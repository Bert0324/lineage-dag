{
  "mimiciv_hosp.diagnoses_icd": {
    "tables": [""],
    "columns": {
      "hadm_id": [[""], [""]],
      "icd_version": [[""], [""]],
      "icd_code": [[""], [""]]
    },
    "table_name": "mimiciv_hosp.diagnoses_icd",
    "sql": "this is a base table"
  },
  "mimiciv_hosp.prescriptions": {
    "tables": [""],
    "columns": {
      "subject_id": [[""], [""]],
      "drug": [[""], [""]],
      "starttime": [[""], [""]],
      "hadm_id": [[""], [""]],
      "route": [[""], [""]],
      "drug_type": [[""], [""]],
      "stoptime": [[""], [""]]
    },
    "table_name": "mimiciv_hosp.prescriptions",
    "sql": "this is a base table"
  },
  "mimiciv_icu.d_items": {
    "tables": [""],
    "columns": { "label": [[""], [""]], "itemid": [[""], [""]] },
    "table_name": "mimiciv_icu.d_items",
    "sql": "this is a base table"
  },
  "mimiciv_hosp.labevents": {
    "tables": [""],
    "columns": {
      "subject_id": [[""], [""]],
      "specimen_id": [[""], [""]],
      "itemid": [[""], [""]],
      "valuenum": [[""], [""]],
      "hadm_id": [[""], [""]],
      "charttime": [[""], [""]],
      "value": [[""], [""]]
    },
    "table_name": "mimiciv_hosp.labevents",
    "sql": "this is a base table"
  },
  "mimiciv_hosp.admissions": {
    "tables": [""],
    "columns": {
      "subject_id": [[""], [""]],
      "hadm_id": [[""], [""]],
      "admittime": [[""], [""]],
      "dischtime": [[""], [""]],
      "race": [[""], [""]],
      "hospital_expire_flag": [[""], [""]],
      "admission_type": [[""], [""]]
    },
    "table_name": "mimiciv_hosp.admissions",
    "sql": "this is a base table"
  },
  "mimiciv_icu.inputevents": {
    "tables": [""],
    "columns": {
      "stay_id": [[""], [""]],
      "itemid": [[""], [""]],
      "rate": [[""], [""]],
      "orderid": [[""], [""]],
      "amount": [[""], [""]],
      "starttime": [[""], [""]],
      "endtime": [[""], [""]],
      "linkorderid": [[""], [""]],
      "rateuom": [[""], [""]],
      "patientweight": [[""], [""]]
    },
    "table_name": "mimiciv_icu.inputevents",
    "sql": "this is a base table"
  },
  "mimiciv_icu.icustays": {
    "tables": [""],
    "columns": {
      "subject_id": [[""], [""]],
      "intime": [[""], [""]],
      "hadm_id": [[""], [""]],
      "stay_id": [[""], [""]],
      "outtime": [[""], [""]]
    },
    "table_name": "mimiciv_icu.icustays",
    "sql": "this is a base table"
  },
  "mimiciv_hosp.services": {
    "tables": [""],
    "columns": { "transfertime": [[""], [""]], "hadm_id": [[""], [""]] },
    "table_name": "mimiciv_hosp.services",
    "sql": "this is a base table"
  },
  "mimiciv_icu.procedureevents": {
    "tables": [""],
    "columns": {
      "location": [[""], [""]],
      "itemid": [[""], [""]],
      "endtime": [[""], [""]],
      "stay_id": [[""], [""]],
      "starttime": [[""], [""]],
      "value": [[""], [""]]
    },
    "table_name": "mimiciv_icu.procedureevents",
    "sql": "this is a base table"
  },
  "mimiciv_icu.outputevents": {
    "tables": [""],
    "columns": {
      "stay_id": [[""], [""]],
      "itemid": [[""], [""]],
      "charttime": [[""], [""]],
      "value": [[""], [""]]
    },
    "table_name": "mimiciv_icu.outputevents",
    "sql": "this is a base table"
  },
  "mimiciv_hosp.patients": {
    "tables": [""],
    "columns": {
      "subject_id": [[""], [""]],
      "gender": [[""], [""]],
      "dod": [[""], [""]],
      "anchor_age": [[""], [""]],
      "anchor_year": [[""], [""]]
    },
    "table_name": "mimiciv_hosp.patients",
    "sql": "this is a base table"
  },
  "mimiciv_icu.chartevents": {
    "tables": [""],
    "columns": {
      "subject_id": [[""], [""]],
      "itemid": [[""], [""]],
      "charttime": [[""], [""]],
      "stay_id": [[""], [""]],
      "valuenum": [[""], [""]],
      "value": [[""], [""]],
      "storetime": [[""], [""]]
    },
    "table_name": "mimiciv_icu.chartevents",
    "sql": "this is a base table"
  },
  "mimiciv_hosp.microbiologyevents": {
    "tables": [""],
    "columns": {
      "charttime": [[""], [""]],
      "subject_id": [[""], [""]],
      "chartdate": [[""], [""]],
      "micro_specimen_id": [[""], [""]],
      "spec_type_desc": [[""], [""]],
      "org_itemid": [[""], [""]],
      "org_name": [[""], [""]]
    },
    "table_name": "mimiciv_hosp.microbiologyevents",
    "sql": "this is a base table"
  },
  "charlson": {
    "tables": [
      "mimiciv_hosp.diagnoses_icd",
      "mimiciv_derived.age",
      "mimiciv_hosp.admissions"
    ],
    "columns": {
      "subject_id": [
        ["mimiciv_hosp.admissions.subject_id"],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "hadm_id": [
        ["mimiciv_hosp.admissions.hadm_id"],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "age_score": [
        ["mimiciv_derived.age.age"],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "myocardial_infarct": [
        [
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.diagnoses_icd.icd_code"
        ],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "congestive_heart_failure": [
        [
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.diagnoses_icd.icd_code"
        ],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "peripheral_vascular_disease": [
        [
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.diagnoses_icd.icd_code"
        ],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "cerebrovascular_disease": [
        [
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.diagnoses_icd.icd_code"
        ],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "dementia": [
        [
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.diagnoses_icd.icd_code"
        ],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "chronic_pulmonary_disease": [
        [
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.diagnoses_icd.icd_code"
        ],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "rheumatic_disease": [
        [
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.diagnoses_icd.icd_code"
        ],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "peptic_ulcer_disease": [
        [
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.diagnoses_icd.icd_code"
        ],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "mild_liver_disease": [
        [
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.diagnoses_icd.icd_code"
        ],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "diabetes_without_cc": [
        [
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.diagnoses_icd.icd_code"
        ],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "diabetes_with_cc": [
        [
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.diagnoses_icd.icd_code"
        ],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "paraplegia": [
        [
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.diagnoses_icd.icd_code"
        ],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "renal_disease": [
        [
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.diagnoses_icd.icd_code"
        ],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "malignant_cancer": [
        [
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.diagnoses_icd.icd_code"
        ],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "severe_liver_disease": [
        [
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.diagnoses_icd.icd_code"
        ],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "metastatic_solid_tumor": [
        [
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.diagnoses_icd.icd_code"
        ],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "aids": [
        [
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.diagnoses_icd.icd_code"
        ],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "charlson_comorbidity_index": [
        [
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.age.age"
        ],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ]
    },
    "table_name": "charlson",
    "sql": "WITH diag AS ( SELECT hadm_id,CASE WHEN icd_version = 9 THEN icd_code ELSE NULL END AS icd9_code,CASE WHEN icd_version = 10 THEN icd_code ELSE NULL END AS icd10_code FROM mimiciv_hosp.diagnoses_icd ),com AS ( SELECT ad.hadm_id,MAX(CASE WHEN SUBSTR(icd9_code,1,3) IN ('410','412') OR SUBSTR(icd10_code,1,3) IN ('I21','I22') OR SUBSTR(icd10_code,1,4) = 'I252' THEN 1 ELSE 0 END) AS myocardial_infarct,MAX(CASE WHEN SUBSTR(icd9_code,1,3) = '428' OR SUBSTR( icd9_code,1,5 ) IN ('39891','40201','40211','40291','40401','40403','40411','40413','40491','40493') OR SUBSTR(icd9_code,1,4) BETWEEN '4254' AND '4259' OR SUBSTR(icd10_code,1,3) IN ('I43','I50') OR SUBSTR( icd10_code,1,4 ) IN ('I099','I110','I130','I132','I255','I420','I425','I426','I427','I428','I429','P290' ) THEN 1 ELSE 0 END) AS congestive_heart_failure,MAX(CASE WHEN SUBSTR(icd9_code,1,3) IN ('440','441') OR SUBSTR( icd9_code,1,4 ) IN ('0930','4373','4471','5571','5579','V434') OR SUBSTR(icd9_code,1,4) BETWEEN '4431' AND '4439' OR SUBSTR(icd10_code,1,3) IN ('I70','I71') OR SUBSTR(icd10_code,1,4) IN ('I731','I738','I739','I771','I790','I792','K551','K558','K559','Z958','Z959' ) THEN 1 ELSE 0 END) AS peripheral_vascular_disease,MAX(CASE WHEN SUBSTR(icd9_code,1,3) BETWEEN '430' AND '438' OR SUBSTR(icd9_code,1,5) = '36234' OR SUBSTR(icd10_code,1,3) IN ('G45','G46') OR SUBSTR(icd10_code,1,3) BETWEEN 'I60' AND 'I69' OR SUBSTR(icd10_code,1,4) = 'H340' THEN 1 ELSE 0 END) AS cerebrovascular_disease,MAX(CASE WHEN SUBSTR(icd9_code,1,3) = '290' OR SUBSTR(icd9_code,1,4) IN ('2941','3312') OR SUBSTR(icd10_code,1,3) IN ('F00','F01','F02','F03','G30') OR SUBSTR(icd10_code,1,4) IN ('F051','G311') THEN 1 ELSE 0 END) AS dementia,MAX(CASE WHEN SUBSTR(icd9_code,1,3) BETWEEN '490' AND '505' OR SUBSTR(icd9_code,1,4) IN ('4168','4169','5064','5081','5088') OR SUBSTR(icd10_code,1,3) BETWEEN 'J40' AND 'J47' OR SUBSTR(icd10_code,1,3) BETWEEN 'J60' AND 'J67' OR SUBSTR(icd10_code,1,4) IN ('I278','I279','J684','J701','J703') THEN 1 ELSE 0 END) AS chronic_pulmonary_disease,MAX(CASE WHEN SUBSTR(icd9_code,1,3) = '725' OR SUBSTR(icd9_code,1,4) IN ('4465','7100','7101','7102','7103','7104','7140','7141','7142','7148' ) OR SUBSTR(icd10_code,1,3) IN ('M05','M06','M32','M33','M34') OR SUBSTR(icd10_code,1,4) IN ('M315','M351','M353','M360') THEN 1 ELSE 0 END) AS rheumatic_disease,MAX(CASE WHEN SUBSTR(icd9_code,1,3) IN ('531','532','533','534') OR SUBSTR(icd10_code,1,3) IN ('K25','K26','K27','K28') THEN 1 ELSE 0 END) AS peptic_ulcer_disease,MAX(CASE WHEN SUBSTR(icd9_code,1,3) IN ('570','571') OR SUBSTR( icd9_code,1,4 ) IN ('0706','0709','5733','5734','5738','5739','V427') OR SUBSTR( icd9_code,1,5 ) IN ('07022','07023','07032','07033','07044','07054') OR SUBSTR(icd10_code,1,3) IN ('B18','K73','K74') OR SUBSTR( icd10_code,1,4 ) IN ('K700','K701','K702','K703','K709','K713','K714','K715','K717','K760','K762','K763','K764','K768','K769','Z944') THEN 1 ELSE 0 END) AS mild_liver_disease,MAX(CASE WHEN SUBSTR( icd9_code,1,4 ) IN ('2500','2501','2502','2503','2508','2509') OR SUBSTR( icd10_code,1,4 ) IN ('E100','E10l','E106','E108','E109','E110','E111','E116','E118','E119','E120','E121','E126','E128','E129','E130','E131','E136','E138','E139','E140','E141','E146','E148','E149') THEN 1 ELSE 0 END) AS diabetes_without_cc,MAX(CASE WHEN SUBSTR(icd9_code,1,4) IN ('2504','2505','2506','2507') OR SUBSTR( icd10_code,1,4 ) IN ('E102','E103','E104','E105','E107','E112','E113','E114','E115','E117','E122','E123','E124','E125','E127','E132','E133','E134','E135','E137','E142','E143','E144','E145','E147') THEN 1 ELSE 0 END) AS diabetes_with_cc,MAX(CASE WHEN SUBSTR(icd9_code,1,3) IN ('342','343') OR SUBSTR(icd9_code,1,4) IN ('3341','3440','3441','3442','3443','3444','3445','3446','3449' ) OR SUBSTR(icd10_code,1,3) IN ('G81','G82') OR SUBSTR(icd10_code,1,4) IN ('G041','G114','G801','G802','G830','G831','G832','G833','G834','G839' ) THEN 1 ELSE 0 END) AS paraplegia,MAX(CASE WHEN SUBSTR(icd9_code,1,3) IN ('582','585','586','V56') OR SUBSTR(icd9_code,1,4) IN ('5880','V420','V451') OR SUBSTR(icd9_code,1,4) BETWEEN '5830' AND '5837' OR SUBSTR( icd9_code,1,5 ) IN ( '40301','40311','40391','40402','40403','40412','40413','40492','40493' ) OR SUBSTR(icd10_code,1,3) IN ('N18','N19') OR SUBSTR(icd10_code,1,4) IN ('I120','I131','N032','N033','N034','N035','N036','N037','N052','N053','N054','N055','N056','N057','N250','Z490','Z491','Z492','Z940','Z992' ) THEN 1 ELSE 0 END) AS renal_disease,MAX(CASE WHEN SUBSTR(icd9_code,1,3) BETWEEN '140' AND '172' OR SUBSTR(icd9_code,1,4) BETWEEN '1740' AND '1958' OR SUBSTR(icd9_code,1,3) BETWEEN '200' AND '208' OR SUBSTR(icd9_code,1,4) = '2386' OR SUBSTR(icd10_code,1,3) IN ('C43','C88') OR SUBSTR(icd10_code,1,3) BETWEEN 'C00' AND 'C26' OR SUBSTR(icd10_code,1,3) BETWEEN 'C30' AND 'C34' OR SUBSTR(icd10_code,1,3) BETWEEN 'C37' AND 'C41' OR SUBSTR(icd10_code,1,3) BETWEEN 'C45' AND 'C58' OR SUBSTR(icd10_code,1,3) BETWEEN 'C60' AND 'C76' OR SUBSTR(icd10_code,1,3) BETWEEN 'C81' AND 'C85' OR SUBSTR(icd10_code,1,3) BETWEEN 'C90' AND 'C97' THEN 1 ELSE 0 END) AS malignant_cancer,MAX(CASE WHEN SUBSTR(icd9_code,1,4) IN ('4560','4561','4562') OR SUBSTR(icd9_code,1,4) BETWEEN '5722' AND '5728' OR SUBSTR( icd10_code,1,4 ) IN ('I850','I859','I864','I982','K704','K711','K721','K729','K765','K766','K767') THEN 1 ELSE 0 END) AS severe_liver_disease,MAX(CASE WHEN SUBSTR(icd9_code,1,3) IN ('196','197','198','199') OR SUBSTR(icd10_code,1,3) IN ('C77','C78','C79','C80') THEN 1 ELSE 0 END) AS metastatic_solid_tumor,MAX(CASE WHEN SUBSTR(icd9_code,1,3) IN ('042','043','044') OR SUBSTR(icd10_code,1,3) IN ('B20','B21','B22','B24') THEN 1 ELSE 0 END) AS aids FROM mimiciv_hosp.admissions ad LEFT JOIN diag ON ad.hadm_id = diag.hadm_id GROUP BY ad.hadm_id ),ag AS ( SELECT hadm_id,age,CASE WHEN age <= 50 THEN 0 WHEN age <= 60 THEN 1 WHEN age <= 70 THEN 2 WHEN age <= 80 THEN 3 ELSE 4 END AS age_score FROM mimiciv_derived.age ) SELECT ad.subject_id,ad.hadm_id,ag.age_score,myocardial_infarct,congestive_heart_failure,peripheral_vascular_disease,cerebrovascular_disease,dementia,chronic_pulmonary_disease,rheumatic_disease,peptic_ulcer_disease,mild_liver_disease,diabetes_without_cc,diabetes_with_cc,paraplegia,renal_disease,malignant_cancer,severe_liver_disease,metastatic_solid_tumor,aids,age_score + myocardial_infarct + congestive_heart_failure + peripheral_vascular_disease + cerebrovascular_disease + dementia + chronic_pulmonary_disease + rheumatic_disease + peptic_ulcer_disease + GREATEST(mild_liver_disease,3 * severe_liver_disease) + GREATEST(2 * diabetes_with_cc,diabetes_without_cc) + GREATEST(2 * malignant_cancer,6 * metastatic_solid_tumor) + 2 * paraplegia + 2 * renal_disease + 6 * aids AS charlson_comorbidity_index FROM mimiciv_hosp.admissions ad LEFT JOIN com ON ad.hadm_id = com.hadm_id LEFT JOIN ag ON com.hadm_id = ag.hadm_id"
  },
  "icustay_detail": {
    "tables": [
      "mimiciv_hosp.patients",
      "mimiciv_hosp.admissions",
      "mimiciv_icu.icustays"
    ],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.icustays.subject_id"],
        [
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "hadm_id": [
        ["mimiciv_icu.icustays.hadm_id"],
        [
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "gender": [
        ["mimiciv_hosp.patients.gender"],
        [
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "dod": [
        ["mimiciv_hosp.patients.dod"],
        [
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "admittime": [
        ["mimiciv_hosp.admissions.admittime"],
        [
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "dischtime": [
        ["mimiciv_hosp.admissions.dischtime"],
        [
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "los_hospital": [
        [
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_hosp.admissions.dischtime"
        ],
        [
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "admission_age": [
        [
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_hosp.patients.anchor_age",
          "mimiciv_hosp.patients.anchor_year"
        ],
        [
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "race": [
        ["mimiciv_hosp.admissions.race"],
        [
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "hospital_expire_flag": [
        ["mimiciv_hosp.admissions.hospital_expire_flag"],
        [
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "hospstay_seq": [
        [
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_hosp.admissions.subject_id"
        ],
        [
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "first_hosp_stay": [
        [
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_hosp.admissions.subject_id"
        ],
        [
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "icu_intime": [
        ["mimiciv_icu.icustays.intime"],
        [
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "icu_outtime": [
        ["mimiciv_icu.icustays.outtime"],
        [
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "los_icu": [
        ["mimiciv_icu.icustays.outtime", "mimiciv_icu.icustays.intime"],
        [
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "icustay_seq": [
        ["mimiciv_icu.icustays.hadm_id", "mimiciv_icu.icustays.intime"],
        [
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "first_icu_stay": [
        ["mimiciv_icu.icustays.hadm_id", "mimiciv_icu.icustays.intime"],
        [
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ]
    },
    "table_name": "icustay_detail",
    "sql": "SELECT ie.subject_id,ie.hadm_id,ie.stay_id,pat.gender,pat.dod,adm.admittime,adm.dischtime,DATETIME_DIFF(adm.dischtime,adm.admittime,'DAY') AS los_hospital,pat.anchor_age + DATETIME_DIFF(adm.admittime,DATETIME(pat.anchor_year,1,1,0,0,0),'YEAR') AS admission_age,adm.race,adm.hospital_expire_flag,DENSE_RANK() OVER ( PARTITION BY adm.subject_id ORDER BY adm.admittime ) AS hospstay_seq,CASE WHEN DENSE_RANK() OVER ( PARTITION BY adm.subject_id ORDER BY adm.admittime ) = 1 THEN True ELSE False END AS first_hosp_stay,ie.intime AS icu_intime,ie.outtime AS icu_outtime,ROUND( CAST(DATETIME_DIFF(ie.outtime,ie.intime,'HOUR') / 24.0 AS NUMERIC),2 ) AS los_icu,DENSE_RANK() OVER ( PARTITION BY ie.hadm_id ORDER BY ie.intime ) AS icustay_seq,CASE WHEN DENSE_RANK() OVER ( PARTITION BY ie.hadm_id ORDER BY ie.intime ) = 1 THEN True ELSE False END AS first_icu_stay FROM mimiciv_icu.icustays ie INNER JOIN mimiciv_hosp.admissions adm ON ie.hadm_id = adm.hadm_id INNER JOIN mimiciv_hosp.patients pat ON ie.subject_id = pat.subject_id"
  },
  "first_day_bg": {
    "tables": ["mimiciv_derived.bg", "mimiciv_icu.icustays"],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.icustays.subject_id"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "lactate_min": [
        ["lactate"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "lactate_max": [
        ["lactate"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "ph_min": [
        ["ph"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "ph_max": [
        ["ph"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "so2_min": [
        ["so2"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "so2_max": [
        ["so2"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "po2_min": [
        ["po2"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "po2_max": [
        ["po2"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "pco2_min": [
        ["pco2"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "pco2_max": [
        ["pco2"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "aado2_min": [
        ["aado2"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "aado2_max": [
        ["aado2"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "aado2_calc_min": [
        ["aado2_calc"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "aado2_calc_max": [
        ["aado2_calc"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "pao2fio2ratio_min": [
        ["pao2fio2ratio"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "pao2fio2ratio_max": [
        ["pao2fio2ratio"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "baseexcess_min": [
        ["baseexcess"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "baseexcess_max": [
        ["baseexcess"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "bicarbonate_min": [
        ["bicarbonate"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "bicarbonate_max": [
        ["bicarbonate"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "totalco2_min": [
        ["totalco2"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "totalco2_max": [
        ["totalco2"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "hematocrit_min": [
        ["hematocrit"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "hematocrit_max": [
        ["hematocrit"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "hemoglobin_min": [
        ["hemoglobin"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "hemoglobin_max": [
        ["hemoglobin"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "carboxyhemoglobin_min": [
        ["carboxyhemoglobin"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "carboxyhemoglobin_max": [
        ["carboxyhemoglobin"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "methemoglobin_min": [
        ["methemoglobin"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "methemoglobin_max": [
        ["methemoglobin"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "temperature_min": [
        ["temperature"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "temperature_max": [
        ["temperature"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "chloride_min": [
        ["chloride"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "chloride_max": [
        ["chloride"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "calcium_min": [
        ["calcium"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "calcium_max": [
        ["calcium"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "glucose_min": [
        ["glucose"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "glucose_max": [
        ["glucose"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "potassium_min": [
        ["potassium"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "potassium_max": [
        ["potassium"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "sodium_min": [
        ["sodium"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "sodium_max": [
        ["sodium"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ]
    },
    "table_name": "first_day_bg",
    "sql": "SELECT ie.subject_id,ie.stay_id,MIN(lactate) AS lactate_min,MAX(lactate) AS lactate_max,MIN(ph) AS ph_min,MAX(ph) AS ph_max,MIN(so2) AS so2_min,MAX(so2) AS so2_max,MIN(po2) AS po2_min,MAX(po2) AS po2_max,MIN(pco2) AS pco2_min,MAX(pco2) AS pco2_max,MIN(aado2) AS aado2_min,MAX(aado2) AS aado2_max,MIN(aado2_calc) AS aado2_calc_min,MAX(aado2_calc) AS aado2_calc_max,MIN(pao2fio2ratio) AS pao2fio2ratio_min,MAX(pao2fio2ratio) AS pao2fio2ratio_max,MIN(baseexcess) AS baseexcess_min,MAX(baseexcess) AS baseexcess_max,MIN(bicarbonate) AS bicarbonate_min,MAX(bicarbonate) AS bicarbonate_max,MIN(totalco2) AS totalco2_min,MAX(totalco2) AS totalco2_max,MIN(hematocrit) AS hematocrit_min,MAX(hematocrit) AS hematocrit_max,MIN(hemoglobin) AS hemoglobin_min,MAX(hemoglobin) AS hemoglobin_max,MIN(carboxyhemoglobin) AS carboxyhemoglobin_min,MAX(carboxyhemoglobin) AS carboxyhemoglobin_max,MIN(methemoglobin) AS methemoglobin_min,MAX(methemoglobin) AS methemoglobin_max,MIN(temperature) AS temperature_min,MAX(temperature) AS temperature_max,MIN(chloride) AS chloride_min,MAX(chloride) AS chloride_max,MIN(calcium) AS calcium_min,MAX(calcium) AS calcium_max,MIN(glucose) AS glucose_min,MAX(glucose) AS glucose_max,MIN(potassium) AS potassium_min,MAX(potassium) AS potassium_max,MIN(sodium) AS sodium_min,MAX(sodium) AS sodium_max FROM mimiciv_icu.icustays ie LEFT JOIN mimiciv_derived.bg bg ON ie.subject_id = bg.subject_id AND bg.charttime >= DATETIME_SUB(ie.intime,INTERVAL '6' HOUR) AND bg.charttime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) GROUP BY ie.subject_id,ie.stay_id"
  },
  "first_day_height": {
    "tables": ["mimiciv_derived.height", "mimiciv_icu.icustays"],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.icustays.subject_id"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.height.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.height.charttime"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.height.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.height.charttime"
        ]
      ],
      "height": [
        ["height"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.height.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.height.charttime"
        ]
      ]
    },
    "table_name": "first_day_height",
    "sql": "SELECT ie.subject_id,ie.stay_id,ROUND(CAST(AVG(height) AS NUMERIC),2) AS height FROM mimiciv_icu.icustays ie LEFT JOIN mimiciv_derived.height ht ON ie.stay_id = ht.stay_id AND ht.charttime >= DATETIME_SUB(ie.intime,INTERVAL '6' HOUR) AND ht.charttime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) GROUP BY ie.subject_id,ie.stay_id"
  },
  "first_day_sofa": {
    "tables": [
      "mimiciv_derived.norepinephrine",
      "mimiciv_derived.epinephrine",
      "mimiciv_derived.dopamine",
      "mimiciv_derived.first_day_lab",
      "mimiciv_derived.bg",
      "mimiciv_icu.icustays",
      "mimiciv_derived.first_day_vitalsign",
      "mimiciv_derived.ventilation",
      "mimiciv_derived.first_day_urine_output",
      "mimiciv_derived.dobutamine",
      "mimiciv_derived.first_day_gcs"
    ],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.icustays.subject_id"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_icu.icustays.intime",
          "vaso_rate",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "hadm_id": [
        ["mimiciv_icu.icustays.hadm_id"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_icu.icustays.intime",
          "vaso_rate",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_icu.icustays.intime",
          "vaso_rate",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "sofa": [
        [
          "mimiciv_derived.first_day_vitalsign.mbp_min",
          "mimiciv_derived.first_day_gcs.gcs_min",
          "mimiciv_derived.first_day_lab.creatinine_max",
          "mimiciv_derived.first_day_urine_output.urineoutput",
          "vaso_rate",
          "mimiciv_derived.first_day_lab.platelets_min",
          "mimiciv_derived.first_day_lab.bilirubin_total_max",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.bg.pao2fio2ratio"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_icu.icustays.intime",
          "vaso_rate",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "respiration": [
        [
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.bg.pao2fio2ratio"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_icu.icustays.intime",
          "vaso_rate",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "coagulation": [
        ["mimiciv_derived.first_day_lab.platelets_min"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_icu.icustays.intime",
          "vaso_rate",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "liver": [
        ["mimiciv_derived.first_day_lab.bilirubin_total_max"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_icu.icustays.intime",
          "vaso_rate",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "cardiovascular": [
        ["mimiciv_derived.first_day_vitalsign.mbp_min", "vaso_rate"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_icu.icustays.intime",
          "vaso_rate",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "cns": [
        ["mimiciv_derived.first_day_gcs.gcs_min"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_icu.icustays.intime",
          "vaso_rate",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "renal": [
        [
          "mimiciv_derived.first_day_lab.creatinine_max",
          "mimiciv_derived.first_day_urine_output.urineoutput"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_icu.icustays.intime",
          "vaso_rate",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_icu.icustays.subject_id"
        ]
      ]
    },
    "table_name": "first_day_sofa",
    "sql": "WITH vaso_stg AS ( SELECT ie.stay_id,'norepinephrine' AS treatment,vaso_rate AS rate FROM mimiciv_icu.icustays ie INNER JOIN mimiciv_derived.norepinephrine mv ON ie.stay_id = mv.stay_id AND mv.starttime >= DATETIME_SUB(ie.intime,INTERVAL '6' HOUR) AND mv.starttime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) UNION ALL SELECT ie.stay_id,'epinephrine' AS treatment,vaso_rate AS rate FROM mimiciv_icu.icustays ie INNER JOIN mimiciv_derived.epinephrine mv ON ie.stay_id = mv.stay_id AND mv.starttime >= DATETIME_SUB(ie.intime,INTERVAL '6' HOUR) AND mv.starttime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) UNION ALL SELECT ie.stay_id,'dobutamine' AS treatment,vaso_rate AS rate FROM mimiciv_icu.icustays ie INNER JOIN mimiciv_derived.dobutamine mv ON ie.stay_id = mv.stay_id AND mv.starttime >= DATETIME_SUB(ie.intime,INTERVAL '6' HOUR) AND mv.starttime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) UNION ALL SELECT ie.stay_id,'dopamine' AS treatment,vaso_rate AS rate FROM mimiciv_icu.icustays ie INNER JOIN mimiciv_derived.dopamine mv ON ie.stay_id = mv.stay_id AND mv.starttime >= DATETIME_SUB(ie.intime,INTERVAL '6' HOUR) AND mv.starttime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) ),vaso_mv AS ( SELECT ie.stay_id,MAX( CASE WHEN treatment = 'norepinephrine' THEN rate ELSE NULL END ) AS rate_norepinephrine,MAX( CASE WHEN treatment = 'epinephrine' THEN rate ELSE NULL END ) AS rate_epinephrine,MAX( CASE WHEN treatment = 'dopamine' THEN rate ELSE NULL END ) AS rate_dopamine,MAX( CASE WHEN treatment = 'dobutamine' THEN rate ELSE NULL END ) AS rate_dobutamine FROM mimiciv_icu.icustays ie LEFT JOIN vaso_stg v ON ie.stay_id = v.stay_id GROUP BY ie.stay_id ),pafi1 AS ( SELECT ie.stay_id,bg.charttime,bg.pao2fio2ratio,CASE WHEN vd.stay_id IS NOT NULL THEN 1 ELSE 0 END AS isvent FROM mimiciv_icu.icustays ie LEFT JOIN mimiciv_derived.bg bg ON ie.subject_id = bg.subject_id AND bg.charttime >= DATETIME_SUB(ie.intime,INTERVAL '6' HOUR) AND bg.charttime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) LEFT JOIN mimiciv_derived.ventilation vd ON ie.stay_id = vd.stay_id AND bg.charttime >= vd.starttime AND bg.charttime <= vd.endtime AND vd.ventilation_status = 'InvasiveVent' ),pafi2 AS ( SELECT stay_id,MIN( CASE WHEN isvent = 0 THEN pao2fio2ratio ELSE NULL END ) AS pao2fio2_novent_min,MIN( CASE WHEN isvent = 1 THEN pao2fio2ratio ELSE NULL END ) AS pao2fio2_vent_min FROM pafi1 GROUP BY stay_id ),scorecomp AS ( SELECT ie.stay_id,v.mbp_min,mv.rate_norepinephrine,mv.rate_epinephrine,mv.rate_dopamine,mv.rate_dobutamine,l.creatinine_max,l.bilirubin_total_max AS bilirubin_max,l.platelets_min AS platelet_min,pf.pao2fio2_novent_min,pf.pao2fio2_vent_min,uo.urineoutput,gcs.gcs_min FROM mimiciv_icu.icustays ie LEFT JOIN vaso_mv mv ON ie.stay_id = mv.stay_id LEFT JOIN pafi2 pf ON ie.stay_id = pf.stay_id LEFT JOIN mimiciv_derived.first_day_vitalsign v ON ie.stay_id = v.stay_id LEFT JOIN mimiciv_derived.first_day_lab l ON ie.stay_id = l.stay_id LEFT JOIN mimiciv_derived.first_day_urine_output uo ON ie.stay_id = uo.stay_id LEFT JOIN mimiciv_derived.first_day_gcs gcs ON ie.stay_id = gcs.stay_id ),scorecalc AS ( SELECT stay_id,CASE WHEN pao2fio2_vent_min < 100 THEN 4 WHEN pao2fio2_vent_min < 200 THEN 3 WHEN pao2fio2_novent_min < 300 THEN 2 WHEN pao2fio2_novent_min < 400 THEN 1 WHEN COALESCE( pao2fio2_vent_min,pao2fio2_novent_min ) IS NULL THEN NULL ELSE 0 END AS respiration,CASE WHEN platelet_min < 20 THEN 4 WHEN platelet_min < 50 THEN 3 WHEN platelet_min < 100 THEN 2 WHEN platelet_min < 150 THEN 1 WHEN platelet_min IS NULL THEN NULL ELSE 0 END AS coagulation,CASE WHEN bilirubin_max >= 12.0 THEN 4 WHEN bilirubin_max >= 6.0 THEN 3 WHEN bilirubin_max >= 2.0 THEN 2 WHEN bilirubin_max >= 1.2 THEN 1 WHEN bilirubin_max IS NULL THEN NULL ELSE 0 END AS liver,CASE WHEN rate_dopamine > 15 OR rate_epinephrine > 0.1 OR rate_norepinephrine > 0.1 THEN 4 WHEN rate_dopamine > 5 OR rate_epinephrine <= 0.1 OR rate_norepinephrine <= 0.1 THEN 3 WHEN rate_dopamine > 0 OR rate_dobutamine > 0 THEN 2 WHEN mbp_min < 70 THEN 1 WHEN COALESCE( mbp_min,rate_dopamine,rate_dobutamine,rate_epinephrine,rate_norepinephrine ) IS NULL THEN NULL ELSE 0 END AS cardiovascular,CASE WHEN (gcs_min >= 13 AND gcs_min <= 14) THEN 1 WHEN (gcs_min >= 10 AND gcs_min <= 12) THEN 2 WHEN (gcs_min >= 6 AND gcs_min <= 9) THEN 3 WHEN gcs_min < 6 THEN 4 WHEN gcs_min IS NULL THEN NULL ELSE 0 END AS cns,CASE WHEN (creatinine_max >= 5.0) THEN 4 WHEN urineoutput < 200 THEN 4 WHEN (creatinine_max >= 3.5 AND creatinine_max < 5.0) THEN 3 WHEN urineoutput < 500 THEN 3 WHEN (creatinine_max >= 2.0 AND creatinine_max < 3.5) THEN 2 WHEN (creatinine_max >= 1.2 AND creatinine_max < 2.0) THEN 1 WHEN COALESCE(urineoutput,creatinine_max) IS NULL THEN NULL ELSE 0 END AS renal FROM scorecomp ) SELECT ie.subject_id,ie.hadm_id,ie.stay_id,COALESCE(respiration,0) + COALESCE(coagulation,0) + COALESCE(liver,0) + COALESCE(cardiovascular,0) + COALESCE(cns,0) + COALESCE(renal,0) AS sofa,respiration,coagulation,liver,cardiovascular,cns,renal FROM mimiciv_icu.icustays ie LEFT JOIN scorecalc s ON ie.stay_id = s.stay_id"
  },
  "first_day_weight": {
    "tables": ["mimiciv_derived.weight_durations", "mimiciv_icu.icustays"],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.icustays.subject_id"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.weight_durations.starttime"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.weight_durations.starttime"
        ]
      ],
      "weight_admit": [
        [
          "mimiciv_derived.weight_durations.weight",
          "mimiciv_derived.weight_durations.weight_type"
        ],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.weight_durations.starttime"
        ]
      ],
      "weight": [
        ["mimiciv_derived.weight_durations.weight"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.weight_durations.starttime"
        ]
      ],
      "weight_min": [
        ["mimiciv_derived.weight_durations.weight"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.weight_durations.starttime"
        ]
      ],
      "weight_max": [
        ["mimiciv_derived.weight_durations.weight"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.weight_durations.starttime"
        ]
      ]
    },
    "table_name": "first_day_weight",
    "sql": "SELECT ie.subject_id,ie.stay_id,AVG( CASE WHEN weight_type = 'admit' THEN ce.weight ELSE NULL END ) AS weight_admit,AVG(ce.weight) AS weight,MIN(ce.weight) AS weight_min,MAX(ce.weight) AS weight_max FROM mimiciv_icu.icustays ie LEFT JOIN mimiciv_derived.weight_durations ce ON ie.stay_id = ce.stay_id AND ce.starttime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) GROUP BY ie.subject_id,ie.stay_id"
  },
  "cardiac_marker": {
    "tables": ["mimiciv_hosp.labevents"],
    "columns": {
      "subject_id": [
        ["mimiciv_hosp.labevents.subject_id"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "hadm_id": [
        ["mimiciv_hosp.labevents.hadm_id"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "charttime": [
        ["mimiciv_hosp.labevents.charttime"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "specimen_id": [
        ["mimiciv_hosp.labevents.specimen_id"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "troponin_t": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.value"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "ck_mb": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "ntprobnp": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ]
    },
    "table_name": "cardiac_marker",
    "sql": "SELECT MAX(subject_id) AS subject_id,MAX(hadm_id) AS hadm_id,MAX(charttime) AS charttime,le.specimen_id,MAX(CASE WHEN itemid = 51003 THEN value ELSE NULL END) AS troponin_t,MAX(CASE WHEN itemid = 50911 THEN valuenum ELSE NULL END) AS ck_mb,MAX(CASE WHEN itemid = 50963 THEN valuenum ELSE NULL END) AS ntprobnp FROM mimiciv_hosp.labevents le WHERE le.itemid IN ( 51003,50911,50963 ) AND valuenum IS NOT NULL GROUP BY le.specimen_id"
  },
  "creatinine_baseline": {
    "tables": [
      "mimiciv_hosp.patients",
      "mimiciv_hosp.diagnoses_icd",
      "mimiciv_derived.age",
      "mimiciv_derived.chemistry"
    ],
    "columns": {
      "hadm_id": [
        ["mimiciv_derived.age.hadm_id"],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_derived.age.age",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.age.subject_id"
        ]
      ],
      "gender": [
        ["mimiciv_hosp.patients.gender"],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_derived.age.age",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.age.subject_id"
        ]
      ],
      "age": [
        ["mimiciv_derived.age.age"],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_derived.age.age",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.age.subject_id"
        ]
      ],
      "scr_min": [
        ["mimiciv_derived.chemistry.creatinine"],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_derived.age.age",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.age.subject_id"
        ]
      ],
      "ckd": [
        [],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_derived.age.age",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.age.subject_id"
        ]
      ],
      "mdrd_est": [
        ["mimiciv_derived.age.age", "mimiciv_hosp.patients.gender"],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_derived.age.age",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.age.subject_id"
        ]
      ],
      "scr_baseline": [
        [
          "mimiciv_derived.age.age",
          "mimiciv_hosp.patients.gender",
          "mimiciv_derived.chemistry.creatinine"
        ],
        [
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_derived.age.age",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.age.subject_id"
        ]
      ]
    },
    "table_name": "creatinine_baseline",
    "sql": "WITH p AS ( SELECT ag.subject_id,ag.hadm_id,ag.age,p.gender,CASE WHEN p.gender = 'F' THEN POWER(75.0 / 186.0 / POWER(ag.age,-0.203) / 0.742,-1 / 1.154) ELSE POWER(75.0 / 186.0 / POWER(ag.age,-0.203),-1 / 1.154) END AS mdrd_est FROM mimiciv_derived.age ag LEFT JOIN mimiciv_hosp.patients p ON ag.subject_id = p.subject_id WHERE ag.age >= 18 ),lab AS ( SELECT hadm_id,MIN(creatinine) AS scr_min FROM mimiciv_derived.chemistry GROUP BY hadm_id ),ckd AS ( SELECT hadm_id,MAX(1) AS ckd_flag FROM mimiciv_hosp.diagnoses_icd WHERE ( SUBSTR(icd_code,1,3) = '585' AND icd_version = 9 ) OR ( SUBSTR(icd_code,1,3) = 'N18' AND icd_version = 10 ) GROUP BY hadm_id ) SELECT p.hadm_id,p.gender,p.age,lab.scr_min,COALESCE(ckd.ckd_flag,0) AS ckd,p.mdrd_est,CASE WHEN lab.scr_min <= 1.1 THEN scr_min WHEN ckd.ckd_flag = 1 THEN scr_min ELSE mdrd_est END AS scr_baseline FROM p LEFT JOIN lab ON p.hadm_id = lab.hadm_id LEFT JOIN ckd ON p.hadm_id = ckd.hadm_id"
  },
  "icp": {
    "tables": ["mimiciv_icu.chartevents"],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.chartevents.subject_id"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.chartevents.stay_id"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "charttime": [
        ["mimiciv_icu.chartevents.charttime"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "icp": [
        ["mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ]
    },
    "table_name": "icp",
    "sql": "WITH ce AS ( SELECT ce.subject_id,ce.stay_id,ce.charttime,CASE WHEN valuenum > 0 AND valuenum < 100 THEN valuenum ELSE null END AS icp FROM mimiciv_icu.chartevents ce WHERE ce.itemid IN ( 220765,227989 ) ) SELECT ce.subject_id,ce.stay_id,ce.charttime,MAX(icp) AS icp FROM ce GROUP BY ce.subject_id,ce.stay_id,ce.charttime"
  },
  "inflammation": {
    "tables": ["mimiciv_hosp.labevents"],
    "columns": {
      "subject_id": [
        ["mimiciv_hosp.labevents.subject_id"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "hadm_id": [
        ["mimiciv_hosp.labevents.hadm_id"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "charttime": [
        ["mimiciv_hosp.labevents.charttime"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "specimen_id": [
        ["mimiciv_hosp.labevents.specimen_id"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "crp": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ]
    },
    "table_name": "inflammation",
    "sql": "SELECT MAX(subject_id) AS subject_id,MAX(hadm_id) AS hadm_id,MAX(charttime) AS charttime,le.specimen_id,MAX(CASE WHEN itemid = 50889 THEN valuenum ELSE NULL END) AS crp FROM mimiciv_hosp.labevents le WHERE le.itemid IN ( 50889 ) AND valuenum IS NOT NULL AND valuenum > 0 GROUP BY le.specimen_id"
  },
  "rhythm": {
    "tables": ["mimiciv_icu.chartevents"],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.chartevents.subject_id"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "charttime": [
        ["mimiciv_icu.chartevents.charttime"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "heart_rhythm": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.value"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "ectopy_type": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.value"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "ectopy_frequency": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.value"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "ectopy_type_secondary": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.value"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "ectopy_frequency_secondary": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.value"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ]
    },
    "table_name": "rhythm",
    "sql": "SELECT ce.subject_id,ce.charttime,MAX(CASE WHEN itemid = 220048 THEN value ELSE NULL END) AS heart_rhythm,MAX(CASE WHEN itemid = 224650 THEN value ELSE NULL END) AS ectopy_type,MAX( CASE WHEN itemid = 224651 THEN value ELSE NULL END ) AS ectopy_frequency,MAX( CASE WHEN itemid = 226479 THEN value ELSE NULL END ) AS ectopy_type_secondary,MAX( CASE WHEN itemid = 226480 THEN value ELSE NULL END ) AS ectopy_frequency_secondary FROM mimiciv_icu.chartevents ce WHERE ce.stay_id IS NOT NULL AND ce.itemid IN ( 220048,224650,224651,226479,226480 ) GROUP BY ce.subject_id,ce.charttime"
  },
  "neuroblock": {
    "tables": ["mimiciv_icu.inputevents"],
    "columns": {
      "stay_id": [
        ["mimiciv_icu.inputevents.stay_id"],
        ["mimiciv_icu.inputevents.itemid", "mimiciv_icu.inputevents.rate"]
      ],
      "orderid": [
        ["mimiciv_icu.inputevents.orderid"],
        ["mimiciv_icu.inputevents.itemid", "mimiciv_icu.inputevents.rate"]
      ],
      "drug_rate": [
        ["mimiciv_icu.inputevents.rate"],
        ["mimiciv_icu.inputevents.itemid", "mimiciv_icu.inputevents.rate"]
      ],
      "drug_amount": [
        ["mimiciv_icu.inputevents.amount"],
        ["mimiciv_icu.inputevents.itemid", "mimiciv_icu.inputevents.rate"]
      ],
      "starttime": [
        ["mimiciv_icu.inputevents.starttime"],
        ["mimiciv_icu.inputevents.itemid", "mimiciv_icu.inputevents.rate"]
      ],
      "endtime": [
        ["mimiciv_icu.inputevents.endtime"],
        ["mimiciv_icu.inputevents.itemid", "mimiciv_icu.inputevents.rate"]
      ]
    },
    "table_name": "neuroblock",
    "sql": "SELECT stay_id,orderid,rate AS drug_rate,amount AS drug_amount,starttime,endtime FROM mimiciv_icu.inputevents WHERE itemid IN ( 222062,221555 ) AND rate IS NOT NULL"
  },
  "norepinephrine_equivalent_dose": {
    "tables": ["mimiciv_derived.vasoactive_agent"],
    "columns": {
      "stay_id": [
        ["mimiciv_derived.vasoactive_agent.stay_id"],
        [
          "mimiciv_derived.vasoactive_agent.norepinephrine",
          "mimiciv_derived.vasoactive_agent.dopamine",
          "mimiciv_derived.vasoactive_agent.vasopressin",
          "mimiciv_derived.vasoactive_agent.epinephrine",
          "mimiciv_derived.vasoactive_agent.phenylephrine"
        ]
      ],
      "starttime": [
        ["mimiciv_derived.vasoactive_agent.starttime"],
        [
          "mimiciv_derived.vasoactive_agent.norepinephrine",
          "mimiciv_derived.vasoactive_agent.dopamine",
          "mimiciv_derived.vasoactive_agent.vasopressin",
          "mimiciv_derived.vasoactive_agent.epinephrine",
          "mimiciv_derived.vasoactive_agent.phenylephrine"
        ]
      ],
      "endtime": [
        ["mimiciv_derived.vasoactive_agent.endtime"],
        [
          "mimiciv_derived.vasoactive_agent.norepinephrine",
          "mimiciv_derived.vasoactive_agent.dopamine",
          "mimiciv_derived.vasoactive_agent.vasopressin",
          "mimiciv_derived.vasoactive_agent.epinephrine",
          "mimiciv_derived.vasoactive_agent.phenylephrine"
        ]
      ],
      "norepinephrine_equivalent_dose": [
        [
          "mimiciv_derived.vasoactive_agent.norepinephrine",
          "mimiciv_derived.vasoactive_agent.dopamine",
          "mimiciv_derived.vasoactive_agent.vasopressin",
          "mimiciv_derived.vasoactive_agent.epinephrine",
          "mimiciv_derived.vasoactive_agent.phenylephrine"
        ],
        [
          "mimiciv_derived.vasoactive_agent.norepinephrine",
          "mimiciv_derived.vasoactive_agent.dopamine",
          "mimiciv_derived.vasoactive_agent.vasopressin",
          "mimiciv_derived.vasoactive_agent.epinephrine",
          "mimiciv_derived.vasoactive_agent.phenylephrine"
        ]
      ]
    },
    "table_name": "norepinephrine_equivalent_dose",
    "sql": "SELECT stay_id,starttime,endtime,ROUND(CAST( COALESCE(norepinephrine,0) + COALESCE(epinephrine,0) + COALESCE(phenylephrine / 10,0) + COALESCE(dopamine / 100,0) + COALESCE(vasopressin * 2.5 / 60,0) AS NUMERIC),4) AS norepinephrine_equivalent_dose FROM mimiciv_derived.vasoactive_agent WHERE norepinephrine IS NOT NULL OR epinephrine IS NOT NULL OR phenylephrine IS NOT NULL OR dopamine IS NOT NULL OR vasopressin IS NOT NULL"
  },
  "kdigo_stages": {
    "tables": [
      "mimiciv_derived.kdigo_uo",
      "mimiciv_derived.kdigo_creatinine",
      "mimiciv_derived.crrt",
      "mimiciv_icu.icustays"
    ],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.icustays.subject_id"],
        [
          "mimiciv_derived.kdigo_creatinine.stay_id",
          "mimiciv_derived.crrt.stay_id",
          "mimiciv_derived.crrt.crrt_mode",
          "mimiciv_derived.crrt.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.kdigo_uo.charttime",
          "mimiciv_derived.kdigo_creatinine.charttime",
          "mimiciv_derived.kdigo_uo.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "hadm_id": [
        ["mimiciv_icu.icustays.hadm_id"],
        [
          "mimiciv_derived.kdigo_creatinine.stay_id",
          "mimiciv_derived.crrt.stay_id",
          "mimiciv_derived.crrt.crrt_mode",
          "mimiciv_derived.crrt.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.kdigo_uo.charttime",
          "mimiciv_derived.kdigo_creatinine.charttime",
          "mimiciv_derived.kdigo_uo.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_derived.kdigo_creatinine.stay_id",
          "mimiciv_derived.crrt.stay_id",
          "mimiciv_derived.crrt.crrt_mode",
          "mimiciv_derived.crrt.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.kdigo_uo.charttime",
          "mimiciv_derived.kdigo_creatinine.charttime",
          "mimiciv_derived.kdigo_uo.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "charttime": [
        ["mimiciv_derived.kdigo_creatinine.charttime"],
        [
          "mimiciv_derived.kdigo_creatinine.stay_id",
          "mimiciv_derived.crrt.stay_id",
          "mimiciv_derived.crrt.crrt_mode",
          "mimiciv_derived.crrt.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.kdigo_uo.charttime",
          "mimiciv_derived.kdigo_creatinine.charttime",
          "mimiciv_derived.kdigo_uo.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "creat_low_past_7day": [
        ["mimiciv_derived.kdigo_creatinine.creat_low_past_7day"],
        [
          "mimiciv_derived.kdigo_creatinine.stay_id",
          "mimiciv_derived.crrt.stay_id",
          "mimiciv_derived.crrt.crrt_mode",
          "mimiciv_derived.crrt.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.kdigo_uo.charttime",
          "mimiciv_derived.kdigo_creatinine.charttime",
          "mimiciv_derived.kdigo_uo.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "creat_low_past_48hr": [
        ["mimiciv_derived.kdigo_creatinine.creat_low_past_48hr"],
        [
          "mimiciv_derived.kdigo_creatinine.stay_id",
          "mimiciv_derived.crrt.stay_id",
          "mimiciv_derived.crrt.crrt_mode",
          "mimiciv_derived.crrt.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.kdigo_uo.charttime",
          "mimiciv_derived.kdigo_creatinine.charttime",
          "mimiciv_derived.kdigo_uo.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "creat": [
        ["mimiciv_derived.kdigo_creatinine.creat"],
        [
          "mimiciv_derived.kdigo_creatinine.stay_id",
          "mimiciv_derived.crrt.stay_id",
          "mimiciv_derived.crrt.crrt_mode",
          "mimiciv_derived.crrt.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.kdigo_uo.charttime",
          "mimiciv_derived.kdigo_creatinine.charttime",
          "mimiciv_derived.kdigo_uo.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "aki_stage_creat": [
        [
          "mimiciv_derived.kdigo_creatinine.creat",
          "mimiciv_derived.kdigo_creatinine.creat_low_past_7day",
          "mimiciv_derived.kdigo_creatinine.creat_low_past_48hr"
        ],
        [
          "mimiciv_derived.kdigo_creatinine.stay_id",
          "mimiciv_derived.crrt.stay_id",
          "mimiciv_derived.crrt.crrt_mode",
          "mimiciv_derived.crrt.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.kdigo_uo.charttime",
          "mimiciv_derived.kdigo_creatinine.charttime",
          "mimiciv_derived.kdigo_uo.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "uo_rt_6hr": [
        ["mimiciv_derived.kdigo_uo.uo_rt_6hr"],
        [
          "mimiciv_derived.kdigo_creatinine.stay_id",
          "mimiciv_derived.crrt.stay_id",
          "mimiciv_derived.crrt.crrt_mode",
          "mimiciv_derived.crrt.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.kdigo_uo.charttime",
          "mimiciv_derived.kdigo_creatinine.charttime",
          "mimiciv_derived.kdigo_uo.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "uo_rt_12hr": [
        ["mimiciv_derived.kdigo_uo.uo_rt_12hr"],
        [
          "mimiciv_derived.kdigo_creatinine.stay_id",
          "mimiciv_derived.crrt.stay_id",
          "mimiciv_derived.crrt.crrt_mode",
          "mimiciv_derived.crrt.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.kdigo_uo.charttime",
          "mimiciv_derived.kdigo_creatinine.charttime",
          "mimiciv_derived.kdigo_uo.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "uo_rt_24hr": [
        ["mimiciv_derived.kdigo_uo.uo_rt_24hr"],
        [
          "mimiciv_derived.kdigo_creatinine.stay_id",
          "mimiciv_derived.crrt.stay_id",
          "mimiciv_derived.crrt.crrt_mode",
          "mimiciv_derived.crrt.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.kdigo_uo.charttime",
          "mimiciv_derived.kdigo_creatinine.charttime",
          "mimiciv_derived.kdigo_uo.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "aki_stage_uo": [
        [
          "mimiciv_derived.kdigo_uo.uo_rt_24hr",
          "mimiciv_derived.kdigo_uo.uo_tm_12hr",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.kdigo_uo.uo_tm_6hr",
          "mimiciv_derived.kdigo_uo.charttime",
          "mimiciv_derived.kdigo_uo.uo_rt_12hr",
          "mimiciv_derived.kdigo_uo.uo_rt_6hr",
          "mimiciv_derived.kdigo_uo.uo_tm_24hr"
        ],
        [
          "mimiciv_derived.kdigo_creatinine.stay_id",
          "mimiciv_derived.crrt.stay_id",
          "mimiciv_derived.crrt.crrt_mode",
          "mimiciv_derived.crrt.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.kdigo_uo.charttime",
          "mimiciv_derived.kdigo_creatinine.charttime",
          "mimiciv_derived.kdigo_uo.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "aki_stage_crrt": [
        ["mimiciv_derived.crrt.charttime"],
        [
          "mimiciv_derived.kdigo_creatinine.stay_id",
          "mimiciv_derived.crrt.stay_id",
          "mimiciv_derived.crrt.crrt_mode",
          "mimiciv_derived.crrt.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.kdigo_uo.charttime",
          "mimiciv_derived.kdigo_creatinine.charttime",
          "mimiciv_derived.kdigo_uo.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "aki_stage": [
        [
          "mimiciv_derived.kdigo_uo.uo_rt_24hr",
          "mimiciv_derived.kdigo_uo.uo_tm_12hr",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.kdigo_uo.uo_tm_6hr",
          "mimiciv_derived.kdigo_uo.charttime",
          "mimiciv_derived.kdigo_creatinine.creat_low_past_7day",
          "mimiciv_derived.crrt.charttime",
          "mimiciv_derived.kdigo_uo.uo_rt_6hr",
          "mimiciv_derived.kdigo_uo.uo_rt_12hr",
          "mimiciv_derived.kdigo_creatinine.creat",
          "mimiciv_derived.kdigo_creatinine.creat_low_past_48hr",
          "mimiciv_derived.kdigo_uo.uo_tm_24hr"
        ],
        [
          "mimiciv_derived.kdigo_creatinine.stay_id",
          "mimiciv_derived.crrt.stay_id",
          "mimiciv_derived.crrt.crrt_mode",
          "mimiciv_derived.crrt.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.kdigo_uo.charttime",
          "mimiciv_derived.kdigo_creatinine.charttime",
          "mimiciv_derived.kdigo_uo.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "aki_stage_smoothed": [
        [
          "mimiciv_derived.kdigo_uo.uo_rt_24hr",
          "mimiciv_derived.kdigo_uo.uo_tm_12hr",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.kdigo_uo.uo_tm_6hr",
          "mimiciv_derived.kdigo_uo.charttime",
          "mimiciv_derived.kdigo_creatinine.creat_low_past_7day",
          "mimiciv_derived.crrt.charttime",
          "mimiciv_derived.kdigo_creatinine.charttime",
          "mimiciv_derived.kdigo_uo.uo_rt_6hr",
          "mimiciv_derived.kdigo_uo.uo_rt_12hr",
          "mimiciv_derived.kdigo_creatinine.creat",
          "mimiciv_derived.kdigo_creatinine.creat_low_past_48hr",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.kdigo_uo.uo_tm_24hr"
        ],
        [
          "mimiciv_derived.kdigo_creatinine.stay_id",
          "mimiciv_derived.crrt.stay_id",
          "mimiciv_derived.crrt.crrt_mode",
          "mimiciv_derived.crrt.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.kdigo_uo.charttime",
          "mimiciv_derived.kdigo_creatinine.charttime",
          "mimiciv_derived.kdigo_uo.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ]
    },
    "table_name": "kdigo_stages",
    "sql": "WITH cr_stg AS ( SELECT cr.stay_id,cr.charttime,cr.creat_low_past_7day,cr.creat_low_past_48hr,cr.creat,CASE WHEN cr.creat >= (cr.creat_low_past_7day * 3.0) THEN 3 WHEN cr.creat >= 4 AND ( cr.creat_low_past_48hr <= 3.7 OR cr.creat >= ( 1.5 * cr.creat_low_past_7day ) ) THEN 3 WHEN cr.creat >= (cr.creat_low_past_7day * 2.0) THEN 2 WHEN cr.creat >= (cr.creat_low_past_48hr + 0.3) THEN 1 WHEN cr.creat >= (cr.creat_low_past_7day * 1.5) THEN 1 ELSE 0 END AS aki_stage_creat FROM mimiciv_derived.kdigo_creatinine cr ),uo_stg AS ( SELECT uo.stay_id,uo.charttime,uo.weight,uo.uo_rt_6hr,uo.uo_rt_12hr,uo.uo_rt_24hr,CASE WHEN uo.uo_rt_6hr IS NULL THEN NULL WHEN uo.charttime <= DATETIME_ADD(ie.intime,INTERVAL '6' HOUR) THEN 0 WHEN uo.uo_tm_24hr >= 24 AND uo.uo_rt_24hr < 0.3 THEN 3 WHEN uo.uo_tm_12hr >= 12 AND uo.uo_rt_12hr = 0 THEN 3 WHEN uo.uo_tm_12hr >= 12 AND uo.uo_rt_12hr < 0.5 THEN 2 WHEN uo.uo_tm_6hr >= 6 AND uo.uo_rt_6hr < 0.5 THEN 1 ELSE 0 END AS aki_stage_uo FROM mimiciv_derived.kdigo_uo uo INNER JOIN mimiciv_icu.icustays ie ON uo.stay_id = ie.stay_id ),crrt_stg AS ( SELECT stay_id,charttime,CASE WHEN charttime IS NOT NULL THEN 3 ELSE NULL END AS aki_stage_crrt FROM mimiciv_derived.crrt WHERE crrt_mode IS NOT NULL ),tm_stg AS ( SELECT stay_id,charttime FROM cr_stg UNION DISTINCT SELECT stay_id,charttime FROM uo_stg UNION DISTINCT SELECT stay_id,charttime FROM crrt_stg ) SELECT ie.subject_id,ie.hadm_id,ie.stay_id,tm.charttime,cr.creat_low_past_7day,cr.creat_low_past_48hr,cr.creat,cr.aki_stage_creat,uo.uo_rt_6hr,uo.uo_rt_12hr,uo.uo_rt_24hr,uo.aki_stage_uo,crrt.aki_stage_crrt,GREATEST( COALESCE(cr.aki_stage_creat,0),COALESCE(uo.aki_stage_uo,0),COALESCE(crrt.aki_stage_crrt,0) ) AS aki_stage,MAX( GREATEST( COALESCE(cr.aki_stage_creat,0),COALESCE(uo.aki_stage_uo,0),COALESCE(crrt.aki_stage_crrt,0) ) ) OVER ( PARTITION BY ie.subject_id ORDER BY DATETIME_DIFF(tm.charttime,ie.intime,'SECOND') RANGE BETWEEN 21600 PRECEDING AND CURRENT ROW ) AS aki_stage_smoothed FROM mimiciv_icu.icustays ie LEFT JOIN tm_stg tm ON ie.stay_id = tm.stay_id LEFT JOIN cr_stg cr ON ie.stay_id = cr.stay_id AND tm.charttime = cr.charttime LEFT JOIN uo_stg uo ON ie.stay_id = uo.stay_id AND tm.charttime = uo.charttime LEFT JOIN crrt_stg crrt ON ie.stay_id = crrt.stay_id AND tm.charttime = crrt.charttime"
  },
  "meld": {
    "tables": [
      "mimiciv_derived.first_day_lab",
      "mimiciv_derived.first_day_rrt",
      "mimiciv_icu.icustays"
    ],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.icustays.subject_id"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.first_day_rrt.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "hadm_id": [
        ["mimiciv_icu.icustays.hadm_id"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.first_day_rrt.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.first_day_rrt.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "meld_initial": [
        [
          "mimiciv_derived.first_day_lab.inr_max",
          "mimiciv_derived.first_day_rrt.dialysis_present",
          "mimiciv_derived.first_day_lab.bilirubin_total_max",
          "mimiciv_derived.first_day_lab.creatinine_max"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.first_day_rrt.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "meld": [
        [
          "mimiciv_derived.first_day_lab.sodium_min",
          "mimiciv_derived.first_day_lab.creatinine_max",
          "mimiciv_derived.first_day_lab.inr_max",
          "mimiciv_derived.first_day_lab.bilirubin_total_max",
          "mimiciv_derived.first_day_rrt.dialysis_present"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.first_day_rrt.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "rrt": [
        ["mimiciv_derived.first_day_rrt.dialysis_present"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.first_day_rrt.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "creatinine_max": [
        ["mimiciv_derived.first_day_lab.creatinine_max"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.first_day_rrt.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "bilirubin_total_max": [
        ["mimiciv_derived.first_day_lab.bilirubin_total_max"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.first_day_rrt.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "inr_max": [
        ["mimiciv_derived.first_day_lab.inr_max"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.first_day_rrt.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "sodium_min": [
        ["mimiciv_derived.first_day_lab.sodium_min"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.first_day_rrt.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ]
    },
    "table_name": "meld",
    "sql": "WITH cohort AS ( SELECT ie.subject_id,ie.hadm_id,ie.stay_id,ie.intime,ie.outtime,labs.creatinine_max,labs.bilirubin_total_max,labs.inr_max,labs.sodium_min,r.dialysis_present AS rrt FROM mimiciv_icu.icustays ie LEFT JOIN mimiciv_derived.first_day_lab labs ON ie.stay_id = labs.stay_id LEFT JOIN mimiciv_derived.first_day_rrt r ON ie.stay_id = r.stay_id ),score AS ( SELECT subject_id,hadm_id,stay_id,rrt,creatinine_max,bilirubin_total_max,inr_max,sodium_min,CASE WHEN sodium_min IS NULL THEN 0.0 WHEN sodium_min > 137 THEN 0.0 WHEN sodium_min < 125 THEN 12.0 ELSE 137.0 - sodium_min END AS sodium_score,CASE WHEN rrt = 1 OR creatinine_max > 4.0 THEN (0.957 * LN(4)) WHEN creatinine_max < 1 THEN (0.957 * LN(1)) ELSE 0.957 * COALESCE(LN(creatinine_max),LN(1)) END AS creatinine_score,CASE WHEN bilirubin_total_max < 1 THEN 0.378 * LN(1) ELSE 0.378 * COALESCE(LN(bilirubin_total_max),LN(1)) END AS bilirubin_score,CASE WHEN inr_max < 1 THEN (1.120 * LN(1) + 0.643) ELSE (1.120 * COALESCE(LN(inr_max),LN(1)) + 0.643) END AS inr_score FROM cohort ),score2 AS ( SELECT subject_id,hadm_id,stay_id,rrt,creatinine_max,bilirubin_total_max,inr_max,sodium_min,creatinine_score,sodium_score,bilirubin_score,inr_score,CASE WHEN (creatinine_score + bilirubin_score + inr_score) > 4 THEN 40.0 ELSE ROUND( CAST( creatinine_score + bilirubin_score + inr_score AS NUMERIC),1 ) * 10 END AS meld_initial FROM score ) SELECT subject_id,hadm_id,stay_id,meld_initial,CASE WHEN meld_initial > 11 THEN meld_initial + 1.32 * sodium_score - 0.033 * meld_initial * sodium_score ELSE meld_initial END AS meld,rrt,creatinine_max,bilirubin_total_max,inr_max,sodium_min FROM score2"
  },
  "apsiii": {
    "tables": [
      "mimiciv_hosp.diagnoses_icd",
      "mimiciv_hosp.patients",
      "mimiciv_hosp.admissions",
      "mimiciv_derived.first_day_lab",
      "mimiciv_icu.icustays",
      "mimiciv_derived.first_day_vitalsign",
      "mimiciv_derived.ventilation",
      "mimiciv_derived.first_day_urine_output",
      "mimiciv_derived.bg",
      "mimiciv_derived.first_day_gcs"
    ],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.icustays.subject_id"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.bg.ph",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.bg.fio2_chartevents",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.bg.fio2",
          "mimiciv_derived.bg.pco2",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "hadm_id": [
        ["mimiciv_icu.icustays.hadm_id"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.bg.ph",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.bg.fio2_chartevents",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.bg.fio2",
          "mimiciv_derived.bg.pco2",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.bg.ph",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.bg.fio2_chartevents",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.bg.fio2",
          "mimiciv_derived.bg.pco2",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "apsiii": [
        [
          "mimiciv_derived.first_day_lab.sodium_min",
          "mimiciv_derived.first_day_lab.glucose_min",
          "mimiciv_derived.first_day_lab.wbc_min",
          "mimiciv_derived.first_day_vitalsign.temperature_min",
          "mimiciv_derived.bg.ph",
          "mimiciv_derived.first_day_gcs.gcs_eyes",
          "mimiciv_derived.first_day_lab.albumin_min",
          "mimiciv_derived.first_day_vitalsign.heart_rate_max",
          "mimiciv_derived.first_day_lab.sodium_max",
          "mimiciv_derived.first_day_lab.hematocrit_min",
          "mimiciv_derived.first_day_gcs.gcs_verbal",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_lab.albumin_max",
          "mimiciv_derived.first_day_vitalsign.temperature_max",
          "mimiciv_derived.first_day_lab.creatinine_max",
          "mimiciv_derived.first_day_vitalsign.glucose_max",
          "mimiciv_derived.first_day_vitalsign.mbp_max",
          "mimiciv_derived.first_day_lab.creatinine_min",
          "mimiciv_derived.first_day_gcs.gcs_motor",
          "mimiciv_derived.first_day_vitalsign.resp_rate_min",
          "mimiciv_derived.first_day_vitalsign.mbp_min",
          "mimiciv_derived.first_day_lab.hematocrit_max",
          "mimiciv_derived.first_day_gcs.gcs_unable",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_derived.first_day_vitalsign.resp_rate_max",
          "mimiciv_derived.first_day_urine_output.urineoutput",
          "mimiciv_derived.first_day_vitalsign.heart_rate_min",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.first_day_lab.bun_max",
          "mimiciv_derived.first_day_vitalsign.glucose_min",
          "mimiciv_derived.first_day_lab.glucose_max",
          "mimiciv_derived.first_day_lab.wbc_max",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.first_day_lab.bilirubin_total_max",
          "mimiciv_derived.bg.pco2"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.bg.ph",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.bg.fio2_chartevents",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.bg.fio2",
          "mimiciv_derived.bg.pco2",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "apsiii_prob": [
        [
          "mimiciv_derived.first_day_lab.sodium_min",
          "mimiciv_derived.first_day_lab.glucose_min",
          "mimiciv_derived.first_day_lab.wbc_min",
          "mimiciv_derived.first_day_vitalsign.temperature_min",
          "mimiciv_derived.bg.ph",
          "mimiciv_derived.first_day_gcs.gcs_eyes",
          "mimiciv_derived.first_day_lab.albumin_min",
          "mimiciv_derived.first_day_vitalsign.heart_rate_max",
          "mimiciv_derived.first_day_lab.sodium_max",
          "mimiciv_derived.first_day_lab.hematocrit_min",
          "mimiciv_derived.first_day_gcs.gcs_verbal",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_lab.albumin_max",
          "mimiciv_derived.first_day_vitalsign.temperature_max",
          "mimiciv_derived.first_day_lab.creatinine_max",
          "mimiciv_derived.first_day_vitalsign.glucose_max",
          "mimiciv_derived.first_day_vitalsign.mbp_max",
          "mimiciv_derived.first_day_lab.creatinine_min",
          "mimiciv_derived.first_day_gcs.gcs_motor",
          "mimiciv_derived.first_day_vitalsign.resp_rate_min",
          "mimiciv_derived.first_day_vitalsign.mbp_min",
          "mimiciv_derived.first_day_lab.hematocrit_max",
          "mimiciv_derived.first_day_gcs.gcs_unable",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_derived.first_day_vitalsign.resp_rate_max",
          "mimiciv_derived.first_day_urine_output.urineoutput",
          "mimiciv_derived.first_day_vitalsign.heart_rate_min",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.first_day_lab.bun_max",
          "mimiciv_derived.first_day_vitalsign.glucose_min",
          "mimiciv_derived.first_day_lab.glucose_max",
          "mimiciv_derived.first_day_lab.wbc_max",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.first_day_lab.bilirubin_total_max",
          "mimiciv_derived.bg.pco2"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.bg.ph",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.bg.fio2_chartevents",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.bg.fio2",
          "mimiciv_derived.bg.pco2",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "hr_score": [
        [
          "mimiciv_derived.first_day_vitalsign.heart_rate_min",
          "mimiciv_derived.first_day_vitalsign.heart_rate_max"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.bg.ph",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.bg.fio2_chartevents",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.bg.fio2",
          "mimiciv_derived.bg.pco2",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "mbp_score": [
        [
          "mimiciv_derived.first_day_vitalsign.mbp_max",
          "mimiciv_derived.first_day_vitalsign.mbp_min"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.bg.ph",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.bg.fio2_chartevents",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.bg.fio2",
          "mimiciv_derived.bg.pco2",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "temp_score": [
        [
          "mimiciv_derived.first_day_vitalsign.temperature_max",
          "mimiciv_derived.first_day_vitalsign.temperature_min"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.bg.ph",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.bg.fio2_chartevents",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.bg.fio2",
          "mimiciv_derived.bg.pco2",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "resp_rate_score": [
        [
          "mimiciv_derived.first_day_vitalsign.resp_rate_max",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.resp_rate_min"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.bg.ph",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.bg.fio2_chartevents",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.bg.fio2",
          "mimiciv_derived.bg.pco2",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "pao2_aado2_score": [
        ["mimiciv_derived.bg.po2", "mimiciv_derived.bg.aado2"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.bg.ph",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.bg.fio2_chartevents",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.bg.fio2",
          "mimiciv_derived.bg.pco2",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "hematocrit_score": [
        [
          "mimiciv_derived.first_day_lab.hematocrit_max",
          "mimiciv_derived.first_day_lab.hematocrit_min"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.bg.ph",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.bg.fio2_chartevents",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.bg.fio2",
          "mimiciv_derived.bg.pco2",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "wbc_score": [
        [
          "mimiciv_derived.first_day_lab.wbc_min",
          "mimiciv_derived.first_day_lab.wbc_max"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.bg.ph",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.bg.fio2_chartevents",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.bg.fio2",
          "mimiciv_derived.bg.pco2",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "creatinine_score": [
        [
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_derived.first_day_lab.creatinine_max",
          "mimiciv_derived.first_day_urine_output.urineoutput",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.first_day_lab.creatinine_min"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.bg.ph",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.bg.fio2_chartevents",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.bg.fio2",
          "mimiciv_derived.bg.pco2",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "uo_score": [
        ["mimiciv_derived.first_day_urine_output.urineoutput"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.bg.ph",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.bg.fio2_chartevents",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.bg.fio2",
          "mimiciv_derived.bg.pco2",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "bun_score": [
        ["mimiciv_derived.first_day_lab.bun_max"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.bg.ph",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.bg.fio2_chartevents",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.bg.fio2",
          "mimiciv_derived.bg.pco2",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "sodium_score": [
        [
          "mimiciv_derived.first_day_lab.sodium_min",
          "mimiciv_derived.first_day_lab.sodium_max"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.bg.ph",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.bg.fio2_chartevents",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.bg.fio2",
          "mimiciv_derived.bg.pco2",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "albumin_score": [
        [
          "mimiciv_derived.first_day_lab.albumin_max",
          "mimiciv_derived.first_day_lab.albumin_min"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.bg.ph",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.bg.fio2_chartevents",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.bg.fio2",
          "mimiciv_derived.bg.pco2",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "bilirubin_score": [
        ["mimiciv_derived.first_day_lab.bilirubin_total_max"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.bg.ph",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.bg.fio2_chartevents",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.bg.fio2",
          "mimiciv_derived.bg.pco2",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "glucose_score": [
        [
          "mimiciv_derived.first_day_lab.glucose_max",
          "mimiciv_derived.first_day_lab.glucose_min",
          "mimiciv_derived.first_day_vitalsign.glucose_min",
          "mimiciv_derived.first_day_vitalsign.glucose_max"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.bg.ph",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.bg.fio2_chartevents",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.bg.fio2",
          "mimiciv_derived.bg.pco2",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "acidbase_score": [
        ["mimiciv_derived.bg.pco2", "mimiciv_derived.bg.ph"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.bg.ph",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.bg.fio2_chartevents",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.bg.fio2",
          "mimiciv_derived.bg.pco2",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "gcs_score": [
        [
          "mimiciv_derived.first_day_gcs.gcs_eyes",
          "mimiciv_derived.first_day_gcs.gcs_unable",
          "mimiciv_derived.first_day_gcs.gcs_motor",
          "mimiciv_derived.first_day_gcs.gcs_verbal"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.bg.ph",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_derived.bg.fio2_chartevents",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.aado2",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.bg.po2",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.bg.fio2",
          "mimiciv_derived.bg.pco2",
          "mimiciv_icu.icustays.subject_id"
        ]
      ]
    },
    "table_name": "apsiii",
    "sql": "WITH pa AS ( SELECT ie.stay_id,bg.charttime,po2 AS pao2,ROW_NUMBER() OVER (PARTITION BY ie.stay_id ORDER BY bg.po2 DESC) AS rn FROM mimiciv_derived.bg bg INNER JOIN mimiciv_icu.icustays ie ON bg.hadm_id = ie.hadm_id AND bg.charttime >= ie.intime AND bg.charttime < ie.outtime LEFT JOIN mimiciv_derived.ventilation vd ON ie.stay_id = vd.stay_id AND bg.charttime >= vd.starttime AND bg.charttime <= vd.endtime AND vd.ventilation_status = 'InvasiveVent' WHERE vd.stay_id IS NULL AND COALESCE(fio2,fio2_chartevents,21) < 50 AND bg.po2 IS NOT NULL AND bg.specimen = 'ART.' ),aa AS ( SELECT ie.stay_id,bg.charttime,bg.aado2,ROW_NUMBER() OVER ( PARTITION BY ie.stay_id ORDER BY bg.aado2 DESC ) AS rn FROM mimiciv_derived.bg bg INNER JOIN mimiciv_icu.icustays ie ON bg.hadm_id = ie.hadm_id AND bg.charttime >= ie.intime AND bg.charttime < ie.outtime INNER JOIN mimiciv_derived.ventilation vd ON ie.stay_id = vd.stay_id AND bg.charttime >= vd.starttime AND bg.charttime <= vd.endtime AND vd.ventilation_status = 'InvasiveVent' WHERE vd.stay_id IS NOT NULL AND COALESCE(fio2,fio2_chartevents) >= 50 AND bg.aado2 IS NOT NULL AND bg.specimen = 'ART.' ),acidbase AS ( SELECT ie.stay_id,ph,pco2 AS paco2,CASE WHEN ph IS NULL OR pco2 IS NULL THEN null WHEN ph < 7.20 THEN CASE WHEN pco2 < 50 THEN 12 ELSE 4 END WHEN ph < 7.30 THEN CASE WHEN pco2 < 30 THEN 9 WHEN pco2 < 40 THEN 6 WHEN pco2 < 50 THEN 3 ELSE 2 END WHEN ph < 7.35 THEN CASE WHEN pco2 < 30 THEN 9 WHEN pco2 < 45 THEN 0 ELSE 1 END WHEN ph < 7.45 THEN CASE WHEN pco2 < 30 THEN 5 WHEN pco2 < 45 THEN 0 ELSE 1 END WHEN ph < 7.50 THEN CASE WHEN pco2 < 30 THEN 5 WHEN pco2 < 35 THEN 0 WHEN pco2 < 45 THEN 2 ELSE 12 END WHEN ph < 7.60 THEN CASE WHEN pco2 < 40 THEN 3 ELSE 12 END ELSE CASE WHEN pco2 < 25 THEN 0 WHEN pco2 < 40 THEN 3 ELSE 12 END END AS acidbase_score FROM mimiciv_derived.bg bg INNER JOIN mimiciv_icu.icustays ie ON bg.hadm_id = ie.hadm_id AND bg.charttime >= ie.intime AND bg.charttime < ie.outtime WHERE ph IS NOT NULL AND pco2 IS NOT NULL AND bg.specimen = 'ART.' ),acidbase_max AS ( SELECT stay_id,acidbase_score,ph,paco2,ROW_NUMBER() OVER ( PARTITION BY stay_id ORDER BY acidbase_score DESC ) AS acidbase_rn FROM acidbase ),arf AS ( SELECT ie.stay_id,CASE WHEN labs.creatinine_max >= 1.5 AND uo.urineoutput < 410 AND icd.ckd = 0 THEN 1 ELSE 0 END AS arf FROM mimiciv_icu.icustays ie LEFT JOIN mimiciv_derived.first_day_urine_output uo ON ie.stay_id = uo.stay_id LEFT JOIN mimiciv_derived.first_day_lab labs ON ie.stay_id = labs.stay_id LEFT JOIN ( SELECT hadm_id,MAX(CASE WHEN icd_version = 9 AND SUBSTR( icd_code,1,4 ) IN ('5854','5855','5856') THEN 1 WHEN icd_version = 10 AND SUBSTR( icd_code,1,4 ) IN ('N184','N185','N186') THEN 1 ELSE 0 END) AS ckd FROM mimiciv_hosp.diagnoses_icd GROUP BY hadm_id ) icd ON ie.hadm_id = icd.hadm_id ),vent AS ( SELECT ie.stay_id,MAX( CASE WHEN v.stay_id IS NOT NULL THEN 1 ELSE 0 END ) AS vent FROM mimiciv_icu.icustays ie LEFT JOIN mimiciv_derived.ventilation v ON ie.stay_id = v.stay_id AND v.ventilation_status = 'InvasiveVent' AND ( ( v.starttime >= ie.intime AND v.starttime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) ) OR ( v.endtime >= ie.intime AND v.endtime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) ) OR ( v.starttime <= ie.intime AND v.endtime >= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) ) ) GROUP BY ie.stay_id ),cohort AS ( SELECT ie.subject_id,ie.hadm_id,ie.stay_id,ie.intime,ie.outtime,vital.heart_rate_min,vital.heart_rate_max,vital.mbp_min,vital.mbp_max,vital.temperature_min,vital.temperature_max,vital.resp_rate_min,vital.resp_rate_max,pa.pao2,aa.aado2,ab.ph,ab.paco2,ab.acidbase_score,labs.hematocrit_min,labs.hematocrit_max,labs.wbc_min,labs.wbc_max,labs.creatinine_min,labs.creatinine_max,labs.bun_min,labs.bun_max,labs.sodium_min,labs.sodium_max,labs.albumin_min,labs.albumin_max,labs.bilirubin_total_min AS bilirubin_min,labs.bilirubin_total_max AS bilirubin_max,CASE WHEN labs.glucose_max IS NULL AND vital.glucose_max IS NULL THEN null WHEN labs.glucose_max IS NULL OR vital.glucose_max > labs.glucose_max THEN vital.glucose_max WHEN vital.glucose_max IS NULL OR labs.glucose_max > vital.glucose_max THEN labs.glucose_max ELSE labs.glucose_max END AS glucose_max,CASE WHEN labs.glucose_min IS NULL AND vital.glucose_min IS NULL THEN null WHEN labs.glucose_min IS NULL OR vital.glucose_min < labs.glucose_min THEN vital.glucose_min WHEN vital.glucose_min IS NULL OR labs.glucose_min < vital.glucose_min THEN labs.glucose_min ELSE labs.glucose_min END AS glucose_min,vent.vent,uo.urineoutput,gcs.gcs_min AS mingcs,gcs.gcs_motor,gcs.gcs_verbal,gcs.gcs_eyes,gcs.gcs_unable,arf.arf AS arf FROM mimiciv_icu.icustays ie INNER JOIN mimiciv_hosp.admissions adm ON ie.hadm_id = adm.hadm_id INNER JOIN mimiciv_hosp.patients pat ON ie.subject_id = pat.subject_id LEFT JOIN pa ON ie.stay_id = pa.stay_id AND pa.rn = 1 LEFT JOIN aa ON ie.stay_id = aa.stay_id AND aa.rn = 1 LEFT JOIN acidbase_max ab ON ie.stay_id = ab.stay_id AND ab.acidbase_rn = 1 LEFT JOIN arf ON ie.stay_id = arf.stay_id LEFT JOIN vent ON ie.stay_id = vent.stay_id LEFT JOIN mimiciv_derived.first_day_gcs gcs ON ie.stay_id = gcs.stay_id LEFT JOIN mimiciv_derived.first_day_vitalsign vital ON ie.stay_id = vital.stay_id LEFT JOIN mimiciv_derived.first_day_urine_output uo ON ie.stay_id = uo.stay_id LEFT JOIN mimiciv_derived.first_day_lab labs ON ie.stay_id = labs.stay_id ),score_min AS ( SELECT cohort.subject_id,cohort.hadm_id,cohort.stay_id,CASE WHEN heart_rate_min IS NULL THEN null WHEN heart_rate_min < 40 THEN 8 WHEN heart_rate_min < 50 THEN 5 WHEN heart_rate_min < 100 THEN 0 WHEN heart_rate_min < 110 THEN 1 WHEN heart_rate_min < 120 THEN 5 WHEN heart_rate_min < 140 THEN 7 WHEN heart_rate_min < 155 THEN 13 WHEN heart_rate_min >= 155 THEN 17 END AS hr_score,CASE WHEN mbp_min IS NULL THEN null WHEN mbp_min < 40 THEN 23 WHEN mbp_min < 60 THEN 15 WHEN mbp_min < 70 THEN 7 WHEN mbp_min < 80 THEN 6 WHEN mbp_min < 100 THEN 0 WHEN mbp_min < 120 THEN 4 WHEN mbp_min < 130 THEN 7 WHEN mbp_min < 140 THEN 9 WHEN mbp_min >= 140 THEN 10 END AS mbp_score,CASE WHEN temperature_min IS NULL THEN null WHEN temperature_min < 33.0 THEN 20 WHEN temperature_min < 33.5 THEN 16 WHEN temperature_min < 34.0 THEN 13 WHEN temperature_min < 35.0 THEN 8 WHEN temperature_min < 36.0 THEN 2 WHEN temperature_min < 40.0 THEN 0 WHEN temperature_min >= 40.0 THEN 4 END AS temp_score,CASE WHEN resp_rate_min IS NULL THEN null WHEN vent = 1 AND resp_rate_min < 14 THEN 0 WHEN resp_rate_min < 6 THEN 17 WHEN resp_rate_min < 12 THEN 8 WHEN resp_rate_min < 14 THEN 7 WHEN resp_rate_min < 25 THEN 0 WHEN resp_rate_min < 35 THEN 6 WHEN resp_rate_min < 40 THEN 9 WHEN resp_rate_min < 50 THEN 11 WHEN resp_rate_min >= 50 THEN 18 END AS resp_rate_score,CASE WHEN hematocrit_min IS NULL THEN null WHEN hematocrit_min < 41.0 THEN 3 WHEN hematocrit_min < 50.0 THEN 0 WHEN hematocrit_min >= 50.0 THEN 3 END AS hematocrit_score,CASE WHEN wbc_min IS NULL THEN null WHEN wbc_min < 1.0 THEN 19 WHEN wbc_min < 3.0 THEN 5 WHEN wbc_min < 20.0 THEN 0 WHEN wbc_min < 25.0 THEN 1 WHEN wbc_min >= 25.0 THEN 5 END AS wbc_score,CASE WHEN creatinine_min IS NULL THEN null WHEN arf = 1 AND creatinine_min < 1.5 THEN 0 WHEN arf = 1 AND creatinine_min >= 1.5 THEN 10 WHEN creatinine_min < 0.5 THEN 3 WHEN creatinine_min < 1.5 THEN 0 WHEN creatinine_min < 1.95 THEN 4 WHEN creatinine_min >= 1.95 THEN 7 END AS creatinine_score,CASE WHEN bun_min IS NULL THEN null WHEN bun_min < 17.0 THEN 0 WHEN bun_min < 20.0 THEN 2 WHEN bun_min < 40.0 THEN 7 WHEN bun_min < 80.0 THEN 11 WHEN bun_min >= 80.0 THEN 12 END AS bun_score,CASE WHEN sodium_min IS NULL THEN null WHEN sodium_min < 120 THEN 3 WHEN sodium_min < 135 THEN 2 WHEN sodium_min < 155 THEN 0 WHEN sodium_min >= 155 THEN 4 END AS sodium_score,CASE WHEN albumin_min IS NULL THEN null WHEN albumin_min < 2.0 THEN 11 WHEN albumin_min < 2.5 THEN 6 WHEN albumin_min < 4.5 THEN 0 WHEN albumin_min >= 4.5 THEN 4 END AS albumin_score,CASE WHEN bilirubin_min IS NULL THEN null WHEN bilirubin_min < 2.0 THEN 0 WHEN bilirubin_min < 3.0 THEN 5 WHEN bilirubin_min < 5.0 THEN 6 WHEN bilirubin_min < 8.0 THEN 8 WHEN bilirubin_min >= 8.0 THEN 16 END AS bilirubin_score,CASE WHEN glucose_min IS NULL THEN null WHEN glucose_min < 40 THEN 8 WHEN glucose_min < 60 THEN 9 WHEN glucose_min < 200 THEN 0 WHEN glucose_min < 350 THEN 3 WHEN glucose_min >= 350 THEN 5 END AS glucose_score FROM cohort ),score_max AS ( SELECT cohort.subject_id,cohort.hadm_id,cohort.stay_id,CASE WHEN heart_rate_max IS NULL THEN null WHEN heart_rate_max < 40 THEN 8 WHEN heart_rate_max < 50 THEN 5 WHEN heart_rate_max < 100 THEN 0 WHEN heart_rate_max < 110 THEN 1 WHEN heart_rate_max < 120 THEN 5 WHEN heart_rate_max < 140 THEN 7 WHEN heart_rate_max < 155 THEN 13 WHEN heart_rate_max >= 155 THEN 17 END AS hr_score,CASE WHEN mbp_max IS NULL THEN null WHEN mbp_max < 40 THEN 23 WHEN mbp_max < 60 THEN 15 WHEN mbp_max < 70 THEN 7 WHEN mbp_max < 80 THEN 6 WHEN mbp_max < 100 THEN 0 WHEN mbp_max < 120 THEN 4 WHEN mbp_max < 130 THEN 7 WHEN mbp_max < 140 THEN 9 WHEN mbp_max >= 140 THEN 10 END AS mbp_score,CASE WHEN temperature_max IS NULL THEN null WHEN temperature_max < 33.0 THEN 20 WHEN temperature_max < 33.5 THEN 16 WHEN temperature_max < 34.0 THEN 13 WHEN temperature_max < 35.0 THEN 8 WHEN temperature_max < 36.0 THEN 2 WHEN temperature_max < 40.0 THEN 0 WHEN temperature_max >= 40.0 THEN 4 END AS temp_score,CASE WHEN resp_rate_max IS NULL THEN null WHEN vent = 1 AND resp_rate_max < 14 THEN 0 WHEN resp_rate_max < 6 THEN 17 WHEN resp_rate_max < 12 THEN 8 WHEN resp_rate_max < 14 THEN 7 WHEN resp_rate_max < 25 THEN 0 WHEN resp_rate_max < 35 THEN 6 WHEN resp_rate_max < 40 THEN 9 WHEN resp_rate_max < 50 THEN 11 WHEN resp_rate_max >= 50 THEN 18 END AS resp_rate_score,CASE WHEN hematocrit_max IS NULL THEN null WHEN hematocrit_max < 41.0 THEN 3 WHEN hematocrit_max < 50.0 THEN 0 WHEN hematocrit_max >= 50.0 THEN 3 END AS hematocrit_score,CASE WHEN wbc_max IS NULL THEN null WHEN wbc_max < 1.0 THEN 19 WHEN wbc_max < 3.0 THEN 5 WHEN wbc_max < 20.0 THEN 0 WHEN wbc_max < 25.0 THEN 1 WHEN wbc_max >= 25.0 THEN 5 END AS wbc_score,CASE WHEN creatinine_max IS NULL THEN null WHEN arf = 1 AND creatinine_max < 1.5 THEN 0 WHEN arf = 1 AND creatinine_max >= 1.5 THEN 10 WHEN creatinine_max < 0.5 THEN 3 WHEN creatinine_max < 1.5 THEN 0 WHEN creatinine_max < 1.95 THEN 4 WHEN creatinine_max >= 1.95 THEN 7 END AS creatinine_score,CASE WHEN bun_max IS NULL THEN null WHEN bun_max < 17.0 THEN 0 WHEN bun_max < 20.0 THEN 2 WHEN bun_max < 40.0 THEN 7 WHEN bun_max < 80.0 THEN 11 WHEN bun_max >= 80.0 THEN 12 END AS bun_score,CASE WHEN sodium_max IS NULL THEN null WHEN sodium_max < 120 THEN 3 WHEN sodium_max < 135 THEN 2 WHEN sodium_max < 155 THEN 0 WHEN sodium_max >= 155 THEN 4 END AS sodium_score,CASE WHEN albumin_max IS NULL THEN null WHEN albumin_max < 2.0 THEN 11 WHEN albumin_max < 2.5 THEN 6 WHEN albumin_max < 4.5 THEN 0 WHEN albumin_max >= 4.5 THEN 4 END AS albumin_score,CASE WHEN bilirubin_max IS NULL THEN null WHEN bilirubin_max < 2.0 THEN 0 WHEN bilirubin_max < 3.0 THEN 5 WHEN bilirubin_max < 5.0 THEN 6 WHEN bilirubin_max < 8.0 THEN 8 WHEN bilirubin_max >= 8.0 THEN 16 END AS bilirubin_score,CASE WHEN glucose_max IS NULL THEN null WHEN glucose_max < 40 THEN 8 WHEN glucose_max < 60 THEN 9 WHEN glucose_max < 200 THEN 0 WHEN glucose_max < 350 THEN 3 WHEN glucose_max >= 350 THEN 5 END AS glucose_score FROM cohort ),scorecomp AS ( SELECT co.*,CASE WHEN heart_rate_max IS NULL THEN null WHEN ABS(heart_rate_max - 75) > ABS(heart_rate_min - 75) THEN smax.hr_score WHEN ABS(heart_rate_max - 75) < ABS(heart_rate_min - 75) THEN smin.hr_score WHEN ABS(heart_rate_max - 75) = ABS(heart_rate_min - 75) AND smax.hr_score >= smin.hr_score THEN smax.hr_score WHEN ABS(heart_rate_max - 75) = ABS(heart_rate_min - 75) AND smax.hr_score < smin.hr_score THEN smin.hr_score END AS hr_score,CASE WHEN mbp_max IS NULL THEN null WHEN ABS(mbp_max - 90) > ABS(mbp_min - 90) THEN smax.mbp_score WHEN ABS(mbp_max - 90) < ABS(mbp_min - 90) THEN smin.mbp_score WHEN ABS(mbp_max - 90) = ABS(mbp_min - 90) AND smax.mbp_score >= smin.mbp_score THEN smax.mbp_score WHEN ABS(mbp_max - 90) = ABS(mbp_min - 90) AND smax.mbp_score < smin.mbp_score THEN smin.mbp_score END AS mbp_score,CASE WHEN temperature_max IS NULL THEN null WHEN ABS(temperature_max - 38) > ABS(temperature_min - 38) THEN smax.temp_score WHEN ABS(temperature_max - 38) < ABS(temperature_min - 38) THEN smin.temp_score WHEN ABS(temperature_max - 38) = ABS(temperature_min - 38) AND smax.temp_score >= smin.temp_score THEN smax.temp_score WHEN ABS(temperature_max - 38) = ABS(temperature_min - 38) AND smax.temp_score < smin.temp_score THEN smin.temp_score END AS temp_score,CASE WHEN resp_rate_max IS NULL THEN null WHEN ABS(resp_rate_max - 19) > ABS(resp_rate_min - 19) THEN smax.resp_rate_score WHEN ABS(resp_rate_max - 19) < ABS(resp_rate_min - 19) THEN smin.resp_rate_score WHEN ABS(resp_rate_max - 19) = ABS(resp_rate_max - 19) AND smax.resp_rate_score >= smin.resp_rate_score THEN smax.resp_rate_score WHEN ABS(resp_rate_max - 19) = ABS(resp_rate_max - 19) AND smax.resp_rate_score < smin.resp_rate_score THEN smin.resp_rate_score END AS resp_rate_score,CASE WHEN hematocrit_max IS NULL THEN null WHEN ABS(hematocrit_max - 45.5) > ABS(hematocrit_min - 45.5) THEN smax.hematocrit_score WHEN ABS(hematocrit_max - 45.5) < ABS(hematocrit_min - 45.5) THEN smin.hematocrit_score WHEN ABS(hematocrit_max - 45.5) = ABS(hematocrit_max - 45.5) AND smax.hematocrit_score >= smin.hematocrit_score THEN smax.hematocrit_score WHEN ABS(hematocrit_max - 45.5) = ABS(hematocrit_max - 45.5) AND smax.hematocrit_score < smin.hematocrit_score THEN smin.hematocrit_score END AS hematocrit_score,CASE WHEN wbc_max IS NULL THEN null WHEN ABS(wbc_max - 11.5) > ABS(wbc_min - 11.5) THEN smax.wbc_score WHEN ABS(wbc_max - 11.5) < ABS(wbc_min - 11.5) THEN smin.wbc_score WHEN ABS(wbc_max - 11.5) = ABS(wbc_max - 11.5) AND smax.wbc_score >= smin.wbc_score THEN smax.wbc_score WHEN ABS(wbc_max - 11.5) = ABS(wbc_max - 11.5) AND smax.wbc_score < smin.wbc_score THEN smin.wbc_score END AS wbc_score,CASE WHEN creatinine_max IS NULL THEN null WHEN arf = 1 THEN smax.creatinine_score WHEN ABS(creatinine_max - 1) > ABS(creatinine_min - 1) THEN smax.creatinine_score WHEN ABS(creatinine_max - 1) < ABS(creatinine_min - 1) THEN smin.creatinine_score WHEN smax.creatinine_score >= smin.creatinine_score THEN smax.creatinine_score WHEN smax.creatinine_score < smin.creatinine_score THEN smin.creatinine_score END AS creatinine_score,CASE WHEN bun_max IS NULL THEN null ELSE smax.bun_score END AS bun_score,CASE WHEN sodium_max IS NULL THEN null WHEN ABS(sodium_max - 145.5) > ABS(sodium_min - 145.5) THEN smax.sodium_score WHEN ABS(sodium_max - 145.5) < ABS(sodium_min - 145.5) THEN smin.sodium_score WHEN ABS(sodium_max - 145.5) = ABS(sodium_max - 145.5) AND smax.sodium_score >= smin.sodium_score THEN smax.sodium_score WHEN ABS(sodium_max - 145.5) = ABS(sodium_max - 145.5) AND smax.sodium_score < smin.sodium_score THEN smin.sodium_score END AS sodium_score,CASE WHEN albumin_max IS NULL THEN null WHEN ABS(albumin_max - 3.5) > ABS(albumin_min - 3.5) THEN smax.albumin_score WHEN ABS(albumin_max - 3.5) < ABS(albumin_min - 3.5) THEN smin.albumin_score WHEN ABS(albumin_max - 3.5) = ABS(albumin_max - 3.5) AND smax.albumin_score >= smin.albumin_score THEN smax.albumin_score WHEN ABS(albumin_max - 3.5) = ABS(albumin_max - 3.5) AND smax.albumin_score < smin.albumin_score THEN smin.albumin_score END AS albumin_score,CASE WHEN bilirubin_max IS NULL THEN null ELSE smax.bilirubin_score END AS bilirubin_score,CASE WHEN glucose_max IS NULL THEN null WHEN ABS(glucose_max - 130) > ABS(glucose_min - 130) THEN smax.glucose_score WHEN ABS(glucose_max - 130) < ABS(glucose_min - 130) THEN smin.glucose_score WHEN ABS(glucose_max - 130) = ABS(glucose_max - 130) AND smax.glucose_score >= smin.glucose_score THEN smax.glucose_score WHEN ABS(glucose_max - 130) = ABS(glucose_max - 130) AND smax.glucose_score < smin.glucose_score THEN smin.glucose_score END AS glucose_score,CASE WHEN urineoutput IS NULL THEN null WHEN urineoutput < 400 THEN 15 WHEN urineoutput < 600 THEN 8 WHEN urineoutput < 900 THEN 7 WHEN urineoutput < 1500 THEN 5 WHEN urineoutput < 2000 THEN 4 WHEN urineoutput < 4000 THEN 0 WHEN urineoutput >= 4000 THEN 1 END AS uo_score,CASE WHEN gcs_unable = 1 THEN 0 WHEN gcs_eyes = 1 THEN CASE WHEN gcs_verbal = 1 AND gcs_motor IN (1,2) THEN 48 WHEN gcs_verbal = 1 AND gcs_motor IN (3,4) THEN 33 WHEN gcs_verbal = 1 AND gcs_motor IN (5,6) THEN 16 WHEN gcs_verbal IN (2,3) AND gcs_motor IN (1,2) THEN 29 WHEN gcs_verbal IN (2,3) AND gcs_motor IN (3,4) THEN 24 WHEN gcs_verbal IN (2,3) AND gcs_motor >= 5 THEN null WHEN gcs_verbal >= 4 THEN null END WHEN gcs_eyes > 1 THEN CASE WHEN gcs_verbal = 1 AND gcs_motor IN (1,2) THEN 29 WHEN gcs_verbal = 1 AND gcs_motor IN (3,4) THEN 24 WHEN gcs_verbal = 1 AND gcs_motor IN (5,6) THEN 15 WHEN gcs_verbal IN (2,3) AND gcs_motor IN (1,2) THEN 29 WHEN gcs_verbal IN (2,3) AND gcs_motor IN (3,4) THEN 24 WHEN gcs_verbal IN (2,3) AND gcs_motor = 5 THEN 13 WHEN gcs_verbal IN (2,3) AND gcs_motor = 6 THEN 10 WHEN gcs_verbal = 4 AND gcs_motor IN (1,2,3,4) THEN 13 WHEN gcs_verbal = 4 AND gcs_motor = 5 THEN 8 WHEN gcs_verbal = 4 AND gcs_motor = 6 THEN 3 WHEN gcs_verbal = 5 AND gcs_motor IN (1,2,3,4,5) THEN 3 WHEN gcs_verbal = 5 AND gcs_motor = 6 THEN 0 END ELSE null END AS gcs_score,CASE WHEN pao2 IS NULL AND aado2 IS NULL THEN null WHEN pao2 IS NOT NULL THEN CASE WHEN pao2 < 50 THEN 15 WHEN pao2 < 70 THEN 5 WHEN pao2 < 80 THEN 2 ELSE 0 END WHEN aado2 IS NOT NULL THEN CASE WHEN aado2 < 100 THEN 0 WHEN aado2 < 250 THEN 7 WHEN aado2 < 350 THEN 9 WHEN aado2 < 500 THEN 11 WHEN aado2 >= 500 THEN 14 ELSE 0 END END AS pao2_aado2_score FROM cohort co LEFT JOIN score_min smin ON co.stay_id = smin.stay_id LEFT JOIN score_max smax ON co.stay_id = smax.stay_id ),score AS ( SELECT s.*,COALESCE(hr_score,0) + COALESCE(mbp_score,0) + COALESCE(temp_score,0) + COALESCE(resp_rate_score,0) + COALESCE(pao2_aado2_score,0) + COALESCE(hematocrit_score,0) + COALESCE(wbc_score,0) + COALESCE(creatinine_score,0) + COALESCE(uo_score,0) + COALESCE(bun_score,0) + COALESCE(sodium_score,0) + COALESCE(albumin_score,0) + COALESCE(bilirubin_score,0) + COALESCE(glucose_score,0) + COALESCE(acidbase_score,0) + COALESCE(gcs_score,0) AS apsiii FROM scorecomp s ) SELECT ie.subject_id,ie.hadm_id,ie.stay_id,apsiii,1 / (1 + EXP(- (-4.4360 + 0.04726 * (apsiii)))) AS apsiii_prob,hr_score,mbp_score,temp_score,resp_rate_score,pao2_aado2_score,hematocrit_score,wbc_score,creatinine_score,uo_score,bun_score,sodium_score,albumin_score,bilirubin_score,glucose_score,acidbase_score,gcs_score FROM mimiciv_icu.icustays ie LEFT JOIN score s ON ie.stay_id = s.stay_id"
  },
  "lods": {
    "tables": [
      "mimiciv_hosp.admissions",
      "mimiciv_derived.first_day_lab",
      "mimiciv_icu.icustays",
      "mimiciv_derived.first_day_vitalsign",
      "mimiciv_derived.ventilation",
      "mimiciv_derived.first_day_urine_output",
      "mimiciv_hosp.patients",
      "mimiciv_derived.bg",
      "mimiciv_derived.first_day_gcs",
      "mimiciv_icu.chartevents"
    ],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.icustays.subject_id"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "itemid",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "hadm_id": [
        ["mimiciv_icu.icustays.hadm_id"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "itemid",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "itemid",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "lods": [
        [
          "mimiciv_derived.first_day_lab.wbc_min",
          "mimiciv_derived.first_day_vitalsign.sbp_max",
          "mimiciv_derived.first_day_gcs.gcs_min",
          "mimiciv_derived.first_day_lab.creatinine_max",
          "mimiciv_derived.first_day_lab.wbc_max",
          "mimiciv_derived.first_day_lab.pt_max",
          "mimiciv_derived.first_day_urine_output.urineoutput",
          "mimiciv_derived.first_day_lab.pt_min",
          "mimiciv_derived.first_day_vitalsign.heart_rate_min",
          "mimiciv_derived.first_day_vitalsign.sbp_min",
          "mimiciv_derived.first_day_vitalsign.heart_rate_max",
          "mimiciv_derived.first_day_lab.platelets_min",
          "mimiciv_derived.first_day_lab.bilirubin_total_max",
          "mimiciv_derived.first_day_lab.bun_max",
          "mimiciv_derived.bg.pao2fio2ratio"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "itemid",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "neurologic": [
        ["mimiciv_derived.first_day_gcs.gcs_min"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "itemid",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "cardiovascular": [
        [
          "mimiciv_derived.first_day_vitalsign.heart_rate_min",
          "mimiciv_derived.first_day_vitalsign.sbp_min",
          "mimiciv_derived.first_day_vitalsign.heart_rate_max",
          "mimiciv_derived.first_day_vitalsign.sbp_max"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "itemid",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "renal": [
        [
          "mimiciv_derived.first_day_lab.bun_max",
          "mimiciv_derived.first_day_lab.creatinine_max",
          "mimiciv_derived.first_day_urine_output.urineoutput"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "itemid",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "pulmonary": [
        ["mimiciv_derived.bg.pao2fio2ratio"],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "itemid",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "hematologic": [
        [
          "mimiciv_derived.first_day_lab.wbc_min",
          "mimiciv_derived.first_day_lab.wbc_max",
          "mimiciv_derived.first_day_lab.platelets_min"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "itemid",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "hepatic": [
        [
          "mimiciv_derived.first_day_lab.bilirubin_total_max",
          "mimiciv_derived.first_day_lab.pt_min",
          "mimiciv_derived.first_day_lab.pt_max"
        ],
        [
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "itemid",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.bg.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.icustays.subject_id"
        ]
      ]
    },
    "table_name": "lods",
    "sql": "WITH cpap AS ( SELECT ie.stay_id,MIN(DATETIME_SUB(charttime,INTERVAL '1' HOUR)) AS starttime,MAX(DATETIME_ADD(charttime,INTERVAL '4' HOUR)) AS endtime,MAX(CASE WHEN LOWER(ce.value) LIKE '%cpap%' THEN 1 WHEN LOWER(ce.value) LIKE '%bipap mask%' THEN 1 ELSE 0 END) AS cpap FROM mimiciv_icu.icustays ie INNER JOIN mimiciv_icu.chartevents ce ON ie.stay_id = ce.stay_id AND ce.charttime >= ie.intime AND ce.charttime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) WHERE itemid = 226732 AND ( LOWER(ce.value) LIKE '%cpap%' OR LOWER(ce.value) LIKE '%bipap mask%' ) GROUP BY ie.stay_id ),pafi1 AS ( SELECT ie.stay_id,bg.charttime,pao2fio2ratio,CASE WHEN vd.stay_id IS NOT NULL THEN 1 ELSE 0 END AS vent,CASE WHEN cp.stay_id IS NOT NULL THEN 1 ELSE 0 END AS cpap FROM mimiciv_derived.bg bg INNER JOIN mimiciv_icu.icustays ie ON bg.hadm_id = ie.hadm_id AND bg.charttime >= ie.intime AND bg.charttime < ie.outtime LEFT JOIN mimiciv_derived.ventilation vd ON ie.stay_id = vd.stay_id AND bg.charttime >= vd.starttime AND bg.charttime <= vd.endtime AND vd.ventilation_status = 'InvasiveVent' LEFT JOIN cpap cp ON ie.stay_id = cp.stay_id AND bg.charttime >= cp.starttime AND bg.charttime <= cp.endtime ),pafi2 AS ( SELECT stay_id,MIN(pao2fio2ratio) AS pao2fio2_vent_min FROM pafi1 WHERE vent = 1 OR cpap = 1 GROUP BY stay_id ),cohort AS ( SELECT ie.subject_id,ie.hadm_id,ie.stay_id,ie.intime,ie.outtime,gcs.gcs_min,vital.heart_rate_max,vital.heart_rate_min,vital.sbp_max,vital.sbp_min,pf.pao2fio2_vent_min,labs.bun_max,labs.bun_min,labs.wbc_max,labs.wbc_min,labs.bilirubin_total_max AS bilirubin_max,labs.creatinine_max,labs.pt_min,labs.pt_max,labs.platelets_min AS platelet_min,uo.urineoutput FROM mimiciv_icu.icustays ie INNER JOIN mimiciv_hosp.admissions adm ON ie.hadm_id = adm.hadm_id INNER JOIN mimiciv_hosp.patients pat ON ie.subject_id = pat.subject_id LEFT JOIN pafi2 pf ON ie.stay_id = pf.stay_id LEFT JOIN mimiciv_derived.first_day_gcs gcs ON ie.stay_id = gcs.stay_id LEFT JOIN mimiciv_derived.first_day_vitalsign vital ON ie.stay_id = vital.stay_id LEFT JOIN mimiciv_derived.first_day_urine_output uo ON ie.stay_id = uo.stay_id LEFT JOIN mimiciv_derived.first_day_lab labs ON ie.stay_id = labs.stay_id ),scorecomp AS ( SELECT cohort.*,CASE WHEN gcs_min IS NULL THEN null WHEN gcs_min < 3 THEN null WHEN gcs_min <= 5 THEN 5 WHEN gcs_min <= 8 THEN 3 WHEN gcs_min <= 13 THEN 1 ELSE 0 END AS neurologic,CASE WHEN heart_rate_max IS NULL AND sbp_min IS NULL THEN null WHEN heart_rate_min < 30 THEN 5 WHEN sbp_min < 40 THEN 5 WHEN sbp_min < 70 THEN 3 WHEN sbp_max >= 270 THEN 3 WHEN heart_rate_max >= 140 THEN 1 WHEN sbp_max >= 240 THEN 1 WHEN sbp_min < 90 THEN 1 ELSE 0 END AS cardiovascular,CASE WHEN bun_max IS NULL OR urineoutput IS NULL OR creatinine_max IS NULL THEN null WHEN urineoutput < 500.0 THEN 5 WHEN bun_max >= 56.0 THEN 5 WHEN creatinine_max >= 1.60 THEN 3 WHEN urineoutput < 750.0 THEN 3 WHEN bun_max >= 28.0 THEN 3 WHEN urineoutput >= 10000.0 THEN 3 WHEN creatinine_max >= 1.20 THEN 1 WHEN bun_max >= 17.0 THEN 1 WHEN bun_max >= 7.50 THEN 1 ELSE 0 END AS renal,CASE WHEN pao2fio2_vent_min IS NULL THEN 0 WHEN pao2fio2_vent_min >= 150 THEN 1 WHEN pao2fio2_vent_min < 150 THEN 3 ELSE null END AS pulmonary,CASE WHEN wbc_max IS NULL AND platelet_min IS NULL THEN null WHEN wbc_min < 1.0 THEN 3 WHEN wbc_min < 2.5 THEN 1 WHEN platelet_min < 50.0 THEN 1 WHEN wbc_max >= 50.0 THEN 1 ELSE 0 END AS hematologic,CASE WHEN pt_max IS NULL AND bilirubin_max IS NULL THEN null WHEN bilirubin_max >= 2.0 THEN 1 WHEN pt_max > (12 + 3) THEN 1 WHEN pt_min < (12 * 0.25) THEN 1 ELSE 0 END AS hepatic FROM cohort ) SELECT ie.subject_id,ie.hadm_id,ie.stay_id,COALESCE(neurologic,0) + COALESCE(cardiovascular,0) + COALESCE(renal,0) + COALESCE(pulmonary,0) + COALESCE(hematologic,0) + COALESCE(hepatic,0) AS lods,neurologic,cardiovascular,renal,pulmonary,hematologic,hepatic FROM mimiciv_icu.icustays ie LEFT JOIN scorecomp s ON ie.stay_id = s.stay_id"
  },
  "oasis": {
    "tables": [
      "mimiciv_hosp.patients",
      "mimiciv_hosp.admissions",
      "mimiciv_derived.age",
      "mimiciv_icu.icustays",
      "mimiciv_hosp.services",
      "mimiciv_derived.first_day_vitalsign",
      "mimiciv_derived.ventilation",
      "mimiciv_derived.first_day_urine_output",
      "mimiciv_derived.first_day_gcs"
    ],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.icustays.subject_id"],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "hadm_id": [
        ["mimiciv_icu.icustays.hadm_id"],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "oasis": [
        [
          "mimiciv_derived.first_day_vitalsign.mbp_min",
          "mimiciv_derived.first_day_vitalsign.temperature_min",
          "mimiciv_hosp.admissions.admission_type",
          "mimiciv_derived.first_day_vitalsign.mbp_max",
          "mimiciv_derived.first_day_vitalsign.temperature_max",
          "curr_service",
          "mimiciv_derived.first_day_vitalsign.resp_rate_max",
          "mimiciv_derived.age.age",
          "mimiciv_derived.first_day_vitalsign.heart_rate_max",
          "mimiciv_derived.first_day_gcs.gcs_min",
          "mimiciv_derived.first_day_urine_output.urineoutput",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.first_day_vitalsign.heart_rate_min",
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.resp_rate_min"
        ],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "oasis_prob": [
        [
          "mimiciv_derived.first_day_vitalsign.mbp_min",
          "mimiciv_derived.first_day_vitalsign.temperature_min",
          "mimiciv_hosp.admissions.admission_type",
          "mimiciv_derived.first_day_vitalsign.mbp_max",
          "mimiciv_derived.first_day_vitalsign.temperature_max",
          "curr_service",
          "mimiciv_derived.first_day_vitalsign.resp_rate_max",
          "mimiciv_derived.age.age",
          "mimiciv_derived.first_day_vitalsign.heart_rate_max",
          "mimiciv_derived.first_day_gcs.gcs_min",
          "mimiciv_derived.first_day_urine_output.urineoutput",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.first_day_vitalsign.heart_rate_min",
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.first_day_vitalsign.resp_rate_min"
        ],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "age": [
        ["mimiciv_derived.age.age"],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "age_score": [
        ["mimiciv_derived.age.age"],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "preiculos": [
        ["mimiciv_hosp.admissions.admittime", "mimiciv_icu.icustays.intime"],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "preiculos_score": [
        ["mimiciv_hosp.admissions.admittime", "mimiciv_icu.icustays.intime"],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "gcs": [
        ["mimiciv_derived.first_day_gcs.gcs_min"],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "gcs_score": [
        ["mimiciv_derived.first_day_gcs.gcs_min"],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "heartrate": [
        [
          "mimiciv_derived.first_day_vitalsign.heart_rate_min",
          "mimiciv_derived.first_day_vitalsign.heart_rate_max"
        ],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "heart_rate_score": [
        [
          "mimiciv_derived.first_day_vitalsign.heart_rate_min",
          "mimiciv_derived.first_day_vitalsign.heart_rate_max"
        ],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "meanbp": [
        [
          "mimiciv_derived.first_day_vitalsign.mbp_min",
          "mimiciv_derived.first_day_vitalsign.mbp_max"
        ],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "mbp_score": [
        [
          "mimiciv_derived.first_day_vitalsign.mbp_min",
          "mimiciv_derived.first_day_vitalsign.mbp_max"
        ],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "resprate": [
        [
          "mimiciv_derived.first_day_vitalsign.resp_rate_max",
          "mimiciv_derived.first_day_vitalsign.resp_rate_min"
        ],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "resp_rate_score": [
        [
          "mimiciv_derived.first_day_vitalsign.resp_rate_max",
          "mimiciv_derived.first_day_vitalsign.resp_rate_min"
        ],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "temp": [
        [
          "mimiciv_derived.first_day_vitalsign.temperature_max",
          "mimiciv_derived.first_day_vitalsign.temperature_min"
        ],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "temp_score": [
        [
          "mimiciv_derived.first_day_vitalsign.temperature_max",
          "mimiciv_derived.first_day_vitalsign.temperature_min"
        ],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "urineoutput": [
        ["mimiciv_derived.first_day_urine_output.urineoutput"],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "urineoutput_score": [
        ["mimiciv_derived.first_day_urine_output.urineoutput"],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "mechvent": [
        ["mimiciv_derived.ventilation.stay_id"],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "mechvent_score": [
        ["mimiciv_derived.ventilation.stay_id"],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "electivesurgery": [
        ["curr_service", "mimiciv_hosp.admissions.admission_type"],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ],
      "electivesurgery_score": [
        ["curr_service", "mimiciv_hosp.admissions.admission_type"],
        [
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.age.hadm_id",
          "mimiciv_hosp.services.transfertime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.patients.subject_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_derived.first_day_urine_output.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.first_day_gcs.stay_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_hosp.admissions.hadm_id"
        ]
      ]
    },
    "table_name": "oasis",
    "sql": "WITH surgflag AS ( SELECT ie.stay_id,MAX(CASE WHEN LOWER(curr_service) LIKE '%surg%' THEN 1 WHEN curr_service = 'ORTHO' THEN 1 ELSE 0 END) AS surgical FROM mimiciv_icu.icustays ie LEFT JOIN mimiciv_hosp.services se ON ie.hadm_id = se.hadm_id AND se.transfertime < DATETIME_ADD(ie.intime,INTERVAL '1' DAY) GROUP BY ie.stay_id ),vent AS ( SELECT ie.stay_id,MAX( CASE WHEN v.stay_id IS NOT NULL THEN 1 ELSE 0 END ) AS vent FROM mimiciv_icu.icustays ie LEFT JOIN mimiciv_derived.ventilation v ON ie.stay_id = v.stay_id AND v.ventilation_status = 'InvasiveVent' AND ( ( v.starttime >= ie.intime AND v.starttime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) ) OR ( v.endtime >= ie.intime AND v.endtime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) ) OR ( v.starttime <= ie.intime AND v.endtime >= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) ) ) GROUP BY ie.stay_id ),cohort AS ( SELECT ie.subject_id,ie.hadm_id,ie.stay_id,ie.intime,ie.outtime,adm.deathtime,DATETIME_DIFF(ie.intime,adm.admittime,'MINUTE') AS preiculos,ag.age,gcs.gcs_min,vital.heart_rate_max,vital.heart_rate_min,vital.mbp_max,vital.mbp_min,vital.resp_rate_max,vital.resp_rate_min,vital.temperature_max,vital.temperature_min,vent.vent AS mechvent,uo.urineoutput,CASE WHEN adm.admission_type = 'ELECTIVE' AND sf.surgical = 1 THEN 1 WHEN adm.admission_type IS NULL OR sf.surgical IS NULL THEN null ELSE 0 END AS electivesurgery,CASE WHEN adm.deathtime BETWEEN ie.intime AND ie.outtime THEN 1 WHEN adm.deathtime <= ie.intime THEN 1 WHEN adm.dischtime <= ie.outtime AND adm.discharge_location = 'DEAD/EXPIRED' THEN 1 ELSE 0 END AS icustay_expire_flag,adm.hospital_expire_flag FROM mimiciv_icu.icustays ie INNER JOIN mimiciv_hosp.admissions adm ON ie.hadm_id = adm.hadm_id INNER JOIN mimiciv_hosp.patients pat ON ie.subject_id = pat.subject_id LEFT JOIN mimiciv_derived.age ag ON ie.hadm_id = ag.hadm_id LEFT JOIN surgflag sf ON ie.stay_id = sf.stay_id LEFT JOIN mimiciv_derived.first_day_gcs gcs ON ie.stay_id = gcs.stay_id LEFT JOIN mimiciv_derived.first_day_vitalsign vital ON ie.stay_id = vital.stay_id LEFT JOIN mimiciv_derived.first_day_urine_output uo ON ie.stay_id = uo.stay_id LEFT JOIN vent ON ie.stay_id = vent.stay_id ),scorecomp AS ( SELECT co.subject_id,co.hadm_id,co.stay_id,co.icustay_expire_flag,co.hospital_expire_flag,CASE WHEN preiculos IS NULL THEN null WHEN preiculos < 10.2 THEN 5 WHEN preiculos < 297 THEN 3 WHEN preiculos < 1440 THEN 0 WHEN preiculos < 18708 THEN 1 ELSE 2 END AS preiculos_score,CASE WHEN age IS NULL THEN null WHEN age < 24 THEN 0 WHEN age <= 53 THEN 3 WHEN age <= 77 THEN 6 WHEN age <= 89 THEN 9 WHEN age >= 90 THEN 7 ELSE 0 END AS age_score,CASE WHEN gcs_min IS NULL THEN null WHEN gcs_min <= 7 THEN 10 WHEN gcs_min < 14 THEN 4 WHEN gcs_min = 14 THEN 3 ELSE 0 END AS gcs_score,CASE WHEN heart_rate_max IS NULL THEN null WHEN heart_rate_max > 125 THEN 6 WHEN heart_rate_min < 33 THEN 4 WHEN heart_rate_max >= 107 AND heart_rate_max <= 125 THEN 3 WHEN heart_rate_max >= 89 AND heart_rate_max <= 106 THEN 1 ELSE 0 END AS heart_rate_score,CASE WHEN mbp_min IS NULL THEN null WHEN mbp_min < 20.65 THEN 4 WHEN mbp_min < 51 THEN 3 WHEN mbp_max > 143.44 THEN 3 WHEN mbp_min >= 51 AND mbp_min < 61.33 THEN 2 ELSE 0 END AS mbp_score,CASE WHEN resp_rate_min IS NULL THEN null WHEN resp_rate_min < 6 THEN 10 WHEN resp_rate_max > 44 THEN 9 WHEN resp_rate_max > 30 THEN 6 WHEN resp_rate_max > 22 THEN 1 WHEN resp_rate_min < 13 THEN 1 ELSE 0 END AS resp_rate_score,CASE WHEN temperature_max IS NULL THEN null WHEN temperature_max > 39.88 THEN 6 WHEN temperature_min >= 33.22 AND temperature_min <= 35.93 THEN 4 WHEN temperature_max >= 33.22 AND temperature_max <= 35.93 THEN 4 WHEN temperature_min < 33.22 THEN 3 WHEN temperature_min > 35.93 AND temperature_min <= 36.39 THEN 2 WHEN temperature_max >= 36.89 AND temperature_max <= 39.88 THEN 2 ELSE 0 END AS temp_score,CASE WHEN urineoutput IS NULL THEN null WHEN urineoutput < 671.09 THEN 10 WHEN urineoutput > 6896.80 THEN 8 WHEN urineoutput >= 671.09 AND urineoutput <= 1426.99 THEN 5 WHEN urineoutput >= 1427.00 AND urineoutput <= 2544.14 THEN 1 ELSE 0 END AS urineoutput_score,CASE WHEN mechvent IS NULL THEN null WHEN mechvent = 1 THEN 9 ELSE 0 END AS mechvent_score,CASE WHEN electivesurgery IS NULL THEN null WHEN electivesurgery = 1 THEN 0 ELSE 6 END AS electivesurgery_score,preiculos,age,gcs_min AS gcs,CASE WHEN heart_rate_max IS NULL THEN null WHEN heart_rate_max > 125 THEN heart_rate_max WHEN heart_rate_min < 33 THEN heart_rate_min WHEN heart_rate_max >= 107 AND heart_rate_max <= 125 THEN heart_rate_max WHEN heart_rate_max >= 89 AND heart_rate_max <= 106 THEN heart_rate_max ELSE (heart_rate_min + heart_rate_max) / 2 END AS heartrate,CASE WHEN mbp_min IS NULL THEN null WHEN mbp_min < 20.65 THEN mbp_min WHEN mbp_min < 51 THEN mbp_min WHEN mbp_max > 143.44 THEN mbp_max WHEN mbp_min >= 51 AND mbp_min < 61.33 THEN mbp_min ELSE (mbp_min + mbp_max) / 2 END AS meanbp,CASE WHEN resp_rate_min IS NULL THEN null WHEN resp_rate_min < 6 THEN resp_rate_min WHEN resp_rate_max > 44 THEN resp_rate_max WHEN resp_rate_max > 30 THEN resp_rate_max WHEN resp_rate_max > 22 THEN resp_rate_max WHEN resp_rate_min < 13 THEN resp_rate_min ELSE (resp_rate_min + resp_rate_max) / 2 END AS resprate,CASE WHEN temperature_max IS NULL THEN null WHEN temperature_max > 39.88 THEN temperature_max WHEN temperature_min >= 33.22 AND temperature_min <= 35.93 THEN temperature_min WHEN temperature_max >= 33.22 AND temperature_max <= 35.93 THEN temperature_max WHEN temperature_min < 33.22 THEN temperature_min WHEN temperature_min > 35.93 AND temperature_min <= 36.39 THEN temperature_min WHEN temperature_max >= 36.89 AND temperature_max <= 39.88 THEN temperature_max ELSE (temperature_min + temperature_max) / 2 END AS temp,urineoutput,mechvent,electivesurgery FROM cohort co ),score AS ( SELECT s.*,COALESCE(age_score,0) + COALESCE(preiculos_score,0) + COALESCE(gcs_score,0) + COALESCE(heart_rate_score,0) + COALESCE(mbp_score,0) + COALESCE(resp_rate_score,0) + COALESCE(temp_score,0) + COALESCE(urineoutput_score,0) + COALESCE(mechvent_score,0) + COALESCE(electivesurgery_score,0) AS oasis FROM scorecomp s ) SELECT subject_id,hadm_id,stay_id,oasis,1 / (1 + EXP(- (-6.1746 + 0.1275 * (oasis)))) AS oasis_prob,age,age_score,preiculos,preiculos_score,gcs,gcs_score,heartrate,heart_rate_score,meanbp,mbp_score,resprate,resp_rate_score,temp,temp_score,urineoutput,urineoutput_score,mechvent,mechvent_score,electivesurgery,electivesurgery_score FROM score"
  },
  "sapsii": {
    "tables": [
      "mimiciv_derived.vitalsign",
      "mimiciv_derived.enzyme",
      "mimiciv_hosp.diagnoses_icd",
      "mimiciv_derived.chemistry",
      "mimiciv_hosp.admissions",
      "mimiciv_derived.complete_blood_count",
      "mimiciv_derived.urine_output",
      "mimiciv_derived.age",
      "mimiciv_icu.icustays",
      "mimiciv_hosp.services",
      "mimiciv_derived.gcs",
      "mimiciv_derived.ventilation",
      "mimiciv_derived.bg",
      "mimiciv_icu.chartevents"
    ],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.icustays.subject_id"],
        [
          "mimiciv_derived.age.hadm_id",
          "transfertime",
          "mimiciv_derived.vitalsign.subject_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.chemistry.subject_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "hadm_id": [
        ["mimiciv_icu.icustays.hadm_id"],
        [
          "mimiciv_derived.age.hadm_id",
          "transfertime",
          "mimiciv_derived.vitalsign.subject_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.chemistry.subject_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_derived.age.hadm_id",
          "transfertime",
          "mimiciv_derived.vitalsign.subject_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.chemistry.subject_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "starttime": [
        ["mimiciv_icu.icustays.intime"],
        [
          "mimiciv_derived.age.hadm_id",
          "transfertime",
          "mimiciv_derived.vitalsign.subject_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.chemistry.subject_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "endtime": [
        ["mimiciv_icu.icustays.intime"],
        [
          "mimiciv_derived.age.hadm_id",
          "transfertime",
          "mimiciv_derived.vitalsign.subject_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.chemistry.subject_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "sapsii": [
        [
          "mimiciv_derived.complete_blood_count.wbc",
          "mimiciv_derived.enzyme.bilirubin_total",
          "mimiciv_hosp.admissions.admission_type",
          "curr_service",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_derived.age.age",
          "mimiciv_derived.chemistry.potassium",
          "mimiciv_derived.chemistry.bicarbonate",
          "mimiciv_derived.urine_output.urineoutput",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.vitalsign.heart_rate",
          "mimiciv_derived.chemistry.sodium",
          "mimiciv_derived.chemistry.bun",
          "mimiciv_derived.vitalsign.temperature",
          "mimiciv_derived.vitalsign.sbp",
          "mimiciv_derived.bg.pao2fio2ratio",
          "mimiciv_derived.gcs.gcs"
        ],
        [
          "mimiciv_derived.age.hadm_id",
          "transfertime",
          "mimiciv_derived.vitalsign.subject_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.chemistry.subject_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "sapsii_prob": [
        [
          "mimiciv_derived.complete_blood_count.wbc",
          "mimiciv_derived.enzyme.bilirubin_total",
          "mimiciv_hosp.admissions.admission_type",
          "curr_service",
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_derived.age.age",
          "mimiciv_derived.chemistry.potassium",
          "mimiciv_derived.chemistry.bicarbonate",
          "mimiciv_derived.urine_output.urineoutput",
          "mimiciv_hosp.diagnoses_icd.icd_code",
          "mimiciv_derived.vitalsign.heart_rate",
          "mimiciv_derived.chemistry.sodium",
          "mimiciv_derived.chemistry.bun",
          "mimiciv_derived.vitalsign.temperature",
          "mimiciv_derived.vitalsign.sbp",
          "mimiciv_derived.bg.pao2fio2ratio",
          "mimiciv_derived.gcs.gcs"
        ],
        [
          "mimiciv_derived.age.hadm_id",
          "transfertime",
          "mimiciv_derived.vitalsign.subject_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.chemistry.subject_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "age_score": [
        ["mimiciv_derived.age.age"],
        [
          "mimiciv_derived.age.hadm_id",
          "transfertime",
          "mimiciv_derived.vitalsign.subject_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.chemistry.subject_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "hr_score": [
        ["mimiciv_derived.vitalsign.heart_rate"],
        [
          "mimiciv_derived.age.hadm_id",
          "transfertime",
          "mimiciv_derived.vitalsign.subject_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.chemistry.subject_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "sysbp_score": [
        ["mimiciv_derived.vitalsign.sbp"],
        [
          "mimiciv_derived.age.hadm_id",
          "transfertime",
          "mimiciv_derived.vitalsign.subject_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.chemistry.subject_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "temp_score": [
        ["mimiciv_derived.vitalsign.temperature"],
        [
          "mimiciv_derived.age.hadm_id",
          "transfertime",
          "mimiciv_derived.vitalsign.subject_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.chemistry.subject_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "pao2fio2_score": [
        ["mimiciv_derived.bg.pao2fio2ratio"],
        [
          "mimiciv_derived.age.hadm_id",
          "transfertime",
          "mimiciv_derived.vitalsign.subject_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.chemistry.subject_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "uo_score": [
        ["mimiciv_derived.urine_output.urineoutput"],
        [
          "mimiciv_derived.age.hadm_id",
          "transfertime",
          "mimiciv_derived.vitalsign.subject_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.chemistry.subject_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "bun_score": [
        ["mimiciv_derived.chemistry.bun"],
        [
          "mimiciv_derived.age.hadm_id",
          "transfertime",
          "mimiciv_derived.vitalsign.subject_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.chemistry.subject_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "wbc_score": [
        ["mimiciv_derived.complete_blood_count.wbc"],
        [
          "mimiciv_derived.age.hadm_id",
          "transfertime",
          "mimiciv_derived.vitalsign.subject_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.chemistry.subject_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "potassium_score": [
        ["mimiciv_derived.chemistry.potassium"],
        [
          "mimiciv_derived.age.hadm_id",
          "transfertime",
          "mimiciv_derived.vitalsign.subject_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.chemistry.subject_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "sodium_score": [
        ["mimiciv_derived.chemistry.sodium"],
        [
          "mimiciv_derived.age.hadm_id",
          "transfertime",
          "mimiciv_derived.vitalsign.subject_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.chemistry.subject_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "bicarbonate_score": [
        ["mimiciv_derived.chemistry.bicarbonate"],
        [
          "mimiciv_derived.age.hadm_id",
          "transfertime",
          "mimiciv_derived.vitalsign.subject_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.chemistry.subject_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "bilirubin_score": [
        ["mimiciv_derived.enzyme.bilirubin_total"],
        [
          "mimiciv_derived.age.hadm_id",
          "transfertime",
          "mimiciv_derived.vitalsign.subject_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.chemistry.subject_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "gcs_score": [
        ["mimiciv_derived.gcs.gcs"],
        [
          "mimiciv_derived.age.hadm_id",
          "transfertime",
          "mimiciv_derived.vitalsign.subject_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.chemistry.subject_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "comorbidity_score": [
        [
          "mimiciv_hosp.diagnoses_icd.icd_version",
          "mimiciv_hosp.diagnoses_icd.icd_code"
        ],
        [
          "mimiciv_derived.age.hadm_id",
          "transfertime",
          "mimiciv_derived.vitalsign.subject_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.chemistry.subject_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "admissiontype_score": [
        ["curr_service", "mimiciv_hosp.admissions.admission_type"],
        [
          "mimiciv_derived.age.hadm_id",
          "transfertime",
          "mimiciv_derived.vitalsign.subject_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.bg.charttime",
          "mimiciv_hosp.diagnoses_icd.hadm_id",
          "mimiciv_icu.chartevents.value",
          "mimiciv_hosp.admissions.hadm_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.chemistry.subject_id",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_hosp.services.hadm_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ]
    },
    "table_name": "sapsii",
    "sql": "WITH co AS ( SELECT subject_id,hadm_id,stay_id,intime AS starttime,DATETIME_ADD(intime,INTERVAL '24' HOUR) AS endtime FROM mimiciv_icu.icustays ),cpap AS ( SELECT co.subject_id,co.stay_id,GREATEST( MIN(DATETIME_SUB(charttime,INTERVAL '1' HOUR)),co.starttime ) AS starttime,LEAST( MAX(DATETIME_ADD(charttime,INTERVAL '4' HOUR)),co.endtime ) AS endtime,MAX( CASE WHEN REGEXP_CONTAINS(LOWER(ce.value),'(cpap mask|bipap)') THEN 1 ELSE 0 END ) AS cpap FROM co INNER JOIN mimiciv_icu.chartevents ce ON co.stay_id = ce.stay_id AND ce.charttime > co.starttime AND ce.charttime <= co.endtime WHERE ce.itemid = 226732 AND REGEXP_CONTAINS(LOWER(ce.value),'(cpap mask|bipap)') GROUP BY co.subject_id,co.stay_id,co.starttime,co.endtime ),surgflag AS ( SELECT adm.hadm_id,CASE WHEN LOWER(curr_service) LIKE '%surg%' THEN 1 ELSE 0 END AS surgical,ROW_NUMBER() OVER ( PARTITION BY adm.hadm_id ORDER BY transfertime ) AS serviceorder FROM mimiciv_hosp.admissions adm LEFT JOIN mimiciv_hosp.services se ON adm.hadm_id = se.hadm_id ),comorb AS ( SELECT hadm_id,MAX(CASE WHEN icd_version = 9 AND SUBSTR( icd_code,1,3 ) BETWEEN '042' AND '044' THEN 1 WHEN icd_version = 10 AND SUBSTR( icd_code,1,3 ) BETWEEN 'B20' AND 'B22' THEN 1 WHEN icd_version = 10 AND SUBSTR(icd_code,1,3) = 'B24' THEN 1 ELSE 0 END) AS aids,MAX( CASE WHEN icd_version = 9 THEN CASE WHEN SUBSTR( icd_code,1,5 ) BETWEEN '20000' AND '20238' THEN 1 WHEN SUBSTR( icd_code,1,5 ) BETWEEN '20240' AND '20248' THEN 1 WHEN SUBSTR( icd_code,1,5 ) BETWEEN '20250' AND '20302' THEN 1 WHEN SUBSTR( icd_code,1,5 ) BETWEEN '20310' AND '20312' THEN 1 WHEN SUBSTR( icd_code,1,5 ) BETWEEN '20302' AND '20382' THEN 1 WHEN SUBSTR( icd_code,1,5 ) BETWEEN '20400' AND '20522' THEN 1 WHEN SUBSTR( icd_code,1,5 ) BETWEEN '20580' AND '20702' THEN 1 WHEN SUBSTR( icd_code,1,5 ) BETWEEN '20720' AND '20892' THEN 1 WHEN SUBSTR(icd_code,1,4) IN ('2386','2733') THEN 1 ELSE 0 END WHEN icd_version = 10 AND SUBSTR( icd_code,1,3 ) BETWEEN 'C81' AND 'C96' THEN 1 ELSE 0 END) AS hem,MAX(CASE WHEN icd_version = 9 THEN CASE WHEN SUBSTR(icd_code,1,4) BETWEEN '1960' AND '1991' THEN 1 WHEN SUBSTR( icd_code,1,5 ) BETWEEN '20970' AND '20975' THEN 1 WHEN SUBSTR(icd_code,1,5) IN ('20979','78951') THEN 1 ELSE 0 END WHEN icd_version = 10 AND SUBSTR( icd_code,1,3 ) BETWEEN 'C77' AND 'C79' THEN 1 WHEN icd_version = 10 AND SUBSTR(icd_code,1,4) = 'C800' THEN 1 ELSE 0 END) AS mets FROM mimiciv_hosp.diagnoses_icd GROUP BY hadm_id ),pafi1 AS ( SELECT co.stay_id,bg.charttime,pao2fio2ratio AS pao2fio2,CASE WHEN vd.stay_id IS NOT NULL THEN 1 ELSE 0 END AS vent,CASE WHEN cp.subject_id IS NOT NULL THEN 1 ELSE 0 END AS cpap FROM co LEFT JOIN mimiciv_derived.bg bg ON co.subject_id = bg.subject_id AND bg.specimen = 'ART.' AND bg.charttime > co.starttime AND bg.charttime <= co.endtime LEFT JOIN mimiciv_derived.ventilation vd ON co.stay_id = vd.stay_id AND bg.charttime > vd.starttime AND bg.charttime <= vd.endtime AND vd.ventilation_status = 'InvasiveVent' LEFT JOIN cpap cp ON bg.subject_id = cp.subject_id AND bg.charttime > cp.starttime AND bg.charttime <= cp.endtime ),pafi2 AS ( SELECT stay_id,MIN(pao2fio2) AS pao2fio2_vent_min FROM pafi1 WHERE vent = 1 OR cpap = 1 GROUP BY stay_id ),gcs AS ( SELECT co.stay_id,MIN(gcs.gcs) AS mingcs FROM co LEFT JOIN mimiciv_derived.gcs gcs ON co.stay_id = gcs.stay_id AND co.starttime < gcs.charttime AND gcs.charttime <= co.endtime GROUP BY co.stay_id ),vital AS ( SELECT co.stay_id,MIN(vital.heart_rate) AS heartrate_min,MAX(vital.heart_rate) AS heartrate_max,MIN(vital.sbp) AS sysbp_min,MAX(vital.sbp) AS sysbp_max,MIN(vital.temperature) AS tempc_min,MAX(vital.temperature) AS tempc_max FROM co LEFT JOIN mimiciv_derived.vitalsign vital ON co.subject_id = vital.subject_id AND co.starttime < vital.charttime AND co.endtime >= vital.charttime GROUP BY co.stay_id ),uo AS ( SELECT co.stay_id,SUM(uo.urineoutput) AS urineoutput FROM co LEFT JOIN mimiciv_derived.urine_output uo ON co.stay_id = uo.stay_id AND co.starttime < uo.charttime AND co.endtime >= uo.charttime GROUP BY co.stay_id ),labs AS ( SELECT co.stay_id,MIN(labs.bun) AS bun_min,MAX(labs.bun) AS bun_max,MIN(labs.potassium) AS potassium_min,MAX(labs.potassium) AS potassium_max,MIN(labs.sodium) AS sodium_min,MAX(labs.sodium) AS sodium_max,MIN(labs.bicarbonate) AS bicarbonate_min,MAX(labs.bicarbonate) AS bicarbonate_max FROM co LEFT JOIN mimiciv_derived.chemistry labs ON co.subject_id = labs.subject_id AND co.starttime < labs.charttime AND co.endtime >= labs.charttime GROUP BY co.stay_id ),cbc AS ( SELECT co.stay_id,MIN(cbc.wbc) AS wbc_min,MAX(cbc.wbc) AS wbc_max FROM co LEFT JOIN mimiciv_derived.complete_blood_count cbc ON co.subject_id = cbc.subject_id AND co.starttime < cbc.charttime AND co.endtime >= cbc.charttime GROUP BY co.stay_id ),enz AS ( SELECT co.stay_id,MIN(enz.bilirubin_total) AS bilirubin_min,MAX(enz.bilirubin_total) AS bilirubin_max FROM co LEFT JOIN mimiciv_derived.enzyme enz ON co.subject_id = enz.subject_id AND co.starttime < enz.charttime AND co.endtime >= enz.charttime GROUP BY co.stay_id ),cohort AS ( SELECT ie.subject_id,ie.hadm_id,ie.stay_id,ie.intime,ie.outtime,va.age,co.starttime,co.endtime,vital.heartrate_max,vital.heartrate_min,vital.sysbp_max,vital.sysbp_min,vital.tempc_max,vital.tempc_min,pf.pao2fio2_vent_min,uo.urineoutput,labs.bun_min,labs.bun_max,cbc.wbc_min,cbc.wbc_max,labs.potassium_min,labs.potassium_max,labs.sodium_min,labs.sodium_max,labs.bicarbonate_min,labs.bicarbonate_max,enz.bilirubin_min,enz.bilirubin_max,gcs.mingcs,comorb.aids,comorb.hem,comorb.mets,CASE WHEN adm.admission_type = 'ELECTIVE' AND sf.surgical = 1 THEN 'ScheduledSurgical' WHEN adm.admission_type != 'ELECTIVE' AND sf.surgical = 1 THEN 'UnscheduledSurgical' ELSE 'Medical' END AS admissiontype FROM mimiciv_icu.icustays ie INNER JOIN mimiciv_hosp.admissions adm ON ie.hadm_id = adm.hadm_id LEFT JOIN mimiciv_derived.age va ON ie.hadm_id = va.hadm_id INNER JOIN co ON ie.stay_id = co.stay_id LEFT JOIN pafi2 pf ON ie.stay_id = pf.stay_id LEFT JOIN surgflag sf ON adm.hadm_id = sf.hadm_id AND sf.serviceorder = 1 LEFT JOIN comorb ON ie.hadm_id = comorb.hadm_id LEFT JOIN gcs gcs ON ie.stay_id = gcs.stay_id LEFT JOIN vital ON ie.stay_id = vital.stay_id LEFT JOIN uo ON ie.stay_id = uo.stay_id LEFT JOIN labs ON ie.stay_id = labs.stay_id LEFT JOIN cbc ON ie.stay_id = cbc.stay_id LEFT JOIN enz ON ie.stay_id = enz.stay_id ),scorecomp AS ( SELECT cohort.*,CASE WHEN age IS NULL THEN null WHEN age < 40 THEN 0 WHEN age < 60 THEN 7 WHEN age < 70 THEN 12 WHEN age < 75 THEN 15 WHEN age < 80 THEN 16 WHEN age >= 80 THEN 18 END AS age_score,CASE WHEN heartrate_max IS NULL THEN null WHEN heartrate_min < 40 THEN 11 WHEN heartrate_max >= 160 THEN 7 WHEN heartrate_max >= 120 THEN 4 WHEN heartrate_min < 70 THEN 2 WHEN heartrate_max >= 70 AND heartrate_max < 120 AND heartrate_min >= 70 AND heartrate_min < 120 THEN 0 END AS hr_score,CASE WHEN sysbp_min IS NULL THEN null WHEN sysbp_min < 70 THEN 13 WHEN sysbp_min < 100 THEN 5 WHEN sysbp_max >= 200 THEN 2 WHEN sysbp_max >= 100 AND sysbp_max < 200 AND sysbp_min >= 100 AND sysbp_min < 200 THEN 0 END AS sysbp_score,CASE WHEN tempc_max IS NULL THEN null WHEN tempc_max >= 39.0 THEN 3 WHEN tempc_min < 39.0 THEN 0 END AS temp_score,CASE WHEN pao2fio2_vent_min IS NULL THEN null WHEN pao2fio2_vent_min < 100 THEN 11 WHEN pao2fio2_vent_min < 200 THEN 9 WHEN pao2fio2_vent_min >= 200 THEN 6 END AS pao2fio2_score,CASE WHEN urineoutput IS NULL THEN null WHEN urineoutput < 500.0 THEN 11 WHEN urineoutput < 1000.0 THEN 4 WHEN urineoutput >= 1000.0 THEN 0 END AS uo_score,CASE WHEN bun_max IS NULL THEN null WHEN bun_max < 28.0 THEN 0 WHEN bun_max < 84.0 THEN 6 WHEN bun_max >= 84.0 THEN 10 END AS bun_score,CASE WHEN wbc_max IS NULL THEN null WHEN wbc_min < 1.0 THEN 12 WHEN wbc_max >= 20.0 THEN 3 WHEN wbc_max >= 1.0 AND wbc_max < 20.0 AND wbc_min >= 1.0 AND wbc_min < 20.0 THEN 0 END AS wbc_score,CASE WHEN potassium_max IS NULL THEN null WHEN potassium_min < 3.0 THEN 3 WHEN potassium_max >= 5.0 THEN 3 WHEN potassium_max >= 3.0 AND potassium_max < 5.0 AND potassium_min >= 3.0 AND potassium_min < 5.0 THEN 0 END AS potassium_score,CASE WHEN sodium_max IS NULL THEN null WHEN sodium_min < 125 THEN 5 WHEN sodium_max >= 145 THEN 1 WHEN sodium_max >= 125 AND sodium_max < 145 AND sodium_min >= 125 AND sodium_min < 145 THEN 0 END AS sodium_score,CASE WHEN bicarbonate_max IS NULL THEN null WHEN bicarbonate_min < 15.0 THEN 5 WHEN bicarbonate_min < 20.0 THEN 3 WHEN bicarbonate_max >= 20.0 AND bicarbonate_min >= 20.0 THEN 0 END AS bicarbonate_score,CASE WHEN bilirubin_max IS NULL THEN null WHEN bilirubin_max < 4.0 THEN 0 WHEN bilirubin_max < 6.0 THEN 4 WHEN bilirubin_max >= 6.0 THEN 9 END AS bilirubin_score,CASE WHEN mingcs IS NULL THEN null WHEN mingcs < 3 THEN null WHEN mingcs < 6 THEN 26 WHEN mingcs < 9 THEN 13 WHEN mingcs < 11 THEN 7 WHEN mingcs < 14 THEN 5 WHEN mingcs >= 14 AND mingcs <= 15 THEN 0 END AS gcs_score,CASE WHEN aids = 1 THEN 17 WHEN hem = 1 THEN 10 WHEN mets = 1 THEN 9 ELSE 0 END AS comorbidity_score,CASE WHEN admissiontype = 'ScheduledSurgical' THEN 0 WHEN admissiontype = 'Medical' THEN 6 WHEN admissiontype = 'UnscheduledSurgical' THEN 8 ELSE null END AS admissiontype_score FROM cohort ),score AS ( SELECT s.*,COALESCE(age_score,0) + COALESCE(hr_score,0) + COALESCE(sysbp_score,0) + COALESCE(temp_score,0) + COALESCE(pao2fio2_score,0) + COALESCE(uo_score,0) + COALESCE(bun_score,0) + COALESCE(wbc_score,0) + COALESCE(potassium_score,0) + COALESCE(sodium_score,0) + COALESCE(bicarbonate_score,0) + COALESCE(bilirubin_score,0) + COALESCE(gcs_score,0) + COALESCE(comorbidity_score,0) + COALESCE(admissiontype_score,0) AS sapsii FROM scorecomp s ) SELECT s.subject_id,s.hadm_id,s.stay_id,s.starttime,s.endtime,sapsii,1 / ( 1 + EXP(- (-7.7631 + 0.0737 * (sapsii) + 0.9971 * (LN(sapsii + 1)))) ) AS sapsii_prob,age_score,hr_score,sysbp_score,temp_score,pao2fio2_score,uo_score,bun_score,wbc_score,potassium_score,sodium_score,bicarbonate_score,bilirubin_score,gcs_score,comorbidity_score,admissiontype_score FROM score s"
  },
  "sirs": {
    "tables": [
      "mimiciv_derived.first_day_lab",
      "mimiciv_derived.first_day_bg_art",
      "mimiciv_derived.first_day_vitalsign",
      "mimiciv_icu.icustays"
    ],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.icustays.subject_id"],
        [
          "mimiciv_derived.first_day_bg_art.stay_id",
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "hadm_id": [
        ["mimiciv_icu.icustays.hadm_id"],
        [
          "mimiciv_derived.first_day_bg_art.stay_id",
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_derived.first_day_bg_art.stay_id",
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "sirs": [
        [
          "mimiciv_derived.first_day_lab.wbc_min",
          "mimiciv_derived.first_day_vitalsign.temperature_min",
          "mimiciv_derived.first_day_vitalsign.temperature_max",
          "mimiciv_derived.first_day_vitalsign.resp_rate_max",
          "mimiciv_derived.first_day_lab.bands_max",
          "mimiciv_derived.first_day_vitalsign.heart_rate_max",
          "mimiciv_derived.first_day_lab.wbc_max",
          "mimiciv_derived.first_day_bg_art.pco2_min"
        ],
        [
          "mimiciv_derived.first_day_bg_art.stay_id",
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "temp_score": [
        [
          "mimiciv_derived.first_day_vitalsign.temperature_max",
          "mimiciv_derived.first_day_vitalsign.temperature_min"
        ],
        [
          "mimiciv_derived.first_day_bg_art.stay_id",
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "heart_rate_score": [
        ["mimiciv_derived.first_day_vitalsign.heart_rate_max"],
        [
          "mimiciv_derived.first_day_bg_art.stay_id",
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "resp_score": [
        [
          "mimiciv_derived.first_day_bg_art.pco2_min",
          "mimiciv_derived.first_day_vitalsign.resp_rate_max"
        ],
        [
          "mimiciv_derived.first_day_bg_art.stay_id",
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "wbc_score": [
        [
          "mimiciv_derived.first_day_lab.wbc_min",
          "mimiciv_derived.first_day_lab.bands_max",
          "mimiciv_derived.first_day_lab.wbc_max"
        ],
        [
          "mimiciv_derived.first_day_bg_art.stay_id",
          "mimiciv_derived.first_day_lab.stay_id",
          "mimiciv_derived.first_day_vitalsign.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ]
    },
    "table_name": "sirs",
    "sql": "WITH scorecomp AS ( SELECT ie.stay_id,v.temperature_min,v.temperature_max,v.heart_rate_max,v.resp_rate_max,bg.pco2_min AS paco2_min,l.wbc_min,l.wbc_max,l.bands_max FROM mimiciv_icu.icustays ie LEFT JOIN mimiciv_derived.first_day_bg_art bg ON ie.stay_id = bg.stay_id LEFT JOIN mimiciv_derived.first_day_vitalsign v ON ie.stay_id = v.stay_id LEFT JOIN mimiciv_derived.first_day_lab l ON ie.stay_id = l.stay_id ),scorecalc AS ( SELECT stay_id,CASE WHEN temperature_min < 36.0 THEN 1 WHEN temperature_max > 38.0 THEN 1 WHEN temperature_min IS NULL THEN null ELSE 0 END AS temp_score,CASE WHEN heart_rate_max > 90.0 THEN 1 WHEN heart_rate_max IS NULL THEN null ELSE 0 END AS heart_rate_score,CASE WHEN resp_rate_max > 20.0 THEN 1 WHEN paco2_min < 32.0 THEN 1 WHEN COALESCE(resp_rate_max,paco2_min) IS NULL THEN null ELSE 0 END AS resp_score,CASE WHEN wbc_min < 4.0 THEN 1 WHEN wbc_max > 12.0 THEN 1 WHEN bands_max > 10 THEN 1 WHEN COALESCE(wbc_min,bands_max) IS NULL THEN null ELSE 0 END AS wbc_score FROM scorecomp ) SELECT ie.subject_id,ie.hadm_id,ie.stay_id,COALESCE(temp_score,0) + COALESCE(heart_rate_score,0) + COALESCE(resp_score,0) + COALESCE(wbc_score,0) AS sirs,temp_score,heart_rate_score,resp_score,wbc_score FROM mimiciv_icu.icustays ie LEFT JOIN scorecalc s ON ie.stay_id = s.stay_id"
  },
  "sepsis3": {
    "tables": [
      "mimiciv_derived.suspicion_of_infection",
      "mimiciv_derived.sofa"
    ],
    "columns": {
      "subject_id": [
        ["mimiciv_derived.suspicion_of_infection.subject_id"],
        [
          "mimiciv_derived.suspicion_of_infection.stay_id",
          "mimiciv_derived.suspicion_of_infection.sofa_score",
          "mimiciv_derived.suspicion_of_infection.antibiotic_time",
          "mimiciv_derived.sofa.sofa_24hours",
          "mimiciv_derived.sofa.endtime",
          "mimiciv_derived.sofa.stay_id",
          "sofa.endtime",
          "mimiciv_derived.suspicion_of_infection.suspected_infection_time",
          "mimiciv_derived.suspicion_of_infection.culture_time",
          "mimiciv_derived.suspicion_of_infection.suspected_infection"
        ]
      ],
      "stay_id": [
        ["mimiciv_derived.suspicion_of_infection.stay_id"],
        [
          "mimiciv_derived.suspicion_of_infection.stay_id",
          "mimiciv_derived.suspicion_of_infection.sofa_score",
          "mimiciv_derived.suspicion_of_infection.antibiotic_time",
          "mimiciv_derived.sofa.sofa_24hours",
          "mimiciv_derived.sofa.endtime",
          "mimiciv_derived.sofa.stay_id",
          "sofa.endtime",
          "mimiciv_derived.suspicion_of_infection.suspected_infection_time",
          "mimiciv_derived.suspicion_of_infection.culture_time",
          "mimiciv_derived.suspicion_of_infection.suspected_infection"
        ]
      ],
      "antibiotic_time": [
        ["mimiciv_derived.suspicion_of_infection.antibiotic_time"],
        [
          "mimiciv_derived.suspicion_of_infection.stay_id",
          "mimiciv_derived.suspicion_of_infection.sofa_score",
          "mimiciv_derived.suspicion_of_infection.antibiotic_time",
          "mimiciv_derived.sofa.sofa_24hours",
          "mimiciv_derived.sofa.endtime",
          "mimiciv_derived.sofa.stay_id",
          "sofa.endtime",
          "mimiciv_derived.suspicion_of_infection.suspected_infection_time",
          "mimiciv_derived.suspicion_of_infection.culture_time",
          "mimiciv_derived.suspicion_of_infection.suspected_infection"
        ]
      ],
      "culture_time": [
        ["mimiciv_derived.suspicion_of_infection.culture_time"],
        [
          "mimiciv_derived.suspicion_of_infection.stay_id",
          "mimiciv_derived.suspicion_of_infection.sofa_score",
          "mimiciv_derived.suspicion_of_infection.antibiotic_time",
          "mimiciv_derived.sofa.sofa_24hours",
          "mimiciv_derived.sofa.endtime",
          "mimiciv_derived.sofa.stay_id",
          "sofa.endtime",
          "mimiciv_derived.suspicion_of_infection.suspected_infection_time",
          "mimiciv_derived.suspicion_of_infection.culture_time",
          "mimiciv_derived.suspicion_of_infection.suspected_infection"
        ]
      ],
      "suspected_infection_time": [
        ["mimiciv_derived.suspicion_of_infection.suspected_infection_time"],
        [
          "mimiciv_derived.suspicion_of_infection.stay_id",
          "mimiciv_derived.suspicion_of_infection.sofa_score",
          "mimiciv_derived.suspicion_of_infection.antibiotic_time",
          "mimiciv_derived.sofa.sofa_24hours",
          "mimiciv_derived.sofa.endtime",
          "mimiciv_derived.sofa.stay_id",
          "sofa.endtime",
          "mimiciv_derived.suspicion_of_infection.suspected_infection_time",
          "mimiciv_derived.suspicion_of_infection.culture_time",
          "mimiciv_derived.suspicion_of_infection.suspected_infection"
        ]
      ],
      "sofa_time": [
        ["sofa.endtime"],
        [
          "mimiciv_derived.suspicion_of_infection.stay_id",
          "mimiciv_derived.suspicion_of_infection.sofa_score",
          "mimiciv_derived.suspicion_of_infection.antibiotic_time",
          "mimiciv_derived.sofa.sofa_24hours",
          "mimiciv_derived.sofa.endtime",
          "mimiciv_derived.sofa.stay_id",
          "sofa.endtime",
          "mimiciv_derived.suspicion_of_infection.suspected_infection_time",
          "mimiciv_derived.suspicion_of_infection.culture_time",
          "mimiciv_derived.suspicion_of_infection.suspected_infection"
        ]
      ],
      "sofa_score": [
        ["mimiciv_derived.suspicion_of_infection.sofa_score"],
        [
          "mimiciv_derived.suspicion_of_infection.stay_id",
          "mimiciv_derived.suspicion_of_infection.sofa_score",
          "mimiciv_derived.suspicion_of_infection.antibiotic_time",
          "mimiciv_derived.sofa.sofa_24hours",
          "mimiciv_derived.sofa.endtime",
          "mimiciv_derived.sofa.stay_id",
          "sofa.endtime",
          "mimiciv_derived.suspicion_of_infection.suspected_infection_time",
          "mimiciv_derived.suspicion_of_infection.culture_time",
          "mimiciv_derived.suspicion_of_infection.suspected_infection"
        ]
      ],
      "respiration": [
        ["sofa.respiration"],
        [
          "mimiciv_derived.suspicion_of_infection.stay_id",
          "mimiciv_derived.suspicion_of_infection.sofa_score",
          "mimiciv_derived.suspicion_of_infection.antibiotic_time",
          "mimiciv_derived.sofa.sofa_24hours",
          "mimiciv_derived.sofa.endtime",
          "mimiciv_derived.sofa.stay_id",
          "sofa.endtime",
          "mimiciv_derived.suspicion_of_infection.suspected_infection_time",
          "mimiciv_derived.suspicion_of_infection.culture_time",
          "mimiciv_derived.suspicion_of_infection.suspected_infection"
        ]
      ],
      "coagulation": [
        ["sofa.coagulation"],
        [
          "mimiciv_derived.suspicion_of_infection.stay_id",
          "mimiciv_derived.suspicion_of_infection.sofa_score",
          "mimiciv_derived.suspicion_of_infection.antibiotic_time",
          "mimiciv_derived.sofa.sofa_24hours",
          "mimiciv_derived.sofa.endtime",
          "mimiciv_derived.sofa.stay_id",
          "sofa.endtime",
          "mimiciv_derived.suspicion_of_infection.suspected_infection_time",
          "mimiciv_derived.suspicion_of_infection.culture_time",
          "mimiciv_derived.suspicion_of_infection.suspected_infection"
        ]
      ],
      "liver": [
        ["sofa.liver"],
        [
          "mimiciv_derived.suspicion_of_infection.stay_id",
          "mimiciv_derived.suspicion_of_infection.sofa_score",
          "mimiciv_derived.suspicion_of_infection.antibiotic_time",
          "mimiciv_derived.sofa.sofa_24hours",
          "mimiciv_derived.sofa.endtime",
          "mimiciv_derived.sofa.stay_id",
          "sofa.endtime",
          "mimiciv_derived.suspicion_of_infection.suspected_infection_time",
          "mimiciv_derived.suspicion_of_infection.culture_time",
          "mimiciv_derived.suspicion_of_infection.suspected_infection"
        ]
      ],
      "cardiovascular": [
        ["sofa.cardiovascular"],
        [
          "mimiciv_derived.suspicion_of_infection.stay_id",
          "mimiciv_derived.suspicion_of_infection.sofa_score",
          "mimiciv_derived.suspicion_of_infection.antibiotic_time",
          "mimiciv_derived.sofa.sofa_24hours",
          "mimiciv_derived.sofa.endtime",
          "mimiciv_derived.sofa.stay_id",
          "sofa.endtime",
          "mimiciv_derived.suspicion_of_infection.suspected_infection_time",
          "mimiciv_derived.suspicion_of_infection.culture_time",
          "mimiciv_derived.suspicion_of_infection.suspected_infection"
        ]
      ],
      "cns": [
        ["sofa.cns"],
        [
          "mimiciv_derived.suspicion_of_infection.stay_id",
          "mimiciv_derived.suspicion_of_infection.sofa_score",
          "mimiciv_derived.suspicion_of_infection.antibiotic_time",
          "mimiciv_derived.sofa.sofa_24hours",
          "mimiciv_derived.sofa.endtime",
          "mimiciv_derived.sofa.stay_id",
          "sofa.endtime",
          "mimiciv_derived.suspicion_of_infection.suspected_infection_time",
          "mimiciv_derived.suspicion_of_infection.culture_time",
          "mimiciv_derived.suspicion_of_infection.suspected_infection"
        ]
      ],
      "renal": [
        ["sofa.renal"],
        [
          "mimiciv_derived.suspicion_of_infection.stay_id",
          "mimiciv_derived.suspicion_of_infection.sofa_score",
          "mimiciv_derived.suspicion_of_infection.antibiotic_time",
          "mimiciv_derived.sofa.sofa_24hours",
          "mimiciv_derived.sofa.endtime",
          "mimiciv_derived.sofa.stay_id",
          "sofa.endtime",
          "mimiciv_derived.suspicion_of_infection.suspected_infection_time",
          "mimiciv_derived.suspicion_of_infection.culture_time",
          "mimiciv_derived.suspicion_of_infection.suspected_infection"
        ]
      ],
      "sepsis3": [
        [
          "mimiciv_derived.suspicion_of_infection.sofa_score",
          "mimiciv_derived.suspicion_of_infection.suspected_infection"
        ],
        [
          "mimiciv_derived.suspicion_of_infection.stay_id",
          "mimiciv_derived.suspicion_of_infection.sofa_score",
          "mimiciv_derived.suspicion_of_infection.antibiotic_time",
          "mimiciv_derived.sofa.sofa_24hours",
          "mimiciv_derived.sofa.endtime",
          "mimiciv_derived.sofa.stay_id",
          "sofa.endtime",
          "mimiciv_derived.suspicion_of_infection.suspected_infection_time",
          "mimiciv_derived.suspicion_of_infection.culture_time",
          "mimiciv_derived.suspicion_of_infection.suspected_infection"
        ]
      ]
    },
    "table_name": "sepsis3",
    "sql": "WITH sofa AS ( SELECT stay_id,starttime,endtime,respiration_24hours AS respiration,coagulation_24hours AS coagulation,liver_24hours AS liver,cardiovascular_24hours AS cardiovascular,cns_24hours AS cns,renal_24hours AS renal,sofa_24hours AS sofa_score FROM mimiciv_derived.sofa WHERE sofa_24hours >= 2 ),s1 AS ( SELECT soi.subject_id,soi.stay_id,soi.ab_id,soi.antibiotic,soi.antibiotic_time,soi.culture_time,soi.suspected_infection,soi.suspected_infection_time,soi.specimen,soi.positive_culture,starttime,endtime,respiration,coagulation,liver,cardiovascular,cns,renal,sofa_score,sofa_score >= 2 AND suspected_infection = 1 AS sepsis3,ROW_NUMBER() OVER ( PARTITION BY soi.stay_id ORDER BY suspected_infection_time,antibiotic_time,culture_time,endtime ) AS rn_sus FROM mimiciv_derived.suspicion_of_infection AS soi INNER JOIN sofa ON soi.stay_id = sofa.stay_id AND sofa.endtime >= DATETIME_SUB( soi.suspected_infection_time,INTERVAL '48' HOUR ) AND sofa.endtime <= DATETIME_ADD( soi.suspected_infection_time,INTERVAL '24' HOUR ) WHERE soi.stay_id IS NOT NULL ) SELECT subject_id,stay_id,antibiotic_time,culture_time,suspected_infection_time,endtime AS sofa_time,sofa_score,respiration,coagulation,liver,cardiovascular,cns,renal,sepsis3 FROM s1 WHERE rn_sus = 1"
  },
  "invasive_line": {
    "tables": ["mimiciv_icu.procedureevents", "mimiciv_icu.d_items"],
    "columns": {
      "stay_id": [
        ["stay_id"],
        [
          "mimiciv_icu.procedureevents.location",
          "mimiciv_icu.d_items.label",
          "starttime",
          "mimiciv_icu.d_items.itemid",
          "stay_id",
          "mimiciv_icu.procedureevents.itemid"
        ]
      ],
      "line_type": [
        ["mimiciv_icu.d_items.label"],
        [
          "mimiciv_icu.procedureevents.location",
          "mimiciv_icu.d_items.label",
          "starttime",
          "mimiciv_icu.d_items.itemid",
          "stay_id",
          "mimiciv_icu.procedureevents.itemid"
        ]
      ],
      "line_site": [
        ["mimiciv_icu.procedureevents.location"],
        [
          "mimiciv_icu.procedureevents.location",
          "mimiciv_icu.d_items.label",
          "starttime",
          "mimiciv_icu.d_items.itemid",
          "stay_id",
          "mimiciv_icu.procedureevents.itemid"
        ]
      ],
      "starttime": [
        ["starttime"],
        [
          "mimiciv_icu.procedureevents.location",
          "mimiciv_icu.d_items.label",
          "starttime",
          "mimiciv_icu.d_items.itemid",
          "stay_id",
          "mimiciv_icu.procedureevents.itemid"
        ]
      ],
      "endtime": [
        ["endtime"],
        [
          "mimiciv_icu.procedureevents.location",
          "mimiciv_icu.d_items.label",
          "starttime",
          "mimiciv_icu.d_items.itemid",
          "stay_id",
          "mimiciv_icu.procedureevents.itemid"
        ]
      ]
    },
    "table_name": "invasive_line",
    "sql": "WITH mv AS ( SELECT stay_id,mv.itemid AS line_number,di.label AS line_type,mv.location AS line_site,starttime,endtime FROM mimiciv_icu.procedureevents mv INNER JOIN mimiciv_icu.d_items di ON mv.itemid = di.itemid WHERE mv.itemid IN ( 227719,225752,224269,224267,224270,224272,226124,228169,225202,228286,225204,224263,224560,224264,225203,224273,225789,225761,228201,228202,224268,225199,225315,225205 ) ) SELECT stay_id,CASE WHEN line_type IN ('Arterial Line','A-Line') THEN 'Arterial' WHEN line_type IN ( 'CCO PA Line','CCO PAC' ) THEN 'Continuous Cardiac Output PA' WHEN line_type IN ('Dialysis Catheter','Dialysis Line') THEN 'Dialysis' WHEN line_type IN ('Hickman','Tunneled (Hickman) Line') THEN 'Hickman' WHEN line_type IN ('IABP','IABP line') THEN 'IABP' WHEN line_type IN ('Multi Lumen','Multi-lumen') THEN 'Multi Lumen' WHEN line_type IN ('PA Catheter','PA line') THEN 'PA' WHEN line_type IN ('PICC Line','PICC line') THEN 'PICC' WHEN line_type IN ('Pre-Sep Catheter','Presep Catheter') THEN 'Pre-Sep' WHEN line_type IN ('Trauma Line','Trauma line') THEN 'Trauma' WHEN line_type IN ( 'Triple Introducer','TripleIntroducer' ) THEN 'Triple Introducer' WHEN line_type IN ( 'Portacath','Indwelling Port (PortaCath)' ) THEN 'Portacath' ELSE line_type END AS line_type,CASE WHEN line_site IN ('Left Antecub','Left Antecube') THEN 'Left Antecube' WHEN line_site IN ('Left Axilla','Left Axilla.') THEN 'Left Axilla' WHEN line_site IN ( 'Left Brachial','Left Brachial.' ) THEN 'Left Brachial' WHEN line_site IN ('Left Femoral','Left Femoral.') THEN 'Left Femoral' WHEN line_site IN ( 'Right Antecub','Right Antecube' ) THEN 'Right Antecube' WHEN line_site IN ('Right Axilla','Right Axilla.') THEN 'Right Axilla' WHEN line_site IN ( 'Right Brachial','Right Brachial.' ) THEN 'Right Brachial' WHEN line_site IN ( 'Right Femoral','Right Femoral.' ) THEN 'Right Femoral' ELSE line_site END AS line_site,starttime,endtime FROM mv ORDER BY stay_id,starttime,line_type,line_site"
  },
  "mimiciv_derived.age": {
    "tables": ["mimiciv_hosp.patients", "mimiciv_hosp.admissions"],
    "columns": {
      "subject_id": [
        ["mimiciv_hosp.admissions.subject_id"],
        [
          "mimiciv_hosp.admissions.subject_id",
          "mimiciv_hosp.patients.subject_id"
        ]
      ],
      "hadm_id": [
        ["mimiciv_hosp.admissions.hadm_id"],
        [
          "mimiciv_hosp.admissions.subject_id",
          "mimiciv_hosp.patients.subject_id"
        ]
      ],
      "admittime": [
        ["mimiciv_hosp.admissions.admittime"],
        [
          "mimiciv_hosp.admissions.subject_id",
          "mimiciv_hosp.patients.subject_id"
        ]
      ],
      "anchor_age": [
        ["mimiciv_hosp.patients.anchor_age"],
        [
          "mimiciv_hosp.admissions.subject_id",
          "mimiciv_hosp.patients.subject_id"
        ]
      ],
      "anchor_year": [
        ["mimiciv_hosp.patients.anchor_year"],
        [
          "mimiciv_hosp.admissions.subject_id",
          "mimiciv_hosp.patients.subject_id"
        ]
      ],
      "age": [
        [
          "mimiciv_hosp.admissions.admittime",
          "mimiciv_hosp.patients.anchor_age",
          "mimiciv_hosp.patients.anchor_year"
        ],
        [
          "mimiciv_hosp.admissions.subject_id",
          "mimiciv_hosp.patients.subject_id"
        ]
      ]
    },
    "table_name": "mimiciv_derived.age",
    "sql": "SELECT ad.subject_id,ad.hadm_id,ad.admittime,pa.anchor_age,pa.anchor_year,pa.anchor_age + DATETIME_DIFF(ad.admittime,DATETIME(pa.anchor_year,1,1,0,0,0),'YEAR') AS age FROM mimiciv_hosp.admissions ad INNER JOIN mimiciv_hosp.patients pa ON ad.subject_id = pa.subject_id"
  },
  "mimiciv_derived.icustay_hourly": {
    "tables": ["mimiciv_derived.icustay_times"],
    "columns": {
      "stay_id": [
        ["mimiciv_derived.icustay_times.stay_id"],
        [
          "mimiciv_derived.icustay_times.intime_hr",
          "mimiciv_derived.icustay_times.outtime_hr"
        ]
      ],
      "hr": [
        [
          "mimiciv_derived.icustay_times.intime_hr",
          "mimiciv_derived.icustay_times.outtime_hr"
        ],
        [
          "mimiciv_derived.icustay_times.intime_hr",
          "mimiciv_derived.icustay_times.outtime_hr"
        ]
      ],
      "endtime": [
        [
          "mimiciv_derived.icustay_times.intime_hr",
          "mimiciv_derived.icustay_times.outtime_hr"
        ],
        [
          "mimiciv_derived.icustay_times.intime_hr",
          "mimiciv_derived.icustay_times.outtime_hr"
        ]
      ]
    },
    "table_name": "mimiciv_derived.icustay_hourly",
    "sql": "WITH all_hours AS ( SELECT it.stay_id,PARSE_DATETIME( '%Y-%m-%d %H:00:00',FORMAT_DATETIME( '%Y-%m-%d %H:00:00',DATETIME_ADD(it.intime_hr,INTERVAL '59' MINUTE) )) AS endtime,ARRAY(SELECT * FROM generate_series(-24,CEIL(DATETIME_DIFF(it.outtime_hr,it.intime_hr,'HOUR')))) AS hrs FROM mimiciv_derived.icustay_times it ) SELECT stay_id,CAST(hr AS bigint) AS hr,DATETIME_ADD(endtime,interval '1' hour * CAST(hr AS bigint)) AS endtime FROM all_hours CROSS JOIN UNNEST(all_hours.hrs) AS hr"
  },
  "mimiciv_derived.icustay_times": {
    "tables": ["mimiciv_icu.chartevents", "mimiciv_icu.icustays"],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.icustays.subject_id"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "hadm_id": [
        ["mimiciv_icu.icustays.hadm_id"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "intime_hr": [
        ["mimiciv_icu.chartevents.charttime"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ],
      "outtime_hr": [
        ["mimiciv_icu.chartevents.charttime"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.stay_id"
        ]
      ]
    },
    "table_name": "mimiciv_derived.icustay_times",
    "sql": "WITH t1 AS ( SELECT ce.stay_id,MIN(charttime) AS intime_hr,MAX(charttime) AS outtime_hr FROM mimiciv_icu.chartevents ce WHERE ce.itemid = 220045 GROUP BY ce.stay_id ) SELECT ie.subject_id,ie.hadm_id,ie.stay_id,t1.intime_hr,t1.outtime_hr FROM mimiciv_icu.icustays ie LEFT JOIN t1 ON ie.stay_id = t1.stay_id"
  },
  "mimiciv_derived.weight_durations": {
    "tables": ["mimiciv_icu.chartevents", "mimiciv_icu.icustays"],
    "columns": {
      "stay_id": [
        ["mimiciv_icu.chartevents.stay_id"],
        [
          "mimiciv_icu.icustays.outtime",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "starttime": [
        [
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime"
        ],
        [
          "mimiciv_icu.icustays.outtime",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "endtime": [
        [
          "mimiciv_icu.icustays.outtime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime"
        ],
        [
          "mimiciv_icu.icustays.outtime",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "weight": [
        ["mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.icustays.outtime",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "weight_type": [
        ["mimiciv_icu.chartevents.itemid"],
        [
          "mimiciv_icu.icustays.outtime",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.chartevents.itemid"
        ]
      ]
    },
    "table_name": "mimiciv_derived.weight_durations",
    "sql": "WITH wt_stg AS ( SELECT c.stay_id,c.charttime,CASE WHEN c.itemid = 226512 THEN 'admit' ELSE 'daily' END AS weight_type,c.valuenum AS weight FROM mimiciv_icu.chartevents c WHERE c.valuenum IS NOT NULL AND c.itemid IN ( 226512,224639 ) AND c.valuenum > 0 ),wt_stg1 AS ( SELECT stay_id,charttime,weight_type,weight,ROW_NUMBER() OVER ( PARTITION BY stay_id,weight_type ORDER BY charttime ) AS rn FROM wt_stg WHERE weight IS NOT NULL ),wt_stg2 AS ( SELECT wt_stg1.stay_id,ie.intime,ie.outtime,wt_stg1.weight_type,CASE WHEN wt_stg1.weight_type = 'admit' AND wt_stg1.rn = 1 THEN DATETIME_SUB(ie.intime,INTERVAL '2' HOUR) ELSE wt_stg1.charttime END AS starttime,wt_stg1.weight FROM wt_stg1 INNER JOIN mimiciv_icu.icustays ie ON ie.stay_id = wt_stg1.stay_id ),wt_stg3 AS ( SELECT stay_id,intime,outtime,starttime,COALESCE( LEAD(starttime) OVER (PARTITION BY stay_id ORDER BY starttime),DATETIME_ADD(outtime,INTERVAL '2' HOUR) ) AS endtime,weight,weight_type FROM wt_stg2 ),wt1 AS ( SELECT stay_id,starttime,COALESCE( endtime,LEAD( starttime ) OVER (PARTITION BY stay_id ORDER BY starttime),DATETIME_ADD(outtime,INTERVAL '2' HOUR) ) AS endtime,weight,weight_type FROM wt_stg3 ),wt_fix AS ( SELECT ie.stay_id,DATETIME_SUB(ie.intime,INTERVAL '2' HOUR) AS starttime,wt.starttime AS endtime,wt.weight,wt.weight_type FROM mimiciv_icu.icustays ie INNER JOIN ( SELECT wt1.stay_id,wt1.starttime,wt1.weight,weight_type,ROW_NUMBER() OVER ( PARTITION BY wt1.stay_id ORDER BY wt1.starttime ) AS rn FROM wt1 ) wt ON ie.stay_id = wt.stay_id AND wt.rn = 1 AND ie.intime < wt.starttime ) SELECT wt1.stay_id,wt1.starttime,wt1.endtime,wt1.weight,wt1.weight_type FROM wt1 UNION ALL SELECT wt_fix.stay_id,wt_fix.starttime,wt_fix.endtime,wt_fix.weight,wt_fix.weight_type FROM wt_fix"
  },
  "mimiciv_derived.first_day_bg_art": {
    "tables": ["mimiciv_derived.bg", "mimiciv_icu.icustays"],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.icustays.subject_id"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "lactate_min": [
        ["lactate"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "lactate_max": [
        ["lactate"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "ph_min": [
        ["ph"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "ph_max": [
        ["ph"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "so2_min": [
        ["so2"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "so2_max": [
        ["so2"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "po2_min": [
        ["po2"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "po2_max": [
        ["po2"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "pco2_min": [
        ["pco2"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "pco2_max": [
        ["pco2"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "aado2_min": [
        ["aado2"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "aado2_max": [
        ["aado2"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "aado2_calc_min": [
        ["aado2_calc"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "aado2_calc_max": [
        ["aado2_calc"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "pao2fio2ratio_min": [
        ["pao2fio2ratio"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "pao2fio2ratio_max": [
        ["pao2fio2ratio"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "baseexcess_min": [
        ["baseexcess"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "baseexcess_max": [
        ["baseexcess"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "bicarbonate_min": [
        ["bicarbonate"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "bicarbonate_max": [
        ["bicarbonate"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "totalco2_min": [
        ["totalco2"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "totalco2_max": [
        ["totalco2"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "hematocrit_min": [
        ["hematocrit"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "hematocrit_max": [
        ["hematocrit"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "hemoglobin_min": [
        ["hemoglobin"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "hemoglobin_max": [
        ["hemoglobin"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "carboxyhemoglobin_min": [
        ["carboxyhemoglobin"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "carboxyhemoglobin_max": [
        ["carboxyhemoglobin"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "methemoglobin_min": [
        ["methemoglobin"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "methemoglobin_max": [
        ["methemoglobin"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "temperature_min": [
        ["temperature"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "temperature_max": [
        ["temperature"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "chloride_min": [
        ["chloride"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "chloride_max": [
        ["chloride"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "calcium_min": [
        ["calcium"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "calcium_max": [
        ["calcium"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "glucose_min": [
        ["glucose"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "glucose_max": [
        ["glucose"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "potassium_min": [
        ["potassium"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "potassium_max": [
        ["potassium"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "sodium_min": [
        ["sodium"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "sodium_max": [
        ["sodium"],
        [
          "mimiciv_derived.bg.specimen",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ]
    },
    "table_name": "mimiciv_derived.first_day_bg_art",
    "sql": "SELECT ie.subject_id,ie.stay_id,MIN(lactate) AS lactate_min,MAX(lactate) AS lactate_max,MIN(ph) AS ph_min,MAX(ph) AS ph_max,MIN(so2) AS so2_min,MAX(so2) AS so2_max,MIN(po2) AS po2_min,MAX(po2) AS po2_max,MIN(pco2) AS pco2_min,MAX(pco2) AS pco2_max,MIN(aado2) AS aado2_min,MAX(aado2) AS aado2_max,MIN(aado2_calc) AS aado2_calc_min,MAX(aado2_calc) AS aado2_calc_max,MIN(pao2fio2ratio) AS pao2fio2ratio_min,MAX(pao2fio2ratio) AS pao2fio2ratio_max,MIN(baseexcess) AS baseexcess_min,MAX(baseexcess) AS baseexcess_max,MIN(bicarbonate) AS bicarbonate_min,MAX(bicarbonate) AS bicarbonate_max,MIN(totalco2) AS totalco2_min,MAX(totalco2) AS totalco2_max,MIN(hematocrit) AS hematocrit_min,MAX(hematocrit) AS hematocrit_max,MIN(hemoglobin) AS hemoglobin_min,MAX(hemoglobin) AS hemoglobin_max,MIN(carboxyhemoglobin) AS carboxyhemoglobin_min,MAX(carboxyhemoglobin) AS carboxyhemoglobin_max,MIN(methemoglobin) AS methemoglobin_min,MAX(methemoglobin) AS methemoglobin_max,MIN(temperature) AS temperature_min,MAX(temperature) AS temperature_max,MIN(chloride) AS chloride_min,MAX(chloride) AS chloride_max,MIN(calcium) AS calcium_min,MAX(calcium) AS calcium_max,MIN(glucose) AS glucose_min,MAX(glucose) AS glucose_max,MIN(potassium) AS potassium_min,MAX(potassium) AS potassium_max,MIN(sodium) AS sodium_min,MAX(sodium) AS sodium_max FROM mimiciv_icu.icustays ie LEFT JOIN mimiciv_derived.bg bg ON ie.subject_id = bg.subject_id AND bg.specimen = 'ART.' AND bg.charttime >= DATETIME_SUB(ie.intime,INTERVAL '6' HOUR) AND bg.charttime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) GROUP BY ie.subject_id,ie.stay_id"
  },
  "mimiciv_derived.first_day_gcs": {
    "tables": ["mimiciv_derived.gcs", "mimiciv_icu.icustays"],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.icustays.subject_id"],
        [
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.gcs.gcs"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.gcs.gcs"
        ]
      ],
      "gcs_min": [
        ["mimiciv_derived.gcs.gcs"],
        [
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.gcs.gcs"
        ]
      ],
      "gcs_motor": [
        ["mimiciv_derived.gcs.gcs_motor"],
        [
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.gcs.gcs"
        ]
      ],
      "gcs_verbal": [
        ["mimiciv_derived.gcs.gcs_verbal"],
        [
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.gcs.gcs"
        ]
      ],
      "gcs_eyes": [
        ["mimiciv_derived.gcs.gcs_eyes"],
        [
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.gcs.gcs"
        ]
      ],
      "gcs_unable": [
        ["mimiciv_derived.gcs.gcs_unable"],
        [
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.gcs.charttime",
          "mimiciv_derived.gcs.gcs"
        ]
      ]
    },
    "table_name": "mimiciv_derived.first_day_gcs",
    "sql": "WITH gcs_final AS ( SELECT ie.subject_id,ie.stay_id,g.gcs,g.gcs_motor,g.gcs_verbal,g.gcs_eyes,g.gcs_unable,ROW_NUMBER() OVER ( PARTITION BY g.stay_id ORDER BY g.gcs ) AS gcs_seq FROM mimiciv_icu.icustays ie LEFT JOIN mimiciv_derived.gcs g ON ie.stay_id = g.stay_id AND g.charttime >= DATETIME_SUB(ie.intime,INTERVAL '6' HOUR) AND g.charttime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) ) SELECT ie.subject_id,ie.stay_id,gcs AS gcs_min,gcs_motor,gcs_verbal,gcs_eyes,gcs_unable FROM mimiciv_icu.icustays ie LEFT JOIN gcs_final gs ON ie.stay_id = gs.stay_id AND gs.gcs_seq = 1"
  },
  "mimiciv_derived.first_day_lab": {
    "tables": [
      "mimiciv_derived.enzyme",
      "mimiciv_derived.chemistry",
      "mimiciv_derived.complete_blood_count",
      "mimiciv_derived.blood_differential",
      "mimiciv_derived.coagulation",
      "mimiciv_icu.icustays"
    ],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.icustays.subject_id"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "hematocrit_min": [
        ["hematocrit"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "hematocrit_max": [
        ["hematocrit"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "hemoglobin_min": [
        ["hemoglobin"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "hemoglobin_max": [
        ["hemoglobin"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "platelets_min": [
        ["platelet"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "platelets_max": [
        ["platelet"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "wbc_min": [
        ["wbc"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "wbc_max": [
        ["wbc"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "albumin_min": [
        ["albumin"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "albumin_max": [
        ["albumin"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "globulin_min": [
        ["globulin"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "globulin_max": [
        ["globulin"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "total_protein_min": [
        ["total_protein"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "total_protein_max": [
        ["total_protein"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "aniongap_min": [
        ["aniongap"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "aniongap_max": [
        ["aniongap"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "bicarbonate_min": [
        ["bicarbonate"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "bicarbonate_max": [
        ["bicarbonate"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "bun_min": [
        ["bun"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "bun_max": [
        ["bun"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "calcium_min": [
        ["calcium"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "calcium_max": [
        ["calcium"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "chloride_min": [
        ["chloride"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "chloride_max": [
        ["chloride"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "creatinine_min": [
        ["creatinine"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "creatinine_max": [
        ["creatinine"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "glucose_min": [
        ["glucose"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "glucose_max": [
        ["glucose"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "sodium_min": [
        ["sodium"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "sodium_max": [
        ["sodium"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "potassium_min": [
        ["potassium"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "potassium_max": [
        ["potassium"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "basophils_abs_min": [
        ["basophils_abs"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "basophils_abs_max": [
        ["basophils_abs"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "eosinophils_abs_min": [
        ["eosinophils_abs"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "eosinophils_abs_max": [
        ["eosinophils_abs"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "lymphocytes_abs_min": [
        ["lymphocytes_abs"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "lymphocytes_abs_max": [
        ["lymphocytes_abs"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "monocytes_abs_min": [
        ["monocytes_abs"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "monocytes_abs_max": [
        ["monocytes_abs"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "neutrophils_abs_min": [
        ["neutrophils_abs"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "neutrophils_abs_max": [
        ["neutrophils_abs"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "atypical_lymphocytes_min": [
        ["atypical_lymphocytes"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "atypical_lymphocytes_max": [
        ["atypical_lymphocytes"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "bands_min": [
        ["bands"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "bands_max": [
        ["bands"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "immature_granulocytes_min": [
        ["immature_granulocytes"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "immature_granulocytes_max": [
        ["immature_granulocytes"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "metamyelocytes_min": [
        ["metamyelocytes"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "metamyelocytes_max": [
        ["metamyelocytes"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "nrbc_min": [
        ["nrbc"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "nrbc_max": [
        ["nrbc"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "d_dimer_min": [
        ["d_dimer"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "d_dimer_max": [
        ["d_dimer"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "fibrinogen_min": [
        ["fibrinogen"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "fibrinogen_max": [
        ["fibrinogen"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "thrombin_min": [
        ["thrombin"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "thrombin_max": [
        ["thrombin"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "inr_min": [
        ["inr"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "inr_max": [
        ["inr"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "pt_min": [
        ["pt"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "pt_max": [
        ["pt"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "ptt_min": [
        ["ptt"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "ptt_max": [
        ["ptt"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "alt_min": [
        ["alt"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "alt_max": [
        ["alt"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "alp_min": [
        ["alp"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "alp_max": [
        ["alp"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "ast_min": [
        ["ast"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "ast_max": [
        ["ast"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "amylase_min": [
        ["amylase"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "amylase_max": [
        ["amylase"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "bilirubin_total_min": [
        ["bilirubin_total"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "bilirubin_total_max": [
        ["bilirubin_total"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "bilirubin_direct_min": [
        ["bilirubin_direct"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "bilirubin_direct_max": [
        ["bilirubin_direct"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "bilirubin_indirect_min": [
        ["bilirubin_indirect"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "bilirubin_indirect_max": [
        ["bilirubin_indirect"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "ck_cpk_min": [
        ["ck_cpk"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "ck_cpk_max": [
        ["ck_cpk"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "ck_mb_min": [
        ["ck_mb"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "ck_mb_max": [
        ["ck_mb"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "ggt_min": [
        ["ggt"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "ggt_max": [
        ["ggt"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "ld_ldh_min": [
        ["ld_ldh"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ],
      "ld_ldh_max": [
        ["ld_ldh"],
        [
          "mimiciv_derived.blood_differential.charttime",
          "mimiciv_derived.coagulation.subject_id",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.enzyme.subject_id",
          "mimiciv_derived.complete_blood_count.subject_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_derived.blood_differential.subject_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.coagulation.charttime",
          "mimiciv_derived.chemistry.subject_id"
        ]
      ]
    },
    "table_name": "mimiciv_derived.first_day_lab",
    "sql": "WITH cbc AS ( SELECT ie.stay_id,MIN(hematocrit) as hematocrit_min,MAX(hematocrit) as hematocrit_max,MIN(hemoglobin) as hemoglobin_min,MAX(hemoglobin) as hemoglobin_max,MIN(platelet) as platelets_min,MAX(platelet) as platelets_max,MIN(wbc) as wbc_min,MAX(wbc) as wbc_max FROM mimiciv_icu.icustays ie LEFT JOIN mimiciv_derived.complete_blood_count le ON le.subject_id = ie.subject_id AND le.charttime >= DATETIME_SUB(ie.intime,INTERVAL '6' HOUR) AND le.charttime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) GROUP BY ie.stay_id ),chem AS ( SELECT ie.stay_id,MIN(albumin) AS albumin_min,MAX(albumin) AS albumin_max,MIN(globulin) AS globulin_min,MAX(globulin) AS globulin_max,MIN(total_protein) AS total_protein_min,MAX(total_protein) AS total_protein_max,MIN(aniongap) AS aniongap_min,MAX(aniongap) AS aniongap_max,MIN(bicarbonate) AS bicarbonate_min,MAX(bicarbonate) AS bicarbonate_max,MIN(bun) AS bun_min,MAX(bun) AS bun_max,MIN(calcium) AS calcium_min,MAX(calcium) AS calcium_max,MIN(chloride) AS chloride_min,MAX(chloride) AS chloride_max,MIN(creatinine) AS creatinine_min,MAX(creatinine) AS creatinine_max,MIN(glucose) AS glucose_min,MAX(glucose) AS glucose_max,MIN(sodium) AS sodium_min,MAX(sodium) AS sodium_max,MIN(potassium) AS potassium_min,MAX(potassium) AS potassium_max FROM mimiciv_icu.icustays ie LEFT JOIN mimiciv_derived.chemistry le ON le.subject_id = ie.subject_id AND le.charttime >= DATETIME_SUB(ie.intime,INTERVAL '6' HOUR) AND le.charttime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) GROUP BY ie.stay_id ),diff AS ( SELECT ie.stay_id,MIN(basophils_abs) AS basophils_abs_min,MAX(basophils_abs) AS basophils_abs_max,MIN(eosinophils_abs) AS eosinophils_abs_min,MAX(eosinophils_abs) AS eosinophils_abs_max,MIN(lymphocytes_abs) AS lymphocytes_abs_min,MAX(lymphocytes_abs) AS lymphocytes_abs_max,MIN(monocytes_abs) AS monocytes_abs_min,MAX(monocytes_abs) AS monocytes_abs_max,MIN(neutrophils_abs) AS neutrophils_abs_min,MAX(neutrophils_abs) AS neutrophils_abs_max,MIN(atypical_lymphocytes) AS atypical_lymphocytes_min,MAX(atypical_lymphocytes) AS atypical_lymphocytes_max,MIN(bands) AS bands_min,MAX(bands) AS bands_max,MIN(immature_granulocytes) AS immature_granulocytes_min,MAX(immature_granulocytes) AS immature_granulocytes_max,MIN(metamyelocytes) AS metamyelocytes_min,MAX(metamyelocytes) AS metamyelocytes_max,MIN(nrbc) AS nrbc_min,MAX(nrbc) AS nrbc_max FROM mimiciv_icu.icustays ie LEFT JOIN mimiciv_derived.blood_differential le ON le.subject_id = ie.subject_id AND le.charttime >= DATETIME_SUB(ie.intime,INTERVAL '6' HOUR) AND le.charttime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) GROUP BY ie.stay_id ),coag AS ( SELECT ie.stay_id,MIN(d_dimer) AS d_dimer_min,MAX(d_dimer) AS d_dimer_max,MIN(fibrinogen) AS fibrinogen_min,MAX(fibrinogen) AS fibrinogen_max,MIN(thrombin) AS thrombin_min,MAX(thrombin) AS thrombin_max,MIN(inr) AS inr_min,MAX(inr) AS inr_max,MIN(pt) AS pt_min,MAX(pt) AS pt_max,MIN(ptt) AS ptt_min,MAX(ptt) AS ptt_max FROM mimiciv_icu.icustays ie LEFT JOIN mimiciv_derived.coagulation le ON le.subject_id = ie.subject_id AND le.charttime >= DATETIME_SUB(ie.intime,INTERVAL '6' HOUR) AND le.charttime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) GROUP BY ie.stay_id ),enz AS ( SELECT ie.stay_id,MIN(alt) AS alt_min,MAX(alt) AS alt_max,MIN(alp) AS alp_min,MAX(alp) AS alp_max,MIN(ast) AS ast_min,MAX(ast) AS ast_max,MIN(amylase) AS amylase_min,MAX(amylase) AS amylase_max,MIN(bilirubin_total) AS bilirubin_total_min,MAX(bilirubin_total) AS bilirubin_total_max,MIN(bilirubin_direct) AS bilirubin_direct_min,MAX(bilirubin_direct) AS bilirubin_direct_max,MIN(bilirubin_indirect) AS bilirubin_indirect_min,MAX(bilirubin_indirect) AS bilirubin_indirect_max,MIN(ck_cpk) AS ck_cpk_min,MAX(ck_cpk) AS ck_cpk_max,MIN(ck_mb) AS ck_mb_min,MAX(ck_mb) AS ck_mb_max,MIN(ggt) AS ggt_min,MAX(ggt) AS ggt_max,MIN(ld_ldh) AS ld_ldh_min,MAX(ld_ldh) AS ld_ldh_max FROM mimiciv_icu.icustays ie LEFT JOIN mimiciv_derived.enzyme le ON le.subject_id = ie.subject_id AND le.charttime >= DATETIME_SUB(ie.intime,INTERVAL '6' HOUR) AND le.charttime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) GROUP BY ie.stay_id ) SELECT ie.subject_id,ie.stay_id,hematocrit_min,hematocrit_max,hemoglobin_min,hemoglobin_max,platelets_min,platelets_max,wbc_min,wbc_max,albumin_min,albumin_max,globulin_min,globulin_max,total_protein_min,total_protein_max,aniongap_min,aniongap_max,bicarbonate_min,bicarbonate_max,bun_min,bun_max,calcium_min,calcium_max,chloride_min,chloride_max,creatinine_min,creatinine_max,glucose_min,glucose_max,sodium_min,sodium_max,potassium_min,potassium_max,basophils_abs_min,basophils_abs_max,eosinophils_abs_min,eosinophils_abs_max,lymphocytes_abs_min,lymphocytes_abs_max,monocytes_abs_min,monocytes_abs_max,neutrophils_abs_min,neutrophils_abs_max,atypical_lymphocytes_min,atypical_lymphocytes_max,bands_min,bands_max,immature_granulocytes_min,immature_granulocytes_max,metamyelocytes_min,metamyelocytes_max,nrbc_min,nrbc_max,d_dimer_min,d_dimer_max,fibrinogen_min,fibrinogen_max,thrombin_min,thrombin_max,inr_min,inr_max,pt_min,pt_max,ptt_min,ptt_max,alt_min,alt_max,alp_min,alp_max,ast_min,ast_max,amylase_min,amylase_max,bilirubin_total_min,bilirubin_total_max,bilirubin_direct_min,bilirubin_direct_max,bilirubin_indirect_min,bilirubin_indirect_max,ck_cpk_min,ck_cpk_max,ck_mb_min,ck_mb_max,ggt_min,ggt_max,ld_ldh_min,ld_ldh_max FROM mimiciv_icu.icustays ie LEFT JOIN cbc ON ie.stay_id = cbc.stay_id LEFT JOIN chem ON ie.stay_id = chem.stay_id LEFT JOIN diff ON ie.stay_id = diff.stay_id LEFT JOIN coag ON ie.stay_id = coag.stay_id LEFT JOIN enz ON ie.stay_id = enz.stay_id"
  },
  "mimiciv_derived.first_day_rrt": {
    "tables": ["mimiciv_derived.rrt", "mimiciv_icu.icustays"],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.icustays.subject_id"],
        [
          "mimiciv_derived.rrt.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.rrt.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_derived.rrt.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.rrt.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "dialysis_present": [
        ["dialysis_present"],
        [
          "mimiciv_derived.rrt.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.rrt.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "dialysis_active": [
        ["dialysis_active"],
        [
          "mimiciv_derived.rrt.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.rrt.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "dialysis_type": [
        ["dialysis_type"],
        [
          "mimiciv_derived.rrt.charttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.rrt.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ]
    },
    "table_name": "mimiciv_derived.first_day_rrt",
    "sql": "SELECT ie.subject_id,ie.stay_id,MAX(dialysis_present) AS dialysis_present,MAX(dialysis_active) AS dialysis_active,STRING_AGG(DISTINCT dialysis_type,',') AS dialysis_type FROM mimiciv_icu.icustays ie LEFT JOIN mimiciv_derived.rrt rrt ON ie.stay_id = rrt.stay_id AND rrt.charttime >= DATETIME_SUB(ie.intime,INTERVAL '6' HOUR) AND rrt.charttime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) GROUP BY ie.subject_id,ie.stay_id"
  },
  "mimiciv_derived.first_day_urine_output": {
    "tables": ["mimiciv_derived.urine_output", "mimiciv_icu.icustays"],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.icustays.subject_id"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "urineoutput": [
        ["urineoutput"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ]
    },
    "table_name": "mimiciv_derived.first_day_urine_output",
    "sql": "SELECT ie.subject_id,ie.stay_id,SUM(urineoutput) AS urineoutput FROM mimiciv_icu.icustays ie LEFT JOIN mimiciv_derived.urine_output uo ON ie.stay_id = uo.stay_id AND uo.charttime >= ie.intime AND uo.charttime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) GROUP BY ie.subject_id,ie.stay_id"
  },
  "mimiciv_derived.first_day_vitalsign": {
    "tables": ["mimiciv_derived.vitalsign", "mimiciv_icu.icustays"],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.icustays.subject_id"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "heart_rate_min": [
        ["heart_rate"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "heart_rate_max": [
        ["heart_rate"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "heart_rate_mean": [
        ["heart_rate"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "sbp_min": [
        ["sbp"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "sbp_max": [
        ["sbp"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "sbp_mean": [
        ["sbp"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "dbp_min": [
        ["dbp"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "dbp_max": [
        ["dbp"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "dbp_mean": [
        ["dbp"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "mbp_min": [
        ["mbp"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "mbp_max": [
        ["mbp"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "mbp_mean": [
        ["mbp"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "resp_rate_min": [
        ["resp_rate"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "resp_rate_max": [
        ["resp_rate"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "resp_rate_mean": [
        ["resp_rate"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "temperature_min": [
        ["temperature"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "temperature_max": [
        ["temperature"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "temperature_mean": [
        ["temperature"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "spo2_min": [
        ["spo2"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "spo2_max": [
        ["spo2"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "spo2_mean": [
        ["spo2"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "glucose_min": [
        ["glucose"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "glucose_max": [
        ["glucose"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "glucose_mean": [
        ["glucose"],
        [
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ]
    },
    "table_name": "mimiciv_derived.first_day_vitalsign",
    "sql": "SELECT ie.subject_id,ie.stay_id,MIN(heart_rate) AS heart_rate_min,MAX(heart_rate) AS heart_rate_max,AVG(heart_rate) AS heart_rate_mean,MIN(sbp) AS sbp_min,MAX(sbp) AS sbp_max,AVG(sbp) AS sbp_mean,MIN(dbp) AS dbp_min,MAX(dbp) AS dbp_max,AVG(dbp) AS dbp_mean,MIN(mbp) AS mbp_min,MAX(mbp) AS mbp_max,AVG(mbp) AS mbp_mean,MIN(resp_rate) AS resp_rate_min,MAX(resp_rate) AS resp_rate_max,AVG(resp_rate) AS resp_rate_mean,MIN(temperature) AS temperature_min,MAX(temperature) AS temperature_max,AVG(temperature) AS temperature_mean,MIN(spo2) AS spo2_min,MAX(spo2) AS spo2_max,AVG(spo2) AS spo2_mean,MIN(glucose) AS glucose_min,MAX(glucose) AS glucose_max,AVG(glucose) AS glucose_mean FROM mimiciv_icu.icustays ie LEFT JOIN mimiciv_derived.vitalsign ce ON ie.stay_id = ce.stay_id AND ce.charttime >= DATETIME_SUB(ie.intime,INTERVAL '6' HOUR) AND ce.charttime <= DATETIME_ADD(ie.intime,INTERVAL '1' DAY) GROUP BY ie.subject_id,ie.stay_id"
  },
  "mimiciv_derived.bg": {
    "tables": ["mimiciv_hosp.labevents", "mimiciv_icu.chartevents"],
    "columns": {
      "subject_id": [
        ["mimiciv_hosp.labevents.subject_id"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "hadm_id": [
        ["mimiciv_hosp.labevents.hadm_id"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "charttime": [
        ["mimiciv_hosp.labevents.charttime"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "specimen": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.value"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "so2": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "po2": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "pco2": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "fio2_chartevents": [
        ["mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "fio2": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "aado2": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "aado2_calc": [
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.valuenum"
        ],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "pao2fio2ratio": [
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.valuenum"
        ],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "ph": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "baseexcess": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "bicarbonate": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "totalco2": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "hematocrit": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "hemoglobin": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "carboxyhemoglobin": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "methemoglobin": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "chloride": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "calcium": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "temperature": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "potassium": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "sodium": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "lactate": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ],
      "glucose": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.chartevents.itemid"
        ]
      ]
    },
    "table_name": "mimiciv_derived.bg",
    "sql": "WITH bg AS ( SELECT MAX(subject_id) AS subject_id,MAX(hadm_id) AS hadm_id,MAX(charttime) AS charttime,MAX(storetime) AS storetime,le.specimen_id,MAX(CASE WHEN itemid = 52033 THEN value ELSE NULL END) AS specimen,MAX(CASE WHEN itemid = 50801 THEN valuenum ELSE NULL END) AS aado2,MAX( CASE WHEN itemid = 50802 THEN valuenum ELSE NULL END ) AS baseexcess,MAX( CASE WHEN itemid = 50803 THEN valuenum ELSE NULL END ) AS bicarbonate,MAX(CASE WHEN itemid = 50804 THEN valuenum ELSE NULL END) AS totalco2,MAX( CASE WHEN itemid = 50805 THEN valuenum ELSE NULL END ) AS carboxyhemoglobin,MAX(CASE WHEN itemid = 50806 THEN valuenum ELSE NULL END) AS chloride,MAX(CASE WHEN itemid = 50808 THEN valuenum ELSE NULL END) AS calcium,MAX( CASE WHEN itemid = 50809 AND valuenum <= 10000 THEN valuenum ELSE NULL END ) AS glucose,MAX( CASE WHEN itemid = 50810 AND valuenum <= 100 THEN valuenum ELSE NULL END ) AS hematocrit,MAX( CASE WHEN itemid = 50811 THEN valuenum ELSE NULL END ) AS hemoglobin,MAX( CASE WHEN itemid = 50813 AND valuenum <= 10000 THEN valuenum ELSE NULL END ) AS lactate,MAX( CASE WHEN itemid = 50814 THEN valuenum ELSE NULL END ) AS methemoglobin,MAX(CASE WHEN itemid = 50815 THEN valuenum ELSE NULL END) AS o2flow,MAX(CASE WHEN itemid = 50816 THEN CASE WHEN valuenum > 20 AND valuenum <= 100 THEN valuenum WHEN valuenum > 0.2 AND valuenum <= 1.0 THEN valuenum * 100.0 ELSE NULL END ELSE NULL END) AS fio2,MAX( CASE WHEN itemid = 50817 AND valuenum <= 100 THEN valuenum ELSE NULL END ) AS so2,MAX(CASE WHEN itemid = 50818 THEN valuenum ELSE NULL END) AS pco2,MAX(CASE WHEN itemid = 50819 THEN valuenum ELSE NULL END) AS peep,MAX(CASE WHEN itemid = 50820 THEN valuenum ELSE NULL END) AS ph,MAX(CASE WHEN itemid = 50821 THEN valuenum ELSE NULL END) AS po2,MAX(CASE WHEN itemid = 50822 THEN valuenum ELSE NULL END) AS potassium,MAX( CASE WHEN itemid = 50823 THEN valuenum ELSE NULL END ) AS requiredo2,MAX(CASE WHEN itemid = 50824 THEN valuenum ELSE NULL END) AS sodium,MAX( CASE WHEN itemid = 50825 THEN valuenum ELSE NULL END ) AS temperature,MAX(CASE WHEN itemid = 50807 THEN value ELSE NULL END) AS comments FROM mimiciv_hosp.labevents le WHERE le.itemid IN ( 52033,50801,50802,50803,50804,50805,50806,50807,50808,50809,50810,50811,50813,50814,50815,50816,50817,50818,50819,50820,50821,50822,50823,50824,50825 ) GROUP BY le.specimen_id ),stg_spo2 AS ( SELECT subject_id,charttime,AVG(valuenum) AS spo2 FROM mimiciv_icu.chartevents WHERE itemid = 220277 AND valuenum > 0 AND valuenum <= 100 GROUP BY subject_id,charttime ),stg_fio2 AS ( SELECT subject_id,charttime,MAX( CASE WHEN valuenum > 0.2 AND valuenum <= 1 THEN valuenum * 100 WHEN valuenum > 1 AND valuenum < 20 THEN NULL WHEN valuenum >= 20 AND valuenum <= 100 THEN valuenum ELSE NULL END ) AS fio2_chartevents FROM mimiciv_icu.chartevents WHERE itemid = 223835 AND valuenum > 0 AND valuenum <= 100 GROUP BY subject_id,charttime ),stg2 AS ( SELECT bg.*,ROW_NUMBER() OVER ( PARTITION BY bg.subject_id,bg.charttime ORDER BY s1.charttime DESC ) AS lastrowspo2,s1.spo2 FROM bg LEFT JOIN stg_spo2 s1 ON bg.subject_id = s1.subject_id AND s1.charttime BETWEEN DATETIME_SUB(bg.charttime,INTERVAL '2' HOUR) AND bg.charttime WHERE bg.po2 IS NOT NULL ),stg3 AS ( SELECT bg.*,ROW_NUMBER() OVER ( PARTITION BY bg.subject_id,bg.charttime ORDER BY s2.charttime DESC ) AS lastrowfio2,s2.fio2_chartevents FROM stg2 bg LEFT JOIN stg_fio2 s2 ON bg.subject_id = s2.subject_id AND s2.charttime >= DATETIME_SUB(bg.charttime,INTERVAL '4' HOUR) AND s2.charttime <= bg.charttime AND s2.fio2_chartevents > 0 WHERE bg.lastrowspo2 = 1 ) SELECT stg3.subject_id,stg3.hadm_id,stg3.charttime,specimen,so2,po2,pco2,fio2_chartevents,fio2,aado2,CASE WHEN po2 IS NULL OR pco2 IS NULL THEN NULL WHEN fio2 IS NOT NULL THEN (fio2 / 100) * (760 - 47) - (pco2 / 0.8) - po2 WHEN fio2_chartevents IS NOT NULL THEN (fio2_chartevents / 100) * (760 - 47) - (pco2 / 0.8) - po2 ELSE NULL END AS aado2_calc,CASE WHEN po2 IS NULL THEN NULL WHEN fio2 IS NOT NULL THEN 100 * po2 / fio2 WHEN fio2_chartevents IS NOT NULL THEN 100 * po2 / fio2_chartevents ELSE NULL END AS pao2fio2ratio,ph,baseexcess,bicarbonate,totalco2,hematocrit,hemoglobin,carboxyhemoglobin,methemoglobin,chloride,calcium,temperature,potassium,sodium,lactate,glucose FROM stg3 WHERE lastrowfio2 = 1"
  },
  "mimiciv_derived.blood_differential": {
    "tables": ["mimiciv_hosp.labevents"],
    "columns": {
      "subject_id": [
        ["mimiciv_hosp.labevents.subject_id"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "hadm_id": [
        ["mimiciv_hosp.labevents.hadm_id"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "charttime": [
        ["mimiciv_hosp.labevents.charttime"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "specimen_id": [
        ["mimiciv_hosp.labevents.specimen_id"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "wbc": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "basophils_abs": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "eosinophils_abs": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "lymphocytes_abs": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "monocytes_abs": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "neutrophils_abs": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "basophils": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "eosinophils": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "lymphocytes": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "monocytes": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "neutrophils": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "atypical_lymphocytes": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "bands": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "immature_granulocytes": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "metamyelocytes": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "nrbc": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ]
    },
    "table_name": "mimiciv_derived.blood_differential",
    "sql": "WITH blood_diff AS ( SELECT MAX(subject_id) AS subject_id,MAX(hadm_id) AS hadm_id,MAX(charttime) AS charttime,le.specimen_id,MAX( CASE WHEN itemid IN (51300,51301,51755) THEN valuenum ELSE NULL END ) AS wbc,MAX( CASE WHEN itemid = 52069 THEN valuenum ELSE NULL END ) AS basophils_abs,MAX( CASE WHEN itemid = 52073 THEN valuenum WHEN itemid = 51199 THEN valuenum / 1000.0 ELSE NULL END ) AS eosinophils_abs,MAX( CASE WHEN itemid = 51133 THEN valuenum WHEN itemid = 52769 THEN valuenum / 1000.0 ELSE NULL END ) AS lymphocytes_abs,MAX( CASE WHEN itemid = 52074 THEN valuenum WHEN itemid = 51253 THEN valuenum / 1000.0 ELSE NULL END ) AS monocytes_abs,MAX( CASE WHEN itemid = 52075 THEN valuenum ELSE NULL END ) AS neutrophils_abs,MAX( CASE WHEN itemid = 51218 THEN valuenum / 1000.0 ELSE NULL END ) AS granulocytes_abs,MAX(CASE WHEN itemid = 51146 THEN valuenum ELSE NULL END) AS basophils,MAX( CASE WHEN itemid = 51200 THEN valuenum ELSE NULL END ) AS eosinophils,MAX( CASE WHEN itemid IN (51244,51245) THEN valuenum ELSE NULL END ) AS lymphocytes,MAX(CASE WHEN itemid = 51254 THEN valuenum ELSE NULL END) AS monocytes,MAX( CASE WHEN itemid = 51256 THEN valuenum ELSE NULL END ) AS neutrophils,MAX( CASE WHEN itemid = 51143 THEN valuenum ELSE NULL END ) AS atypical_lymphocytes,MAX(CASE WHEN itemid = 51144 THEN valuenum ELSE NULL END) AS bands,MAX( CASE WHEN itemid = 52135 THEN valuenum ELSE NULL END ) AS immature_granulocytes,MAX( CASE WHEN itemid = 51251 THEN valuenum ELSE NULL END ) AS metamyelocytes,MAX(CASE WHEN itemid = 51257 THEN valuenum ELSE NULL END) AS nrbc,CASE WHEN MAX( CASE WHEN itemid IN (51300,51301,51755) THEN valuenum ELSE NULL END ) > 0 AND SUM( CASE WHEN itemid IN ( 51146,51200,51244,51245,51254,51256 ) THEN valuenum ELSE NULL END ) > 0 THEN 1 ELSE 0 END AS impute_abs FROM mimiciv_hosp.labevents le WHERE le.itemid IN ( 51146,52069,51199,51200,52073,51244,51245,51133,52769,51253,51254,52074,51256,52075,51143,51144,51218,52135,51251,51257,51300,51301,51755 ) AND valuenum IS NOT NULL AND valuenum >= 0 GROUP BY le.specimen_id ) SELECT subject_id,hadm_id,charttime,specimen_id,wbc,ROUND(CAST(CASE WHEN basophils_abs IS NULL AND basophils IS NOT NULL AND impute_abs = 1 THEN basophils * wbc / 100 ELSE basophils_abs END AS NUMERIC),4) AS basophils_abs,ROUND(CAST(CASE WHEN eosinophils_abs IS NULL AND eosinophils IS NOT NULL AND impute_abs = 1 THEN eosinophils * wbc / 100 ELSE eosinophils_abs END AS NUMERIC),4) AS eosinophils_abs,ROUND(CAST(CASE WHEN lymphocytes_abs IS NULL AND lymphocytes IS NOT NULL AND impute_abs = 1 THEN lymphocytes * wbc / 100 ELSE lymphocytes_abs END AS NUMERIC),4) AS lymphocytes_abs,ROUND(CAST(CASE WHEN monocytes_abs IS NULL AND monocytes IS NOT NULL AND impute_abs = 1 THEN monocytes * wbc / 100 ELSE monocytes_abs END AS NUMERIC),4) AS monocytes_abs,ROUND(CAST(CASE WHEN neutrophils_abs IS NULL AND neutrophils IS NOT NULL AND impute_abs = 1 THEN neutrophils * wbc / 100 ELSE neutrophils_abs END AS NUMERIC),4) AS neutrophils_abs,basophils,eosinophils,lymphocytes,monocytes,neutrophils,atypical_lymphocytes,bands,immature_granulocytes,metamyelocytes,nrbc FROM blood_diff"
  },
  "mimiciv_derived.chemistry": {
    "tables": ["mimiciv_hosp.labevents"],
    "columns": {
      "subject_id": [
        ["mimiciv_hosp.labevents.subject_id"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "hadm_id": [
        ["mimiciv_hosp.labevents.hadm_id"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "charttime": [
        ["mimiciv_hosp.labevents.charttime"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "specimen_id": [
        ["mimiciv_hosp.labevents.specimen_id"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "albumin": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "globulin": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "total_protein": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "aniongap": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "bicarbonate": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "bun": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "calcium": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "chloride": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "creatinine": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "glucose": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "sodium": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "potassium": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ]
    },
    "table_name": "mimiciv_derived.chemistry",
    "sql": "SELECT MAX(subject_id) AS subject_id,MAX(hadm_id) AS hadm_id,MAX(charttime) AS charttime,le.specimen_id,MAX( CASE WHEN itemid = 50862 AND valuenum <= 10 THEN valuenum ELSE NULL END ) AS albumin,MAX( CASE WHEN itemid = 50930 AND valuenum <= 10 THEN valuenum ELSE NULL END ) AS globulin,MAX( CASE WHEN itemid = 50976 AND valuenum <= 20 THEN valuenum ELSE NULL END ) AS total_protein,MAX( CASE WHEN itemid = 50868 AND valuenum <= 10000 THEN valuenum ELSE NULL END ) AS aniongap,MAX( CASE WHEN itemid = 50882 AND valuenum <= 10000 THEN valuenum ELSE NULL END ) AS bicarbonate,MAX( CASE WHEN itemid = 51006 AND valuenum <= 300 THEN valuenum ELSE NULL END ) AS bun,MAX( CASE WHEN itemid = 50893 AND valuenum <= 10000 THEN valuenum ELSE NULL END ) AS calcium,MAX( CASE WHEN itemid = 50902 AND valuenum <= 10000 THEN valuenum ELSE NULL END ) AS chloride,MAX( CASE WHEN itemid = 50912 AND valuenum <= 150 THEN valuenum ELSE NULL END ) AS creatinine,MAX( CASE WHEN itemid = 50931 AND valuenum <= 10000 THEN valuenum ELSE NULL END ) AS glucose,MAX( CASE WHEN itemid = 50983 AND valuenum <= 200 THEN valuenum ELSE NULL END ) AS sodium,MAX( CASE WHEN itemid = 50971 AND valuenum <= 30 THEN valuenum ELSE NULL END ) AS potassium FROM mimiciv_hosp.labevents le WHERE le.itemid IN ( 50862,50930,50976,50868,50882,50893,50912,50902,50931,50971,50983,51006 ) AND valuenum IS NOT NULL AND (valuenum > 0 OR itemid = 50868) GROUP BY le.specimen_id"
  },
  "mimiciv_derived.coagulation": {
    "tables": ["mimiciv_hosp.labevents"],
    "columns": {
      "subject_id": [
        ["mimiciv_hosp.labevents.subject_id"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "hadm_id": [
        ["mimiciv_hosp.labevents.hadm_id"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "charttime": [
        ["mimiciv_hosp.labevents.charttime"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "specimen_id": [
        ["mimiciv_hosp.labevents.specimen_id"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "d_dimer": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "fibrinogen": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "thrombin": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "inr": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "pt": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "ptt": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ]
    },
    "table_name": "mimiciv_derived.coagulation",
    "sql": "SELECT MAX(subject_id) AS subject_id,MAX(hadm_id) AS hadm_id,MAX(charttime) AS charttime,le.specimen_id,MAX(CASE WHEN itemid = 51196 THEN valuenum ELSE NULL END) AS d_dimer,MAX(CASE WHEN itemid = 51214 THEN valuenum ELSE NULL END) AS fibrinogen,MAX(CASE WHEN itemid = 51297 THEN valuenum ELSE NULL END) AS thrombin,MAX(CASE WHEN itemid = 51237 THEN valuenum ELSE NULL END) AS inr,MAX(CASE WHEN itemid = 51274 THEN valuenum ELSE NULL END) AS pt,MAX(CASE WHEN itemid = 51275 THEN valuenum ELSE NULL END) AS ptt FROM mimiciv_hosp.labevents le WHERE le.itemid IN ( 51196,51214,51297,51237,51274,51275 ) AND valuenum IS NOT NULL GROUP BY le.specimen_id"
  },
  "mimiciv_derived.complete_blood_count": {
    "tables": ["mimiciv_hosp.labevents"],
    "columns": {
      "subject_id": [
        ["mimiciv_hosp.labevents.subject_id"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "hadm_id": [
        ["mimiciv_hosp.labevents.hadm_id"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "charttime": [
        ["mimiciv_hosp.labevents.charttime"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "specimen_id": [
        ["mimiciv_hosp.labevents.specimen_id"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "hematocrit": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "hemoglobin": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "mch": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "mchc": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "mcv": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "platelet": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "rbc": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "rdw": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "rdwsd": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "wbc": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ]
    },
    "table_name": "mimiciv_derived.complete_blood_count",
    "sql": "SELECT MAX(subject_id) AS subject_id,MAX(hadm_id) AS hadm_id,MAX(charttime) AS charttime,le.specimen_id,MAX(CASE WHEN itemid = 51221 THEN valuenum ELSE NULL END) AS hematocrit,MAX(CASE WHEN itemid = 51222 THEN valuenum ELSE NULL END) AS hemoglobin,MAX(CASE WHEN itemid = 51248 THEN valuenum ELSE NULL END) AS mch,MAX(CASE WHEN itemid = 51249 THEN valuenum ELSE NULL END) AS mchc,MAX(CASE WHEN itemid = 51250 THEN valuenum ELSE NULL END) AS mcv,MAX(CASE WHEN itemid = 51265 THEN valuenum ELSE NULL END) AS platelet,MAX(CASE WHEN itemid = 51279 THEN valuenum ELSE NULL END) AS rbc,MAX(CASE WHEN itemid = 51277 THEN valuenum ELSE NULL END) AS rdw,MAX(CASE WHEN itemid = 52159 THEN valuenum ELSE NULL END) AS rdwsd,MAX(CASE WHEN itemid = 51301 THEN valuenum ELSE NULL END) AS wbc FROM mimiciv_hosp.labevents le WHERE le.itemid IN ( 51221,51222,51248,51249,51250,51265,51279,51277,52159,51301 ) AND valuenum IS NOT NULL AND valuenum > 0 GROUP BY le.specimen_id"
  },
  "mimiciv_derived.enzyme": {
    "tables": ["mimiciv_hosp.labevents"],
    "columns": {
      "subject_id": [
        ["mimiciv_hosp.labevents.subject_id"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "hadm_id": [
        ["mimiciv_hosp.labevents.hadm_id"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "charttime": [
        ["mimiciv_hosp.labevents.charttime"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "specimen_id": [
        ["mimiciv_hosp.labevents.specimen_id"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "alt": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "alp": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "ast": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "amylase": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "bilirubin_total": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "bilirubin_direct": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "bilirubin_indirect": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "ck_cpk": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "ck_mb": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "ggt": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ],
      "ld_ldh": [
        ["mimiciv_hosp.labevents.itemid", "mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.specimen_id",
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_hosp.labevents.valuenum"
        ]
      ]
    },
    "table_name": "mimiciv_derived.enzyme",
    "sql": "SELECT MAX(subject_id) AS subject_id,MAX(hadm_id) AS hadm_id,MAX(charttime) AS charttime,le.specimen_id,MAX(CASE WHEN itemid = 50861 THEN valuenum ELSE NULL END) AS alt,MAX(CASE WHEN itemid = 50863 THEN valuenum ELSE NULL END) AS alp,MAX(CASE WHEN itemid = 50878 THEN valuenum ELSE NULL END) AS ast,MAX(CASE WHEN itemid = 50867 THEN valuenum ELSE NULL END) AS amylase,MAX( CASE WHEN itemid = 50885 THEN valuenum ELSE NULL END ) AS bilirubin_total,MAX( CASE WHEN itemid = 50883 THEN valuenum ELSE NULL END ) AS bilirubin_direct,MAX( CASE WHEN itemid = 50884 THEN valuenum ELSE NULL END ) AS bilirubin_indirect,MAX(CASE WHEN itemid = 50910 THEN valuenum ELSE NULL END) AS ck_cpk,MAX(CASE WHEN itemid = 50911 THEN valuenum ELSE NULL END) AS ck_mb,MAX(CASE WHEN itemid = 50927 THEN valuenum ELSE NULL END) AS ggt,MAX(CASE WHEN itemid = 50954 THEN valuenum ELSE NULL END) AS ld_ldh FROM mimiciv_hosp.labevents le WHERE le.itemid IN ( 50861,50863,50878,50867,50885,50884,50883,50910,50911,50927,50954 ) AND valuenum IS NOT NULL AND valuenum > 0 GROUP BY le.specimen_id"
  },
  "mimiciv_derived.gcs": {
    "tables": ["mimiciv_icu.chartevents"],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.chartevents.subject_id"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.chartevents.stay_id"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "charttime": [
        ["mimiciv_icu.chartevents.charttime"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "gcs": [
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.value",
          "mimiciv_icu.chartevents.valuenum"
        ],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "gcs_motor": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "gcs_verbal": [
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.value",
          "mimiciv_icu.chartevents.valuenum"
        ],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "gcs_eyes": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "gcs_unable": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.value"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ]
    },
    "table_name": "mimiciv_derived.gcs",
    "sql": "WITH base AS ( SELECT subject_id,ce.stay_id,ce.charttime,MAX( CASE WHEN ce.itemid = 223901 THEN ce.valuenum ELSE null END ) AS gcsmotor,MAX(CASE WHEN ce.itemid = 223900 AND ce.value = 'No Response-ETT' THEN 0 WHEN ce.itemid = 223900 THEN ce.valuenum ELSE null END) AS gcsverbal,MAX( CASE WHEN ce.itemid = 220739 THEN ce.valuenum ELSE null END ) AS gcseyes,MAX(CASE WHEN ce.itemid = 223900 AND ce.value = 'No Response-ETT' THEN 1 ELSE 0 END) AS endotrachflag,ROW_NUMBER() OVER (PARTITION BY ce.stay_id ORDER BY ce.charttime ASC) AS rn FROM mimiciv_icu.chartevents ce WHERE ce.itemid IN ( 223900,223901,220739 ) GROUP BY ce.subject_id,ce.stay_id,ce.charttime ),gcs AS ( SELECT b.*,b2.gcsverbal AS gcsverbalprev,b2.gcsmotor AS gcsmotorprev,b2.gcseyes AS gcseyesprev,CASE WHEN b.gcsverbal = 0 THEN 15 WHEN b.gcsverbal IS NULL AND b2.gcsverbal = 0 THEN 15 WHEN b2.gcsverbal = 0 THEN COALESCE(b.gcsmotor,6) + COALESCE(b.gcsverbal,5) + COALESCE(b.gcseyes,4) ELSE COALESCE(b.gcsmotor,COALESCE(b2.gcsmotor,6)) + COALESCE(b.gcsverbal,COALESCE(b2.gcsverbal,5)) + COALESCE(b.gcseyes,COALESCE(b2.gcseyes,4)) END AS gcs FROM base b LEFT JOIN base b2 ON b.stay_id = b2.stay_id AND b.rn = b2.rn + 1 AND b2.charttime > DATETIME_SUB(b.charttime,INTERVAL '6' HOUR) ),gcs_stg AS ( SELECT subject_id,gs.stay_id,gs.charttime,gcs,COALESCE(gcsmotor,gcsmotorprev) AS gcsmotor,COALESCE(gcsverbal,gcsverbalprev) AS gcsverbal,COALESCE(gcseyes,gcseyesprev) AS gcseyes,CASE WHEN COALESCE(gcsmotor,gcsmotorprev) IS NULL THEN 0 ELSE 1 END + CASE WHEN COALESCE(gcsverbal,gcsverbalprev) IS NULL THEN 0 ELSE 1 END + CASE WHEN COALESCE(gcseyes,gcseyesprev) IS NULL THEN 0 ELSE 1 END AS components_measured,endotrachflag FROM gcs gs ) SELECT gs.subject_id,gs.stay_id,gs.charttime,gcs AS gcs,gcsmotor AS gcs_motor,gcsverbal AS gcs_verbal,gcseyes AS gcs_eyes,endotrachflag AS gcs_unable FROM gcs_stg gs"
  },
  "mimiciv_derived.height": {
    "tables": ["mimiciv_icu.chartevents"],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.chartevents.subject_id"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.chartevents.stay_id"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum"
        ]
      ],
      "charttime": [
        ["mimiciv_icu.chartevents.charttime"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum"
        ]
      ],
      "height": [
        ["mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.valuenum"
        ]
      ]
    },
    "table_name": "mimiciv_derived.height",
    "sql": "WITH ht_in AS ( SELECT c.subject_id,c.stay_id,c.charttime,ROUND(CAST(c.valuenum * 2.54 AS NUMERIC),2) AS height,c.valuenum AS height_orig FROM mimiciv_icu.chartevents c WHERE c.valuenum IS NOT NULL AND c.itemid = 226707 ),ht_cm AS ( SELECT c.subject_id,c.stay_id,c.charttime,ROUND(CAST(c.valuenum AS NUMERIC),2) AS height FROM mimiciv_icu.chartevents c WHERE c.valuenum IS NOT NULL AND c.itemid = 226730 ),ht_stg0 AS ( SELECT COALESCE(h1.subject_id,h1.subject_id) AS subject_id,COALESCE(h1.stay_id,h1.stay_id) AS stay_id,COALESCE(h1.charttime,h1.charttime) AS charttime,COALESCE(h1.height,h2.height) AS height FROM ht_cm h1 FULL OUTER JOIN ht_in h2 ON h1.subject_id = h2.subject_id AND h1.charttime = h2.charttime ) SELECT subject_id,stay_id,charttime,height FROM ht_stg0 WHERE height IS NOT NULL AND height > 120 AND height < 230"
  },
  "mimiciv_derived.oxygen_delivery": {
    "tables": ["mimiciv_icu.chartevents"],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.chartevents.subject_id"],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.storetime",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.chartevents.stay_id"],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.storetime",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "charttime": [
        ["mimiciv_icu.chartevents.charttime"],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.storetime",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "o2_flow": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.storetime",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "o2_flow_additional": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.storetime",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "o2_delivery_device_1": [
        [
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.value",
          "mimiciv_icu.chartevents.subject_id"
        ],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.storetime",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "o2_delivery_device_2": [
        [
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.value",
          "mimiciv_icu.chartevents.subject_id"
        ],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.storetime",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "o2_delivery_device_3": [
        [
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.value",
          "mimiciv_icu.chartevents.subject_id"
        ],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.storetime",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "o2_delivery_device_4": [
        [
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.value",
          "mimiciv_icu.chartevents.subject_id"
        ],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.storetime",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.value"
        ]
      ]
    },
    "table_name": "mimiciv_derived.oxygen_delivery",
    "sql": "WITH ce_stg1 AS ( SELECT ce.subject_id,ce.stay_id,ce.charttime,CASE WHEN itemid IN (223834,227582) THEN 223834 ELSE itemid END AS itemid,value,valuenum,valueuom,storetime FROM mimiciv_icu.chartevents ce WHERE ce.value IS NOT NULL AND ce.itemid IN ( 223834,227582,227287 ) ),ce_stg2 AS ( SELECT ce.subject_id,ce.stay_id,ce.charttime,itemid,value,valuenum,valueuom,ROW_NUMBER() OVER ( PARTITION BY subject_id,charttime,itemid ORDER BY storetime DESC ) AS rn FROM ce_stg1 ce ),o2 AS ( SELECT subject_id,stay_id,charttime,itemid,value AS o2_device,ROW_NUMBER() OVER ( PARTITION BY subject_id,charttime,itemid ORDER BY value ) AS rn FROM mimiciv_icu.chartevents WHERE itemid = 226732 ),stg AS ( SELECT COALESCE(ce.subject_id,o2.subject_id) AS subject_id,COALESCE(ce.stay_id,o2.stay_id) AS stay_id,COALESCE(ce.charttime,o2.charttime) AS charttime,COALESCE(ce.itemid,o2.itemid) AS itemid,ce.value,ce.valuenum,o2.o2_device,o2.rn FROM ce_stg2 ce FULL OUTER JOIN o2 ON ce.subject_id = o2.subject_id AND ce.charttime = o2.charttime WHERE ce.rn = 1 ) SELECT subject_id,MAX(stay_id) AS stay_id,charttime,MAX(CASE WHEN itemid = 223834 THEN valuenum ELSE NULL END) AS o2_flow,MAX( CASE WHEN itemid = 227287 THEN valuenum ELSE NULL END ) AS o2_flow_additional,MAX(CASE WHEN rn = 1 THEN o2_device ELSE NULL END) AS o2_delivery_device_1,MAX(CASE WHEN rn = 2 THEN o2_device ELSE NULL END) AS o2_delivery_device_2,MAX(CASE WHEN rn = 3 THEN o2_device ELSE NULL END) AS o2_delivery_device_3,MAX(CASE WHEN rn = 4 THEN o2_device ELSE NULL END) AS o2_delivery_device_4 FROM stg GROUP BY subject_id,charttime"
  },
  "mimiciv_derived.urine_output": {
    "tables": ["mimiciv_icu.outputevents"],
    "columns": {
      "stay_id": [
        ["mimiciv_icu.outputevents.stay_id"],
        [
          "mimiciv_icu.outputevents.stay_id",
          "mimiciv_icu.outputevents.itemid",
          "mimiciv_icu.outputevents.charttime"
        ]
      ],
      "charttime": [
        ["mimiciv_icu.outputevents.charttime"],
        [
          "mimiciv_icu.outputevents.stay_id",
          "mimiciv_icu.outputevents.itemid",
          "mimiciv_icu.outputevents.charttime"
        ]
      ],
      "urineoutput": [
        ["mimiciv_icu.outputevents.value", "mimiciv_icu.outputevents.itemid"],
        [
          "mimiciv_icu.outputevents.stay_id",
          "mimiciv_icu.outputevents.itemid",
          "mimiciv_icu.outputevents.charttime"
        ]
      ]
    },
    "table_name": "mimiciv_derived.urine_output",
    "sql": "WITH uo AS ( SELECT oe.stay_id,oe.charttime,CASE WHEN oe.itemid = 227488 AND oe.value > 0 THEN -1 * oe.value ELSE oe.value END AS urineoutput FROM mimiciv_icu.outputevents oe WHERE itemid IN ( 226559,226560,226561,226584,226563,226564,226565,226567,226557,226558,227488,227489 ) ) SELECT stay_id,charttime,SUM(urineoutput) AS urineoutput FROM uo GROUP BY stay_id,charttime"
  },
  "mimiciv_derived.urine_output_rate": {
    "tables": [
      "mimiciv_derived.weight_durations",
      "mimiciv_derived.urine_output",
      "mimiciv_icu.chartevents",
      "mimiciv_icu.icustays"
    ],
    "columns": {
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.weight_durations.weight",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "charttime": [
        ["mimiciv_derived.urine_output.charttime"],
        [
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.weight_durations.weight",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "weight": [
        ["mimiciv_derived.weight_durations.weight"],
        [
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.weight_durations.weight",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "uo": [
        ["mimiciv_derived.urine_output.urineoutput"],
        [
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.weight_durations.weight",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "urineoutput_6hr": [
        [
          "mimiciv_derived.urine_output.urineoutput",
          "mimiciv_derived.urine_output.charttime"
        ],
        [
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.weight_durations.weight",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "urineoutput_12hr": [
        [
          "mimiciv_derived.urine_output.urineoutput",
          "mimiciv_derived.urine_output.charttime"
        ],
        [
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.weight_durations.weight",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "urineoutput_24hr": [
        ["mimiciv_derived.urine_output.urineoutput"],
        [
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.weight_durations.weight",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "uo_mlkghr_6hr": [
        [
          "mimiciv_derived.weight_durations.weight",
          "mimiciv_derived.urine_output.urineoutput",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.chartevents.charttime"
        ],
        [
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.weight_durations.weight",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "uo_mlkghr_12hr": [
        [
          "mimiciv_derived.weight_durations.weight",
          "mimiciv_derived.urine_output.urineoutput",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.chartevents.charttime"
        ],
        [
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.weight_durations.weight",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "uo_mlkghr_24hr": [
        [
          "mimiciv_derived.weight_durations.weight",
          "mimiciv_derived.urine_output.urineoutput",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.chartevents.charttime"
        ],
        [
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.weight_durations.weight",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "uo_tm_6hr": [
        [
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.chartevents.charttime"
        ],
        [
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.weight_durations.weight",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "uo_tm_12hr": [
        [
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.chartevents.charttime"
        ],
        [
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.weight_durations.weight",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "uo_tm_24hr": [
        [
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.chartevents.charttime"
        ],
        [
          "mimiciv_icu.icustays.outtime",
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_derived.weight_durations.weight",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ]
    },
    "table_name": "mimiciv_derived.urine_output_rate",
    "sql": "WITH tm AS ( SELECT ie.stay_id,MIN(charttime) AS intime_hr,MAX(charttime) AS outtime_hr FROM mimiciv_icu.icustays ie INNER JOIN mimiciv_icu.chartevents ce ON ie.stay_id = ce.stay_id AND ce.itemid = 220045 AND ce.charttime > DATETIME_SUB(ie.intime,INTERVAL '1' MONTH) AND ce.charttime < DATETIME_ADD(ie.outtime,INTERVAL '1' MONTH) GROUP BY ie.stay_id ),uo_tm AS ( SELECT tm.stay_id,CASE WHEN LAG(charttime) OVER w IS NULL THEN DATETIME_DIFF(charttime,intime_hr,'MINUTE') ELSE DATETIME_DIFF(charttime,LAG(charttime) OVER w,'MINUTE') END AS tm_since_last_uo,uo.charttime,uo.urineoutput FROM tm INNER JOIN mimiciv_derived.urine_output uo ON tm.stay_id = uo.stay_id WINDOW w AS (PARTITION BY tm.stay_id ORDER BY charttime) ),ur_stg AS ( SELECT io.stay_id,io.charttime,SUM(DISTINCT io.urineoutput) AS uo,SUM(CASE WHEN DATETIME_DIFF(io.charttime,iosum.charttime,'HOUR') <= 5 THEN iosum.urineoutput ELSE null END) AS urineoutput_6hr,SUM(CASE WHEN DATETIME_DIFF(io.charttime,iosum.charttime,'HOUR') <= 5 THEN iosum.tm_since_last_uo ELSE null END) / 60.0 AS uo_tm_6hr,SUM(CASE WHEN DATETIME_DIFF(io.charttime,iosum.charttime,'HOUR') <= 11 THEN iosum.urineoutput ELSE null END) AS urineoutput_12hr,SUM(CASE WHEN DATETIME_DIFF(io.charttime,iosum.charttime,'HOUR') <= 11 THEN iosum.tm_since_last_uo ELSE null END) / 60.0 AS uo_tm_12hr,SUM(iosum.urineoutput) AS urineoutput_24hr,SUM(iosum.tm_since_last_uo) / 60.0 AS uo_tm_24hr FROM uo_tm io LEFT JOIN uo_tm iosum ON io.stay_id = iosum.stay_id AND io.charttime >= iosum.charttime AND io.charttime <= ( DATETIME_ADD(iosum.charttime,INTERVAL '23' HOUR) ) GROUP BY io.stay_id,io.charttime ) SELECT ur.stay_id,ur.charttime,wd.weight,ur.uo,ur.urineoutput_6hr,ur.urineoutput_12hr,ur.urineoutput_24hr,CASE WHEN uo_tm_6hr >= 6 THEN ROUND( CAST((ur.urineoutput_6hr / wd.weight / uo_tm_6hr) AS NUMERIC),4 ) END AS uo_mlkghr_6hr,CASE WHEN uo_tm_12hr >= 12 THEN ROUND( CAST((ur.urineoutput_12hr / wd.weight / uo_tm_12hr) AS NUMERIC),4 ) END AS uo_mlkghr_12hr,CASE WHEN uo_tm_24hr >= 24 THEN ROUND( CAST((ur.urineoutput_24hr / wd.weight / uo_tm_24hr) AS NUMERIC),4 ) END AS uo_mlkghr_24hr,ROUND(CAST(uo_tm_6hr AS NUMERIC),2) AS uo_tm_6hr,ROUND(CAST(uo_tm_12hr AS NUMERIC),2) AS uo_tm_12hr,ROUND(CAST(uo_tm_24hr AS NUMERIC),2) AS uo_tm_24hr FROM ur_stg ur LEFT JOIN mimiciv_derived.weight_durations wd ON ur.stay_id = wd.stay_id AND ur.charttime > wd.starttime AND ur.charttime <= wd.endtime AND wd.weight > 0"
  },
  "mimiciv_derived.ventilator_setting": {
    "tables": ["mimiciv_icu.chartevents"],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.chartevents.subject_id"],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.chartevents.stay_id"],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "charttime": [
        ["mimiciv_icu.chartevents.charttime"],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "respiratory_rate_set": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "respiratory_rate_total": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "respiratory_rate_spontaneous": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "minute_volume": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "tidal_volume_set": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "tidal_volume_observed": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "tidal_volume_spontaneous": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "plateau_pressure": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "peep": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "fio2": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "flow_rate": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "ventilator_mode": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.value"],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "ventilator_mode_hamilton": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.value"],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "ventilator_type": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.value"],
        [
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ]
    },
    "table_name": "mimiciv_derived.ventilator_setting",
    "sql": "WITH ce AS ( SELECT ce.subject_id,ce.stay_id,ce.charttime,itemid,value,CASE WHEN itemid = 223835 THEN CASE WHEN valuenum >= 0.20 AND valuenum <= 1 THEN valuenum * 100 WHEN valuenum > 1 AND valuenum < 20 THEN null WHEN valuenum >= 20 AND valuenum <= 100 THEN valuenum ELSE null END WHEN itemid IN (220339,224700) THEN CASE WHEN valuenum > 100 THEN null WHEN valuenum < 0 THEN null ELSE valuenum END ELSE valuenum END AS valuenum,valueuom,storetime FROM mimiciv_icu.chartevents ce WHERE ce.value IS NOT NULL AND ce.stay_id IS NOT NULL AND ce.itemid IN ( 224688,224689,224690,224687,224685,224684,224686,224696,220339,224700,223835,223849,229314,223848,224691 ) ) SELECT subject_id,MAX(stay_id) AS stay_id,charttime,MAX( CASE WHEN itemid = 224688 THEN valuenum ELSE null END ) AS respiratory_rate_set,MAX( CASE WHEN itemid = 224690 THEN valuenum ELSE null END ) AS respiratory_rate_total,MAX( CASE WHEN itemid = 224689 THEN valuenum ELSE null END ) AS respiratory_rate_spontaneous,MAX( CASE WHEN itemid = 224687 THEN valuenum ELSE null END ) AS minute_volume,MAX( CASE WHEN itemid = 224684 THEN valuenum ELSE null END ) AS tidal_volume_set,MAX( CASE WHEN itemid = 224685 THEN valuenum ELSE null END ) AS tidal_volume_observed,MAX( CASE WHEN itemid = 224686 THEN valuenum ELSE null END ) AS tidal_volume_spontaneous,MAX( CASE WHEN itemid = 224696 THEN valuenum ELSE null END ) AS plateau_pressure,MAX( CASE WHEN itemid IN (220339,224700) THEN valuenum ELSE null END ) AS peep,MAX(CASE WHEN itemid = 223835 THEN valuenum ELSE null END) AS fio2,MAX(CASE WHEN itemid = 224691 THEN valuenum ELSE null END) AS flow_rate,MAX(CASE WHEN itemid = 223849 THEN value ELSE null END) AS ventilator_mode,MAX( CASE WHEN itemid = 229314 THEN value ELSE null END ) AS ventilator_mode_hamilton,MAX(CASE WHEN itemid = 223848 THEN value ELSE null END) AS ventilator_type FROM ce GROUP BY subject_id,charttime"
  },
  "mimiciv_derived.vitalsign": {
    "tables": ["mimiciv_icu.chartevents"],
    "columns": {
      "subject_id": [
        ["mimiciv_icu.chartevents.subject_id"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.chartevents.stay_id"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "charttime": [
        ["mimiciv_icu.chartevents.charttime"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "heart_rate": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "sbp": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "dbp": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "mbp": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "sbp_ni": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "dbp_ni": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "mbp_ni": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "resp_rate": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "temperature": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "temperature_site": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.value"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "spo2": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ],
      "glucose": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.subject_id",
          "mimiciv_icu.chartevents.stay_id"
        ]
      ]
    },
    "table_name": "mimiciv_derived.vitalsign",
    "sql": "SELECT ce.subject_id,ce.stay_id,ce.charttime,AVG(CASE WHEN itemid IN (220045) AND valuenum > 0 AND valuenum < 300 THEN valuenum END ) AS heart_rate,AVG(CASE WHEN itemid IN (220179,220050,225309) AND valuenum > 0 AND valuenum < 400 THEN valuenum END ) AS sbp,AVG(CASE WHEN itemid IN (220180,220051,225310) AND valuenum > 0 AND valuenum < 300 THEN valuenum END ) AS dbp,AVG(CASE WHEN itemid IN (220052,220181,225312) AND valuenum > 0 AND valuenum < 300 THEN valuenum END ) AS mbp,AVG(CASE WHEN itemid = 220179 AND valuenum > 0 AND valuenum < 400 THEN valuenum END ) AS sbp_ni,AVG(CASE WHEN itemid = 220180 AND valuenum > 0 AND valuenum < 300 THEN valuenum END ) AS dbp_ni,AVG(CASE WHEN itemid = 220181 AND valuenum > 0 AND valuenum < 300 THEN valuenum END ) AS mbp_ni,AVG(CASE WHEN itemid IN (220210,224690) AND valuenum > 0 AND valuenum < 70 THEN valuenum END ) AS resp_rate,ROUND(CAST( AVG(CASE WHEN itemid IN (223761) AND valuenum > 70 AND valuenum < 120 THEN (valuenum - 32) / 1.8 WHEN itemid IN (223762) AND valuenum > 10 AND valuenum < 50 THEN valuenum END) AS NUMERIC),2) AS temperature,MAX(CASE WHEN itemid = 224642 THEN value END ) AS temperature_site,AVG(CASE WHEN itemid IN (220277) AND valuenum > 0 AND valuenum <= 100 THEN valuenum END ) AS spo2,AVG(CASE WHEN itemid IN (225664,220621,226537) AND valuenum > 0 THEN valuenum END ) AS glucose FROM mimiciv_icu.chartevents ce WHERE ce.stay_id IS NOT NULL AND ce.itemid IN ( 220045,225309,225310,225312,220050,220051,220052,220179,220180,220181,220210,224690,220277,225664,220621,226537,223762,223761,224642 ) GROUP BY ce.subject_id,ce.stay_id,ce.charttime"
  },
  "mimiciv_derived.antibiotic": {
    "tables": ["mimiciv_hosp.prescriptions", "mimiciv_icu.icustays"],
    "columns": {
      "subject_id": [
        ["mimiciv_hosp.prescriptions.subject_id"],
        [
          "mimiciv_hosp.prescriptions.drug",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_hosp.prescriptions.starttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.prescriptions.hadm_id",
          "mimiciv_hosp.prescriptions.route",
          "mimiciv_hosp.prescriptions.drug_type"
        ]
      ],
      "hadm_id": [
        ["mimiciv_hosp.prescriptions.hadm_id"],
        [
          "mimiciv_hosp.prescriptions.drug",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_hosp.prescriptions.starttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.prescriptions.hadm_id",
          "mimiciv_hosp.prescriptions.route",
          "mimiciv_hosp.prescriptions.drug_type"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_hosp.prescriptions.drug",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_hosp.prescriptions.starttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.prescriptions.hadm_id",
          "mimiciv_hosp.prescriptions.route",
          "mimiciv_hosp.prescriptions.drug_type"
        ]
      ],
      "antibiotic": [
        ["mimiciv_hosp.prescriptions.drug"],
        [
          "mimiciv_hosp.prescriptions.drug",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_hosp.prescriptions.starttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.prescriptions.hadm_id",
          "mimiciv_hosp.prescriptions.route",
          "mimiciv_hosp.prescriptions.drug_type"
        ]
      ],
      "route": [
        ["mimiciv_hosp.prescriptions.route"],
        [
          "mimiciv_hosp.prescriptions.drug",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_hosp.prescriptions.starttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.prescriptions.hadm_id",
          "mimiciv_hosp.prescriptions.route",
          "mimiciv_hosp.prescriptions.drug_type"
        ]
      ],
      "starttime": [
        ["mimiciv_hosp.prescriptions.starttime"],
        [
          "mimiciv_hosp.prescriptions.drug",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_hosp.prescriptions.starttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.prescriptions.hadm_id",
          "mimiciv_hosp.prescriptions.route",
          "mimiciv_hosp.prescriptions.drug_type"
        ]
      ],
      "stoptime": [
        ["mimiciv_hosp.prescriptions.stoptime"],
        [
          "mimiciv_hosp.prescriptions.drug",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_hosp.prescriptions.starttime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.prescriptions.hadm_id",
          "mimiciv_hosp.prescriptions.route",
          "mimiciv_hosp.prescriptions.drug_type"
        ]
      ]
    },
    "table_name": "mimiciv_derived.antibiotic",
    "sql": "WITH abx AS ( SELECT DISTINCT drug,route,CASE WHEN LOWER(drug) LIKE '%adoxa%' THEN 1 WHEN LOWER(drug) LIKE '%ala-tet%' THEN 1 WHEN LOWER(drug) LIKE '%alodox%' THEN 1 WHEN LOWER(drug) LIKE '%amikacin%' THEN 1 WHEN LOWER(drug) LIKE '%amikin%' THEN 1 WHEN LOWER(drug) LIKE '%amoxicill%' THEN 1 WHEN LOWER(drug) LIKE '%amphotericin%' THEN 1 WHEN LOWER(drug) LIKE '%anidulafungin%' THEN 1 WHEN LOWER(drug) LIKE '%ancef%' THEN 1 WHEN LOWER(drug) LIKE '%clavulanate%' THEN 1 WHEN LOWER(drug) LIKE '%ampicillin%' THEN 1 WHEN LOWER(drug) LIKE '%augmentin%' THEN 1 WHEN LOWER(drug) LIKE '%avelox%' THEN 1 WHEN LOWER(drug) LIKE '%avidoxy%' THEN 1 WHEN LOWER(drug) LIKE '%azactam%' THEN 1 WHEN LOWER(drug) LIKE '%azithromycin%' THEN 1 WHEN LOWER(drug) LIKE '%aztreonam%' THEN 1 WHEN LOWER(drug) LIKE '%axetil%' THEN 1 WHEN LOWER(drug) LIKE '%bactocill%' THEN 1 WHEN LOWER(drug) LIKE '%bactrim%' THEN 1 WHEN LOWER(drug) LIKE '%bactroban%' THEN 1 WHEN LOWER(drug) LIKE '%bethkis%' THEN 1 WHEN LOWER(drug) LIKE '%biaxin%' THEN 1 WHEN LOWER(drug) LIKE '%bicillin l-a%' THEN 1 WHEN LOWER(drug) LIKE '%cayston%' THEN 1 WHEN LOWER(drug) LIKE '%cefazolin%' THEN 1 WHEN LOWER(drug) LIKE '%cedax%' THEN 1 WHEN LOWER(drug) LIKE '%cefoxitin%' THEN 1 WHEN LOWER(drug) LIKE '%ceftazidime%' THEN 1 WHEN LOWER(drug) LIKE '%cefaclor%' THEN 1 WHEN LOWER(drug) LIKE '%cefadroxil%' THEN 1 WHEN LOWER(drug) LIKE '%cefdinir%' THEN 1 WHEN LOWER(drug) LIKE '%cefditoren%' THEN 1 WHEN LOWER(drug) LIKE '%cefepime%' THEN 1 WHEN LOWER(drug) LIKE '%cefotan%' THEN 1 WHEN LOWER(drug) LIKE '%cefotetan%' THEN 1 WHEN LOWER(drug) LIKE '%cefotaxime%' THEN 1 WHEN LOWER(drug) LIKE '%ceftaroline%' THEN 1 WHEN LOWER(drug) LIKE '%cefpodoxime%' THEN 1 WHEN LOWER(drug) LIKE '%cefpirome%' THEN 1 WHEN LOWER(drug) LIKE '%cefprozil%' THEN 1 WHEN LOWER(drug) LIKE '%ceftibuten%' THEN 1 WHEN LOWER(drug) LIKE '%ceftin%' THEN 1 WHEN LOWER(drug) LIKE '%ceftriaxone%' THEN 1 WHEN LOWER(drug) LIKE '%cefuroxime%' THEN 1 WHEN LOWER(drug) LIKE '%cephalexin%' THEN 1 WHEN LOWER(drug) LIKE '%cephalothin%' THEN 1 WHEN LOWER(drug) LIKE '%cephapririn%' THEN 1 WHEN LOWER(drug) LIKE '%chloramphenicol%' THEN 1 WHEN LOWER(drug) LIKE '%cipro%' THEN 1 WHEN LOWER(drug) LIKE '%ciprofloxacin%' THEN 1 WHEN LOWER(drug) LIKE '%claforan%' THEN 1 WHEN LOWER(drug) LIKE '%clarithromycin%' THEN 1 WHEN LOWER(drug) LIKE '%cleocin%' THEN 1 WHEN LOWER(drug) LIKE '%clindamycin%' THEN 1 WHEN LOWER(drug) LIKE '%cubicin%' THEN 1 WHEN LOWER(drug) LIKE '%dicloxacillin%' THEN 1 WHEN LOWER(drug) LIKE '%dirithromycin%' THEN 1 WHEN LOWER(drug) LIKE '%doryx%' THEN 1 WHEN LOWER(drug) LIKE '%doxycy%' THEN 1 WHEN LOWER(drug) LIKE '%duricef%' THEN 1 WHEN LOWER(drug) LIKE '%dynacin%' THEN 1 WHEN LOWER(drug) LIKE '%ery-tab%' THEN 1 WHEN LOWER(drug) LIKE '%eryped%' THEN 1 WHEN LOWER(drug) LIKE '%eryc%' THEN 1 WHEN LOWER(drug) LIKE '%erythrocin%' THEN 1 WHEN LOWER(drug) LIKE '%erythromycin%' THEN 1 WHEN LOWER(drug) LIKE '%factive%' THEN 1 WHEN LOWER(drug) LIKE '%flagyl%' THEN 1 WHEN LOWER(drug) LIKE '%fortaz%' THEN 1 WHEN LOWER(drug) LIKE '%furadantin%' THEN 1 WHEN LOWER(drug) LIKE '%garamycin%' THEN 1 WHEN LOWER(drug) LIKE '%gentamicin%' THEN 1 WHEN LOWER(drug) LIKE '%kanamycin%' THEN 1 WHEN LOWER(drug) LIKE '%keflex%' THEN 1 WHEN LOWER(drug) LIKE '%kefzol%' THEN 1 WHEN LOWER(drug) LIKE '%ketek%' THEN 1 WHEN LOWER(drug) LIKE '%levaquin%' THEN 1 WHEN LOWER(drug) LIKE '%levofloxacin%' THEN 1 WHEN LOWER(drug) LIKE '%lincocin%' THEN 1 WHEN LOWER(drug) LIKE '%linezolid%' THEN 1 WHEN LOWER(drug) LIKE '%macrobid%' THEN 1 WHEN LOWER(drug) LIKE '%macrodantin%' THEN 1 WHEN LOWER(drug) LIKE '%maxipime%' THEN 1 WHEN LOWER(drug) LIKE '%mefoxin%' THEN 1 WHEN LOWER(drug) LIKE '%metronidazole%' THEN 1 WHEN LOWER(drug) LIKE '%meropenem%' THEN 1 WHEN LOWER(drug) LIKE '%methicillin%' THEN 1 WHEN LOWER(drug) LIKE '%minocin%' THEN 1 WHEN LOWER(drug) LIKE '%minocycline%' THEN 1 WHEN LOWER(drug) LIKE '%monodox%' THEN 1 WHEN LOWER(drug) LIKE '%monurol%' THEN 1 WHEN LOWER(drug) LIKE '%morgidox%' THEN 1 WHEN LOWER(drug) LIKE '%moxatag%' THEN 1 WHEN LOWER(drug) LIKE '%moxifloxacin%' THEN 1 WHEN LOWER(drug) LIKE '%mupirocin%' THEN 1 WHEN LOWER(drug) LIKE '%myrac%' THEN 1 WHEN LOWER(drug) LIKE '%nafcillin%' THEN 1 WHEN LOWER(drug) LIKE '%neomycin%' THEN 1 WHEN LOWER(drug) LIKE '%nicazel doxy 30%' THEN 1 WHEN LOWER(drug) LIKE '%nitrofurantoin%' THEN 1 WHEN LOWER(drug) LIKE '%norfloxacin%' THEN 1 WHEN LOWER(drug) LIKE '%noroxin%' THEN 1 WHEN LOWER(drug) LIKE '%ocudox%' THEN 1 WHEN LOWER(drug) LIKE '%ofloxacin%' THEN 1 WHEN LOWER(drug) LIKE '%omnicef%' THEN 1 WHEN LOWER(drug) LIKE '%oracea%' THEN 1 WHEN LOWER(drug) LIKE '%oraxyl%' THEN 1 WHEN LOWER(drug) LIKE '%oxacillin%' THEN 1 WHEN LOWER(drug) LIKE '%pc pen vk%' THEN 1 WHEN LOWER(drug) LIKE '%pce dispertab%' THEN 1 WHEN LOWER(drug) LIKE '%panixine%' THEN 1 WHEN LOWER(drug) LIKE '%pediazole%' THEN 1 WHEN LOWER(drug) LIKE '%penicillin%' THEN 1 WHEN LOWER(drug) LIKE '%periostat%' THEN 1 WHEN LOWER(drug) LIKE '%pfizerpen%' THEN 1 WHEN LOWER(drug) LIKE '%piperacillin%' THEN 1 WHEN LOWER(drug) LIKE '%tazobactam%' THEN 1 WHEN LOWER(drug) LIKE '%primsol%' THEN 1 WHEN LOWER(drug) LIKE '%proquin%' THEN 1 WHEN LOWER(drug) LIKE '%raniclor%' THEN 1 WHEN LOWER(drug) LIKE '%rifadin%' THEN 1 WHEN LOWER(drug) LIKE '%rifampin%' THEN 1 WHEN LOWER(drug) LIKE '%rocephin%' THEN 1 WHEN LOWER(drug) LIKE '%smz-tmp%' THEN 1 WHEN LOWER(drug) LIKE '%septra%' THEN 1 WHEN LOWER(drug) LIKE '%septra ds%' THEN 1 WHEN LOWER(drug) LIKE '%septra%' THEN 1 WHEN LOWER(drug) LIKE '%solodyn%' THEN 1 WHEN LOWER(drug) LIKE '%spectracef%' THEN 1 WHEN LOWER(drug) LIKE '%streptomycin%' THEN 1 WHEN LOWER(drug) LIKE '%sulfadiazine%' THEN 1 WHEN LOWER(drug) LIKE '%sulfamethoxazole%' THEN 1 WHEN LOWER(drug) LIKE '%trimethoprim%' THEN 1 WHEN LOWER(drug) LIKE '%sulfatrim%' THEN 1 WHEN LOWER(drug) LIKE '%sulfisoxazole%' THEN 1 WHEN LOWER(drug) LIKE '%suprax%' THEN 1 WHEN LOWER(drug) LIKE '%synercid%' THEN 1 WHEN LOWER(drug) LIKE '%tazicef%' THEN 1 WHEN LOWER(drug) LIKE '%tetracycline%' THEN 1 WHEN LOWER(drug) LIKE '%timentin%' THEN 1 WHEN LOWER(drug) LIKE '%tobramycin%' THEN 1 WHEN LOWER(drug) LIKE '%trimethoprim%' THEN 1 WHEN LOWER(drug) LIKE '%unasyn%' THEN 1 WHEN LOWER(drug) LIKE '%vancocin%' THEN 1 WHEN LOWER(drug) LIKE '%vancomycin%' THEN 1 WHEN LOWER(drug) LIKE '%vantin%' THEN 1 WHEN LOWER(drug) LIKE '%vibativ%' THEN 1 WHEN LOWER(drug) LIKE '%vibra-tabs%' THEN 1 WHEN LOWER(drug) LIKE '%vibramycin%' THEN 1 WHEN LOWER(drug) LIKE '%zinacef%' THEN 1 WHEN LOWER(drug) LIKE '%zithromax%' THEN 1 WHEN LOWER(drug) LIKE '%zosyn%' THEN 1 WHEN LOWER(drug) LIKE '%zyvox%' THEN 1 ELSE 0 END AS antibiotic FROM mimiciv_hosp.prescriptions WHERE drug_type NOT IN ('BASE') AND route NOT IN ('OU','OS','OD','AU','AS','AD','TP') AND LOWER(route) NOT LIKE '%ear%' AND LOWER(route) NOT LIKE '%eye%' AND LOWER(drug) NOT LIKE '%cream%' AND LOWER(drug) NOT LIKE '%desensitization%' AND LOWER(drug) NOT LIKE '%ophth oint%' AND LOWER(drug) NOT LIKE '%gel%' ) SELECT pr.subject_id,pr.hadm_id,ie.stay_id,pr.drug AS antibiotic,pr.route,pr.starttime,pr.stoptime FROM mimiciv_hosp.prescriptions pr INNER JOIN abx ON pr.drug = abx.drug AND pr.route = abx.route LEFT JOIN mimiciv_icu.icustays ie ON pr.hadm_id = ie.hadm_id AND pr.starttime >= ie.intime AND pr.starttime < ie.outtime WHERE abx.antibiotic = 1"
  },
  "mimiciv_derived.dobutamine": {
    "tables": ["mimiciv_icu.inputevents"],
    "columns": {
      "stay_id": [
        ["mimiciv_icu.inputevents.stay_id"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "linkorderid": [
        ["mimiciv_icu.inputevents.linkorderid"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "vaso_rate": [
        ["mimiciv_icu.inputevents.rate"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "vaso_amount": [
        ["mimiciv_icu.inputevents.amount"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "starttime": [
        ["mimiciv_icu.inputevents.starttime"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "endtime": [
        ["mimiciv_icu.inputevents.endtime"],
        ["mimiciv_icu.inputevents.itemid"]
      ]
    },
    "table_name": "mimiciv_derived.dobutamine",
    "sql": "SELECT stay_id,linkorderid,rate AS vaso_rate,amount AS vaso_amount,starttime,endtime FROM mimiciv_icu.inputevents WHERE itemid = 221653"
  },
  "mimiciv_derived.dopamine": {
    "tables": ["mimiciv_icu.inputevents"],
    "columns": {
      "stay_id": [
        ["mimiciv_icu.inputevents.stay_id"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "linkorderid": [
        ["mimiciv_icu.inputevents.linkorderid"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "vaso_rate": [
        ["mimiciv_icu.inputevents.rate"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "vaso_amount": [
        ["mimiciv_icu.inputevents.amount"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "starttime": [
        ["mimiciv_icu.inputevents.starttime"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "endtime": [
        ["mimiciv_icu.inputevents.endtime"],
        ["mimiciv_icu.inputevents.itemid"]
      ]
    },
    "table_name": "mimiciv_derived.dopamine",
    "sql": "SELECT stay_id,linkorderid,rate AS vaso_rate,amount AS vaso_amount,starttime,endtime FROM mimiciv_icu.inputevents WHERE itemid = 221662"
  },
  "mimiciv_derived.epinephrine": {
    "tables": ["mimiciv_icu.inputevents"],
    "columns": {
      "stay_id": [
        ["mimiciv_icu.inputevents.stay_id"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "linkorderid": [
        ["mimiciv_icu.inputevents.linkorderid"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "vaso_rate": [
        ["mimiciv_icu.inputevents.rate"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "vaso_amount": [
        ["mimiciv_icu.inputevents.amount"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "starttime": [
        ["mimiciv_icu.inputevents.starttime"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "endtime": [
        ["mimiciv_icu.inputevents.endtime"],
        ["mimiciv_icu.inputevents.itemid"]
      ]
    },
    "table_name": "mimiciv_derived.epinephrine",
    "sql": "SELECT stay_id,linkorderid,rate AS vaso_rate,amount AS vaso_amount,starttime,endtime FROM mimiciv_icu.inputevents WHERE itemid = 221289"
  },
  "mimiciv_derived.milrinone": {
    "tables": ["mimiciv_icu.inputevents"],
    "columns": {
      "stay_id": [
        ["mimiciv_icu.inputevents.stay_id"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "linkorderid": [
        ["mimiciv_icu.inputevents.linkorderid"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "vaso_rate": [
        ["mimiciv_icu.inputevents.rate"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "vaso_amount": [
        ["mimiciv_icu.inputevents.amount"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "starttime": [
        ["mimiciv_icu.inputevents.starttime"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "endtime": [
        ["mimiciv_icu.inputevents.endtime"],
        ["mimiciv_icu.inputevents.itemid"]
      ]
    },
    "table_name": "mimiciv_derived.milrinone",
    "sql": "SELECT stay_id,linkorderid,rate AS vaso_rate,amount AS vaso_amount,starttime,endtime FROM mimiciv_icu.inputevents WHERE itemid = 221986"
  },
  "mimiciv_derived.norepinephrine": {
    "tables": ["mimiciv_icu.inputevents"],
    "columns": {
      "stay_id": [
        ["mimiciv_icu.inputevents.stay_id"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "linkorderid": [
        ["mimiciv_icu.inputevents.linkorderid"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "vaso_rate": [
        [
          "mimiciv_icu.inputevents.rateuom",
          "mimiciv_icu.inputevents.patientweight",
          "mimiciv_icu.inputevents.rate"
        ],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "vaso_amount": [
        ["mimiciv_icu.inputevents.amount"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "starttime": [
        ["mimiciv_icu.inputevents.starttime"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "endtime": [
        ["mimiciv_icu.inputevents.endtime"],
        ["mimiciv_icu.inputevents.itemid"]
      ]
    },
    "table_name": "mimiciv_derived.norepinephrine",
    "sql": "SELECT stay_id,linkorderid,CASE WHEN rateuom = 'mg/kg/min' AND patientweight = 1 THEN rate WHEN rateuom = 'mg/kg/min' THEN rate * 1000.0 ELSE rate END AS vaso_rate,amount AS vaso_amount,starttime,endtime FROM mimiciv_icu.inputevents WHERE itemid = 221906"
  },
  "mimiciv_derived.phenylephrine": {
    "tables": ["mimiciv_icu.inputevents"],
    "columns": {
      "stay_id": [
        ["mimiciv_icu.inputevents.stay_id"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "linkorderid": [
        ["mimiciv_icu.inputevents.linkorderid"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "vaso_rate": [
        [
          "mimiciv_icu.inputevents.rateuom",
          "mimiciv_icu.inputevents.patientweight",
          "mimiciv_icu.inputevents.rate"
        ],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "vaso_amount": [
        ["mimiciv_icu.inputevents.amount"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "starttime": [
        ["mimiciv_icu.inputevents.starttime"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "endtime": [
        ["mimiciv_icu.inputevents.endtime"],
        ["mimiciv_icu.inputevents.itemid"]
      ]
    },
    "table_name": "mimiciv_derived.phenylephrine",
    "sql": "SELECT stay_id,linkorderid,CASE WHEN rateuom = 'mcg/min' THEN rate / patientweight ELSE rate END AS vaso_rate,amount AS vaso_amount,starttime,endtime FROM mimiciv_icu.inputevents WHERE itemid = 221749"
  },
  "mimiciv_derived.vasoactive_agent": {
    "tables": [
      "mimiciv_derived.norepinephrine",
      "mimiciv_derived.milrinone",
      "mimiciv_derived.epinephrine",
      "mimiciv_derived.dopamine",
      "mimiciv_derived.vasopressin",
      "mimiciv_derived.phenylephrine",
      "mimiciv_derived.dobutamine"
    ],
    "columns": {
      "stay_id": [
        ["mimiciv_derived.dobutamine.stay_id"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.phenylephrine.stay_id",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.vasopressin.endtime",
          "mimiciv_derived.milrinone.starttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.milrinone.stay_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.phenylephrine.starttime",
          "mimiciv_derived.phenylephrine.endtime",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.milrinone.endtime",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.vasopressin.starttime",
          "mimiciv_derived.vasopressin.stay_id"
        ]
      ],
      "starttime": [
        ["mimiciv_derived.dobutamine.starttime"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.phenylephrine.stay_id",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.vasopressin.endtime",
          "mimiciv_derived.milrinone.starttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.milrinone.stay_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.phenylephrine.starttime",
          "mimiciv_derived.phenylephrine.endtime",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.milrinone.endtime",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.vasopressin.starttime",
          "mimiciv_derived.vasopressin.stay_id"
        ]
      ],
      "endtime": [
        [
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.dobutamine.starttime"
        ],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.phenylephrine.stay_id",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.vasopressin.endtime",
          "mimiciv_derived.milrinone.starttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.milrinone.stay_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.phenylephrine.starttime",
          "mimiciv_derived.phenylephrine.endtime",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.milrinone.endtime",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.vasopressin.starttime",
          "mimiciv_derived.vasopressin.stay_id"
        ]
      ],
      "dopamine": [
        ["mimiciv_derived.dopamine.vaso_rate"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.phenylephrine.stay_id",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.vasopressin.endtime",
          "mimiciv_derived.milrinone.starttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.milrinone.stay_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.phenylephrine.starttime",
          "mimiciv_derived.phenylephrine.endtime",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.milrinone.endtime",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.vasopressin.starttime",
          "mimiciv_derived.vasopressin.stay_id"
        ]
      ],
      "epinephrine": [
        ["mimiciv_derived.epinephrine.vaso_rate"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.phenylephrine.stay_id",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.vasopressin.endtime",
          "mimiciv_derived.milrinone.starttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.milrinone.stay_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.phenylephrine.starttime",
          "mimiciv_derived.phenylephrine.endtime",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.milrinone.endtime",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.vasopressin.starttime",
          "mimiciv_derived.vasopressin.stay_id"
        ]
      ],
      "norepinephrine": [
        ["mimiciv_derived.norepinephrine.vaso_rate"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.phenylephrine.stay_id",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.vasopressin.endtime",
          "mimiciv_derived.milrinone.starttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.milrinone.stay_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.phenylephrine.starttime",
          "mimiciv_derived.phenylephrine.endtime",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.milrinone.endtime",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.vasopressin.starttime",
          "mimiciv_derived.vasopressin.stay_id"
        ]
      ],
      "phenylephrine": [
        ["mimiciv_derived.phenylephrine.vaso_rate"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.phenylephrine.stay_id",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.vasopressin.endtime",
          "mimiciv_derived.milrinone.starttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.milrinone.stay_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.phenylephrine.starttime",
          "mimiciv_derived.phenylephrine.endtime",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.milrinone.endtime",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.vasopressin.starttime",
          "mimiciv_derived.vasopressin.stay_id"
        ]
      ],
      "vasopressin": [
        ["mimiciv_derived.vasopressin.vaso_rate"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.phenylephrine.stay_id",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.vasopressin.endtime",
          "mimiciv_derived.milrinone.starttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.milrinone.stay_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.phenylephrine.starttime",
          "mimiciv_derived.phenylephrine.endtime",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.milrinone.endtime",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.vasopressin.starttime",
          "mimiciv_derived.vasopressin.stay_id"
        ]
      ],
      "dobutamine": [
        ["mimiciv_derived.dobutamine.vaso_rate"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.phenylephrine.stay_id",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.vasopressin.endtime",
          "mimiciv_derived.milrinone.starttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.milrinone.stay_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.phenylephrine.starttime",
          "mimiciv_derived.phenylephrine.endtime",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.milrinone.endtime",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.vasopressin.starttime",
          "mimiciv_derived.vasopressin.stay_id"
        ]
      ],
      "milrinone": [
        ["mimiciv_derived.milrinone.vaso_rate"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.phenylephrine.stay_id",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.vasopressin.endtime",
          "mimiciv_derived.milrinone.starttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.milrinone.stay_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.phenylephrine.starttime",
          "mimiciv_derived.phenylephrine.endtime",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.milrinone.endtime",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.vasopressin.starttime",
          "mimiciv_derived.vasopressin.stay_id"
        ]
      ]
    },
    "table_name": "mimiciv_derived.vasoactive_agent",
    "sql": "WITH tm AS ( SELECT stay_id,starttime AS vasotime FROM mimiciv_derived.dobutamine UNION DISTINCT SELECT stay_id,starttime AS vasotime FROM mimiciv_derived.dopamine UNION DISTINCT SELECT stay_id,starttime AS vasotime FROM mimiciv_derived.epinephrine UNION DISTINCT SELECT stay_id,starttime AS vasotime FROM mimiciv_derived.norepinephrine UNION DISTINCT SELECT stay_id,starttime AS vasotime FROM mimiciv_derived.phenylephrine UNION DISTINCT SELECT stay_id,starttime AS vasotime FROM mimiciv_derived.vasopressin UNION DISTINCT SELECT stay_id,starttime AS vasotime FROM mimiciv_derived.milrinone UNION DISTINCT SELECT stay_id,endtime AS vasotime FROM mimiciv_derived.dobutamine UNION DISTINCT SELECT stay_id,endtime AS vasotime FROM mimiciv_derived.dopamine UNION DISTINCT SELECT stay_id,endtime AS vasotime FROM mimiciv_derived.epinephrine UNION DISTINCT SELECT stay_id,endtime AS vasotime FROM mimiciv_derived.norepinephrine UNION DISTINCT SELECT stay_id,endtime AS vasotime FROM mimiciv_derived.phenylephrine UNION DISTINCT SELECT stay_id,endtime AS vasotime FROM mimiciv_derived.vasopressin UNION DISTINCT SELECT stay_id,endtime AS vasotime FROM mimiciv_derived.milrinone ),tm_lag AS ( SELECT stay_id,vasotime AS starttime,LEAD( vasotime,1 ) OVER (PARTITION BY stay_id ORDER BY vasotime) AS endtime FROM tm ) SELECT t.stay_id,t.starttime,t.endtime,dop.vaso_rate AS dopamine,epi.vaso_rate AS epinephrine,nor.vaso_rate AS norepinephrine,phe.vaso_rate AS phenylephrine,vas.vaso_rate AS vasopressin,dob.vaso_rate AS dobutamine,mil.vaso_rate AS milrinone FROM tm_lag t LEFT JOIN mimiciv_derived.dobutamine dob ON t.stay_id = dob.stay_id AND t.starttime >= dob.starttime AND t.endtime <= dob.endtime LEFT JOIN mimiciv_derived.dopamine dop ON t.stay_id = dop.stay_id AND t.starttime >= dop.starttime AND t.endtime <= dop.endtime LEFT JOIN mimiciv_derived.epinephrine epi ON t.stay_id = epi.stay_id AND t.starttime >= epi.starttime AND t.endtime <= epi.endtime LEFT JOIN mimiciv_derived.norepinephrine nor ON t.stay_id = nor.stay_id AND t.starttime >= nor.starttime AND t.endtime <= nor.endtime LEFT JOIN mimiciv_derived.phenylephrine phe ON t.stay_id = phe.stay_id AND t.starttime >= phe.starttime AND t.endtime <= phe.endtime LEFT JOIN mimiciv_derived.vasopressin vas ON t.stay_id = vas.stay_id AND t.starttime >= vas.starttime AND t.endtime <= vas.endtime LEFT JOIN mimiciv_derived.milrinone mil ON t.stay_id = mil.stay_id AND t.starttime >= mil.starttime AND t.endtime <= mil.endtime WHERE t.endtime IS NOT NULL"
  },
  "mimiciv_derived.vasopressin": {
    "tables": ["mimiciv_icu.inputevents"],
    "columns": {
      "stay_id": [
        ["mimiciv_icu.inputevents.stay_id"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "linkorderid": [
        ["mimiciv_icu.inputevents.linkorderid"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "vaso_rate": [
        ["mimiciv_icu.inputevents.rateuom", "mimiciv_icu.inputevents.rate"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "vaso_amount": [
        ["mimiciv_icu.inputevents.amount"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "starttime": [
        ["mimiciv_icu.inputevents.starttime"],
        ["mimiciv_icu.inputevents.itemid"]
      ],
      "endtime": [
        ["mimiciv_icu.inputevents.endtime"],
        ["mimiciv_icu.inputevents.itemid"]
      ]
    },
    "table_name": "mimiciv_derived.vasopressin",
    "sql": "SELECT stay_id,linkorderid,CASE WHEN rateuom = 'units/min' THEN rate * 60.0 ELSE rate END AS vaso_rate,amount AS vaso_amount,starttime,endtime FROM mimiciv_icu.inputevents WHERE itemid = 222315"
  },
  "mimiciv_derived.kdigo_creatinine": {
    "tables": ["mimiciv_hosp.labevents", "mimiciv_icu.icustays"],
    "columns": {
      "hadm_id": [
        ["mimiciv_icu.icustays.hadm_id"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.icustays.intime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.icustays.intime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "charttime": [
        ["mimiciv_hosp.labevents.charttime"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.icustays.intime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "creat": [
        ["mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.icustays.intime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "creat_low_past_48hr": [
        ["mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.icustays.intime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ],
      "creat_low_past_7day": [
        ["mimiciv_hosp.labevents.valuenum"],
        [
          "mimiciv_hosp.labevents.itemid",
          "mimiciv_icu.icustays.outtime",
          "mimiciv_hosp.labevents.valuenum",
          "mimiciv_icu.icustays.intime",
          "mimiciv_hosp.labevents.subject_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_hosp.labevents.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_icu.icustays.subject_id"
        ]
      ]
    },
    "table_name": "mimiciv_derived.kdigo_creatinine",
    "sql": "WITH cr AS ( SELECT ie.hadm_id,ie.stay_id,le.charttime,AVG(le.valuenum) AS creat FROM mimiciv_icu.icustays ie LEFT JOIN mimiciv_hosp.labevents le ON ie.subject_id = le.subject_id AND le.itemid = 50912 AND le.valuenum IS NOT NULL AND le.valuenum <= 150 AND le.charttime >= DATETIME_SUB(ie.intime,INTERVAL '7' DAY) AND le.charttime <= ie.outtime GROUP BY ie.hadm_id,ie.stay_id,le.charttime ),cr48 AS ( SELECT cr.stay_id,cr.charttime,MIN(cr48.creat) AS creat_low_past_48hr FROM cr LEFT JOIN cr cr48 ON cr.stay_id = cr48.stay_id AND cr48.charttime < cr.charttime AND cr48.charttime >= DATETIME_SUB(cr.charttime,INTERVAL '48' HOUR) GROUP BY cr.stay_id,cr.charttime ),cr7 AS ( SELECT cr.stay_id,cr.charttime,MIN(cr7.creat) AS creat_low_past_7day FROM cr LEFT JOIN cr cr7 ON cr.stay_id = cr7.stay_id AND cr7.charttime < cr.charttime AND cr7.charttime >= DATETIME_SUB(cr.charttime,INTERVAL '7' DAY) GROUP BY cr.stay_id,cr.charttime ) SELECT cr.hadm_id,cr.stay_id,cr.charttime,cr.creat,cr48.creat_low_past_48hr,cr7.creat_low_past_7day FROM cr LEFT JOIN cr48 ON cr.stay_id = cr48.stay_id AND cr.charttime = cr48.charttime LEFT JOIN cr7 ON cr.stay_id = cr7.stay_id AND cr.charttime = cr7.charttime"
  },
  "mimiciv_derived.kdigo_uo": {
    "tables": [
      "mimiciv_derived.weight_durations",
      "mimiciv_derived.urine_output",
      "mimiciv_icu.icustays"
    ],
    "columns": {
      "stay_id": [
        ["mimiciv_icu.icustays.stay_id"],
        [
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "charttime": [
        ["mimiciv_derived.urine_output.charttime"],
        [
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "weight": [
        ["mimiciv_derived.weight_durations.weight"],
        [
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "urineoutput_6hr": [
        [
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.urine_output.urineoutput",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.icustays.intime"
        ],
        [
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "urineoutput_12hr": [
        [
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.urine_output.urineoutput",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.icustays.intime"
        ],
        [
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "urineoutput_24hr": [
        [
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.urine_output.urineoutput",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.icustays.intime"
        ],
        [
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "uo_rt_6hr": [
        [
          "mimiciv_derived.urine_output.urineoutput",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.weight_durations.weight",
          "mimiciv_derived.urine_output.charttime"
        ],
        [
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "uo_rt_12hr": [
        [
          "mimiciv_derived.urine_output.urineoutput",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.weight_durations.weight",
          "mimiciv_derived.urine_output.charttime"
        ],
        [
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "uo_rt_24hr": [
        [
          "mimiciv_derived.urine_output.urineoutput",
          "mimiciv_icu.icustays.intime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.weight_durations.weight",
          "mimiciv_derived.urine_output.charttime"
        ],
        [
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "uo_tm_6hr": [
        [
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.icustays.intime"
        ],
        [
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "uo_tm_12hr": [
        [
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.icustays.intime"
        ],
        [
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ],
      "uo_tm_24hr": [
        [
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_icu.icustays.intime"
        ],
        [
          "mimiciv_derived.weight_durations.endtime",
          "mimiciv_icu.icustays.intime",
          "mimiciv_derived.weight_durations.stay_id",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.urine_output.charttime",
          "mimiciv_derived.weight_durations.starttime",
          "mimiciv_derived.urine_output.stay_id"
        ]
      ]
    },
    "table_name": "mimiciv_derived.kdigo_uo",
    "sql": "WITH uo_stg1 AS ( SELECT ie.stay_id,uo.charttime,DATETIME_DIFF(charttime,intime,'SECOND') AS seconds_since_admit,COALESCE( DATETIME_DIFF(charttime,LAG(charttime) OVER (PARTITION BY ie.stay_id ORDER BY charttime),'SECOND') / 3600.0,1 ) AS hours_since_previous_row,urineoutput FROM mimiciv_icu.icustays ie INNER JOIN mimiciv_derived.urine_output uo ON ie.stay_id = uo.stay_id ),uo_stg2 AS ( SELECT stay_id,charttime,hours_since_previous_row,urineoutput,SUM(urineoutput) OVER ( PARTITION BY stay_id ORDER BY seconds_since_admit RANGE BETWEEN 21600 PRECEDING AND CURRENT ROW ) AS urineoutput_6hr,SUM(urineoutput) OVER ( PARTITION BY stay_id ORDER BY seconds_since_admit RANGE BETWEEN 43200 PRECEDING AND CURRENT ROW ) AS urineoutput_12hr,SUM(urineoutput) OVER ( PARTITION BY stay_id ORDER BY seconds_since_admit RANGE BETWEEN 86400 PRECEDING AND CURRENT ROW ) AS urineoutput_24hr,SUM(hours_since_previous_row) OVER ( PARTITION BY stay_id ORDER BY seconds_since_admit RANGE BETWEEN 21600 PRECEDING AND CURRENT ROW ) AS uo_tm_6hr,SUM(hours_since_previous_row) OVER ( PARTITION BY stay_id ORDER BY seconds_since_admit RANGE BETWEEN 43200 PRECEDING AND CURRENT ROW ) AS uo_tm_12hr,SUM(hours_since_previous_row) OVER ( PARTITION BY stay_id ORDER BY seconds_since_admit RANGE BETWEEN 86400 PRECEDING AND CURRENT ROW ) AS uo_tm_24hr FROM uo_stg1 ) SELECT ur.stay_id,ur.charttime,wd.weight,ur.urineoutput_6hr,ur.urineoutput_12hr,ur.urineoutput_24hr,CASE WHEN uo_tm_6hr >= 6 AND uo_tm_6hr < 12 THEN ROUND( CAST((ur.urineoutput_6hr / wd.weight / uo_tm_6hr) AS NUMERIC),4 ) ELSE NULL END AS uo_rt_6hr,CASE WHEN uo_tm_12hr >= 12 THEN ROUND( CAST((ur.urineoutput_12hr / wd.weight / uo_tm_12hr) AS NUMERIC),4 ) ELSE NULL END AS uo_rt_12hr,CASE WHEN uo_tm_24hr >= 24 THEN ROUND( CAST((ur.urineoutput_24hr / wd.weight / uo_tm_24hr) AS NUMERIC),4 ) ELSE NULL END AS uo_rt_24hr,uo_tm_6hr,uo_tm_12hr,uo_tm_24hr FROM uo_stg2 ur LEFT JOIN mimiciv_derived.weight_durations wd ON ur.stay_id = wd.stay_id AND ur.charttime >= wd.starttime AND ur.charttime < wd.endtime"
  },
  "mimiciv_derived.sofa": {
    "tables": [
      "mimiciv_derived.vitalsign",
      "mimiciv_derived.norepinephrine",
      "mimiciv_derived.enzyme",
      "mimiciv_derived.epinephrine",
      "mimiciv_derived.dopamine",
      "mimiciv_derived.chemistry",
      "mimiciv_derived.complete_blood_count",
      "mimiciv_derived.bg",
      "mimiciv_icu.icustays",
      "mimiciv_derived.gcs",
      "mimiciv_derived.ventilation",
      "mimiciv_derived.dobutamine",
      "mimiciv_derived.icustay_hourly",
      "mimiciv_derived.urine_output_rate"
    ],
    "columns": {
      "stay_id": [
        ["mimiciv_derived.icustay_hourly.stay_id"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "hr": [
        ["mimiciv_derived.icustay_hourly.hr"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "starttime": [
        ["mimiciv_derived.icustay_hourly.endtime"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "endtime": [
        ["mimiciv_derived.icustay_hourly.endtime"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "pao2fio2ratio_novent": [
        [
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.bg.pao2fio2ratio"
        ],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "pao2fio2ratio_vent": [
        [
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.bg.pao2fio2ratio"
        ],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "rate_epinephrine": [
        ["mimiciv_derived.epinephrine.vaso_rate"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "rate_norepinephrine": [
        ["mimiciv_derived.norepinephrine.vaso_rate"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "rate_dopamine": [
        ["mimiciv_derived.dopamine.vaso_rate"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "rate_dobutamine": [
        ["mimiciv_derived.dobutamine.vaso_rate"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "meanbp_min": [
        ["mimiciv_derived.vitalsign.mbp"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "gcs_min": [
        ["mimiciv_derived.gcs.gcs"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "uo_24hr": [
        [
          "mimiciv_derived.urine_output_rate.urineoutput_24hr",
          "mimiciv_derived.urine_output_rate.uo_tm_24hr"
        ],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "bilirubin_max": [
        ["mimiciv_derived.enzyme.bilirubin_total"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "creatinine_max": [
        ["mimiciv_derived.chemistry.creatinine"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "platelet_min": [
        ["mimiciv_derived.complete_blood_count.platelet"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "respiration": [
        [
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.bg.pao2fio2ratio"
        ],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "coagulation": [
        ["mimiciv_derived.complete_blood_count.platelet"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "liver": [
        ["mimiciv_derived.enzyme.bilirubin_total"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "cardiovascular": [
        [
          "mimiciv_derived.dopamine.vaso_rate",
          "mimiciv_derived.vitalsign.mbp",
          "mimiciv_derived.dobutamine.vaso_rate",
          "mimiciv_derived.epinephrine.vaso_rate",
          "mimiciv_derived.norepinephrine.vaso_rate"
        ],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "cns": [
        ["mimiciv_derived.gcs.gcs"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "renal": [
        [
          "mimiciv_derived.urine_output_rate.urineoutput_24hr",
          "mimiciv_derived.chemistry.creatinine",
          "mimiciv_derived.urine_output_rate.uo_tm_24hr"
        ],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "respiration_24hours": [
        [
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.bg.pao2fio2ratio"
        ],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "coagulation_24hours": [
        ["mimiciv_derived.complete_blood_count.platelet"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "liver_24hours": [
        ["mimiciv_derived.enzyme.bilirubin_total"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "cardiovascular_24hours": [
        [
          "mimiciv_derived.dopamine.vaso_rate",
          "mimiciv_derived.vitalsign.mbp",
          "mimiciv_derived.dobutamine.vaso_rate",
          "mimiciv_derived.epinephrine.vaso_rate",
          "mimiciv_derived.norepinephrine.vaso_rate"
        ],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "cns_24hours": [
        ["mimiciv_derived.gcs.gcs"],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "renal_24hours": [
        [
          "mimiciv_derived.urine_output_rate.urineoutput_24hr",
          "mimiciv_derived.chemistry.creatinine",
          "mimiciv_derived.urine_output_rate.uo_tm_24hr"
        ],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ],
      "sofa_24hours": [
        [
          "mimiciv_derived.dopamine.vaso_rate",
          "mimiciv_derived.vitalsign.mbp",
          "mimiciv_derived.dobutamine.vaso_rate",
          "mimiciv_derived.enzyme.bilirubin_total",
          "mimiciv_derived.epinephrine.vaso_rate",
          "mimiciv_derived.complete_blood_count.platelet",
          "mimiciv_derived.urine_output_rate.uo_tm_24hr",
          "mimiciv_derived.urine_output_rate.urineoutput_24hr",
          "mimiciv_derived.norepinephrine.vaso_rate",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.chemistry.creatinine",
          "mimiciv_derived.bg.pao2fio2ratio",
          "mimiciv_derived.gcs.gcs"
        ],
        [
          "mimiciv_derived.norepinephrine.endtime",
          "mimiciv_derived.dopamine.stay_id",
          "mimiciv_derived.dopamine.starttime",
          "mimiciv_derived.epinephrine.starttime",
          "mimiciv_derived.ventilation.stay_id",
          "mimiciv_derived.epinephrine.stay_id",
          "mimiciv_derived.icustay_hourly.endtime",
          "mimiciv_derived.complete_blood_count.charttime",
          "mimiciv_derived.gcs.stay_id",
          "mimiciv_derived.ventilation.starttime",
          "mimiciv_derived.bg.charttime",
          "mimiciv_derived.urine_output_rate.stay_id",
          "mimiciv_derived.ventilation.endtime",
          "mimiciv_derived.urine_output_rate.charttime",
          "mimiciv_derived.dobutamine.starttime",
          "mimiciv_derived.epinephrine.endtime",
          "mimiciv_derived.bg.specimen",
          "mimiciv_derived.complete_blood_count.hadm_id",
          "mimiciv_derived.chemistry.hadm_id",
          "mimiciv_derived.vitalsign.stay_id",
          "mimiciv_icu.icustays.hadm_id",
          "mimiciv_derived.norepinephrine.starttime",
          "mimiciv_derived.icustay_hourly.stay_id",
          "mimiciv_derived.vitalsign.charttime",
          "mimiciv_icu.icustays.stay_id",
          "mimiciv_derived.enzyme.charttime",
          "mimiciv_derived.bg.subject_id",
          "mimiciv_derived.dopamine.endtime",
          "mimiciv_derived.enzyme.hadm_id",
          "mimiciv_derived.dobutamine.stay_id",
          "mimiciv_derived.norepinephrine.stay_id",
          "mimiciv_derived.dobutamine.endtime",
          "mimiciv_derived.ventilation.ventilation_status",
          "mimiciv_derived.icustay_hourly.hr",
          "mimiciv_derived.chemistry.charttime",
          "mimiciv_icu.icustays.subject_id",
          "mimiciv_derived.gcs.charttime"
        ]
      ]
    },
    "table_name": "mimiciv_derived.sofa",
    "sql": "WITH co AS ( SELECT ih.stay_id,ie.hadm_id,hr,DATETIME_SUB(ih.endtime,INTERVAL '1' HOUR) AS starttime,ih.endtime FROM mimiciv_derived.icustay_hourly ih INNER JOIN mimiciv_icu.icustays ie ON ih.stay_id = ie.stay_id ),pafi AS ( SELECT ie.stay_id,bg.charttime,CASE WHEN vd.stay_id IS NULL THEN pao2fio2ratio ELSE null END AS pao2fio2ratio_novent,CASE WHEN vd.stay_id IS NOT NULL THEN pao2fio2ratio ELSE null END AS pao2fio2ratio_vent FROM mimiciv_icu.icustays ie INNER JOIN mimiciv_derived.bg bg ON ie.subject_id = bg.subject_id LEFT JOIN mimiciv_derived.ventilation vd ON ie.stay_id = vd.stay_id AND bg.charttime >= vd.starttime AND bg.charttime <= vd.endtime AND vd.ventilation_status = 'InvasiveVent' WHERE specimen = 'ART.' ),vs AS ( SELECT co.stay_id,co.hr,MIN(vs.mbp) AS meanbp_min FROM co LEFT JOIN mimiciv_derived.vitalsign vs ON co.stay_id = vs.stay_id AND co.starttime < vs.charttime AND co.endtime >= vs.charttime GROUP BY co.stay_id,co.hr ),gcs AS ( SELECT co.stay_id,co.hr,MIN(gcs.gcs) AS gcs_min FROM co LEFT JOIN mimiciv_derived.gcs gcs ON co.stay_id = gcs.stay_id AND co.starttime < gcs.charttime AND co.endtime >= gcs.charttime GROUP BY co.stay_id,co.hr ),bili AS ( SELECT co.stay_id,co.hr,MAX(enz.bilirubin_total) AS bilirubin_max FROM co LEFT JOIN mimiciv_derived.enzyme enz ON co.hadm_id = enz.hadm_id AND co.starttime < enz.charttime AND co.endtime >= enz.charttime GROUP BY co.stay_id,co.hr ),cr AS ( SELECT co.stay_id,co.hr,MAX(chem.creatinine) AS creatinine_max FROM co LEFT JOIN mimiciv_derived.chemistry chem ON co.hadm_id = chem.hadm_id AND co.starttime < chem.charttime AND co.endtime >= chem.charttime GROUP BY co.stay_id,co.hr ),plt AS ( SELECT co.stay_id,co.hr,MIN(cbc.platelet) AS platelet_min FROM co LEFT JOIN mimiciv_derived.complete_blood_count cbc ON co.hadm_id = cbc.hadm_id AND co.starttime < cbc.charttime AND co.endtime >= cbc.charttime GROUP BY co.stay_id,co.hr ),pf AS ( SELECT co.stay_id,co.hr,MIN(pafi.pao2fio2ratio_novent) AS pao2fio2ratio_novent,MIN(pafi.pao2fio2ratio_vent) AS pao2fio2ratio_vent FROM co LEFT JOIN pafi ON co.stay_id = pafi.stay_id AND co.starttime < pafi.charttime AND co.endtime >= pafi.charttime GROUP BY co.stay_id,co.hr ),uo AS ( SELECT co.stay_id,co.hr,MAX( CASE WHEN uo.uo_tm_24hr >= 22 AND uo.uo_tm_24hr <= 30 THEN uo.urineoutput_24hr / uo.uo_tm_24hr * 24 END) AS uo_24hr FROM co LEFT JOIN mimiciv_derived.urine_output_rate uo ON co.stay_id = uo.stay_id AND co.starttime < uo.charttime AND co.endtime >= uo.charttime GROUP BY co.stay_id,co.hr ),vaso AS ( SELECT co.stay_id,co.hr,MAX(epi.vaso_rate) AS rate_epinephrine,MAX(nor.vaso_rate) AS rate_norepinephrine,MAX(dop.vaso_rate) AS rate_dopamine,MAX(dob.vaso_rate) AS rate_dobutamine FROM co LEFT JOIN mimiciv_derived.epinephrine epi ON co.stay_id = epi.stay_id AND co.endtime > epi.starttime AND co.endtime <= epi.endtime LEFT JOIN mimiciv_derived.norepinephrine nor ON co.stay_id = nor.stay_id AND co.endtime > nor.starttime AND co.endtime <= nor.endtime LEFT JOIN mimiciv_derived.dopamine dop ON co.stay_id = dop.stay_id AND co.endtime > dop.starttime AND co.endtime <= dop.endtime LEFT JOIN mimiciv_derived.dobutamine dob ON co.stay_id = dob.stay_id AND co.endtime > dob.starttime AND co.endtime <= dob.endtime WHERE epi.stay_id IS NOT NULL OR nor.stay_id IS NOT NULL OR dop.stay_id IS NOT NULL OR dob.stay_id IS NOT NULL GROUP BY co.stay_id,co.hr ),scorecomp AS ( SELECT co.stay_id,co.hr,co.starttime,co.endtime,pf.pao2fio2ratio_novent,pf.pao2fio2ratio_vent,vaso.rate_epinephrine,vaso.rate_norepinephrine,vaso.rate_dopamine,vaso.rate_dobutamine,vs.meanbp_min,gcs.gcs_min,uo.uo_24hr,bili.bilirubin_max,cr.creatinine_max,plt.platelet_min FROM co LEFT JOIN vs ON co.stay_id = vs.stay_id AND co.hr = vs.hr LEFT JOIN gcs ON co.stay_id = gcs.stay_id AND co.hr = gcs.hr LEFT JOIN bili ON co.stay_id = bili.stay_id AND co.hr = bili.hr LEFT JOIN cr ON co.stay_id = cr.stay_id AND co.hr = cr.hr LEFT JOIN plt ON co.stay_id = plt.stay_id AND co.hr = plt.hr LEFT JOIN pf ON co.stay_id = pf.stay_id AND co.hr = pf.hr LEFT JOIN uo ON co.stay_id = uo.stay_id AND co.hr = uo.hr LEFT JOIN vaso ON co.stay_id = vaso.stay_id AND co.hr = vaso.hr ),scorecalc AS ( SELECT scorecomp.*,CASE WHEN pao2fio2ratio_vent < 100 THEN 4 WHEN pao2fio2ratio_vent < 200 THEN 3 WHEN pao2fio2ratio_novent < 300 THEN 2 WHEN pao2fio2ratio_vent < 300 THEN 2 WHEN pao2fio2ratio_novent < 400 THEN 1 WHEN pao2fio2ratio_vent < 400 THEN 1 WHEN COALESCE( pao2fio2ratio_vent,pao2fio2ratio_novent ) IS NULL THEN null ELSE 0 END AS respiration,CASE WHEN platelet_min < 20 THEN 4 WHEN platelet_min < 50 THEN 3 WHEN platelet_min < 100 THEN 2 WHEN platelet_min < 150 THEN 1 WHEN platelet_min IS NULL THEN null ELSE 0 END AS coagulation,CASE WHEN bilirubin_max >= 12.0 THEN 4 WHEN bilirubin_max >= 6.0 THEN 3 WHEN bilirubin_max >= 2.0 THEN 2 WHEN bilirubin_max >= 1.2 THEN 1 WHEN bilirubin_max IS NULL THEN null ELSE 0 END AS liver,CASE WHEN rate_dopamine > 15 OR rate_epinephrine > 0.1 OR rate_norepinephrine > 0.1 THEN 4 WHEN rate_dopamine > 5 OR rate_epinephrine <= 0.1 OR rate_norepinephrine <= 0.1 THEN 3 WHEN rate_dopamine > 0 OR rate_dobutamine > 0 THEN 2 WHEN meanbp_min < 70 THEN 1 WHEN COALESCE( meanbp_min,rate_dopamine,rate_dobutamine,rate_epinephrine,rate_norepinephrine ) IS NULL THEN null ELSE 0 END AS cardiovascular,CASE WHEN (gcs_min >= 13 AND gcs_min <= 14) THEN 1 WHEN (gcs_min >= 10 AND gcs_min <= 12) THEN 2 WHEN (gcs_min >= 6 AND gcs_min <= 9) THEN 3 WHEN gcs_min < 6 THEN 4 WHEN gcs_min IS NULL THEN null ELSE 0 END AS cns,CASE WHEN (creatinine_max >= 5.0) THEN 4 WHEN uo_24hr < 200 THEN 4 WHEN (creatinine_max >= 3.5 AND creatinine_max < 5.0) THEN 3 WHEN uo_24hr < 500 THEN 3 WHEN (creatinine_max >= 2.0 AND creatinine_max < 3.5) THEN 2 WHEN (creatinine_max >= 1.2 AND creatinine_max < 2.0) THEN 1 WHEN COALESCE(uo_24hr,creatinine_max) IS NULL THEN null ELSE 0 END AS renal FROM scorecomp ),score_final AS ( SELECT s.*,COALESCE( MAX(respiration) OVER w,0) AS respiration_24hours,COALESCE( MAX(coagulation) OVER w,0) AS coagulation_24hours,COALESCE( MAX(liver) OVER w,0) AS liver_24hours,COALESCE( MAX(cardiovascular) OVER w,0) AS cardiovascular_24hours,COALESCE( MAX(cns) OVER w,0) AS cns_24hours,COALESCE( MAX(renal) OVER w,0) AS renal_24hours,COALESCE( MAX(respiration) OVER w,0) + COALESCE( MAX(coagulation) OVER w,0) + COALESCE( MAX(liver) OVER w,0) + COALESCE( MAX(cardiovascular) OVER w,0) + COALESCE( MAX(cns) OVER w,0) + COALESCE( MAX(renal) OVER w,0) AS sofa_24hours FROM scorecalc s WINDOW w AS ( PARTITION BY stay_id ORDER BY hr ROWS BETWEEN 23 PRECEDING AND 0 FOLLOWING ) ) SELECT * FROM score_final WHERE hr >= 0"
  },
  "mimiciv_derived.suspicion_of_infection": {
    "tables": ["mimiciv_derived.antibiotic", "mimiciv_hosp.microbiologyevents"],
    "columns": {
      "subject_id": [
        ["mimiciv_derived.antibiotic.subject_id"],
        [
          "mimiciv_hosp.microbiologyevents.charttime",
          "mimiciv_derived.antibiotic.subject_id",
          "mimiciv_hosp.microbiologyevents.subject_id",
          "mimiciv_derived.antibiotic.starttime",
          "mimiciv_derived.antibiotic.antibiotic",
          "mimiciv_hosp.microbiologyevents.chartdate",
          "mimiciv_hosp.microbiologyevents.micro_specimen_id",
          "mimiciv_derived.antibiotic.stoptime"
        ]
      ],
      "stay_id": [
        ["mimiciv_derived.antibiotic.stay_id"],
        [
          "mimiciv_hosp.microbiologyevents.charttime",
          "mimiciv_derived.antibiotic.subject_id",
          "mimiciv_hosp.microbiologyevents.subject_id",
          "mimiciv_derived.antibiotic.starttime",
          "mimiciv_derived.antibiotic.antibiotic",
          "mimiciv_hosp.microbiologyevents.chartdate",
          "mimiciv_hosp.microbiologyevents.micro_specimen_id",
          "mimiciv_derived.antibiotic.stoptime"
        ]
      ],
      "hadm_id": [
        ["mimiciv_derived.antibiotic.hadm_id"],
        [
          "mimiciv_hosp.microbiologyevents.charttime",
          "mimiciv_derived.antibiotic.subject_id",
          "mimiciv_hosp.microbiologyevents.subject_id",
          "mimiciv_derived.antibiotic.starttime",
          "mimiciv_derived.antibiotic.antibiotic",
          "mimiciv_hosp.microbiologyevents.chartdate",
          "mimiciv_hosp.microbiologyevents.micro_specimen_id",
          "mimiciv_derived.antibiotic.stoptime"
        ]
      ],
      "ab_id": [
        [
          "mimiciv_derived.antibiotic.subject_id",
          "mimiciv_derived.antibiotic.starttime",
          "mimiciv_derived.antibiotic.antibiotic",
          "mimiciv_derived.antibiotic.stoptime"
        ],
        [
          "mimiciv_hosp.microbiologyevents.charttime",
          "mimiciv_derived.antibiotic.subject_id",
          "mimiciv_hosp.microbiologyevents.subject_id",
          "mimiciv_derived.antibiotic.starttime",
          "mimiciv_derived.antibiotic.antibiotic",
          "mimiciv_hosp.microbiologyevents.chartdate",
          "mimiciv_hosp.microbiologyevents.micro_specimen_id",
          "mimiciv_derived.antibiotic.stoptime"
        ]
      ],
      "antibiotic": [
        ["mimiciv_derived.antibiotic.antibiotic"],
        [
          "mimiciv_hosp.microbiologyevents.charttime",
          "mimiciv_derived.antibiotic.subject_id",
          "mimiciv_hosp.microbiologyevents.subject_id",
          "mimiciv_derived.antibiotic.starttime",
          "mimiciv_derived.antibiotic.antibiotic",
          "mimiciv_hosp.microbiologyevents.chartdate",
          "mimiciv_hosp.microbiologyevents.micro_specimen_id",
          "mimiciv_derived.antibiotic.stoptime"
        ]
      ],
      "antibiotic_time": [
        ["mimiciv_derived.antibiotic.starttime"],
        [
          "mimiciv_hosp.microbiologyevents.charttime",
          "mimiciv_derived.antibiotic.subject_id",
          "mimiciv_hosp.microbiologyevents.subject_id",
          "mimiciv_derived.antibiotic.starttime",
          "mimiciv_derived.antibiotic.antibiotic",
          "mimiciv_hosp.microbiologyevents.chartdate",
          "mimiciv_hosp.microbiologyevents.micro_specimen_id",
          "mimiciv_derived.antibiotic.stoptime"
        ]
      ],
      "suspected_infection": [
        ["mimiciv_hosp.microbiologyevents.spec_type_desc"],
        [
          "mimiciv_hosp.microbiologyevents.charttime",
          "mimiciv_derived.antibiotic.subject_id",
          "mimiciv_hosp.microbiologyevents.subject_id",
          "mimiciv_derived.antibiotic.starttime",
          "mimiciv_derived.antibiotic.antibiotic",
          "mimiciv_hosp.microbiologyevents.chartdate",
          "mimiciv_hosp.microbiologyevents.micro_specimen_id",
          "mimiciv_derived.antibiotic.stoptime"
        ]
      ],
      "suspected_infection_time": [
        [
          "mimiciv_hosp.microbiologyevents.charttime",
          "mimiciv_derived.antibiotic.starttime",
          "mimiciv_hosp.microbiologyevents.spec_type_desc",
          "mimiciv_hosp.microbiologyevents.chartdate"
        ],
        [
          "mimiciv_hosp.microbiologyevents.charttime",
          "mimiciv_derived.antibiotic.subject_id",
          "mimiciv_hosp.microbiologyevents.subject_id",
          "mimiciv_derived.antibiotic.starttime",
          "mimiciv_derived.antibiotic.antibiotic",
          "mimiciv_hosp.microbiologyevents.chartdate",
          "mimiciv_hosp.microbiologyevents.micro_specimen_id",
          "mimiciv_derived.antibiotic.stoptime"
        ]
      ],
      "culture_time": [
        [
          "mimiciv_hosp.microbiologyevents.charttime",
          "mimiciv_hosp.microbiologyevents.chartdate"
        ],
        [
          "mimiciv_hosp.microbiologyevents.charttime",
          "mimiciv_derived.antibiotic.subject_id",
          "mimiciv_hosp.microbiologyevents.subject_id",
          "mimiciv_derived.antibiotic.starttime",
          "mimiciv_derived.antibiotic.antibiotic",
          "mimiciv_hosp.microbiologyevents.chartdate",
          "mimiciv_hosp.microbiologyevents.micro_specimen_id",
          "mimiciv_derived.antibiotic.stoptime"
        ]
      ],
      "specimen": [
        ["mimiciv_hosp.microbiologyevents.spec_type_desc"],
        [
          "mimiciv_hosp.microbiologyevents.charttime",
          "mimiciv_derived.antibiotic.subject_id",
          "mimiciv_hosp.microbiologyevents.subject_id",
          "mimiciv_derived.antibiotic.starttime",
          "mimiciv_derived.antibiotic.antibiotic",
          "mimiciv_hosp.microbiologyevents.chartdate",
          "mimiciv_hosp.microbiologyevents.micro_specimen_id",
          "mimiciv_derived.antibiotic.stoptime"
        ]
      ],
      "positive_culture": [
        [
          "mimiciv_hosp.microbiologyevents.org_itemid",
          "mimiciv_hosp.microbiologyevents.org_name"
        ],
        [
          "mimiciv_hosp.microbiologyevents.charttime",
          "mimiciv_derived.antibiotic.subject_id",
          "mimiciv_hosp.microbiologyevents.subject_id",
          "mimiciv_derived.antibiotic.starttime",
          "mimiciv_derived.antibiotic.antibiotic",
          "mimiciv_hosp.microbiologyevents.chartdate",
          "mimiciv_hosp.microbiologyevents.micro_specimen_id",
          "mimiciv_derived.antibiotic.stoptime"
        ]
      ]
    },
    "table_name": "mimiciv_derived.suspicion_of_infection",
    "sql": "WITH ab_tbl AS ( SELECT abx.subject_id,abx.hadm_id,abx.stay_id,abx.antibiotic,abx.starttime AS antibiotic_time,DATE_TRUNC('DAY',abx.starttime) AS antibiotic_date,abx.stoptime AS antibiotic_stoptime,ROW_NUMBER() OVER ( PARTITION BY subject_id ORDER BY starttime,stoptime,antibiotic ) AS ab_id FROM mimiciv_derived.antibiotic abx ),me AS ( SELECT micro_specimen_id,MAX(subject_id) AS subject_id,MAX(hadm_id) AS hadm_id,CAST(MAX(chartdate) AS DATE) AS chartdate,MAX(charttime) AS charttime,MAX(spec_type_desc) AS spec_type_desc,MAX( CASE WHEN org_name IS NOT NULL AND org_itemid != 90856 AND org_name != '' THEN 1 ELSE 0 END) AS positiveculture FROM mimiciv_hosp.microbiologyevents GROUP BY micro_specimen_id ),me_then_ab AS ( SELECT ab_tbl.subject_id,ab_tbl.hadm_id,ab_tbl.stay_id,ab_tbl.ab_id,me72.micro_specimen_id,COALESCE(me72.charttime,DATETIME(me72.chartdate)) AS last72_charttime,me72.positiveculture AS last72_positiveculture,me72.spec_type_desc AS last72_specimen,ROW_NUMBER() OVER ( PARTITION BY ab_tbl.subject_id,ab_tbl.ab_id ORDER BY me72.chartdate,me72.charttime NULLS LAST ) AS micro_seq FROM ab_tbl LEFT JOIN me me72 ON ab_tbl.subject_id = me72.subject_id AND ( ( me72.charttime IS NOT NULL AND ab_tbl.antibiotic_time > me72.charttime AND ab_tbl.antibiotic_time <= DATETIME_ADD( me72.charttime,INTERVAL '72' HOUR ) ) OR ( me72.charttime IS NULL AND antibiotic_date >= me72.chartdate AND antibiotic_date <= DATE_ADD( me72.chartdate,INTERVAL '3' DAY ) ) ) ),ab_then_me AS ( SELECT ab_tbl.subject_id,ab_tbl.hadm_id,ab_tbl.stay_id,ab_tbl.ab_id,me24.micro_specimen_id,COALESCE(me24.charttime,DATETIME(me24.chartdate)) AS next24_charttime,me24.positiveculture AS next24_positiveculture,me24.spec_type_desc AS next24_specimen,ROW_NUMBER() OVER ( PARTITION BY ab_tbl.subject_id,ab_tbl.ab_id ORDER BY me24.chartdate,me24.charttime NULLS LAST ) AS micro_seq FROM ab_tbl LEFT JOIN me me24 ON ab_tbl.subject_id = me24.subject_id AND ( ( me24.charttime IS NOT NULL AND ab_tbl.antibiotic_time >= DATETIME_SUB(me24.charttime,INTERVAL '24' HOUR) AND ab_tbl.antibiotic_time < me24.charttime ) OR ( me24.charttime IS NULL AND ab_tbl.antibiotic_date >= DATE_SUB(me24.chartdate,INTERVAL '1' DAY) AND ab_tbl.antibiotic_date <= me24.chartdate ) ) ) SELECT ab_tbl.subject_id,ab_tbl.stay_id,ab_tbl.hadm_id,ab_tbl.ab_id,ab_tbl.antibiotic,ab_tbl.antibiotic_time,CASE WHEN last72_specimen IS NULL AND next24_specimen IS NULL THEN 0 ELSE 1 END AS suspected_infection,CASE WHEN last72_specimen IS NULL AND next24_specimen IS NULL THEN NULL ELSE COALESCE(last72_charttime,antibiotic_time) END AS suspected_infection_time,COALESCE(last72_charttime,next24_charttime) AS culture_time,COALESCE(last72_specimen,next24_specimen) AS specimen,COALESCE( last72_positiveculture,next24_positiveculture ) AS positive_culture FROM ab_tbl LEFT JOIN ab_then_me ab2me ON ab_tbl.subject_id = ab2me.subject_id AND ab_tbl.ab_id = ab2me.ab_id AND ab2me.micro_seq = 1 LEFT JOIN me_then_ab me2ab ON ab_tbl.subject_id = me2ab.subject_id AND ab_tbl.ab_id = me2ab.ab_id AND me2ab.micro_seq = 1"
  },
  "mimiciv_derived.crrt": {
    "tables": ["mimiciv_icu.chartevents"],
    "columns": {
      "stay_id": [
        ["mimiciv_icu.chartevents.stay_id"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "charttime": [
        ["mimiciv_icu.chartevents.charttime"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "crrt_mode": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.value"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "access_pressure": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "blood_flow": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "citrate": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "current_goal": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "dialysate_fluid": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.value"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "dialysate_rate": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "effluent_pressure": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "filter_pressure": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "heparin_concentration": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.value"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "heparin_dose": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "hourly_patient_fluid_removal": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "prefilter_replacement_rate": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "postfilter_replacement_rate": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "replacement_fluid": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.value"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "replacement_rate": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "return_pressure": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "ultrafiltrate_output": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.valuenum"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "system_active": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.value"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "clots": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.value"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "clots_increasing": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.value"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "clotted": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.value"],
        [
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ]
    },
    "table_name": "mimiciv_derived.crrt",
    "sql": "WITH crrt_settings AS ( SELECT ce.stay_id,ce.charttime,CASE WHEN ce.itemid = 227290 THEN ce.value END AS crrt_mode,CASE WHEN ce.itemid = 224149 THEN ce.valuenum ELSE NULL END AS accesspressure,CASE WHEN ce.itemid = 224144 THEN ce.valuenum ELSE NULL END AS bloodflow,CASE WHEN ce.itemid = 228004 THEN ce.valuenum ELSE NULL END AS citrate,CASE WHEN ce.itemid = 225183 THEN ce.valuenum ELSE NULL END AS currentgoal,CASE WHEN ce.itemid = 225977 THEN ce.value ELSE NULL END AS dialysatefluid,CASE WHEN ce.itemid = 224154 THEN ce.valuenum ELSE NULL END AS dialysaterate,CASE WHEN ce.itemid = 224151 THEN ce.valuenum ELSE NULL END AS effluentpressure,CASE WHEN ce.itemid = 224150 THEN ce.valuenum ELSE NULL END AS filterpressure,CASE WHEN ce.itemid = 225958 THEN ce.value ELSE NULL END AS heparinconcentration,CASE WHEN ce.itemid = 224145 THEN ce.valuenum ELSE NULL END AS heparindose,CASE WHEN ce.itemid = 224191 THEN ce.valuenum ELSE NULL END AS hourlypatientfluidremoval,CASE WHEN ce.itemid = 228005 THEN ce.valuenum ELSE NULL END AS prefilterreplacementrate,CASE WHEN ce.itemid = 228006 THEN ce.valuenum ELSE NULL END AS postfilterreplacementrate,CASE WHEN ce.itemid = 225976 THEN ce.value ELSE NULL END AS replacementfluid,CASE WHEN ce.itemid = 224153 THEN ce.valuenum ELSE NULL END AS replacementrate,CASE WHEN ce.itemid = 224152 THEN ce.valuenum ELSE NULL END AS returnpressure,CASE WHEN ce.itemid = 226457 THEN ce.valuenum END AS ultrafiltrateoutput,CASE WHEN ce.itemid = 224146 AND ce.value IN ( 'Active','Initiated','Reinitiated','New Filter' ) THEN 1 WHEN ce.itemid = 224146 AND ce.value IN ('Recirculating','Discontinued') THEN 0 ELSE NULL END AS system_active,CASE WHEN ce.itemid = 224146 AND ce.value IN ('Clots Present','Clots Present') THEN 1 WHEN ce.itemid = 224146 AND ce.value IN ('No Clot Present','No Clot Present') THEN 0 ELSE NULL END AS clots,CASE WHEN ce.itemid = 224146 AND ce.value IN ('Clots Increasing','Clot Increasing') THEN 1 ELSE NULL END AS clots_increasing,CASE WHEN ce.itemid = 224146 AND ce.value IN ('Clotted') THEN 1 ELSE NULL END AS clotted FROM mimiciv_icu.chartevents ce WHERE ce.itemid IN ( 227290,224146,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457 ) AND ce.value IS NOT NULL ) SELECT stay_id,charttime,MAX(crrt_mode) AS crrt_mode,MAX(accesspressure) AS access_pressure,MAX(bloodflow) AS blood_flow,MAX(citrate) AS citrate,MAX(currentgoal) AS current_goal,MAX(dialysatefluid) AS dialysate_fluid,MAX(dialysaterate) AS dialysate_rate,MAX(effluentpressure) AS effluent_pressure,MAX(filterpressure) AS filter_pressure,MAX(heparinconcentration) AS heparin_concentration,MAX(heparindose) AS heparin_dose,MAX(hourlypatientfluidremoval) AS hourly_patient_fluid_removal,MAX(prefilterreplacementrate) AS prefilter_replacement_rate,MAX(postfilterreplacementrate) AS postfilter_replacement_rate,MAX(replacementfluid) AS replacement_fluid,MAX(replacementrate) AS replacement_rate,MAX(returnpressure) AS return_pressure,MAX(ultrafiltrateoutput) AS ultrafiltrate_output,MAX(system_active) AS system_active,MAX(clots) AS clots,MAX(clots_increasing) AS clots_increasing,MAX(clotted) AS clotted FROM crrt_settings GROUP BY stay_id,charttime"
  },
  "mimiciv_derived.rrt": {
    "tables": [
      "mimiciv_icu.procedureevents",
      "mimiciv_icu.chartevents",
      "mimiciv_icu.inputevents"
    ],
    "columns": {
      "stay_id": [
        ["mimiciv_icu.chartevents.stay_id"],
        [
          "mimiciv_icu.inputevents.itemid",
          "mimiciv_icu.inputevents.amount",
          "mimiciv_icu.procedureevents.endtime",
          "mimiciv_icu.procedureevents.stay_id",
          "mimiciv_icu.procedureevents.starttime",
          "starttime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.inputevents.starttime",
          "mimiciv_icu.procedureevents.itemid",
          "mimiciv_icu.inputevents.stay_id",
          "mimiciv_icu.procedureevents.value",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.inputevents.endtime",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "charttime": [
        ["mimiciv_icu.chartevents.charttime"],
        [
          "mimiciv_icu.inputevents.itemid",
          "mimiciv_icu.inputevents.amount",
          "mimiciv_icu.procedureevents.endtime",
          "mimiciv_icu.procedureevents.stay_id",
          "mimiciv_icu.procedureevents.starttime",
          "starttime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.inputevents.starttime",
          "mimiciv_icu.procedureevents.itemid",
          "mimiciv_icu.inputevents.stay_id",
          "mimiciv_icu.procedureevents.value",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.inputevents.endtime",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "dialysis_present": [
        ["mimiciv_icu.chartevents.itemid"],
        [
          "mimiciv_icu.inputevents.itemid",
          "mimiciv_icu.inputevents.amount",
          "mimiciv_icu.procedureevents.endtime",
          "mimiciv_icu.procedureevents.stay_id",
          "mimiciv_icu.procedureevents.starttime",
          "starttime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.inputevents.starttime",
          "mimiciv_icu.procedureevents.itemid",
          "mimiciv_icu.inputevents.stay_id",
          "mimiciv_icu.procedureevents.value",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.inputevents.endtime",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "dialysis_active": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.value"],
        [
          "mimiciv_icu.inputevents.itemid",
          "mimiciv_icu.inputevents.amount",
          "mimiciv_icu.procedureevents.endtime",
          "mimiciv_icu.procedureevents.stay_id",
          "mimiciv_icu.procedureevents.starttime",
          "starttime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.inputevents.starttime",
          "mimiciv_icu.procedureevents.itemid",
          "mimiciv_icu.inputevents.stay_id",
          "mimiciv_icu.procedureevents.value",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.inputevents.endtime",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ],
      "dialysis_type": [
        ["mimiciv_icu.chartevents.itemid", "mimiciv_icu.chartevents.value"],
        [
          "mimiciv_icu.inputevents.itemid",
          "mimiciv_icu.inputevents.amount",
          "mimiciv_icu.procedureevents.endtime",
          "mimiciv_icu.procedureevents.stay_id",
          "mimiciv_icu.procedureevents.starttime",
          "starttime",
          "mimiciv_icu.chartevents.stay_id",
          "mimiciv_icu.inputevents.starttime",
          "mimiciv_icu.procedureevents.itemid",
          "mimiciv_icu.inputevents.stay_id",
          "mimiciv_icu.procedureevents.value",
          "mimiciv_icu.chartevents.itemid",
          "mimiciv_icu.inputevents.endtime",
          "mimiciv_icu.chartevents.charttime",
          "mimiciv_icu.chartevents.value"
        ]
      ]
    },
    "table_name": "mimiciv_derived.rrt",
    "sql": "WITH ce AS ( SELECT ce.stay_id,ce.charttime,CASE WHEN ce.itemid IN ( 226118,227357,225725 ) THEN 1 WHEN ce.itemid IN ( 226499,224154,225810,225959,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457 ) THEN 1 WHEN ce.itemid IN ( 224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753 ) THEN 1 ELSE 0 END AS dialysis_present,CASE WHEN ce.itemid = 225965 AND value = 'In use' THEN 1 WHEN ce.itemid IN ( 226499,224154,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224153,226457 ) THEN 1 ELSE 0 END AS dialysis_active,CASE WHEN ce.itemid = 227290 THEN value WHEN ce.itemid IN ( 225810,225806,225807,225810,227639,225959,225951,225952,225961,225953,225963,225965,227638,227640 ) THEN 'Peritoneal' WHEN ce.itemid = 226499 THEN 'IHD' ELSE NULL END AS dialysis_type FROM mimiciv_icu.chartevents ce WHERE ce.itemid IN ( 226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753 ) AND ce.value IS NOT NULL ),mv_ranges AS ( SELECT stay_id,starttime,endtime,1 AS dialysis_present,1 AS dialysis_active,'CRRT' AS dialysis_type FROM mimiciv_icu.inputevents WHERE itemid IN ( 227536,227525 ) AND amount > 0 UNION DISTINCT SELECT stay_id,starttime,endtime,1 AS dialysis_present,CASE WHEN itemid NOT IN (224270,225436) THEN 1 ELSE 0 END AS dialysis_active,CASE WHEN itemid = 225441 THEN 'IHD' WHEN itemid = 225802 THEN 'CRRT' WHEN itemid = 225803 THEN 'CVVHD' WHEN itemid = 225805 THEN 'Peritoneal' WHEN itemid = 225809 THEN 'CVVHDF' WHEN itemid = 225955 THEN 'SCUF' ELSE NULL END AS dialysis_type FROM mimiciv_icu.procedureevents WHERE itemid IN ( 225441,225802,225803,225805,224270,225809,225955,225436 ) AND value IS NOT NULL ),stg0 AS ( SELECT stay_id,charttime,dialysis_present,dialysis_active,dialysis_type FROM ce WHERE dialysis_present = 1 UNION DISTINCT SELECT stay_id,starttime AS charttime,dialysis_present,dialysis_active,dialysis_type FROM mv_ranges ) SELECT stg0.stay_id,charttime,COALESCE(mv.dialysis_present,stg0.dialysis_present) AS dialysis_present,COALESCE(mv.dialysis_active,stg0.dialysis_active) AS dialysis_active,COALESCE(mv.dialysis_type,stg0.dialysis_type) AS dialysis_type FROM stg0 LEFT JOIN mv_ranges mv ON stg0.stay_id = mv.stay_id AND stg0.charttime >= mv.starttime AND stg0.charttime <= mv.endtime"
  },
  "mimiciv_derived.ventilation": {
    "tables": [
      "mimiciv_derived.oxygen_delivery",
      "mimiciv_derived.ventilator_setting"
    ],
    "columns": {
      "stay_id": [
        ["mimiciv_derived.ventilator_setting.stay_id"],
        [
          "mimiciv_derived.oxygen_delivery.o2_delivery_device_1",
          "mimiciv_derived.ventilator_setting.charttime",
          "mimiciv_derived.oxygen_delivery.charttime",
          "mimiciv_derived.ventilator_setting.ventilator_mode",
          "mimiciv_derived.ventilator_setting.ventilator_mode_hamilton",
          "mimiciv_derived.ventilator_setting.stay_id",
          "mimiciv_derived.oxygen_delivery.stay_id"
        ]
      ],
      "starttime": [
        ["mimiciv_derived.ventilator_setting.charttime"],
        [
          "mimiciv_derived.oxygen_delivery.o2_delivery_device_1",
          "mimiciv_derived.ventilator_setting.charttime",
          "mimiciv_derived.oxygen_delivery.charttime",
          "mimiciv_derived.ventilator_setting.ventilator_mode",
          "mimiciv_derived.ventilator_setting.ventilator_mode_hamilton",
          "mimiciv_derived.ventilator_setting.stay_id",
          "mimiciv_derived.oxygen_delivery.stay_id"
        ]
      ],
      "endtime": [
        ["mimiciv_derived.ventilator_setting.charttime"],
        [
          "mimiciv_derived.oxygen_delivery.o2_delivery_device_1",
          "mimiciv_derived.ventilator_setting.charttime",
          "mimiciv_derived.oxygen_delivery.charttime",
          "mimiciv_derived.ventilator_setting.ventilator_mode",
          "mimiciv_derived.ventilator_setting.ventilator_mode_hamilton",
          "mimiciv_derived.ventilator_setting.stay_id",
          "mimiciv_derived.oxygen_delivery.stay_id"
        ]
      ],
      "ventilation_status": [
        [
          "mimiciv_derived.ventilator_setting.ventilator_mode",
          "mimiciv_derived.ventilator_setting.ventilator_mode_hamilton",
          "mimiciv_derived.oxygen_delivery.o2_delivery_device_1"
        ],
        [
          "mimiciv_derived.oxygen_delivery.o2_delivery_device_1",
          "mimiciv_derived.ventilator_setting.charttime",
          "mimiciv_derived.oxygen_delivery.charttime",
          "mimiciv_derived.ventilator_setting.ventilator_mode",
          "mimiciv_derived.ventilator_setting.ventilator_mode_hamilton",
          "mimiciv_derived.ventilator_setting.stay_id",
          "mimiciv_derived.oxygen_delivery.stay_id"
        ]
      ]
    },
    "table_name": "mimiciv_derived.ventilation",
    "sql": "WITH tm AS ( SELECT stay_id,charttime FROM mimiciv_derived.ventilator_setting UNION DISTINCT SELECT stay_id,charttime FROM mimiciv_derived.oxygen_delivery ),vs AS ( SELECT tm.stay_id,tm.charttime,o2_delivery_device_1,COALESCE(ventilator_mode,ventilator_mode_hamilton) AS vent_mode,CASE WHEN o2_delivery_device_1 IN ( 'Tracheostomy tube','Trach mask ' ) THEN 'Tracheostomy' WHEN o2_delivery_device_1 IN ( 'Endotracheal tube' ) OR ventilator_mode IN ( '(S) CMV','APRV','APRV/Biphasic+ApnPress','APRV/Biphasic+ApnVol','APV (cmv)','Ambient','Apnea Ventilation','CMV','CMV/ASSIST','CMV/ASSIST/AutoFlow','CMV/AutoFlow','CPAP/PPS','CPAP/PSV','CPAP/PSV+Apn TCPL','CPAP/PSV+ApnPres','CPAP/PSV+ApnVol','MMV','MMV/AutoFlow','MMV/PSV','MMV/PSV/AutoFlow','P-CMV','PCV+','PCV+/PSV','PCV+Assist','PRES/AC','PRVC/AC','PRVC/SIMV','PSV/SBT','SIMV','SIMV/AutoFlow','SIMV/PRES','SIMV/PSV','SIMV/PSV/AutoFlow','SIMV/VOL','SYNCHRON MASTER','SYNCHRON SLAVE','VOL/AC' ) OR ventilator_mode_hamilton IN ( 'APRV','APV (cmv)','Ambient','(S) CMV','P-CMV','SIMV','APV (simv)','P-SIMV','VS','ASV' ) THEN 'InvasiveVent' WHEN o2_delivery_device_1 IN ( 'Bipap mask ','CPAP mask ' ) OR ventilator_mode_hamilton IN ( 'DuoPaP','NIV','NIV-ST' ) THEN 'NonInvasiveVent' WHEN o2_delivery_device_1 IN ( 'High flow nasal cannula' ) THEN 'HFNC' WHEN o2_delivery_device_1 IN ( 'Non-rebreather','Face tent','Aerosol-cool','Venti mask ','Medium conc mask ','Ultrasonic neb','Vapomist','Oxymizer','High flow neb','Nasal cannula' ) THEN 'SupplementalOxygen' WHEN o2_delivery_device_1 IN ( 'None' ) THEN 'None' ELSE NULL END AS ventilation_status FROM tm LEFT JOIN mimiciv_derived.ventilator_setting vs ON tm.stay_id = vs.stay_id AND tm.charttime = vs.charttime LEFT JOIN mimiciv_derived.oxygen_delivery od ON tm.stay_id = od.stay_id AND tm.charttime = od.charttime ),vd0 AS ( SELECT stay_id,charttime,LAG( charttime,1 ) OVER ( PARTITION BY stay_id,ventilation_status ORDER BY charttime ) AS charttime_lag,LEAD(charttime,1) OVER w AS charttime_lead,ventilation_status,LAG(ventilation_status,1) OVER w AS ventilation_status_lag FROM vs WHERE ventilation_status IS NOT NULL WINDOW w AS (PARTITION BY stay_id ORDER BY charttime) ),vd1 AS ( SELECT stay_id,charttime,charttime_lag,charttime_lead,ventilation_status,DATETIME_DIFF(charttime,charttime_lag,'MINUTE') / 60 AS ventduration,CASE WHEN ventilation_status_lag IS NULL THEN 1 WHEN DATETIME_DIFF(charttime,charttime_lag,'HOUR') >= 14 THEN 1 WHEN ventilation_status_lag != ventilation_status THEN 1 ELSE 0 END AS new_ventilation_event FROM vd0 ),vd2 AS ( SELECT vd1.stay_id,vd1.charttime,vd1.charttime_lead,vd1.ventilation_status,ventduration,new_ventilation_event,SUM(new_ventilation_event) OVER ( PARTITION BY stay_id ORDER BY charttime ) AS vent_seq FROM vd1 ) SELECT stay_id,MIN(charttime) AS starttime,MAX( CASE WHEN charttime_lead IS NULL OR DATETIME_DIFF(charttime_lead,charttime,'HOUR') >= 14 THEN charttime ELSE charttime_lead END ) AS endtime,MAX(ventilation_status) AS ventilation_status FROM vd2 GROUP BY stay_id,vent_seq HAVING MIN(charttime) != MAX(charttime)"
  }
}
