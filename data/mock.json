{
    "model.mimic.code_status": {
        "sql": "-- This query extracts:\n--    i) a patient's first code status\n--    ii) a patient's last code status\n--    iii) the time of the first entry of DNR or CMO\n\n\n\nwith t1 as\n(\n  select icustay_id, charttime, value\n  -- use row number to identify first and last code status\n  , ROW_NUMBER() over (PARTITION BY icustay_id order by charttime) as rnfirst\n  , ROW_NUMBER() over (PARTITION BY icustay_id order by charttime desc) as rnlast\n\n  -- coalesce the values\n  , case\n      when value in ('Full Code','Full code') then 1\n    else 0 end as fullcode\n  , case\n      when value in ('Comfort Measures','Comfort measures only') then 1\n    else 0 end as cmo\n  , case\n      when value = 'CPR Not Indicate' then 1\n    else 0 end as dncpr -- only in CareVue, i.e. only possible for ~60-70% of patients\n  , case\n      when value in ('Do Not Intubate','DNI (do not intubate)','DNR / DNI') then 1\n    else 0 end as dni\n  , case\n      when value in ('Do Not Resuscita','DNR (do not resuscitate)','DNR / DNI') then 1\n    else 0 end as dnr\n  FROM chartevents\n  where itemid in (128, 223758)\n  and value is not null\n  and value != 'Other/Remarks'\n  -- exclude rows marked as error\n  AND (error IS NULL OR error = 0)\n)\nselect ie.subject_id, ie.hadm_id, ie.icustay_id\n  -- first recorded code status\n  , max(case when rnfirst = 1 then t1.fullcode else null end) as fullcode_first\n  , max(case when rnfirst = 1 then t1.cmo else null end) as cmo_first\n  , max(case when rnfirst = 1 then t1.dnr else null end) as dnr_first\n  , max(case when rnfirst = 1 then t1.dni else null end) as dni_first\n  , max(case when rnfirst = 1 then t1.dncpr else null end) as dncpr_first\n\n  -- last recorded code status\n  , max(case when  rnlast = 1 then t1.fullcode else null end) as fullcode_last\n  , max(case when  rnlast = 1 then t1.cmo else null end) as cmo_last\n  , max(case when  rnlast = 1 then t1.dnr else null end) as dnr_last\n  , max(case when  rnlast = 1 then t1.dni else null end) as dni_last\n  , max(case when  rnlast = 1 then t1.dncpr else null end) as DNCPR_last\n\n  -- were they *at any time* given a certain code status\n  , max(t1.fullcode) as fullcode\n  , max(t1.cmo) as cmo\n  , max(t1.dnr) as dnr\n  , max(t1.dni) as dni\n  , max(t1.dncpr) as dncpr\n\n  -- time until their first DNR\n  , min(case when t1.dnr = 1 then t1.charttime else null end)\n        as dnr_first_charttime\n  , min(case when t1.dni = 1 then t1.charttime else null end)\n        as dni_first_charttime\n  , min(case when t1.dncpr = 1 then t1.charttime else null end)\n        as dncpr_first_charttime\n\n  -- first code status of CMO\n  , min(case when t1.cmo = 1 then t1.charttime else null end)\n        as timecmo_chart\n\nFROM icustays ie\nleft join t1\n  on ie.icustay_id = t1.icustay_id\ngroup by ie.subject_id, ie.hadm_id, ie.icustay_id, ie.intime",
        "tables": [
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.icustays"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "hadm_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "icustay_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "fullcode_first": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "cmo_first": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "dnr_first": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "dni_first": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "dncpr_first": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "fullcode_last": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "cmo_last": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "dnr_last": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "dni_last": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "dncpr_last": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "fullcode": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "cmo": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "dnr": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "dni": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "dncpr": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "dnr_first_charttime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "dni_first_charttime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "dncpr_first_charttime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "timecmo_chart": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.code_status",
        "plan": {
            "Node Type": "Aggregate",
            "Strategy": "Sorted",
            "Partial Mode": "Simple",
            "Parallel Aware": false,
            "Output": [
                "ie.subject_id",
                "ie.hadm_id",
                "ie.icustay_id",
                "max(CASE WHEN (t1.rnfirst = 1) THEN t1.fullcode ELSE NULL::integer END)",
                "max(CASE WHEN (t1.rnfirst = 1) THEN t1.cmo ELSE NULL::integer END)",
                "max(CASE WHEN (t1.rnfirst = 1) THEN t1.dnr ELSE NULL::integer END)",
                "max(CASE WHEN (t1.rnfirst = 1) THEN t1.dni ELSE NULL::integer END)",
                "max(CASE WHEN (t1.rnfirst = 1) THEN t1.dncpr ELSE NULL::integer END)",
                "max(CASE WHEN (t1.rnlast = 1) THEN t1.fullcode ELSE NULL::integer END)",
                "max(CASE WHEN (t1.rnlast = 1) THEN t1.cmo ELSE NULL::integer END)",
                "max(CASE WHEN (t1.rnlast = 1) THEN t1.dnr ELSE NULL::integer END)",
                "max(CASE WHEN (t1.rnlast = 1) THEN t1.dni ELSE NULL::integer END)",
                "max(CASE WHEN (t1.rnlast = 1) THEN t1.dncpr ELSE NULL::integer END)",
                "max(t1.fullcode)",
                "max(t1.cmo)",
                "max(t1.dnr)",
                "max(t1.dni)",
                "max(t1.dncpr)",
                "min(CASE WHEN (t1.dnr = 1) THEN t1.charttime ELSE NULL::timestamp without time zone END)",
                "min(CASE WHEN (t1.dni = 1) THEN t1.charttime ELSE NULL::timestamp without time zone END)",
                "min(CASE WHEN (t1.dncpr = 1) THEN t1.charttime ELSE NULL::timestamp without time zone END)",
                "min(CASE WHEN (t1.cmo = 1) THEN t1.charttime ELSE NULL::timestamp without time zone END)",
                "ie.intime"
            ],
            "Group Key": [
                "ie.subject_id",
                "ie.hadm_id",
                "ie.icustay_id",
                "ie.intime"
            ],
            "Plans": [
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE t1",
                    "Parallel Aware": false,
                    "Output": [
                        "chartevents_18.icustay_id",
                        "chartevents_18.charttime",
                        "chartevents_18.value",
                        "(row_number() OVER (?))",
                        "row_number() OVER (?)",
                        "CASE WHEN ((chartevents_18.value)::text = ANY ('{\"Full Code\",\"Full code\"}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN ((chartevents_18.value)::text = ANY ('{\"Comfort Measures\",\"Comfort measures only\"}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN ((chartevents_18.value)::text = 'CPR Not Indicate'::text) THEN 1 ELSE 0 END",
                        "CASE WHEN ((chartevents_18.value)::text = ANY ('{\"Do Not Intubate\",\"DNI (do not intubate)\",\"DNR / DNI\"}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN ((chartevents_18.value)::text = ANY ('{\"Do Not Resuscita\",\"DNR (do not resuscitate)\",\"DNR / DNI\"}'::text[])) THEN 1 ELSE 0 END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "chartevents_18.icustay_id",
                                "chartevents_18.charttime",
                                "chartevents_18.value",
                                "(row_number() OVER (?))"
                            ],
                            "Sort Key": [
                                "chartevents_18.icustay_id",
                                "chartevents_18.charttime DESC"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "WindowAgg",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "chartevents_18.icustay_id",
                                        "chartevents_18.charttime",
                                        "chartevents_18.value",
                                        "row_number() OVER (?)"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "chartevents_18.icustay_id",
                                                "chartevents_18.charttime",
                                                "chartevents_18.value"
                                            ],
                                            "Sort Key": [
                                                "chartevents_18.icustay_id",
                                                "chartevents_18.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Append",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Seq Scan",
                                                            "Parent Relationship": "Member",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "chartevents_18",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "chartevents_18",
                                                            "Output": [
                                                                "chartevents_18.icustay_id",
                                                                "chartevents_18.charttime",
                                                                "chartevents_18.value"
                                                            ],
                                                            "Filter": "((chartevents_18.value IS NOT NULL) AND (chartevents_18.itemid = ANY ('{128,223758}'::integer[])) AND ((chartevents_18.value)::text <> 'Other/Remarks'::text) AND ((chartevents_18.error IS NULL) OR (chartevents_18.error = 0)))"
                                                        },
                                                        {
                                                            "Node Type": "Bitmap Heap Scan",
                                                            "Parent Relationship": "Member",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "chartevents_172",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "chartevents_172",
                                                            "Output": [
                                                                "chartevents_172.icustay_id",
                                                                "chartevents_172.charttime",
                                                                "chartevents_172.value"
                                                            ],
                                                            "Recheck Cond": "(chartevents_172.itemid = ANY ('{128,223758}'::integer[]))",
                                                            "Filter": "((chartevents_172.value IS NOT NULL) AND ((chartevents_172.value)::text <> 'Other/Remarks'::text) AND ((chartevents_172.error IS NULL) OR (chartevents_172.error = 0)))",
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Bitmap Index Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Index Name": "chartevents_172_idx01",
                                                                    "Index Cond": "(chartevents_172.itemid = ANY ('{128,223758}'::integer[]))"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Sort",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id",
                        "ie.intime",
                        "t1.rnfirst",
                        "t1.fullcode",
                        "t1.cmo",
                        "t1.dnr",
                        "t1.dni",
                        "t1.dncpr",
                        "t1.rnlast",
                        "t1.charttime"
                    ],
                    "Sort Key": [
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id",
                        "ie.intime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Right",
                            "Output": [
                                "ie.subject_id",
                                "ie.hadm_id",
                                "ie.icustay_id",
                                "ie.intime",
                                "t1.rnfirst",
                                "t1.fullcode",
                                "t1.cmo",
                                "t1.dnr",
                                "t1.dni",
                                "t1.dncpr",
                                "t1.rnlast",
                                "t1.charttime"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "(t1.icustay_id = ie.icustay_id)",
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "t1",
                                    "Alias": "t1",
                                    "Output": [
                                        "t1.icustay_id",
                                        "t1.charttime",
                                        "t1.value",
                                        "t1.rnfirst",
                                        "t1.rnlast",
                                        "t1.fullcode",
                                        "t1.cmo",
                                        "t1.dncpr",
                                        "t1.dni",
                                        "t1.dnr"
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "ie.subject_id",
                                        "ie.hadm_id",
                                        "ie.icustay_id",
                                        "ie.intime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "icustays",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ie",
                                            "Output": [
                                                "ie.subject_id",
                                                "ie.hadm_id",
                                                "ie.icustay_id",
                                                "ie.intime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.echo_data": {
        "sql": "-- This code extracts structured data from echocardiographies\n-- You can join it to the text notes using ROW_ID\n-- Just note that ROW_ID will differ across versions of MIMIC-III.\n\n\nselect ROW_ID\n  , subject_id, hadm_id\n  , chartdate\n  -- charttime is always null for echoes..\n  -- however, the time is available in the echo text, e.g.:\n  -- , substring(ne.text, 'Date/Time: [\\[\\]0-9*-]+ at ([0-9:]+)') as TIMESTAMP\n  -- we can therefore impute it and re-create charttime\n  , PARSE_DATETIME\n  (\n      '%Y-%m-%d%H:%M:%S',\n      FORMAT_DATE('%Y-%m-%d', chartdate)\n      || REGEXP_EXTRACT(ne.text, 'Date/Time: .+? at ([0-9]+:[0-9]{2})')\n      || ':00'\n   ) AS charttime\n\n  -- explanation of below substring:\n  --  'Indication: ' - matched verbatim\n  --  (.*?) - match any character\n  --  \\n - the end of the line\n  -- substring only returns the item in ()s\n  -- note: the '?' makes it non-greedy. if you exclude it, it matches until it reaches the *last* \\n\n\n  , REGEXP_EXTRACT(ne.text, 'Indication: (.*?)\\n') as Indication\n\n  -- sometimes numeric values contain de-id text, e.g. [** Numeric Identifier **]\n  -- this removes that text\n  , cast(REGEXP_EXTRACT(ne.text, 'Height: \\\\x28in\\\\x29 ([0-9]+)') as numeric) as Height\n  , cast(REGEXP_EXTRACT(ne.text, 'Weight \\\\x28lb\\\\x29: ([0-9]+)\\n') as numeric) as Weight\n  , cast(REGEXP_EXTRACT(ne.text, 'BSA \\\\x28m2\\\\x29: ([0-9]+) m2\\n') as numeric) as BSA -- ends in 'm2'\n  , REGEXP_EXTRACT(ne.text, 'BP \\\\x28mm Hg\\\\x29: (.+)\\n') as BP -- Sys/Dias\n  , cast(REGEXP_EXTRACT(ne.text, 'BP \\\\x28mm Hg\\\\x29: ([0-9]+)/[0-9]+?\\n') as numeric) as BPSys -- first part of fraction\n  , cast(REGEXP_EXTRACT(ne.text, 'BP \\\\x28mm Hg\\\\x29: [0-9]+/([0-9]+?)\\n') as numeric) as BPDias -- second part of fraction\n  , cast(REGEXP_EXTRACT(ne.text, 'HR \\\\x28bpm\\\\x29: ([0-9]+?)\\n') as numeric) as HR\n\n  , REGEXP_EXTRACT(ne.text, 'Status: (.*?)\\n') as Status\n  , REGEXP_EXTRACT(ne.text, 'Test: (.*?)\\n') as Test\n  , REGEXP_EXTRACT(ne.text, 'Doppler: (.*?)\\n') as Doppler\n  , REGEXP_EXTRACT(ne.text, 'Contrast: (.*?)\\n') as Contrast\n  , REGEXP_EXTRACT(ne.text, 'Technical Quality: (.*?)\\n') as TechnicalQuality\nFROM noteevents ne\nwhere category = 'Echo'",
        "tables": [
            "mimiciii_clinical.noteevents"
        ],
        "columns": {
            "row_id": [
                "mimiciii_clinical.noteevents.category",
                "mimiciii_clinical.noteevents.row_id"
            ],
            "subject_id": [
                "mimiciii_clinical.noteevents.category",
                "mimiciii_clinical.noteevents.subject_id"
            ],
            "hadm_id": [
                "mimiciii_clinical.noteevents.category",
                "mimiciii_clinical.noteevents.hadm_id"
            ],
            "chartdate": [
                "mimiciii_clinical.noteevents.category",
                "mimiciii_clinical.noteevents.chartdate"
            ],
            "charttime": [
                "mimiciii_clinical.noteevents.category",
                "mimiciii_clinical.noteevents.chartdate",
                "mimiciii_clinical.noteevents.text"
            ],
            "indication": [
                "mimiciii_clinical.noteevents.category",
                "mimiciii_clinical.noteevents.text"
            ],
            "height": [
                "mimiciii_clinical.noteevents.category",
                "mimiciii_clinical.noteevents.text"
            ],
            "weight": [
                "mimiciii_clinical.noteevents.category",
                "mimiciii_clinical.noteevents.text"
            ],
            "bsa": [
                "mimiciii_clinical.noteevents.category",
                "mimiciii_clinical.noteevents.text"
            ],
            "bp": [
                "mimiciii_clinical.noteevents.category",
                "mimiciii_clinical.noteevents.text"
            ],
            "bpsys": [
                "mimiciii_clinical.noteevents.category",
                "mimiciii_clinical.noteevents.text"
            ],
            "bpdias": [
                "mimiciii_clinical.noteevents.category",
                "mimiciii_clinical.noteevents.text"
            ],
            "hr": [
                "mimiciii_clinical.noteevents.category",
                "mimiciii_clinical.noteevents.text"
            ],
            "status": [
                "mimiciii_clinical.noteevents.category",
                "mimiciii_clinical.noteevents.text"
            ],
            "test": [
                "mimiciii_clinical.noteevents.category",
                "mimiciii_clinical.noteevents.text"
            ],
            "doppler": [
                "mimiciii_clinical.noteevents.category",
                "mimiciii_clinical.noteevents.text"
            ],
            "contrast": [
                "mimiciii_clinical.noteevents.category",
                "mimiciii_clinical.noteevents.text"
            ],
            "technicalquality": [
                "mimiciii_clinical.noteevents.category",
                "mimiciii_clinical.noteevents.text"
            ]
        },
        "table_name": "mimiciii_clinical.echo_data",
        "plan": {
            "Node Type": "Bitmap Heap Scan",
            "Parallel Aware": false,
            "Relation Name": "noteevents",
            "Schema": "mimiciii_clinical",
            "Alias": "ne",
            "Output": [
                "row_id",
                "subject_id",
                "hadm_id",
                "chartdate",
                "parse_datetime('%Y-%m-%d%H:%M:%S'::character varying, (((format_date('%Y-%m-%d'::character varying, chartdate) || regexp_extract(text, 'Date/Time: .+? at ([0-9]+:[0-9]{2})'::text)) || ':00'::text))::character varying)",
                "regexp_extract(text, 'Indication: (.*?)\\n'::text)",
                "(regexp_extract(text, 'Height: \\\\x28in\\\\x29 ([0-9]+)'::text))::numeric",
                "(regexp_extract(text, 'Weight \\\\x28lb\\\\x29: ([0-9]+)\\n'::text))::numeric",
                "(regexp_extract(text, 'BSA \\\\x28m2\\\\x29: ([0-9]+) m2\\n'::text))::numeric",
                "regexp_extract(text, 'BP \\\\x28mm Hg\\\\x29: (.+)\\n'::text)",
                "(regexp_extract(text, 'BP \\\\x28mm Hg\\\\x29: ([0-9]+)/[0-9]+?\\n'::text))::numeric",
                "(regexp_extract(text, 'BP \\\\x28mm Hg\\\\x29: [0-9]+/([0-9]+?)\\n'::text))::numeric",
                "(regexp_extract(text, 'HR \\\\x28bpm\\\\x29: ([0-9]+?)\\n'::text))::numeric",
                "regexp_extract(text, 'Status: (.*?)\\n'::text)",
                "regexp_extract(text, 'Test: (.*?)\\n'::text)",
                "regexp_extract(text, 'Doppler: (.*?)\\n'::text)",
                "regexp_extract(text, 'Contrast: (.*?)\\n'::text)",
                "regexp_extract(text, 'Technical Quality: (.*?)\\n'::text)"
            ],
            "Recheck Cond": "((ne.category)::text = 'Echo'::text)",
            "Plans": [
                {
                    "Node Type": "Bitmap Index Scan",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Index Name": "noteevents_idx05",
                    "Index Cond": "((ne.category)::text = 'Echo'::text)"
                }
            ]
        }
    },
    "model.mimic.elixhauser_ahrq_v37": {
        "sql": "-- This code uses the latest version of Elixhauser provided by AHRQ\n \n\nwith eliflg as (\n    select\n        hadm_id,\n        seq_num,\n        icd9_code -- note that these codes will seem incomplete at first\n        -- for example, CHF is missing a lot of codes referenced in the literature (402.11, 402.91, etc)\n        -- these codes are captured by hypertension flags instead\n        -- later there are some complicated rules which confirm/reject those codes as chf\n,\n        CASE\n            when icd9_code = '39891' then 1\n            when icd9_code between '4280'\n            and '4289' then 1\n        end as chf\n        /* Congestive heart failure */\n        -- cardiac arrhythmias is removed in up to date versions\n,\n        case\n            when icd9_code = '42610' then 1\n            when icd9_code = '42611' then 1\n            when icd9_code = '42613' then 1\n            when icd9_code between '4262'\n            and '42653' then 1\n            when icd9_code between '4266'\n            and '42689' then 1\n            when icd9_code = '4270' then 1\n            when icd9_code = '4272' then 1\n            when icd9_code = '42731' then 1\n            when icd9_code = '42760' then 1\n            when icd9_code = '4279' then 1\n            when icd9_code = '7850' then 1\n            when icd9_code between 'V450'\n            and 'V4509' then 1\n            when icd9_code between 'V533'\n            and 'V5339' then 1\n        end as arythm\n        /* Cardiac arrhythmias */\n,\n        CASE\n            when icd9_code between '09320'\n            and '09324' then 1\n            when icd9_code between '3940'\n            and '3971' then 1\n            when icd9_code = '3979' then 1\n            when icd9_code between '4240'\n            and '42499' then 1\n            when icd9_code between '7463'\n            and '7466' then 1\n            when icd9_code = 'V422' then 1\n            when icd9_code = 'V433' then 1\n        end as valve\n        /* Valvular disease */\n,\n        CASE\n            when icd9_code between '41511'\n            and '41519' then 1\n            when icd9_code between '4160'\n            and '4169' then 1\n            when icd9_code = '4179' then 1\n        end as pulmcirc\n        /* Pulmonary circulation disorder */\n,\n        CASE\n            when icd9_code between '4400'\n            and '4409' then 1\n            when icd9_code between '44100'\n            and '4419' then 1\n            when icd9_code between '4420'\n            and '4429' then 1\n            when icd9_code between '4431'\n            and '4439' then 1\n            when icd9_code between '44421'\n            and '44422' then 1\n            when icd9_code = '4471' then 1\n            when icd9_code = '449' then 1\n            when icd9_code = '5571' then 1\n            when icd9_code = '5579' then 1\n            when icd9_code = 'V434' then 1\n        end as perivasc\n        /* Peripheral vascular disorder */\n,\n        CASE\n            when icd9_code = '4011' then 1\n            when icd9_code = '4019' then 1\n            when icd9_code between '64200'\n            and '64204' then 1\n        end as htn\n        /* Hypertension, uncomplicated */\n,\n        CASE\n            when icd9_code = '4010' then 1\n            when icd9_code = '4372' then 1\n        end as htncx\n        /* Hypertension, complicated */\n        /******************************************************************/\n        /* The following are special, temporary formats used in the       */\n        /* creation of the hypertension complicated comorbidity when      */\n        /* overlapping with congestive heart failure or renal failure     */\n        /* occurs. These temporary formats are referenced in the program  */\n        /* called comoanaly2009.txt.                                      */\n        /******************************************************************/\n,\n        CASE\n            when icd9_code between '64220'\n            and '64224' then 1\n        end as htnpreg\n        /* Pre-existing hypertension complicating pregnancy */\n,\n        CASE\n            when icd9_code = '40200' then 1\n            when icd9_code = '40210' then 1\n            when icd9_code = '40290' then 1\n            when icd9_code = '40509' then 1\n            when icd9_code = '40519' then 1\n            when icd9_code = '40599' then 1\n        end as htnwochf\n        /* Hypertensive heart disease without heart failure */\n,\n        CASE\n            when icd9_code = '40201' then 1\n            when icd9_code = '40211' then 1\n            when icd9_code = '40291' then 1\n        end as htnwchf\n        /* Hypertensive heart disease with heart failure */\n,\n        CASE\n            when icd9_code = '40300' then 1\n            when icd9_code = '40310' then 1\n            when icd9_code = '40390' then 1\n            when icd9_code = '40501' then 1\n            when icd9_code = '40511' then 1\n            when icd9_code = '40591' then 1\n            when icd9_code between '64210'\n            and '64214' then 1\n        end as hrenworf\n        /* Hypertensive renal disease without renal failure */\n,\n        CASE\n            when icd9_code = '40301' then 1\n            when icd9_code = '40311' then 1\n            when icd9_code = '40391' then 1\n        end as hrenwrf\n        /* Hypertensive renal disease with renal failure */\n,\n        CASE\n            when icd9_code = '40400' then 1\n            when icd9_code = '40410' then 1\n            when icd9_code = '40490' then 1\n        end as hhrwohrf\n        /* Hypertensive heart and renal disease without heart or renal failure */\n,\n        CASE\n            when icd9_code = '40401' then 1\n            when icd9_code = '40411' then 1\n            when icd9_code = '40491' then 1\n        end as hhrwchf\n        /* Hypertensive heart and renal disease with heart failure */\n,\n        CASE\n            when icd9_code = '40402' then 1\n            when icd9_code = '40412' then 1\n            when icd9_code = '40492' then 1\n        end as hhrwrf\n        /* Hypertensive heart and renal disease with renal failure */\n,\n        CASE\n            when icd9_code = '40403' then 1\n            when icd9_code = '40413' then 1\n            when icd9_code = '40493' then 1\n        end as hhrwhrf\n        /* Hypertensive heart and renal disease with heart and renal failure */\n,\n        CASE\n            when icd9_code between '64270'\n            and '64274' then 1\n            when icd9_code between '64290'\n            and '64294' then 1\n        end as ohtnpreg\n        /* Other hypertension in pregnancy */\n        /******************** End Temporary Formats ***********************/\n,\n        CASE\n            when icd9_code between '3420'\n            and '3449' then 1\n            when icd9_code between '43820'\n            and '43853' then 1\n            when icd9_code = '78072' then 1\n        end as para\n        /* Paralysis */\n,\n        CASE\n            when icd9_code between '3300'\n            and '3319' then 1\n            when icd9_code = '3320' then 1\n            when icd9_code = '3334' then 1\n            when icd9_code = '3335' then 1\n            when icd9_code = '3337' then 1\n            when icd9_code in ('33371', '33372', '33379', '33385', '33394') then 1\n            when icd9_code between '3340'\n            and '3359' then 1\n            when icd9_code = '3380' then 1\n            when icd9_code = '340' then 1\n            when icd9_code between '3411'\n            and '3419' then 1\n            when icd9_code between '34500'\n            and '34511' then 1\n            when icd9_code between '3452'\n            and '3453' then 1\n            when icd9_code between '34540'\n            and '34591' then 1\n            when icd9_code between '34700'\n            and '34701' then 1\n            when icd9_code between '34710'\n            and '34711' then 1\n            when icd9_code = '3483' then 1 -- discontinued icd-9\n            when icd9_code between '64940'\n            and '64944' then 1\n            when icd9_code = '7687' then 1\n            when icd9_code between '76870'\n            and '76873' then 1\n            when icd9_code = '7803' then 1\n            when icd9_code = '78031' then 1\n            when icd9_code = '78032' then 1\n            when icd9_code = '78033' then 1\n            when icd9_code = '78039' then 1\n            when icd9_code = '78097' then 1\n            when icd9_code = '7843' then 1\n        end as neuro\n        /* Other neurological */\n,\n        CASE\n            when icd9_code between '490'\n            and '4928' then 1\n            when icd9_code between '49300'\n            and '49392' then 1\n            when icd9_code between '494'\n            and '4941' then 1\n            when icd9_code between '4950'\n            and '505' then 1\n            when icd9_code = '5064' then 1\n        end as chrnlung\n        /* Chronic pulmonary disease */\n,\n        CASE\n            when icd9_code between '25000'\n            and '25033' then 1\n            when icd9_code between '64800'\n            and '64804' then 1\n            when icd9_code between '24900'\n            and '24931' then 1\n        end as dm\n        /* Diabetes w/o chronic complications*/\n,\n        CASE\n            when icd9_code between '25040'\n            and '25093' then 1\n            when icd9_code = '7751' then 1\n            when icd9_code between '24940'\n            and '24991' then 1\n        end as dmcx\n        /* Diabetes w/ chronic complications */\n,\n        CASE\n            when icd9_code between '243'\n            and '2442' then 1\n            when icd9_code = '2448' then 1\n            when icd9_code = '2449' then 1\n        end as hypothy\n        /* Hypothyroidism */\n,\n        CASE\n            when icd9_code = '585' then 1 -- discontinued code\n            when icd9_code = '5853' then 1\n            when icd9_code = '5854' then 1\n            when icd9_code = '5855' then 1\n            when icd9_code = '5856' then 1\n            when icd9_code = '5859' then 1\n            when icd9_code = '586' then 1\n            when icd9_code = 'V420' then 1\n            when icd9_code = 'V451' then 1\n            when icd9_code between 'V560'\n            and 'V5632' then 1\n            when icd9_code = 'V568' then 1\n            when icd9_code between 'V4511'\n            and 'V4512' then 1\n        end as renlfail\n        /* Renal failure */\n,\n        CASE\n            when icd9_code = '07022' then 1\n            when icd9_code = '07023' then 1\n            when icd9_code = '07032' then 1\n            when icd9_code = '07033' then 1\n            when icd9_code = '07044' then 1\n            when icd9_code = '07054' then 1\n            when icd9_code = '4560' then 1\n            when icd9_code = '4561' then 1\n            when icd9_code = '45620' then 1\n            when icd9_code = '45621' then 1\n            when icd9_code = '5710' then 1\n            when icd9_code = '5712' then 1\n            when icd9_code = '5713' then 1\n            when icd9_code between '57140'\n            and '57149' then 1\n            when icd9_code = '5715' then 1\n            when icd9_code = '5716' then 1\n            when icd9_code = '5718' then 1\n            when icd9_code = '5719' then 1\n            when icd9_code = '5723' then 1\n            when icd9_code = '5728' then 1\n            when icd9_code = '5735' then 1\n            when icd9_code = 'V427' then 1\n        end as liver\n        /* Liver disease */\n,\n        CASE\n            when icd9_code = '53141' then 1\n            when icd9_code = '53151' then 1\n            when icd9_code = '53161' then 1\n            when icd9_code = '53170' then 1\n            when icd9_code = '53171' then 1\n            when icd9_code = '53191' then 1\n            when icd9_code = '53241' then 1\n            when icd9_code = '53251' then 1\n            when icd9_code = '53261' then 1\n            when icd9_code = '53270' then 1\n            when icd9_code = '53271' then 1\n            when icd9_code = '53291' then 1\n            when icd9_code = '53341' then 1\n            when icd9_code = '53351' then 1\n            when icd9_code = '53361' then 1\n            when icd9_code = '53370' then 1\n            when icd9_code = '53371' then 1\n            when icd9_code = '53391' then 1\n            when icd9_code = '53441' then 1\n            when icd9_code = '53451' then 1\n            when icd9_code = '53461' then 1\n            when icd9_code = '53470' then 1\n            when icd9_code = '53471' then 1\n            when icd9_code = '53491' then 1\n        end as ulcer\n        /* Chronic Peptic ulcer disease (includes bleeding only if obstruction is also present) */\n,\n        CASE\n            when icd9_code between '042'\n            and '0449' then 1\n        end as aids\n        /* HIV and AIDS */\n,\n        CASE\n            when icd9_code between '20000'\n            and '20238' then 1\n            when icd9_code between '20250'\n            and '20301' then 1\n            when icd9_code = '2386' then 1\n            when icd9_code = '2733' then 1\n            when icd9_code between '20302'\n            and '20382' then 1\n        end as lymph\n        /* Lymphoma */\n,\n        CASE\n            when icd9_code between '1960'\n            and '1991' then 1\n            when icd9_code between '20970'\n            and '20975' then 1\n            when icd9_code = '20979' then 1\n            when icd9_code = '78951' then 1\n        end as mets\n        /* Metastatic cancer */\n,\n        CASE\n            when icd9_code between '1400'\n            and '1729' then 1\n            when icd9_code between '1740'\n            and '1759' then 1\n            when icd9_code between '179'\n            and '1958' then 1\n            when icd9_code between '20900'\n            and '20924' then 1\n            when icd9_code between '20925'\n            and '2093' then 1\n            when icd9_code between '20930'\n            and '20936' then 1\n            when icd9_code between '25801'\n            and '25803' then 1\n        end as tumor\n        /* Solid tumor without metastasis */\n,\n        CASE\n            when icd9_code = '7010' then 1\n            when icd9_code between '7100'\n            and '7109' then 1\n            when icd9_code between '7140'\n            and '7149' then 1\n            when icd9_code between '7200'\n            and '7209' then 1\n            when icd9_code = '725' then 1\n        end as arth\n        /* Rheumatoid arthritis/collagen vascular diseases */\n,\n        CASE\n            when icd9_code between '2860'\n            and '2869' then 1\n            when icd9_code = '2871' then 1\n            when icd9_code between '2873'\n            and '2875' then 1\n            when icd9_code between '64930'\n            and '64934' then 1\n            when icd9_code = '28984' then 1\n        end as coag\n        /* Coagulation deficiency */\n,\n        CASE\n            when icd9_code = '2780' then 1\n            when icd9_code = '27800' then 1\n            when icd9_code = '27801' then 1\n            when icd9_code = '27803' then 1\n            when icd9_code between '64910'\n            and '64914' then 1\n            when icd9_code between 'V8530'\n            and 'V8539' then 1\n            when icd9_code = 'V854' then 1 -- hierarchy used for AHRQ v3.6 and earlier\n            when icd9_code between 'V8541'\n            and 'V8545' then 1\n            when icd9_code = 'V8554' then 1\n            when icd9_code = '79391' then 1\n        end as obese\n        /* Obesity      */\n,\n        CASE\n            when icd9_code between '260'\n            and '2639' then 1\n            when icd9_code between '78321'\n            and '78322' then 1\n        end as wghtloss\n        /* Weight loss */\n,\n        CASE\n            when icd9_code between '2760'\n            and '2769' then 1\n        end as lytes\n        /* Fluid and electrolyte disorders - note:\n         this comorbidity should be dropped when\n         used with the AHRQ Patient Safety Indicators*/\n,\n        CASE\n            when icd9_code = '2800' then 1\n            when icd9_code between '64820'\n            and '64824' then 1\n        end as bldloss\n        /* Blood loss anemia */\n,\n        CASE\n            when icd9_code between '2801'\n            and '2819' then 1\n            when icd9_code between '28521'\n            and '28529' then 1\n            when icd9_code = '2859' then 1\n        end as anemdef\n        /* Deficiency anemias */\n,\n        CASE\n            when icd9_code between '2910'\n            and '2913' then 1\n            when icd9_code = '2915' then 1\n            when icd9_code = '2918' then 1\n            when icd9_code = '29181' then 1\n            when icd9_code = '29182' then 1\n            when icd9_code = '29189' then 1\n            when icd9_code = '2919' then 1\n            when icd9_code between '30300'\n            and '30393' then 1\n            when icd9_code between '30500'\n            and '30503' then 1\n        end as alcohol\n        /* Alcohol abuse */\n,\n        CASE\n            when icd9_code = '2920' then 1\n            when icd9_code between '29282'\n            and '29289' then 1\n            when icd9_code = '2929' then 1\n            when icd9_code between '30400'\n            and '30493' then 1\n            when icd9_code between '30520'\n            and '30593' then 1\n            when icd9_code between '64830'\n            and '64834' then 1\n        end as drug\n        /* Drug abuse */\n,\n        CASE\n            when icd9_code between '29500'\n            and '2989' then 1\n            when icd9_code = '29910' then 1\n            when icd9_code = '29911' then 1\n        end as psych\n        /* Psychoses */\n,\n        CASE\n            when icd9_code = '3004' then 1\n            when icd9_code = '30112' then 1\n            when icd9_code = '3090' then 1\n            when icd9_code = '3091' then 1\n            when icd9_code = '311' then 1\n        end as depress\n        /* Depression */\n    from\n        diagnoses_icd icd\n    WHERE\n        seq_num = 1\n) -- collapse the icd9_code specific flags into hadm_id specific flags\n-- this groups comorbidities together for a single patient admission\n,\neligrp as (\n    select\n        hadm_id,\n        max(chf) as chf,\n        max(arythm) as arythm,\n        max(valve) as valve,\n        max(pulmcirc) as pulmcirc,\n        max(perivasc) as perivasc,\n        max(htn) as htn,\n        max(htncx) as htncx,\n        max(htnpreg) as htnpreg,\n        max(htnwochf) as htnwochf,\n        max(htnwchf) as htnwchf,\n        max(hrenworf) as hrenworf,\n        max(hrenwrf) as hrenwrf,\n        max(hhrwohrf) as hhrwohrf,\n        max(hhrwchf) as hhrwchf,\n        max(hhrwrf) as hhrwrf,\n        max(hhrwhrf) as hhrwhrf,\n        max(ohtnpreg) as ohtnpreg,\n        max(para) as para,\n        max(neuro) as neuro,\n        max(chrnlung) as chrnlung,\n        max(dm) as dm,\n        max(dmcx) as dmcx,\n        max(hypothy) as hypothy,\n        max(renlfail) as renlfail,\n        max(liver) as liver,\n        max(ulcer) as ulcer,\n        max(aids) as aids,\n        max(lymph) as lymph,\n        max(mets) as mets,\n        max(tumor) as tumor,\n        max(arth) as arth,\n        max(coag) as coag,\n        max(obese) as obese,\n        max(wghtloss) as wghtloss,\n        max(lytes) as lytes,\n        max(bldloss) as bldloss,\n        max(anemdef) as anemdef,\n        max(alcohol) as alcohol,\n        max(drug) as drug,\n        max(psych) as psych,\n        max(depress) as depress\n    from\n        eliflg\n    group by\n        hadm_id\n) -- DRG FILTER --\n,\nmsdrg as (\n    select\n        hadm_id\n        /**** V29 MS-DRG Formats ****/\n        /* Cardiac */\n,\n        case\n            when d.drg_code between 001\n            and 002 then 1\n            when d.drg_code between 215\n            and 238 then 1\n            when d.drg_code between 242\n            and 252 then 1\n            when d.drg_code between 253\n            and 254 then 1\n            when d.drg_code between 258\n            and 262 then 1\n            when d.drg_code between 265\n            and 267 then 1\n            when d.drg_code between 280\n            and 293 then 1\n            when d.drg_code between 296\n            and 298 then 1\n            when d.drg_code between 302\n            and 303 then 1\n            when d.drg_code between 306\n            and 313 then 1\n            else 0\n        end as carddrg\n        /* Peripheral vascular */\n,\n        case\n            when d.drg_code between 299\n            and 301 then 1\n            else 0\n        end as peridrg\n        /* Renal */\n,\n        case\n            when d.drg_code = 652 then 1\n            when d.drg_code between 656\n            and 661 then 1\n            when d.drg_code between 673\n            and 675 then 1\n            when d.drg_code between 682\n            and 700 then 1\n            else 0\n        end as renaldrg\n        /* Nervous system */\n,\n        case\n            when d.drg_code between 020\n            and 042 then 1\n            when d.drg_code between 052\n            and 103 then 1\n            else 0\n        end as nervdrg\n        /* Cerebrovascular */\n,\n        case\n            when d.drg_code between 020\n            and 022 then 1\n            when d.drg_code between 034\n            and 039 then 1\n            when d.drg_code between 064\n            and 072 then 1\n            else 0\n        end as ceredrg\n        /* COPD asthma */\n,\n        case\n            when d.drg_code between 190\n            and 192 then 1\n            when d.drg_code between 202\n            and 203 then 1\n            else 0\n        end as pulmdrg\n        /* Diabetes */\n,\n        case\n            when d.drg_code between 637\n            and 639 then 1\n            else 0\n        end as DIABDRG\n        /* Thyroid endocrine */\n,\n        case\n            when d.drg_code between 625\n            and 627 then 1\n            when d.drg_code between 643\n            and 645 then 1\n            else 0\n        end as hypodrg\n        /* Kidney transp, renal fail/dialysis */\n,\n        case\n            when d.drg_code = 652 then 1\n            when d.drg_code between 682\n            and 685 then 1\n            else 0\n        end as renfdrg\n        /* Liver */\n,\n        case\n            when d.drg_code between 420\n            and 425 then 1\n            when d.drg_code between 432\n            and 434 then 1\n            when d.drg_code between 441\n            and 446 then 1\n            else 0\n        end as liverdrg\n        /* GI hemorrhage or ulcer */\n,\n        case\n            when d.drg_code between 377\n            and 384 then 1\n            else 0\n        end as ulcedrg\n        /* Human immunodeficiency virus */\n,\n        case\n            when d.drg_code between 969\n            and 970 then 1\n            when d.drg_code between 974\n            and 977 then 1\n            else 0\n        end as hivdrg\n        /* Leukemia/lymphoma */\n,\n        case\n            when d.drg_code between 820\n            and 830 then 1\n            when d.drg_code between 834\n            and 849 then 1\n            else 0\n        end as leukdrg\n        /* Cancer, lymphoma */\n,\n        case\n            when d.drg_code = 054 then 1\n            when d.drg_code = 055 then 1\n            when d.drg_code between 146\n            and 148 then 1\n            when d.drg_code between 180\n            and 182 then 1\n            when d.drg_code between 374\n            and 376 then 1\n            when d.drg_code between 435\n            and 437 then 1\n            when d.drg_code between 542\n            and 544 then 1\n            when d.drg_code between 582\n            and 585 then 1\n            when d.drg_code between 597\n            and 599 then 1\n            when d.drg_code between 656\n            and 658 then 1\n            when d.drg_code between 686\n            and 688 then 1\n            when d.drg_code between 715\n            and 716 then 1\n            when d.drg_code between 722\n            and 724 then 1\n            when d.drg_code between 736\n            and 741 then 1\n            when d.drg_code between 754\n            and 756 then 1\n            when d.drg_code between 826\n            and 830 then 1\n            when d.drg_code between 843\n            and 849 then 1\n            else 0\n        end as cancdrg\n        /* Connective tissue */\n,\n        case\n            when d.drg_code between 545\n            and 547 then 1\n            else 0\n        end as arthdrg\n        /* Nutrition/metabolic */\n,\n        case\n            when d.drg_code between 640\n            and 641 then 1\n            else 0\n        end as nutrdrg\n        /* Anemia */\n,\n        case\n            when d.drg_code between 808\n            and 812 then 1\n            else 0\n        end as anemdrg\n        /* Alcohol drug */\n,\n        case\n            when d.drg_code between 894\n            and 897 then 1\n            else 0\n        end as alcdrg\n        /*Coagulation disorders*/\n,\n        case\n            when d.drg_code = 813 then 1\n            else 0\n        end as coagdrg\n        /*Hypertensive Complicated  */\n,\n        case\n            when d.drg_code = 077 then 1\n            when d.drg_code = 078 then 1\n            when d.drg_code = 304 then 1\n            else 0\n        end as htncxdrg\n        /*Hypertensive Uncomplicated  */\n,\n        case\n            when d.drg_code = 079 then 1\n            when d.drg_code = 305 then 1\n            else 0\n        end as htndrg\n        /* Psychoses */\n,\n        case\n            when d.drg_code = 885 then 1\n            else 0\n        end as psydrg\n        /* Obesity */\n,\n        case\n            when d.drg_code between 619\n            and 621 then 1\n            else 0\n        end as obesedrg\n        /* Depressive Neuroses */\n,\n        case\n            when d.drg_code = 881 then 1\n            else 0\n        end as deprsdrg\n    from\n        (\n            select\n                hadm_id,\n                drg_type,\n                cast(drg_code as numeric) as drg_code\n            from\n                drgcodes\n            where\n                drg_type = 'MS'\n        ) d\n),\nhcfadrg as (\n    select\n        hadm_id\n        /** V24 DRG Formats  **/\n        /* Cardiac */\n,\n        case\n            when d.drg_code between 103\n            and 112 then 1\n            when d.drg_code between 115\n            and 118 then 1\n            when d.drg_code between 121\n            and 127 then 1\n            when d.drg_code = 129 then 1\n            when d.drg_code = 132 then 1\n            when d.drg_code = 133 then 1\n            when d.drg_code between 135\n            and 143 then 1\n            when d.drg_code between 514\n            and 518 then 1\n            when d.drg_code between 525\n            and 527 then 1\n            when d.drg_code between 535\n            and 536 then 1\n            when d.drg_code between 547\n            and 550 then 1\n            when d.drg_code between 551\n            and 558 then 1\n            else 0\n        end as carddrg\n        /* Peripheral vascular */\n,\n        case\n            when d.drg_code = 130 then 1\n            when d.drg_code = 131 then 1\n            else 0\n        end as peridrg\n        /* Renal */\n,\n        case\n            when d.drg_code between 302\n            and 305 then 1\n            when d.drg_code between 315\n            and 333 then 1\n            else 0\n        end as renaldrg\n        /* Nervous system */\n,\n        case\n            when d.drg_code between 1\n            and 35 then 1\n            when d.drg_code = 524 then 1\n            when d.drg_code between 528\n            and 534 then 1\n            when d.drg_code = 543 then 1\n            when d.drg_code between 559\n            and 564 then 1\n            when d.drg_code = 577 then 1\n            else 0\n        end as nervdrg\n        /* Cerebrovascular */\n,\n        case\n            when d.drg_code = 5 then 1\n            when d.drg_code between 14\n            and 17 then 1\n            when d.drg_code = 524 then 1\n            when d.drg_code = 528 then 1\n            when d.drg_code between 533\n            and 534 then 1\n            when d.drg_code = 577 then 1\n            else 0\n        end as ceredrg\n        /* COPD asthma */\n,\n        case\n            when d.drg_code = 88 then 1\n            when d.drg_code between 96\n            and 98 then 1\n            else 0\n        end as pulmdrg\n        /* Diabetes */\n,\n        case\n            when d.drg_code = 294 then 1\n            when d.drg_code = 295 then 1\n            else 0\n        end as diabdrg\n        /* Thyroid endocrine */\n,\n        case\n            when d.drg_code = 290 then 1\n            when d.drg_code = 300 then 1\n            when d.drg_code = 301 then 1\n            else 0\n        end as hypodrg\n        /* Kidney transp, renal fail/dialysis */\n,\n        case\n            when d.drg_code = 302 then 1\n            when d.drg_code = 316 then 1\n            when d.drg_code = 317 then 1\n            else 0\n        end as renfdrg\n        /* Liver */\n,\n        case\n            when d.drg_code between 199\n            and 202 then 1\n            when d.drg_code between 205\n            and 208 then 1\n            else 0\n        end as liverdrg\n        /* GI hemorrhage or ulcer */\n,\n        case\n            when d.drg_code between 174\n            and 178 then 1\n            else 0\n        end as ulcedrg\n        /* Human immunodeficiency virus */\n,\n        case\n            when d.drg_code = 488 then 1\n            when d.drg_code = 489 then 1\n            when d.drg_code = 490 then 1\n            else 0\n        end as hivdrg\n        /* Leukemia/lymphoma */\n,\n        case\n            when d.drg_code between 400\n            and 414 then 1\n            when d.drg_code = 473 then 1\n            when d.drg_code = 492 then 1\n            when d.drg_code between 539\n            and 540 then 1\n            else 0\n        end as leukdrg\n        /* Cancer, lymphoma */\n,\n        case\n            when d.drg_code = 10 then 1\n            when d.drg_code = 11 then 1\n            when d.drg_code = 64 then 1\n            when d.drg_code = 82 then 1\n            when d.drg_code = 172 then 1\n            when d.drg_code = 173 then 1\n            when d.drg_code = 199 then 1\n            when d.drg_code = 203 then 1\n            when d.drg_code = 239 then 1\n            when d.drg_code between 257\n            and 260 then 1\n            when d.drg_code = 274 then 1\n            when d.drg_code = 275 then 1\n            when d.drg_code = 303 then 1\n            when d.drg_code = 318 then 1\n            when d.drg_code = 319 then 1\n            when d.drg_code = 338 then 1\n            when d.drg_code = 344 then 1\n            when d.drg_code = 346 then 1\n            when d.drg_code = 347 then 1\n            when d.drg_code = 354 then 1\n            when d.drg_code = 355 then 1\n            when d.drg_code = 357 then 1\n            when d.drg_code = 363 then 1\n            when d.drg_code = 366 then 1\n            when d.drg_code = 367 then 1\n            when d.drg_code between 406\n            and 414 then 1\n            else 0\n        end as cancdrg\n        /* Connective tissue */\n,\n        case\n            when d.drg_code = 240 then 1\n            when d.drg_code = 241 then 1\n            else 0\n        end as arthdrg\n        /* Nutrition/metabolic */\n,\n        case\n            when d.drg_code between 296\n            and 298 then 1\n            else 0\n        end as nutrdrg\n        /* Anemia */\n,\n        case\n            when d.drg_code = 395 then 1\n            when d.drg_code = 396 then 1\n            when d.drg_code = 574 then 1\n            else 0\n        end as anemdrg\n        /* Alcohol drug */\n,\n        case\n            when d.drg_code between 433\n            and 437 then 1\n            when d.drg_code between 521\n            and 523 then 1\n            else 0\n        end as alcdrg\n        /* Coagulation disorders */\n,\n        case\n            when d.drg_code = 397 then 1\n            else 0\n        end as coagdrg\n        /* Hypertensive Complicated */\n,\n        case\n            when d.drg_code = 22 then 1\n            when d.drg_code = 134 then 1\n            else 0\n        end as htncxdrg\n        /* Hypertensive Uncomplicated */\n,\n        case\n            when d.drg_code = 134 then 1\n            else 0\n        end as htndrg\n        /* Psychoses */\n,\n        case\n            when d.drg_code = 430 then 1\n            else 0\n        end as psydrg\n        /* Obesity */\n,\n        case\n            when d.drg_code = 288 then 1\n            else 0\n        end as obesedrg\n        /* Depressive Neuroses */\n,\n        case\n            when d.drg_code = 426 then 1\n            else 0\n        end as deprsdrg\n    from\n        (\n            select\n                hadm_id,\n                drg_type,\n                cast(drg_code as numeric) as drg_code\n            from\n                drgcodes\n            where\n                drg_type = 'HCFA'\n        ) d\n) -- merge DRG groups together\n,\ndrggrp as (\n    select\n        hadm_id,\n        max(carddrg) as carddrg,\n        max(peridrg) as peridrg,\n        max(renaldrg) as renaldrg,\n        max(nervdrg) as nervdrg,\n        max(ceredrg) as ceredrg,\n        max(pulmdrg) as pulmdrg,\n        max(diabdrg) as diabdrg,\n        max(hypodrg) as hypodrg,\n        max(renfdrg) as renfdrg,\n        max(liverdrg) as liverdrg,\n        max(ulcedrg) as ulcedrg,\n        max(hivdrg) as hivdrg,\n        max(leukdrg) as leukdrg,\n        max(cancdrg) as cancdrg,\n        max(arthdrg) as arthdrg,\n        max(nutrdrg) as nutrdrg,\n        max(anemdrg) as anemdrg,\n        max(alcdrg) as alcdrg,\n        max(coagdrg) as coagdrg,\n        max(htncxdrg) as htncxdrg,\n        max(htndrg) as htndrg,\n        max(psydrg) as psydrg,\n        max(obesedrg) as obesedrg,\n        max(deprsdrg) as deprsdrg\n    from\n        (\n            select\n                d1.*\n            from\n                msdrg d1\n            UNION\n            DISTINCT\n            select\n                d1.*\n            from\n                hcfadrg d1\n        ) d\n    group by\n        d.hadm_id\n) -- now merge these flags together to define elixhauser\n-- most are straightforward.. but hypertension flags are a bit more complicated\nselect\n    adm.subject_id,\n    adm.hadm_id,\n    case\n        when carddrg = 1 then 0 -- DRG filter\n        when chf = 1 then 1\n        when htnwchf = 1 then 1\n        when hhrwchf = 1 then 1\n        when hhrwhrf = 1 then 1\n        else 0\n    end as congestive_heart_failure,\n    case\n        when carddrg = 1 then 0 -- DRG filter\n        when arythm = 1 then 1\n        else 0\n    end as cardiac_arrhythmias,\n    case\n        when carddrg = 1 then 0\n        when valve = 1 then 1\n        else 0\n    end as valvular_disease,\n    case\n        when carddrg = 1\n        or pulmdrg = 1 then 0\n        when pulmcirc = 1 then 1\n        else 0\n    end as pulmonary_circulation,\n    case\n        when peridrg = 1 then 0\n        when perivasc = 1 then 1\n        else 0\n    end as peripheral_vascular -- we combine 'htn' and 'htncx' into 'HYPERTENSION'\n    -- note 'htn' (hypertension) is only 1 if 'htncx' (complicated hypertension) is 0\n    -- also if htncxdrg = 1, then htndrg = 1\n    -- In the original Sas code, it appears that:\n    --  HTN can be 1\n    --  HTNCX is set to 0 by DRGs\n    --  but HTN_C is still 1, because HTN is 1\n    -- so we have to do this complex addition.\n,\n    case\n        when (\n            -- first hypertension\n            case\n                when htndrg = 0 then 0\n                when htn = 1 then 1\n                else 0\n            end\n        ) + (\n            -- next complicated hypertension\n            case\n                when htncx = 1\n                and htncxdrg = 1 then 0\n                when htnpreg = 1\n                and htncxdrg = 1 then 0\n                when htnwochf = 1\n                and (\n                    htncxdrg = 1\n                    OR carddrg = 1\n                ) then 0\n                when htnwchf = 1\n                and htncxdrg = 1 then 0\n                when htnwchf = 1\n                and carddrg = 1 then 0\n                when hrenworf = 1\n                and (\n                    htncxdrg = 1\n                    or renaldrg = 1\n                ) then 0\n                when hrenwrf = 1\n                and htncxdrg = 1 then 0\n                when hrenwrf = 1\n                and renaldrg = 1 then 0\n                when hhrwohrf = 1\n                and (\n                    htncxdrg = 1\n                    or carddrg = 1\n                    or renaldrg = 1\n                ) then 0\n                when hhrwchf = 1\n                and (\n                    htncxdrg = 1\n                    or carddrg = 1\n                    or renaldrg = 1\n                ) then 0\n                when hhrwrf = 1\n                and (\n                    htncxdrg = 1\n                    or carddrg = 1\n                    or renaldrg = 1\n                ) then 0\n                when hhrwhrf = 1\n                and (\n                    htncxdrg = 1\n                    or carddrg = 1\n                    or renaldrg = 1\n                ) then 0\n                when ohtnpreg = 1\n                and (\n                    htncxdrg = 1\n                    or carddrg = 1\n                    or renaldrg = 1\n                ) then 0\n                when htncx = 1 then 1\n                when htnpreg = 1 then 1\n                when htnwochf = 1 then 1\n                when htnwchf = 1 then 1\n                when hrenworf = 1 then 1\n                when hrenwrf = 1 then 1\n                when hhrwohrf = 1 then 1\n                when hhrwchf = 1 then 1\n                when hhrwrf = 1 then 1\n                when hhrwhrf = 1 then 1\n                when ohtnpreg = 1 then 1\n                else 0\n            end\n        ) > 0 then 1\n        else 0\n    end as hypertension,\n    case\n        when ceredrg = 1 then 0\n        when para = 1 then 1\n        else 0\n    end as paralysis,\n    case\n        when nervdrg = 1 then 0\n        when neuro = 1 then 1\n        else 0\n    end as other_neurological,\n    case\n        when pulmdrg = 1 then 0\n        when chrnlung = 1 then 1\n        else 0\n    end as chronic_pulmonary,\n    case\n        -- only the more severe comorbidity (complicated diabetes) is kept\n        when diabdrg = 1 then 0\n        when dmcx = 1 then 0\n        when dm = 1 then 1\n        else 0\n    end as diabetes_uncomplicated,\n    case\n        when diabdrg = 1 then 0\n        when dmcx = 1 then 1\n        else 0\n    end as diabetes_complicated,\n    case\n        when hypodrg = 1 then 0\n        when hypothy = 1 then 1\n        else 0\n    end as hypothyroidism,\n    case\n        when renaldrg = 1 then 0\n        when renlfail = 1 then 1\n        when hrenwrf = 1 then 1\n        when hhrwrf = 1 then 1\n        when hhrwhrf = 1 then 1\n        else 0\n    end as renal_failure,\n    case\n        when liverdrg = 1 then 0\n        when liver = 1 then 1\n        else 0\n    end as liver_disease,\n    case\n        when ulcedrg = 1 then 0\n        when ulcer = 1 then 1\n        else 0\n    end as peptic_ulcer,\n    case\n        when hivdrg = 1 then 0\n        when aids = 1 then 1\n        else 0\n    end as aids,\n    case\n        when leukdrg = 1 then 0\n        when lymph = 1 then 1\n        else 0\n    end as lymphoma,\n    case\n        when cancdrg = 1 then 0\n        when mets = 1 then 1\n        else 0\n    end as metastatic_cancer,\n    case\n        when cancdrg = 1 then 0 -- only the more severe comorbidity (metastatic cancer) is kept\n        when mets = 1 then 0\n        when tumor = 1 then 1\n        else 0\n    end as solid_tumor,\n    case\n        when arthdrg = 1 then 0\n        when arth = 1 then 1\n        else 0\n    end as rheumatoid_arthritis,\n    case\n        when coagdrg = 1 then 0\n        when coag = 1 then 1\n        else 0\n    end as coagulopathy,\n    case\n        when nutrdrg = 1\n        OR obesedrg = 1 then 0\n        when obese = 1 then 1\n        else 0\n    end as obesity,\n    case\n        when nutrdrg = 1 then 0\n        when wghtloss = 1 then 1\n        else 0\n    end as weight_loss,\n    case\n        when nutrdrg = 1 then 0\n        when lytes = 1 then 1\n        else 0\n    end as fluid_electrolyte,\n    case\n        when anemdrg = 1 then 0\n        when bldloss = 1 then 1\n        else 0\n    end as blood_loss_anemia,\n    case\n        when anemdrg = 1 then 0\n        when anemdef = 1 then 1\n        else 0\n    end as deficiency_anemias,\n    case\n        when alcdrg = 1 then 0\n        when alcohol = 1 then 1\n        else 0\n    end as alcohol_abuse,\n    case\n        when alcdrg = 1 then 0\n        when drug = 1 then 1\n        else 0\n    end as drug_abuse,\n    case\n        when psydrg = 1 then 0\n        when psych = 1 then 1\n        else 0\n    end as psychoses,\n    case\n        when deprsdrg = 1 then 0\n        when depress = 1 then 1\n        else 0\n    end as depression\nFROM\n    admissions adm\n    left join eligrp eli on adm.hadm_id = eli.hadm_id\n    left join drggrp d on adm.hadm_id = d.hadm_id\norder by\n    adm.hadm_id",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.diagnoses_icd",
            "mimiciii_clinical.drgcodes"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "hadm_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "congestive_heart_failure": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "cardiac_arrhythmias": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "valvular_disease": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "pulmonary_circulation": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "peripheral_vascular": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "hypertension": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "paralysis": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "other_neurological": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "chronic_pulmonary": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "diabetes_uncomplicated": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "diabetes_complicated": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "hypothyroidism": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "renal_failure": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "liver_disease": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "peptic_ulcer": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "aids": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "lymphoma": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "metastatic_cancer": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "solid_tumor": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "rheumatoid_arthritis": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "coagulopathy": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "obesity": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "weight_loss": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "fluid_electrolyte": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "blood_loss_anemia": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "deficiency_anemias": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "alcohol_abuse": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "drug_abuse": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "psychoses": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ],
            "depression": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num",
                "mimiciii_clinical.drgcodes.drg_code",
                "mimiciii_clinical.drgcodes.drg_type",
                "mimiciii_clinical.drgcodes.hadm_id"
            ]
        },
        "table_name": "mimiciii_clinical.elixhauser_ahrq_v37",
        "plan": {
            "Node Type": "Merge Join",
            "Parallel Aware": false,
            "Join Type": "Left",
            "Output": [
                "adm.subject_id",
                "adm.hadm_id",
                "CASE WHEN (d.carddrg = 1) THEN 0 WHEN (eli.chf = 1) THEN 1 WHEN (eli.htnwchf = 1) THEN 1 WHEN (eli.hhrwchf = 1) THEN 1 WHEN (eli.hhrwhrf = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.carddrg = 1) THEN 0 WHEN (eli.arythm = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.carddrg = 1) THEN 0 WHEN (eli.valve = 1) THEN 1 ELSE 0 END",
                "CASE WHEN ((d.carddrg = 1) OR (d.pulmdrg = 1)) THEN 0 WHEN (eli.pulmcirc = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.peridrg = 1) THEN 0 WHEN (eli.perivasc = 1) THEN 1 ELSE 0 END",
                "CASE WHEN ((CASE WHEN (d.htndrg = 0) THEN 0 WHEN (eli.htn = 1) THEN 1 ELSE 0 END + CASE WHEN ((eli.htncx = 1) AND (d.htncxdrg = 1)) THEN 0 WHEN ((eli.htnpreg = 1) AND (d.htncxdrg = 1)) THEN 0 WHEN ((eli.htnwochf = 1) AND ((d.htncxdrg = 1) OR (d.carddrg = 1))) THEN 0 WHEN ((eli.htnwchf = 1) AND (d.htncxdrg = 1)) THEN 0 WHEN ((eli.htnwchf = 1) AND (d.carddrg = 1)) THEN 0 WHEN ((eli.hrenworf = 1) AND ((d.htncxdrg = 1) OR (d.renaldrg = 1))) THEN 0 WHEN ((eli.hrenwrf = 1) AND (d.htncxdrg = 1)) THEN 0 WHEN ((eli.hrenwrf = 1) AND (d.renaldrg = 1)) THEN 0 WHEN ((eli.hhrwohrf = 1) AND ((d.htncxdrg = 1) OR (d.carddrg = 1) OR (d.renaldrg = 1))) THEN 0 WHEN ((eli.hhrwchf = 1) AND ((d.htncxdrg = 1) OR (d.carddrg = 1) OR (d.renaldrg = 1))) THEN 0 WHEN ((eli.hhrwrf = 1) AND ((d.htncxdrg = 1) OR (d.carddrg = 1) OR (d.renaldrg = 1))) THEN 0 WHEN ((eli.hhrwhrf = 1) AND ((d.htncxdrg = 1) OR (d.carddrg = 1) OR (d.renaldrg = 1))) THEN 0 WHEN ((eli.ohtnpreg = 1) AND ((d.htncxdrg = 1) OR (d.carddrg = 1) OR (d.renaldrg = 1))) THEN 0 WHEN (eli.htncx = 1) THEN 1 WHEN (eli.htnpreg = 1) THEN 1 WHEN (eli.htnwochf = 1) THEN 1 WHEN (eli.htnwchf = 1) THEN 1 WHEN (eli.hrenworf = 1) THEN 1 WHEN (eli.hrenwrf = 1) THEN 1 WHEN (eli.hhrwohrf = 1) THEN 1 WHEN (eli.hhrwchf = 1) THEN 1 WHEN (eli.hhrwrf = 1) THEN 1 WHEN (eli.hhrwhrf = 1) THEN 1 WHEN (eli.ohtnpreg = 1) THEN 1 ELSE 0 END) > 0) THEN 1 ELSE 0 END",
                "CASE WHEN (d.ceredrg = 1) THEN 0 WHEN (eli.para = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.nervdrg = 1) THEN 0 WHEN (eli.neuro = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.pulmdrg = 1) THEN 0 WHEN (eli.chrnlung = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.diabdrg = 1) THEN 0 WHEN (eli.dmcx = 1) THEN 0 WHEN (eli.dm = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.diabdrg = 1) THEN 0 WHEN (eli.dmcx = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.hypodrg = 1) THEN 0 WHEN (eli.hypothy = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.renaldrg = 1) THEN 0 WHEN (eli.renlfail = 1) THEN 1 WHEN (eli.hrenwrf = 1) THEN 1 WHEN (eli.hhrwrf = 1) THEN 1 WHEN (eli.hhrwhrf = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.liverdrg = 1) THEN 0 WHEN (eli.liver = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.ulcedrg = 1) THEN 0 WHEN (eli.ulcer = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.hivdrg = 1) THEN 0 WHEN (eli.aids = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.leukdrg = 1) THEN 0 WHEN (eli.lymph = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.cancdrg = 1) THEN 0 WHEN (eli.mets = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.cancdrg = 1) THEN 0 WHEN (eli.mets = 1) THEN 0 WHEN (eli.tumor = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.arthdrg = 1) THEN 0 WHEN (eli.arth = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.coagdrg = 1) THEN 0 WHEN (eli.coag = 1) THEN 1 ELSE 0 END",
                "CASE WHEN ((d.nutrdrg = 1) OR (d.obesedrg = 1)) THEN 0 WHEN (eli.obese = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.nutrdrg = 1) THEN 0 WHEN (eli.wghtloss = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.nutrdrg = 1) THEN 0 WHEN (eli.lytes = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.anemdrg = 1) THEN 0 WHEN (eli.bldloss = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.anemdrg = 1) THEN 0 WHEN (eli.anemdef = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.alcdrg = 1) THEN 0 WHEN (eli.alcohol = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.alcdrg = 1) THEN 0 WHEN (eli.drug = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.psydrg = 1) THEN 0 WHEN (eli.psych = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (d.deprsdrg = 1) THEN 0 WHEN (eli.depress = 1) THEN 1 ELSE 0 END"
            ],
            "Inner Unique": false,
            "Merge Cond": "(adm.hadm_id = d.hadm_id)",
            "Plans": [
                {
                    "Node Type": "Seq Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE eliflg",
                    "Parallel Aware": false,
                    "Relation Name": "diagnoses_icd",
                    "Schema": "mimiciii_clinical",
                    "Alias": "icd",
                    "Output": [
                        "icd.hadm_id",
                        "icd.seq_num",
                        "icd.icd9_code",
                        "CASE WHEN ((icd.icd9_code)::text = '39891'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '4280'::text) AND ((icd.icd9_code)::text <= '4289'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '42610'::text) THEN 1 WHEN ((icd.icd9_code)::text = '42611'::text) THEN 1 WHEN ((icd.icd9_code)::text = '42613'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '4262'::text) AND ((icd.icd9_code)::text <= '42653'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '4266'::text) AND ((icd.icd9_code)::text <= '42689'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '4270'::text) THEN 1 WHEN ((icd.icd9_code)::text = '4272'::text) THEN 1 WHEN ((icd.icd9_code)::text = '42731'::text) THEN 1 WHEN ((icd.icd9_code)::text = '42760'::text) THEN 1 WHEN ((icd.icd9_code)::text = '4279'::text) THEN 1 WHEN ((icd.icd9_code)::text = '7850'::text) THEN 1 WHEN (((icd.icd9_code)::text >= 'V450'::text) AND ((icd.icd9_code)::text <= 'V4509'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= 'V533'::text) AND ((icd.icd9_code)::text <= 'V5339'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '09320'::text) AND ((icd.icd9_code)::text <= '09324'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '3940'::text) AND ((icd.icd9_code)::text <= '3971'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '3979'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '4240'::text) AND ((icd.icd9_code)::text <= '42499'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '7463'::text) AND ((icd.icd9_code)::text <= '7466'::text)) THEN 1 WHEN ((icd.icd9_code)::text = 'V422'::text) THEN 1 WHEN ((icd.icd9_code)::text = 'V433'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '41511'::text) AND ((icd.icd9_code)::text <= '41519'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '4160'::text) AND ((icd.icd9_code)::text <= '4169'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '4179'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '4400'::text) AND ((icd.icd9_code)::text <= '4409'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '44100'::text) AND ((icd.icd9_code)::text <= '4419'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '4420'::text) AND ((icd.icd9_code)::text <= '4429'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '4431'::text) AND ((icd.icd9_code)::text <= '4439'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '44421'::text) AND ((icd.icd9_code)::text <= '44422'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '4471'::text) THEN 1 WHEN ((icd.icd9_code)::text = '449'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5571'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5579'::text) THEN 1 WHEN ((icd.icd9_code)::text = 'V434'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '4011'::text) THEN 1 WHEN ((icd.icd9_code)::text = '4019'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '64200'::text) AND ((icd.icd9_code)::text <= '64204'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '4010'::text) THEN 1 WHEN ((icd.icd9_code)::text = '4372'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '64220'::text) AND ((icd.icd9_code)::text <= '64224'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '40200'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40210'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40290'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40509'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40519'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40599'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '40201'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40211'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40291'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '40300'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40310'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40390'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40501'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40511'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40591'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '64210'::text) AND ((icd.icd9_code)::text <= '64214'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '40301'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40311'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40391'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '40400'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40410'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40490'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '40401'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40411'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40491'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '40402'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40412'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40492'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '40403'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40413'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40493'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '64270'::text) AND ((icd.icd9_code)::text <= '64274'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '64290'::text) AND ((icd.icd9_code)::text <= '64294'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '3420'::text) AND ((icd.icd9_code)::text <= '3449'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '43820'::text) AND ((icd.icd9_code)::text <= '43853'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '78072'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '3300'::text) AND ((icd.icd9_code)::text <= '3319'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '3320'::text) THEN 1 WHEN ((icd.icd9_code)::text = '3334'::text) THEN 1 WHEN ((icd.icd9_code)::text = '3335'::text) THEN 1 WHEN ((icd.icd9_code)::text = '3337'::text) THEN 1 WHEN ((icd.icd9_code)::text = ANY ('{33371,33372,33379,33385,33394}'::text[])) THEN 1 WHEN (((icd.icd9_code)::text >= '3340'::text) AND ((icd.icd9_code)::text <= '3359'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '3380'::text) THEN 1 WHEN ((icd.icd9_code)::text = '340'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '3411'::text) AND ((icd.icd9_code)::text <= '3419'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '34500'::text) AND ((icd.icd9_code)::text <= '34511'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '3452'::text) AND ((icd.icd9_code)::text <= '3453'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '34540'::text) AND ((icd.icd9_code)::text <= '34591'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '34700'::text) AND ((icd.icd9_code)::text <= '34701'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '34710'::text) AND ((icd.icd9_code)::text <= '34711'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '3483'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '64940'::text) AND ((icd.icd9_code)::text <= '64944'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '7687'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '76870'::text) AND ((icd.icd9_code)::text <= '76873'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '7803'::text) THEN 1 WHEN ((icd.icd9_code)::text = '78031'::text) THEN 1 WHEN ((icd.icd9_code)::text = '78032'::text) THEN 1 WHEN ((icd.icd9_code)::text = '78033'::text) THEN 1 WHEN ((icd.icd9_code)::text = '78039'::text) THEN 1 WHEN ((icd.icd9_code)::text = '78097'::text) THEN 1 WHEN ((icd.icd9_code)::text = '7843'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '490'::text) AND ((icd.icd9_code)::text <= '4928'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '49300'::text) AND ((icd.icd9_code)::text <= '49392'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '494'::text) AND ((icd.icd9_code)::text <= '4941'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '4950'::text) AND ((icd.icd9_code)::text <= '505'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '5064'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '25000'::text) AND ((icd.icd9_code)::text <= '25033'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '64800'::text) AND ((icd.icd9_code)::text <= '64804'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '24900'::text) AND ((icd.icd9_code)::text <= '24931'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '25040'::text) AND ((icd.icd9_code)::text <= '25093'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '7751'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '24940'::text) AND ((icd.icd9_code)::text <= '24991'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '243'::text) AND ((icd.icd9_code)::text <= '2442'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '2448'::text) THEN 1 WHEN ((icd.icd9_code)::text = '2449'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '585'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5853'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5854'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5855'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5856'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5859'::text) THEN 1 WHEN ((icd.icd9_code)::text = '586'::text) THEN 1 WHEN ((icd.icd9_code)::text = 'V420'::text) THEN 1 WHEN ((icd.icd9_code)::text = 'V451'::text) THEN 1 WHEN (((icd.icd9_code)::text >= 'V560'::text) AND ((icd.icd9_code)::text <= 'V5632'::text)) THEN 1 WHEN ((icd.icd9_code)::text = 'V568'::text) THEN 1 WHEN (((icd.icd9_code)::text >= 'V4511'::text) AND ((icd.icd9_code)::text <= 'V4512'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '07022'::text) THEN 1 WHEN ((icd.icd9_code)::text = '07023'::text) THEN 1 WHEN ((icd.icd9_code)::text = '07032'::text) THEN 1 WHEN ((icd.icd9_code)::text = '07033'::text) THEN 1 WHEN ((icd.icd9_code)::text = '07044'::text) THEN 1 WHEN ((icd.icd9_code)::text = '07054'::text) THEN 1 WHEN ((icd.icd9_code)::text = '4560'::text) THEN 1 WHEN ((icd.icd9_code)::text = '4561'::text) THEN 1 WHEN ((icd.icd9_code)::text = '45620'::text) THEN 1 WHEN ((icd.icd9_code)::text = '45621'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5710'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5712'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5713'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '57140'::text) AND ((icd.icd9_code)::text <= '57149'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '5715'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5716'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5718'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5719'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5723'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5728'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5735'::text) THEN 1 WHEN ((icd.icd9_code)::text = 'V427'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '53141'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53151'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53161'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53170'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53171'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53191'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53241'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53251'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53261'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53270'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53271'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53291'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53341'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53351'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53361'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53370'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53371'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53391'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53441'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53451'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53461'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53470'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53471'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53491'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '042'::text) AND ((icd.icd9_code)::text <= '0449'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '20000'::text) AND ((icd.icd9_code)::text <= '20238'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '20250'::text) AND ((icd.icd9_code)::text <= '20301'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '2386'::text) THEN 1 WHEN ((icd.icd9_code)::text = '2733'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '20302'::text) AND ((icd.icd9_code)::text <= '20382'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '1960'::text) AND ((icd.icd9_code)::text <= '1991'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '20970'::text) AND ((icd.icd9_code)::text <= '20975'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '20979'::text) THEN 1 WHEN ((icd.icd9_code)::text = '78951'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '1400'::text) AND ((icd.icd9_code)::text <= '1729'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '1740'::text) AND ((icd.icd9_code)::text <= '1759'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '179'::text) AND ((icd.icd9_code)::text <= '1958'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '20900'::text) AND ((icd.icd9_code)::text <= '20924'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '20925'::text) AND ((icd.icd9_code)::text <= '2093'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '20930'::text) AND ((icd.icd9_code)::text <= '20936'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '25801'::text) AND ((icd.icd9_code)::text <= '25803'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '7010'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '7100'::text) AND ((icd.icd9_code)::text <= '7109'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '7140'::text) AND ((icd.icd9_code)::text <= '7149'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '7200'::text) AND ((icd.icd9_code)::text <= '7209'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '725'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '2860'::text) AND ((icd.icd9_code)::text <= '2869'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '2871'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '2873'::text) AND ((icd.icd9_code)::text <= '2875'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '64930'::text) AND ((icd.icd9_code)::text <= '64934'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '28984'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '2780'::text) THEN 1 WHEN ((icd.icd9_code)::text = '27800'::text) THEN 1 WHEN ((icd.icd9_code)::text = '27801'::text) THEN 1 WHEN ((icd.icd9_code)::text = '27803'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '64910'::text) AND ((icd.icd9_code)::text <= '64914'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= 'V8530'::text) AND ((icd.icd9_code)::text <= 'V8539'::text)) THEN 1 WHEN ((icd.icd9_code)::text = 'V854'::text) THEN 1 WHEN (((icd.icd9_code)::text >= 'V8541'::text) AND ((icd.icd9_code)::text <= 'V8545'::text)) THEN 1 WHEN ((icd.icd9_code)::text = 'V8554'::text) THEN 1 WHEN ((icd.icd9_code)::text = '79391'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '260'::text) AND ((icd.icd9_code)::text <= '2639'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '78321'::text) AND ((icd.icd9_code)::text <= '78322'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '2760'::text) AND ((icd.icd9_code)::text <= '2769'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '2800'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '64820'::text) AND ((icd.icd9_code)::text <= '64824'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '2801'::text) AND ((icd.icd9_code)::text <= '2819'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '28521'::text) AND ((icd.icd9_code)::text <= '28529'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '2859'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '2910'::text) AND ((icd.icd9_code)::text <= '2913'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '2915'::text) THEN 1 WHEN ((icd.icd9_code)::text = '2918'::text) THEN 1 WHEN ((icd.icd9_code)::text = '29181'::text) THEN 1 WHEN ((icd.icd9_code)::text = '29182'::text) THEN 1 WHEN ((icd.icd9_code)::text = '29189'::text) THEN 1 WHEN ((icd.icd9_code)::text = '2919'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '30300'::text) AND ((icd.icd9_code)::text <= '30393'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '30500'::text) AND ((icd.icd9_code)::text <= '30503'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '2920'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '29282'::text) AND ((icd.icd9_code)::text <= '29289'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '2929'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '30400'::text) AND ((icd.icd9_code)::text <= '30493'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '30520'::text) AND ((icd.icd9_code)::text <= '30593'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '64830'::text) AND ((icd.icd9_code)::text <= '64834'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '29500'::text) AND ((icd.icd9_code)::text <= '2989'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '29910'::text) THEN 1 WHEN ((icd.icd9_code)::text = '29911'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '3004'::text) THEN 1 WHEN ((icd.icd9_code)::text = '30112'::text) THEN 1 WHEN ((icd.icd9_code)::text = '3090'::text) THEN 1 WHEN ((icd.icd9_code)::text = '3091'::text) THEN 1 WHEN ((icd.icd9_code)::text = '311'::text) THEN 1 ELSE NULL::integer END"
                    ],
                    "Filter": "(icd.seq_num = 1)"
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE eligrp",
                    "Parallel Aware": false,
                    "Output": [
                        "eliflg.hadm_id",
                        "max(eliflg.chf)",
                        "max(eliflg.arythm)",
                        "max(eliflg.valve)",
                        "max(eliflg.pulmcirc)",
                        "max(eliflg.perivasc)",
                        "max(eliflg.htn)",
                        "max(eliflg.htncx)",
                        "max(eliflg.htnpreg)",
                        "max(eliflg.htnwochf)",
                        "max(eliflg.htnwchf)",
                        "max(eliflg.hrenworf)",
                        "max(eliflg.hrenwrf)",
                        "max(eliflg.hhrwohrf)",
                        "max(eliflg.hhrwchf)",
                        "max(eliflg.hhrwrf)",
                        "max(eliflg.hhrwhrf)",
                        "max(eliflg.ohtnpreg)",
                        "max(eliflg.para)",
                        "max(eliflg.neuro)",
                        "max(eliflg.chrnlung)",
                        "max(eliflg.dm)",
                        "max(eliflg.dmcx)",
                        "max(eliflg.hypothy)",
                        "max(eliflg.renlfail)",
                        "max(eliflg.liver)",
                        "max(eliflg.ulcer)",
                        "max(eliflg.aids)",
                        "max(eliflg.lymph)",
                        "max(eliflg.mets)",
                        "max(eliflg.tumor)",
                        "max(eliflg.arth)",
                        "max(eliflg.coag)",
                        "max(eliflg.obese)",
                        "max(eliflg.wghtloss)",
                        "max(eliflg.lytes)",
                        "max(eliflg.bldloss)",
                        "max(eliflg.anemdef)",
                        "max(eliflg.alcohol)",
                        "max(eliflg.drug)",
                        "max(eliflg.psych)",
                        "max(eliflg.depress)"
                    ],
                    "Group Key": [
                        "eliflg.hadm_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "eliflg",
                            "Alias": "eliflg",
                            "Output": [
                                "eliflg.hadm_id",
                                "eliflg.seq_num",
                                "eliflg.icd9_code",
                                "eliflg.chf",
                                "eliflg.arythm",
                                "eliflg.valve",
                                "eliflg.pulmcirc",
                                "eliflg.perivasc",
                                "eliflg.htn",
                                "eliflg.htncx",
                                "eliflg.htnpreg",
                                "eliflg.htnwochf",
                                "eliflg.htnwchf",
                                "eliflg.hrenworf",
                                "eliflg.hrenwrf",
                                "eliflg.hhrwohrf",
                                "eliflg.hhrwchf",
                                "eliflg.hhrwrf",
                                "eliflg.hhrwhrf",
                                "eliflg.ohtnpreg",
                                "eliflg.para",
                                "eliflg.neuro",
                                "eliflg.chrnlung",
                                "eliflg.dm",
                                "eliflg.dmcx",
                                "eliflg.hypothy",
                                "eliflg.renlfail",
                                "eliflg.liver",
                                "eliflg.ulcer",
                                "eliflg.aids",
                                "eliflg.lymph",
                                "eliflg.mets",
                                "eliflg.tumor",
                                "eliflg.arth",
                                "eliflg.coag",
                                "eliflg.obese",
                                "eliflg.wghtloss",
                                "eliflg.lytes",
                                "eliflg.bldloss",
                                "eliflg.anemdef",
                                "eliflg.alcohol",
                                "eliflg.drug",
                                "eliflg.psych",
                                "eliflg.depress"
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Seq Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE msdrg",
                    "Parallel Aware": false,
                    "Relation Name": "drgcodes",
                    "Schema": "mimiciii_clinical",
                    "Alias": "drgcodes",
                    "Output": [
                        "drgcodes.hadm_id",
                        "CASE WHEN (((drgcodes.drg_code)::numeric >= '1'::numeric) AND ((drgcodes.drg_code)::numeric <= '2'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '215'::numeric) AND ((drgcodes.drg_code)::numeric <= '238'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '242'::numeric) AND ((drgcodes.drg_code)::numeric <= '252'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '253'::numeric) AND ((drgcodes.drg_code)::numeric <= '254'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '258'::numeric) AND ((drgcodes.drg_code)::numeric <= '262'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '265'::numeric) AND ((drgcodes.drg_code)::numeric <= '267'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '280'::numeric) AND ((drgcodes.drg_code)::numeric <= '293'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '296'::numeric) AND ((drgcodes.drg_code)::numeric <= '298'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '302'::numeric) AND ((drgcodes.drg_code)::numeric <= '303'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '306'::numeric) AND ((drgcodes.drg_code)::numeric <= '313'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN (((drgcodes.drg_code)::numeric >= '299'::numeric) AND ((drgcodes.drg_code)::numeric <= '301'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes.drg_code)::numeric = '652'::numeric) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '656'::numeric) AND ((drgcodes.drg_code)::numeric <= '661'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '673'::numeric) AND ((drgcodes.drg_code)::numeric <= '675'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '682'::numeric) AND ((drgcodes.drg_code)::numeric <= '700'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN (((drgcodes.drg_code)::numeric >= '20'::numeric) AND ((drgcodes.drg_code)::numeric <= '42'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '52'::numeric) AND ((drgcodes.drg_code)::numeric <= '103'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN (((drgcodes.drg_code)::numeric >= '20'::numeric) AND ((drgcodes.drg_code)::numeric <= '22'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '34'::numeric) AND ((drgcodes.drg_code)::numeric <= '39'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '64'::numeric) AND ((drgcodes.drg_code)::numeric <= '72'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN (((drgcodes.drg_code)::numeric >= '190'::numeric) AND ((drgcodes.drg_code)::numeric <= '192'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '202'::numeric) AND ((drgcodes.drg_code)::numeric <= '203'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN (((drgcodes.drg_code)::numeric >= '637'::numeric) AND ((drgcodes.drg_code)::numeric <= '639'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN (((drgcodes.drg_code)::numeric >= '625'::numeric) AND ((drgcodes.drg_code)::numeric <= '627'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '643'::numeric) AND ((drgcodes.drg_code)::numeric <= '645'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes.drg_code)::numeric = '652'::numeric) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '682'::numeric) AND ((drgcodes.drg_code)::numeric <= '685'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN (((drgcodes.drg_code)::numeric >= '420'::numeric) AND ((drgcodes.drg_code)::numeric <= '425'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '432'::numeric) AND ((drgcodes.drg_code)::numeric <= '434'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '441'::numeric) AND ((drgcodes.drg_code)::numeric <= '446'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN (((drgcodes.drg_code)::numeric >= '377'::numeric) AND ((drgcodes.drg_code)::numeric <= '384'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN (((drgcodes.drg_code)::numeric >= '969'::numeric) AND ((drgcodes.drg_code)::numeric <= '970'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '974'::numeric) AND ((drgcodes.drg_code)::numeric <= '977'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN (((drgcodes.drg_code)::numeric >= '820'::numeric) AND ((drgcodes.drg_code)::numeric <= '830'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '834'::numeric) AND ((drgcodes.drg_code)::numeric <= '849'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes.drg_code)::numeric = '54'::numeric) THEN 1 WHEN ((drgcodes.drg_code)::numeric = '55'::numeric) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '146'::numeric) AND ((drgcodes.drg_code)::numeric <= '148'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '180'::numeric) AND ((drgcodes.drg_code)::numeric <= '182'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '374'::numeric) AND ((drgcodes.drg_code)::numeric <= '376'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '435'::numeric) AND ((drgcodes.drg_code)::numeric <= '437'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '542'::numeric) AND ((drgcodes.drg_code)::numeric <= '544'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '582'::numeric) AND ((drgcodes.drg_code)::numeric <= '585'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '597'::numeric) AND ((drgcodes.drg_code)::numeric <= '599'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '656'::numeric) AND ((drgcodes.drg_code)::numeric <= '658'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '686'::numeric) AND ((drgcodes.drg_code)::numeric <= '688'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '715'::numeric) AND ((drgcodes.drg_code)::numeric <= '716'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '722'::numeric) AND ((drgcodes.drg_code)::numeric <= '724'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '736'::numeric) AND ((drgcodes.drg_code)::numeric <= '741'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '754'::numeric) AND ((drgcodes.drg_code)::numeric <= '756'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '826'::numeric) AND ((drgcodes.drg_code)::numeric <= '830'::numeric)) THEN 1 WHEN (((drgcodes.drg_code)::numeric >= '843'::numeric) AND ((drgcodes.drg_code)::numeric <= '849'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN (((drgcodes.drg_code)::numeric >= '545'::numeric) AND ((drgcodes.drg_code)::numeric <= '547'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN (((drgcodes.drg_code)::numeric >= '640'::numeric) AND ((drgcodes.drg_code)::numeric <= '641'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN (((drgcodes.drg_code)::numeric >= '808'::numeric) AND ((drgcodes.drg_code)::numeric <= '812'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN (((drgcodes.drg_code)::numeric >= '894'::numeric) AND ((drgcodes.drg_code)::numeric <= '897'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes.drg_code)::numeric = '813'::numeric) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes.drg_code)::numeric = '77'::numeric) THEN 1 WHEN ((drgcodes.drg_code)::numeric = '78'::numeric) THEN 1 WHEN ((drgcodes.drg_code)::numeric = '304'::numeric) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes.drg_code)::numeric = '79'::numeric) THEN 1 WHEN ((drgcodes.drg_code)::numeric = '305'::numeric) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes.drg_code)::numeric = '885'::numeric) THEN 1 ELSE 0 END",
                        "CASE WHEN (((drgcodes.drg_code)::numeric >= '619'::numeric) AND ((drgcodes.drg_code)::numeric <= '621'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes.drg_code)::numeric = '881'::numeric) THEN 1 ELSE 0 END"
                    ],
                    "Filter": "((drgcodes.drg_type)::text = 'MS'::text)"
                },
                {
                    "Node Type": "Seq Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE hcfadrg",
                    "Parallel Aware": false,
                    "Relation Name": "drgcodes",
                    "Schema": "mimiciii_clinical",
                    "Alias": "drgcodes_1",
                    "Output": [
                        "drgcodes_1.hadm_id",
                        "CASE WHEN (((drgcodes_1.drg_code)::numeric >= '103'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '112'::numeric)) THEN 1 WHEN (((drgcodes_1.drg_code)::numeric >= '115'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '118'::numeric)) THEN 1 WHEN (((drgcodes_1.drg_code)::numeric >= '121'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '127'::numeric)) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '129'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '132'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '133'::numeric) THEN 1 WHEN (((drgcodes_1.drg_code)::numeric >= '135'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '143'::numeric)) THEN 1 WHEN (((drgcodes_1.drg_code)::numeric >= '514'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '518'::numeric)) THEN 1 WHEN (((drgcodes_1.drg_code)::numeric >= '525'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '527'::numeric)) THEN 1 WHEN (((drgcodes_1.drg_code)::numeric >= '535'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '536'::numeric)) THEN 1 WHEN (((drgcodes_1.drg_code)::numeric >= '547'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '550'::numeric)) THEN 1 WHEN (((drgcodes_1.drg_code)::numeric >= '551'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '558'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes_1.drg_code)::numeric = '130'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '131'::numeric) THEN 1 ELSE 0 END",
                        "CASE WHEN (((drgcodes_1.drg_code)::numeric >= '302'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '305'::numeric)) THEN 1 WHEN (((drgcodes_1.drg_code)::numeric >= '315'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '333'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN (((drgcodes_1.drg_code)::numeric >= '1'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '35'::numeric)) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '524'::numeric) THEN 1 WHEN (((drgcodes_1.drg_code)::numeric >= '528'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '534'::numeric)) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '543'::numeric) THEN 1 WHEN (((drgcodes_1.drg_code)::numeric >= '559'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '564'::numeric)) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '577'::numeric) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes_1.drg_code)::numeric = '5'::numeric) THEN 1 WHEN (((drgcodes_1.drg_code)::numeric >= '14'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '17'::numeric)) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '524'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '528'::numeric) THEN 1 WHEN (((drgcodes_1.drg_code)::numeric >= '533'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '534'::numeric)) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '577'::numeric) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes_1.drg_code)::numeric = '88'::numeric) THEN 1 WHEN (((drgcodes_1.drg_code)::numeric >= '96'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '98'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes_1.drg_code)::numeric = '294'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '295'::numeric) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes_1.drg_code)::numeric = '290'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '300'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '301'::numeric) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes_1.drg_code)::numeric = '302'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '316'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '317'::numeric) THEN 1 ELSE 0 END",
                        "CASE WHEN (((drgcodes_1.drg_code)::numeric >= '199'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '202'::numeric)) THEN 1 WHEN (((drgcodes_1.drg_code)::numeric >= '205'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '208'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN (((drgcodes_1.drg_code)::numeric >= '174'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '178'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes_1.drg_code)::numeric = '488'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '489'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '490'::numeric) THEN 1 ELSE 0 END",
                        "CASE WHEN (((drgcodes_1.drg_code)::numeric >= '400'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '414'::numeric)) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '473'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '492'::numeric) THEN 1 WHEN (((drgcodes_1.drg_code)::numeric >= '539'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '540'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes_1.drg_code)::numeric = '10'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '11'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '64'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '82'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '172'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '173'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '199'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '203'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '239'::numeric) THEN 1 WHEN (((drgcodes_1.drg_code)::numeric >= '257'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '260'::numeric)) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '274'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '275'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '303'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '318'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '319'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '338'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '344'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '346'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '347'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '354'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '355'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '357'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '363'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '366'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '367'::numeric) THEN 1 WHEN (((drgcodes_1.drg_code)::numeric >= '406'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '414'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes_1.drg_code)::numeric = '240'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '241'::numeric) THEN 1 ELSE 0 END",
                        "CASE WHEN (((drgcodes_1.drg_code)::numeric >= '296'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '298'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes_1.drg_code)::numeric = '395'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '396'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '574'::numeric) THEN 1 ELSE 0 END",
                        "CASE WHEN (((drgcodes_1.drg_code)::numeric >= '433'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '437'::numeric)) THEN 1 WHEN (((drgcodes_1.drg_code)::numeric >= '521'::numeric) AND ((drgcodes_1.drg_code)::numeric <= '523'::numeric)) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes_1.drg_code)::numeric = '397'::numeric) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes_1.drg_code)::numeric = '22'::numeric) THEN 1 WHEN ((drgcodes_1.drg_code)::numeric = '134'::numeric) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes_1.drg_code)::numeric = '134'::numeric) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes_1.drg_code)::numeric = '430'::numeric) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes_1.drg_code)::numeric = '288'::numeric) THEN 1 ELSE 0 END",
                        "CASE WHEN ((drgcodes_1.drg_code)::numeric = '426'::numeric) THEN 1 ELSE 0 END"
                    ],
                    "Filter": "((drgcodes_1.drg_type)::text = 'HCFA'::text)"
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE drggrp",
                    "Parallel Aware": false,
                    "Output": [
                        "d1.hadm_id",
                        "max(d1.carddrg)",
                        "max(d1.peridrg)",
                        "max(d1.renaldrg)",
                        "max(d1.nervdrg)",
                        "max(d1.ceredrg)",
                        "max(d1.pulmdrg)",
                        "max(d1.diabdrg)",
                        "max(d1.hypodrg)",
                        "max(d1.renfdrg)",
                        "max(d1.liverdrg)",
                        "max(d1.ulcedrg)",
                        "max(d1.hivdrg)",
                        "max(d1.leukdrg)",
                        "max(d1.cancdrg)",
                        "max(d1.arthdrg)",
                        "max(d1.nutrdrg)",
                        "max(d1.anemdrg)",
                        "max(d1.alcdrg)",
                        "max(d1.coagdrg)",
                        "max(d1.htncxdrg)",
                        "max(d1.htndrg)",
                        "max(d1.psydrg)",
                        "max(d1.obesedrg)",
                        "max(d1.deprsdrg)"
                    ],
                    "Group Key": [
                        "d1.hadm_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Unique",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "d1.hadm_id",
                                "d1.carddrg",
                                "d1.peridrg",
                                "d1.renaldrg",
                                "d1.nervdrg",
                                "d1.ceredrg",
                                "d1.pulmdrg",
                                "d1.diabdrg",
                                "d1.hypodrg",
                                "d1.renfdrg",
                                "d1.liverdrg",
                                "d1.ulcedrg",
                                "d1.hivdrg",
                                "d1.leukdrg",
                                "d1.cancdrg",
                                "d1.arthdrg",
                                "d1.nutrdrg",
                                "d1.anemdrg",
                                "d1.alcdrg",
                                "d1.coagdrg",
                                "d1.htncxdrg",
                                "d1.htndrg",
                                "d1.psydrg",
                                "d1.obesedrg",
                                "d1.deprsdrg"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "d1.hadm_id",
                                        "d1.carddrg",
                                        "d1.peridrg",
                                        "d1.renaldrg",
                                        "d1.nervdrg",
                                        "d1.ceredrg",
                                        "d1.pulmdrg",
                                        "d1.diabdrg",
                                        "d1.hypodrg",
                                        "d1.renfdrg",
                                        "d1.liverdrg",
                                        "d1.ulcedrg",
                                        "d1.hivdrg",
                                        "d1.leukdrg",
                                        "d1.cancdrg",
                                        "d1.arthdrg",
                                        "d1.nutrdrg",
                                        "d1.anemdrg",
                                        "d1.alcdrg",
                                        "d1.coagdrg",
                                        "d1.htncxdrg",
                                        "d1.htndrg",
                                        "d1.psydrg",
                                        "d1.obesedrg",
                                        "d1.deprsdrg"
                                    ],
                                    "Sort Key": [
                                        "d1.hadm_id",
                                        "d1.carddrg",
                                        "d1.peridrg",
                                        "d1.renaldrg",
                                        "d1.nervdrg",
                                        "d1.ceredrg",
                                        "d1.pulmdrg",
                                        "d1.diabdrg",
                                        "d1.hypodrg",
                                        "d1.renfdrg",
                                        "d1.liverdrg",
                                        "d1.ulcedrg",
                                        "d1.hivdrg",
                                        "d1.leukdrg",
                                        "d1.cancdrg",
                                        "d1.arthdrg",
                                        "d1.nutrdrg",
                                        "d1.anemdrg",
                                        "d1.alcdrg",
                                        "d1.coagdrg",
                                        "d1.htncxdrg",
                                        "d1.htndrg",
                                        "d1.psydrg",
                                        "d1.obesedrg",
                                        "d1.deprsdrg"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Append",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "msdrg",
                                                    "Alias": "d1",
                                                    "Output": [
                                                        "d1.hadm_id",
                                                        "d1.carddrg",
                                                        "d1.peridrg",
                                                        "d1.renaldrg",
                                                        "d1.nervdrg",
                                                        "d1.ceredrg",
                                                        "d1.pulmdrg",
                                                        "d1.diabdrg",
                                                        "d1.hypodrg",
                                                        "d1.renfdrg",
                                                        "d1.liverdrg",
                                                        "d1.ulcedrg",
                                                        "d1.hivdrg",
                                                        "d1.leukdrg",
                                                        "d1.cancdrg",
                                                        "d1.arthdrg",
                                                        "d1.nutrdrg",
                                                        "d1.anemdrg",
                                                        "d1.alcdrg",
                                                        "d1.coagdrg",
                                                        "d1.htncxdrg",
                                                        "d1.htndrg",
                                                        "d1.psydrg",
                                                        "d1.obesedrg",
                                                        "d1.deprsdrg"
                                                    ]
                                                },
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "hcfadrg",
                                                    "Alias": "d1_1",
                                                    "Output": [
                                                        "d1_1.hadm_id",
                                                        "d1_1.carddrg",
                                                        "d1_1.peridrg",
                                                        "d1_1.renaldrg",
                                                        "d1_1.nervdrg",
                                                        "d1_1.ceredrg",
                                                        "d1_1.pulmdrg",
                                                        "d1_1.diabdrg",
                                                        "d1_1.hypodrg",
                                                        "d1_1.renfdrg",
                                                        "d1_1.liverdrg",
                                                        "d1_1.ulcedrg",
                                                        "d1_1.hivdrg",
                                                        "d1_1.leukdrg",
                                                        "d1_1.cancdrg",
                                                        "d1_1.arthdrg",
                                                        "d1_1.nutrdrg",
                                                        "d1_1.anemdrg",
                                                        "d1_1.alcdrg",
                                                        "d1_1.coagdrg",
                                                        "d1_1.htncxdrg",
                                                        "d1_1.htndrg",
                                                        "d1_1.psydrg",
                                                        "d1_1.obesedrg",
                                                        "d1_1.deprsdrg"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "adm.subject_id",
                        "adm.hadm_id",
                        "eli.chf",
                        "eli.htnwchf",
                        "eli.hhrwchf",
                        "eli.hhrwhrf",
                        "eli.arythm",
                        "eli.valve",
                        "eli.pulmcirc",
                        "eli.perivasc",
                        "eli.htn",
                        "eli.htncx",
                        "eli.htnpreg",
                        "eli.htnwochf",
                        "eli.hrenworf",
                        "eli.hrenwrf",
                        "eli.hhrwohrf",
                        "eli.hhrwrf",
                        "eli.ohtnpreg",
                        "eli.para",
                        "eli.neuro",
                        "eli.chrnlung",
                        "eli.dmcx",
                        "eli.dm",
                        "eli.hypothy",
                        "eli.renlfail",
                        "eli.liver",
                        "eli.ulcer",
                        "eli.aids",
                        "eli.lymph",
                        "eli.mets",
                        "eli.tumor",
                        "eli.arth",
                        "eli.coag",
                        "eli.obese",
                        "eli.wghtloss",
                        "eli.lytes",
                        "eli.bldloss",
                        "eli.anemdef",
                        "eli.alcohol",
                        "eli.drug",
                        "eli.psych",
                        "eli.depress"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "(adm.hadm_id = eli.hadm_id)",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "adm.subject_id",
                                "adm.hadm_id"
                            ],
                            "Sort Key": [
                                "adm.hadm_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "admissions",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "adm",
                                    "Output": [
                                        "adm.subject_id",
                                        "adm.hadm_id"
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "eli.chf",
                                "eli.htnwchf",
                                "eli.hhrwchf",
                                "eli.hhrwhrf",
                                "eli.arythm",
                                "eli.valve",
                                "eli.pulmcirc",
                                "eli.perivasc",
                                "eli.htn",
                                "eli.htncx",
                                "eli.htnpreg",
                                "eli.htnwochf",
                                "eli.hrenworf",
                                "eli.hrenwrf",
                                "eli.hhrwohrf",
                                "eli.hhrwrf",
                                "eli.ohtnpreg",
                                "eli.para",
                                "eli.neuro",
                                "eli.chrnlung",
                                "eli.dmcx",
                                "eli.dm",
                                "eli.hypothy",
                                "eli.renlfail",
                                "eli.liver",
                                "eli.ulcer",
                                "eli.aids",
                                "eli.lymph",
                                "eli.mets",
                                "eli.tumor",
                                "eli.arth",
                                "eli.coag",
                                "eli.obese",
                                "eli.wghtloss",
                                "eli.lytes",
                                "eli.bldloss",
                                "eli.anemdef",
                                "eli.alcohol",
                                "eli.drug",
                                "eli.psych",
                                "eli.depress",
                                "eli.hadm_id"
                            ],
                            "Sort Key": [
                                "eli.hadm_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "eligrp",
                                    "Alias": "eli",
                                    "Output": [
                                        "eli.chf",
                                        "eli.htnwchf",
                                        "eli.hhrwchf",
                                        "eli.hhrwhrf",
                                        "eli.arythm",
                                        "eli.valve",
                                        "eli.pulmcirc",
                                        "eli.perivasc",
                                        "eli.htn",
                                        "eli.htncx",
                                        "eli.htnpreg",
                                        "eli.htnwochf",
                                        "eli.hrenworf",
                                        "eli.hrenwrf",
                                        "eli.hhrwohrf",
                                        "eli.hhrwrf",
                                        "eli.ohtnpreg",
                                        "eli.para",
                                        "eli.neuro",
                                        "eli.chrnlung",
                                        "eli.dmcx",
                                        "eli.dm",
                                        "eli.hypothy",
                                        "eli.renlfail",
                                        "eli.liver",
                                        "eli.ulcer",
                                        "eli.aids",
                                        "eli.lymph",
                                        "eli.mets",
                                        "eli.tumor",
                                        "eli.arth",
                                        "eli.coag",
                                        "eli.obese",
                                        "eli.wghtloss",
                                        "eli.lytes",
                                        "eli.bldloss",
                                        "eli.anemdef",
                                        "eli.alcohol",
                                        "eli.drug",
                                        "eli.psych",
                                        "eli.depress",
                                        "eli.hadm_id"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Sort",
                    "Parent Relationship": "Inner",
                    "Parallel Aware": false,
                    "Output": [
                        "d.carddrg",
                        "d.pulmdrg",
                        "d.peridrg",
                        "d.htndrg",
                        "d.htncxdrg",
                        "d.renaldrg",
                        "d.ceredrg",
                        "d.nervdrg",
                        "d.diabdrg",
                        "d.hypodrg",
                        "d.liverdrg",
                        "d.ulcedrg",
                        "d.hivdrg",
                        "d.leukdrg",
                        "d.cancdrg",
                        "d.arthdrg",
                        "d.coagdrg",
                        "d.nutrdrg",
                        "d.obesedrg",
                        "d.anemdrg",
                        "d.alcdrg",
                        "d.psydrg",
                        "d.deprsdrg",
                        "d.hadm_id"
                    ],
                    "Sort Key": [
                        "d.hadm_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "drggrp",
                            "Alias": "d",
                            "Output": [
                                "d.carddrg",
                                "d.pulmdrg",
                                "d.peridrg",
                                "d.htndrg",
                                "d.htncxdrg",
                                "d.renaldrg",
                                "d.ceredrg",
                                "d.nervdrg",
                                "d.diabdrg",
                                "d.hypodrg",
                                "d.liverdrg",
                                "d.ulcedrg",
                                "d.hivdrg",
                                "d.leukdrg",
                                "d.cancdrg",
                                "d.arthdrg",
                                "d.coagdrg",
                                "d.nutrdrg",
                                "d.obesedrg",
                                "d.anemdrg",
                                "d.alcdrg",
                                "d.psydrg",
                                "d.deprsdrg",
                                "d.hadm_id"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.elixhauser_ahrq_v37_no_drg": {
        "sql": "-- This code uses the latest version of Elixhauser provided by AHRQ\n-- However, it does *not* filter based on diagnosis related groups (DRGs)\n-- As such, \"comorbidities\" identified are more likely to be associated with the primary reason for their hospital stay\n\n-- The code:\n--  removes \"primary\" ICD9_CODE (seq_num != 1)\n--  uses AHRQ published rules to define comorbidities\n \n\nwith\neliflg as\n(\nselect hadm_id, seq_num, icd9_code\n-- note that these codes will seem incomplete at first\n-- for example, CHF is missing a lot of codes referenced in the literature (402.11, 402.91, etc)\n-- these codes are captured by hypertension flags instead\n-- later there are some complicated rules which confirm/reject those codes as chf\n, CASE\n  when icd9_code = '39891' then 1\n  when icd9_code between '4280' and '4289' then 1\n\t\tend as chf       /* Congestive heart failure */\n\n-- cardiac arrhythmias is removed in up to date versions\n, case\n    when icd9_code = '42610' then 1\n    when icd9_code = '42611' then 1\n    when icd9_code = '42613' then 1\n    when icd9_code between '4262' and '42653' then 1\n    when icd9_code between '4266' and '42689' then 1\n    when icd9_code = '4270' then 1\n    when icd9_code = '4272' then 1\n    when icd9_code = '42731' then 1\n    when icd9_code = '42760' then 1\n    when icd9_code = '4279' then 1\n    when icd9_code = '7850' then 1\n    when icd9_code between 'V450' and 'V4509' then 1\n    when icd9_code between 'V533' and 'V5339' then 1\n  end as arythm /* Cardiac arrhythmias */\n\n, CASE\n  when icd9_code between '09320' and '09324' then 1\n  when icd9_code between '3940' and '3971' then 1\n  when icd9_code = '3979' then 1\n  when icd9_code between '4240' and '42499' then 1\n  when icd9_code between '7463' and '7466' then 1\n  when icd9_code = 'V422' then 1\n  when icd9_code = 'V433' then 1\n\t\tend as valve     /* Valvular disease */\n\n, CASE\n  when icd9_code between '41511' and '41519' then 1\n  when icd9_code between '4160' and '4169' then 1\n  when icd9_code = '4179' then 1\n\t\tend as pulmcirc  /* Pulmonary circulation disorder */\n\n, CASE\n  when icd9_code between '4400' and '4409' then 1\n  when icd9_code between '44100' and '4419' then 1\n  when icd9_code between '4420' and '4429' then 1\n  when icd9_code between '4431' and '4439' then 1\n  when icd9_code between '44421' and '44422' then 1\n  when icd9_code = '4471' then 1\n  when icd9_code = '449' then 1\n  when icd9_code = '5571' then 1\n  when icd9_code = '5579' then 1\n  when icd9_code = 'V434' then 1\n\t\tend as perivasc  /* Peripheral vascular disorder */\n\n, CASE\n  when icd9_code = '4011' then 1\n  when icd9_code = '4019' then 1\n  when icd9_code between '64200' and '64204' then 1\n\t\tend as htn       /* Hypertension, uncomplicated */\n\n, CASE\n  when icd9_code = '4010' then 1\n  when icd9_code = '4372' then 1\n\t\tend as htncx     /* Hypertension, complicated */\n\n\n      /******************************************************************/\n      /* The following are special, temporary formats used in the       */\n      /* creation of the hypertension complicated comorbidity when      */\n      /* overlapping with congestive heart failure or renal failure     */\n      /* occurs. These temporary formats are referenced in the program  */\n      /* called comoanaly2009.txt.                                      */\n      /******************************************************************/\n, CASE\n  when icd9_code between '64220' and '64224' then 1\n\t\tend as htnpreg   /* Pre-existing hypertension complicating pregnancy */\n\n, CASE\n  when icd9_code = '40200' then 1\n  when icd9_code = '40210' then 1\n  when icd9_code = '40290' then 1\n  when icd9_code = '40509' then 1\n  when icd9_code = '40519' then 1\n  when icd9_code = '40599'         then 1\n\t\tend as htnwochf  /* Hypertensive heart disease without heart failure */\n\n, CASE\n  when icd9_code = '40201' then 1\n  when icd9_code = '40211' then 1\n  when icd9_code = '40291'         then 1\n\t\tend as htnwchf   /* Hypertensive heart disease with heart failure */\n\n, CASE\n  when icd9_code = '40300' then 1\n  when icd9_code = '40310' then 1\n  when icd9_code = '40390' then 1\n  when icd9_code = '40501' then 1\n  when icd9_code = '40511' then 1\n  when icd9_code = '40591' then 1\n  when icd9_code between '64210' and '64214' then 1\n\t\tend as hrenworf  /* Hypertensive renal disease without renal failure */\n\n, CASE\n  when icd9_code = '40301' then 1\n  when icd9_code = '40311' then 1\n  when icd9_code = '40391'         then 1\n\t\tend as hrenwrf   /* Hypertensive renal disease with renal failure */\n\n, CASE\n  when icd9_code = '40400' then 1\n  when icd9_code = '40410' then 1\n  when icd9_code = '40490'         then 1\n\t\tend as hhrwohrf  /* Hypertensive heart and renal disease without heart or renal failure */\n\n, CASE\n  when icd9_code = '40401' then 1\n  when icd9_code = '40411' then 1\n  when icd9_code = '40491'         then 1\n\t\tend as hhrwchf   /* Hypertensive heart and renal disease with heart failure */\n\n, CASE\n  when icd9_code = '40402' then 1\n  when icd9_code = '40412' then 1\n  when icd9_code = '40492'         then 1\n\t\tend as hhrwrf    /* Hypertensive heart and renal disease with renal failure */\n\n, CASE\n  when icd9_code = '40403' then 1\n  when icd9_code = '40413' then 1\n  when icd9_code = '40493'         then 1\n\t\tend as hhrwhrf   /* Hypertensive heart and renal disease with heart and renal failure */\n\n, CASE\n  when icd9_code between '64270' and '64274' then 1\n  when icd9_code between '64290' and '64294' then 1\n\t\tend as ohtnpreg  /* Other hypertension in pregnancy */\n\n      /******************** End Temporary Formats ***********************/\n\n, CASE\n  when icd9_code between '3420' and '3449' then 1\n  when icd9_code between '43820' and '43853' then 1\n  when icd9_code = '78072'         then 1\n\t\tend as para      /* Paralysis */\n\n, CASE\n  when icd9_code between '3300' and '3319' then 1\n  when icd9_code = '3320' then 1\n  when icd9_code = '3334' then 1\n  when icd9_code = '3335' then 1\n  when icd9_code = '3337' then 1\n  when icd9_code in ('33371','33372','33379','33385','33394') then 1\n  when icd9_code between '3340' and '3359' then 1\n  when icd9_code = '3380' then 1\n  when icd9_code = '340' then 1\n  when icd9_code between '3411' and '3419' then 1\n  when icd9_code between '34500' and '34511' then 1\n  when icd9_code between '3452' and '3453' then 1\n  when icd9_code between '34540' and '34591' then 1\n  when icd9_code between '34700' and '34701' then 1\n  when icd9_code between '34710' and '34711' then 1\n  when icd9_code = '3483' then 1 -- discontinued icd-9\n  when icd9_code between '64940' and '64944' then 1\n  when icd9_code = '7687' then 1\n  when icd9_code between '76870' and '76873' then 1\n  when icd9_code = '7803' then 1\n  when icd9_code = '78031' then 1\n  when icd9_code = '78032' then 1\n  when icd9_code = '78033' then 1\n  when icd9_code = '78039' then 1\n  when icd9_code = '78097' then 1\n  when icd9_code = '7843'         then 1\n\t\tend as neuro     /* Other neurological */\n\n, CASE\n  when icd9_code between '490' and '4928' then 1\n  when icd9_code between '49300' and '49392' then 1\n  when icd9_code between '494' and '4941' then 1\n  when icd9_code between '4950' and '505' then 1\n  when icd9_code = '5064'         then 1\n\t\tend as chrnlung  /* Chronic pulmonary disease */\n\n, CASE\n  when icd9_code between '25000' and '25033' then 1\n  when icd9_code between '64800' and '64804' then 1\n  when icd9_code between '24900' and '24931' then 1\n\t\tend as dm        /* Diabetes w/o chronic complications*/\n\n, CASE\n  when icd9_code between '25040' and '25093' then 1\n  when icd9_code = '7751' then 1\n  when icd9_code between '24940' and '24991' then 1\n\t\tend as dmcx      /* Diabetes w/ chronic complications */\n\n, CASE\n  when icd9_code between '243' and '2442' then 1\n  when icd9_code = '2448' then 1\n  when icd9_code = '2449'         then 1\n\t\tend as hypothy   /* Hypothyroidism */\n\n, CASE\n  when icd9_code = '585' then 1 -- discontinued code\n  when icd9_code = '5853' then 1\n  when icd9_code = '5854' then 1\n  when icd9_code = '5855' then 1\n  when icd9_code = '5856' then 1\n  when icd9_code = '5859' then 1\n  when icd9_code = '586' then 1\n  when icd9_code = 'V420' then 1\n  when icd9_code = 'V451' then 1\n  when icd9_code between 'V560' and 'V5632' then 1\n  when icd9_code = 'V568' then 1\n  when icd9_code between 'V4511' and 'V4512' then 1\n\t\tend as renlfail  /* Renal failure */\n\n, CASE\n  when icd9_code = '07022' then 1\n  when icd9_code = '07023' then 1\n  when icd9_code = '07032' then 1\n  when icd9_code = '07033' then 1\n  when icd9_code = '07044' then 1\n  when icd9_code = '07054' then 1\n  when icd9_code = '4560' then 1\n  when icd9_code = '4561' then 1\n  when icd9_code = '45620' then 1\n  when icd9_code = '45621' then 1\n  when icd9_code = '5710' then 1\n  when icd9_code = '5712' then 1\n  when icd9_code = '5713' then 1\n  when icd9_code between '57140' and '57149' then 1\n  when icd9_code = '5715' then 1\n  when icd9_code = '5716' then 1\n  when icd9_code = '5718' then 1\n  when icd9_code = '5719' then 1\n  when icd9_code = '5723' then 1\n  when icd9_code = '5728' then 1\n  when icd9_code = '5735' then 1\n  when icd9_code = 'V427'         then 1\n\t\tend as liver     /* Liver disease */\n\n, CASE\n  when icd9_code = '53141' then 1\n  when icd9_code = '53151' then 1\n  when icd9_code = '53161' then 1\n  when icd9_code = '53170' then 1\n  when icd9_code = '53171' then 1\n  when icd9_code = '53191' then 1\n  when icd9_code = '53241' then 1\n  when icd9_code = '53251' then 1\n  when icd9_code = '53261' then 1\n  when icd9_code = '53270' then 1\n  when icd9_code = '53271' then 1\n  when icd9_code = '53291' then 1\n  when icd9_code = '53341' then 1\n  when icd9_code = '53351' then 1\n  when icd9_code = '53361' then 1\n  when icd9_code = '53370' then 1\n  when icd9_code = '53371' then 1\n  when icd9_code = '53391' then 1\n  when icd9_code = '53441' then 1\n  when icd9_code = '53451' then 1\n  when icd9_code = '53461' then 1\n  when icd9_code = '53470' then 1\n  when icd9_code = '53471' then 1\n  when icd9_code = '53491'         then 1\n\t\tend as ulcer     /* Chronic Peptic ulcer disease (includes bleeding only if obstruction is also present) */\n\n, CASE\n  when icd9_code between '042' and '0449' then 1\n\t\tend as aids      /* HIV and AIDS */\n\n, CASE\n  when icd9_code between '20000' and '20238' then 1\n  when icd9_code between '20250' and '20301' then 1\n  when icd9_code = '2386' then 1\n  when icd9_code = '2733' then 1\n  when icd9_code between '20302' and '20382' then 1\n\t\tend as lymph     /* Lymphoma */\n\n, CASE\n  when icd9_code between '1960' and '1991' then 1\n  when icd9_code between '20970' and '20975' then 1\n  when icd9_code = '20979' then 1\n  when icd9_code = '78951'         then 1\n\t\tend as mets      /* Metastatic cancer */\n\n, CASE\n  when icd9_code between '1400' and '1729' then 1\n  when icd9_code between '1740' and '1759' then 1\n  when icd9_code between '179' and '1958' then 1\n  when icd9_code between '20900' and '20924' then 1\n  when icd9_code between '20925' and '2093' then 1\n  when icd9_code between '20930' and '20936' then 1\n  when icd9_code between '25801' and '25803' then 1\n\t\tend as tumor     /* Solid tumor without metastasis */\n\n, CASE\n  when icd9_code = '7010' then 1\n  when icd9_code between '7100' and '7109' then 1\n  when icd9_code between '7140' and '7149' then 1\n  when icd9_code between '7200' and '7209' then 1\n  when icd9_code = '725' then 1\n\t\tend as arth              /* Rheumatoid arthritis/collagen vascular diseases */\n\n, CASE\n  when icd9_code between '2860' and '2869' then 1\n  when icd9_code = '2871' then 1\n  when icd9_code between '2873' and '2875' then 1\n  when icd9_code between '64930' and '64934' then 1\n  when icd9_code = '28984'         then 1\n\t\tend as coag      /* Coagulation deficiency */\n\n, CASE\n  when icd9_code = '2780' then 1\n  when icd9_code = '27800' then 1\n  when icd9_code = '27801' then 1\n  when icd9_code = '27803' then 1\n  when icd9_code between '64910' and '64914' then 1\n  when icd9_code between 'V8530' and 'V8539' then 1\n  when icd9_code = 'V854' then 1 -- hierarchy used for AHRQ v3.6 and earlier\n  when icd9_code between 'V8541' and 'V8545' then 1\n  when icd9_code = 'V8554' then 1\n  when icd9_code = '79391'         then 1\n\t\tend as obese     /* Obesity      */\n\n, CASE\n  when icd9_code between '260' and '2639' then 1\n  when icd9_code between '78321' and '78322' then 1\n\t\tend as wghtloss  /* Weight loss */\n\n, CASE\n  when icd9_code between '2760' and '2769' then 1\n\t\tend as lytes     /* Fluid and electrolyte disorders - note:\n                                      this comorbidity should be dropped when\n                                      used with the AHRQ Patient Safety Indicators*/\n, CASE\n  when icd9_code = '2800' then 1\n  when icd9_code between '64820' and '64824' then 1\n\t\tend as bldloss   /* Blood loss anemia */\n\n, CASE\n  when icd9_code between '2801' and '2819' then 1\n  when icd9_code between '28521' and '28529' then 1\n  when icd9_code = '2859'         then 1\n\t\tend as anemdef  /* Deficiency anemias */\n\n, CASE\n  when icd9_code between '2910' and '2913' then 1\n  when icd9_code = '2915' then 1\n  when icd9_code = '2918' then 1\n  when icd9_code = '29181' then 1\n  when icd9_code = '29182' then 1\n  when icd9_code = '29189' then 1\n  when icd9_code = '2919' then 1\n  when icd9_code between '30300' and '30393' then 1\n  when icd9_code between '30500' and '30503' then 1\n\t\tend as alcohol   /* Alcohol abuse */\n\n, CASE\n  when icd9_code = '2920' then 1\n  when icd9_code between '29282' and '29289' then 1\n  when icd9_code = '2929' then 1\n  when icd9_code between '30400' and '30493' then 1\n  when icd9_code between '30520' and '30593' then 1\n  when icd9_code between '64830' and '64834' then 1\n\t\tend as drug      /* Drug abuse */\n\n, CASE\n  when icd9_code between '29500' and '2989' then 1\n  when icd9_code = '29910' then 1\n  when icd9_code = '29911'         then 1\n\t\tend as psych    /* Psychoses */\n\n, CASE\n  when icd9_code = '3004' then 1\n  when icd9_code = '30112' then 1\n  when icd9_code = '3090' then 1\n  when icd9_code = '3091' then 1\n  when icd9_code = '311'         then 1\n\t\tend as depress  /* Depression */\nfrom diagnoses_icd icd\nWHERE seq_num = 1\n)\n-- collapse the icd9_code specific flags into hadm_id specific flags\n-- this groups comorbidities together for a single patient admission\n, eligrp as\n(\n  select hadm_id\n  , max(chf) as chf\n  , max(arythm) as arythm\n  , max(valve) as valve\n  , max(pulmcirc) as pulmcirc\n  , max(perivasc) as perivasc\n  , max(htn) as htn\n  , max(htncx) as htncx\n  , max(htnpreg) as htnpreg\n  , max(htnwochf) as htnwochf\n  , max(htnwchf) as htnwchf\n  , max(hrenworf) as hrenworf\n  , max(hrenwrf) as hrenwrf\n  , max(hhrwohrf) as hhrwohrf\n  , max(hhrwchf) as hhrwchf\n  , max(hhrwrf) as hhrwrf\n  , max(hhrwhrf) as hhrwhrf\n  , max(ohtnpreg) as ohtnpreg\n  , max(para) as para\n  , max(neuro) as neuro\n  , max(chrnlung) as chrnlung\n  , max(dm) as dm\n  , max(dmcx) as dmcx\n  , max(hypothy) as hypothy\n  , max(renlfail) as renlfail\n  , max(liver) as liver\n  , max(ulcer) as ulcer\n  , max(aids) as aids\n  , max(lymph) as lymph\n  , max(mets) as mets\n  , max(tumor) as tumor\n  , max(arth) as arth\n  , max(coag) as coag\n  , max(obese) as obese\n  , max(wghtloss) as wghtloss\n  , max(lytes) as lytes\n  , max(bldloss) as bldloss\n  , max(anemdef) as anemdef\n  , max(alcohol) as alcohol\n  , max(drug) as drug\n  , max(psych) as psych\n  , max(depress) as depress\nfrom eliflg\ngroup by hadm_id\n)\n-- now merge these flags together to define elixhauser\n-- most are straightforward.. but hypertension flags are a bit more complicated\nselect adm.subject_id, adm.hadm_id\n, case\n    when chf     = 1 then 1\n    when htnwchf = 1 then 1\n    when hhrwchf = 1 then 1\n    when hhrwhrf = 1 then 1\n  else 0 end as congestive_heart_failure\n, case\n    when arythm = 1 then 1\n  else 0 end as cardiac_arrhythmias\n, case when    valve = 1 then 1 else 0 end as valvular_disease\n, case when pulmcirc = 1 then 1 else 0 end as pulmonary_circulation\n, case when perivasc = 1 then 1 else 0 end as peripheral_vascular\n\n-- we combine \"htn\" and \"htncx\" into \"HYPERTENSION\"\n-- note \"htn\" (hypertension) is only 1 if \"htncx\" (complicated hypertension) is 0\n-- this matters if you filter on DRG but for this query we can just merge them immediately\n, case\n    when htn = 1 then 1\n    when htncx = 1 then 1\n    when htnpreg = 1 then 1\n    when htnwochf = 1 then 1\n    when htnwchf = 1 then 1\n    when hrenworf = 1 then 1\n    when hrenwrf = 1 then 1\n    when hhrwohrf = 1 then 1\n    when hhrwchf = 1 then 1\n    when hhrwrf = 1 then 1\n    when hhrwhrf = 1 then 1\n    when ohtnpreg = 1 then 1\n  else 0 end as hypertension\n\n, case when para      = 1 then 1 else 0 end as paralysis\n, case when neuro     = 1 then 1 else 0 end as other_neurological\n, case when chrnlung  = 1 then 1 else 0 end as chronic_pulmonary\n, case\n    -- only the more severe comorbidity (complicated diabetes) is kept\n    when dmcx = 1 then 0\n    when dm = 1 then 1\n  else 0 end as diabetes_uncomplicated\n, case when dmcx    = 1 then 1 else 0 end as diabetes_complicated\n, case when hypothy = 1 then 1 else 0 end as hypothyroidism\n, case\n    when renlfail = 1 then 1\n    when hrenwrf  = 1 then 1\n    when hhrwrf   = 1 then 1\n    when hhrwhrf  = 1 then 1\n  else 0 end as renal_failure\n\n, case when liver = 1 then 1 else 0 end as liver_disease\n, case when ulcer = 1 then 1 else 0 end as peptic_ulcer\n, case when aids = 1 then 1 else 0 end as aids\n, case when lymph = 1 then 1 else 0 end as lymphoma\n, case when mets = 1 then 1 else 0 end as metastatic_cancer\n, case\n    -- only the more severe comorbidity (metastatic cancer) is kept\n    when mets = 1 then 0\n    when tumor = 1 then 1\n  else 0 end as solid_tumor\n, case when arth = 1 then 1 else 0 end as rheumatoid_arthritis\n, case when coag = 1 then 1 else 0 end as coagulopathy\n, case when obese = 1 then 1 else 0 end as obesity\n, case when wghtloss = 1 then 1 else 0 end as weight_loss\n, case when lytes = 1 then 1 else 0 end as fluid_electrolyte\n, case when bldloss = 1 then 1 else 0 end as blood_loss_anemia\n, case when anemdef = 1 then 1 else 0 end as deficiency_anemias\n, case when alcohol = 1 then 1 else 0 end as alcohol_abuse\n, case when drug = 1 then 1 else 0 end as drug_abuse\n, case when psych = 1 then 1 else 0 end as psychoses\n, case when depress = 1 then 1 else 0 end as depression\n\nFROM admissions adm\nleft join eligrp eli\n  on adm.hadm_id = eli.hadm_id\norder by adm.hadm_id",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.diagnoses_icd"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "hadm_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "congestive_heart_failure": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "cardiac_arrhythmias": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "valvular_disease": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "pulmonary_circulation": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "peripheral_vascular": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "hypertension": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "paralysis": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "other_neurological": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "chronic_pulmonary": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "diabetes_uncomplicated": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "diabetes_complicated": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "hypothyroidism": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "renal_failure": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "liver_disease": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "peptic_ulcer": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "aids": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "lymphoma": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "metastatic_cancer": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "solid_tumor": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "rheumatoid_arthritis": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "coagulopathy": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "obesity": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "weight_loss": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "fluid_electrolyte": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "blood_loss_anemia": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "deficiency_anemias": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "alcohol_abuse": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "drug_abuse": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "psychoses": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "depression": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ]
        },
        "table_name": "mimiciii_clinical.elixhauser_ahrq_v37_no_drg",
        "plan": {
            "Node Type": "Merge Join",
            "Parallel Aware": false,
            "Join Type": "Left",
            "Output": [
                "adm.subject_id",
                "adm.hadm_id",
                "CASE WHEN (eli.chf = 1) THEN 1 WHEN (eli.htnwchf = 1) THEN 1 WHEN (eli.hhrwchf = 1) THEN 1 WHEN (eli.hhrwhrf = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.arythm = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.valve = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.pulmcirc = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.perivasc = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.htn = 1) THEN 1 WHEN (eli.htncx = 1) THEN 1 WHEN (eli.htnpreg = 1) THEN 1 WHEN (eli.htnwochf = 1) THEN 1 WHEN (eli.htnwchf = 1) THEN 1 WHEN (eli.hrenworf = 1) THEN 1 WHEN (eli.hrenwrf = 1) THEN 1 WHEN (eli.hhrwohrf = 1) THEN 1 WHEN (eli.hhrwchf = 1) THEN 1 WHEN (eli.hhrwrf = 1) THEN 1 WHEN (eli.hhrwhrf = 1) THEN 1 WHEN (eli.ohtnpreg = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.para = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.neuro = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.chrnlung = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.dmcx = 1) THEN 0 WHEN (eli.dm = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.dmcx = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.hypothy = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.renlfail = 1) THEN 1 WHEN (eli.hrenwrf = 1) THEN 1 WHEN (eli.hhrwrf = 1) THEN 1 WHEN (eli.hhrwhrf = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.liver = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.ulcer = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.aids = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.lymph = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.mets = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.mets = 1) THEN 0 WHEN (eli.tumor = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.arth = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.coag = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.obese = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.wghtloss = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.lytes = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.bldloss = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.anemdef = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.alcohol = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.drug = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.psych = 1) THEN 1 ELSE 0 END",
                "CASE WHEN (eli.depress = 1) THEN 1 ELSE 0 END"
            ],
            "Inner Unique": false,
            "Merge Cond": "(adm.hadm_id = eli.hadm_id)",
            "Plans": [
                {
                    "Node Type": "Seq Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE eliflg",
                    "Parallel Aware": false,
                    "Relation Name": "diagnoses_icd",
                    "Schema": "mimiciii_clinical",
                    "Alias": "icd",
                    "Output": [
                        "icd.hadm_id",
                        "icd.seq_num",
                        "icd.icd9_code",
                        "CASE WHEN ((icd.icd9_code)::text = '39891'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '4280'::text) AND ((icd.icd9_code)::text <= '4289'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '42610'::text) THEN 1 WHEN ((icd.icd9_code)::text = '42611'::text) THEN 1 WHEN ((icd.icd9_code)::text = '42613'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '4262'::text) AND ((icd.icd9_code)::text <= '42653'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '4266'::text) AND ((icd.icd9_code)::text <= '42689'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '4270'::text) THEN 1 WHEN ((icd.icd9_code)::text = '4272'::text) THEN 1 WHEN ((icd.icd9_code)::text = '42731'::text) THEN 1 WHEN ((icd.icd9_code)::text = '42760'::text) THEN 1 WHEN ((icd.icd9_code)::text = '4279'::text) THEN 1 WHEN ((icd.icd9_code)::text = '7850'::text) THEN 1 WHEN (((icd.icd9_code)::text >= 'V450'::text) AND ((icd.icd9_code)::text <= 'V4509'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= 'V533'::text) AND ((icd.icd9_code)::text <= 'V5339'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '09320'::text) AND ((icd.icd9_code)::text <= '09324'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '3940'::text) AND ((icd.icd9_code)::text <= '3971'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '3979'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '4240'::text) AND ((icd.icd9_code)::text <= '42499'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '7463'::text) AND ((icd.icd9_code)::text <= '7466'::text)) THEN 1 WHEN ((icd.icd9_code)::text = 'V422'::text) THEN 1 WHEN ((icd.icd9_code)::text = 'V433'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '41511'::text) AND ((icd.icd9_code)::text <= '41519'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '4160'::text) AND ((icd.icd9_code)::text <= '4169'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '4179'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '4400'::text) AND ((icd.icd9_code)::text <= '4409'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '44100'::text) AND ((icd.icd9_code)::text <= '4419'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '4420'::text) AND ((icd.icd9_code)::text <= '4429'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '4431'::text) AND ((icd.icd9_code)::text <= '4439'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '44421'::text) AND ((icd.icd9_code)::text <= '44422'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '4471'::text) THEN 1 WHEN ((icd.icd9_code)::text = '449'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5571'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5579'::text) THEN 1 WHEN ((icd.icd9_code)::text = 'V434'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '4011'::text) THEN 1 WHEN ((icd.icd9_code)::text = '4019'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '64200'::text) AND ((icd.icd9_code)::text <= '64204'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '4010'::text) THEN 1 WHEN ((icd.icd9_code)::text = '4372'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '64220'::text) AND ((icd.icd9_code)::text <= '64224'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '40200'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40210'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40290'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40509'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40519'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40599'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '40201'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40211'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40291'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '40300'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40310'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40390'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40501'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40511'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40591'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '64210'::text) AND ((icd.icd9_code)::text <= '64214'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '40301'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40311'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40391'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '40400'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40410'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40490'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '40401'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40411'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40491'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '40402'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40412'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40492'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '40403'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40413'::text) THEN 1 WHEN ((icd.icd9_code)::text = '40493'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '64270'::text) AND ((icd.icd9_code)::text <= '64274'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '64290'::text) AND ((icd.icd9_code)::text <= '64294'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '3420'::text) AND ((icd.icd9_code)::text <= '3449'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '43820'::text) AND ((icd.icd9_code)::text <= '43853'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '78072'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '3300'::text) AND ((icd.icd9_code)::text <= '3319'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '3320'::text) THEN 1 WHEN ((icd.icd9_code)::text = '3334'::text) THEN 1 WHEN ((icd.icd9_code)::text = '3335'::text) THEN 1 WHEN ((icd.icd9_code)::text = '3337'::text) THEN 1 WHEN ((icd.icd9_code)::text = ANY ('{33371,33372,33379,33385,33394}'::text[])) THEN 1 WHEN (((icd.icd9_code)::text >= '3340'::text) AND ((icd.icd9_code)::text <= '3359'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '3380'::text) THEN 1 WHEN ((icd.icd9_code)::text = '340'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '3411'::text) AND ((icd.icd9_code)::text <= '3419'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '34500'::text) AND ((icd.icd9_code)::text <= '34511'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '3452'::text) AND ((icd.icd9_code)::text <= '3453'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '34540'::text) AND ((icd.icd9_code)::text <= '34591'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '34700'::text) AND ((icd.icd9_code)::text <= '34701'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '34710'::text) AND ((icd.icd9_code)::text <= '34711'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '3483'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '64940'::text) AND ((icd.icd9_code)::text <= '64944'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '7687'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '76870'::text) AND ((icd.icd9_code)::text <= '76873'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '7803'::text) THEN 1 WHEN ((icd.icd9_code)::text = '78031'::text) THEN 1 WHEN ((icd.icd9_code)::text = '78032'::text) THEN 1 WHEN ((icd.icd9_code)::text = '78033'::text) THEN 1 WHEN ((icd.icd9_code)::text = '78039'::text) THEN 1 WHEN ((icd.icd9_code)::text = '78097'::text) THEN 1 WHEN ((icd.icd9_code)::text = '7843'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '490'::text) AND ((icd.icd9_code)::text <= '4928'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '49300'::text) AND ((icd.icd9_code)::text <= '49392'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '494'::text) AND ((icd.icd9_code)::text <= '4941'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '4950'::text) AND ((icd.icd9_code)::text <= '505'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '5064'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '25000'::text) AND ((icd.icd9_code)::text <= '25033'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '64800'::text) AND ((icd.icd9_code)::text <= '64804'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '24900'::text) AND ((icd.icd9_code)::text <= '24931'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '25040'::text) AND ((icd.icd9_code)::text <= '25093'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '7751'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '24940'::text) AND ((icd.icd9_code)::text <= '24991'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '243'::text) AND ((icd.icd9_code)::text <= '2442'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '2448'::text) THEN 1 WHEN ((icd.icd9_code)::text = '2449'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '585'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5853'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5854'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5855'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5856'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5859'::text) THEN 1 WHEN ((icd.icd9_code)::text = '586'::text) THEN 1 WHEN ((icd.icd9_code)::text = 'V420'::text) THEN 1 WHEN ((icd.icd9_code)::text = 'V451'::text) THEN 1 WHEN (((icd.icd9_code)::text >= 'V560'::text) AND ((icd.icd9_code)::text <= 'V5632'::text)) THEN 1 WHEN ((icd.icd9_code)::text = 'V568'::text) THEN 1 WHEN (((icd.icd9_code)::text >= 'V4511'::text) AND ((icd.icd9_code)::text <= 'V4512'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '07022'::text) THEN 1 WHEN ((icd.icd9_code)::text = '07023'::text) THEN 1 WHEN ((icd.icd9_code)::text = '07032'::text) THEN 1 WHEN ((icd.icd9_code)::text = '07033'::text) THEN 1 WHEN ((icd.icd9_code)::text = '07044'::text) THEN 1 WHEN ((icd.icd9_code)::text = '07054'::text) THEN 1 WHEN ((icd.icd9_code)::text = '4560'::text) THEN 1 WHEN ((icd.icd9_code)::text = '4561'::text) THEN 1 WHEN ((icd.icd9_code)::text = '45620'::text) THEN 1 WHEN ((icd.icd9_code)::text = '45621'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5710'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5712'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5713'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '57140'::text) AND ((icd.icd9_code)::text <= '57149'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '5715'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5716'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5718'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5719'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5723'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5728'::text) THEN 1 WHEN ((icd.icd9_code)::text = '5735'::text) THEN 1 WHEN ((icd.icd9_code)::text = 'V427'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '53141'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53151'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53161'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53170'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53171'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53191'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53241'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53251'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53261'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53270'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53271'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53291'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53341'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53351'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53361'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53370'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53371'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53391'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53441'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53451'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53461'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53470'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53471'::text) THEN 1 WHEN ((icd.icd9_code)::text = '53491'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '042'::text) AND ((icd.icd9_code)::text <= '0449'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '20000'::text) AND ((icd.icd9_code)::text <= '20238'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '20250'::text) AND ((icd.icd9_code)::text <= '20301'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '2386'::text) THEN 1 WHEN ((icd.icd9_code)::text = '2733'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '20302'::text) AND ((icd.icd9_code)::text <= '20382'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '1960'::text) AND ((icd.icd9_code)::text <= '1991'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '20970'::text) AND ((icd.icd9_code)::text <= '20975'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '20979'::text) THEN 1 WHEN ((icd.icd9_code)::text = '78951'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '1400'::text) AND ((icd.icd9_code)::text <= '1729'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '1740'::text) AND ((icd.icd9_code)::text <= '1759'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '179'::text) AND ((icd.icd9_code)::text <= '1958'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '20900'::text) AND ((icd.icd9_code)::text <= '20924'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '20925'::text) AND ((icd.icd9_code)::text <= '2093'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '20930'::text) AND ((icd.icd9_code)::text <= '20936'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '25801'::text) AND ((icd.icd9_code)::text <= '25803'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '7010'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '7100'::text) AND ((icd.icd9_code)::text <= '7109'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '7140'::text) AND ((icd.icd9_code)::text <= '7149'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '7200'::text) AND ((icd.icd9_code)::text <= '7209'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '725'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '2860'::text) AND ((icd.icd9_code)::text <= '2869'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '2871'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '2873'::text) AND ((icd.icd9_code)::text <= '2875'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '64930'::text) AND ((icd.icd9_code)::text <= '64934'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '28984'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '2780'::text) THEN 1 WHEN ((icd.icd9_code)::text = '27800'::text) THEN 1 WHEN ((icd.icd9_code)::text = '27801'::text) THEN 1 WHEN ((icd.icd9_code)::text = '27803'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '64910'::text) AND ((icd.icd9_code)::text <= '64914'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= 'V8530'::text) AND ((icd.icd9_code)::text <= 'V8539'::text)) THEN 1 WHEN ((icd.icd9_code)::text = 'V854'::text) THEN 1 WHEN (((icd.icd9_code)::text >= 'V8541'::text) AND ((icd.icd9_code)::text <= 'V8545'::text)) THEN 1 WHEN ((icd.icd9_code)::text = 'V8554'::text) THEN 1 WHEN ((icd.icd9_code)::text = '79391'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '260'::text) AND ((icd.icd9_code)::text <= '2639'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '78321'::text) AND ((icd.icd9_code)::text <= '78322'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '2760'::text) AND ((icd.icd9_code)::text <= '2769'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '2800'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '64820'::text) AND ((icd.icd9_code)::text <= '64824'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '2801'::text) AND ((icd.icd9_code)::text <= '2819'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '28521'::text) AND ((icd.icd9_code)::text <= '28529'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '2859'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '2910'::text) AND ((icd.icd9_code)::text <= '2913'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '2915'::text) THEN 1 WHEN ((icd.icd9_code)::text = '2918'::text) THEN 1 WHEN ((icd.icd9_code)::text = '29181'::text) THEN 1 WHEN ((icd.icd9_code)::text = '29182'::text) THEN 1 WHEN ((icd.icd9_code)::text = '29189'::text) THEN 1 WHEN ((icd.icd9_code)::text = '2919'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '30300'::text) AND ((icd.icd9_code)::text <= '30393'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '30500'::text) AND ((icd.icd9_code)::text <= '30503'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '2920'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '29282'::text) AND ((icd.icd9_code)::text <= '29289'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '2929'::text) THEN 1 WHEN (((icd.icd9_code)::text >= '30400'::text) AND ((icd.icd9_code)::text <= '30493'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '30520'::text) AND ((icd.icd9_code)::text <= '30593'::text)) THEN 1 WHEN (((icd.icd9_code)::text >= '64830'::text) AND ((icd.icd9_code)::text <= '64834'::text)) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (((icd.icd9_code)::text >= '29500'::text) AND ((icd.icd9_code)::text <= '2989'::text)) THEN 1 WHEN ((icd.icd9_code)::text = '29910'::text) THEN 1 WHEN ((icd.icd9_code)::text = '29911'::text) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN ((icd.icd9_code)::text = '3004'::text) THEN 1 WHEN ((icd.icd9_code)::text = '30112'::text) THEN 1 WHEN ((icd.icd9_code)::text = '3090'::text) THEN 1 WHEN ((icd.icd9_code)::text = '3091'::text) THEN 1 WHEN ((icd.icd9_code)::text = '311'::text) THEN 1 ELSE NULL::integer END"
                    ],
                    "Filter": "(icd.seq_num = 1)"
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE eligrp",
                    "Parallel Aware": false,
                    "Output": [
                        "eliflg.hadm_id",
                        "max(eliflg.chf)",
                        "max(eliflg.arythm)",
                        "max(eliflg.valve)",
                        "max(eliflg.pulmcirc)",
                        "max(eliflg.perivasc)",
                        "max(eliflg.htn)",
                        "max(eliflg.htncx)",
                        "max(eliflg.htnpreg)",
                        "max(eliflg.htnwochf)",
                        "max(eliflg.htnwchf)",
                        "max(eliflg.hrenworf)",
                        "max(eliflg.hrenwrf)",
                        "max(eliflg.hhrwohrf)",
                        "max(eliflg.hhrwchf)",
                        "max(eliflg.hhrwrf)",
                        "max(eliflg.hhrwhrf)",
                        "max(eliflg.ohtnpreg)",
                        "max(eliflg.para)",
                        "max(eliflg.neuro)",
                        "max(eliflg.chrnlung)",
                        "max(eliflg.dm)",
                        "max(eliflg.dmcx)",
                        "max(eliflg.hypothy)",
                        "max(eliflg.renlfail)",
                        "max(eliflg.liver)",
                        "max(eliflg.ulcer)",
                        "max(eliflg.aids)",
                        "max(eliflg.lymph)",
                        "max(eliflg.mets)",
                        "max(eliflg.tumor)",
                        "max(eliflg.arth)",
                        "max(eliflg.coag)",
                        "max(eliflg.obese)",
                        "max(eliflg.wghtloss)",
                        "max(eliflg.lytes)",
                        "max(eliflg.bldloss)",
                        "max(eliflg.anemdef)",
                        "max(eliflg.alcohol)",
                        "max(eliflg.drug)",
                        "max(eliflg.psych)",
                        "max(eliflg.depress)"
                    ],
                    "Group Key": [
                        "eliflg.hadm_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "eliflg",
                            "Alias": "eliflg",
                            "Output": [
                                "eliflg.hadm_id",
                                "eliflg.seq_num",
                                "eliflg.icd9_code",
                                "eliflg.chf",
                                "eliflg.arythm",
                                "eliflg.valve",
                                "eliflg.pulmcirc",
                                "eliflg.perivasc",
                                "eliflg.htn",
                                "eliflg.htncx",
                                "eliflg.htnpreg",
                                "eliflg.htnwochf",
                                "eliflg.htnwchf",
                                "eliflg.hrenworf",
                                "eliflg.hrenwrf",
                                "eliflg.hhrwohrf",
                                "eliflg.hhrwchf",
                                "eliflg.hhrwrf",
                                "eliflg.hhrwhrf",
                                "eliflg.ohtnpreg",
                                "eliflg.para",
                                "eliflg.neuro",
                                "eliflg.chrnlung",
                                "eliflg.dm",
                                "eliflg.dmcx",
                                "eliflg.hypothy",
                                "eliflg.renlfail",
                                "eliflg.liver",
                                "eliflg.ulcer",
                                "eliflg.aids",
                                "eliflg.lymph",
                                "eliflg.mets",
                                "eliflg.tumor",
                                "eliflg.arth",
                                "eliflg.coag",
                                "eliflg.obese",
                                "eliflg.wghtloss",
                                "eliflg.lytes",
                                "eliflg.bldloss",
                                "eliflg.anemdef",
                                "eliflg.alcohol",
                                "eliflg.drug",
                                "eliflg.psych",
                                "eliflg.depress"
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Sort",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "adm.subject_id",
                        "adm.hadm_id"
                    ],
                    "Sort Key": [
                        "adm.hadm_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Seq Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "admissions",
                            "Schema": "mimiciii_clinical",
                            "Alias": "adm",
                            "Output": [
                                "adm.subject_id",
                                "adm.hadm_id"
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Sort",
                    "Parent Relationship": "Inner",
                    "Parallel Aware": false,
                    "Output": [
                        "eli.chf",
                        "eli.htnwchf",
                        "eli.hhrwchf",
                        "eli.hhrwhrf",
                        "eli.arythm",
                        "eli.valve",
                        "eli.pulmcirc",
                        "eli.perivasc",
                        "eli.htn",
                        "eli.htncx",
                        "eli.htnpreg",
                        "eli.htnwochf",
                        "eli.hrenworf",
                        "eli.hrenwrf",
                        "eli.hhrwohrf",
                        "eli.hhrwrf",
                        "eli.ohtnpreg",
                        "eli.para",
                        "eli.neuro",
                        "eli.chrnlung",
                        "eli.dmcx",
                        "eli.dm",
                        "eli.hypothy",
                        "eli.renlfail",
                        "eli.liver",
                        "eli.ulcer",
                        "eli.aids",
                        "eli.lymph",
                        "eli.mets",
                        "eli.tumor",
                        "eli.arth",
                        "eli.coag",
                        "eli.obese",
                        "eli.wghtloss",
                        "eli.lytes",
                        "eli.bldloss",
                        "eli.anemdef",
                        "eli.alcohol",
                        "eli.drug",
                        "eli.psych",
                        "eli.depress",
                        "eli.hadm_id"
                    ],
                    "Sort Key": [
                        "eli.hadm_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "eligrp",
                            "Alias": "eli",
                            "Output": [
                                "eli.chf",
                                "eli.htnwchf",
                                "eli.hhrwchf",
                                "eli.hhrwhrf",
                                "eli.arythm",
                                "eli.valve",
                                "eli.pulmcirc",
                                "eli.perivasc",
                                "eli.htn",
                                "eli.htncx",
                                "eli.htnpreg",
                                "eli.htnwochf",
                                "eli.hrenworf",
                                "eli.hrenwrf",
                                "eli.hhrwohrf",
                                "eli.hhrwrf",
                                "eli.ohtnpreg",
                                "eli.para",
                                "eli.neuro",
                                "eli.chrnlung",
                                "eli.dmcx",
                                "eli.dm",
                                "eli.hypothy",
                                "eli.renlfail",
                                "eli.liver",
                                "eli.ulcer",
                                "eli.aids",
                                "eli.lymph",
                                "eli.mets",
                                "eli.tumor",
                                "eli.arth",
                                "eli.coag",
                                "eli.obese",
                                "eli.wghtloss",
                                "eli.lytes",
                                "eli.bldloss",
                                "eli.anemdef",
                                "eli.alcohol",
                                "eli.drug",
                                "eli.psych",
                                "eli.depress",
                                "eli.hadm_id"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.elixhauser_quan": {
        "sql": "-- This code calculates the Elixhauser comorbidities as defined in Quan et. al 2009:\n-- Quan, Hude, et al. \"Coding algorithms for defining comorbidities in\n-- ICD-9-CM and ICD-10 administrative data.\" Medical care (2005): 1130-1139.\n--  https://www.ncbi.nlm.nih.gov/pubmed/16224307\n-- Quan defined an \"Enhanced ICD-9\" coding scheme for deriving Elixhauser\n-- comorbidities from ICD-9 billing codes. This script implements that calculation.\n-- The logic of the code is roughly that, if the comorbidity lists a length 3\n-- ICD-9 code (e.g. 585), then we only require a match on the first 3 characters.\n-- This code derives each comorbidity as follows:\n--  1) ICD9_CODE is directly compared to 5 character codes\n--  2) The first 4 characters of ICD9_CODE are compared to 4 character codes\n--  3) The first 3 characters of ICD9_CODE are compared to 3 character codes\n\n \n\nwith eliflg as (\n    select\n        hadm_id,\n        seq_num,\n        icd9_code,\n        CASE\n            when icd9_code in (\n                '39891',\n                '40201',\n                '40211',\n                '40291',\n                '40401',\n                '40403',\n                '40411',\n                '40413',\n                '40491',\n                '40493'\n            ) then 1\n            when SUBSTR(icd9_code, 1, 4) in ('4254', '4255', '4257', '4258', '4259') then 1\n            when SUBSTR(icd9_code, 1, 3) in ('428') then 1\n            else 0\n        end as chf\n        /* Congestive heart failure */\n,\n        CASE\n            when icd9_code in ('42613', '42610', '42612', '99601', '99604') then 1\n            when SUBSTR(icd9_code, 1, 4) in (\n                '4260',\n                '4267',\n                '4269',\n                '4270',\n                '4271',\n                '4272',\n                '4273',\n                '4274',\n                '4276',\n                '4278',\n                '4279',\n                '7850',\n                'V450',\n                'V533'\n            ) then 1\n            else 0\n        end as arrhy,\n        CASE\n            when SUBSTR(icd9_code, 1, 4) in ('0932', '7463', '7464', '7465', '7466', 'V422', 'V433') then 1\n            when SUBSTR(icd9_code, 1, 3) in ('394', '395', '396', '397', '424') then 1\n            else 0\n        end as valve\n        /* Valvular disease */\n,\n        CASE\n            when SUBSTR(icd9_code, 1, 4) in ('4150', '4151', '4170', '4178', '4179') then 1\n            when SUBSTR(icd9_code, 1, 3) in ('416') then 1\n            else 0\n        end as pulmcirc\n        /* Pulmonary circulation disorder */\n,\n        CASE\n            when SUBSTR(icd9_code, 1, 4) in (\n                '0930',\n                '4373',\n                '4431',\n                '4432',\n                '4438',\n                '4439',\n                '4471',\n                '5571',\n                '5579',\n                'V434'\n            ) then 1\n            when SUBSTR(icd9_code, 1, 3) in ('440', '441') then 1\n            else 0\n        end as perivasc\n        /* Peripheral vascular disorder */\n,\n        CASE\n            when SUBSTR(icd9_code, 1, 3) in ('401') then 1\n            else 0\n        end as htn\n        /* Hypertension, uncomplicated */\n,\n        CASE\n            when SUBSTR(icd9_code, 1, 3) in ('402', '403', '404', '405') then 1\n            else 0\n        end as htncx\n        /* Hypertension, complicated */\n,\n        CASE\n            when SUBSTR(icd9_code, 1, 4) in (\n                '3341',\n                '3440',\n                '3441',\n                '3442',\n                '3443',\n                '3444',\n                '3445',\n                '3446',\n                '3449'\n            ) then 1\n            when SUBSTR(icd9_code, 1, 3) in ('342', '343') then 1\n            else 0\n        end as para\n        /* Paralysis */\n,\n        CASE\n            when icd9_code in ('33392') then 1\n            when SUBSTR(icd9_code, 1, 4) in (\n                '3319',\n                '3320',\n                '3321',\n                '3334',\n                '3335',\n                '3362',\n                '3481',\n                '3483',\n                '7803',\n                '7843'\n            ) then 1\n            when SUBSTR(icd9_code, 1, 3) in ('334', '335', '340', '341', '345') then 1\n            else 0\n        end as neuro\n        /* Other neurological */\n,\n        CASE\n            when SUBSTR(icd9_code, 1, 4) in ('4168', '4169', '5064', '5081', '5088') then 1\n            when SUBSTR(icd9_code, 1, 3) in (\n                '490',\n                '491',\n                '492',\n                '493',\n                '494',\n                '495',\n                '496',\n                '500',\n                '501',\n                '502',\n                '503',\n                '504',\n                '505'\n            ) then 1\n            else 0\n        end as chrnlung\n        /* Chronic pulmonary disease */\n,\n        CASE\n            when SUBSTR(icd9_code, 1, 4) in ('2500', '2501', '2502', '2503') then 1\n            else 0\n        end as dm\n        /* Diabetes w/o chronic complications*/\n,\n        CASE\n            when SUBSTR(icd9_code, 1, 4) in ('2504', '2505', '2506', '2507', '2508', '2509') then 1\n            else 0\n        end as dmcx\n        /* Diabetes w/ chronic complications */\n,\n        CASE\n            when SUBSTR(icd9_code, 1, 4) in ('2409', '2461', '2468') then 1\n            when SUBSTR(icd9_code, 1, 3) in ('243', '244') then 1\n            else 0\n        end as hypothy\n        /* Hypothyroidism */\n,\n        CASE\n            when icd9_code in (\n                '40301',\n                '40311',\n                '40391',\n                '40402',\n                '40403',\n                '40412',\n                '40413',\n                '40492',\n                '40493'\n            ) then 1\n            when SUBSTR(icd9_code, 1, 4) in ('5880', 'V420', 'V451') then 1\n            when SUBSTR(icd9_code, 1, 3) in ('585', '586', 'V56') then 1\n            else 0\n        end as renlfail\n        /* Renal failure */\n,\n        CASE\n            when icd9_code in ('07022', '07023', '07032', '07033', '07044', '07054') then 1\n            when SUBSTR(icd9_code, 1, 4) in (\n                '0706',\n                '0709',\n                '4560',\n                '4561',\n                '4562',\n                '5722',\n                '5723',\n                '5724',\n                '5728',\n                '5733',\n                '5734',\n                '5738',\n                '5739',\n                'V427'\n            ) then 1\n            when SUBSTR(icd9_code, 1, 3) in ('570', '571') then 1\n            else 0\n        end as liver\n        /* Liver disease */\n,\n        CASE\n            when SUBSTR(icd9_code, 1, 4) in (\n                '5317',\n                '5319',\n                '5327',\n                '5329',\n                '5337',\n                '5339',\n                '5347',\n                '5349'\n            ) then 1\n            else 0\n        end as ulcer\n        /* Chronic Peptic ulcer disease (includes bleeding only if obstruction is also present) */\n,\n        CASE\n            when SUBSTR(icd9_code, 1, 3) in ('042', '043', '044') then 1\n            else 0\n        end as aids\n        /* HIV and AIDS */\n,\n        CASE\n            when SUBSTR(icd9_code, 1, 4) in ('2030', '2386') then 1\n            when SUBSTR(icd9_code, 1, 3) in ('200', '201', '202') then 1\n            else 0\n        end as lymph\n        /* Lymphoma */\n,\n        CASE\n            when SUBSTR(icd9_code, 1, 3) in ('196', '197', '198', '199') then 1\n            else 0\n        end as mets\n        /* Metastatic cancer */\n,\n        CASE\n            when SUBSTR(icd9_code, 1, 3) in (\n                '140',\n                '141',\n                '142',\n                '143',\n                '144',\n                '145',\n                '146',\n                '147',\n                '148',\n                '149',\n                '150',\n                '151',\n                '152',\n                '153',\n                '154',\n                '155',\n                '156',\n                '157',\n                '158',\n                '159',\n                '160',\n                '161',\n                '162',\n                '163',\n                '164',\n                '165',\n                '166',\n                '167',\n                '168',\n                '169',\n                '170',\n                '171',\n                '172',\n                '174',\n                '175',\n                '176',\n                '177',\n                '178',\n                '179',\n                '180',\n                '181',\n                '182',\n                '183',\n                '184',\n                '185',\n                '186',\n                '187',\n                '188',\n                '189',\n                '190',\n                '191',\n                '192',\n                '193',\n                '194',\n                '195'\n            ) then 1\n            else 0\n        end as tumor\n        /* Solid tumor without metastasis */\n,\n        CASE\n            when icd9_code in ('72889', '72930') then 1\n            when SUBSTR(icd9_code, 1, 4) in (\n                '7010',\n                '7100',\n                '7101',\n                '7102',\n                '7103',\n                '7104',\n                '7108',\n                '7109',\n                '7112',\n                '7193',\n                '7285'\n            ) then 1\n            when SUBSTR(icd9_code, 1, 3) in ('446', '714', '720', '725') then 1\n            else 0\n        end as arth\n        /* Rheumatoid arthritis/collagen vascular diseases */\n,\n        CASE\n            when SUBSTR(icd9_code, 1, 4) in ('2871', '2873', '2874', '2875') then 1\n            when SUBSTR(icd9_code, 1, 3) in ('286') then 1\n            else 0\n        end as coag\n        /* Coagulation deficiency */\n,\n        CASE\n            when SUBSTR(icd9_code, 1, 4) in ('2780') then 1\n            else 0\n        end as obese\n        /* Obesity      */\n,\n        CASE\n            when SUBSTR(icd9_code, 1, 4) in ('7832', '7994') then 1\n            when SUBSTR(icd9_code, 1, 3) in ('260', '261', '262', '263') then 1\n            else 0\n        end as wghtloss\n        /* Weight loss */\n,\n        CASE\n            when SUBSTR(icd9_code, 1, 4) in ('2536') then 1\n            when SUBSTR(icd9_code, 1, 3) in ('276') then 1\n            else 0\n        end as lytes\n        /* Fluid and electrolyte disorders */\n,\n        CASE\n            when SUBSTR(icd9_code, 1, 4) in ('2800') then 1\n            else 0\n        end as bldloss\n        /* Blood loss anemia */\n,\n        CASE\n            when SUBSTR(icd9_code, 1, 4) in ('2801', '2808', '2809') then 1\n            when SUBSTR(icd9_code, 1, 3) in ('281') then 1\n            else 0\n        end as anemdef\n        /* Deficiency anemias */\n,\n        CASE\n            when SUBSTR(icd9_code, 1, 4) in (\n                '2652',\n                '2911',\n                '2912',\n                '2913',\n                '2915',\n                '2918',\n                '2919',\n                '3030',\n                '3039',\n                '3050',\n                '3575',\n                '4255',\n                '5353',\n                '5710',\n                '5711',\n                '5712',\n                '5713',\n                'V113'\n            ) then 1\n            when SUBSTR(icd9_code, 1, 3) in ('980') then 1\n            else 0\n        end as alcohol\n        /* Alcohol abuse */\n,\n        CASE\n            when icd9_code in ('V6542') then 1\n            when SUBSTR(icd9_code, 1, 4) in (\n                '3052',\n                '3053',\n                '3054',\n                '3055',\n                '3056',\n                '3057',\n                '3058',\n                '3059'\n            ) then 1\n            when SUBSTR(icd9_code, 1, 3) in ('292', '304') then 1\n            else 0\n        end as drug\n        /* Drug abuse */\n,\n        CASE\n            when icd9_code in ('29604', '29614', '29644', '29654') then 1\n            when SUBSTR(icd9_code, 1, 4) in ('2938') then 1\n            when SUBSTR(icd9_code, 1, 3) in ('295', '297', '298') then 1\n            else 0\n        end as psych\n        /* Psychoses */\n,\n        CASE\n            when SUBSTR(icd9_code, 1, 4) in ('2962', '2963', '2965', '3004') then 1\n            when SUBSTR(icd9_code, 1, 3) in ('309', '311') then 1\n            else 0\n        end as depress\n        /* Depression */\n    from\n        diagnoses_icd icd\n    where\n        seq_num != 1 -- we do not include the primary icd-9 code\n) -- collapse the icd9_code specific flags into hadm_id specific flags\n-- this groups comorbidities together for a single patient admission\n,\neligrp as (\n    select\n        hadm_id,\n        max(chf) as chf,\n        max(arrhy) as arrhy,\n        max(valve) as valve,\n        max(pulmcirc) as pulmcirc,\n        max(perivasc) as perivasc,\n        max(htn) as htn,\n        max(htncx) as htncx,\n        max(para) as para,\n        max(neuro) as neuro,\n        max(chrnlung) as chrnlung,\n        max(dm) as dm,\n        max(dmcx) as dmcx,\n        max(hypothy) as hypothy,\n        max(renlfail) as renlfail,\n        max(liver) as liver,\n        max(ulcer) as ulcer,\n        max(aids) as aids,\n        max(lymph) as lymph,\n        max(mets) as mets,\n        max(tumor) as tumor,\n        max(arth) as arth,\n        max(coag) as coag,\n        max(obese) as obese,\n        max(wghtloss) as wghtloss,\n        max(lytes) as lytes,\n        max(bldloss) as bldloss,\n        max(anemdef) as anemdef,\n        max(alcohol) as alcohol,\n        max(drug) as drug,\n        max(psych) as psych,\n        max(depress) as depress\n    from\n        eliflg\n    group by\n        hadm_id\n) -- now merge these flags together to define elixhauser\n-- most are straightforward.. but hypertension flags are a bit more complicated\nselect\n    adm.hadm_id,\n    chf as congestive_heart_failure,\n    arrhy as cardiac_arrhythmias,\n    valve as valvular_disease,\n    pulmcirc as pulmonary_circulation,\n    perivasc as peripheral_vascular -- we combine \"htn\" and \"htncx\" into \"HYPERTENSION\"\n,\n    case\n        when htn = 1 then 1\n        when htncx = 1 then 1\n        else 0\n    end as hypertension,\n    para as paralysis,\n    neuro as other_neurological,\n    chrnlung as chronic_pulmonary -- only the more severe comorbidity (complicated diabetes) is kept\n,\n    case\n        when dmcx = 1 then 0\n        when dm = 1 then 1\n        else 0\n    end as diabetes_uncomplicated,\n    dmcx as diabetes_complicated,\n    hypothy as hypothyroidism,\n    renlfail as renal_failure,\n    liver as liver_disease,\n    ulcer as peptic_ulcer,\n    aids as aids,\n    lymph as lymphoma,\n    mets as metastatic_cancer -- only the more severe comorbidity (metastatic cancer) is kept\n,\n    case\n        when mets = 1 then 0\n        when tumor = 1 then 1\n        else 0\n    end as solid_tumor,\n    arth as rheumatoid_arthritis,\n    coag as coagulopathy,\n    obese as obesity,\n    wghtloss as weight_loss,\n    lytes as fluid_electrolyte,\n    bldloss as blood_loss_anemia,\n    anemdef as deficiency_anemias,\n    alcohol as alcohol_abuse,\n    drug as drug_abuse,\n    psych as psychoses,\n    depress as depression\nFROM\n    admissions adm\n    left join eligrp eli on adm.hadm_id = eli.hadm_id\norder by\n    adm.hadm_id",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.diagnoses_icd"
        ],
        "columns": {
            "hadm_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "congestive_heart_failure": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "cardiac_arrhythmias": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "valvular_disease": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "pulmonary_circulation": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "peripheral_vascular": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "hypertension": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "paralysis": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "other_neurological": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "chronic_pulmonary": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "diabetes_uncomplicated": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "diabetes_complicated": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "hypothyroidism": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "renal_failure": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "liver_disease": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "peptic_ulcer": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "aids": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "lymphoma": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "metastatic_cancer": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "solid_tumor": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "rheumatoid_arthritis": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "coagulopathy": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "obesity": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "weight_loss": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "fluid_electrolyte": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "blood_loss_anemia": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "deficiency_anemias": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "alcohol_abuse": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "drug_abuse": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "psychoses": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ],
            "depression": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.seq_num"
            ]
        },
        "table_name": "mimiciii_clinical.elixhauser_quan",
        "plan": {
            "Node Type": "Merge Join",
            "Parallel Aware": false,
            "Join Type": "Left",
            "Output": [
                "adm.hadm_id",
                "eli.chf",
                "eli.arrhy",
                "eli.valve",
                "eli.pulmcirc",
                "eli.perivasc",
                "CASE WHEN (eli.htn = 1) THEN 1 WHEN (eli.htncx = 1) THEN 1 ELSE 0 END",
                "eli.para",
                "eli.neuro",
                "eli.chrnlung",
                "CASE WHEN (eli.dmcx = 1) THEN 0 WHEN (eli.dm = 1) THEN 1 ELSE 0 END",
                "eli.dmcx",
                "eli.hypothy",
                "eli.renlfail",
                "eli.liver",
                "eli.ulcer",
                "eli.aids",
                "eli.lymph",
                "eli.mets",
                "CASE WHEN (eli.mets = 1) THEN 0 WHEN (eli.tumor = 1) THEN 1 ELSE 0 END",
                "eli.arth",
                "eli.coag",
                "eli.obese",
                "eli.wghtloss",
                "eli.lytes",
                "eli.bldloss",
                "eli.anemdef",
                "eli.alcohol",
                "eli.drug",
                "eli.psych",
                "eli.depress"
            ],
            "Inner Unique": false,
            "Merge Cond": "(adm.hadm_id = eli.hadm_id)",
            "Plans": [
                {
                    "Node Type": "Seq Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE eliflg",
                    "Parallel Aware": false,
                    "Relation Name": "diagnoses_icd",
                    "Schema": "mimiciii_clinical",
                    "Alias": "icd",
                    "Output": [
                        "icd.hadm_id",
                        "icd.seq_num",
                        "icd.icd9_code",
                        "CASE WHEN ((icd.icd9_code)::text = ANY ('{39891,40201,40211,40291,40401,40403,40411,40413,40491,40493}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 4) = ANY ('{4254,4255,4257,4258,4259}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 3) = '428'::text) THEN 1 ELSE 0 END",
                        "CASE WHEN ((icd.icd9_code)::text = ANY ('{42613,42610,42612,99601,99604}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 4) = ANY ('{4260,4267,4269,4270,4271,4272,4273,4274,4276,4278,4279,7850,V450,V533}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 4) = ANY ('{0932,7463,7464,7465,7466,V422,V433}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 3) = ANY ('{394,395,396,397,424}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 4) = ANY ('{4150,4151,4170,4178,4179}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 3) = '416'::text) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 4) = ANY ('{0930,4373,4431,4432,4438,4439,4471,5571,5579,V434}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 3) = ANY ('{440,441}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 3) = '401'::text) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 3) = ANY ('{402,403,404,405}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 4) = ANY ('{3341,3440,3441,3442,3443,3444,3445,3446,3449}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 3) = ANY ('{342,343}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN ((icd.icd9_code)::text = '33392'::text) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 4) = ANY ('{3319,3320,3321,3334,3335,3362,3481,3483,7803,7843}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 3) = ANY ('{334,335,340,341,345}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 4) = ANY ('{4168,4169,5064,5081,5088}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 3) = ANY ('{490,491,492,493,494,495,496,500,501,502,503,504,505}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 4) = ANY ('{2500,2501,2502,2503}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 4) = ANY ('{2504,2505,2506,2507,2508,2509}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 4) = ANY ('{2409,2461,2468}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 3) = ANY ('{243,244}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN ((icd.icd9_code)::text = ANY ('{40301,40311,40391,40402,40403,40412,40413,40492,40493}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 4) = ANY ('{5880,V420,V451}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 3) = ANY ('{585,586,V56}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN ((icd.icd9_code)::text = ANY ('{07022,07023,07032,07033,07044,07054}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 4) = ANY ('{0706,0709,4560,4561,4562,5722,5723,5724,5728,5733,5734,5738,5739,V427}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 3) = ANY ('{570,571}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 4) = ANY ('{5317,5319,5327,5329,5337,5339,5347,5349}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 3) = ANY ('{042,043,044}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 4) = ANY ('{2030,2386}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 3) = ANY ('{200,201,202}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 3) = ANY ('{196,197,198,199}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 3) = ANY ('{140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN ((icd.icd9_code)::text = ANY ('{72889,72930}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 4) = ANY ('{7010,7100,7101,7102,7103,7104,7108,7109,7112,7193,7285}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 3) = ANY ('{446,714,720,725}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 4) = ANY ('{2871,2873,2874,2875}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 3) = '286'::text) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 4) = '2780'::text) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 4) = ANY ('{7832,7994}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 3) = ANY ('{260,261,262,263}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 4) = '2536'::text) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 3) = '276'::text) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 4) = '2800'::text) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 4) = ANY ('{2801,2808,2809}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 3) = '281'::text) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 4) = ANY ('{2652,2911,2912,2913,2915,2918,2919,3030,3039,3050,3575,4255,5353,5710,5711,5712,5713,V113}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 3) = '980'::text) THEN 1 ELSE 0 END",
                        "CASE WHEN ((icd.icd9_code)::text = 'V6542'::text) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 4) = ANY ('{3052,3053,3054,3055,3056,3057,3058,3059}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 3) = ANY ('{292,304}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN ((icd.icd9_code)::text = ANY ('{29604,29614,29644,29654}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 4) = '2938'::text) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 3) = ANY ('{295,297,298}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((icd.icd9_code)::text, 1, 4) = ANY ('{2962,2963,2965,3004}'::text[])) THEN 1 WHEN (substr((icd.icd9_code)::text, 1, 3) = ANY ('{309,311}'::text[])) THEN 1 ELSE 0 END"
                    ],
                    "Filter": "(icd.seq_num <> 1)"
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE eligrp",
                    "Parallel Aware": false,
                    "Output": [
                        "eliflg.hadm_id",
                        "max(eliflg.chf)",
                        "max(eliflg.arrhy)",
                        "max(eliflg.valve)",
                        "max(eliflg.pulmcirc)",
                        "max(eliflg.perivasc)",
                        "max(eliflg.htn)",
                        "max(eliflg.htncx)",
                        "max(eliflg.para)",
                        "max(eliflg.neuro)",
                        "max(eliflg.chrnlung)",
                        "max(eliflg.dm)",
                        "max(eliflg.dmcx)",
                        "max(eliflg.hypothy)",
                        "max(eliflg.renlfail)",
                        "max(eliflg.liver)",
                        "max(eliflg.ulcer)",
                        "max(eliflg.aids)",
                        "max(eliflg.lymph)",
                        "max(eliflg.mets)",
                        "max(eliflg.tumor)",
                        "max(eliflg.arth)",
                        "max(eliflg.coag)",
                        "max(eliflg.obese)",
                        "max(eliflg.wghtloss)",
                        "max(eliflg.lytes)",
                        "max(eliflg.bldloss)",
                        "max(eliflg.anemdef)",
                        "max(eliflg.alcohol)",
                        "max(eliflg.drug)",
                        "max(eliflg.psych)",
                        "max(eliflg.depress)"
                    ],
                    "Group Key": [
                        "eliflg.hadm_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "eliflg",
                            "Alias": "eliflg",
                            "Output": [
                                "eliflg.hadm_id",
                                "eliflg.seq_num",
                                "eliflg.icd9_code",
                                "eliflg.chf",
                                "eliflg.arrhy",
                                "eliflg.valve",
                                "eliflg.pulmcirc",
                                "eliflg.perivasc",
                                "eliflg.htn",
                                "eliflg.htncx",
                                "eliflg.para",
                                "eliflg.neuro",
                                "eliflg.chrnlung",
                                "eliflg.dm",
                                "eliflg.dmcx",
                                "eliflg.hypothy",
                                "eliflg.renlfail",
                                "eliflg.liver",
                                "eliflg.ulcer",
                                "eliflg.aids",
                                "eliflg.lymph",
                                "eliflg.mets",
                                "eliflg.tumor",
                                "eliflg.arth",
                                "eliflg.coag",
                                "eliflg.obese",
                                "eliflg.wghtloss",
                                "eliflg.lytes",
                                "eliflg.bldloss",
                                "eliflg.anemdef",
                                "eliflg.alcohol",
                                "eliflg.drug",
                                "eliflg.psych",
                                "eliflg.depress"
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Sort",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "adm.hadm_id"
                    ],
                    "Sort Key": [
                        "adm.hadm_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Seq Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "admissions",
                            "Schema": "mimiciii_clinical",
                            "Alias": "adm",
                            "Output": [
                                "adm.hadm_id"
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Sort",
                    "Parent Relationship": "Inner",
                    "Parallel Aware": false,
                    "Output": [
                        "eli.chf",
                        "eli.arrhy",
                        "eli.valve",
                        "eli.pulmcirc",
                        "eli.perivasc",
                        "eli.htn",
                        "eli.htncx",
                        "eli.para",
                        "eli.neuro",
                        "eli.chrnlung",
                        "eli.dmcx",
                        "eli.dm",
                        "eli.hypothy",
                        "eli.renlfail",
                        "eli.liver",
                        "eli.ulcer",
                        "eli.aids",
                        "eli.lymph",
                        "eli.mets",
                        "eli.tumor",
                        "eli.arth",
                        "eli.coag",
                        "eli.obese",
                        "eli.wghtloss",
                        "eli.lytes",
                        "eli.bldloss",
                        "eli.anemdef",
                        "eli.alcohol",
                        "eli.drug",
                        "eli.psych",
                        "eli.depress",
                        "eli.hadm_id"
                    ],
                    "Sort Key": [
                        "eli.hadm_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "eligrp",
                            "Alias": "eli",
                            "Output": [
                                "eli.chf",
                                "eli.arrhy",
                                "eli.valve",
                                "eli.pulmcirc",
                                "eli.perivasc",
                                "eli.htn",
                                "eli.htncx",
                                "eli.para",
                                "eli.neuro",
                                "eli.chrnlung",
                                "eli.dmcx",
                                "eli.dm",
                                "eli.hypothy",
                                "eli.renlfail",
                                "eli.liver",
                                "eli.ulcer",
                                "eli.aids",
                                "eli.lymph",
                                "eli.mets",
                                "eli.tumor",
                                "eli.arth",
                                "eli.coag",
                                "eli.obese",
                                "eli.wghtloss",
                                "eli.lytes",
                                "eli.bldloss",
                                "eli.anemdef",
                                "eli.alcohol",
                                "eli.drug",
                                "eli.psych",
                                "eli.depress",
                                "eli.hadm_id"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.elixhauser_score_ahrq": {
        "sql": "-- This query provides various methods of combining the Elixhauser components into a single score\n-- The methods are called \"vanWalRaven\" and \"SID30\", and \"SID29\"\nselect subject_id, hadm_id\n,  -- Below is the van Walraven score\n   0 * aids +\n   0 * alcohol_abuse +\n  -2 * blood_loss_anemia +\n   7 * congestive_heart_failure +\n   -- Cardiac arrhythmias are not included in van Walraven based on Quan 2007\n   3 * chronic_pulmonary +\n   3 * coagulopathy +\n  -2 * deficiency_anemias +\n  -3 * depression +\n   0 * diabetes_complicated +\n   0 * diabetes_uncomplicated +\n  -7 * drug_abuse +\n   5 * fluid_electrolyte +\n   0 * hypertension +\n   0 * hypothyroidism +\n   11 * liver_disease +\n   9 * lymphoma +\n   12 * metastatic_cancer +\n   6 * other_neurological +\n  -4 * obesity +\n   7 * paralysis +\n   2 * peripheral_vascular +\n   0 * peptic_ulcer +\n   0 * psychoses +\n   4 * pulmonary_circulation +\n   0 * rheumatoid_arthritis +\n   5 * renal_failure +\n   4 * solid_tumor +\n  -1 * valvular_disease +\n   6 * weight_loss\nas elixhauser_vanwalraven\n\n\n\n,  -- Below is the 29 component SID score\n   0 * aids +\n  -2 * alcohol_abuse +\n  -2 * blood_loss_anemia +\n   -- Cardiac arrhythmias are not included in SID-29\n   9 * congestive_heart_failure +\n   3 * chronic_pulmonary +\n   9 * coagulopathy +\n   0 * deficiency_anemias +\n  -4 * depression +\n   0 * diabetes_complicated +\n  -1 * diabetes_uncomplicated +\n  -8 * drug_abuse +\n   9 * fluid_electrolyte +\n  -1 * hypertension +\n   0 * hypothyroidism +\n   5 * liver_disease +\n   6 * lymphoma +\n   13 * metastatic_cancer +\n   4 * other_neurological +\n  -4 * obesity +\n   3 * paralysis +\n   0 * peptic_ulcer +\n   4 * peripheral_vascular +\n  -4 * psychoses +\n   5 * pulmonary_circulation +\n   6 * renal_failure +\n   0 * rheumatoid_arthritis +\n   8 * solid_tumor +\n   0 * valvular_disease +\n   8 * weight_loss\nas elixhauser_SID29\n\n\n,  -- Below is the 30 component SID score\n   0 * aids +\n   0 * alcohol_abuse +\n  -3 * blood_loss_anemia +\n   8 * cardiac_arrhythmias +\n   9 * congestive_heart_failure +\n   3 * chronic_pulmonary +\n  12 * coagulopathy +\n   0 * deficiency_anemias +\n  -5 * depression +\n   1 * diabetes_complicated +\n   0 * diabetes_uncomplicated +\n -11 * drug_abuse +\n  11 * fluid_electrolyte +\n  -2 * hypertension +\n   0 * hypothyroidism +\n   7 * liver_disease +\n   8 * lymphoma +\n  17 * metastatic_cancer +\n   5 * other_neurological +\n  -5 * obesity +\n   4 * paralysis +\n   0 * peptic_ulcer +\n   4 * peripheral_vascular +\n  -6 * psychoses +\n   5 * pulmonary_circulation +\n   7 * renal_failure +\n   0 * rheumatoid_arthritis +\n  10 * solid_tumor +\n   0 * valvular_disease +\n  10 * weight_loss\nas elixhauser_SID30\n\nfrom \"mimic\".\"mimiciii_clinical\".\"elixhauser_ahrq_v37\"",
        "tables": [
            "mimiciii_clinical.elixhauser_ahrq_v37"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.elixhauser_ahrq_v37.subject_id"
            ],
            "hadm_id": [
                "mimiciii_clinical.elixhauser_ahrq_v37.hadm_id"
            ],
            "elixhauser_vanwalraven": [
                "mimiciii_clinical.elixhauser_ahrq_v37.aids",
                "mimiciii_clinical.elixhauser_ahrq_v37.alcohol_abuse",
                "mimiciii_clinical.elixhauser_ahrq_v37.blood_loss_anemia",
                "mimiciii_clinical.elixhauser_ahrq_v37.chronic_pulmonary",
                "mimiciii_clinical.elixhauser_ahrq_v37.coagulopathy",
                "mimiciii_clinical.elixhauser_ahrq_v37.congestive_heart_failure",
                "mimiciii_clinical.elixhauser_ahrq_v37.deficiency_anemias",
                "mimiciii_clinical.elixhauser_ahrq_v37.depression",
                "mimiciii_clinical.elixhauser_ahrq_v37.diabetes_complicated",
                "mimiciii_clinical.elixhauser_ahrq_v37.diabetes_uncomplicated",
                "mimiciii_clinical.elixhauser_ahrq_v37.drug_abuse",
                "mimiciii_clinical.elixhauser_ahrq_v37.fluid_electrolyte",
                "mimiciii_clinical.elixhauser_ahrq_v37.hypertension",
                "mimiciii_clinical.elixhauser_ahrq_v37.hypothyroidism",
                "mimiciii_clinical.elixhauser_ahrq_v37.liver_disease",
                "mimiciii_clinical.elixhauser_ahrq_v37.lymphoma",
                "mimiciii_clinical.elixhauser_ahrq_v37.metastatic_cancer",
                "mimiciii_clinical.elixhauser_ahrq_v37.obesity",
                "mimiciii_clinical.elixhauser_ahrq_v37.other_neurological",
                "mimiciii_clinical.elixhauser_ahrq_v37.paralysis",
                "mimiciii_clinical.elixhauser_ahrq_v37.peptic_ulcer",
                "mimiciii_clinical.elixhauser_ahrq_v37.peripheral_vascular",
                "mimiciii_clinical.elixhauser_ahrq_v37.psychoses",
                "mimiciii_clinical.elixhauser_ahrq_v37.pulmonary_circulation",
                "mimiciii_clinical.elixhauser_ahrq_v37.renal_failure",
                "mimiciii_clinical.elixhauser_ahrq_v37.rheumatoid_arthritis",
                "mimiciii_clinical.elixhauser_ahrq_v37.solid_tumor",
                "mimiciii_clinical.elixhauser_ahrq_v37.valvular_disease",
                "mimiciii_clinical.elixhauser_ahrq_v37.weight_loss"
            ],
            "elixhauser_sid29": [
                "mimiciii_clinical.elixhauser_ahrq_v37.aids",
                "mimiciii_clinical.elixhauser_ahrq_v37.alcohol_abuse",
                "mimiciii_clinical.elixhauser_ahrq_v37.blood_loss_anemia",
                "mimiciii_clinical.elixhauser_ahrq_v37.chronic_pulmonary",
                "mimiciii_clinical.elixhauser_ahrq_v37.coagulopathy",
                "mimiciii_clinical.elixhauser_ahrq_v37.congestive_heart_failure",
                "mimiciii_clinical.elixhauser_ahrq_v37.deficiency_anemias",
                "mimiciii_clinical.elixhauser_ahrq_v37.depression",
                "mimiciii_clinical.elixhauser_ahrq_v37.diabetes_complicated",
                "mimiciii_clinical.elixhauser_ahrq_v37.diabetes_uncomplicated",
                "mimiciii_clinical.elixhauser_ahrq_v37.drug_abuse",
                "mimiciii_clinical.elixhauser_ahrq_v37.fluid_electrolyte",
                "mimiciii_clinical.elixhauser_ahrq_v37.hypertension",
                "mimiciii_clinical.elixhauser_ahrq_v37.hypothyroidism",
                "mimiciii_clinical.elixhauser_ahrq_v37.liver_disease",
                "mimiciii_clinical.elixhauser_ahrq_v37.lymphoma",
                "mimiciii_clinical.elixhauser_ahrq_v37.metastatic_cancer",
                "mimiciii_clinical.elixhauser_ahrq_v37.obesity",
                "mimiciii_clinical.elixhauser_ahrq_v37.other_neurological",
                "mimiciii_clinical.elixhauser_ahrq_v37.paralysis",
                "mimiciii_clinical.elixhauser_ahrq_v37.peptic_ulcer",
                "mimiciii_clinical.elixhauser_ahrq_v37.peripheral_vascular",
                "mimiciii_clinical.elixhauser_ahrq_v37.psychoses",
                "mimiciii_clinical.elixhauser_ahrq_v37.pulmonary_circulation",
                "mimiciii_clinical.elixhauser_ahrq_v37.renal_failure",
                "mimiciii_clinical.elixhauser_ahrq_v37.rheumatoid_arthritis",
                "mimiciii_clinical.elixhauser_ahrq_v37.solid_tumor",
                "mimiciii_clinical.elixhauser_ahrq_v37.valvular_disease",
                "mimiciii_clinical.elixhauser_ahrq_v37.weight_loss"
            ],
            "elixhauser_sid30": [
                "mimiciii_clinical.elixhauser_ahrq_v37.aids",
                "mimiciii_clinical.elixhauser_ahrq_v37.alcohol_abuse",
                "mimiciii_clinical.elixhauser_ahrq_v37.blood_loss_anemia",
                "mimiciii_clinical.elixhauser_ahrq_v37.cardiac_arrhythmias",
                "mimiciii_clinical.elixhauser_ahrq_v37.chronic_pulmonary",
                "mimiciii_clinical.elixhauser_ahrq_v37.coagulopathy",
                "mimiciii_clinical.elixhauser_ahrq_v37.congestive_heart_failure",
                "mimiciii_clinical.elixhauser_ahrq_v37.deficiency_anemias",
                "mimiciii_clinical.elixhauser_ahrq_v37.depression",
                "mimiciii_clinical.elixhauser_ahrq_v37.diabetes_complicated",
                "mimiciii_clinical.elixhauser_ahrq_v37.diabetes_uncomplicated",
                "mimiciii_clinical.elixhauser_ahrq_v37.drug_abuse",
                "mimiciii_clinical.elixhauser_ahrq_v37.fluid_electrolyte",
                "mimiciii_clinical.elixhauser_ahrq_v37.hypertension",
                "mimiciii_clinical.elixhauser_ahrq_v37.hypothyroidism",
                "mimiciii_clinical.elixhauser_ahrq_v37.liver_disease",
                "mimiciii_clinical.elixhauser_ahrq_v37.lymphoma",
                "mimiciii_clinical.elixhauser_ahrq_v37.metastatic_cancer",
                "mimiciii_clinical.elixhauser_ahrq_v37.obesity",
                "mimiciii_clinical.elixhauser_ahrq_v37.other_neurological",
                "mimiciii_clinical.elixhauser_ahrq_v37.paralysis",
                "mimiciii_clinical.elixhauser_ahrq_v37.peptic_ulcer",
                "mimiciii_clinical.elixhauser_ahrq_v37.peripheral_vascular",
                "mimiciii_clinical.elixhauser_ahrq_v37.psychoses",
                "mimiciii_clinical.elixhauser_ahrq_v37.pulmonary_circulation",
                "mimiciii_clinical.elixhauser_ahrq_v37.renal_failure",
                "mimiciii_clinical.elixhauser_ahrq_v37.rheumatoid_arthritis",
                "mimiciii_clinical.elixhauser_ahrq_v37.solid_tumor",
                "mimiciii_clinical.elixhauser_ahrq_v37.valvular_disease",
                "mimiciii_clinical.elixhauser_ahrq_v37.weight_loss"
            ]
        },
        "table_name": "mimiciii_clinical.elixhauser_score_ahrq",
        "plan": {
            "Node Type": "Seq Scan",
            "Parallel Aware": false,
            "Relation Name": "elixhauser_ahrq_v37",
            "Schema": "mimiciii_clinical",
            "Alias": "elixhauser_ahrq_v37",
            "Output": [
                "subject_id",
                "hadm_id",
                "(((((((((((((((((((((((((((((0 * aids) + (0 * alcohol_abuse)) + ('-2'::integer * blood_loss_anemia)) + (7 * congestive_heart_failure)) + (3 * chronic_pulmonary)) + (3 * coagulopathy)) + ('-2'::integer * deficiency_anemias)) + ('-3'::integer * depression)) + (0 * diabetes_complicated)) + (0 * diabetes_uncomplicated)) + ('-7'::integer * drug_abuse)) + (5 * fluid_electrolyte)) + (0 * hypertension)) + (0 * hypothyroidism)) + (11 * liver_disease)) + (9 * lymphoma)) + (12 * metastatic_cancer)) + (6 * other_neurological)) + ('-4'::integer * obesity)) + (7 * paralysis)) + (2 * peripheral_vascular)) + (0 * peptic_ulcer)) + (0 * psychoses)) + (4 * pulmonary_circulation)) + (0 * rheumatoid_arthritis)) + (5 * renal_failure)) + (4 * solid_tumor)) + ('-1'::integer * valvular_disease)) + (6 * weight_loss))",
                "(((((((((((((((((((((((((((((0 * aids) + ('-2'::integer * alcohol_abuse)) + ('-2'::integer * blood_loss_anemia)) + (9 * congestive_heart_failure)) + (3 * chronic_pulmonary)) + (9 * coagulopathy)) + (0 * deficiency_anemias)) + ('-4'::integer * depression)) + (0 * diabetes_complicated)) + ('-1'::integer * diabetes_uncomplicated)) + ('-8'::integer * drug_abuse)) + (9 * fluid_electrolyte)) + ('-1'::integer * hypertension)) + (0 * hypothyroidism)) + (5 * liver_disease)) + (6 * lymphoma)) + (13 * metastatic_cancer)) + (4 * other_neurological)) + ('-4'::integer * obesity)) + (3 * paralysis)) + (0 * peptic_ulcer)) + (4 * peripheral_vascular)) + ('-4'::integer * psychoses)) + (5 * pulmonary_circulation)) + (6 * renal_failure)) + (0 * rheumatoid_arthritis)) + (8 * solid_tumor)) + (0 * valvular_disease)) + (8 * weight_loss))",
                "((((((((((((((((((((((((((((((0 * aids) + (0 * alcohol_abuse)) + ('-3'::integer * blood_loss_anemia)) + (8 * cardiac_arrhythmias)) + (9 * congestive_heart_failure)) + (3 * chronic_pulmonary)) + (12 * coagulopathy)) + (0 * deficiency_anemias)) + ('-5'::integer * depression)) + (1 * diabetes_complicated)) + (0 * diabetes_uncomplicated)) + ('-11'::integer * drug_abuse)) + (11 * fluid_electrolyte)) + ('-2'::integer * hypertension)) + (0 * hypothyroidism)) + (7 * liver_disease)) + (8 * lymphoma)) + (17 * metastatic_cancer)) + (5 * other_neurological)) + ('-5'::integer * obesity)) + (4 * paralysis)) + (0 * peptic_ulcer)) + (4 * peripheral_vascular)) + ('-6'::integer * psychoses)) + (5 * pulmonary_circulation)) + (7 * renal_failure)) + (0 * rheumatoid_arthritis)) + (10 * solid_tumor)) + (0 * valvular_disease)) + (10 * weight_loss))"
            ]
        }
    },
    "model.mimic.elixhauser_score_quan": {
        "sql": "-- This query provides various methods of combining the Elixhauser components into a single score\n-- The methods are called \"vanWalRaven\" and \"SID30\", and \"SID29\"\n\nselect hadm_id\n,  -- Below is the van Walraven score\n   0 * aids +\n   0 * alcohol_abuse +\n  -2 * blood_loss_anemia +\n   7 * congestive_heart_failure +\n   -- Cardiac arrhythmias are not included in van Walraven based on Quan 2007\n   3 * chronic_pulmonary +\n   3 * coagulopathy +\n  -2 * deficiency_anemias +\n  -3 * depression +\n   0 * diabetes_complicated +\n   0 * diabetes_uncomplicated +\n  -7 * drug_abuse +\n   5 * fluid_electrolyte +\n   0 * hypertension +\n   0 * hypothyroidism +\n   11 * liver_disease +\n   9 * lymphoma +\n   12 * metastatic_cancer +\n   6 * other_neurological +\n  -4 * obesity +\n   7 * paralysis +\n   2 * peripheral_vascular +\n   0 * peptic_ulcer +\n   0 * psychoses +\n   4 * pulmonary_circulation +\n   0 * rheumatoid_arthritis +\n   5 * renal_failure +\n   4 * solid_tumor +\n  -1 * valvular_disease +\n   6 * weight_loss\nas elixhauser_vanwalraven\n\n\n\n,  -- Below is the 29 component SID score\n   0 * aids +\n  -2 * alcohol_abuse +\n  -2 * blood_loss_anemia +\n   -- Cardiac arrhythmias are not included in SID-29\n   9 * congestive_heart_failure +\n   3 * chronic_pulmonary +\n   9 * coagulopathy +\n   0 * deficiency_anemias +\n  -4 * depression +\n   0 * diabetes_complicated +\n  -1 * diabetes_uncomplicated +\n  -8 * drug_abuse +\n   9 * fluid_electrolyte +\n  -1 * hypertension +\n   0 * hypothyroidism +\n   5 * liver_disease +\n   6 * lymphoma +\n   13 * metastatic_cancer +\n   4 * other_neurological +\n  -4 * obesity +\n   3 * paralysis +\n   0 * peptic_ulcer +\n   4 * peripheral_vascular +\n  -4 * psychoses +\n   5 * pulmonary_circulation +\n   6 * renal_failure +\n   0 * rheumatoid_arthritis +\n   8 * solid_tumor +\n   0 * valvular_disease +\n   8 * weight_loss\nas elixhauser_SID29\n\n\n,  -- Below is the 30 component SID score\n   0 * aids +\n   0 * alcohol_abuse +\n  -3 * blood_loss_anemia +\n   8 * cardiac_arrhythmias +\n   9 * congestive_heart_failure +\n   3 * chronic_pulmonary +\n  12 * coagulopathy +\n   0 * deficiency_anemias +\n  -5 * depression +\n   1 * diabetes_complicated +\n   0 * diabetes_uncomplicated +\n -11 * drug_abuse +\n  11 * fluid_electrolyte +\n  -2 * hypertension +\n   0 * hypothyroidism +\n   7 * liver_disease +\n   8 * lymphoma +\n  17 * metastatic_cancer +\n   5 * other_neurological +\n  -5 * obesity +\n   4 * paralysis +\n   0 * peptic_ulcer +\n   4 * peripheral_vascular +\n  -6 * psychoses +\n   5 * pulmonary_circulation +\n   7 * renal_failure +\n   0 * rheumatoid_arthritis +\n  10 * solid_tumor +\n   0 * valvular_disease +\n  10 * weight_loss\nas elixhauser_SID30\n\nfrom  \"mimic\".\"mimiciii_clinical\".\"elixhauser_quan\"",
        "tables": [
            "mimiciii_clinical.elixhauser_quan"
        ],
        "columns": {
            "hadm_id": [
                "mimiciii_clinical.elixhauser_quan.hadm_id"
            ],
            "elixhauser_vanwalraven": [
                "mimiciii_clinical.elixhauser_quan.aids",
                "mimiciii_clinical.elixhauser_quan.alcohol_abuse",
                "mimiciii_clinical.elixhauser_quan.blood_loss_anemia",
                "mimiciii_clinical.elixhauser_quan.chronic_pulmonary",
                "mimiciii_clinical.elixhauser_quan.coagulopathy",
                "mimiciii_clinical.elixhauser_quan.congestive_heart_failure",
                "mimiciii_clinical.elixhauser_quan.deficiency_anemias",
                "mimiciii_clinical.elixhauser_quan.depression",
                "mimiciii_clinical.elixhauser_quan.diabetes_complicated",
                "mimiciii_clinical.elixhauser_quan.diabetes_uncomplicated",
                "mimiciii_clinical.elixhauser_quan.drug_abuse",
                "mimiciii_clinical.elixhauser_quan.fluid_electrolyte",
                "mimiciii_clinical.elixhauser_quan.hypertension",
                "mimiciii_clinical.elixhauser_quan.hypothyroidism",
                "mimiciii_clinical.elixhauser_quan.liver_disease",
                "mimiciii_clinical.elixhauser_quan.lymphoma",
                "mimiciii_clinical.elixhauser_quan.metastatic_cancer",
                "mimiciii_clinical.elixhauser_quan.obesity",
                "mimiciii_clinical.elixhauser_quan.other_neurological",
                "mimiciii_clinical.elixhauser_quan.paralysis",
                "mimiciii_clinical.elixhauser_quan.peptic_ulcer",
                "mimiciii_clinical.elixhauser_quan.peripheral_vascular",
                "mimiciii_clinical.elixhauser_quan.psychoses",
                "mimiciii_clinical.elixhauser_quan.pulmonary_circulation",
                "mimiciii_clinical.elixhauser_quan.renal_failure",
                "mimiciii_clinical.elixhauser_quan.rheumatoid_arthritis",
                "mimiciii_clinical.elixhauser_quan.solid_tumor",
                "mimiciii_clinical.elixhauser_quan.valvular_disease",
                "mimiciii_clinical.elixhauser_quan.weight_loss"
            ],
            "elixhauser_sid29": [
                "mimiciii_clinical.elixhauser_quan.aids",
                "mimiciii_clinical.elixhauser_quan.alcohol_abuse",
                "mimiciii_clinical.elixhauser_quan.blood_loss_anemia",
                "mimiciii_clinical.elixhauser_quan.chronic_pulmonary",
                "mimiciii_clinical.elixhauser_quan.coagulopathy",
                "mimiciii_clinical.elixhauser_quan.congestive_heart_failure",
                "mimiciii_clinical.elixhauser_quan.deficiency_anemias",
                "mimiciii_clinical.elixhauser_quan.depression",
                "mimiciii_clinical.elixhauser_quan.diabetes_complicated",
                "mimiciii_clinical.elixhauser_quan.diabetes_uncomplicated",
                "mimiciii_clinical.elixhauser_quan.drug_abuse",
                "mimiciii_clinical.elixhauser_quan.fluid_electrolyte",
                "mimiciii_clinical.elixhauser_quan.hypertension",
                "mimiciii_clinical.elixhauser_quan.hypothyroidism",
                "mimiciii_clinical.elixhauser_quan.liver_disease",
                "mimiciii_clinical.elixhauser_quan.lymphoma",
                "mimiciii_clinical.elixhauser_quan.metastatic_cancer",
                "mimiciii_clinical.elixhauser_quan.obesity",
                "mimiciii_clinical.elixhauser_quan.other_neurological",
                "mimiciii_clinical.elixhauser_quan.paralysis",
                "mimiciii_clinical.elixhauser_quan.peptic_ulcer",
                "mimiciii_clinical.elixhauser_quan.peripheral_vascular",
                "mimiciii_clinical.elixhauser_quan.psychoses",
                "mimiciii_clinical.elixhauser_quan.pulmonary_circulation",
                "mimiciii_clinical.elixhauser_quan.renal_failure",
                "mimiciii_clinical.elixhauser_quan.rheumatoid_arthritis",
                "mimiciii_clinical.elixhauser_quan.solid_tumor",
                "mimiciii_clinical.elixhauser_quan.valvular_disease",
                "mimiciii_clinical.elixhauser_quan.weight_loss"
            ],
            "elixhauser_sid30": [
                "mimiciii_clinical.elixhauser_quan.aids",
                "mimiciii_clinical.elixhauser_quan.alcohol_abuse",
                "mimiciii_clinical.elixhauser_quan.blood_loss_anemia",
                "mimiciii_clinical.elixhauser_quan.cardiac_arrhythmias",
                "mimiciii_clinical.elixhauser_quan.chronic_pulmonary",
                "mimiciii_clinical.elixhauser_quan.coagulopathy",
                "mimiciii_clinical.elixhauser_quan.congestive_heart_failure",
                "mimiciii_clinical.elixhauser_quan.deficiency_anemias",
                "mimiciii_clinical.elixhauser_quan.depression",
                "mimiciii_clinical.elixhauser_quan.diabetes_complicated",
                "mimiciii_clinical.elixhauser_quan.diabetes_uncomplicated",
                "mimiciii_clinical.elixhauser_quan.drug_abuse",
                "mimiciii_clinical.elixhauser_quan.fluid_electrolyte",
                "mimiciii_clinical.elixhauser_quan.hypertension",
                "mimiciii_clinical.elixhauser_quan.hypothyroidism",
                "mimiciii_clinical.elixhauser_quan.liver_disease",
                "mimiciii_clinical.elixhauser_quan.lymphoma",
                "mimiciii_clinical.elixhauser_quan.metastatic_cancer",
                "mimiciii_clinical.elixhauser_quan.obesity",
                "mimiciii_clinical.elixhauser_quan.other_neurological",
                "mimiciii_clinical.elixhauser_quan.paralysis",
                "mimiciii_clinical.elixhauser_quan.peptic_ulcer",
                "mimiciii_clinical.elixhauser_quan.peripheral_vascular",
                "mimiciii_clinical.elixhauser_quan.psychoses",
                "mimiciii_clinical.elixhauser_quan.pulmonary_circulation",
                "mimiciii_clinical.elixhauser_quan.renal_failure",
                "mimiciii_clinical.elixhauser_quan.rheumatoid_arthritis",
                "mimiciii_clinical.elixhauser_quan.solid_tumor",
                "mimiciii_clinical.elixhauser_quan.valvular_disease",
                "mimiciii_clinical.elixhauser_quan.weight_loss"
            ]
        },
        "table_name": "mimiciii_clinical.elixhauser_score_quan",
        "plan": {
            "Node Type": "Seq Scan",
            "Parallel Aware": false,
            "Relation Name": "elixhauser_quan",
            "Schema": "mimiciii_clinical",
            "Alias": "elixhauser_quan",
            "Output": [
                "hadm_id",
                "(((((((((((((((((((((((((((((0 * aids) + (0 * alcohol_abuse)) + ('-2'::integer * blood_loss_anemia)) + (7 * congestive_heart_failure)) + (3 * chronic_pulmonary)) + (3 * coagulopathy)) + ('-2'::integer * deficiency_anemias)) + ('-3'::integer * depression)) + (0 * diabetes_complicated)) + (0 * diabetes_uncomplicated)) + ('-7'::integer * drug_abuse)) + (5 * fluid_electrolyte)) + (0 * hypertension)) + (0 * hypothyroidism)) + (11 * liver_disease)) + (9 * lymphoma)) + (12 * metastatic_cancer)) + (6 * other_neurological)) + ('-4'::integer * obesity)) + (7 * paralysis)) + (2 * peripheral_vascular)) + (0 * peptic_ulcer)) + (0 * psychoses)) + (4 * pulmonary_circulation)) + (0 * rheumatoid_arthritis)) + (5 * renal_failure)) + (4 * solid_tumor)) + ('-1'::integer * valvular_disease)) + (6 * weight_loss))",
                "(((((((((((((((((((((((((((((0 * aids) + ('-2'::integer * alcohol_abuse)) + ('-2'::integer * blood_loss_anemia)) + (9 * congestive_heart_failure)) + (3 * chronic_pulmonary)) + (9 * coagulopathy)) + (0 * deficiency_anemias)) + ('-4'::integer * depression)) + (0 * diabetes_complicated)) + ('-1'::integer * diabetes_uncomplicated)) + ('-8'::integer * drug_abuse)) + (9 * fluid_electrolyte)) + ('-1'::integer * hypertension)) + (0 * hypothyroidism)) + (5 * liver_disease)) + (6 * lymphoma)) + (13 * metastatic_cancer)) + (4 * other_neurological)) + ('-4'::integer * obesity)) + (3 * paralysis)) + (0 * peptic_ulcer)) + (4 * peripheral_vascular)) + ('-4'::integer * psychoses)) + (5 * pulmonary_circulation)) + (6 * renal_failure)) + (0 * rheumatoid_arthritis)) + (8 * solid_tumor)) + (0 * valvular_disease)) + (8 * weight_loss))",
                "((((((((((((((((((((((((((((((0 * aids) + (0 * alcohol_abuse)) + ('-3'::integer * blood_loss_anemia)) + (8 * cardiac_arrhythmias)) + (9 * congestive_heart_failure)) + (3 * chronic_pulmonary)) + (12 * coagulopathy)) + (0 * deficiency_anemias)) + ('-5'::integer * depression)) + (1 * diabetes_complicated)) + (0 * diabetes_uncomplicated)) + ('-11'::integer * drug_abuse)) + (11 * fluid_electrolyte)) + ('-2'::integer * hypertension)) + (0 * hypothyroidism)) + (7 * liver_disease)) + (8 * lymphoma)) + (17 * metastatic_cancer)) + (5 * other_neurological)) + ('-5'::integer * obesity)) + (4 * paralysis)) + (0 * peptic_ulcer)) + (4 * peripheral_vascular)) + ('-6'::integer * psychoses)) + (5 * pulmonary_circulation)) + (7 * renal_failure)) + (0 * rheumatoid_arthritis)) + (10 * solid_tumor)) + (0 * valvular_disease)) + (10 * weight_loss))"
            ]
        }
    },
    "model.mimic.age_histogram": {
        "sql": "-- ------------------------------------------------------------------\n-- Title: Count the number of hospital admissions in equally sized bins of age\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n--  SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- ------------------------------------------------------------------\n\nWITH agetbl AS\n(\n    SELECT DATETIME_DIFF(ad.admittime, p.dob, 'YEAR') AS age\n      FROM admissions ad\n      INNER JOIN patients p\n      ON ad.subject_id = p.subject_id\n)\n, agebin AS\n(\n      SELECT age, width_bucket(age, 15, 100, 85) AS bucket\n      FROM agetbl\n)\nSELECT bucket+15 as age, count(*)\nFROM agebin\nGROUP BY bucket\nORDER BY bucket",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "age": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "count": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.age_histogram",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "((agebin.bucket + 15))",
                "(count(*))",
                "agebin.bucket"
            ],
            "Sort Key": [
                "agebin.bucket"
            ],
            "Plans": [
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE agetbl",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "datetime_diff(ad.admittime, p.dob, 'YEAR'::text)"
                    ],
                    "Inner Unique": true,
                    "Hash Cond": "(ad.subject_id = p.subject_id)",
                    "Plans": [
                        {
                            "Node Type": "Seq Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "admissions",
                            "Schema": "mimiciii_clinical",
                            "Alias": "ad",
                            "Output": [
                                "ad.row_id",
                                "ad.subject_id",
                                "ad.hadm_id",
                                "ad.admittime",
                                "ad.dischtime",
                                "ad.deathtime",
                                "ad.admission_type",
                                "ad.admission_location",
                                "ad.discharge_location",
                                "ad.insurance",
                                "ad.language",
                                "ad.religion",
                                "ad.marital_status",
                                "ad.ethnicity",
                                "ad.edregtime",
                                "ad.edouttime",
                                "ad.diagnosis",
                                "ad.hospital_expire_flag",
                                "ad.has_chartevents_data"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "p.dob",
                                "p.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "patients",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "p",
                                    "Output": [
                                        "p.dob",
                                        "p.subject_id"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE agebin",
                    "Parallel Aware": false,
                    "CTE Name": "agetbl",
                    "Alias": "agetbl",
                    "Output": [
                        "agetbl.age",
                        "width_bucket(agetbl.age, '15'::numeric, '100'::numeric, 85)"
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "(agebin.bucket + 15)",
                        "count(*)",
                        "agebin.bucket"
                    ],
                    "Group Key": [
                        "agebin.bucket"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "agebin",
                            "Alias": "agebin",
                            "Output": [
                                "agebin.age",
                                "agebin.bucket"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.basic_patient_info": {
        "sql": "-- ------------------------------------------------------------------\n-- Title: Retrieves basic patient information from the patients table\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n--  SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- ------------------------------------------------------------------\n\n\nSELECT subject_id, gender, dob\nFROM patients",
        "tables": [
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.patients.subject_id"
            ],
            "gender": [
                "mimiciii_clinical.patients.gender"
            ],
            "dob": [
                "mimiciii_clinical.patients.dob"
            ]
        },
        "table_name": "mimiciii_clinical.basic_patient_info",
        "plan": {
            "Node Type": "Seq Scan",
            "Parallel Aware": false,
            "Relation Name": "patients",
            "Schema": "mimiciii_clinical",
            "Alias": "patients",
            "Output": [
                "subject_id",
                "gender",
                "dob"
            ]
        }
    },
    "model.mimic.bun": {
        "sql": "-- --------------------------------------------------------\n-- Title: Create a distribution of BUN values for adult hospital admissions\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n--  SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- --------------------------------------------------------\n\nWITH agetbl AS\n(\n    SELECT ad.subject_id\n    FROM admissions ad\n    INNER JOIN patients p\n    ON ad.subject_id = p.subject_id\n    WHERE\n     -- filter to only adults\n    DATETIME_DIFF(ad.admittime, p.dob, 'YEAR') > 15\n    -- group by subject_id to ensure there is only 1 subject_id per row\n    group by ad.subject_id\n)\n, bun as\n(\n  SELECT width_bucket(valuenum, 0, 280, 280) AS bucket\n  FROM labevents le\n  INNER JOIN agetbl\n  ON le.subject_id = agetbl.subject_id\n  WHERE itemid IN (51006)\n)\nSELECT bucket as blood_urea_nitrogen, count(*)\nFROM bun\nGROUP BY bucket\nORDER BY bucket",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.labevents",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "blood_urea_nitrogen": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "count": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.bun",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "bun.bucket",
                "(count(*))"
            ],
            "Sort Key": [
                "bun.bucket"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE agetbl",
                    "Parallel Aware": false,
                    "Output": [
                        "ad.subject_id"
                    ],
                    "Group Key": [
                        "ad.subject_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "ad.subject_id"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "(ad.subject_id = p.subject_id)",
                            "Join Filter": "(datetime_diff(ad.admittime, p.dob, 'YEAR'::text) > '15'::numeric)",
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "admissions",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ad",
                                    "Output": [
                                        "ad.row_id",
                                        "ad.subject_id",
                                        "ad.hadm_id",
                                        "ad.admittime",
                                        "ad.dischtime",
                                        "ad.deathtime",
                                        "ad.admission_type",
                                        "ad.admission_location",
                                        "ad.discharge_location",
                                        "ad.insurance",
                                        "ad.language",
                                        "ad.religion",
                                        "ad.marital_status",
                                        "ad.ethnicity",
                                        "ad.edregtime",
                                        "ad.edouttime",
                                        "ad.diagnosis",
                                        "ad.hospital_expire_flag",
                                        "ad.has_chartevents_data"
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "p.subject_id",
                                        "p.dob"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "patients",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "p",
                                            "Output": [
                                                "p.subject_id",
                                                "p.dob"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE bun",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "width_bucket(le.valuenum, '0'::double precision, '280'::double precision, 280)"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "(agetbl.subject_id = le.subject_id)",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "agetbl.subject_id"
                            ],
                            "Sort Key": [
                                "agetbl.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "agetbl",
                                    "Alias": "agetbl",
                                    "Output": [
                                        "agetbl.subject_id"
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Materialize",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "le.valuenum",
                                "le.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "le.valuenum",
                                        "le.subject_id"
                                    ],
                                    "Sort Key": [
                                        "le.subject_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "labevents",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "le",
                                            "Output": [
                                                "le.valuenum",
                                                "le.subject_id"
                                            ],
                                            "Recheck Cond": "(le.itemid = 51006)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "labevents_idx03",
                                                    "Index Cond": "(le.itemid = 51006)"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "bun.bucket",
                        "count(*)"
                    ],
                    "Group Key": [
                        "bun.bucket"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "bun",
                            "Alias": "bun",
                            "Output": [
                                "bun.bucket"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.gcs": {
        "sql": "-- --------------------------------------------------------\n-- Title: Find the glasgow coma *MOTOR* score for each adult patient\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n--  SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- --------------------------------------------------------\n\nWITH agetbl AS\n(\n    SELECT ad.subject_id\n    FROM admissions ad\n    INNER JOIN patients p\n    ON ad.subject_id = p.subject_id\n    WHERE\n     -- filter to only adults\n    DATETIME_DIFF(ad.admittime, p.dob, 'YEAR') > 15\n    -- group by subject_id to ensure there is only 1 subject_id per row\n    group by ad.subject_id\n)\n, gcs as\n(\n    SELECT width_bucket(valuenum, 1, 30, 30) AS bucket\n    FROM chartevents ce\n    INNER JOIN agetbl\n    ON ce.subject_id = agetbl.subject_id\n    WHERE itemid IN\n    (\n        454 -- \"Motor Response\"\n      , 223900 -- \"GCS - Motor Response\"\n    )\n)\nSELECT bucket as GCS_Motor_Response, count(*)\nFROM gcs\nGROUP BY bucket\nORDER BY bucket",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "gcs_motor_response": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "count": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.gcs",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "gcs.bucket",
                "(count(*))"
            ],
            "Sort Key": [
                "gcs.bucket"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE agetbl",
                    "Parallel Aware": false,
                    "Output": [
                        "ad.subject_id"
                    ],
                    "Group Key": [
                        "ad.subject_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "ad.subject_id"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "(ad.subject_id = p.subject_id)",
                            "Join Filter": "(datetime_diff(ad.admittime, p.dob, 'YEAR'::text) > '15'::numeric)",
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "admissions",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ad",
                                    "Output": [
                                        "ad.row_id",
                                        "ad.subject_id",
                                        "ad.hadm_id",
                                        "ad.admittime",
                                        "ad.dischtime",
                                        "ad.deathtime",
                                        "ad.admission_type",
                                        "ad.admission_location",
                                        "ad.discharge_location",
                                        "ad.insurance",
                                        "ad.language",
                                        "ad.religion",
                                        "ad.marital_status",
                                        "ad.ethnicity",
                                        "ad.edregtime",
                                        "ad.edouttime",
                                        "ad.diagnosis",
                                        "ad.hospital_expire_flag",
                                        "ad.has_chartevents_data"
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "p.subject_id",
                                        "p.dob"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "patients",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "p",
                                            "Output": [
                                                "p.subject_id",
                                                "p.dob"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE gcs",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "width_bucket(ce.valuenum, '1'::double precision, '30'::double precision, 30)"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "(agetbl.subject_id = ce.subject_id)",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "agetbl.subject_id"
                            ],
                            "Sort Key": [
                                "agetbl.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "agetbl",
                                    "Alias": "agetbl",
                                    "Output": [
                                        "agetbl.subject_id"
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Materialize",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "ce.valuenum",
                                "ce.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "ce.valuenum",
                                        "ce.subject_id"
                                    ],
                                    "Sort Key": [
                                        "ce.subject_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Append",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_41",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce",
                                                    "Output": [
                                                        "ce.valuenum",
                                                        "ce.subject_id"
                                                    ],
                                                    "Filter": "(ce.itemid = ANY ('{454,223900}'::integer[]))"
                                                },
                                                {
                                                    "Node Type": "Bitmap Heap Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_177",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_1",
                                                    "Output": [
                                                        "ce_1.valuenum",
                                                        "ce_1.subject_id"
                                                    ],
                                                    "Recheck Cond": "(ce_1.itemid = ANY ('{454,223900}'::integer[]))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Bitmap Index Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Index Name": "chartevents_177_idx01",
                                                            "Index Cond": "(ce_1.itemid = ANY ('{454,223900}'::integer[]))"
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "gcs.bucket",
                        "count(*)"
                    ],
                    "Group Key": [
                        "gcs.bucket"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "gcs",
                            "Alias": "gcs",
                            "Output": [
                                "gcs.bucket"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.glucose": {
        "sql": "-- --------------------------------------------------------\n-- Title: Retrieves a glucose histogram of adult patients\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n--  SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- --------------------------------------------------------\n\nWITH agetbl AS\n(\n  SELECT ad.subject_id\n  FROM admissions ad\n  INNER JOIN patients p\n  ON ad.subject_id = p.subject_id\n  WHERE\n  -- filter to only adults\n  DATETIME_DIFF(ad.admittime, p.dob, 'YEAR') > 15\n  -- group by subject_id to ensure there is only 1 subject_id per row\n  group by ad.subject_id\n)\n, glc as\n(\n  SELECT width_bucket(valuenum, 0.5, 1000, 1000) AS bucket\n  FROM labevents le\n  INNER JOIN agetbl\n  ON le.subject_id = agetbl.subject_id\n  WHERE itemid IN (50809,50931)\n  AND valuenum IS NOT NULL\n)\nSELECT bucket as glucose, count(*)\nFROM glc\nGROUP BY bucket\nORDER BY bucket",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.labevents",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "glucose": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "count": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.glucose",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "glc.bucket",
                "(count(*))"
            ],
            "Sort Key": [
                "glc.bucket"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE agetbl",
                    "Parallel Aware": false,
                    "Output": [
                        "ad.subject_id"
                    ],
                    "Group Key": [
                        "ad.subject_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "ad.subject_id"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "(ad.subject_id = p.subject_id)",
                            "Join Filter": "(datetime_diff(ad.admittime, p.dob, 'YEAR'::text) > '15'::numeric)",
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "admissions",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ad",
                                    "Output": [
                                        "ad.row_id",
                                        "ad.subject_id",
                                        "ad.hadm_id",
                                        "ad.admittime",
                                        "ad.dischtime",
                                        "ad.deathtime",
                                        "ad.admission_type",
                                        "ad.admission_location",
                                        "ad.discharge_location",
                                        "ad.insurance",
                                        "ad.language",
                                        "ad.religion",
                                        "ad.marital_status",
                                        "ad.ethnicity",
                                        "ad.edregtime",
                                        "ad.edouttime",
                                        "ad.diagnosis",
                                        "ad.hospital_expire_flag",
                                        "ad.has_chartevents_data"
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "p.subject_id",
                                        "p.dob"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "patients",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "p",
                                            "Output": [
                                                "p.subject_id",
                                                "p.dob"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE glc",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "width_bucket(le.valuenum, '0.5'::double precision, '1000'::double precision, 1000)"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "(agetbl.subject_id = le.subject_id)",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "agetbl.subject_id"
                            ],
                            "Sort Key": [
                                "agetbl.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "agetbl",
                                    "Alias": "agetbl",
                                    "Output": [
                                        "agetbl.subject_id"
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Materialize",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "le.valuenum",
                                "le.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "le.valuenum",
                                        "le.subject_id"
                                    ],
                                    "Sort Key": [
                                        "le.subject_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "labevents",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "le",
                                            "Output": [
                                                "le.valuenum",
                                                "le.subject_id"
                                            ],
                                            "Recheck Cond": "(le.itemid = ANY ('{50809,50931}'::integer[]))",
                                            "Filter": "(le.valuenum IS NOT NULL)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "labevents_idx03",
                                                    "Index Cond": "(le.itemid = ANY ('{50809,50931}'::integer[]))"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "glc.bucket",
                        "count(*)"
                    ],
                    "Group Key": [
                        "glc.bucket"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "glc",
                            "Alias": "glc",
                            "Output": [
                                "glc.bucket"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.hco": {
        "sql": "-- --------------------------------------------------------\n-- Title: Create a histogram bicarbonate levels for all patients (adults and neonates)\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n--  SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- --------------------------------------------------------\n\nWITH agetbl AS\n(\n  SELECT ad.subject_id\n  FROM admissions ad\n  INNER JOIN patients p\n  ON ad.subject_id = p.subject_id\n  WHERE\n  -- filter to only adults\n  DATETIME_DIFF(ad.admittime, p.dob, 'YEAR') > 15\n  -- group by subject_id to ensure there is only 1 subject_id per row\n  group by ad.subject_id\n)\n, hco as\n(\n  SELECT width_bucket(valuenum, 0, 231, 231) AS bucket\n  FROM labevents le\n  INNER JOIN agetbl\n  ON le.subject_id = agetbl.subject_id\n  WHERE itemid IN (50803, 50804, 50882)\n  AND valuenum IS NOT NULL\n)\nSELECT bucket as bicarbonate, count(*)\nFROM hco\nGROUP BY bucket\nORDER BY bucket",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.labevents",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "bicarbonate": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "count": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.hco",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "hco.bucket",
                "(count(*))"
            ],
            "Sort Key": [
                "hco.bucket"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE agetbl",
                    "Parallel Aware": false,
                    "Output": [
                        "ad.subject_id"
                    ],
                    "Group Key": [
                        "ad.subject_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "ad.subject_id"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "(ad.subject_id = p.subject_id)",
                            "Join Filter": "(datetime_diff(ad.admittime, p.dob, 'YEAR'::text) > '15'::numeric)",
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "admissions",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ad",
                                    "Output": [
                                        "ad.row_id",
                                        "ad.subject_id",
                                        "ad.hadm_id",
                                        "ad.admittime",
                                        "ad.dischtime",
                                        "ad.deathtime",
                                        "ad.admission_type",
                                        "ad.admission_location",
                                        "ad.discharge_location",
                                        "ad.insurance",
                                        "ad.language",
                                        "ad.religion",
                                        "ad.marital_status",
                                        "ad.ethnicity",
                                        "ad.edregtime",
                                        "ad.edouttime",
                                        "ad.diagnosis",
                                        "ad.hospital_expire_flag",
                                        "ad.has_chartevents_data"
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "p.subject_id",
                                        "p.dob"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "patients",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "p",
                                            "Output": [
                                                "p.subject_id",
                                                "p.dob"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE hco",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "width_bucket(le.valuenum, '0'::double precision, '231'::double precision, 231)"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "(agetbl.subject_id = le.subject_id)",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "agetbl.subject_id"
                            ],
                            "Sort Key": [
                                "agetbl.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "agetbl",
                                    "Alias": "agetbl",
                                    "Output": [
                                        "agetbl.subject_id"
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Materialize",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "le.valuenum",
                                "le.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "le.valuenum",
                                        "le.subject_id"
                                    ],
                                    "Sort Key": [
                                        "le.subject_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "labevents",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "le",
                                            "Output": [
                                                "le.valuenum",
                                                "le.subject_id"
                                            ],
                                            "Recheck Cond": "(le.itemid = ANY ('{50803,50804,50882}'::integer[]))",
                                            "Filter": "(le.valuenum IS NOT NULL)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "labevents_idx03",
                                                    "Index Cond": "(le.itemid = ANY ('{50803,50804,50882}'::integer[]))"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "hco.bucket",
                        "count(*)"
                    ],
                    "Group Key": [
                        "hco.bucket"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "hco",
                            "Alias": "hco",
                            "Output": [
                                "hco.bucket"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.heart_rate": {
        "sql": "-- --------------------------------------------------------\n-- Title: Create a histogram of heart rates for adult patients\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n--  SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- --------------------------------------------------------\n\nWITH agetbl AS\n(\n  SELECT ad.subject_id\n  FROM admissions ad\n  INNER JOIN patients p\n  ON ad.subject_id = p.subject_id\n  WHERE\n  -- filter to only adults\n  DATETIME_DIFF(ad.admittime, p.dob, 'YEAR') > 15\n  -- group by subject_id to ensure there is only 1 subject_id per row\n  group by ad.subject_id\n)\n, hr as\n(\n  SELECT width_bucket(valuenum, 0, 300, 301) AS bucket\n  FROM chartevents ce\n  INNER JOIN agetbl\n  ON ce.subject_id = agetbl.subject_id\n  WHERE itemid in (211,220045)\n)\nSELECT bucket as heart_rate, count(*)\nFROM hr\nGROUP BY bucket\nORDER BY bucket",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "heart_rate": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "count": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.heart_rate",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "hr.bucket",
                "(count(*))"
            ],
            "Sort Key": [
                "hr.bucket"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE agetbl",
                    "Parallel Aware": false,
                    "Output": [
                        "ad.subject_id"
                    ],
                    "Group Key": [
                        "ad.subject_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "ad.subject_id"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "(ad.subject_id = p.subject_id)",
                            "Join Filter": "(datetime_diff(ad.admittime, p.dob, 'YEAR'::text) > '15'::numeric)",
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "admissions",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ad",
                                    "Output": [
                                        "ad.row_id",
                                        "ad.subject_id",
                                        "ad.hadm_id",
                                        "ad.admittime",
                                        "ad.dischtime",
                                        "ad.deathtime",
                                        "ad.admission_type",
                                        "ad.admission_location",
                                        "ad.discharge_location",
                                        "ad.insurance",
                                        "ad.language",
                                        "ad.religion",
                                        "ad.marital_status",
                                        "ad.ethnicity",
                                        "ad.edregtime",
                                        "ad.edouttime",
                                        "ad.diagnosis",
                                        "ad.hospital_expire_flag",
                                        "ad.has_chartevents_data"
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "p.subject_id",
                                        "p.dob"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "patients",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "p",
                                            "Output": [
                                                "p.subject_id",
                                                "p.dob"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE hr",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "width_bucket(ce.valuenum, '0'::double precision, '300'::double precision, 301)"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "(agetbl.subject_id = ce.subject_id)",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "agetbl.subject_id"
                            ],
                            "Sort Key": [
                                "agetbl.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "agetbl",
                                    "Alias": "agetbl",
                                    "Output": [
                                        "agetbl.subject_id"
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Materialize",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "ce.valuenum",
                                "ce.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "ce.valuenum",
                                        "ce.subject_id"
                                    ],
                                    "Sort Key": [
                                        "ce.subject_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Append",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_31",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce",
                                                    "Output": [
                                                        "ce.valuenum",
                                                        "ce.subject_id"
                                                    ],
                                                    "Filter": "(ce.itemid = ANY ('{211,220045}'::integer[]))"
                                                },
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_155",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_1",
                                                    "Output": [
                                                        "ce_1.valuenum",
                                                        "ce_1.subject_id"
                                                    ],
                                                    "Filter": "(ce_1.itemid = ANY ('{211,220045}'::integer[]))"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "hr.bucket",
                        "count(*)"
                    ],
                    "Group Key": [
                        "hr.bucket"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "hr",
                            "Alias": "hr",
                            "Output": [
                                "hr.bucket"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.height": {
        "sql": "-- --------------------------------------------------------\n-- Title: Create a histogram of heights for all patients\n--  note: some height ITEMIDs were not included, which may implicitly exclude\n--  some neonates from this calculation\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n--  SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- --------------------------------------------------------\n\nWITH ht AS\n(\n  SELECT valuenum, width_bucket(valuenum, 1, 200, 200) AS bucket\n  FROM chartevents\n  WHERE itemid in (920,226730)\n  AND valuenum IS NOT NULL\n  AND valuenum > 0\n  AND valuenum < 500\n)\nSELECT bucket as height, count(*)\nFROM ht\nGROUP BY bucket\nORDER BY bucket",
        "tables": [
            "mimiciii_clinical.chartevents"
        ],
        "columns": {
            "height": [
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "count": [
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum"
            ]
        },
        "table_name": "mimiciii_clinical.height",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "ht.bucket",
                "(count(*))"
            ],
            "Sort Key": [
                "ht.bucket"
            ],
            "Plans": [
                {
                    "Node Type": "Result",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE ht",
                    "Parallel Aware": false,
                    "Output": [
                        "chartevents_90.valuenum",
                        "width_bucket(chartevents_90.valuenum, '1'::double precision, '200'::double precision, 200)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Append",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_90",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "chartevents_90",
                                    "Output": [
                                        "chartevents_90.valuenum"
                                    ],
                                    "Recheck Cond": "(chartevents_90.itemid = ANY ('{920,226730}'::integer[]))",
                                    "Filter": "((chartevents_90.valuenum IS NOT NULL) AND (chartevents_90.valuenum > '0'::double precision) AND (chartevents_90.valuenum < '500'::double precision))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_90_idx01",
                                            "Index Cond": "(chartevents_90.itemid = ANY ('{920,226730}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_201",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "chartevents_201",
                                    "Output": [
                                        "chartevents_201.valuenum"
                                    ],
                                    "Recheck Cond": "(chartevents_201.itemid = ANY ('{920,226730}'::integer[]))",
                                    "Filter": "((chartevents_201.valuenum IS NOT NULL) AND (chartevents_201.valuenum > '0'::double precision) AND (chartevents_201.valuenum < '500'::double precision))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_201_idx01",
                                            "Index Cond": "(chartevents_201.itemid = ANY ('{920,226730}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "ht.bucket",
                        "count(*)"
                    ],
                    "Group Key": [
                        "ht.bucket"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "ht",
                            "Alias": "ht",
                            "Output": [
                                "ht.valuenum",
                                "ht.bucket"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.icd9agelimited": {
        "sql": "-- ------------------------------------------------------------------\n-- Title: Count the number of patients with a specific icd9 code above a certain age\n-- MIMIC version: MIMIC-III v1.3\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n-- SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- Reference: tompollard, alistairewj, erinhong for code taken\n-- from sodium.sql on the MIMIC III github repository\n-- ------------------------------------------------------------------\n\nWITH agetbl AS \n\t(\n\tSELECT ad.subject_id \n\tFROM admissions ad \n\tINNER JOIN patients p \n\tON ad.subject_id = p.subject_id \n\tWHERE \n\t-- filter to only adults above 30\n\tDATETIME_DIFF(ad.admittime, p.dob, 'YEAR') > 30\n\t-- group by subject_id to ensure there is only 1 subject_id per row\n\tGROUP BY ad.subject_id\n\t) \nSELECT COUNT(DISTINCT dia.subject_id) \nAS \"Hypertension Age 30+\" \nfrom diagnoses_icd dia \nINNER JOIN agetbl \nON dia.subject_id = agetbl.subject_id \nWHERE dia.icd9_code \n-- 401% relates to Hypertension\nLIKE '401%'",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.diagnoses_icd",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "Hypertension Age 30+": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.icd9agelimited",
        "plan": {
            "Node Type": "Aggregate",
            "Strategy": "Plain",
            "Partial Mode": "Simple",
            "Parallel Aware": false,
            "Output": [
                "count(DISTINCT dia.subject_id)"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE agetbl",
                    "Parallel Aware": false,
                    "Output": [
                        "ad.subject_id"
                    ],
                    "Group Key": [
                        "ad.subject_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "ad.subject_id"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "(ad.subject_id = p.subject_id)",
                            "Join Filter": "(datetime_diff(ad.admittime, p.dob, 'YEAR'::text) > '30'::numeric)",
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "admissions",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ad",
                                    "Output": [
                                        "ad.row_id",
                                        "ad.subject_id",
                                        "ad.hadm_id",
                                        "ad.admittime",
                                        "ad.dischtime",
                                        "ad.deathtime",
                                        "ad.admission_type",
                                        "ad.admission_location",
                                        "ad.discharge_location",
                                        "ad.insurance",
                                        "ad.language",
                                        "ad.religion",
                                        "ad.marital_status",
                                        "ad.ethnicity",
                                        "ad.edregtime",
                                        "ad.edouttime",
                                        "ad.diagnosis",
                                        "ad.hospital_expire_flag",
                                        "ad.has_chartevents_data"
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "p.subject_id",
                                        "p.dob"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "patients",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "p",
                                            "Output": [
                                                "p.subject_id",
                                                "p.dob"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "dia.subject_id"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "(dia.subject_id = agetbl.subject_id)",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "dia.subject_id"
                            ],
                            "Sort Key": [
                                "dia.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "diagnoses_icd",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "dia",
                                    "Output": [
                                        "dia.subject_id"
                                    ],
                                    "Filter": "((dia.icd9_code)::text ~~ '401%'::text)"
                                }
                            ]
                        },
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "agetbl.subject_id"
                            ],
                            "Sort Key": [
                                "agetbl.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "agetbl",
                                    "Alias": "agetbl",
                                    "Output": [
                                        "agetbl.subject_id"
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.icd9count": {
        "sql": "-- ------------------------------------------------------------------\n-- Title: Count the number of patients with a specific icd9 code\n-- MIMIC version: MIMIC-III v1.3\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n-- SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- Acknowledgement: Credit goes to Kris Kindle\n-- ------------------------------------------------------------------\n\nSELECT COUNT(DISTINCT subject_id) \nAS \"Hypertension\" \nfrom diagnoses_icd \nWHERE icd9_code \n-- 401% will search for all icd9 codes relating to hypertension\nLIKE '401%'",
        "tables": [
            "mimiciii_clinical.diagnoses_icd"
        ],
        "columns": {
            "Hypertension": [
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.icd9count",
        "plan": {
            "Node Type": "Aggregate",
            "Strategy": "Plain",
            "Partial Mode": "Simple",
            "Parallel Aware": false,
            "Output": [
                "count(DISTINCT subject_id)"
            ],
            "Plans": [
                {
                    "Node Type": "Gather",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "subject_id"
                    ],
                    "Workers Planned": 2,
                    "Single Copy": false,
                    "Plans": [
                        {
                            "Node Type": "Seq Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": true,
                            "Relation Name": "diagnoses_icd",
                            "Schema": "mimiciii_clinical",
                            "Alias": "diagnoses_icd",
                            "Output": [
                                "subject_id"
                            ],
                            "Filter": "((diagnoses_icd.icd9_code)::text ~~ '401%'::text)"
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.icd9vagehistogram": {
        "sql": "-- ------------------------------------------------------------------\n-- Title: Count the number of patients with a specific icd9 code and shows the output as a histogram with groups of age\n-- MIMIC version: MIMIC-III v1.3\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n-- SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- Acknowledgements: Made with help from Kris Kindle\n-- Reference: tompollard, alistairewj for code taken\n-- from age_hist.sql on the MIMIC III github repository\n-- ------------------------------------------------------------------\n\nWITH diatbl AS\n\t(\n\tSELECT DISTINCT ON (dia.subject_id) dia.subject_id, ad.admittime\n\tfrom diagnoses_icd dia\n\tINNER JOIN admissions ad\n\tON dia.subject_id = ad.subject_id\n\tWHERE dia.icd9_code\n\t-- 401% relates to hypertension\n\tLIKE '401%'\n\t),\nagetbl AS\n\t(\n\tSELECT dt.subject_id, DATETIME_DIFF(dt.admittime, p.dob, 'YEAR') AS age\n\tFROM diatbl dt\n\tINNER JOIN patients p\n\tON dt.subject_id = p.subject_id\n\t)\nSELECT\n        COUNT(*) AS TOTAL,\n        COUNT(CASE WHEN age >= 0 AND age < 16 THEN  '0 - 15' END) AS \"0-15\",\n        COUNT(CASE WHEN age >= 16 AND age < 21 THEN '16 - 20' END) AS \"16-20\",\n        COUNT(CASE WHEN age >= 21 AND age < 26 THEN '21 - 25' END) AS \"21-25\",\n        COUNT(CASE WHEN age >= 26 AND age < 31 THEN '26 - 30' END) AS \"26-30\",\n        COUNT(CASE WHEN age >= 31 AND age < 36 THEN '31 - 35' END) AS \"31-35\",\n        COUNT(CASE WHEN age >= 36 AND age < 41 THEN '36 - 40' END) AS \"36-40\",\n        COUNT(CASE WHEN age >= 41 AND age < 46 THEN '41 - 45' END) AS \"41-45\",\n        COUNT(CASE WHEN age >= 46 AND age < 51 THEN '46 - 50' END) AS \"46-50\",\n        COUNT(CASE WHEN age >= 51 AND age < 56 THEN '51 - 55' END) AS \"51-55\",\n        COUNT(CASE WHEN age >= 56 AND age < 61 THEN '56 - 60' END) AS \"56-60\",\n        COUNT(CASE WHEN age >= 61 AND age < 66 THEN '61 - 65' END) AS \"61-65\",\n        COUNT(CASE WHEN age >= 66 AND age < 71 THEN '66 - 70' END) AS \"66-70\",\n        COUNT(CASE WHEN age >= 71 AND age < 76 THEN '71 - 75' END) AS \"71-75\",\n        COUNT(CASE WHEN age >= 76 AND age < 81 THEN '76 - 80' END) AS \"76-80\",\n        COUNT(CASE WHEN age >= 81 AND age < 86 THEN '81 - 85' END) AS \"81-85\",\n        COUNT(CASE WHEN age >= 86 AND age < 91 THEN '86 - 90' END) AS \"86-91\",\n        COUNT(CASE WHEN age >= 91 THEN 'Over 91' END) AS \">91\"\nFROM agetbl",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.diagnoses_icd",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "total": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "0-15": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "16-20": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "21-25": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "26-30": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "31-35": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "36-40": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "41-45": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "46-50": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "51-55": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "56-60": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "61-65": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "66-70": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "71-75": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "76-80": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "81-85": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "86-91": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            ">91": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.icd9vagehistogram",
        "plan": {
            "Node Type": "Aggregate",
            "Strategy": "Plain",
            "Partial Mode": "Simple",
            "Parallel Aware": false,
            "Output": [
                "count(*)",
                "count(CASE WHEN ((agetbl.age >= '0'::numeric) AND (agetbl.age < '16'::numeric)) THEN '0 - 15'::text ELSE NULL::text END)",
                "count(CASE WHEN ((agetbl.age >= '16'::numeric) AND (agetbl.age < '21'::numeric)) THEN '16 - 20'::text ELSE NULL::text END)",
                "count(CASE WHEN ((agetbl.age >= '21'::numeric) AND (agetbl.age < '26'::numeric)) THEN '21 - 25'::text ELSE NULL::text END)",
                "count(CASE WHEN ((agetbl.age >= '26'::numeric) AND (agetbl.age < '31'::numeric)) THEN '26 - 30'::text ELSE NULL::text END)",
                "count(CASE WHEN ((agetbl.age >= '31'::numeric) AND (agetbl.age < '36'::numeric)) THEN '31 - 35'::text ELSE NULL::text END)",
                "count(CASE WHEN ((agetbl.age >= '36'::numeric) AND (agetbl.age < '41'::numeric)) THEN '36 - 40'::text ELSE NULL::text END)",
                "count(CASE WHEN ((agetbl.age >= '41'::numeric) AND (agetbl.age < '46'::numeric)) THEN '41 - 45'::text ELSE NULL::text END)",
                "count(CASE WHEN ((agetbl.age >= '46'::numeric) AND (agetbl.age < '51'::numeric)) THEN '46 - 50'::text ELSE NULL::text END)",
                "count(CASE WHEN ((agetbl.age >= '51'::numeric) AND (agetbl.age < '56'::numeric)) THEN '51 - 55'::text ELSE NULL::text END)",
                "count(CASE WHEN ((agetbl.age >= '56'::numeric) AND (agetbl.age < '61'::numeric)) THEN '56 - 60'::text ELSE NULL::text END)",
                "count(CASE WHEN ((agetbl.age >= '61'::numeric) AND (agetbl.age < '66'::numeric)) THEN '61 - 65'::text ELSE NULL::text END)",
                "count(CASE WHEN ((agetbl.age >= '66'::numeric) AND (agetbl.age < '71'::numeric)) THEN '66 - 70'::text ELSE NULL::text END)",
                "count(CASE WHEN ((agetbl.age >= '71'::numeric) AND (agetbl.age < '76'::numeric)) THEN '71 - 75'::text ELSE NULL::text END)",
                "count(CASE WHEN ((agetbl.age >= '76'::numeric) AND (agetbl.age < '81'::numeric)) THEN '76 - 80'::text ELSE NULL::text END)",
                "count(CASE WHEN ((agetbl.age >= '81'::numeric) AND (agetbl.age < '86'::numeric)) THEN '81 - 85'::text ELSE NULL::text END)",
                "count(CASE WHEN ((agetbl.age >= '86'::numeric) AND (agetbl.age < '91'::numeric)) THEN '86 - 90'::text ELSE NULL::text END)",
                "count(CASE WHEN (agetbl.age >= '91'::numeric) THEN 'Over 91'::text ELSE NULL::text END)"
            ],
            "Plans": [
                {
                    "Node Type": "Unique",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE diatbl",
                    "Parallel Aware": false,
                    "Output": [
                        "dia.subject_id",
                        "ad.admittime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "dia.subject_id",
                                "ad.admittime"
                            ],
                            "Sort Key": [
                                "dia.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "dia.subject_id",
                                        "ad.admittime"
                                    ],
                                    "Inner Unique": false,
                                    "Hash Cond": "(dia.subject_id = ad.subject_id)",
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "diagnoses_icd",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "dia",
                                            "Output": [
                                                "dia.row_id",
                                                "dia.subject_id",
                                                "dia.hadm_id",
                                                "dia.seq_num",
                                                "dia.icd9_code"
                                            ],
                                            "Filter": "((dia.icd9_code)::text ~~ '401%'::text)"
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ad.admittime",
                                                "ad.subject_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "admissions",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ad",
                                                    "Output": [
                                                        "ad.admittime",
                                                        "ad.subject_id"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE agetbl",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "dt.subject_id",
                        "datetime_diff(dt.admittime, p.dob, 'YEAR'::text)"
                    ],
                    "Inner Unique": true,
                    "Hash Cond": "(dt.subject_id = p.subject_id)",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "diatbl",
                            "Alias": "dt",
                            "Output": [
                                "dt.subject_id",
                                "dt.admittime"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "p.dob",
                                "p.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "patients",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "p",
                                    "Output": [
                                        "p.dob",
                                        "p.subject_id"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "CTE Name": "agetbl",
                    "Alias": "agetbl",
                    "Output": [
                        "agetbl.subject_id",
                        "agetbl.age"
                    ]
                }
            ]
        }
    },
    "model.mimic.icd9vicd9agelimited": {
        "sql": "-- ------------------------------------------------------------------\n-- Title: Count the number of patients with two specific icd9 codes above a certain age\n-- MIMIC version: MIMIC-III v1.3\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n-- SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- Reference: tompollard, alistairewj, erinhong for code taken\n-- from sodium.sql on the MIMIC III github repository\n-- ------------------------------------------------------------------\n\nWITH agetbl AS \n\t(\n\tSELECT ad.subject_id \n\tFROM admissions ad \n\tINNER JOIN patients p \n\tON ad.subject_id = p.subject_id \n\tWHERE \n\tDATETIME_DIFF(ad.admittime, p.dob, 'YEAR') > 40 \n\tGROUP BY ad.subject_id\n\t) \nSELECT COUNT(DISTINCT dia.subject_id) \nAS \"Obesity vs Hypertension Age 40+\" \nfrom diagnoses_icd dia \nINNER JOIN agetbl \nON dia.subject_id = agetbl.subject_id \nINNER JOIN diagnoses_icd dib \nON dia.subject_id = dib.subject_id \nWHERE dia.icd9_code \n-- 278% relates to obesity\nLIKE '278%' \nAND dib.icd9_code \n-- 401% relates to hypertension\nLIKE '401%'",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.diagnoses_icd",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "Obesity vs Hypertension Age 40+": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.icd9vicd9agelimited",
        "plan": {
            "Node Type": "Aggregate",
            "Strategy": "Plain",
            "Partial Mode": "Simple",
            "Parallel Aware": false,
            "Output": [
                "count(DISTINCT dia.subject_id)"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE agetbl",
                    "Parallel Aware": false,
                    "Output": [
                        "ad.subject_id"
                    ],
                    "Group Key": [
                        "ad.subject_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "ad.subject_id"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "(ad.subject_id = p.subject_id)",
                            "Join Filter": "(datetime_diff(ad.admittime, p.dob, 'YEAR'::text) > '40'::numeric)",
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "admissions",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ad",
                                    "Output": [
                                        "ad.row_id",
                                        "ad.subject_id",
                                        "ad.hadm_id",
                                        "ad.admittime",
                                        "ad.dischtime",
                                        "ad.deathtime",
                                        "ad.admission_type",
                                        "ad.admission_location",
                                        "ad.discharge_location",
                                        "ad.insurance",
                                        "ad.language",
                                        "ad.religion",
                                        "ad.marital_status",
                                        "ad.ethnicity",
                                        "ad.edregtime",
                                        "ad.edouttime",
                                        "ad.diagnosis",
                                        "ad.hospital_expire_flag",
                                        "ad.has_chartevents_data"
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "p.subject_id",
                                        "p.dob"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "patients",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "p",
                                            "Output": [
                                                "p.subject_id",
                                                "p.dob"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Nested Loop",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "dia.subject_id"
                    ],
                    "Inner Unique": false,
                    "Join Filter": "(dia.subject_id = dib.subject_id)",
                    "Plans": [
                        {
                            "Node Type": "Merge Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "dia.subject_id",
                                "agetbl.subject_id"
                            ],
                            "Inner Unique": false,
                            "Merge Cond": "(dia.subject_id = agetbl.subject_id)",
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "dia.subject_id"
                                    ],
                                    "Sort Key": [
                                        "dia.subject_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "diagnoses_icd",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "dia",
                                            "Output": [
                                                "dia.subject_id"
                                            ],
                                            "Filter": "((dia.icd9_code)::text ~~ '278%'::text)"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "agetbl.subject_id"
                                    ],
                                    "Sort Key": [
                                        "agetbl.subject_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "agetbl",
                                            "Alias": "agetbl",
                                            "Output": [
                                                "agetbl.subject_id"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Index Scan",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Scan Direction": "Forward",
                            "Index Name": "diagnoses_icd_idx01",
                            "Relation Name": "diagnoses_icd",
                            "Schema": "mimiciii_clinical",
                            "Alias": "dib",
                            "Output": [
                                "dib.row_id",
                                "dib.subject_id",
                                "dib.hadm_id",
                                "dib.seq_num",
                                "dib.icd9_code"
                            ],
                            "Index Cond": "(dib.subject_id = agetbl.subject_id)",
                            "Filter": "((dib.icd9_code)::text ~~ '401%'::text)"
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.icd9vicd9count": {
        "sql": "-- ------------------------------------------------------------------\n-- Title: Count the number of patients with two specific icd9 codes\n-- MIMIC version: MIMIC-III v1.3\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n-- SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- Acknowledgement: Credit goes to Kris Kindle\n-- ------------------------------------------------------------------\n\nSELECT COUNT(DISTINCT a.subject_id) \nAS \"Obesity and Dyslipidemia\" \nfrom diagnoses_icd a \nINNER JOIN diagnoses_icd b \nON a.subject_id = b.subject_id \nWHERE a.icd9_code\n-- 278% relates to obesity \nLIKE '278%' \nAND b.icd9_code \n-- 272 relates to Dyslipidemia\nLIKE '272%'",
        "tables": [
            "mimiciii_clinical.diagnoses_icd"
        ],
        "columns": {
            "Obesity and Dyslipidemia": [
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.icd9vicd9count",
        "plan": {
            "Node Type": "Aggregate",
            "Strategy": "Plain",
            "Partial Mode": "Simple",
            "Parallel Aware": false,
            "Output": [
                "count(DISTINCT a.subject_id)"
            ],
            "Plans": [
                {
                    "Node Type": "Gather",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "a.subject_id"
                    ],
                    "Workers Planned": 2,
                    "Single Copy": false,
                    "Plans": [
                        {
                            "Node Type": "Nested Loop",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "a.subject_id"
                            ],
                            "Inner Unique": false,
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": true,
                                    "Relation Name": "diagnoses_icd",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "a",
                                    "Output": [
                                        "a.row_id",
                                        "a.subject_id",
                                        "a.hadm_id",
                                        "a.seq_num",
                                        "a.icd9_code"
                                    ],
                                    "Filter": "((a.icd9_code)::text ~~ '278%'::text)"
                                },
                                {
                                    "Node Type": "Index Scan",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Scan Direction": "Forward",
                                    "Index Name": "diagnoses_icd_idx01",
                                    "Relation Name": "diagnoses_icd",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "b",
                                    "Output": [
                                        "b.row_id",
                                        "b.subject_id",
                                        "b.hadm_id",
                                        "b.seq_num",
                                        "b.icd9_code"
                                    ],
                                    "Index Cond": "(b.subject_id = a.subject_id)",
                                    "Filter": "((b.icd9_code)::text ~~ '272%'::text)"
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.min_surviving_bp": {
        "sql": "-- --------------------------------------------------------\n-- Title: Retrieves the systolic blood pressure of hospital survivors\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n--  SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- --------------------------------------------------------\n\nWITH agetbl AS\n(\n  SELECT ad.subject_id\n  FROM admissions ad\n  INNER JOIN patients p\n  ON ad.subject_id = p.subject_id\n  WHERE\n  -- filter to only adults\n  DATETIME_DIFF(ad.admittime, p.dob, 'YEAR') > 15\n  -- group by subject_id to ensure there is only 1 subject_id per row\n  group by ad.subject_id\n)\n, min_surviving_bp as\n(\n  SELECT p.subject_id, ce.icustay_id, min(valuenum) AS min_sbp\n  FROM chartevents ce\n  INNER JOIN agetbl\n  ON ce.subject_id = agetbl.subject_id\n  -- here we filter down to only survivors\n  INNER JOIN patients p\n  ON ce.subject_id = p.subject_id and p.expire_flag = 0\n  WHERE itemid IN (6, 51, 455, 6701, 220179, 220050)\n  GROUP BY p.subject_id, ce.icustay_id\n)\n, min_surviving_bp_counted as\n(\n  SELECT width_bucket(min_sbp, 0, 300, 300) AS bucket\n  FROM min_surviving_bp\n)\nSELECT bucket as systolic_blood_pressure, count(*)\nFROM min_surviving_bp_counted\nGROUP BY bucket\nORDER BY bucket",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "systolic_blood_pressure": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.expire_flag",
                "mimiciii_clinical.patients.subject_id"
            ],
            "count": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.expire_flag",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.min_surviving_bp",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "min_surviving_bp_counted.bucket",
                "(count(*))"
            ],
            "Sort Key": [
                "min_surviving_bp_counted.bucket"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE agetbl",
                    "Parallel Aware": false,
                    "Output": [
                        "ad.subject_id"
                    ],
                    "Group Key": [
                        "ad.subject_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "ad.subject_id"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "(ad.subject_id = p.subject_id)",
                            "Join Filter": "(datetime_diff(ad.admittime, p.dob, 'YEAR'::text) > '15'::numeric)",
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "admissions",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ad",
                                    "Output": [
                                        "ad.row_id",
                                        "ad.subject_id",
                                        "ad.hadm_id",
                                        "ad.admittime",
                                        "ad.dischtime",
                                        "ad.deathtime",
                                        "ad.admission_type",
                                        "ad.admission_location",
                                        "ad.discharge_location",
                                        "ad.insurance",
                                        "ad.language",
                                        "ad.religion",
                                        "ad.marital_status",
                                        "ad.ethnicity",
                                        "ad.edregtime",
                                        "ad.edouttime",
                                        "ad.diagnosis",
                                        "ad.hospital_expire_flag",
                                        "ad.has_chartevents_data"
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "p.subject_id",
                                        "p.dob"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "patients",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "p",
                                            "Output": [
                                                "p.subject_id",
                                                "p.dob"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE min_surviving_bp",
                    "Parallel Aware": false,
                    "Output": [
                        "p_1.subject_id",
                        "ce.icustay_id",
                        "min(ce.valuenum)"
                    ],
                    "Group Key": [
                        "p_1.subject_id",
                        "ce.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "p_1.subject_id",
                                "ce.icustay_id",
                                "ce.valuenum"
                            ],
                            "Sort Key": [
                                "p_1.subject_id",
                                "ce.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Merge Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "p_1.subject_id",
                                        "ce.icustay_id",
                                        "ce.valuenum"
                                    ],
                                    "Inner Unique": false,
                                    "Merge Cond": "(agetbl.subject_id = ce.subject_id)",
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "agetbl.subject_id"
                                            ],
                                            "Sort Key": [
                                                "agetbl.subject_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "agetbl",
                                                    "Alias": "agetbl",
                                                    "Output": [
                                                        "agetbl.subject_id"
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Materialize",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ce.icustay_id",
                                                "ce.valuenum",
                                                "ce.subject_id",
                                                "p_1.subject_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Sort",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Output": [
                                                        "ce.icustay_id",
                                                        "ce.valuenum",
                                                        "ce.subject_id",
                                                        "p_1.subject_id"
                                                    ],
                                                    "Sort Key": [
                                                        "ce.subject_id"
                                                    ],
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Hash Join",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Join Type": "Inner",
                                                            "Output": [
                                                                "ce.icustay_id",
                                                                "ce.valuenum",
                                                                "ce.subject_id",
                                                                "p_1.subject_id"
                                                            ],
                                                            "Inner Unique": true,
                                                            "Hash Cond": "(ce.subject_id = p_1.subject_id)",
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Append",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Heap Scan",
                                                                            "Parent Relationship": "Member",
                                                                            "Parallel Aware": false,
                                                                            "Relation Name": "chartevents_1",
                                                                            "Schema": "mimiciii_clinical",
                                                                            "Alias": "ce",
                                                                            "Output": [
                                                                                "ce.icustay_id",
                                                                                "ce.valuenum",
                                                                                "ce.subject_id"
                                                                            ],
                                                                            "Recheck Cond": "(ce.itemid = ANY ('{6,51,455,6701,220179,220050}'::integer[]))",
                                                                            "Plans": [
                                                                                {
                                                                                    "Node Type": "Bitmap Index Scan",
                                                                                    "Parent Relationship": "Outer",
                                                                                    "Parallel Aware": false,
                                                                                    "Index Name": "chartevents_1_idx01",
                                                                                    "Index Cond": "(ce.itemid = ANY ('{6,51,455,6701,220179,220050}'::integer[]))"
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "Node Type": "Seq Scan",
                                                                            "Parent Relationship": "Member",
                                                                            "Parallel Aware": false,
                                                                            "Relation Name": "chartevents_9",
                                                                            "Schema": "mimiciii_clinical",
                                                                            "Alias": "ce_1",
                                                                            "Output": [
                                                                                "ce_1.icustay_id",
                                                                                "ce_1.valuenum",
                                                                                "ce_1.subject_id"
                                                                            ],
                                                                            "Filter": "(ce_1.itemid = ANY ('{6,51,455,6701,220179,220050}'::integer[]))"
                                                                        },
                                                                        {
                                                                            "Node Type": "Seq Scan",
                                                                            "Parent Relationship": "Member",
                                                                            "Parallel Aware": false,
                                                                            "Relation Name": "chartevents_42",
                                                                            "Schema": "mimiciii_clinical",
                                                                            "Alias": "ce_2",
                                                                            "Output": [
                                                                                "ce_2.icustay_id",
                                                                                "ce_2.valuenum",
                                                                                "ce_2.subject_id"
                                                                            ],
                                                                            "Filter": "(ce_2.itemid = ANY ('{6,51,455,6701,220179,220050}'::integer[]))"
                                                                        },
                                                                        {
                                                                            "Node Type": "Bitmap Heap Scan",
                                                                            "Parent Relationship": "Member",
                                                                            "Parallel Aware": false,
                                                                            "Relation Name": "chartevents_130",
                                                                            "Schema": "mimiciii_clinical",
                                                                            "Alias": "ce_3",
                                                                            "Output": [
                                                                                "ce_3.icustay_id",
                                                                                "ce_3.valuenum",
                                                                                "ce_3.subject_id"
                                                                            ],
                                                                            "Recheck Cond": "(ce_3.itemid = ANY ('{6,51,455,6701,220179,220050}'::integer[]))",
                                                                            "Plans": [
                                                                                {
                                                                                    "Node Type": "Bitmap Index Scan",
                                                                                    "Parent Relationship": "Outer",
                                                                                    "Parallel Aware": false,
                                                                                    "Index Name": "chartevents_130_idx01",
                                                                                    "Index Cond": "(ce_3.itemid = ANY ('{6,51,455,6701,220179,220050}'::integer[]))"
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "Node Type": "Seq Scan",
                                                                            "Parent Relationship": "Member",
                                                                            "Parallel Aware": false,
                                                                            "Relation Name": "chartevents_159",
                                                                            "Schema": "mimiciii_clinical",
                                                                            "Alias": "ce_4",
                                                                            "Output": [
                                                                                "ce_4.icustay_id",
                                                                                "ce_4.valuenum",
                                                                                "ce_4.subject_id"
                                                                            ],
                                                                            "Filter": "(ce_4.itemid = ANY ('{6,51,455,6701,220179,220050}'::integer[]))"
                                                                        },
                                                                        {
                                                                            "Node Type": "Seq Scan",
                                                                            "Parent Relationship": "Member",
                                                                            "Parallel Aware": false,
                                                                            "Relation Name": "chartevents_164",
                                                                            "Schema": "mimiciii_clinical",
                                                                            "Alias": "ce_5",
                                                                            "Output": [
                                                                                "ce_5.icustay_id",
                                                                                "ce_5.valuenum",
                                                                                "ce_5.subject_id"
                                                                            ],
                                                                            "Filter": "(ce_5.itemid = ANY ('{6,51,455,6701,220179,220050}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Hash",
                                                                    "Parent Relationship": "Inner",
                                                                    "Parallel Aware": false,
                                                                    "Output": [
                                                                        "p_1.subject_id"
                                                                    ],
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Seq Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Relation Name": "patients",
                                                                            "Schema": "mimiciii_clinical",
                                                                            "Alias": "p_1",
                                                                            "Output": [
                                                                                "p_1.subject_id"
                                                                            ],
                                                                            "Filter": "(p_1.expire_flag = 0)"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE min_surviving_bp_counted",
                    "Parallel Aware": false,
                    "CTE Name": "min_surviving_bp",
                    "Alias": "min_surviving_bp",
                    "Output": [
                        "width_bucket(min_surviving_bp.min_sbp, '0'::double precision, '300'::double precision, 300)"
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "min_surviving_bp_counted.bucket",
                        "count(*)"
                    ],
                    "Group Key": [
                        "min_surviving_bp_counted.bucket"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "min_surviving_bp_counted",
                            "Alias": "min_surviving_bp_counted",
                            "Output": [
                                "min_surviving_bp_counted.bucket"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.mortality": {
        "sql": "-- ------------------------------------------------------------------\n-- Title: Calculate in-hospital, 30-day, and 1 year mortality (from hospital admission)\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n--  SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- Inclusion criteria: Adult (>15 year old) patients, *MOST RECENT* hospital admission\n-- ------------------------------------------------------------------\n\nWITH tmp as\n(\n    SELECT adm.hadm_id, admittime, dischtime, adm.deathtime, pat.dod\n    FROM admissions adm\n    INNER JOIN patients pat\n    ON adm.subject_id = pat.subject_id\n    -- filter out organ donor accounts\n    WHERE lower(diagnosis) NOT LIKE '%organ donor%'\n    -- at least 15 years old\n    AND DATETIME_DIFF(admittime, dob, 'YEAR') > 15\n    -- filter that removes hospital admissions with no corresponding ICU data\n    AND HAS_CHARTEVENTS_DATA = 1\n)\nSELECT COUNT(hadm_id) AS NumPat -- total number of patients\n, round( cast(COUNT(deathtime) AS NUMERIC)/COUNT(hadm_id)*100 , 4) AS HospMort -- % hospital mortality\n, round( cast(SUM(CASE WHEN dod < DATETIME_ADD(admittime, INTERVAL '30' DAY) THEN 1 ELSE 0 END) AS NUMERIC)/COUNT(hadm_id)*100.0 , 4) AS HospMort30day -- % 30 day mortality\n, round( cast(SUM(CASE WHEN dod < DATETIME_ADD(admittime, INTERVAL '1' YEAR) THEN 1 ELSE 0 END) AS NUMERIC)/COUNT(hadm_id)*100 , 4) AS HospMort1yr -- % 1 year mortality\nFROM tmp",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "numpat": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.diagnosis",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "hospmort": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.deathtime",
                "mimiciii_clinical.admissions.diagnosis",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "hospmort30day": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.diagnosis",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.dod",
                "mimiciii_clinical.patients.subject_id"
            ],
            "hospmort1yr": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.diagnosis",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.dod",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.mortality",
        "plan": {
            "Node Type": "Aggregate",
            "Strategy": "Plain",
            "Partial Mode": "Simple",
            "Parallel Aware": false,
            "Output": [
                "count(tmp.hadm_id)",
                "round((((count(tmp.deathtime))::numeric / (count(tmp.hadm_id))::numeric) * '100'::numeric), 4)",
                "round((((sum(CASE WHEN (tmp.dod < datetime_add(tmp.admittime, '30 days'::interval day)) THEN 1 ELSE 0 END))::numeric / (count(tmp.hadm_id))::numeric) * 100.0), 4)",
                "round((((sum(CASE WHEN (tmp.dod < datetime_add(tmp.admittime, '1 year'::interval year)) THEN 1 ELSE 0 END))::numeric / (count(tmp.hadm_id))::numeric) * '100'::numeric), 4)"
            ],
            "Plans": [
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE tmp",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "adm.hadm_id",
                        "adm.admittime",
                        "adm.dischtime",
                        "adm.deathtime",
                        "pat.dod"
                    ],
                    "Inner Unique": true,
                    "Hash Cond": "(adm.subject_id = pat.subject_id)",
                    "Join Filter": "(datetime_diff(adm.admittime, pat.dob, 'YEAR'::text) > '15'::numeric)",
                    "Plans": [
                        {
                            "Node Type": "Seq Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "admissions",
                            "Schema": "mimiciii_clinical",
                            "Alias": "adm",
                            "Output": [
                                "adm.row_id",
                                "adm.subject_id",
                                "adm.hadm_id",
                                "adm.admittime",
                                "adm.dischtime",
                                "adm.deathtime",
                                "adm.admission_type",
                                "adm.admission_location",
                                "adm.discharge_location",
                                "adm.insurance",
                                "adm.language",
                                "adm.religion",
                                "adm.marital_status",
                                "adm.ethnicity",
                                "adm.edregtime",
                                "adm.edouttime",
                                "adm.diagnosis",
                                "adm.hospital_expire_flag",
                                "adm.has_chartevents_data"
                            ],
                            "Filter": "((adm.has_chartevents_data = 1) AND (lower((adm.diagnosis)::text) !~~ '%organ donor%'::text))"
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "pat.dod",
                                "pat.subject_id",
                                "pat.dob"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "patients",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "pat",
                                    "Output": [
                                        "pat.dod",
                                        "pat.subject_id",
                                        "pat.dob"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "CTE Name": "tmp",
                    "Alias": "tmp",
                    "Output": [
                        "tmp.hadm_id",
                        "tmp.admittime",
                        "tmp.dischtime",
                        "tmp.deathtime",
                        "tmp.dod"
                    ]
                }
            ]
        }
    },
    "model.mimic.number_of_patients": {
        "sql": "-- --------------------------------------------------------\n-- Title: Counts the total number of patients\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n--  SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- --------------------------------------------------------\n\nSELECT count(*)\nFROM patients",
        "tables": [
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "count": [
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.dod",
                "mimiciii_clinical.patients.dod_hosp",
                "mimiciii_clinical.patients.dod_ssn",
                "mimiciii_clinical.patients.expire_flag",
                "mimiciii_clinical.patients.gender",
                "mimiciii_clinical.patients.row_id",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.number_of_patients",
        "plan": {
            "Node Type": "Aggregate",
            "Strategy": "Plain",
            "Partial Mode": "Simple",
            "Parallel Aware": false,
            "Output": [
                "count(*)"
            ],
            "Plans": [
                {
                    "Node Type": "Seq Scan",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Relation Name": "patients",
                    "Schema": "mimiciii_clinical",
                    "Alias": "patients",
                    "Output": [
                        "row_id",
                        "subject_id",
                        "gender",
                        "dob",
                        "dod",
                        "dod_hosp",
                        "dod_ssn",
                        "expire_flag"
                    ]
                }
            ]
        }
    },
    "model.mimic.potassium": {
        "sql": "-- --------------------------------------------------------\n-- Title: Creates a histogram of serum potassium for adult patients\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n--  SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- --------------------------------------------------------\n\nWITH agetbl AS\n(\n  SELECT ad.subject_id\n  FROM admissions ad\n  INNER JOIN patients p\n  ON ad.subject_id = p.subject_id\n  WHERE\n  -- filter to only adults\n  DATETIME_DIFF(ad.admittime, p.dob, 'YEAR') > 15\n  -- group by subject_id to ensure there is only 1 subject_id per row\n  group by ad.subject_id\n)\n, k as\n(\n  SELECT width_bucket(valuenum, 0, 10, 100) AS bucket\n  FROM labevents le\n  INNER JOIN agetbl\n  ON le.subject_id = agetbl.subject_id\n  WHERE itemid IN (50822, 50971)\n)\nSELECT round(cast(bucket as numeric) / 10,2) as potassium_value, count(*)\nFROM k\nGROUP BY bucket\nORDER BY bucket",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.labevents",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "potassium_value": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "count": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.potassium",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "(round(((k.bucket)::numeric / '10'::numeric), 2))",
                "(count(*))",
                "k.bucket"
            ],
            "Sort Key": [
                "k.bucket"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE agetbl",
                    "Parallel Aware": false,
                    "Output": [
                        "ad.subject_id"
                    ],
                    "Group Key": [
                        "ad.subject_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "ad.subject_id"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "(ad.subject_id = p.subject_id)",
                            "Join Filter": "(datetime_diff(ad.admittime, p.dob, 'YEAR'::text) > '15'::numeric)",
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "admissions",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ad",
                                    "Output": [
                                        "ad.row_id",
                                        "ad.subject_id",
                                        "ad.hadm_id",
                                        "ad.admittime",
                                        "ad.dischtime",
                                        "ad.deathtime",
                                        "ad.admission_type",
                                        "ad.admission_location",
                                        "ad.discharge_location",
                                        "ad.insurance",
                                        "ad.language",
                                        "ad.religion",
                                        "ad.marital_status",
                                        "ad.ethnicity",
                                        "ad.edregtime",
                                        "ad.edouttime",
                                        "ad.diagnosis",
                                        "ad.hospital_expire_flag",
                                        "ad.has_chartevents_data"
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "p.subject_id",
                                        "p.dob"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "patients",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "p",
                                            "Output": [
                                                "p.subject_id",
                                                "p.dob"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE k",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "width_bucket(le.valuenum, '0'::double precision, '10'::double precision, 100)"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "(agetbl.subject_id = le.subject_id)",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "agetbl.subject_id"
                            ],
                            "Sort Key": [
                                "agetbl.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "agetbl",
                                    "Alias": "agetbl",
                                    "Output": [
                                        "agetbl.subject_id"
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Materialize",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "le.valuenum",
                                "le.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "le.valuenum",
                                        "le.subject_id"
                                    ],
                                    "Sort Key": [
                                        "le.subject_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "labevents",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "le",
                                            "Output": [
                                                "le.valuenum",
                                                "le.subject_id"
                                            ],
                                            "Recheck Cond": "(le.itemid = ANY ('{50822,50971}'::integer[]))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "labevents_idx03",
                                                    "Index Cond": "(le.itemid = ANY ('{50822,50971}'::integer[]))"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "round(((k.bucket)::numeric / '10'::numeric), 2)",
                        "count(*)",
                        "k.bucket"
                    ],
                    "Group Key": [
                        "k.bucket"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "k",
                            "Alias": "k",
                            "Output": [
                                "k.bucket"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.rr": {
        "sql": "-- --------------------------------------------------------\n-- Title: Retrieves the respiration rate of adult patients\n--        only for patients recorded with carevue\n-- MIMIC version: MIMIC-III v1.3\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n--  SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- --------------------------------------------------------\n\nWITH agetbl AS\n(\n  SELECT ad.subject_id\n  FROM admissions ad\n  INNER JOIN patients p\n  ON ad.subject_id = p.subject_id\n  WHERE\n  -- filter to only adults\n  DATETIME_DIFF(ad.admittime, p.dob, 'YEAR') > 15\n  -- group by subject_id to ensure there is only 1 subject_id per row\n  group by ad.subject_id\n)\n, rr as\n(\n  SELECT valuenum, width_bucket(valuenum, 0, 130, 1400) AS bucket\n  FROM chartevents ce\n  INNER JOIN agetbl\n  ON ce.subject_id = agetbl.subject_id\n  WHERE itemid in (219, 615, 618)\n)\nSELECT round(cast(bucket as numeric) / 10,2) as respiration_rate, count(*)\nFROM rr\nGROUP BY bucket\nORDER BY bucket",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "respiration_rate": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "count": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.rr",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "(round(((rr.bucket)::numeric / '10'::numeric), 2))",
                "(count(*))",
                "rr.bucket"
            ],
            "Sort Key": [
                "rr.bucket"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE agetbl",
                    "Parallel Aware": false,
                    "Output": [
                        "ad.subject_id"
                    ],
                    "Group Key": [
                        "ad.subject_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "ad.subject_id"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "(ad.subject_id = p.subject_id)",
                            "Join Filter": "(datetime_diff(ad.admittime, p.dob, 'YEAR'::text) > '15'::numeric)",
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "admissions",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ad",
                                    "Output": [
                                        "ad.row_id",
                                        "ad.subject_id",
                                        "ad.hadm_id",
                                        "ad.admittime",
                                        "ad.dischtime",
                                        "ad.deathtime",
                                        "ad.admission_type",
                                        "ad.admission_location",
                                        "ad.discharge_location",
                                        "ad.insurance",
                                        "ad.language",
                                        "ad.religion",
                                        "ad.marital_status",
                                        "ad.ethnicity",
                                        "ad.edregtime",
                                        "ad.edouttime",
                                        "ad.diagnosis",
                                        "ad.hospital_expire_flag",
                                        "ad.has_chartevents_data"
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "p.subject_id",
                                        "p.dob"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "patients",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "p",
                                            "Output": [
                                                "p.subject_id",
                                                "p.dob"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE rr",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "ce.valuenum",
                        "width_bucket(ce.valuenum, '0'::double precision, '130'::double precision, 1400)"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "(agetbl.subject_id = ce.subject_id)",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "agetbl.subject_id"
                            ],
                            "Sort Key": [
                                "agetbl.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "agetbl",
                                    "Alias": "agetbl",
                                    "Output": [
                                        "agetbl.subject_id"
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Materialize",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "ce.valuenum",
                                "ce.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "ce.valuenum",
                                        "ce.subject_id"
                                    ],
                                    "Sort Key": [
                                        "ce.subject_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Append",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Heap Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_33",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce",
                                                    "Output": [
                                                        "ce.valuenum",
                                                        "ce.subject_id"
                                                    ],
                                                    "Recheck Cond": "(ce.itemid = ANY ('{219,615,618}'::integer[]))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Bitmap Index Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Index Name": "chartevents_33_idx01",
                                                            "Index Cond": "(ce.itemid = ANY ('{219,615,618}'::integer[]))"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_60",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_1",
                                                    "Output": [
                                                        "ce_1.valuenum",
                                                        "ce_1.subject_id"
                                                    ],
                                                    "Filter": "(ce_1.itemid = ANY ('{219,615,618}'::integer[]))"
                                                },
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_62",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_2",
                                                    "Output": [
                                                        "ce_2.valuenum",
                                                        "ce_2.subject_id"
                                                    ],
                                                    "Filter": "(ce_2.itemid = ANY ('{219,615,618}'::integer[]))"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "round(((rr.bucket)::numeric / '10'::numeric), 2)",
                        "count(*)",
                        "rr.bucket"
                    ],
                    "Group Key": [
                        "rr.bucket"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "rr",
                            "Alias": "rr",
                            "Output": [
                                "rr.valuenum",
                                "rr.bucket"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.sbp": {
        "sql": "-- --------------------------------------------------------\n-- Title: Retrieves the systolic blood pressure for adult patients\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n--  SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- --------------------------------------------------------\n\nWITH agetbl AS\n(\n  SELECT ad.subject_id\n  FROM admissions ad\n  INNER JOIN patients p\n  ON ad.subject_id = p.subject_id\n  WHERE\n  -- filter to only adults\n  DATETIME_DIFF(ad.admittime, p.dob, 'YEAR') > 15\n  -- group by subject_id to ensure there is only 1 subject_id per row\n  group by ad.subject_id\n)\n, sysbp as\n(\n  SELECT width_bucket(valuenum, 0, 300, 300) AS bucket\n  FROM chartevents ce\n  INNER JOIN agetbl\n  ON ce.subject_id = agetbl.subject_id\n  WHERE itemid IN\n  (\n      6 -- ABP [Systolic]\n    , 51 -- Arterial BP [Systolic]\n    , 455 -- NBP [Systolic]\n    , 6701 -- Arterial BP #2 [Systolic]\n    , 220050 -- Arterial Blood Pressure systolic\n    , 220179 -- Non Invasive Blood Pressure systolic\n  )\n)\nSELECT bucket as systolic_blood_pressure, count(*)\nFROM sysbp\nGROUP BY bucket\nORDER BY bucket",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "systolic_blood_pressure": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "count": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.sbp",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "sysbp.bucket",
                "(count(*))"
            ],
            "Sort Key": [
                "sysbp.bucket"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE agetbl",
                    "Parallel Aware": false,
                    "Output": [
                        "ad.subject_id"
                    ],
                    "Group Key": [
                        "ad.subject_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "ad.subject_id"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "(ad.subject_id = p.subject_id)",
                            "Join Filter": "(datetime_diff(ad.admittime, p.dob, 'YEAR'::text) > '15'::numeric)",
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "admissions",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ad",
                                    "Output": [
                                        "ad.row_id",
                                        "ad.subject_id",
                                        "ad.hadm_id",
                                        "ad.admittime",
                                        "ad.dischtime",
                                        "ad.deathtime",
                                        "ad.admission_type",
                                        "ad.admission_location",
                                        "ad.discharge_location",
                                        "ad.insurance",
                                        "ad.language",
                                        "ad.religion",
                                        "ad.marital_status",
                                        "ad.ethnicity",
                                        "ad.edregtime",
                                        "ad.edouttime",
                                        "ad.diagnosis",
                                        "ad.hospital_expire_flag",
                                        "ad.has_chartevents_data"
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "p.subject_id",
                                        "p.dob"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "patients",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "p",
                                            "Output": [
                                                "p.subject_id",
                                                "p.dob"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE sysbp",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "width_bucket(ce.valuenum, '0'::double precision, '300'::double precision, 300)"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "(agetbl.subject_id = ce.subject_id)",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "agetbl.subject_id"
                            ],
                            "Sort Key": [
                                "agetbl.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "agetbl",
                                    "Alias": "agetbl",
                                    "Output": [
                                        "agetbl.subject_id"
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Materialize",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "ce.valuenum",
                                "ce.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "ce.valuenum",
                                        "ce.subject_id"
                                    ],
                                    "Sort Key": [
                                        "ce.subject_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Append",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Heap Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_1",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce",
                                                    "Output": [
                                                        "ce.valuenum",
                                                        "ce.subject_id"
                                                    ],
                                                    "Recheck Cond": "(ce.itemid = ANY ('{6,51,455,6701,220050,220179}'::integer[]))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Bitmap Index Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Index Name": "chartevents_1_idx01",
                                                            "Index Cond": "(ce.itemid = ANY ('{6,51,455,6701,220050,220179}'::integer[]))"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_9",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_1",
                                                    "Output": [
                                                        "ce_1.valuenum",
                                                        "ce_1.subject_id"
                                                    ],
                                                    "Filter": "(ce_1.itemid = ANY ('{6,51,455,6701,220050,220179}'::integer[]))"
                                                },
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_42",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_2",
                                                    "Output": [
                                                        "ce_2.valuenum",
                                                        "ce_2.subject_id"
                                                    ],
                                                    "Filter": "(ce_2.itemid = ANY ('{6,51,455,6701,220050,220179}'::integer[]))"
                                                },
                                                {
                                                    "Node Type": "Bitmap Heap Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_130",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_3",
                                                    "Output": [
                                                        "ce_3.valuenum",
                                                        "ce_3.subject_id"
                                                    ],
                                                    "Recheck Cond": "(ce_3.itemid = ANY ('{6,51,455,6701,220050,220179}'::integer[]))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Bitmap Index Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Index Name": "chartevents_130_idx01",
                                                            "Index Cond": "(ce_3.itemid = ANY ('{6,51,455,6701,220050,220179}'::integer[]))"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_159",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_4",
                                                    "Output": [
                                                        "ce_4.valuenum",
                                                        "ce_4.subject_id"
                                                    ],
                                                    "Filter": "(ce_4.itemid = ANY ('{6,51,455,6701,220050,220179}'::integer[]))"
                                                },
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_164",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_5",
                                                    "Output": [
                                                        "ce_5.valuenum",
                                                        "ce_5.subject_id"
                                                    ],
                                                    "Filter": "(ce_5.itemid = ANY ('{6,51,455,6701,220050,220179}'::integer[]))"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "sysbp.bucket",
                        "count(*)"
                    ],
                    "Group Key": [
                        "sysbp.bucket"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "sysbp",
                            "Alias": "sysbp",
                            "Output": [
                                "sysbp.bucket"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.sodium": {
        "sql": "-- --------------------------------------------------------\n-- Title: Retrieves the blood serum sodium levels for adult patients\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n--  SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- --------------------------------------------------------\n\nWITH agetbl AS\n(\n  SELECT ad.subject_id\n  FROM admissions ad\n  INNER JOIN patients p\n  ON ad.subject_id = p.subject_id\n  WHERE\n  -- filter to only adults\n  DATETIME_DIFF(ad.admittime, p.dob, 'YEAR') > 15\n  -- group by subject_id to ensure there is only 1 subject_id per row\n  group by ad.subject_id\n)\n, sodium as\n(\n  SELECT width_bucket(valuenum, 0, 180, 180) AS bucket\n  FROM labevents le\n  INNER JOIN agetbl\n  ON le.subject_id = agetbl.subject_id\n  WHERE itemid IN (50824, 50983)\n)\nSELECT bucket as sodium, count(*)\nFROM sodium\nGROUP BY bucket\nORDER BY bucket",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.labevents",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "sodium": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "count": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.sodium",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "sodium.bucket",
                "(count(*))"
            ],
            "Sort Key": [
                "sodium.bucket"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE agetbl",
                    "Parallel Aware": false,
                    "Output": [
                        "ad.subject_id"
                    ],
                    "Group Key": [
                        "ad.subject_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "ad.subject_id"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "(ad.subject_id = p.subject_id)",
                            "Join Filter": "(datetime_diff(ad.admittime, p.dob, 'YEAR'::text) > '15'::numeric)",
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "admissions",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ad",
                                    "Output": [
                                        "ad.row_id",
                                        "ad.subject_id",
                                        "ad.hadm_id",
                                        "ad.admittime",
                                        "ad.dischtime",
                                        "ad.deathtime",
                                        "ad.admission_type",
                                        "ad.admission_location",
                                        "ad.discharge_location",
                                        "ad.insurance",
                                        "ad.language",
                                        "ad.religion",
                                        "ad.marital_status",
                                        "ad.ethnicity",
                                        "ad.edregtime",
                                        "ad.edouttime",
                                        "ad.diagnosis",
                                        "ad.hospital_expire_flag",
                                        "ad.has_chartevents_data"
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "p.subject_id",
                                        "p.dob"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "patients",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "p",
                                            "Output": [
                                                "p.subject_id",
                                                "p.dob"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE sodium",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "width_bucket(le.valuenum, '0'::double precision, '180'::double precision, 180)"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "(agetbl.subject_id = le.subject_id)",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "agetbl.subject_id"
                            ],
                            "Sort Key": [
                                "agetbl.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "agetbl",
                                    "Alias": "agetbl",
                                    "Output": [
                                        "agetbl.subject_id"
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Materialize",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "le.valuenum",
                                "le.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "le.valuenum",
                                        "le.subject_id"
                                    ],
                                    "Sort Key": [
                                        "le.subject_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "labevents",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "le",
                                            "Output": [
                                                "le.valuenum",
                                                "le.subject_id"
                                            ],
                                            "Recheck Cond": "(le.itemid = ANY ('{50824,50983}'::integer[]))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "labevents_idx03",
                                                    "Index Cond": "(le.itemid = ANY ('{50824,50983}'::integer[]))"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "sodium.bucket",
                        "count(*)"
                    ],
                    "Group Key": [
                        "sodium.bucket"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "sodium",
                            "Alias": "sodium",
                            "Output": [
                                "sodium.bucket"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.temp": {
        "sql": "-- --------------------------------------------------------\n-- Title: Retrieves the temperature of adult patients\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n--  SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- --------------------------------------------------------\n\nWITH agetbl AS\n(\n  SELECT ad.subject_id\n  FROM admissions ad\n  INNER JOIN patients p\n  ON ad.subject_id = p.subject_id\n  WHERE\n  -- filter to only adults\n  DATETIME_DIFF(ad.admittime, p.dob, 'YEAR') > 15\n  -- group by subject_id to ensure there is only 1 subject_id per row\n  group by ad.subject_id\n)\n, temp as\n(\n  SELECT width_bucket(\n      CASE\n        WHEN itemid IN (223762, 676, 677) THEN valuenum -- celsius\n        WHEN itemid IN (223761, 678, 679) THEN (valuenum - 32) * 5 / 9 --fahrenheit\n      END\n    , 30, 45, 160) AS bucket\n  FROM chartevents ce\n  INNER JOIN agetbl\n  ON ce.subject_id = agetbl.subject_id\n  WHERE itemid IN\n  (\n      676 -- Temperature C\n    , 677 -- Temperature C (calc)\n    , 678 -- Temperature F\n    , 679 -- Temperature F (calc)\n    , 223761 -- Temperature Fahrenheit\n    , 223762 -- Temperature Celsius\n  )\n)\nSELECT round((cast(bucket as numeric)/10) + 30,2) as temperature, count(*)\nFROM temp\nGROUP BY bucket\nORDER BY bucket",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "temperature": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "count": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.temp",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "(round((((temp.bucket)::numeric / '10'::numeric) + '30'::numeric), 2))",
                "(count(*))",
                "temp.bucket"
            ],
            "Sort Key": [
                "temp.bucket"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE agetbl",
                    "Parallel Aware": false,
                    "Output": [
                        "ad.subject_id"
                    ],
                    "Group Key": [
                        "ad.subject_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "ad.subject_id"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "(ad.subject_id = p.subject_id)",
                            "Join Filter": "(datetime_diff(ad.admittime, p.dob, 'YEAR'::text) > '15'::numeric)",
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "admissions",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ad",
                                    "Output": [
                                        "ad.row_id",
                                        "ad.subject_id",
                                        "ad.hadm_id",
                                        "ad.admittime",
                                        "ad.dischtime",
                                        "ad.deathtime",
                                        "ad.admission_type",
                                        "ad.admission_location",
                                        "ad.discharge_location",
                                        "ad.insurance",
                                        "ad.language",
                                        "ad.religion",
                                        "ad.marital_status",
                                        "ad.ethnicity",
                                        "ad.edregtime",
                                        "ad.edouttime",
                                        "ad.diagnosis",
                                        "ad.hospital_expire_flag",
                                        "ad.has_chartevents_data"
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "p.subject_id",
                                        "p.dob"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "patients",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "p",
                                            "Output": [
                                                "p.subject_id",
                                                "p.dob"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE temp",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "width_bucket(CASE WHEN (ce.itemid = ANY ('{223762,676,677}'::integer[])) THEN ce.valuenum WHEN (ce.itemid = ANY ('{223761,678,679}'::integer[])) THEN (((ce.valuenum - '32'::double precision) * '5'::double precision) / '9'::double precision) ELSE NULL::double precision END, '30'::double precision, '45'::double precision, 160)"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "(agetbl.subject_id = ce.subject_id)",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "agetbl.subject_id"
                            ],
                            "Sort Key": [
                                "agetbl.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "agetbl",
                                    "Alias": "agetbl",
                                    "Output": [
                                        "agetbl.subject_id"
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Materialize",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "ce.itemid",
                                "ce.valuenum",
                                "ce.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "ce.itemid",
                                        "ce.valuenum",
                                        "ce.subject_id"
                                    ],
                                    "Sort Key": [
                                        "ce.subject_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Append",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_74",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce",
                                                    "Output": [
                                                        "ce.itemid",
                                                        "ce.valuenum",
                                                        "ce.subject_id"
                                                    ],
                                                    "Filter": "(ce.itemid = ANY ('{676,677,678,679,223761,223762}'::integer[]))"
                                                },
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_75",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_1",
                                                    "Output": [
                                                        "ce_1.itemid",
                                                        "ce_1.valuenum",
                                                        "ce_1.subject_id"
                                                    ],
                                                    "Filter": "(ce_1.itemid = ANY ('{676,677,678,679,223761,223762}'::integer[]))"
                                                },
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_76",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_2",
                                                    "Output": [
                                                        "ce_2.itemid",
                                                        "ce_2.valuenum",
                                                        "ce_2.subject_id"
                                                    ],
                                                    "Filter": "(ce_2.itemid = ANY ('{676,677,678,679,223761,223762}'::integer[]))"
                                                },
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_77",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_3",
                                                    "Output": [
                                                        "ce_3.itemid",
                                                        "ce_3.valuenum",
                                                        "ce_3.subject_id"
                                                    ],
                                                    "Filter": "(ce_3.itemid = ANY ('{676,677,678,679,223761,223762}'::integer[]))"
                                                },
                                                {
                                                    "Node Type": "Bitmap Heap Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_172",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_4",
                                                    "Output": [
                                                        "ce_4.itemid",
                                                        "ce_4.valuenum",
                                                        "ce_4.subject_id"
                                                    ],
                                                    "Recheck Cond": "(ce_4.itemid = ANY ('{676,677,678,679,223761,223762}'::integer[]))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Bitmap Index Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Index Name": "chartevents_172_idx01",
                                                            "Index Cond": "(ce_4.itemid = ANY ('{676,677,678,679,223761,223762}'::integer[]))"
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "round((((temp.bucket)::numeric / '10'::numeric) + '30'::numeric), 2)",
                        "count(*)",
                        "temp.bucket"
                    ],
                    "Group Key": [
                        "temp.bucket"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "temp",
                            "Alias": "temp",
                            "Output": [
                                "temp.bucket"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.uo": {
        "sql": "-- --------------------------------------------------------\n-- Title: Retrieves the urine output of adult patients\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n--  SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- --------------------------------------------------------\n\nWITH agetbl AS\n(\n  SELECT ie.icustay_id, ie.intime\n  FROM icustays ie\n  INNER JOIN patients p\n  ON ie.subject_id = p.subject_id\n  WHERE\n  -- filter to only adults\n  DATETIME_DIFF(ie.intime, p.dob, 'YEAR') > 15\n)\n-- Urine output is measured hourly, but the individual values are not of interest\n-- Usually, you want an overall picture of patient output\n-- This query sums the data over the first 24 hours\n, uo_sum as\n(\n  select oe.icustay_id, sum(oe.VALUE) as urineoutput\n  FROM outputevents oe\n  INNER JOIN agetbl\n  ON oe.icustay_id = agetbl.icustay_id\n  -- and ensure the data occurs during the first day\n  and oe.charttime between agetbl.intime and (DATETIME_ADD(agetbl.intime, INTERVAL '1' DAY)) -- first ICU day\n  WHERE itemid IN\n  (\n  -- these are the most frequently occurring urine output observations in CareVue\n  40055, -- \"Urine Out Foley\"\n  43175, -- \"Urine .\"\n  40069, -- \"Urine Out Void\"\n  40094, -- \"Urine Out Condom Cath\"\n  40715, -- \"Urine Out Suprapubic\"\n  40473, -- \"Urine Out IleoConduit\"\n  40085, -- \"Urine Out Incontinent\"\n  40057, -- \"Urine Out Rt Nephrostomy\"\n  40056, -- \"Urine Out Lt Nephrostomy\"\n  40405, -- \"Urine Out Other\"\n  40428, -- \"Urine Out Straight Cath\"\n  40086,--\tUrine Out Incontinent\n  40096, -- \"Urine Out Ureteral Stent #1\"\n  40651, -- \"Urine Out Ureteral Stent #2\"\n\n  -- these are the most frequently occurring urine output observations in Metavision\n  226559, -- \"Foley\"\n  226560, -- \"Void\"\n  227510, -- \"TF Residual\"\n  226561, -- \"Condom Cath\"\n  226584, -- \"Ileoconduit\"\n  226563, -- \"Suprapubic\"\n  226564, -- \"R Nephrostomy\"\n  226565, -- \"L Nephrostomy\"\n  226567, --\tStraight Cath\n  226557, -- \"R Ureteral Stent\"\n  226558  -- \"L Ureteral Stent\"\n  )\n  group by oe.icustay_id\n)\n, uo as\n(\n  SELECT width_bucket(urineoutput, 0, 5000, 50) AS bucket\n  FROM uo_sum\n)\nSELECT bucket*100 as UrineOutput, COUNT(*)\nFROM uo\nGROUP BY bucket\nORDER BY bucket",
        "tables": [
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.outputevents",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "urineoutput": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.outputevents.charttime",
                "mimiciii_clinical.outputevents.icustay_id",
                "mimiciii_clinical.outputevents.itemid",
                "mimiciii_clinical.outputevents.value",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "count": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.outputevents.charttime",
                "mimiciii_clinical.outputevents.icustay_id",
                "mimiciii_clinical.outputevents.itemid",
                "mimiciii_clinical.outputevents.value",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.uo",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "((uo.bucket * 100))",
                "(count(*))",
                "uo.bucket"
            ],
            "Sort Key": [
                "uo.bucket"
            ],
            "Plans": [
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE agetbl",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "ie.icustay_id",
                        "ie.intime"
                    ],
                    "Inner Unique": true,
                    "Hash Cond": "(ie.subject_id = p.subject_id)",
                    "Join Filter": "(datetime_diff(ie.intime, p.dob, 'YEAR'::text) > '15'::numeric)",
                    "Plans": [
                        {
                            "Node Type": "Seq Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "icustays",
                            "Schema": "mimiciii_clinical",
                            "Alias": "ie",
                            "Output": [
                                "ie.row_id",
                                "ie.subject_id",
                                "ie.hadm_id",
                                "ie.icustay_id",
                                "ie.dbsource",
                                "ie.first_careunit",
                                "ie.last_careunit",
                                "ie.first_wardid",
                                "ie.last_wardid",
                                "ie.intime",
                                "ie.outtime",
                                "ie.los"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "p.subject_id",
                                "p.dob"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "patients",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "p",
                                    "Output": [
                                        "p.subject_id",
                                        "p.dob"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE uo_sum",
                    "Parallel Aware": false,
                    "Output": [
                        "oe.icustay_id",
                        "sum(oe.value)"
                    ],
                    "Group Key": [
                        "oe.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "oe.icustay_id",
                                "oe.value"
                            ],
                            "Inner Unique": false,
                            "Hash Cond": "(agetbl.icustay_id = oe.icustay_id)",
                            "Join Filter": "((oe.charttime >= agetbl.intime) AND (oe.charttime <= datetime_add(agetbl.intime, '1 day'::interval day)))",
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "agetbl",
                                    "Alias": "agetbl",
                                    "Output": [
                                        "agetbl.icustay_id",
                                        "agetbl.intime"
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "oe.icustay_id",
                                        "oe.value",
                                        "oe.charttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "outputevents_idx02",
                                            "Relation Name": "outputevents",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "oe",
                                            "Output": [
                                                "oe.icustay_id",
                                                "oe.value",
                                                "oe.charttime"
                                            ],
                                            "Index Cond": "(oe.itemid = ANY ('{40055,43175,40069,40094,40715,40473,40085,40057,40056,40405,40428,40086,40096,40651,226559,226560,227510,226561,226584,226563,226564,226565,226567,226557,226558}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE uo",
                    "Parallel Aware": false,
                    "CTE Name": "uo_sum",
                    "Alias": "uo_sum",
                    "Output": [
                        "width_bucket(uo_sum.urineoutput, '0'::double precision, '5000'::double precision, 50)"
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "(uo.bucket * 100)",
                        "count(*)",
                        "uo.bucket"
                    ],
                    "Group Key": [
                        "uo.bucket"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "uo",
                            "Alias": "uo",
                            "Output": [
                                "uo.bucket"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.wbc": {
        "sql": "-- --------------------------------------------------------\n-- Title: Retrieves the white blood cell count for adult patients\n-- Notes: this query does not specify a schema. To run it on your local\n-- MIMIC schema, run the following command:\n--  SET SEARCH_PATH TO mimiciii\n-- Where \"mimiciii\" is the name of your schema, and may be different.\n-- --------------------------------------------------------\n\nWITH agetbl AS\n(\n  SELECT ad.subject_id\n  FROM admissions ad\n  INNER JOIN patients p\n  ON ad.subject_id = p.subject_id\n  WHERE\n  -- filter to only adults\n  DATETIME_DIFF(ad.admittime, p.dob, 'YEAR') > 15\n  -- group by subject_id to ensure there is only 1 subject_id per row\n  group by ad.subject_id\n)\n, wbc as\n(\n  SELECT width_bucket(valuenum, 0, 100, 1001) AS bucket\n  FROM labevents le\n  INNER JOIN agetbl\n  ON le.subject_id = agetbl.subject_id\n  WHERE itemid in (51300, 51301)\n  AND valuenum IS NOT NULL\n)\nSELECT round((cast(bucket as numeric)/10),2) as white_blood_cell_count, count(*)\nFROM wbc\nGROUP BY bucket\nORDER BY bucket",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.labevents",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "white_blood_cell_count": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "count": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.wbc",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "(round(((wbc.bucket)::numeric / '10'::numeric), 2))",
                "(count(*))",
                "wbc.bucket"
            ],
            "Sort Key": [
                "wbc.bucket"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE agetbl",
                    "Parallel Aware": false,
                    "Output": [
                        "ad.subject_id"
                    ],
                    "Group Key": [
                        "ad.subject_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "ad.subject_id"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "(ad.subject_id = p.subject_id)",
                            "Join Filter": "(datetime_diff(ad.admittime, p.dob, 'YEAR'::text) > '15'::numeric)",
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "admissions",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ad",
                                    "Output": [
                                        "ad.row_id",
                                        "ad.subject_id",
                                        "ad.hadm_id",
                                        "ad.admittime",
                                        "ad.dischtime",
                                        "ad.deathtime",
                                        "ad.admission_type",
                                        "ad.admission_location",
                                        "ad.discharge_location",
                                        "ad.insurance",
                                        "ad.language",
                                        "ad.religion",
                                        "ad.marital_status",
                                        "ad.ethnicity",
                                        "ad.edregtime",
                                        "ad.edouttime",
                                        "ad.diagnosis",
                                        "ad.hospital_expire_flag",
                                        "ad.has_chartevents_data"
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "p.subject_id",
                                        "p.dob"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "patients",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "p",
                                            "Output": [
                                                "p.subject_id",
                                                "p.dob"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE wbc",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "width_bucket(le.valuenum, '0'::double precision, '100'::double precision, 1001)"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "(agetbl.subject_id = le.subject_id)",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "agetbl.subject_id"
                            ],
                            "Sort Key": [
                                "agetbl.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "agetbl",
                                    "Alias": "agetbl",
                                    "Output": [
                                        "agetbl.subject_id"
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Materialize",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "le.valuenum",
                                "le.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "le.valuenum",
                                        "le.subject_id"
                                    ],
                                    "Sort Key": [
                                        "le.subject_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "labevents",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "le",
                                            "Output": [
                                                "le.valuenum",
                                                "le.subject_id"
                                            ],
                                            "Recheck Cond": "(le.itemid = ANY ('{51300,51301}'::integer[]))",
                                            "Filter": "(le.valuenum IS NOT NULL)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "labevents_idx03",
                                                    "Index Cond": "(le.itemid = ANY ('{51300,51301}'::integer[]))"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "round(((wbc.bucket)::numeric / '10'::numeric), 2)",
                        "count(*)",
                        "wbc.bucket"
                    ],
                    "Group Key": [
                        "wbc.bucket"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "wbc",
                            "Alias": "wbc",
                            "Output": [
                                "wbc.bucket"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.heightweight": {
        "sql": "-- ------------------------------------------------------------------\n-- Title: Extract height and weight for ICUSTAY_IDs\n-- Description: This query gets the first, minimum, and maximum weight and height\n--        for a single ICUSTAY_ID. It extracts data from the CHARTEVENTS table.\n-- MIMIC version: MIMIC-III v1.4\n-- ------------------------------------------------------------------\n\n-- prep height\nWITH ht_stg AS\n(\n  SELECT \n    c.subject_id, c.icustay_id, c.charttime,\n    -- Ensure that all heights are in centimeters, and fix data as needed\n    CASE\n      WHEN c.itemid IN (920, 1394, 4187, 3486, 226707)\n      THEN\n        CASE\n        -- rule for neonates\n        WHEN c.charttime <= DATETIME_ADD(pt.dob, INTERVAL '1 YEAR')\n         AND (c.valuenum * 2.54) < 80\n          THEN c.valuenum * 2.54\n        -- rule for adults\n        WHEN c.charttime >  DATETIME_ADD(pt.dob, INTERVAL '1 YEAR')\n         AND (c.valuenum * 2.54) > 120\n         AND (c.valuenum * 2.54) < 230\n          THEN c.valuenum * 2.54\n        ELSE NULL END\n      ELSE\n        CASE\n        -- rule for neonates\n        WHEN c.charttime <= DATETIME_ADD(pt.dob, INTERVAL '1 YEAR')\n         AND c.valuenum < 80\n          THEN c.valuenum\n        -- rule for adults\n        WHEN c.charttime >  DATETIME_ADD(pt.dob, INTERVAL '1 YEAR')\n         AND c.valuenum > 120\n         AND c.valuenum < 230\n          THEN c.valuenum\n        ELSE NULL END\n    END AS height\n  FROM chartevents c\n  INNER JOIN patients pt\n    ON c.subject_id = pt.subject_id\n  WHERE c.valuenum IS NOT NULL\n  AND c.valuenum != 0\n  -- exclude rows marked as error\n  AND COALESCE(c.error, 0) = 0\n  AND c.itemid IN\n  (\n    -- CareVue\n    920, 1394, 4187, 3486,  -- Height inches\n    3485, 4188              -- Height cm\n    -- Metavision\n    , 226707 -- Height (measured in inches)\n    -- note we intentionally ignore the below ITEMID in metavision\n    -- these are duplicate data in a different unit\n    -- , 226730 -- Height (cm)\n  )\n)\nSELECT \n  ie.icustay_id,\n  ROUND(CAST(wt.weight_first AS NUMERIC), 2) AS weight_first,\n  ROUND(CAST(wt.weight_min AS NUMERIC), 2) AS weight_min,\n  ROUND(CAST(wt.weight_max AS NUMERIC), 2) AS weight_max,\n  ROUND(CAST(ht.height_first AS NUMERIC), 2) AS height_first,\n  ROUND(CAST(ht.height_min AS NUMERIC), 2) AS height_min,\n  ROUND(CAST(ht.height_max AS NUMERIC), 2) AS height_max\nFROM icustays ie\n-- get weight from weight_durations table\nLEFT JOIN\n(\n  SELECT icustay_id,\n    MIN(CASE WHEN rn = 1 THEN weight ELSE NULL END) as weight_first,\n    MIN(weight) AS weight_min,\n    MAX(weight) AS weight_max\n  FROM\n  (\n    SELECT\n      icustay_id,\n      weight,\n      ROW_NUMBER() OVER (PARTITION BY icustay_id ORDER BY starttime) as rn\n    FROM \"mimic\".\"mimiciii_clinical\".\"weight_durations\"\n  ) wt_stg\n  GROUP BY icustay_id\n) wt\n  ON ie.icustay_id = wt.icustay_id\n-- get first/min/max height from above, after filtering bad data\nLEFT JOIN\n(\n  SELECT icustay_id,\n    MIN(CASE WHEN rn = 1 THEN height ELSE NULL END) as height_first,\n    MIN(height) AS height_min,\n    MAX(height) AS height_max\n  FROM\n  (\n    SELECT\n      icustay_id,\n      height,\n      ROW_NUMBER() OVER (PARTITION BY icustay_id ORDER BY charttime) as rn\n    FROM ht_stg\n  ) ht_stg2\n  GROUP BY icustay_id\n) ht\n  ON ie.icustay_id = ht.icustay_id\nORDER BY icustay_id",
        "tables": [
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.patients",
            "mimiciii_clinical.weight_durations"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime"
            ],
            "weight_first": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime",
                "mimiciii_clinical.weight_durations.weight"
            ],
            "weight_min": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime",
                "mimiciii_clinical.weight_durations.weight"
            ],
            "weight_max": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime",
                "mimiciii_clinical.weight_durations.weight"
            ],
            "height_first": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime"
            ],
            "height_min": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime"
            ],
            "height_max": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime"
            ]
        },
        "table_name": "mimiciii_clinical.heightweight",
        "plan": {
            "Node Type": "Merge Join",
            "Parallel Aware": false,
            "Join Type": "Left",
            "Output": [
                "ie.icustay_id",
                "round(((min(CASE WHEN ((row_number() OVER (?)) = 1) THEN weight_durations.weight ELSE NULL::double precision END)))::numeric, 2)",
                "round(((min(weight_durations.weight)))::numeric, 2)",
                "round(((max(weight_durations.weight)))::numeric, 2)",
                "round(((min(CASE WHEN ((row_number() OVER (?)) = 1) THEN ht_stg.height ELSE NULL::double precision END)))::numeric, 2)",
                "round(((min(ht_stg.height)))::numeric, 2)",
                "round(((max(ht_stg.height)))::numeric, 2)"
            ],
            "Inner Unique": true,
            "Merge Cond": "(ie.icustay_id = ht_stg.icustay_id)",
            "Plans": [
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE ht_stg",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "c.subject_id",
                        "c.icustay_id",
                        "c.charttime",
                        "CASE WHEN (c.itemid = ANY ('{920,1394,4187,3486,226707}'::integer[])) THEN CASE WHEN ((c.charttime <= datetime_add(pt.dob, '1 year'::interval)) AND ((c.valuenum * '2.54'::double precision) < '80'::double precision)) THEN (c.valuenum * '2.54'::double precision) WHEN ((c.charttime > datetime_add(pt.dob, '1 year'::interval)) AND ((c.valuenum * '2.54'::double precision) > '120'::double precision) AND ((c.valuenum * '2.54'::double precision) < '230'::double precision)) THEN (c.valuenum * '2.54'::double precision) ELSE NULL::double precision END ELSE CASE WHEN ((c.charttime <= datetime_add(pt.dob, '1 year'::interval)) AND (c.valuenum < '80'::double precision)) THEN c.valuenum WHEN ((c.charttime > datetime_add(pt.dob, '1 year'::interval)) AND (c.valuenum > '120'::double precision) AND (c.valuenum < '230'::double precision)) THEN c.valuenum ELSE NULL::double precision END END"
                    ],
                    "Inner Unique": true,
                    "Hash Cond": "(c.subject_id = pt.subject_id)",
                    "Plans": [
                        {
                            "Node Type": "Append",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_90",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "c",
                                    "Output": [
                                        "c.subject_id",
                                        "c.icustay_id",
                                        "c.charttime",
                                        "c.itemid",
                                        "c.valuenum"
                                    ],
                                    "Recheck Cond": "(c.itemid = ANY ('{920,1394,4187,3486,3485,4188,226707}'::integer[]))",
                                    "Filter": "((c.valuenum IS NOT NULL) AND (c.valuenum <> '0'::double precision) AND (COALESCE(c.error, 0) = 0))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_90_idx01",
                                            "Index Cond": "(c.itemid = ANY ('{920,1394,4187,3486,3485,4188,226707}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_98",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "c_1",
                                    "Output": [
                                        "c_1.subject_id",
                                        "c_1.icustay_id",
                                        "c_1.charttime",
                                        "c_1.itemid",
                                        "c_1.valuenum"
                                    ],
                                    "Recheck Cond": "(c_1.itemid = ANY ('{920,1394,4187,3486,3485,4188,226707}'::integer[]))",
                                    "Filter": "((c_1.valuenum IS NOT NULL) AND (c_1.valuenum <> '0'::double precision) AND (COALESCE(c_1.error, 0) = 0))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_98_idx01",
                                            "Index Cond": "(c_1.itemid = ANY ('{920,1394,4187,3486,3485,4188,226707}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_110",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "c_2",
                                    "Output": [
                                        "c_2.subject_id",
                                        "c_2.icustay_id",
                                        "c_2.charttime",
                                        "c_2.itemid",
                                        "c_2.valuenum"
                                    ],
                                    "Recheck Cond": "(c_2.itemid = ANY ('{920,1394,4187,3486,3485,4188,226707}'::integer[]))",
                                    "Filter": "((c_2.valuenum IS NOT NULL) AND (c_2.valuenum <> '0'::double precision) AND (COALESCE(c_2.error, 0) = 0))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_110_idx01",
                                            "Index Cond": "(c_2.itemid = ANY ('{920,1394,4187,3486,3485,4188,226707}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_121",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "c_3",
                                    "Output": [
                                        "c_3.subject_id",
                                        "c_3.icustay_id",
                                        "c_3.charttime",
                                        "c_3.itemid",
                                        "c_3.valuenum"
                                    ],
                                    "Recheck Cond": "(c_3.itemid = ANY ('{920,1394,4187,3486,3485,4188,226707}'::integer[]))",
                                    "Filter": "((c_3.valuenum IS NOT NULL) AND (c_3.valuenum <> '0'::double precision) AND (COALESCE(c_3.error, 0) = 0))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_121_idx01",
                                            "Index Cond": "(c_3.itemid = ANY ('{920,1394,4187,3486,3485,4188,226707}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_201",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "c_4",
                                    "Output": [
                                        "c_4.subject_id",
                                        "c_4.icustay_id",
                                        "c_4.charttime",
                                        "c_4.itemid",
                                        "c_4.valuenum"
                                    ],
                                    "Recheck Cond": "(c_4.itemid = ANY ('{920,1394,4187,3486,3485,4188,226707}'::integer[]))",
                                    "Filter": "((c_4.valuenum IS NOT NULL) AND (c_4.valuenum <> '0'::double precision) AND (COALESCE(c_4.error, 0) = 0))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_201_idx01",
                                            "Index Cond": "(c_4.itemid = ANY ('{920,1394,4187,3486,3485,4188,226707}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "pt.dob",
                                "pt.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "patients",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "pt",
                                    "Output": [
                                        "pt.dob",
                                        "pt.subject_id"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "ie.icustay_id",
                        "(min(CASE WHEN ((row_number() OVER (?)) = 1) THEN weight_durations.weight ELSE NULL::double precision END))",
                        "(min(weight_durations.weight))",
                        "(max(weight_durations.weight))"
                    ],
                    "Inner Unique": true,
                    "Merge Cond": "(ie.icustay_id = weight_durations.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "Index Only Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Scan Direction": "Forward",
                            "Index Name": "icustays_idx02",
                            "Relation Name": "icustays",
                            "Schema": "mimiciii_clinical",
                            "Alias": "ie",
                            "Output": [
                                "ie.icustay_id"
                            ]
                        },
                        {
                            "Node Type": "Aggregate",
                            "Strategy": "Sorted",
                            "Partial Mode": "Simple",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "weight_durations.icustay_id",
                                "min(CASE WHEN ((row_number() OVER (?)) = 1) THEN weight_durations.weight ELSE NULL::double precision END)",
                                "min(weight_durations.weight)",
                                "max(weight_durations.weight)"
                            ],
                            "Group Key": [
                                "weight_durations.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "WindowAgg",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "weight_durations.icustay_id",
                                        "weight_durations.weight",
                                        "row_number() OVER (?)",
                                        "weight_durations.starttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "weight_durations.icustay_id",
                                                "weight_durations.starttime",
                                                "weight_durations.weight"
                                            ],
                                            "Sort Key": [
                                                "weight_durations.icustay_id",
                                                "weight_durations.starttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "weight_durations",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "weight_durations",
                                                    "Output": [
                                                        "weight_durations.icustay_id",
                                                        "weight_durations.starttime",
                                                        "weight_durations.weight"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "Inner",
                    "Parallel Aware": false,
                    "Output": [
                        "ht_stg.icustay_id",
                        "min(CASE WHEN ((row_number() OVER (?)) = 1) THEN ht_stg.height ELSE NULL::double precision END)",
                        "min(ht_stg.height)",
                        "max(ht_stg.height)"
                    ],
                    "Group Key": [
                        "ht_stg.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ht_stg.icustay_id",
                                "ht_stg.height",
                                "row_number() OVER (?)",
                                "ht_stg.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "ht_stg.icustay_id",
                                        "ht_stg.charttime",
                                        "ht_stg.height"
                                    ],
                                    "Sort Key": [
                                        "ht_stg.icustay_id",
                                        "ht_stg.charttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "ht_stg",
                                            "Alias": "ht_stg",
                                            "Output": [
                                                "ht_stg.icustay_id",
                                                "ht_stg.charttime",
                                                "ht_stg.height"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.icustay_detail": {
        "sql": "-- ------------------------------------------------------------------\n-- Title: Detailed information on ICUSTAY_ID\n-- Description: This query provides a useful set of information regarding patient\n--              ICU stays. The information is combined from the admissions, patients, and\n--              icustays tables. It includes age, length of stay, sequence, and expiry flags.\n-- MIMIC version: MIMIC-III v1.3\n-- ------------------------------------------------------------------\n\n-- This query extracts useful demographic/administrative information for patient ICU stays\n\nSELECT ie.subject_id, ie.hadm_id, ie.icustay_id\n\n-- patient level factors\n, pat.gender, pat.dod\n\n-- hospital level factors\n, adm.admittime, adm.dischtime\n, DATETIME_DIFF(adm.dischtime, adm.admittime, 'DAY') as los_hospital\n, DATETIME_DIFF(ie.intime, pat.dob, 'YEAR') as admission_age\n, adm.ethnicity\n, case when ethnicity in\n  (\n       'WHITE' --  40996\n     , 'WHITE - RUSSIAN' --    164\n     , 'WHITE - OTHER EUROPEAN' --     81\n     , 'WHITE - BRAZILIAN' --     59\n     , 'WHITE - EASTERN EUROPEAN' --     25\n  ) then 'white'\n  when ethnicity in\n  (\n      'BLACK/AFRICAN AMERICAN' --   5440\n    , 'BLACK/CAPE VERDEAN' --    200\n    , 'BLACK/HAITIAN' --    101\n    , 'BLACK/AFRICAN' --     44\n    , 'CARIBBEAN ISLAND' --      9\n  ) then 'black'\n  when ethnicity in\n    (\n      'HISPANIC OR LATINO' --   1696\n    , 'HISPANIC/LATINO - PUERTO RICAN' --    232\n    , 'HISPANIC/LATINO - DOMINICAN' --     78\n    , 'HISPANIC/LATINO - GUATEMALAN' --     40\n    , 'HISPANIC/LATINO - CUBAN' --     24\n    , 'HISPANIC/LATINO - SALVADORAN' --     19\n    , 'HISPANIC/LATINO - CENTRAL AMERICAN (OTHER)' --     13\n    , 'HISPANIC/LATINO - MEXICAN' --     13\n    , 'HISPANIC/LATINO - COLOMBIAN' --      9\n    , 'HISPANIC/LATINO - HONDURAN' --      4\n  ) then 'hispanic'\n  when ethnicity in\n  (\n      'ASIAN' --   1509\n    , 'ASIAN - CHINESE' --    277\n    , 'ASIAN - ASIAN INDIAN' --     85\n    , 'ASIAN - VIETNAMESE' --     53\n    , 'ASIAN - FILIPINO' --     25\n    , 'ASIAN - CAMBODIAN' --     17\n    , 'ASIAN - OTHER' --     17\n    , 'ASIAN - KOREAN' --     13\n    , 'ASIAN - JAPANESE' --      7\n    , 'ASIAN - THAI' --      4\n  ) then 'asian'\n  when ethnicity in\n  (\n       'AMERICAN INDIAN/ALASKA NATIVE' --     51\n     , 'AMERICAN INDIAN/ALASKA NATIVE FEDERALLY RECOGNIZED TRIBE' --      3\n  ) then 'native'\n  when ethnicity in\n  (\n      'UNKNOWN/NOT SPECIFIED' --   4523\n    , 'UNABLE TO OBTAIN' --    814\n    , 'PATIENT DECLINED TO ANSWER' --    559\n  ) then 'unknown'\n  else 'other' end as ethnicity_grouped\n  -- , 'OTHER' --   1512\n  -- , 'MULTI RACE ETHNICITY' --    130\n  -- , 'PORTUGUESE' --     61\n  -- , 'MIDDLE EASTERN' --     43\n  -- , 'NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER' --     18\n  -- , 'SOUTH AMERICAN' --      8\n, adm.hospital_expire_flag\n, DENSE_RANK() OVER (PARTITION BY adm.subject_id ORDER BY adm.admittime) AS hospstay_seq\n, CASE\n    WHEN DENSE_RANK() OVER (PARTITION BY adm.subject_id ORDER BY adm.admittime) = 1 THEN True\n    ELSE False END AS first_hosp_stay\n\n-- icu level factors\n, ie.intime, ie.outtime\n, DATETIME_DIFF(ie.outtime, ie.intime, 'DAY') as los_icu\n, DENSE_RANK() OVER (PARTITION BY ie.hadm_id ORDER BY ie.intime) AS icustay_seq\n\n-- first ICU stay *for the current hospitalization*\n, CASE\n    WHEN DENSE_RANK() OVER (PARTITION BY ie.hadm_id ORDER BY ie.intime) = 1 THEN True\n    ELSE False END AS first_icu_stay\n\nFROM icustays ie\nINNER JOIN admissions adm\n    ON ie.hadm_id = adm.hadm_id\nINNER JOIN patients pat\n    ON ie.subject_id = pat.subject_id\nWHERE adm.has_chartevents_data = 1\nORDER BY ie.subject_id, adm.admittime, ie.intime",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id"
            ],
            "hadm_id": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id"
            ],
            "icustay_id": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id"
            ],
            "gender": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.gender",
                "mimiciii_clinical.patients.subject_id"
            ],
            "dod": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.dod",
                "mimiciii_clinical.patients.subject_id"
            ],
            "admittime": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id"
            ],
            "dischtime": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.dischtime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id"
            ],
            "los_hospital": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.dischtime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id"
            ],
            "admission_age": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "ethnicity": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.ethnicity",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id"
            ],
            "ethnicity_grouped": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.ethnicity",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id"
            ],
            "hospital_expire_flag": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.hospital_expire_flag",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id"
            ],
            "hospstay_seq": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id"
            ],
            "first_hosp_stay": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id"
            ],
            "intime": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id"
            ],
            "outtime": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id"
            ],
            "los_icu": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id"
            ],
            "icustay_seq": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id"
            ],
            "first_icu_stay": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.has_chartevents_data",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.icustay_detail",
        "plan": {
            "Node Type": "Result",
            "Parallel Aware": false,
            "Output": [
                "ie.subject_id",
                "ie.hadm_id",
                "ie.icustay_id",
                "pat.gender",
                "pat.dod",
                "adm.admittime",
                "adm.dischtime",
                "datetime_diff(adm.dischtime, adm.admittime, 'DAY'::text)",
                "datetime_diff(ie.intime, pat.dob, 'YEAR'::text)",
                "adm.ethnicity",
                "CASE WHEN ((adm.ethnicity)::text = ANY ('{WHITE,\"WHITE - RUSSIAN\",\"WHITE - OTHER EUROPEAN\",\"WHITE - BRAZILIAN\",\"WHITE - EASTERN EUROPEAN\"}'::text[])) THEN 'white'::text WHEN ((adm.ethnicity)::text = ANY ('{\"BLACK/AFRICAN AMERICAN\",\"BLACK/CAPE VERDEAN\",BLACK/HAITIAN,BLACK/AFRICAN,\"CARIBBEAN ISLAND\"}'::text[])) THEN 'black'::text WHEN ((adm.ethnicity)::text = ANY ('{\"HISPANIC OR LATINO\",\"HISPANIC/LATINO - PUERTO RICAN\",\"HISPANIC/LATINO - DOMINICAN\",\"HISPANIC/LATINO - GUATEMALAN\",\"HISPANIC/LATINO - CUBAN\",\"HISPANIC/LATINO - SALVADORAN\",\"HISPANIC/LATINO - CENTRAL AMERICAN (OTHER)\",\"HISPANIC/LATINO - MEXICAN\",\"HISPANIC/LATINO - COLOMBIAN\",\"HISPANIC/LATINO - HONDURAN\"}'::text[])) THEN 'hispanic'::text WHEN ((adm.ethnicity)::text = ANY ('{ASIAN,\"ASIAN - CHINESE\",\"ASIAN - ASIAN INDIAN\",\"ASIAN - VIETNAMESE\",\"ASIAN - FILIPINO\",\"ASIAN - CAMBODIAN\",\"ASIAN - OTHER\",\"ASIAN - KOREAN\",\"ASIAN - JAPANESE\",\"ASIAN - THAI\"}'::text[])) THEN 'asian'::text WHEN ((adm.ethnicity)::text = ANY ('{\"AMERICAN INDIAN/ALASKA NATIVE\",\"AMERICAN INDIAN/ALASKA NATIVE FEDERALLY RECOGNIZED TRIBE\"}'::text[])) THEN 'native'::text WHEN ((adm.ethnicity)::text = ANY ('{\"UNKNOWN/NOT SPECIFIED\",\"UNABLE TO OBTAIN\",\"PATIENT DECLINED TO ANSWER\"}'::text[])) THEN 'unknown'::text ELSE 'other'::text END",
                "adm.hospital_expire_flag",
                "(dense_rank() OVER (?))",
                "(CASE WHEN ((dense_rank() OVER (?)) = 1) THEN true ELSE false END)",
                "ie.intime",
                "ie.outtime",
                "datetime_diff(ie.outtime, ie.intime, 'DAY'::text)",
                "(dense_rank() OVER (?))",
                "(CASE WHEN (dense_rank() OVER (?) = 1) THEN true ELSE false END)",
                "adm.subject_id"
            ],
            "Plans": [
                {
                    "Node Type": "Sort",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id",
                        "pat.gender",
                        "pat.dod",
                        "adm.admittime",
                        "adm.dischtime",
                        "adm.ethnicity",
                        "adm.hospital_expire_flag",
                        "(dense_rank() OVER (?))",
                        "(CASE WHEN ((dense_rank() OVER (?)) = 1) THEN true ELSE false END)",
                        "ie.intime",
                        "ie.outtime",
                        "(dense_rank() OVER (?))",
                        "(CASE WHEN (dense_rank() OVER (?) = 1) THEN true ELSE false END)",
                        "adm.subject_id",
                        "pat.dob"
                    ],
                    "Sort Key": [
                        "ie.subject_id",
                        "adm.admittime",
                        "ie.intime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ie.subject_id",
                                "ie.hadm_id",
                                "ie.icustay_id",
                                "pat.gender",
                                "pat.dod",
                                "adm.admittime",
                                "adm.dischtime",
                                "adm.ethnicity",
                                "adm.hospital_expire_flag",
                                "(dense_rank() OVER (?))",
                                "CASE WHEN ((dense_rank() OVER (?)) = 1) THEN true ELSE false END",
                                "ie.intime",
                                "ie.outtime",
                                "dense_rank() OVER (?)",
                                "CASE WHEN (dense_rank() OVER (?) = 1) THEN true ELSE false END",
                                "adm.subject_id",
                                "pat.dob"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "ie.hadm_id",
                                        "adm.admittime",
                                        "ie.intime",
                                        "adm.subject_id",
                                        "ie.subject_id",
                                        "ie.icustay_id",
                                        "pat.gender",
                                        "pat.dod",
                                        "adm.dischtime",
                                        "pat.dob",
                                        "adm.ethnicity",
                                        "adm.hospital_expire_flag",
                                        "ie.outtime",
                                        "(dense_rank() OVER (?))"
                                    ],
                                    "Sort Key": [
                                        "ie.hadm_id",
                                        "ie.intime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "WindowAgg",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ie.hadm_id",
                                                "adm.admittime",
                                                "ie.intime",
                                                "adm.subject_id",
                                                "ie.subject_id",
                                                "ie.icustay_id",
                                                "pat.gender",
                                                "pat.dod",
                                                "adm.dischtime",
                                                "pat.dob",
                                                "adm.ethnicity",
                                                "adm.hospital_expire_flag",
                                                "ie.outtime",
                                                "dense_rank() OVER (?)"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Sort",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Output": [
                                                        "ie.hadm_id",
                                                        "adm.admittime",
                                                        "ie.intime",
                                                        "adm.subject_id",
                                                        "ie.subject_id",
                                                        "ie.icustay_id",
                                                        "pat.gender",
                                                        "pat.dod",
                                                        "adm.dischtime",
                                                        "pat.dob",
                                                        "adm.ethnicity",
                                                        "adm.hospital_expire_flag",
                                                        "ie.outtime"
                                                    ],
                                                    "Sort Key": [
                                                        "adm.subject_id",
                                                        "adm.admittime"
                                                    ],
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Hash Join",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Join Type": "Inner",
                                                            "Output": [
                                                                "ie.hadm_id",
                                                                "adm.admittime",
                                                                "ie.intime",
                                                                "adm.subject_id",
                                                                "ie.subject_id",
                                                                "ie.icustay_id",
                                                                "pat.gender",
                                                                "pat.dod",
                                                                "adm.dischtime",
                                                                "pat.dob",
                                                                "adm.ethnicity",
                                                                "adm.hospital_expire_flag",
                                                                "ie.outtime"
                                                            ],
                                                            "Inner Unique": true,
                                                            "Hash Cond": "(ie.subject_id = pat.subject_id)",
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Hash Join",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Join Type": "Inner",
                                                                    "Output": [
                                                                        "ie.subject_id",
                                                                        "ie.hadm_id",
                                                                        "ie.icustay_id",
                                                                        "ie.intime",
                                                                        "ie.outtime",
                                                                        "adm.admittime",
                                                                        "adm.dischtime",
                                                                        "adm.ethnicity",
                                                                        "adm.hospital_expire_flag",
                                                                        "adm.subject_id"
                                                                    ],
                                                                    "Inner Unique": true,
                                                                    "Hash Cond": "(ie.hadm_id = adm.hadm_id)",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Seq Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Relation Name": "icustays",
                                                                            "Schema": "mimiciii_clinical",
                                                                            "Alias": "ie",
                                                                            "Output": [
                                                                                "ie.subject_id",
                                                                                "ie.hadm_id",
                                                                                "ie.icustay_id",
                                                                                "ie.intime",
                                                                                "ie.outtime"
                                                                            ]
                                                                        },
                                                                        {
                                                                            "Node Type": "Hash",
                                                                            "Parent Relationship": "Inner",
                                                                            "Parallel Aware": false,
                                                                            "Output": [
                                                                                "adm.admittime",
                                                                                "adm.dischtime",
                                                                                "adm.ethnicity",
                                                                                "adm.hospital_expire_flag",
                                                                                "adm.subject_id",
                                                                                "adm.hadm_id"
                                                                            ],
                                                                            "Plans": [
                                                                                {
                                                                                    "Node Type": "Seq Scan",
                                                                                    "Parent Relationship": "Outer",
                                                                                    "Parallel Aware": false,
                                                                                    "Relation Name": "admissions",
                                                                                    "Schema": "mimiciii_clinical",
                                                                                    "Alias": "adm",
                                                                                    "Output": [
                                                                                        "adm.admittime",
                                                                                        "adm.dischtime",
                                                                                        "adm.ethnicity",
                                                                                        "adm.hospital_expire_flag",
                                                                                        "adm.subject_id",
                                                                                        "adm.hadm_id"
                                                                                    ],
                                                                                    "Filter": "(adm.has_chartevents_data = 1)"
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Hash",
                                                                    "Parent Relationship": "Inner",
                                                                    "Parallel Aware": false,
                                                                    "Output": [
                                                                        "pat.gender",
                                                                        "pat.dod",
                                                                        "pat.dob",
                                                                        "pat.subject_id"
                                                                    ],
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Seq Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Relation Name": "patients",
                                                                            "Schema": "mimiciii_clinical",
                                                                            "Alias": "pat",
                                                                            "Output": [
                                                                                "pat.gender",
                                                                                "pat.dod",
                                                                                "pat.dob",
                                                                                "pat.subject_id"
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.icustay_hours": {
        "sql": "-- This query generates a row for every hour the patient is in the ICU.\n-- The hours are based on clock-hours (i.e. 02:00, 03:00).\n-- The hour clock starts 24 hours before the first heart rate measurement.\n-- Note that the time of the first heart rate measurement is ceilinged to the hour.\n\n-- this query extracts the cohort and every possible hour they were in the ICU\n-- this table can be to other tables on ICUSTAY_ID and (ENDTIME - 1 hour,ENDTIME]\n\n-- get first/last measurement time\nwith all_hours as\n(\nselect\n  it.icustay_id\n\n  -- ceiling the intime to the nearest hour by adding 59 minutes then truncating\n  -- note thart we truncate by parsing as string, rather than using DATETIME_TRUNC\n  -- this is done to enable compatibility with psql\n  , PARSE_DATETIME(\n      '%Y-%m-%d %H:00:00',\n      FORMAT_DATETIME(\n        '%Y-%m-%d %H:00:00',\n          DATETIME_ADD(it.intime_hr, '59 MINUTE'::INTERVAL)\n  )) AS endtime\n\n  -- create integers for each charttime in hours from admission\n  -- so 0 is admission time, 1 is one hour after admission, etc, up to ICU disch\n  --  we allow 24 hours before ICU admission (to grab labs before admit)\n  , GENERATE_ARRAY(-24, CEIL(DATETIME_DIFF(it.outtime_hr, it.intime_hr, 'HOUR'))::integer) as hrs\n\n  from \"mimic\".\"mimiciii_clinical\".\"icustay_times\" it\n)\nSELECT icustay_id\n, CAST(hr AS integer) as hr\n, DATETIME_ADD(endtime,  (CAST(hr AS integer) || 'HOUR')::INTERVAL) as endtime\nFROM all_hours\nCROSS JOIN UNNEST(ARRAY[all_hours.hrs]) AS hr",
        "tables": [
            "mimiciii_clinical.icustay_times"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.icustay_times.icustay_id"
            ],
            "hr": [
                "mimiciii_clinical.icustay_times.intime_hr",
                "mimiciii_clinical.icustay_times.outtime_hr"
            ],
            "endtime": [
                "mimiciii_clinical.icustay_times.intime_hr",
                "mimiciii_clinical.icustay_times.outtime_hr"
            ]
        },
        "table_name": "mimiciii_clinical.icustay_hours",
        "plan": {
            "Node Type": "Nested Loop",
            "Parallel Aware": false,
            "Join Type": "Inner",
            "Output": [
                "all_hours.icustay_id",
                "hr.hr",
                "datetime_add(all_hours.endtime, (((hr.hr)::text || 'HOUR'::text))::interval)"
            ],
            "Inner Unique": false,
            "Plans": [
                {
                    "Node Type": "ProjectSet",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE all_hours",
                    "Parallel Aware": false,
                    "Output": [
                        "it.icustay_id",
                        "parse_datetime('%Y-%m-%d %H:00:00'::character varying, (format_datetime('%Y-%m-%d %H:00:00'::character varying, datetime_add(it.intime_hr, '00:59:00'::interval)))::character varying)",
                        "generate_array('-24'::integer, (ceil(datetime_diff(it.outtime_hr, it.intime_hr, 'HOUR'::text)))::integer)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Seq Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "icustay_times",
                            "Schema": "mimiciii_clinical",
                            "Alias": "it",
                            "Output": [
                                "it.subject_id",
                                "it.hadm_id",
                                "it.icustay_id",
                                "it.intime_hr",
                                "it.outtime_hr"
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "CTE Name": "all_hours",
                    "Alias": "all_hours",
                    "Output": [
                        "all_hours.icustay_id",
                        "all_hours.endtime",
                        "all_hours.hrs"
                    ]
                },
                {
                    "Node Type": "Function Scan",
                    "Parent Relationship": "Inner",
                    "Parallel Aware": false,
                    "Function Name": "unnest",
                    "Schema": "pg_catalog",
                    "Alias": "hr",
                    "Output": [
                        "hr.hr"
                    ],
                    "Function Call": "unnest(ARRAY[all_hours.hrs])"
                }
            ]
        }
    },
    "model.mimic.icustay_times": {
        "sql": "-- create a table which has fuzzy boundaries on hospital admission\n-- involves first creating a lag/lead version of disch/admit time\nwith h as\n(\n  select\n    subject_id, hadm_id, admittime, dischtime\n    , lag (dischtime) over (partition by subject_id order by admittime) as dischtime_lag\n    , lead (admittime) over (partition by subject_id order by admittime) as admittime_lead\n  FROM admissions\n)\n, adm as\n(\n  select\n    h.subject_id, h.hadm_id\n    -- this rule is:\n    --  if there are two hospitalizations within 24 hours, set the start/stop\n    --  time as half way between the two admissions\n    , case\n        when h.dischtime_lag is not null\n        and h.dischtime_lag > (DATETIME_SUB(h.admittime, INTERVAL '24 HOUR'))\n          then DATETIME_SUB(h.admittime, (DATETIME_DIFF(h.admittime, h.dischtime_lag, 'SECOND')/2  || ' SECOND')::interval)\n      else DATETIME_SUB(h.admittime, INTERVAL '12 HOUR')\n      end as data_start\n    , case\n        when h.admittime_lead is not null\n        and h.admittime_lead < (DATETIME_ADD(h.dischtime, INTERVAL '24 HOUR'))\n          then DATETIME_ADD(h.dischtime, (DATETIME_DIFF(h.admittime_lead, h.dischtime, 'SECOND')/2 || ' SECOND')::interval)\n      else (DATETIME_ADD(h.dischtime, INTERVAL '12 HOUR'))\n      end as data_end\n    from h\n)\n-- get first/last heart rate measurement during hospitalization for each ICUSTAY_ID\n, t1 as\n(\nselect ce.icustay_id\n, min(charttime) as intime_hr\n, max(charttime) as outtime_hr\nFROM chartevents ce\n-- very loose join to admissions to ensure charttime is near patient admission\ninner join adm\n  on ce.hadm_id = adm.hadm_id\n  and ce.charttime >= adm.data_start\n  and ce.charttime <  adm.data_end\n-- only look at heart rate\nwhere ce.itemid in (211,220045)\ngroup by ce.icustay_id\n)\n-- add in subject_id/hadm_id\nselect\n  ie.subject_id, ie.hadm_id, ie.icustay_id\n  , t1.intime_hr\n  , t1.outtime_hr\nFROM icustays ie\nleft join t1\n  on ie.icustay_id = t1.icustay_id\norder by ie.subject_id, ie.hadm_id, ie.icustay_id",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.icustays"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.dischtime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "hadm_id": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.dischtime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "icustay_id": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.dischtime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "intime_hr": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.dischtime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "outtime_hr": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.dischtime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.icustay_times",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "ie.subject_id",
                "ie.hadm_id",
                "ie.icustay_id",
                "t1.intime_hr",
                "t1.outtime_hr"
            ],
            "Sort Key": [
                "ie.subject_id",
                "ie.hadm_id",
                "ie.icustay_id"
            ],
            "Plans": [
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE h",
                    "Parallel Aware": false,
                    "Output": [
                        "admissions.subject_id",
                        "admissions.hadm_id",
                        "admissions.admittime",
                        "admissions.dischtime",
                        "lag(admissions.dischtime) OVER (?)",
                        "lead(admissions.admittime) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "admissions.subject_id",
                                "admissions.admittime",
                                "admissions.hadm_id",
                                "admissions.dischtime"
                            ],
                            "Sort Key": [
                                "admissions.subject_id",
                                "admissions.admittime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "admissions",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "admissions",
                                    "Output": [
                                        "admissions.subject_id",
                                        "admissions.admittime",
                                        "admissions.hadm_id",
                                        "admissions.dischtime"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE adm",
                    "Parallel Aware": false,
                    "CTE Name": "h",
                    "Alias": "h",
                    "Output": [
                        "h.subject_id",
                        "h.hadm_id",
                        "CASE WHEN ((h.dischtime_lag IS NOT NULL) AND (h.dischtime_lag > datetime_sub(h.admittime, '24:00:00'::interval))) THEN datetime_sub(h.admittime, ((((datetime_diff(h.admittime, h.dischtime_lag, 'SECOND'::text) / '2'::numeric))::text || ' SECOND'::text))::interval) ELSE datetime_sub(h.admittime, '12:00:00'::interval) END",
                        "CASE WHEN ((h.admittime_lead IS NOT NULL) AND (h.admittime_lead < datetime_add(h.dischtime, '24:00:00'::interval))) THEN datetime_add(h.dischtime, ((((datetime_diff(h.admittime_lead, h.dischtime, 'SECOND'::text) / '2'::numeric))::text || ' SECOND'::text))::interval) ELSE datetime_add(h.dischtime, '12:00:00'::interval) END"
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE t1",
                    "Parallel Aware": false,
                    "Output": [
                        "ce.icustay_id",
                        "min(ce.charttime)",
                        "max(ce.charttime)"
                    ],
                    "Group Key": [
                        "ce.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Merge Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "ce.icustay_id",
                                "ce.charttime"
                            ],
                            "Inner Unique": false,
                            "Merge Cond": "(adm.hadm_id = ce.hadm_id)",
                            "Join Filter": "((ce.charttime >= adm.data_start) AND (ce.charttime < adm.data_end))",
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "adm.hadm_id",
                                        "adm.data_start",
                                        "adm.data_end"
                                    ],
                                    "Sort Key": [
                                        "adm.hadm_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "adm",
                                            "Alias": "adm",
                                            "Output": [
                                                "adm.hadm_id",
                                                "adm.data_start",
                                                "adm.data_end"
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Materialize",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "ce.icustay_id",
                                        "ce.charttime",
                                        "ce.hadm_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ce.icustay_id",
                                                "ce.charttime",
                                                "ce.hadm_id"
                                            ],
                                            "Sort Key": [
                                                "ce.hadm_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Append",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Seq Scan",
                                                            "Parent Relationship": "Member",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "chartevents_31",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "ce",
                                                            "Output": [
                                                                "ce.icustay_id",
                                                                "ce.charttime",
                                                                "ce.hadm_id"
                                                            ],
                                                            "Filter": "(ce.itemid = ANY ('{211,220045}'::integer[]))"
                                                        },
                                                        {
                                                            "Node Type": "Seq Scan",
                                                            "Parent Relationship": "Member",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "chartevents_155",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "ce_1",
                                                            "Output": [
                                                                "ce_1.icustay_id",
                                                                "ce_1.charttime",
                                                                "ce_1.hadm_id"
                                                            ],
                                                            "Filter": "(ce_1.itemid = ANY ('{211,220045}'::integer[]))"
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Join Type": "Right",
                    "Output": [
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id",
                        "t1.intime_hr",
                        "t1.outtime_hr"
                    ],
                    "Inner Unique": true,
                    "Hash Cond": "(t1.icustay_id = ie.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "t1",
                            "Alias": "t1",
                            "Output": [
                                "t1.icustay_id",
                                "t1.intime_hr",
                                "t1.outtime_hr"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "ie.subject_id",
                                "ie.hadm_id",
                                "ie.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "icustays",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ie",
                                    "Output": [
                                        "ie.subject_id",
                                        "ie.hadm_id",
                                        "ie.icustay_id"
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.adenosine_durations": {
        "sql": "-- This query extracts durations of adenosine administration\n-- Consecutive administrations are numbered 1, 2, ...\n-- Total time on the drug can be calculated from this table by grouping using ICUSTAY_ID\n\n-- *** COULD NOT FIND ADENOSINE IN THE INPUTEVENTS_MV TABLE ***\n-- This drug is rarely used - it could just be that it was never used in MetaVision.\n-- If using this code, ensure the durations make sense for carevue patients first\n\nwith vasocv1 as\n(\n  select\n    icustay_id, charttime\n    -- case statement determining whether the ITEMID is an instance of vasopressor usage\n    , max(case when itemid = 4649 then 1 else 0 end) as vaso -- adenosine\n\n    -- the 'stopped' column indicates if a vasopressor has been disconnected\n    , 0 as vaso_stopped\n    , max(case when itemid = 4649 and valuenum is not null then 1 else 0 end) as vaso_null\n    , max(case when itemid = 4649 then valuenum else null end) as vaso_rate\n    , max(case when itemid = 4649 then valuenum else null end) as vaso_amount\n\n  FROM chartevents\n  where itemid = 4649 -- adenosine\n  -- exclude rows marked as error\n  AND (error IS NULL OR error = 0)\n  group by icustay_id, charttime\n)\n, vasocv2 as\n(\n  select v.*\n    , sum(vaso_null) over (partition by icustay_id order by charttime) as vaso_partition\n  from\n    vasocv1 v\n)\n, vasocv3 as\n(\n  select v.*\n    , first_value(vaso_rate) over (partition by icustay_id, vaso_partition order by charttime) as vaso_prevrate_ifnull\n  from\n    vasocv2 v\n)\n, vasocv4 as\n(\nselect\n    icustay_id\n    , charttime\n    -- , (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) AS delta\n\n    , vaso\n    , vaso_rate\n    , vaso_amount\n    , vaso_stopped\n    , vaso_prevrate_ifnull\n\n    -- We define start time here\n    , case\n        when vaso = 0 then null\n\n        -- if this is the first instance of the vasoactive drug\n        when vaso_rate > 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso, vaso_null\n          order by charttime\n          )\n          is null\n          then 1\n\n        -- you often get a string of 0s\n        -- we decide not to set these as 1, just because it makes vasonum sequential\n        when vaso_rate = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- sometimes you get a string of NULL, associated with 0 volumes\n        -- same reason as before, we decide not to set these as 1\n        -- vaso_prevrate_ifnull is equal to the previous value *iff* the current value is null\n        when vaso_prevrate_ifnull = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- If the last recorded rate was 0, newvaso = 1\n        when LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) = 0\n          then 1\n\n        -- If the last recorded vaso was D/C'd, newvaso = 1\n        when\n          LAG(vaso_stopped,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 1 then 1\n\n        -- ** not sure if the below is needed\n        --when (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) > (interval '4 hours') then 1\n      else null\n      end as vaso_start\n\nFROM\n  vasocv3\n)\n-- propagate start/stop flags forward in time\n, vasocv5 as\n(\n  select v.*\n    , SUM(vaso_start) OVER (partition by icustay_id, vaso order by charttime) as vaso_first\nFROM\n  vasocv4 v\n)\n, vasocv6 as\n(\n  select v.*\n    -- We define end time here\n    , case\n        when vaso = 0\n          then null\n\n        -- If the recorded vaso was D/C'd, this is an end time\n        when vaso_stopped = 1\n          then vaso_first\n\n        -- If the rate is zero, this is the end time\n        when vaso_rate = 0\n          then vaso_first\n\n        -- the last row in the table is always a potential end time\n        -- this captures patients who die/are discharged while on vasopressors\n        -- in principle, this could add an extra end time for the vasopressor\n        -- however, since we later group on vaso_start, any extra end times are ignored\n        when LEAD(CHARTTIME,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) is null\n          then vaso_first\n\n        else null\n        end as vaso_stop\n    from vasocv5 v\n)\n\n-- -- if you want to look at the results of the table before grouping:\n-- select\n--   icustay_id, charttime, vaso, vaso_rate, vaso_amount\n--     , case when vaso_stopped = 1 then 'Y' else '' end as stopped\n--     , vaso_start\n--     , vaso_first\n--     , vaso_stop\n-- from vasocv6 order by charttime\n\n\n, vasocv as\n(\n-- below groups together vasopressor administrations into groups\nselect\n  icustay_id\n  -- the first non-null rate is considered the starttime\n  , min(case when vaso_rate is not null then charttime else null end) as starttime\n  -- the *first* time the first/last flags agree is the stop time for this duration\n  , min(case when vaso_first = vaso_stop then charttime else null end) as endtime\nfrom vasocv6\nwhere\n  vaso_first is not null -- bogus data\nand\n  vaso_first != 0 -- sometimes *only* a rate of 0 appears, i.e. the drug is never actually delivered\nand\n  icustay_id is not null -- there are data for \"floating\" admissions, we don't worry about these\ngroup by icustay_id, vaso_first\nhaving -- ensure start time is not the same as end time\n min(charttime) != min(case when vaso_first = vaso_stop then charttime else null end)\nand\n  max(vaso_rate) > 0 -- if the rate was always 0 or null, we consider it not a real drug delivery\n)\n\n-- now we extract the associated data for metavision patients\n, vasomv as\n(\n  select\n    icustay_id, linkorderid\n    , min(starttime) as starttime, max(endtime) as endtime\n  FROM inputevents_mv\n  where itemid = 221282 -- adenosine\n  and statusdescription != 'Rewritten' -- only valid orders\n  group by icustay_id, linkorderid\n)\n\nselect\n  icustay_id\n  -- generate a sequential integer for convenience\n  , ROW_NUMBER() over (partition by icustay_id order by starttime) as vasonum\n  , starttime, endtime\n  , DATETIME_DIFF(endtime, starttime, 'HOUR') AS duration_hours\n  -- add durations\nfrom\n  vasocv\n\nUNION ALL\n\nselect\n  icustay_id\n  , ROW_NUMBER() over (partition by icustay_id order by starttime) as vasonum\n  , starttime, endtime\n  , DATETIME_DIFF(endtime, starttime, 'HOUR') AS duration_hours\n  -- add durations\nfrom\n  vasomv\n\norder by icustay_id, vasonum",
        "tables": [
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.inputevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "vasonum": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "starttime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "endtime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "duration_hours": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ]
        },
        "table_name": "mimiciii_clinical.adenosine_durations",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "vasocv.icustay_id",
                "(row_number() OVER (?))",
                "vasocv.starttime",
                "vasocv.endtime",
                "(datetime_diff(vasocv.endtime, vasocv.starttime, 'HOUR'::text))"
            ],
            "Sort Key": [
                "vasocv.icustay_id",
                "(row_number() OVER (?))"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv1",
                    "Parallel Aware": false,
                    "Output": [
                        "chartevents_121.icustay_id",
                        "chartevents_121.charttime",
                        "max(CASE WHEN (chartevents_121.itemid = 4649) THEN 1 ELSE 0 END)",
                        "0",
                        "max(CASE WHEN ((chartevents_121.itemid = 4649) AND (chartevents_121.valuenum IS NOT NULL)) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN (chartevents_121.itemid = 4649) THEN chartevents_121.valuenum ELSE NULL::double precision END)",
                        "max(CASE WHEN (chartevents_121.itemid = 4649) THEN chartevents_121.valuenum ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "chartevents_121.icustay_id",
                        "chartevents_121.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Append",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_121",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "chartevents_121",
                                    "Output": [
                                        "chartevents_121.icustay_id",
                                        "chartevents_121.charttime",
                                        "chartevents_121.itemid",
                                        "chartevents_121.valuenum"
                                    ],
                                    "Recheck Cond": "(chartevents_121.itemid = 4649)",
                                    "Filter": "((chartevents_121.error IS NULL) OR (chartevents_121.error = 0))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_121_idx01",
                                            "Index Cond": "(chartevents_121.itemid = 4649)"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv2",
                    "Parallel Aware": false,
                    "Output": [
                        "v.icustay_id",
                        "v.charttime",
                        "v.vaso",
                        "v.vaso_stopped",
                        "v.vaso_null",
                        "v.vaso_rate",
                        "v.vaso_amount",
                        "sum(v.vaso_null) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v.icustay_id",
                                "v.charttime",
                                "v.vaso",
                                "v.vaso_stopped",
                                "v.vaso_null",
                                "v.vaso_rate",
                                "v.vaso_amount"
                            ],
                            "Sort Key": [
                                "v.icustay_id",
                                "v.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv1",
                                    "Alias": "v",
                                    "Output": [
                                        "v.icustay_id",
                                        "v.charttime",
                                        "v.vaso",
                                        "v.vaso_stopped",
                                        "v.vaso_null",
                                        "v.vaso_rate",
                                        "v.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv3",
                    "Parallel Aware": false,
                    "Output": [
                        "v_1.icustay_id",
                        "v_1.charttime",
                        "v_1.vaso",
                        "v_1.vaso_stopped",
                        "v_1.vaso_null",
                        "v_1.vaso_rate",
                        "v_1.vaso_amount",
                        "v_1.vaso_partition",
                        "first_value(v_1.vaso_rate) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_1.icustay_id",
                                "v_1.charttime",
                                "v_1.vaso_partition",
                                "v_1.vaso",
                                "v_1.vaso_stopped",
                                "v_1.vaso_null",
                                "v_1.vaso_rate",
                                "v_1.vaso_amount"
                            ],
                            "Sort Key": [
                                "v_1.icustay_id",
                                "v_1.vaso_partition",
                                "v_1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv2",
                                    "Alias": "v_1",
                                    "Output": [
                                        "v_1.icustay_id",
                                        "v_1.charttime",
                                        "v_1.vaso_partition",
                                        "v_1.vaso",
                                        "v_1.vaso_stopped",
                                        "v_1.vaso_null",
                                        "v_1.vaso_rate",
                                        "v_1.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv4",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv3.icustay_id",
                        "vasocv3.charttime",
                        "vasocv3.vaso",
                        "vasocv3.vaso_rate",
                        "vasocv3.vaso_amount",
                        "vasocv3.vaso_stopped",
                        "vasocv3.vaso_prevrate_ifnull",
                        "CASE WHEN (vasocv3.vaso = 0) THEN NULL::integer WHEN ((vasocv3.vaso_rate > '0'::double precision) AND ((lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)) IS NULL)) THEN 1 WHEN ((vasocv3.vaso_rate = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN ((vasocv3.vaso_prevrate_ifnull = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision) THEN 1 WHEN (lag(vasocv3.vaso_stopped, 1) OVER (?) = 1) THEN 1 ELSE NULL::integer END",
                        "vasocv3.vaso_null"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv3.icustay_id",
                                "vasocv3.charttime",
                                "vasocv3.vaso",
                                "vasocv3.vaso_null",
                                "vasocv3.vaso_rate",
                                "vasocv3.vaso_amount",
                                "vasocv3.vaso_stopped",
                                "vasocv3.vaso_prevrate_ifnull",
                                "(lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?))"
                            ],
                            "Sort Key": [
                                "vasocv3.icustay_id",
                                "vasocv3.vaso",
                                "vasocv3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "WindowAgg",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv3.icustay_id",
                                        "vasocv3.charttime",
                                        "vasocv3.vaso",
                                        "vasocv3.vaso_null",
                                        "vasocv3.vaso_rate",
                                        "vasocv3.vaso_amount",
                                        "vasocv3.vaso_stopped",
                                        "vasocv3.vaso_prevrate_ifnull",
                                        "lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.charttime",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.vaso_rate",
                                                "vasocv3.vaso_amount",
                                                "vasocv3.vaso_stopped",
                                                "vasocv3.vaso_prevrate_ifnull"
                                            ],
                                            "Sort Key": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "vasocv3",
                                                    "Alias": "vasocv3",
                                                    "Output": [
                                                        "vasocv3.icustay_id",
                                                        "vasocv3.charttime",
                                                        "vasocv3.vaso",
                                                        "vasocv3.vaso_null",
                                                        "vasocv3.vaso_rate",
                                                        "vasocv3.vaso_amount",
                                                        "vasocv3.vaso_stopped",
                                                        "vasocv3.vaso_prevrate_ifnull"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv5",
                    "Parallel Aware": false,
                    "Output": [
                        "v_2.icustay_id",
                        "v_2.charttime",
                        "v_2.vaso",
                        "v_2.vaso_rate",
                        "v_2.vaso_amount",
                        "v_2.vaso_stopped",
                        "v_2.vaso_prevrate_ifnull",
                        "v_2.vaso_start",
                        "sum(v_2.vaso_start) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_2.icustay_id",
                                "v_2.charttime",
                                "v_2.vaso",
                                "v_2.vaso_rate",
                                "v_2.vaso_amount",
                                "v_2.vaso_stopped",
                                "v_2.vaso_prevrate_ifnull",
                                "v_2.vaso_start"
                            ],
                            "Sort Key": [
                                "v_2.icustay_id",
                                "v_2.vaso",
                                "v_2.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv4",
                                    "Alias": "v_2",
                                    "Output": [
                                        "v_2.icustay_id",
                                        "v_2.charttime",
                                        "v_2.vaso",
                                        "v_2.vaso_rate",
                                        "v_2.vaso_amount",
                                        "v_2.vaso_stopped",
                                        "v_2.vaso_prevrate_ifnull",
                                        "v_2.vaso_start"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv6",
                    "Parallel Aware": false,
                    "Output": [
                        "v_3.icustay_id",
                        "v_3.charttime",
                        "v_3.vaso",
                        "v_3.vaso_rate",
                        "v_3.vaso_amount",
                        "v_3.vaso_stopped",
                        "v_3.vaso_prevrate_ifnull",
                        "v_3.vaso_start",
                        "v_3.vaso_first",
                        "CASE WHEN (v_3.vaso = 0) THEN NULL::bigint WHEN (v_3.vaso_stopped = 1) THEN v_3.vaso_first WHEN (v_3.vaso_rate = '0'::double precision) THEN v_3.vaso_first WHEN (lead(v_3.charttime, 1) OVER (?) IS NULL) THEN v_3.vaso_first ELSE NULL::bigint END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_3.icustay_id",
                                "v_3.charttime",
                                "v_3.vaso",
                                "v_3.vaso_rate",
                                "v_3.vaso_amount",
                                "v_3.vaso_stopped",
                                "v_3.vaso_prevrate_ifnull",
                                "v_3.vaso_start",
                                "v_3.vaso_first"
                            ],
                            "Sort Key": [
                                "v_3.icustay_id",
                                "v_3.vaso",
                                "v_3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv5",
                                    "Alias": "v_3",
                                    "Output": [
                                        "v_3.icustay_id",
                                        "v_3.charttime",
                                        "v_3.vaso",
                                        "v_3.vaso_rate",
                                        "v_3.vaso_amount",
                                        "v_3.vaso_stopped",
                                        "v_3.vaso_prevrate_ifnull",
                                        "v_3.vaso_start",
                                        "v_3.vaso_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv6.icustay_id",
                        "min(CASE WHEN (vasocv6.vaso_rate IS NOT NULL) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)",
                        "min(CASE WHEN (vasocv6.vaso_first = vasocv6.vaso_stop) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)",
                        "vasocv6.vaso_first"
                    ],
                    "Group Key": [
                        "vasocv6.icustay_id",
                        "vasocv6.vaso_first"
                    ],
                    "Filter": "((min(vasocv6.charttime) <> min(CASE WHEN (vasocv6.vaso_first = vasocv6.vaso_stop) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)) AND (max(vasocv6.vaso_rate) > '0'::double precision))",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "vasocv6",
                            "Alias": "vasocv6",
                            "Output": [
                                "vasocv6.icustay_id",
                                "vasocv6.charttime",
                                "vasocv6.vaso",
                                "vasocv6.vaso_rate",
                                "vasocv6.vaso_amount",
                                "vasocv6.vaso_stopped",
                                "vasocv6.vaso_prevrate_ifnull",
                                "vasocv6.vaso_start",
                                "vasocv6.vaso_first",
                                "vasocv6.vaso_stop"
                            ],
                            "Filter": "((vasocv6.vaso_first IS NOT NULL) AND (vasocv6.icustay_id IS NOT NULL) AND (vasocv6.vaso_first <> 0))"
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasomv",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid",
                        "min(inputevents_mv.starttime)",
                        "max(inputevents_mv.endtime)"
                    ],
                    "Group Key": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Bitmap Heap Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "inputevents_mv",
                            "Schema": "mimiciii_clinical",
                            "Alias": "inputevents_mv",
                            "Output": [
                                "inputevents_mv.row_id",
                                "inputevents_mv.subject_id",
                                "inputevents_mv.hadm_id",
                                "inputevents_mv.icustay_id",
                                "inputevents_mv.starttime",
                                "inputevents_mv.endtime",
                                "inputevents_mv.itemid",
                                "inputevents_mv.amount",
                                "inputevents_mv.amountuom",
                                "inputevents_mv.rate",
                                "inputevents_mv.rateuom",
                                "inputevents_mv.storetime",
                                "inputevents_mv.cgid",
                                "inputevents_mv.orderid",
                                "inputevents_mv.linkorderid",
                                "inputevents_mv.ordercategoryname",
                                "inputevents_mv.secondaryordercategoryname",
                                "inputevents_mv.ordercomponenttypedescription",
                                "inputevents_mv.ordercategorydescription",
                                "inputevents_mv.patientweight",
                                "inputevents_mv.totalamount",
                                "inputevents_mv.totalamountuom",
                                "inputevents_mv.isopenbag",
                                "inputevents_mv.continueinnextdept",
                                "inputevents_mv.cancelreason",
                                "inputevents_mv.statusdescription",
                                "inputevents_mv.comments_editedby",
                                "inputevents_mv.comments_canceledby",
                                "inputevents_mv.comments_date",
                                "inputevents_mv.originalamount",
                                "inputevents_mv.originalrate"
                            ],
                            "Recheck Cond": "(inputevents_mv.itemid = 221282)",
                            "Filter": "((inputevents_mv.statusdescription)::text <> 'Rewritten'::text)",
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Index Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Index Name": "inputevents_mv_idx05",
                                    "Index Cond": "(inputevents_mv.itemid = 221282)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv.icustay_id",
                                "row_number() OVER (?)",
                                "vasocv.starttime",
                                "vasocv.endtime",
                                "datetime_diff(vasocv.endtime, vasocv.starttime, 'HOUR'::text)"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv.icustay_id",
                                        "vasocv.starttime",
                                        "vasocv.endtime"
                                    ],
                                    "Sort Key": [
                                        "vasocv.icustay_id",
                                        "vasocv.starttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "vasocv",
                                            "Alias": "vasocv",
                                            "Output": [
                                                "vasocv.icustay_id",
                                                "vasocv.starttime",
                                                "vasocv.endtime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "vasomv.icustay_id",
                                "row_number() OVER (?)",
                                "vasomv.starttime",
                                "vasomv.endtime",
                                "datetime_diff(vasomv.endtime, vasomv.starttime, 'HOUR'::text)"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasomv.icustay_id",
                                        "vasomv.starttime",
                                        "vasomv.endtime"
                                    ],
                                    "Sort Key": [
                                        "vasomv.icustay_id",
                                        "vasomv.starttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "vasomv",
                                            "Alias": "vasomv",
                                            "Output": [
                                                "vasomv.icustay_id",
                                                "vasomv.starttime",
                                                "vasomv.endtime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.arterial_line_durations": {
        "sql": "with mv as\n(\n  select\n    pe.icustay_id\n  , pe.starttime, pe.endtime\n  , case\n      when itemid in (225752, 224272)\n        then 1\n      when pe.locationcategory = 'Invasive Arterial'\n        then 1\n      when itemid = 225789 and pe.locationcategory IS NULL\n        then 1\n      else 0\n    end as arterial_line\n  FROM procedureevents_mv pe\n  where pe.itemid in\n  (\n      224263 -- Multi Lumen | None | 12 | Processes\n    -- , 224264 -- PICC Line | None | 12 | Processes\n    , 224267 -- Cordis/Introducer | None | 12 | Processes\n    , 224268 -- Trauma line | None | 12 | Processes\n    , 225199 -- Triple Introducer | None | 12 | Processes\n    -- , 225202 -- Indwelling Port (PortaCath) | None | 12 | Processes\n    -- , 225203 -- Pheresis Catheter | None | 12 | Processes\n    -- , 225315 -- Tunneled (Hickman) Line | None | 12 | Processes\n    , 225752 -- Arterial Line | None | 12 | Processes\n    , 225789 -- Sheath\n    , 224272 -- IABP Line\n    -- , 227719 -- AVA Line | None | 12 | Processes\n    -- , 228286 -- Intraosseous Device | None | 12 | Processes\n  )\n)\n, cv_grp as\n(\n  -- group type+site\n  select ce.icustay_id, ce.charttime\n    , max(case when itemid =  229  then value else null end) as INV1_Type\n    , max(case when itemid =  8392 then value else null end) as INV1_Site\n    , max(case when itemid =  235  then value else null end) as INV2_Type\n    , max(case when itemid =  8393 then value else null end) as INV2_Site\n    , max(case when itemid =  241  then value else null end) as INV3_Type\n    , max(case when itemid =  8394 then value else null end) as INV3_Site\n    , max(case when itemid =  247  then value else null end) as INV4_Type\n    , max(case when itemid =  8395 then value else null end) as INV4_Site\n    , max(case when itemid =  253  then value else null end) as INV5_Type\n    , max(case when itemid =  8396 then value else null end) as INV5_Site\n    , max(case when itemid =  259  then value else null end) as INV6_Type\n    , max(case when itemid =  8397 then value else null end) as INV6_Site\n    , max(case when itemid =  265  then value else null end) as INV7_Type\n    , max(case when itemid =  8398 then value else null end) as INV7_Site\n    , max(case when itemid =  271  then value else null end) as INV8_Type\n    , max(case when itemid =  8399 then value else null end) as INV8_Site\n  FROM chartevents ce\n  where ce.itemid in\n  (\n      229 -- INV Line#1 [Type]\n    , 235 -- INV Line#2 [Type]\n    , 241 -- INV Line#3 [Type]\n    , 247 -- INV Line#4 [Type]\n    , 253 -- INV Line#5 [Type]\n    , 259 -- INV Line#6 [Type]\n    , 265 -- INV Line#7 [Type]\n    , 271 -- INV Line#8 [Type]\n    , 8392 -- INV Line#1 [Site]\n    , 8393 -- INV Line#2 [Site]\n    , 8394 -- INV Line#3 [Site]\n    , 8395 -- INV Line#4 [Site]\n    , 8396 -- INV Line#5 [Site]\n    , 8397 -- INV Line#6 [Site]\n    , 8398 -- INV Line#7 [Site]\n    , 8399 -- INV Line#8 [Site]\n  )\n  and ce.value is not null\n  group by ce.icustay_id, ce.charttime\n)\n-- types of invasive lines in carevue\n--       value       | count\n-- ------------------+--------\n--  A-Line           | 460627\n--  Multi-lumen      | 345858\n--  PICC line        |  92285\n--  PA line          |  65702\n--  Dialysis Line    |  57579\n--  Introducer       |  36027\n--  CCO PA Line      |  24831\n--                   |  22369\n--  Trauma Line      |  15530\n--  Portacath        |  12927\n--  Ventriculostomy  |  10295\n--  Pre-Sep Catheter |   9678\n--  IABP             |   8819\n--  Other/Remarks    |   8725\n--  Midline          |   5067\n--  Venous Access    |   4278\n--  Hickman          |   3783\n--  PacerIntroducer  |   2663\n--  TripleIntroducer |   2262\n--  RIC              |   1625\n--  PermaCath        |   1066\n--  Camino Bolt      |    913\n--  Lumbar Drain     |    361\n-- (23 rows)\n, cv as\n(\n  select distinct icustay_id, charttime\n  from cv_grp\n  where (inv1_type in ('A-Line', 'IABP'))\n     OR (inv2_type in ('A-Line', 'IABP'))\n     OR (inv3_type in ('A-Line', 'IABP'))\n     OR (inv4_type in ('A-Line', 'IABP'))\n     OR (inv5_type in ('A-Line', 'IABP'))\n     OR (inv6_type in ('A-Line', 'IABP'))\n     OR (inv7_type in ('A-Line', 'IABP'))\n     OR (inv8_type in ('A-Line', 'IABP'))\n)\n-- transform carevue data into durations\n, cv0 as\n(\n  select\n    icustay_id\n    -- this carries over the previous charttime\n    , LAG(CHARTTIME, 1) OVER (partition by icustay_id order by charttime) as charttime_lag\n    , charttime\n  from cv\n)\n, cv1 as\n(\n  select\n    icustay_id\n    , charttime\n    , charttime_lag\n    -- if the current observation indicates a line is present\n    -- calculate the time since the last charted line\n    , charttime - charttime_lag as arterial_line_duration\n    -- now we determine if the current line is \"new\"\n    -- new == no documentation for 16 hours\n    , case\n        when DATETIME_DIFF(charttime, charttime_lag, 'HOUR') > 16\n          then 1\n      else 0\n      end as arterial_line_new\n  FROM cv0\n)\n, cv2 as\n(\n  select cv1.*\n  -- create a cumulative sum of the instances of new events\n  -- this results in a monotonic integer assigned to each new instance of a line\n  , SUM( arterial_line_new )\n    OVER ( partition by icustay_id order by charttime )\n    as arterial_line_rownum\n  from cv1\n)\n-- create the durations for each line\n, cv_dur as\n(\n  select icustay_id\n    , arterial_line_rownum\n    , min(charttime) as starttime\n    , max(charttime) as endtime\n    , DATETIME_DIFF(max(charttime), min(charttime), 'HOUR') AS duration_hours\n  from cv2\n  group by icustay_id, arterial_line_rownum\n  having min(charttime) != max(charttime)\n)\nselect icustay_id\n  -- , arterial_line_rownum\n  , starttime, endtime, duration_hours\nfrom cv_dur\nUNION ALL\n--TODO: collapse metavision durations if they overlap\nselect icustay_id\n  -- , ROW_NUMBER() over (PARTITION BY icustay_id ORDER BY starttime) as arterial_line_rownum\n  , starttime, endtime\n  , DATETIME_DIFF(endtime, starttime, 'HOUR') AS duration_hours\nfrom mv\nwhere arterial_line = 1\norder by icustay_id, starttime",
        "tables": [
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.procedureevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.procedureevents_mv.endtime",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.locationcategory",
                "mimiciii_clinical.procedureevents_mv.starttime"
            ],
            "starttime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.procedureevents_mv.endtime",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.locationcategory",
                "mimiciii_clinical.procedureevents_mv.starttime"
            ],
            "endtime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.procedureevents_mv.endtime",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.locationcategory",
                "mimiciii_clinical.procedureevents_mv.starttime"
            ],
            "duration_hours": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.procedureevents_mv.endtime",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.locationcategory",
                "mimiciii_clinical.procedureevents_mv.starttime"
            ]
        },
        "table_name": "mimiciii_clinical.arterial_line_durations",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "cv_dur.icustay_id",
                "cv_dur.starttime",
                "cv_dur.endtime",
                "cv_dur.duration_hours"
            ],
            "Sort Key": [
                "cv_dur.icustay_id",
                "cv_dur.starttime"
            ],
            "Plans": [
                {
                    "Node Type": "Bitmap Heap Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE mv",
                    "Parallel Aware": false,
                    "Relation Name": "procedureevents_mv",
                    "Schema": "mimiciii_clinical",
                    "Alias": "pe",
                    "Output": [
                        "pe.icustay_id",
                        "pe.starttime",
                        "pe.endtime",
                        "CASE WHEN (pe.itemid = ANY ('{225752,224272}'::integer[])) THEN 1 WHEN ((pe.locationcategory)::text = 'Invasive Arterial'::text) THEN 1 WHEN ((pe.itemid = 225789) AND (pe.locationcategory IS NULL)) THEN 1 ELSE 0 END"
                    ],
                    "Recheck Cond": "(pe.itemid = ANY ('{224263,224267,224268,225199,225752,225789,224272}'::integer[]))",
                    "Plans": [
                        {
                            "Node Type": "Bitmap Index Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Index Name": "procedureevents_mv_idx05",
                            "Index Cond": "(pe.itemid = ANY ('{224263,224267,224268,225199,225752,225789,224272}'::integer[]))"
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cv_grp",
                    "Parallel Aware": false,
                    "Output": [
                        "ce.icustay_id",
                        "ce.charttime",
                        "max((CASE WHEN (ce.itemid = 229) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 8392) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 235) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 8393) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 241) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 8394) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 247) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 8395) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 253) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 8396) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 259) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 8397) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 265) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 8398) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 271) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 8399) THEN ce.value ELSE NULL::character varying END)::text)"
                    ],
                    "Group Key": [
                        "ce.icustay_id",
                        "ce.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ce.icustay_id",
                                "ce.charttime",
                                "ce.itemid",
                                "ce.value"
                            ],
                            "Sort Key": [
                                "ce.icustay_id",
                                "ce.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Append",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_33",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce",
                                            "Output": [
                                                "ce.icustay_id",
                                                "ce.charttime",
                                                "ce.itemid",
                                                "ce.value"
                                            ],
                                            "Recheck Cond": "(ce.itemid = ANY ('{229,235,241,247,253,259,265,271,8392,8393,8394,8395,8396,8397,8398,8399}'::integer[]))",
                                            "Filter": "(ce.value IS NOT NULL)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_33_idx01",
                                                    "Index Cond": "(ce.itemid = ANY ('{229,235,241,247,253,259,265,271,8392,8393,8394,8395,8396,8397,8398,8399}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_34",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_1",
                                            "Output": [
                                                "ce_1.icustay_id",
                                                "ce_1.charttime",
                                                "ce_1.itemid",
                                                "ce_1.value"
                                            ],
                                            "Recheck Cond": "(ce_1.itemid = ANY ('{229,235,241,247,253,259,265,271,8392,8393,8394,8395,8396,8397,8398,8399}'::integer[]))",
                                            "Filter": "(ce_1.value IS NOT NULL)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_34_idx01",
                                                    "Index Cond": "(ce_1.itemid = ANY ('{229,235,241,247,253,259,265,271,8392,8393,8394,8395,8396,8397,8398,8399}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_134",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_2",
                                            "Output": [
                                                "ce_2.icustay_id",
                                                "ce_2.charttime",
                                                "ce_2.itemid",
                                                "ce_2.value"
                                            ],
                                            "Recheck Cond": "(ce_2.itemid = ANY ('{229,235,241,247,253,259,265,271,8392,8393,8394,8395,8396,8397,8398,8399}'::integer[]))",
                                            "Filter": "(ce_2.value IS NOT NULL)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_134_idx01",
                                                    "Index Cond": "(ce_2.itemid = ANY ('{229,235,241,247,253,259,265,271,8392,8393,8394,8395,8396,8397,8398,8399}'::integer[]))"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cv",
                    "Parallel Aware": false,
                    "Output": [
                        "cv_grp.icustay_id",
                        "cv_grp.charttime"
                    ],
                    "Group Key": [
                        "cv_grp.icustay_id",
                        "cv_grp.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "cv_grp",
                            "Alias": "cv_grp",
                            "Output": [
                                "cv_grp.icustay_id",
                                "cv_grp.charttime",
                                "cv_grp.inv1_type",
                                "cv_grp.inv1_site",
                                "cv_grp.inv2_type",
                                "cv_grp.inv2_site",
                                "cv_grp.inv3_type",
                                "cv_grp.inv3_site",
                                "cv_grp.inv4_type",
                                "cv_grp.inv4_site",
                                "cv_grp.inv5_type",
                                "cv_grp.inv5_site",
                                "cv_grp.inv6_type",
                                "cv_grp.inv6_site",
                                "cv_grp.inv7_type",
                                "cv_grp.inv7_site",
                                "cv_grp.inv8_type",
                                "cv_grp.inv8_site"
                            ],
                            "Filter": "((cv_grp.inv1_type = ANY ('{A-Line,IABP}'::text[])) OR (cv_grp.inv2_type = ANY ('{A-Line,IABP}'::text[])) OR (cv_grp.inv3_type = ANY ('{A-Line,IABP}'::text[])) OR (cv_grp.inv4_type = ANY ('{A-Line,IABP}'::text[])) OR (cv_grp.inv5_type = ANY ('{A-Line,IABP}'::text[])) OR (cv_grp.inv6_type = ANY ('{A-Line,IABP}'::text[])) OR (cv_grp.inv7_type = ANY ('{A-Line,IABP}'::text[])) OR (cv_grp.inv8_type = ANY ('{A-Line,IABP}'::text[])))"
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cv0",
                    "Parallel Aware": false,
                    "Output": [
                        "cv.icustay_id",
                        "lag(cv.charttime, 1) OVER (?)",
                        "cv.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "cv.icustay_id",
                                "cv.charttime"
                            ],
                            "Sort Key": [
                                "cv.icustay_id",
                                "cv.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "cv",
                                    "Alias": "cv",
                                    "Output": [
                                        "cv.icustay_id",
                                        "cv.charttime"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cv1",
                    "Parallel Aware": false,
                    "CTE Name": "cv0",
                    "Alias": "cv0",
                    "Output": [
                        "cv0.icustay_id",
                        "cv0.charttime",
                        "cv0.charttime_lag",
                        "(cv0.charttime - cv0.charttime_lag)",
                        "CASE WHEN (datetime_diff(cv0.charttime, cv0.charttime_lag, 'HOUR'::text) > '16'::numeric) THEN 1 ELSE 0 END"
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cv2",
                    "Parallel Aware": false,
                    "Output": [
                        "cv1.icustay_id",
                        "cv1.charttime",
                        "cv1.charttime_lag",
                        "cv1.arterial_line_duration",
                        "cv1.arterial_line_new",
                        "sum(cv1.arterial_line_new) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "cv1.icustay_id",
                                "cv1.charttime",
                                "cv1.charttime_lag",
                                "cv1.arterial_line_duration",
                                "cv1.arterial_line_new"
                            ],
                            "Sort Key": [
                                "cv1.icustay_id",
                                "cv1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "cv1",
                                    "Alias": "cv1",
                                    "Output": [
                                        "cv1.icustay_id",
                                        "cv1.charttime",
                                        "cv1.charttime_lag",
                                        "cv1.arterial_line_duration",
                                        "cv1.arterial_line_new"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cv_dur",
                    "Parallel Aware": false,
                    "Output": [
                        "cv2.icustay_id",
                        "cv2.arterial_line_rownum",
                        "min(cv2.charttime)",
                        "max(cv2.charttime)",
                        "datetime_diff(max(cv2.charttime), min(cv2.charttime), 'HOUR'::text)"
                    ],
                    "Group Key": [
                        "cv2.icustay_id",
                        "cv2.arterial_line_rownum"
                    ],
                    "Filter": "(min(cv2.charttime) <> max(cv2.charttime))",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "cv2",
                            "Alias": "cv2",
                            "Output": [
                                "cv2.icustay_id",
                                "cv2.charttime",
                                "cv2.charttime_lag",
                                "cv2.arterial_line_duration",
                                "cv2.arterial_line_new",
                                "cv2.arterial_line_rownum"
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "cv_dur",
                            "Alias": "cv_dur",
                            "Output": [
                                "cv_dur.icustay_id",
                                "cv_dur.starttime",
                                "cv_dur.endtime",
                                "cv_dur.duration_hours"
                            ]
                        },
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "mv",
                            "Alias": "mv",
                            "Output": [
                                "mv.icustay_id",
                                "mv.starttime",
                                "mv.endtime",
                                "datetime_diff(mv.endtime, mv.starttime, 'HOUR'::text)"
                            ],
                            "Filter": "(mv.arterial_line = 1)"
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.central_line_durations": {
        "sql": "with mv as\n(\n  select\n    pe.icustay_id\n  , pe.starttime, pe.endtime\n    , case\n        when (locationcategory <> 'Invasive Arterial' or locationcategory is null)\n          then 1\n        else 0\n      end as central_line\n  FROM procedureevents_mv pe\n  where pe.itemid in\n  (\n      224263 -- Multi Lumen | None | 12 | Processes\n    , 224264 -- PICC Line | None | 12 | Processes\n    , 224267 -- Cordis/Introducer | None | 12 | Processes\n    , 224268 -- Trauma line | None | 12 | Processes\n    , 225199 -- Triple Introducer | None | 12 | Processes\n    , 225202 -- Indwelling Port (PortaCath) | None | 12 | Processes\n    , 225203 -- Pheresis Catheter | None | 12 | Processes\n    , 225315 -- Tunneled (Hickman) Line | None | 12 | Processes\n    , 225752 -- Arterial Line | None | 12 | Processes\n    , 227719 -- AVA Line | None | 12 | Processes\n    -- , 228286 -- Intraosseous Device | None | 12 | Processes\n    , 224270 -- Dialysis Catheter\n  )\n)\n, cv_grp as\n(\n  -- group type+site\n  select ce.icustay_id, ce.charttime\n    , max(case when itemid =  229  then value else null end) as INV1_Type\n    , max(case when itemid =  8392 then value else null end) as INV1_Site\n    , max(case when itemid =  235  then value else null end) as INV2_Type\n    , max(case when itemid =  8393 then value else null end) as INV2_Site\n    , max(case when itemid =  241  then value else null end) as INV3_Type\n    , max(case when itemid =  8394 then value else null end) as INV3_Site\n    , max(case when itemid =  247  then value else null end) as INV4_Type\n    , max(case when itemid =  8395 then value else null end) as INV4_Site\n    , max(case when itemid =  253  then value else null end) as INV5_Type\n    , max(case when itemid =  8396 then value else null end) as INV5_Site\n    , max(case when itemid =  259  then value else null end) as INV6_Type\n    , max(case when itemid =  8397 then value else null end) as INV6_Site\n    , max(case when itemid =  265  then value else null end) as INV7_Type\n    , max(case when itemid =  8398 then value else null end) as INV7_Site\n    , max(case when itemid =  271  then value else null end) as INV8_Type\n    , max(case when itemid =  8399 then value else null end) as INV8_Site\n  FROM chartevents ce\n  where ce.itemid in\n  (\n      229 -- INV Line#1 [Type]\n    , 235 -- INV Line#2 [Type]\n    , 241 -- INV Line#3 [Type]\n    , 247 -- INV Line#4 [Type]\n    , 253 -- INV Line#5 [Type]\n    , 259 -- INV Line#6 [Type]\n    , 265 -- INV Line#7 [Type]\n    , 271 -- INV Line#8 [Type]\n    , 8392 -- INV Line#1 [Site]\n    , 8393 -- INV Line#2 [Site]\n    , 8394 -- INV Line#3 [Site]\n    , 8395 -- INV Line#4 [Site]\n    , 8396 -- INV Line#5 [Site]\n    , 8397 -- INV Line#6 [Site]\n    , 8398 -- INV Line#7 [Site]\n    , 8399 -- INV Line#8 [Site]\n  )\n  and ce.value is not null\n  group by ce.icustay_id, ce.charttime\n)\n-- types of invasive lines in carevue\n--       value       | count\n-- ------------------+--------\n--  A-Line           | 460627\n--  Multi-lumen      | 345858\n--  PICC line        |  92285\n--  PA line          |  65702\n--  Dialysis Line    |  57579\n--  Introducer       |  36027\n--  CCO PA Line      |  24831\n--                   |  22369\n--  Trauma Line      |  15530\n--  Portacath        |  12927\n--  Ventriculostomy  |  10295\n--  Pre-Sep Catheter |   9678\n--  IABP             |   8819\n--  Other/Remarks    |   8725\n--  Midline          |   5067\n--  Venous Access    |   4278\n--  Hickman          |   3783\n--  PacerIntroducer  |   2663\n--  TripleIntroducer |   2262\n--  RIC              |   1625\n--  PermaCath        |   1066\n--  Camino Bolt      |    913\n--  Lumbar Drain     |    361\n-- (23 rows)\n, cv as\n(\n  select distinct icustay_id, charttime\n  from cv_grp\n  where (inv1_type in ('Multi-lumen', 'PICC line', 'Dialysis Line', 'Introducer','Trauma Line', 'Portacath', 'Venous Access', 'Hickman', 'PacerIntroducer', 'TripleIntroducer'))\n     OR (inv2_type in ('Multi-lumen', 'PICC line', 'Dialysis Line', 'Introducer','Trauma Line', 'Portacath', 'Venous Access', 'Hickman', 'PacerIntroducer', 'TripleIntroducer'))\n     OR (inv3_type in ('Multi-lumen', 'PICC line', 'Dialysis Line', 'Introducer','Trauma Line', 'Portacath', 'Venous Access', 'Hickman', 'PacerIntroducer', 'TripleIntroducer'))\n     OR (inv4_type in ('Multi-lumen', 'PICC line', 'Dialysis Line', 'Introducer','Trauma Line', 'Portacath', 'Venous Access', 'Hickman', 'PacerIntroducer', 'TripleIntroducer'))\n     OR (inv5_type in ('Multi-lumen', 'PICC line', 'Dialysis Line', 'Introducer','Trauma Line', 'Portacath', 'Venous Access', 'Hickman', 'PacerIntroducer', 'TripleIntroducer'))\n     OR (inv6_type in ('Multi-lumen', 'PICC line', 'Dialysis Line', 'Introducer','Trauma Line', 'Portacath', 'Venous Access', 'Hickman', 'PacerIntroducer', 'TripleIntroducer'))\n     OR (inv7_type in ('Multi-lumen', 'PICC line', 'Dialysis Line', 'Introducer','Trauma Line', 'Portacath', 'Venous Access', 'Hickman', 'PacerIntroducer', 'TripleIntroducer'))\n     OR (inv8_type in ('Multi-lumen', 'PICC line', 'Dialysis Line', 'Introducer','Trauma Line', 'Portacath', 'Venous Access', 'Hickman', 'PacerIntroducer', 'TripleIntroducer'))\n)\n-- transform carevue data into durations\n, cv0 as\n(\n  select\n    icustay_id\n    -- this carries over the previous charttime\n    , LAG(CHARTTIME, 1) OVER (partition by icustay_id order by charttime) as charttime_lag\n    , charttime\n  from cv\n)\n, cv1 as\n(\n  select\n    icustay_id\n    , charttime\n    , charttime_lag\n    -- if the current observation indicates a line is present\n    -- calculate the time since the last charted line\n    , charttime - charttime_lag as central_line_duration\n    -- now we determine if the current line is \"new\"\n    -- new == no documentation for 16 hours\n    , case\n        when DATETIME_DIFF(charttime, charttime_lag, 'HOUR') > 16\n          then 1\n      else 0\n      end as central_line_new\n  FROM cv0\n)\n, cv2 as\n(\n  select cv1.*\n  -- create a cumulative sum of the instances of new events\n  -- this results in a monotonic integer assigned to each new instance of a line\n  , SUM( central_line_new )\n    OVER ( partition by icustay_id order by charttime )\n    as central_line_rownum\n  from cv1\n)\n-- create the durations for each line\n, cv_dur as\n(\n  select icustay_id\n    , central_line_rownum\n    , min(charttime) as starttime\n    , max(charttime) as endtime\n    , DATETIME_DIFF(max(charttime), min(charttime), 'HOUR') AS duration_hours\n  from cv2\n  group by icustay_id, central_line_rownum\n  having min(charttime) != max(charttime)\n)\nselect icustay_id\n  -- , central_line_rownum\n  , starttime, endtime, duration_hours\nfrom cv_dur\nUNION ALL\n--TODO: collapse metavision durations if they overlap\nselect icustay_id\n  -- , ROW_NUMBER() over (PARTITION BY icustay_id ORDER BY starttime) as central_line_rownum\n  , starttime, endtime\n  , DATETIME_DIFF(endtime, starttime, 'HOUR') AS duration_hours\nfrom mv\nwhere central_line = 1\norder by icustay_id, starttime",
        "tables": [
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.procedureevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.procedureevents_mv.endtime",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.locationcategory",
                "mimiciii_clinical.procedureevents_mv.starttime"
            ],
            "starttime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.procedureevents_mv.endtime",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.locationcategory",
                "mimiciii_clinical.procedureevents_mv.starttime"
            ],
            "endtime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.procedureevents_mv.endtime",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.locationcategory",
                "mimiciii_clinical.procedureevents_mv.starttime"
            ],
            "duration_hours": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.procedureevents_mv.endtime",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.locationcategory",
                "mimiciii_clinical.procedureevents_mv.starttime"
            ]
        },
        "table_name": "mimiciii_clinical.central_line_durations",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "cv_dur.icustay_id",
                "cv_dur.starttime",
                "cv_dur.endtime",
                "cv_dur.duration_hours"
            ],
            "Sort Key": [
                "cv_dur.icustay_id",
                "cv_dur.starttime"
            ],
            "Plans": [
                {
                    "Node Type": "Bitmap Heap Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE mv",
                    "Parallel Aware": false,
                    "Relation Name": "procedureevents_mv",
                    "Schema": "mimiciii_clinical",
                    "Alias": "pe",
                    "Output": [
                        "pe.icustay_id",
                        "pe.starttime",
                        "pe.endtime",
                        "CASE WHEN (((pe.locationcategory)::text <> 'Invasive Arterial'::text) OR (pe.locationcategory IS NULL)) THEN 1 ELSE 0 END"
                    ],
                    "Recheck Cond": "(pe.itemid = ANY ('{224263,224264,224267,224268,225199,225202,225203,225315,225752,227719,224270}'::integer[]))",
                    "Plans": [
                        {
                            "Node Type": "Bitmap Index Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Index Name": "procedureevents_mv_idx05",
                            "Index Cond": "(pe.itemid = ANY ('{224263,224264,224267,224268,225199,225202,225203,225315,225752,227719,224270}'::integer[]))"
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cv_grp",
                    "Parallel Aware": false,
                    "Output": [
                        "ce.icustay_id",
                        "ce.charttime",
                        "max((CASE WHEN (ce.itemid = 229) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 8392) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 235) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 8393) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 241) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 8394) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 247) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 8395) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 253) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 8396) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 259) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 8397) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 265) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 8398) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 271) THEN ce.value ELSE NULL::character varying END)::text)",
                        "max((CASE WHEN (ce.itemid = 8399) THEN ce.value ELSE NULL::character varying END)::text)"
                    ],
                    "Group Key": [
                        "ce.icustay_id",
                        "ce.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ce.icustay_id",
                                "ce.charttime",
                                "ce.itemid",
                                "ce.value"
                            ],
                            "Sort Key": [
                                "ce.icustay_id",
                                "ce.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Append",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_33",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce",
                                            "Output": [
                                                "ce.icustay_id",
                                                "ce.charttime",
                                                "ce.itemid",
                                                "ce.value"
                                            ],
                                            "Recheck Cond": "(ce.itemid = ANY ('{229,235,241,247,253,259,265,271,8392,8393,8394,8395,8396,8397,8398,8399}'::integer[]))",
                                            "Filter": "(ce.value IS NOT NULL)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_33_idx01",
                                                    "Index Cond": "(ce.itemid = ANY ('{229,235,241,247,253,259,265,271,8392,8393,8394,8395,8396,8397,8398,8399}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_34",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_1",
                                            "Output": [
                                                "ce_1.icustay_id",
                                                "ce_1.charttime",
                                                "ce_1.itemid",
                                                "ce_1.value"
                                            ],
                                            "Recheck Cond": "(ce_1.itemid = ANY ('{229,235,241,247,253,259,265,271,8392,8393,8394,8395,8396,8397,8398,8399}'::integer[]))",
                                            "Filter": "(ce_1.value IS NOT NULL)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_34_idx01",
                                                    "Index Cond": "(ce_1.itemid = ANY ('{229,235,241,247,253,259,265,271,8392,8393,8394,8395,8396,8397,8398,8399}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_134",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_2",
                                            "Output": [
                                                "ce_2.icustay_id",
                                                "ce_2.charttime",
                                                "ce_2.itemid",
                                                "ce_2.value"
                                            ],
                                            "Recheck Cond": "(ce_2.itemid = ANY ('{229,235,241,247,253,259,265,271,8392,8393,8394,8395,8396,8397,8398,8399}'::integer[]))",
                                            "Filter": "(ce_2.value IS NOT NULL)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_134_idx01",
                                                    "Index Cond": "(ce_2.itemid = ANY ('{229,235,241,247,253,259,265,271,8392,8393,8394,8395,8396,8397,8398,8399}'::integer[]))"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cv",
                    "Parallel Aware": false,
                    "Output": [
                        "cv_grp.icustay_id",
                        "cv_grp.charttime"
                    ],
                    "Group Key": [
                        "cv_grp.icustay_id",
                        "cv_grp.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "cv_grp",
                            "Alias": "cv_grp",
                            "Output": [
                                "cv_grp.icustay_id",
                                "cv_grp.charttime",
                                "cv_grp.inv1_type",
                                "cv_grp.inv1_site",
                                "cv_grp.inv2_type",
                                "cv_grp.inv2_site",
                                "cv_grp.inv3_type",
                                "cv_grp.inv3_site",
                                "cv_grp.inv4_type",
                                "cv_grp.inv4_site",
                                "cv_grp.inv5_type",
                                "cv_grp.inv5_site",
                                "cv_grp.inv6_type",
                                "cv_grp.inv6_site",
                                "cv_grp.inv7_type",
                                "cv_grp.inv7_site",
                                "cv_grp.inv8_type",
                                "cv_grp.inv8_site"
                            ],
                            "Filter": "((cv_grp.inv1_type = ANY ('{Multi-lumen,\"PICC line\",\"Dialysis Line\",Introducer,\"Trauma Line\",Portacath,\"Venous Access\",Hickman,PacerIntroducer,TripleIntroducer}'::text[])) OR (cv_grp.inv2_type = ANY ('{Multi-lumen,\"PICC line\",\"Dialysis Line\",Introducer,\"Trauma Line\",Portacath,\"Venous Access\",Hickman,PacerIntroducer,TripleIntroducer}'::text[])) OR (cv_grp.inv3_type = ANY ('{Multi-lumen,\"PICC line\",\"Dialysis Line\",Introducer,\"Trauma Line\",Portacath,\"Venous Access\",Hickman,PacerIntroducer,TripleIntroducer}'::text[])) OR (cv_grp.inv4_type = ANY ('{Multi-lumen,\"PICC line\",\"Dialysis Line\",Introducer,\"Trauma Line\",Portacath,\"Venous Access\",Hickman,PacerIntroducer,TripleIntroducer}'::text[])) OR (cv_grp.inv5_type = ANY ('{Multi-lumen,\"PICC line\",\"Dialysis Line\",Introducer,\"Trauma Line\",Portacath,\"Venous Access\",Hickman,PacerIntroducer,TripleIntroducer}'::text[])) OR (cv_grp.inv6_type = ANY ('{Multi-lumen,\"PICC line\",\"Dialysis Line\",Introducer,\"Trauma Line\",Portacath,\"Venous Access\",Hickman,PacerIntroducer,TripleIntroducer}'::text[])) OR (cv_grp.inv7_type = ANY ('{Multi-lumen,\"PICC line\",\"Dialysis Line\",Introducer,\"Trauma Line\",Portacath,\"Venous Access\",Hickman,PacerIntroducer,TripleIntroducer}'::text[])) OR (cv_grp.inv8_type = ANY ('{Multi-lumen,\"PICC line\",\"Dialysis Line\",Introducer,\"Trauma Line\",Portacath,\"Venous Access\",Hickman,PacerIntroducer,TripleIntroducer}'::text[])))"
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cv0",
                    "Parallel Aware": false,
                    "Output": [
                        "cv.icustay_id",
                        "lag(cv.charttime, 1) OVER (?)",
                        "cv.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "cv.icustay_id",
                                "cv.charttime"
                            ],
                            "Sort Key": [
                                "cv.icustay_id",
                                "cv.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "cv",
                                    "Alias": "cv",
                                    "Output": [
                                        "cv.icustay_id",
                                        "cv.charttime"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cv1",
                    "Parallel Aware": false,
                    "CTE Name": "cv0",
                    "Alias": "cv0",
                    "Output": [
                        "cv0.icustay_id",
                        "cv0.charttime",
                        "cv0.charttime_lag",
                        "(cv0.charttime - cv0.charttime_lag)",
                        "CASE WHEN (datetime_diff(cv0.charttime, cv0.charttime_lag, 'HOUR'::text) > '16'::numeric) THEN 1 ELSE 0 END"
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cv2",
                    "Parallel Aware": false,
                    "Output": [
                        "cv1.icustay_id",
                        "cv1.charttime",
                        "cv1.charttime_lag",
                        "cv1.central_line_duration",
                        "cv1.central_line_new",
                        "sum(cv1.central_line_new) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "cv1.icustay_id",
                                "cv1.charttime",
                                "cv1.charttime_lag",
                                "cv1.central_line_duration",
                                "cv1.central_line_new"
                            ],
                            "Sort Key": [
                                "cv1.icustay_id",
                                "cv1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "cv1",
                                    "Alias": "cv1",
                                    "Output": [
                                        "cv1.icustay_id",
                                        "cv1.charttime",
                                        "cv1.charttime_lag",
                                        "cv1.central_line_duration",
                                        "cv1.central_line_new"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cv_dur",
                    "Parallel Aware": false,
                    "Output": [
                        "cv2.icustay_id",
                        "cv2.central_line_rownum",
                        "min(cv2.charttime)",
                        "max(cv2.charttime)",
                        "datetime_diff(max(cv2.charttime), min(cv2.charttime), 'HOUR'::text)"
                    ],
                    "Group Key": [
                        "cv2.icustay_id",
                        "cv2.central_line_rownum"
                    ],
                    "Filter": "(min(cv2.charttime) <> max(cv2.charttime))",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "cv2",
                            "Alias": "cv2",
                            "Output": [
                                "cv2.icustay_id",
                                "cv2.charttime",
                                "cv2.charttime_lag",
                                "cv2.central_line_duration",
                                "cv2.central_line_new",
                                "cv2.central_line_rownum"
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "cv_dur",
                            "Alias": "cv_dur",
                            "Output": [
                                "cv_dur.icustay_id",
                                "cv_dur.starttime",
                                "cv_dur.endtime",
                                "cv_dur.duration_hours"
                            ]
                        },
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "mv",
                            "Alias": "mv",
                            "Output": [
                                "mv.icustay_id",
                                "mv.starttime",
                                "mv.endtime",
                                "datetime_diff(mv.endtime, mv.starttime, 'HOUR'::text)"
                            ],
                            "Filter": "(mv.central_line = 1)"
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.crrt_durations": {
        "sql": "with crrt_settings as\n(\n  select ce.icustay_id, ce.charttime\n  , max(\n      case\n        when ce.itemid in\n        (\n          224149, -- Access Pressure\n          224144, -- Blood Flow (ml/min)\n          228004, -- Citrate (ACD-A)\n          225183, -- Current Goal\n          225977, -- Dialysate Fluid\n          224154, -- Dialysate Rate\n          224151, -- Effluent Pressure\n          224150, -- Filter Pressure\n          225958, -- Heparin Concentration (units/mL)\n          224145, -- Heparin Dose (per hour)\n          224191, -- Hourly Patient Fluid Removal\n          228005, -- PBP (Prefilter) Replacement Rate\n          228006, -- Post Filter Replacement Rate\n          225976, -- Replacement Fluid\n          224153, -- Replacement Rate\n          224152, -- Return Pressure\n          226457  -- Ultrafiltrate Output\n        ) then 1\n      when ce.itemid in\n        (\n        29,  -- Access mmHg\n        173, -- Effluent Press mmHg\n        192, -- Filter Pressure mmHg\n        624, -- Return Pressure mmHg\n        79, -- Blood Flow ml/min\n        142, -- Current Goal\n        146, -- Dialysate Flow ml/hr\n        611, -- Replace Rate ml/hr\n        5683 -- Hourly PFR\n        ) then 1\n      when ce.itemid = 665 and value in ('Active','Clot Increasing','Clots Present','No Clot Present')\n         then 1\n      when ce.itemid = 147 and value = 'Yes'\n         then 1\n      else 0 end)\n      as RRT\n  -- Below indicates that a new instance of CRRT has started\n  , max(\n    case\n      -- System Integrity\n      when ce.itemid = 224146 and value in ('New Filter','Reinitiated')\n        then 1\n      when ce.itemid = 665 and value in ('Initiated')\n        then 1\n    else 0\n   end ) as RRT_start\n  -- Below indicates that the current instance of CRRT has ended\n  , max(\n    case\n      -- System Integrity\n      when ce.itemid = 224146 and value in ('Discontinued','Recirculating')\n        then 1\n      -- the only value like DC is \"DC'D\", use like to avoid apostrophe\n      when ce.itemid = 665 and (value = 'Clotted' OR value LIKE 'DC%')\n        then 1\n      -- Reason for CRRT filter change\n      when ce.itemid = 225956\n        then 1\n    else 0\n   end ) as RRT_end\n  FROM chartevents ce\n  where ce.itemid in\n  (\n    -- MetaVision ITEMIDs\n    -- Below require special handling\n    224146, -- System Integrity\n    225956,  -- Reason for CRRT Filter Change\n    -- Below are settings which indicate CRRT is started/continuing\n    224149, -- Access Pressure\n    224144, -- Blood Flow (ml/min)\n    228004, -- Citrate (ACD-A)\n    225183, -- Current Goal\n    225977, -- Dialysate Fluid\n    224154, -- Dialysate Rate\n    224151, -- Effluent Pressure\n    224150, -- Filter Pressure\n    225958, -- Heparin Concentration (units/mL)\n    224145, -- Heparin Dose (per hour)\n    224191, -- Hourly Patient Fluid Removal\n    228005, -- PBP (Prefilter) Replacement Rate\n    228006, -- Post Filter Replacement Rate\n    225976, -- Replacement Fluid\n    224153, -- Replacement Rate\n    224152, -- Return Pressure\n    226457, -- Ultrafiltrate Output\n    -- CareVue ITEMIDs\n    -- Below require special handling\n    665,  -- System integrity\n    147, -- Dialysate Infusing\n    612, -- Replace.Fluid Infuse\n    -- Below are settings which indicate CRRT is started/continuing\n    29,  -- Access mmHg\n    173, -- Effluent Press mmHg\n    192, -- Filter Pressure mmHg\n    624, -- Return Pressure mmHg\n    142, -- Current Goal\n    79, -- Blood Flow ml/min\n    146, -- Dialysate Flow ml/hr\n    611, -- Replace Rate ml/hr\n    5683 -- Hourly PFR\n  )\n  and ce.value is not null\n  and coalesce(ce.valuenum,1) != 0 -- non-zero rates/values\n  group by icustay_id, charttime\n)\n-- create various lagged variables for future query\n, vd_lag AS\n(\n  select\n    icustay_id\n    -- this carries over the previous charttime\n    , LAG(CHARTTIME, 1) OVER W AS charttime_prev_row\n    , charttime\n    , RRT\n    , RRT_start\n    , RRT_end\n    , LAG(RRT_end, 1) OVER W AS rrt_ended_prev_row\n  FROM crrt_settings\n  WINDOW w AS \n  (\n    partition by icustay_id, case when RRT=1 or RRT_end=1 then 1 else 0 end\n    order by charttime\n  )\n)\n, vd1 as\n(\n  select\n      icustay_id\n      , charttime\n      , RRT\n      , RRT_start\n      , RRT_end\n\n      -- now we determine if the current event is a new instantiation\n      , case\n          when RRT_start = 1\n            then 1\n        -- if there is an end flag, we mark any subsequent event as new\n          when RRT_end = 1\n            -- note the end is *not* a new event, the *subsequent* row is\n            -- so here we output 0\n            then 0\n          when rrt_ended_prev_row = 1\n            then 1\n            -- if there is less than 2 hours between CRRT settings, we do not treat this as a new CRRT event\n          when DATETIME_DIFF(charttime, charttime_prev_row, 'HOUR') <= 2\n            then 0\n        else 1\n      end as NewCRRT\n  -- use the temp table with only settings FROM chartevents\n  FROM vd_lag\n)\n, vd2 as\n(\n  select vd1.*\n  -- create a cumulative sum of the instances of new CRRT\n  -- this results in a monotonically increasing integer assigned to each CRRT\n  , case when RRT_start = 1 or RRT=1 or RRT_end = 1 then\n      SUM( NewCRRT )\n      OVER ( partition by icustay_id order by charttime )\n    else null end\n    as num\n  --- now we convert CHARTTIME of CRRT settings into durations\n  from vd1\n  -- now we can isolate to just rows with settings\n  -- (before we had rows with start/end flags)\n  -- this removes any null values for NewCRRT\n  where\n    RRT_start = 1 or RRT = 1 or RRT_end = 1\n)\n-- create the durations for each CRRT instance\n, fin as\n(\nselect icustay_id\n  , num\n  , min(charttime) as starttime\n  , max(charttime) as endtime\n \t, DATETIME_DIFF(max(charttime), min(charttime), 'HOUR') AS duration_hours\n  -- add durations\nfrom vd2\ngroup by icustay_id, num\nhaving min(charttime) != max(charttime)\n)\nselect icustay_id\n  , ROW_NUMBER() over (partition by icustay_id order by starttime) as num\n  , starttime, endtime, duration_hours\nfrom fin\norder by icustay_id, num",
        "tables": [
            "mimiciii_clinical.chartevents"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "num": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "starttime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "endtime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "duration_hours": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum"
            ]
        },
        "table_name": "mimiciii_clinical.crrt_durations",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "fin.icustay_id",
                "(row_number() OVER (?))",
                "fin.starttime",
                "fin.endtime",
                "fin.duration_hours"
            ],
            "Sort Key": [
                "fin.icustay_id",
                "(row_number() OVER (?))"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE crrt_settings",
                    "Parallel Aware": false,
                    "Output": [
                        "ce.icustay_id",
                        "ce.charttime",
                        "max(CASE WHEN (ce.itemid = ANY ('{224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457}'::integer[])) THEN 1 WHEN (ce.itemid = ANY ('{29,173,192,624,79,142,146,611,5683}'::integer[])) THEN 1 WHEN ((ce.itemid = 665) AND ((ce.value)::text = ANY ('{Active,\"Clot Increasing\",\"Clots Present\",\"No Clot Present\"}'::text[]))) THEN 1 WHEN ((ce.itemid = 147) AND ((ce.value)::text = 'Yes'::text)) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((ce.itemid = 224146) AND ((ce.value)::text = ANY ('{\"New Filter\",Reinitiated}'::text[]))) THEN 1 WHEN ((ce.itemid = 665) AND ((ce.value)::text = 'Initiated'::text)) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((ce.itemid = 224146) AND ((ce.value)::text = ANY ('{Discontinued,Recirculating}'::text[]))) THEN 1 WHEN ((ce.itemid = 665) AND (((ce.value)::text = 'Clotted'::text) OR ((ce.value)::text ~~ 'DC%'::text))) THEN 1 WHEN (ce.itemid = 225956) THEN 1 ELSE 0 END)"
                    ],
                    "Group Key": [
                        "ce.icustay_id",
                        "ce.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ce.icustay_id",
                                "ce.charttime",
                                "ce.itemid",
                                "ce.value"
                            ],
                            "Sort Key": [
                                "ce.icustay_id",
                                "ce.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Append",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_3",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce",
                                            "Output": [
                                                "ce.icustay_id",
                                                "ce.charttime",
                                                "ce.itemid",
                                                "ce.value"
                                            ],
                                            "Filter": "((ce.value IS NOT NULL) AND (COALESCE(ce.valuenum, '1'::double precision) <> '0'::double precision) AND (ce.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[])))"
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_13",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_1",
                                            "Output": [
                                                "ce_1.icustay_id",
                                                "ce_1.charttime",
                                                "ce_1.itemid",
                                                "ce_1.value"
                                            ],
                                            "Recheck Cond": "(ce_1.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))",
                                            "Filter": "((ce_1.value IS NOT NULL) AND (COALESCE(ce_1.valuenum, '1'::double precision) <> '0'::double precision))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_13_idx01",
                                                    "Index Cond": "(ce_1.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_19",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_2",
                                            "Output": [
                                                "ce_2.icustay_id",
                                                "ce_2.charttime",
                                                "ce_2.itemid",
                                                "ce_2.value"
                                            ],
                                            "Recheck Cond": "(ce_2.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))",
                                            "Filter": "((ce_2.value IS NOT NULL) AND (COALESCE(ce_2.valuenum, '1'::double precision) <> '0'::double precision))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_19_idx01",
                                                    "Index Cond": "(ce_2.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_25",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_3",
                                            "Output": [
                                                "ce_3.icustay_id",
                                                "ce_3.charttime",
                                                "ce_3.itemid",
                                                "ce_3.value"
                                            ],
                                            "Recheck Cond": "(ce_3.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))",
                                            "Filter": "((ce_3.value IS NOT NULL) AND (COALESCE(ce_3.valuenum, '1'::double precision) <> '0'::double precision))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_25_idx01",
                                                    "Index Cond": "(ce_3.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_27",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_4",
                                            "Output": [
                                                "ce_4.icustay_id",
                                                "ce_4.charttime",
                                                "ce_4.itemid",
                                                "ce_4.value"
                                            ],
                                            "Recheck Cond": "(ce_4.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))",
                                            "Filter": "((ce_4.value IS NOT NULL) AND (COALESCE(ce_4.valuenum, '1'::double precision) <> '0'::double precision))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_27_idx01",
                                                    "Index Cond": "(ce_4.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_59",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_5",
                                            "Output": [
                                                "ce_5.icustay_id",
                                                "ce_5.charttime",
                                                "ce_5.itemid",
                                                "ce_5.value"
                                            ],
                                            "Recheck Cond": "(ce_5.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))",
                                            "Filter": "((ce_5.value IS NOT NULL) AND (COALESCE(ce_5.valuenum, '1'::double precision) <> '0'::double precision))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_59_idx01",
                                                    "Index Cond": "(ce_5.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_65",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_6",
                                            "Output": [
                                                "ce_6.icustay_id",
                                                "ce_6.charttime",
                                                "ce_6.itemid",
                                                "ce_6.value"
                                            ],
                                            "Recheck Cond": "(ce_6.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))",
                                            "Filter": "((ce_6.value IS NOT NULL) AND (COALESCE(ce_6.valuenum, '1'::double precision) <> '0'::double precision))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_65_idx01",
                                                    "Index Cond": "(ce_6.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_72",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_7",
                                            "Output": [
                                                "ce_7.icustay_id",
                                                "ce_7.charttime",
                                                "ce_7.itemid",
                                                "ce_7.value"
                                            ],
                                            "Recheck Cond": "(ce_7.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))",
                                            "Filter": "((ce_7.value IS NOT NULL) AND (COALESCE(ce_7.valuenum, '1'::double precision) <> '0'::double precision))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_72_idx01",
                                                    "Index Cond": "(ce_7.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_121",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_8",
                                            "Output": [
                                                "ce_8.icustay_id",
                                                "ce_8.charttime",
                                                "ce_8.itemid",
                                                "ce_8.value"
                                            ],
                                            "Recheck Cond": "(ce_8.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))",
                                            "Filter": "((ce_8.value IS NOT NULL) AND (COALESCE(ce_8.valuenum, '1'::double precision) <> '0'::double precision))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_121_idx01",
                                                    "Index Cond": "(ce_8.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_189",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_9",
                                            "Output": [
                                                "ce_9.icustay_id",
                                                "ce_9.charttime",
                                                "ce_9.itemid",
                                                "ce_9.value"
                                            ],
                                            "Recheck Cond": "(ce_9.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))",
                                            "Filter": "((ce_9.value IS NOT NULL) AND (COALESCE(ce_9.valuenum, '1'::double precision) <> '0'::double precision))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_189_idx01",
                                                    "Index Cond": "(ce_9.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_198",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_10",
                                            "Output": [
                                                "ce_10.icustay_id",
                                                "ce_10.charttime",
                                                "ce_10.itemid",
                                                "ce_10.value"
                                            ],
                                            "Recheck Cond": "(ce_10.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))",
                                            "Filter": "((ce_10.value IS NOT NULL) AND (COALESCE(ce_10.valuenum, '1'::double precision) <> '0'::double precision))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_198_idx01",
                                                    "Index Cond": "(ce_10.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_199",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_11",
                                            "Output": [
                                                "ce_11.icustay_id",
                                                "ce_11.charttime",
                                                "ce_11.itemid",
                                                "ce_11.value"
                                            ],
                                            "Recheck Cond": "(ce_11.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))",
                                            "Filter": "((ce_11.value IS NOT NULL) AND (COALESCE(ce_11.valuenum, '1'::double precision) <> '0'::double precision))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_199_idx01",
                                                    "Index Cond": "(ce_11.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_200",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_12",
                                            "Output": [
                                                "ce_12.icustay_id",
                                                "ce_12.charttime",
                                                "ce_12.itemid",
                                                "ce_12.value"
                                            ],
                                            "Recheck Cond": "(ce_12.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))",
                                            "Filter": "((ce_12.value IS NOT NULL) AND (COALESCE(ce_12.valuenum, '1'::double precision) <> '0'::double precision))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_200_idx01",
                                                    "Index Cond": "(ce_12.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_207",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_13",
                                            "Output": [
                                                "ce_13.icustay_id",
                                                "ce_13.charttime",
                                                "ce_13.itemid",
                                                "ce_13.value"
                                            ],
                                            "Recheck Cond": "(ce_13.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))",
                                            "Filter": "((ce_13.value IS NOT NULL) AND (COALESCE(ce_13.valuenum, '1'::double precision) <> '0'::double precision))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_207_idx01",
                                                    "Index Cond": "(ce_13.itemid = ANY ('{224146,225956,224149,224144,228004,225183,225977,224154,224151,224150,225958,224145,224191,228005,228006,225976,224153,224152,226457,665,147,612,29,173,192,624,142,79,146,611,5683}'::integer[]))"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vd_lag",
                    "Parallel Aware": false,
                    "Output": [
                        "crrt_settings.icustay_id",
                        "lag(crrt_settings.charttime, 1) OVER (?)",
                        "crrt_settings.charttime",
                        "crrt_settings.rrt",
                        "crrt_settings.rrt_start",
                        "crrt_settings.rrt_end",
                        "lag(crrt_settings.rrt_end, 1) OVER (?)",
                        "(CASE WHEN ((crrt_settings.rrt = 1) OR (crrt_settings.rrt_end = 1)) THEN 1 ELSE 0 END)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "crrt_settings.icustay_id",
                                "crrt_settings.charttime",
                                "(CASE WHEN ((crrt_settings.rrt = 1) OR (crrt_settings.rrt_end = 1)) THEN 1 ELSE 0 END)",
                                "crrt_settings.rrt",
                                "crrt_settings.rrt_start",
                                "crrt_settings.rrt_end"
                            ],
                            "Sort Key": [
                                "crrt_settings.icustay_id",
                                "(CASE WHEN ((crrt_settings.rrt = 1) OR (crrt_settings.rrt_end = 1)) THEN 1 ELSE 0 END)",
                                "crrt_settings.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "crrt_settings",
                                    "Alias": "crrt_settings",
                                    "Output": [
                                        "crrt_settings.icustay_id",
                                        "crrt_settings.charttime",
                                        "CASE WHEN ((crrt_settings.rrt = 1) OR (crrt_settings.rrt_end = 1)) THEN 1 ELSE 0 END",
                                        "crrt_settings.rrt",
                                        "crrt_settings.rrt_start",
                                        "crrt_settings.rrt_end"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vd1",
                    "Parallel Aware": false,
                    "CTE Name": "vd_lag",
                    "Alias": "vd_lag",
                    "Output": [
                        "vd_lag.icustay_id",
                        "vd_lag.charttime",
                        "vd_lag.rrt",
                        "vd_lag.rrt_start",
                        "vd_lag.rrt_end",
                        "CASE WHEN (vd_lag.rrt_start = 1) THEN 1 WHEN (vd_lag.rrt_end = 1) THEN 0 WHEN (vd_lag.rrt_ended_prev_row = 1) THEN 1 WHEN (datetime_diff(vd_lag.charttime, vd_lag.charttime_prev_row, 'HOUR'::text) <= '2'::numeric) THEN 0 ELSE 1 END"
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vd2",
                    "Parallel Aware": false,
                    "Output": [
                        "vd1.icustay_id",
                        "vd1.charttime",
                        "vd1.rrt",
                        "vd1.rrt_start",
                        "vd1.rrt_end",
                        "vd1.newcrrt",
                        "CASE WHEN ((vd1.rrt_start = 1) OR (vd1.rrt = 1) OR (vd1.rrt_end = 1)) THEN sum(vd1.newcrrt) OVER (?) ELSE NULL::bigint END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vd1.icustay_id",
                                "vd1.charttime",
                                "vd1.rrt",
                                "vd1.rrt_start",
                                "vd1.rrt_end",
                                "vd1.newcrrt"
                            ],
                            "Sort Key": [
                                "vd1.icustay_id",
                                "vd1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vd1",
                                    "Alias": "vd1",
                                    "Output": [
                                        "vd1.icustay_id",
                                        "vd1.charttime",
                                        "vd1.rrt",
                                        "vd1.rrt_start",
                                        "vd1.rrt_end",
                                        "vd1.newcrrt"
                                    ],
                                    "Filter": "((vd1.rrt_start = 1) OR (vd1.rrt = 1) OR (vd1.rrt_end = 1))"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE fin",
                    "Parallel Aware": false,
                    "Output": [
                        "vd2.icustay_id",
                        "vd2.num",
                        "min(vd2.charttime)",
                        "max(vd2.charttime)",
                        "datetime_diff(max(vd2.charttime), min(vd2.charttime), 'HOUR'::text)"
                    ],
                    "Group Key": [
                        "vd2.icustay_id",
                        "vd2.num"
                    ],
                    "Filter": "(min(vd2.charttime) <> max(vd2.charttime))",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "vd2",
                            "Alias": "vd2",
                            "Output": [
                                "vd2.icustay_id",
                                "vd2.charttime",
                                "vd2.rrt",
                                "vd2.rrt_start",
                                "vd2.rrt_end",
                                "vd2.newcrrt",
                                "vd2.num"
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "fin.icustay_id",
                        "row_number() OVER (?)",
                        "fin.starttime",
                        "fin.endtime",
                        "fin.duration_hours"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "fin.icustay_id",
                                "fin.starttime",
                                "fin.endtime",
                                "fin.duration_hours"
                            ],
                            "Sort Key": [
                                "fin.icustay_id",
                                "fin.starttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "fin",
                                    "Alias": "fin",
                                    "Output": [
                                        "fin.icustay_id",
                                        "fin.starttime",
                                        "fin.endtime",
                                        "fin.duration_hours"
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.dobutamine_dose": {
        "sql": "-- This query extracts dose+durations of dopamine administration\n\n-- Get drug administration data from CareVue first\nwith vasocv1 as\n(\n    select\n    icustay_id, charttime\n    -- case statement determining whether the ITEMID is an instance of vasopressor usage\n    , max(case when itemid in (30042,30306) then 1 else 0 end) as vaso -- dobutamine\n\n    -- the 'stopped' column indicates if a vasopressor has been disconnected\n    , max(case when itemid in (30042,30306) and (stopped = 'Stopped' OR stopped like 'D/C%') then 1\n          else 0 end) as vaso_stopped\n\n    , max(case when itemid in (30042,30306) and rate is not null then 1 else 0 end) as vaso_null\n    , max(case when itemid in (30042,30306) then rate else null end) as vaso_rate\n    , max(case when itemid in (30042,30306) then amount else null end) as vaso_amount\n\n  FROM inputevents_cv\n  where itemid in (30042,30306) -- dobutamine\n  group by icustay_id, charttime\n)\n, vasocv2 as\n(\n  select v.*\n    , sum(vaso_null) over (partition by icustay_id order by charttime) as vaso_partition\n  from\n    vasocv1 v\n)\n, vasocv3 as\n(\n  select v.*\n    , first_value(vaso_rate) over (partition by icustay_id, vaso_partition order by charttime) as vaso_prevrate_ifnull\n  from\n    vasocv2 v\n)\n, vasocv4 as\n(\nselect\n    icustay_id\n    , charttime\n    -- , (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) AS delta\n\n    , vaso\n    , vaso_rate\n    , vaso_amount\n    , vaso_stopped\n    , vaso_prevrate_ifnull\n\n    -- We define start time here\n    , case\n        when vaso = 0 then null\n\n        -- if this is the first instance of the vasoactive drug\n        when vaso_rate > 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso, vaso_null\n          order by charttime\n          )\n          is null\n          then 1\n\n        -- you often get a string of 0s\n        -- we decide not to set these as 1, just because it makes vasonum sequential\n        when vaso_rate = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- sometimes you get a string of NULL, associated with 0 volumes\n        -- same reason as before, we decide not to set these as 1\n        -- vaso_prevrate_ifnull is equal to the previous value *iff* the current value is null\n        when vaso_prevrate_ifnull = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- If the last recorded rate was 0, newvaso = 1\n        when LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) = 0\n          then 1\n\n        -- If the last recorded vaso was D/C'd, newvaso = 1\n        when\n          LAG(vaso_stopped,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 1 then 1\n\n        -- ** not sure if the below is needed\n        --when (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) > (interval '4 hours') then 1\n      else null\n      end as vaso_start\n\nFROM\n  vasocv3\n)\n-- propagate start/stop flags forward in time\n, vasocv5 as\n(\n  select v.*\n    , SUM(vaso_start) OVER (partition by icustay_id, vaso order by charttime) as vaso_first\nFROM\n  vasocv4 v\n)\n, vasocv6 as\n(\n  select v.*\n    -- We define end time here\n    , case\n        when vaso = 0\n          then null\n\n        -- If the recorded vaso was D/C'd, this is an end time\n        when vaso_stopped = 1\n          then vaso_first\n\n        -- If the rate is zero, this is the end time\n        when vaso_rate = 0\n          then vaso_first\n\n        -- the last row in the table is always a potential end time\n        -- this captures patients who die/are discharged while on vasopressors\n        -- in principle, this could add an extra end time for the vasopressor\n        -- however, since we later group on vaso_start, any extra end times are ignored\n        when LEAD(CHARTTIME,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) is null\n          then vaso_first\n\n        else null\n        end as vaso_stop\n    from vasocv5 v\n)\n\n-- -- if you want to look at the results of the table before grouping:\n-- select\n--   icustay_id, charttime, vaso, vaso_rate, vaso_amount\n--     , vaso_stopped\n--     , vaso_start\n--     , vaso_first\n--     , vaso_stop\n-- from vasocv6 order by icustay_id, charttime\n\n, vasocv7 as\n(\nselect\n  icustay_id\n  , charttime as starttime\n  , lead(charttime) OVER (partition by icustay_id, vaso_first order by charttime) as endtime\n  , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\nfrom vasocv6\nwhere\n  vaso_first is not null -- bogus data\nand\n  vaso_first != 0 -- sometimes *only* a rate of 0 appears, i.e. the drug is never actually delivered\nand\n  icustay_id is not null -- there are data for \"floating\" admissions, we don't worry about these\n)\n-- table of start/stop times for event\n, vasocv8 as\n(\n  select\n    icustay_id\n    , starttime, endtime\n    , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\n  from vasocv7\n  where endtime is not null\n  and vaso_rate > 0\n  and starttime != endtime\n)\n-- collapse these start/stop times down if the rate doesn't change\n, vasocv9 as\n(\n  select\n    icustay_id\n    , starttime, endtime\n    , case\n        when LAG(endtime) OVER (partition by icustay_id order by starttime, endtime) = starttime\n        AND  LAG(vaso_rate) OVER (partition by icustay_id order by starttime, endtime) = vaso_rate\n        THEN 0\n      else 1\n    end as vaso_groups\n    , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\n  from vasocv8\n  where endtime is not null\n  and vaso_rate > 0\n  and starttime != endtime\n)\n, vasocv10 as\n(\n  select\n    icustay_id\n    , starttime, endtime\n    , vaso_groups\n    , SUM(vaso_groups) OVER (partition by icustay_id order by starttime, endtime) as vaso_groups_sum\n    , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\n  from vasocv9\n)\n, vasocv as\n(\n  select icustay_id\n  , min(starttime) as starttime\n  , max(endtime) as endtime\n  , vaso_groups_sum\n  , vaso_rate\n  , sum(vaso_amount) as vaso_amount\n  from vasocv10\n  group by icustay_id, vaso_groups_sum, vaso_rate\n)\n-- now we extract the associated data for metavision patients\n, vasomv as\n(\n  select\n    icustay_id, linkorderid\n    , rate as vaso_rate\n    , amount as vaso_amount\n    , starttime\n    , endtime\n  from inputevents_mv\n  where itemid = 221653 -- dobutamine\n  and statusdescription != 'Rewritten' -- only valid orders\n)\n-- now assign this data to every hour of the patient's stay\n-- vaso_amount for carevue is not accurate\nSELECT icustay_id\n  , starttime, endtime\n  , vaso_rate, vaso_amount\nfrom vasocv\nUNION ALL\nSELECT icustay_id\n  , starttime, endtime\n  , vaso_rate, vaso_amount\nfrom vasomv\norder by icustay_id, starttime",
        "tables": [
            "mimiciii_clinical.inputevents_cv",
            "mimiciii_clinical.inputevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "starttime": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "endtime": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "vaso_rate": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "vaso_amount": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ]
        },
        "table_name": "mimiciii_clinical.dobutamine_dose",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "vasocv.icustay_id",
                "vasocv.starttime",
                "vasocv.endtime",
                "vasocv.vaso_rate",
                "vasocv.vaso_amount"
            ],
            "Sort Key": [
                "vasocv.icustay_id",
                "vasocv.starttime"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv1",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30042,30306}'::integer[])) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = ANY ('{30042,30306}'::integer[])) AND (((inputevents_cv.stopped)::text = 'Stopped'::text) OR ((inputevents_cv.stopped)::text ~~ 'D/C%'::text))) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = ANY ('{30042,30306}'::integer[])) AND (inputevents_cv.rate IS NOT NULL)) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30042,30306}'::integer[])) THEN inputevents_cv.rate ELSE NULL::double precision END)",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30042,30306}'::integer[])) THEN inputevents_cv.amount ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime",
                                "inputevents_cv.itemid",
                                "inputevents_cv.stopped",
                                "inputevents_cv.rate",
                                "inputevents_cv.amount"
                            ],
                            "Sort Key": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "inputevents_cv",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "inputevents_cv",
                                    "Output": [
                                        "inputevents_cv.icustay_id",
                                        "inputevents_cv.charttime",
                                        "inputevents_cv.itemid",
                                        "inputevents_cv.stopped",
                                        "inputevents_cv.rate",
                                        "inputevents_cv.amount"
                                    ],
                                    "Recheck Cond": "(inputevents_cv.itemid = ANY ('{30042,30306}'::integer[]))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "inputevents_cv_idx05",
                                            "Index Cond": "(inputevents_cv.itemid = ANY ('{30042,30306}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv2",
                    "Parallel Aware": false,
                    "Output": [
                        "v.icustay_id",
                        "v.charttime",
                        "v.vaso",
                        "v.vaso_stopped",
                        "v.vaso_null",
                        "v.vaso_rate",
                        "v.vaso_amount",
                        "sum(v.vaso_null) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v.icustay_id",
                                "v.charttime",
                                "v.vaso",
                                "v.vaso_stopped",
                                "v.vaso_null",
                                "v.vaso_rate",
                                "v.vaso_amount"
                            ],
                            "Sort Key": [
                                "v.icustay_id",
                                "v.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv1",
                                    "Alias": "v",
                                    "Output": [
                                        "v.icustay_id",
                                        "v.charttime",
                                        "v.vaso",
                                        "v.vaso_stopped",
                                        "v.vaso_null",
                                        "v.vaso_rate",
                                        "v.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv3",
                    "Parallel Aware": false,
                    "Output": [
                        "v_1.icustay_id",
                        "v_1.charttime",
                        "v_1.vaso",
                        "v_1.vaso_stopped",
                        "v_1.vaso_null",
                        "v_1.vaso_rate",
                        "v_1.vaso_amount",
                        "v_1.vaso_partition",
                        "first_value(v_1.vaso_rate) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_1.icustay_id",
                                "v_1.charttime",
                                "v_1.vaso_partition",
                                "v_1.vaso",
                                "v_1.vaso_stopped",
                                "v_1.vaso_null",
                                "v_1.vaso_rate",
                                "v_1.vaso_amount"
                            ],
                            "Sort Key": [
                                "v_1.icustay_id",
                                "v_1.vaso_partition",
                                "v_1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv2",
                                    "Alias": "v_1",
                                    "Output": [
                                        "v_1.icustay_id",
                                        "v_1.charttime",
                                        "v_1.vaso_partition",
                                        "v_1.vaso",
                                        "v_1.vaso_stopped",
                                        "v_1.vaso_null",
                                        "v_1.vaso_rate",
                                        "v_1.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv4",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv3.icustay_id",
                        "vasocv3.charttime",
                        "vasocv3.vaso",
                        "vasocv3.vaso_rate",
                        "vasocv3.vaso_amount",
                        "vasocv3.vaso_stopped",
                        "vasocv3.vaso_prevrate_ifnull",
                        "CASE WHEN (vasocv3.vaso = 0) THEN NULL::integer WHEN ((vasocv3.vaso_rate > '0'::double precision) AND ((lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)) IS NULL)) THEN 1 WHEN ((vasocv3.vaso_rate = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN ((vasocv3.vaso_prevrate_ifnull = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision) THEN 1 WHEN (lag(vasocv3.vaso_stopped, 1) OVER (?) = 1) THEN 1 ELSE NULL::integer END",
                        "vasocv3.vaso_null"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv3.icustay_id",
                                "vasocv3.charttime",
                                "vasocv3.vaso",
                                "vasocv3.vaso_null",
                                "vasocv3.vaso_rate",
                                "vasocv3.vaso_amount",
                                "vasocv3.vaso_stopped",
                                "vasocv3.vaso_prevrate_ifnull",
                                "(lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?))"
                            ],
                            "Sort Key": [
                                "vasocv3.icustay_id",
                                "vasocv3.vaso",
                                "vasocv3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "WindowAgg",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv3.icustay_id",
                                        "vasocv3.charttime",
                                        "vasocv3.vaso",
                                        "vasocv3.vaso_null",
                                        "vasocv3.vaso_rate",
                                        "vasocv3.vaso_amount",
                                        "vasocv3.vaso_stopped",
                                        "vasocv3.vaso_prevrate_ifnull",
                                        "lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.charttime",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.vaso_rate",
                                                "vasocv3.vaso_amount",
                                                "vasocv3.vaso_stopped",
                                                "vasocv3.vaso_prevrate_ifnull"
                                            ],
                                            "Sort Key": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "vasocv3",
                                                    "Alias": "vasocv3",
                                                    "Output": [
                                                        "vasocv3.icustay_id",
                                                        "vasocv3.charttime",
                                                        "vasocv3.vaso",
                                                        "vasocv3.vaso_null",
                                                        "vasocv3.vaso_rate",
                                                        "vasocv3.vaso_amount",
                                                        "vasocv3.vaso_stopped",
                                                        "vasocv3.vaso_prevrate_ifnull"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv5",
                    "Parallel Aware": false,
                    "Output": [
                        "v_2.icustay_id",
                        "v_2.charttime",
                        "v_2.vaso",
                        "v_2.vaso_rate",
                        "v_2.vaso_amount",
                        "v_2.vaso_stopped",
                        "v_2.vaso_prevrate_ifnull",
                        "v_2.vaso_start",
                        "sum(v_2.vaso_start) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_2.icustay_id",
                                "v_2.charttime",
                                "v_2.vaso",
                                "v_2.vaso_rate",
                                "v_2.vaso_amount",
                                "v_2.vaso_stopped",
                                "v_2.vaso_prevrate_ifnull",
                                "v_2.vaso_start"
                            ],
                            "Sort Key": [
                                "v_2.icustay_id",
                                "v_2.vaso",
                                "v_2.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv4",
                                    "Alias": "v_2",
                                    "Output": [
                                        "v_2.icustay_id",
                                        "v_2.charttime",
                                        "v_2.vaso",
                                        "v_2.vaso_rate",
                                        "v_2.vaso_amount",
                                        "v_2.vaso_stopped",
                                        "v_2.vaso_prevrate_ifnull",
                                        "v_2.vaso_start"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv6",
                    "Parallel Aware": false,
                    "Output": [
                        "v_3.icustay_id",
                        "v_3.charttime",
                        "v_3.vaso",
                        "v_3.vaso_rate",
                        "v_3.vaso_amount",
                        "v_3.vaso_stopped",
                        "v_3.vaso_prevrate_ifnull",
                        "v_3.vaso_start",
                        "v_3.vaso_first",
                        "CASE WHEN (v_3.vaso = 0) THEN NULL::bigint WHEN (v_3.vaso_stopped = 1) THEN v_3.vaso_first WHEN (v_3.vaso_rate = '0'::double precision) THEN v_3.vaso_first WHEN (lead(v_3.charttime, 1) OVER (?) IS NULL) THEN v_3.vaso_first ELSE NULL::bigint END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_3.icustay_id",
                                "v_3.charttime",
                                "v_3.vaso",
                                "v_3.vaso_rate",
                                "v_3.vaso_amount",
                                "v_3.vaso_stopped",
                                "v_3.vaso_prevrate_ifnull",
                                "v_3.vaso_start",
                                "v_3.vaso_first"
                            ],
                            "Sort Key": [
                                "v_3.icustay_id",
                                "v_3.vaso",
                                "v_3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv5",
                                    "Alias": "v_3",
                                    "Output": [
                                        "v_3.icustay_id",
                                        "v_3.charttime",
                                        "v_3.vaso",
                                        "v_3.vaso_rate",
                                        "v_3.vaso_amount",
                                        "v_3.vaso_stopped",
                                        "v_3.vaso_prevrate_ifnull",
                                        "v_3.vaso_start",
                                        "v_3.vaso_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv7",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv6.icustay_id",
                        "vasocv6.charttime",
                        "lead(vasocv6.charttime) OVER (?)",
                        "vasocv6.vaso",
                        "vasocv6.vaso_rate",
                        "vasocv6.vaso_amount",
                        "vasocv6.vaso_stop",
                        "vasocv6.vaso_start",
                        "vasocv6.vaso_first"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv6.icustay_id",
                                "vasocv6.charttime",
                                "vasocv6.vaso_first",
                                "vasocv6.vaso",
                                "vasocv6.vaso_rate",
                                "vasocv6.vaso_amount",
                                "vasocv6.vaso_stop",
                                "vasocv6.vaso_start"
                            ],
                            "Sort Key": [
                                "vasocv6.icustay_id",
                                "vasocv6.vaso_first",
                                "vasocv6.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv6",
                                    "Alias": "vasocv6",
                                    "Output": [
                                        "vasocv6.icustay_id",
                                        "vasocv6.charttime",
                                        "vasocv6.vaso_first",
                                        "vasocv6.vaso",
                                        "vasocv6.vaso_rate",
                                        "vasocv6.vaso_amount",
                                        "vasocv6.vaso_stop",
                                        "vasocv6.vaso_start"
                                    ],
                                    "Filter": "((vasocv6.vaso_first IS NOT NULL) AND (vasocv6.icustay_id IS NOT NULL) AND (vasocv6.vaso_first <> 0))"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv8",
                    "Parallel Aware": false,
                    "CTE Name": "vasocv7",
                    "Alias": "vasocv7",
                    "Output": [
                        "vasocv7.icustay_id",
                        "vasocv7.starttime",
                        "vasocv7.endtime",
                        "vasocv7.vaso",
                        "vasocv7.vaso_rate",
                        "vasocv7.vaso_amount",
                        "vasocv7.vaso_stop",
                        "vasocv7.vaso_start",
                        "vasocv7.vaso_first"
                    ],
                    "Filter": "((vasocv7.endtime IS NOT NULL) AND (vasocv7.vaso_rate > '0'::double precision) AND (vasocv7.starttime <> vasocv7.endtime))"
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv9",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv8.icustay_id",
                        "vasocv8.starttime",
                        "vasocv8.endtime",
                        "CASE WHEN ((lag(vasocv8.endtime) OVER (?) = vasocv8.starttime) AND (lag(vasocv8.vaso_rate) OVER (?) = vasocv8.vaso_rate)) THEN 0 ELSE 1 END",
                        "vasocv8.vaso",
                        "vasocv8.vaso_rate",
                        "vasocv8.vaso_amount",
                        "vasocv8.vaso_stop",
                        "vasocv8.vaso_start",
                        "vasocv8.vaso_first"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv8.icustay_id",
                                "vasocv8.starttime",
                                "vasocv8.endtime",
                                "vasocv8.vaso_rate",
                                "vasocv8.vaso",
                                "vasocv8.vaso_amount",
                                "vasocv8.vaso_stop",
                                "vasocv8.vaso_start",
                                "vasocv8.vaso_first"
                            ],
                            "Sort Key": [
                                "vasocv8.icustay_id",
                                "vasocv8.starttime",
                                "vasocv8.endtime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv8",
                                    "Alias": "vasocv8",
                                    "Output": [
                                        "vasocv8.icustay_id",
                                        "vasocv8.starttime",
                                        "vasocv8.endtime",
                                        "vasocv8.vaso_rate",
                                        "vasocv8.vaso",
                                        "vasocv8.vaso_amount",
                                        "vasocv8.vaso_stop",
                                        "vasocv8.vaso_start",
                                        "vasocv8.vaso_first"
                                    ],
                                    "Filter": "((vasocv8.endtime IS NOT NULL) AND (vasocv8.vaso_rate > '0'::double precision) AND (vasocv8.starttime <> vasocv8.endtime))"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv10",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv9.icustay_id",
                        "vasocv9.starttime",
                        "vasocv9.endtime",
                        "vasocv9.vaso_groups",
                        "sum(vasocv9.vaso_groups) OVER (?)",
                        "vasocv9.vaso",
                        "vasocv9.vaso_rate",
                        "vasocv9.vaso_amount",
                        "vasocv9.vaso_stop",
                        "vasocv9.vaso_start",
                        "vasocv9.vaso_first"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv9.icustay_id",
                                "vasocv9.starttime",
                                "vasocv9.endtime",
                                "vasocv9.vaso_groups",
                                "vasocv9.vaso",
                                "vasocv9.vaso_rate",
                                "vasocv9.vaso_amount",
                                "vasocv9.vaso_stop",
                                "vasocv9.vaso_start",
                                "vasocv9.vaso_first"
                            ],
                            "Sort Key": [
                                "vasocv9.icustay_id",
                                "vasocv9.starttime",
                                "vasocv9.endtime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv9",
                                    "Alias": "vasocv9",
                                    "Output": [
                                        "vasocv9.icustay_id",
                                        "vasocv9.starttime",
                                        "vasocv9.endtime",
                                        "vasocv9.vaso_groups",
                                        "vasocv9.vaso",
                                        "vasocv9.vaso_rate",
                                        "vasocv9.vaso_amount",
                                        "vasocv9.vaso_stop",
                                        "vasocv9.vaso_start",
                                        "vasocv9.vaso_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv10.icustay_id",
                        "min(vasocv10.starttime)",
                        "max(vasocv10.endtime)",
                        "vasocv10.vaso_groups_sum",
                        "vasocv10.vaso_rate",
                        "sum(vasocv10.vaso_amount)"
                    ],
                    "Group Key": [
                        "vasocv10.icustay_id",
                        "vasocv10.vaso_groups_sum",
                        "vasocv10.vaso_rate"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "vasocv10",
                            "Alias": "vasocv10",
                            "Output": [
                                "vasocv10.icustay_id",
                                "vasocv10.starttime",
                                "vasocv10.endtime",
                                "vasocv10.vaso_groups",
                                "vasocv10.vaso_groups_sum",
                                "vasocv10.vaso",
                                "vasocv10.vaso_rate",
                                "vasocv10.vaso_amount",
                                "vasocv10.vaso_stop",
                                "vasocv10.vaso_start",
                                "vasocv10.vaso_first"
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Bitmap Heap Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasomv",
                    "Parallel Aware": false,
                    "Relation Name": "inputevents_mv",
                    "Schema": "mimiciii_clinical",
                    "Alias": "inputevents_mv",
                    "Output": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid",
                        "inputevents_mv.rate",
                        "inputevents_mv.amount",
                        "inputevents_mv.starttime",
                        "inputevents_mv.endtime"
                    ],
                    "Recheck Cond": "(inputevents_mv.itemid = 221653)",
                    "Filter": "((inputevents_mv.statusdescription)::text <> 'Rewritten'::text)",
                    "Plans": [
                        {
                            "Node Type": "Bitmap Index Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Index Name": "inputevents_mv_idx05",
                            "Index Cond": "(inputevents_mv.itemid = 221653)"
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "vasocv",
                            "Alias": "vasocv",
                            "Output": [
                                "vasocv.icustay_id",
                                "vasocv.starttime",
                                "vasocv.endtime",
                                "vasocv.vaso_rate",
                                "vasocv.vaso_amount"
                            ]
                        },
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "vasomv",
                            "Alias": "vasomv",
                            "Output": [
                                "vasomv.icustay_id",
                                "vasomv.starttime",
                                "vasomv.endtime",
                                "vasomv.vaso_rate",
                                "vasomv.vaso_amount"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.dobutamine_durations": {
        "sql": "-- This query extracts durations of dobutamine administration\n-- Consecutive administrations are numbered 1, 2, ...\n-- Total time on the drug can be calculated from this table by grouping using ICUSTAY_ID\n-- Get drug administration data from CareVue first\nwith vasocv1 as (\n  select\n    icustay_id,\n    charttime -- case statement determining whether the ITEMID is an instance of vasopressor usage\n,\n    max(\n      case\n        when itemid in (30042, 30306) then 1\n        else 0\n      end\n    ) as vaso -- dobutamine\n    -- the 'stopped' column indicates if a vasopressor has been disconnected\n,\n    max(\n      case\n        when itemid in (30042, 30306)\n        and (\n          stopped = 'Stopped'\n          OR stopped like 'D/C%'\n        ) then 1\n        else 0\n      end\n    ) as vaso_stopped,\n    max(\n      case\n        when itemid in (30042, 30306)\n        and rate is not null then 1\n        else 0\n      end\n    ) as vaso_null,\n    max(\n      case\n        when itemid in (30042, 30306) then rate\n        else null\n      end\n    ) as vaso_rate,\n    max(\n      case\n        when itemid in (30042, 30306) then amount\n        else null\n      end\n    ) as vaso_amount\n  FROM\n    inputevents_cv\n  where\n    itemid in (30042, 30306) -- dobutamine\n  group by\n    icustay_id,\n    charttime\n),\nvasocv2 as (\n  select\n    v.*,\n    sum(vaso_null) over (\n      partition by icustay_id\n      order by\n        charttime\n    ) as vaso_partition\n  from\n    vasocv1 v\n),\nvasocv3 as (\n  select\n    v.*,\n    first_value(vaso_rate) over (\n      partition by icustay_id,\n      vaso_partition\n      order by\n        charttime\n    ) as vaso_prevrate_ifnull\n  from\n    vasocv2 v\n),\nvasocv4 as (\n  select\n    icustay_id,\n    charttime -- , (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) AS delta\n,\n    vaso,\n    vaso_rate,\n    vaso_amount,\n    vaso_stopped,\n    vaso_prevrate_ifnull -- We define start time here\n,\n    case\n      when vaso = 0 then null -- if this is the first instance of the vasoactive drug\n      when vaso_rate > 0\n      and LAG(vaso_prevrate_ifnull, 1) OVER (\n        partition by icustay_id,\n        vaso,\n        vaso_null\n        order by\n          charttime\n      ) is null then 1 -- you often get a string of 0s\n      -- we decide not to set these as 1, just because it makes vasonum sequential\n      when vaso_rate = 0\n      and LAG(vaso_prevrate_ifnull, 1) OVER (\n        partition by icustay_id,\n        vaso\n        order by\n          charttime\n      ) = 0 then 0 -- sometimes you get a string of NULL, associated with 0 volumes\n      -- same reason as before, we decide not to set these as 1\n      -- vaso_prevrate_ifnull is equal to the previous value *iff* the current value is null\n      when vaso_prevrate_ifnull = 0\n      and LAG(vaso_prevrate_ifnull, 1) OVER (\n        partition by icustay_id,\n        vaso\n        order by\n          charttime\n      ) = 0 then 0 -- If the last recorded rate was 0, newvaso = 1\n      when LAG(vaso_prevrate_ifnull, 1) OVER (\n        partition by icustay_id,\n        vaso\n        order by\n          charttime\n      ) = 0 then 1 -- If the last recorded vaso was D/C'd, newvaso = 1\n      when LAG(vaso_stopped, 1) OVER (\n        partition by icustay_id,\n        vaso\n        order by\n          charttime\n      ) = 1 then 1 -- ** not sure if the below is needed\n      --when (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) > (interval '4 hours') then 1\n      else null\n    end as vaso_start\n  FROM\n    vasocv3\n) -- propagate start/stop flags forward in time\n,\nvasocv5 as (\n  select\n    v.*,\n    SUM(vaso_start) OVER (\n      partition by icustay_id,\n      vaso\n      order by\n        charttime\n    ) as vaso_first\n  FROM\n    vasocv4 v\n),\nvasocv6 as (\n  select\n    v.* -- We define end time here\n,\n    case\n      when vaso = 0 then null -- If the recorded vaso was D/C'd, this is an end time\n      when vaso_stopped = 1 then vaso_first -- If the rate is zero, this is the end time\n      when vaso_rate = 0 then vaso_first -- the last row in the table is always a potential end time\n      -- this captures patients who die/are discharged while on vasopressors\n      -- in principle, this could add an extra end time for the vasopressor\n      -- however, since we later group on vaso_start, any extra end times are ignored\n      when LEAD(CHARTTIME, 1) OVER (\n        partition by icustay_id,\n        vaso\n        order by\n          charttime\n      ) is null then vaso_first\n      else null\n    end as vaso_stop\n  from\n    vasocv5 v\n) -- -- if you want to look at the results of the table before grouping:\n-- select\n--   icustay_id, charttime, vaso, vaso_rate, vaso_amount\n--     , case when vaso_stopped = 1 then 'Y' else '' end as stopped\n--     , vaso_start\n--     , vaso_first\n--     , vaso_stop\n-- from vasocv6 order by charttime\n,\nvasocv as (\n  -- below groups together vasopressor administrations into groups\n  select\n    icustay_id -- the first non-null rate is considered the starttime\n,\n    min(\n      case\n        when vaso_rate is not null then charttime\n        else null\n      end\n    ) as starttime -- the *first* time the first/last flags agree is the stop time for this duration\n,\n    min(\n      case\n        when vaso_first = vaso_stop then charttime\n        else null\n      end\n    ) as endtime\n  from\n    vasocv6\n  where\n    vaso_first is not null -- bogus data\n    and vaso_first != 0 -- sometimes *only* a rate of 0 appears, i.e. the drug is never actually delivered\n    and icustay_id is not null -- there are data for \"floating\" admissions, we don't worry about these\n  group by\n    icustay_id,\n    vaso_first\n  having\n    -- ensure start time is not the same as end time\n    min(charttime) != min(\n      case\n        when vaso_first = vaso_stop then charttime\n        else null\n      end\n    )\n    and max(vaso_rate) > 0 -- if the rate was always 0 or null, we consider it not a real drug delivery\n) -- now we extract the associated data for metavision patients\n,\nvasomv as (\n  select\n    icustay_id,\n    linkorderid,\n    min(starttime) as starttime,\n    max(endtime) as endtime\n  FROM\n    inputevents_mv\n  where\n    itemid = 221653 -- dobutamine\n    and statusdescription != 'Rewritten' -- only valid orders\n  group by\n    icustay_id,\n    linkorderid\n)\nselect\n  icustay_id -- generate a sequential integer for convenience\n,\n  ROW_NUMBER() over (\n    partition by icustay_id\n    order by\n      starttime\n  ) as vasonum,\n  starttime,\n  endtime,\n  DATETIME_DIFF(endtime, starttime, 'HOUR') AS duration_hours -- add durations\nfrom\n  vasocv\nUNION\nALL\nselect\n  icustay_id,\n  ROW_NUMBER() over (\n    partition by icustay_id\n    order by\n      starttime\n  ) as vasonum,\n  starttime,\n  endtime,\n  DATETIME_DIFF(endtime, starttime, 'HOUR') AS duration_hours -- add durations\nfrom\n  vasomv\norder by\n  icustay_id,\n  vasonum",
        "tables": [
            "mimiciii_clinical.inputevents_cv",
            "mimiciii_clinical.inputevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "vasonum": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "starttime": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "endtime": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "duration_hours": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ]
        },
        "table_name": "mimiciii_clinical.dobutamine_durations",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "vasocv.icustay_id",
                "(row_number() OVER (?))",
                "vasocv.starttime",
                "vasocv.endtime",
                "(datetime_diff(vasocv.endtime, vasocv.starttime, 'HOUR'::text))"
            ],
            "Sort Key": [
                "vasocv.icustay_id",
                "(row_number() OVER (?))"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv1",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30042,30306}'::integer[])) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = ANY ('{30042,30306}'::integer[])) AND (((inputevents_cv.stopped)::text = 'Stopped'::text) OR ((inputevents_cv.stopped)::text ~~ 'D/C%'::text))) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = ANY ('{30042,30306}'::integer[])) AND (inputevents_cv.rate IS NOT NULL)) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30042,30306}'::integer[])) THEN inputevents_cv.rate ELSE NULL::double precision END)",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30042,30306}'::integer[])) THEN inputevents_cv.amount ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime",
                                "inputevents_cv.itemid",
                                "inputevents_cv.stopped",
                                "inputevents_cv.rate",
                                "inputevents_cv.amount"
                            ],
                            "Sort Key": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "inputevents_cv",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "inputevents_cv",
                                    "Output": [
                                        "inputevents_cv.icustay_id",
                                        "inputevents_cv.charttime",
                                        "inputevents_cv.itemid",
                                        "inputevents_cv.stopped",
                                        "inputevents_cv.rate",
                                        "inputevents_cv.amount"
                                    ],
                                    "Recheck Cond": "(inputevents_cv.itemid = ANY ('{30042,30306}'::integer[]))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "inputevents_cv_idx05",
                                            "Index Cond": "(inputevents_cv.itemid = ANY ('{30042,30306}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv2",
                    "Parallel Aware": false,
                    "Output": [
                        "v.icustay_id",
                        "v.charttime",
                        "v.vaso",
                        "v.vaso_stopped",
                        "v.vaso_null",
                        "v.vaso_rate",
                        "v.vaso_amount",
                        "sum(v.vaso_null) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v.icustay_id",
                                "v.charttime",
                                "v.vaso",
                                "v.vaso_stopped",
                                "v.vaso_null",
                                "v.vaso_rate",
                                "v.vaso_amount"
                            ],
                            "Sort Key": [
                                "v.icustay_id",
                                "v.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv1",
                                    "Alias": "v",
                                    "Output": [
                                        "v.icustay_id",
                                        "v.charttime",
                                        "v.vaso",
                                        "v.vaso_stopped",
                                        "v.vaso_null",
                                        "v.vaso_rate",
                                        "v.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv3",
                    "Parallel Aware": false,
                    "Output": [
                        "v_1.icustay_id",
                        "v_1.charttime",
                        "v_1.vaso",
                        "v_1.vaso_stopped",
                        "v_1.vaso_null",
                        "v_1.vaso_rate",
                        "v_1.vaso_amount",
                        "v_1.vaso_partition",
                        "first_value(v_1.vaso_rate) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_1.icustay_id",
                                "v_1.charttime",
                                "v_1.vaso_partition",
                                "v_1.vaso",
                                "v_1.vaso_stopped",
                                "v_1.vaso_null",
                                "v_1.vaso_rate",
                                "v_1.vaso_amount"
                            ],
                            "Sort Key": [
                                "v_1.icustay_id",
                                "v_1.vaso_partition",
                                "v_1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv2",
                                    "Alias": "v_1",
                                    "Output": [
                                        "v_1.icustay_id",
                                        "v_1.charttime",
                                        "v_1.vaso_partition",
                                        "v_1.vaso",
                                        "v_1.vaso_stopped",
                                        "v_1.vaso_null",
                                        "v_1.vaso_rate",
                                        "v_1.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv4",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv3.icustay_id",
                        "vasocv3.charttime",
                        "vasocv3.vaso",
                        "vasocv3.vaso_rate",
                        "vasocv3.vaso_amount",
                        "vasocv3.vaso_stopped",
                        "vasocv3.vaso_prevrate_ifnull",
                        "CASE WHEN (vasocv3.vaso = 0) THEN NULL::integer WHEN ((vasocv3.vaso_rate > '0'::double precision) AND ((lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)) IS NULL)) THEN 1 WHEN ((vasocv3.vaso_rate = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN ((vasocv3.vaso_prevrate_ifnull = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision) THEN 1 WHEN (lag(vasocv3.vaso_stopped, 1) OVER (?) = 1) THEN 1 ELSE NULL::integer END",
                        "vasocv3.vaso_null"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv3.icustay_id",
                                "vasocv3.charttime",
                                "vasocv3.vaso",
                                "vasocv3.vaso_null",
                                "vasocv3.vaso_rate",
                                "vasocv3.vaso_amount",
                                "vasocv3.vaso_stopped",
                                "vasocv3.vaso_prevrate_ifnull",
                                "(lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?))"
                            ],
                            "Sort Key": [
                                "vasocv3.icustay_id",
                                "vasocv3.vaso",
                                "vasocv3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "WindowAgg",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv3.icustay_id",
                                        "vasocv3.charttime",
                                        "vasocv3.vaso",
                                        "vasocv3.vaso_null",
                                        "vasocv3.vaso_rate",
                                        "vasocv3.vaso_amount",
                                        "vasocv3.vaso_stopped",
                                        "vasocv3.vaso_prevrate_ifnull",
                                        "lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.charttime",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.vaso_rate",
                                                "vasocv3.vaso_amount",
                                                "vasocv3.vaso_stopped",
                                                "vasocv3.vaso_prevrate_ifnull"
                                            ],
                                            "Sort Key": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "vasocv3",
                                                    "Alias": "vasocv3",
                                                    "Output": [
                                                        "vasocv3.icustay_id",
                                                        "vasocv3.charttime",
                                                        "vasocv3.vaso",
                                                        "vasocv3.vaso_null",
                                                        "vasocv3.vaso_rate",
                                                        "vasocv3.vaso_amount",
                                                        "vasocv3.vaso_stopped",
                                                        "vasocv3.vaso_prevrate_ifnull"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv5",
                    "Parallel Aware": false,
                    "Output": [
                        "v_2.icustay_id",
                        "v_2.charttime",
                        "v_2.vaso",
                        "v_2.vaso_rate",
                        "v_2.vaso_amount",
                        "v_2.vaso_stopped",
                        "v_2.vaso_prevrate_ifnull",
                        "v_2.vaso_start",
                        "sum(v_2.vaso_start) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_2.icustay_id",
                                "v_2.charttime",
                                "v_2.vaso",
                                "v_2.vaso_rate",
                                "v_2.vaso_amount",
                                "v_2.vaso_stopped",
                                "v_2.vaso_prevrate_ifnull",
                                "v_2.vaso_start"
                            ],
                            "Sort Key": [
                                "v_2.icustay_id",
                                "v_2.vaso",
                                "v_2.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv4",
                                    "Alias": "v_2",
                                    "Output": [
                                        "v_2.icustay_id",
                                        "v_2.charttime",
                                        "v_2.vaso",
                                        "v_2.vaso_rate",
                                        "v_2.vaso_amount",
                                        "v_2.vaso_stopped",
                                        "v_2.vaso_prevrate_ifnull",
                                        "v_2.vaso_start"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv6",
                    "Parallel Aware": false,
                    "Output": [
                        "v_3.icustay_id",
                        "v_3.charttime",
                        "v_3.vaso",
                        "v_3.vaso_rate",
                        "v_3.vaso_amount",
                        "v_3.vaso_stopped",
                        "v_3.vaso_prevrate_ifnull",
                        "v_3.vaso_start",
                        "v_3.vaso_first",
                        "CASE WHEN (v_3.vaso = 0) THEN NULL::bigint WHEN (v_3.vaso_stopped = 1) THEN v_3.vaso_first WHEN (v_3.vaso_rate = '0'::double precision) THEN v_3.vaso_first WHEN (lead(v_3.charttime, 1) OVER (?) IS NULL) THEN v_3.vaso_first ELSE NULL::bigint END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_3.icustay_id",
                                "v_3.charttime",
                                "v_3.vaso",
                                "v_3.vaso_rate",
                                "v_3.vaso_amount",
                                "v_3.vaso_stopped",
                                "v_3.vaso_prevrate_ifnull",
                                "v_3.vaso_start",
                                "v_3.vaso_first"
                            ],
                            "Sort Key": [
                                "v_3.icustay_id",
                                "v_3.vaso",
                                "v_3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv5",
                                    "Alias": "v_3",
                                    "Output": [
                                        "v_3.icustay_id",
                                        "v_3.charttime",
                                        "v_3.vaso",
                                        "v_3.vaso_rate",
                                        "v_3.vaso_amount",
                                        "v_3.vaso_stopped",
                                        "v_3.vaso_prevrate_ifnull",
                                        "v_3.vaso_start",
                                        "v_3.vaso_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv6.icustay_id",
                        "min(CASE WHEN (vasocv6.vaso_rate IS NOT NULL) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)",
                        "min(CASE WHEN (vasocv6.vaso_first = vasocv6.vaso_stop) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)",
                        "vasocv6.vaso_first"
                    ],
                    "Group Key": [
                        "vasocv6.icustay_id",
                        "vasocv6.vaso_first"
                    ],
                    "Filter": "((min(vasocv6.charttime) <> min(CASE WHEN (vasocv6.vaso_first = vasocv6.vaso_stop) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)) AND (max(vasocv6.vaso_rate) > '0'::double precision))",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "vasocv6",
                            "Alias": "vasocv6",
                            "Output": [
                                "vasocv6.icustay_id",
                                "vasocv6.charttime",
                                "vasocv6.vaso",
                                "vasocv6.vaso_rate",
                                "vasocv6.vaso_amount",
                                "vasocv6.vaso_stopped",
                                "vasocv6.vaso_prevrate_ifnull",
                                "vasocv6.vaso_start",
                                "vasocv6.vaso_first",
                                "vasocv6.vaso_stop"
                            ],
                            "Filter": "((vasocv6.vaso_first IS NOT NULL) AND (vasocv6.icustay_id IS NOT NULL) AND (vasocv6.vaso_first <> 0))"
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasomv",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid",
                        "min(inputevents_mv.starttime)",
                        "max(inputevents_mv.endtime)"
                    ],
                    "Group Key": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Bitmap Heap Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "inputevents_mv",
                            "Schema": "mimiciii_clinical",
                            "Alias": "inputevents_mv",
                            "Output": [
                                "inputevents_mv.row_id",
                                "inputevents_mv.subject_id",
                                "inputevents_mv.hadm_id",
                                "inputevents_mv.icustay_id",
                                "inputevents_mv.starttime",
                                "inputevents_mv.endtime",
                                "inputevents_mv.itemid",
                                "inputevents_mv.amount",
                                "inputevents_mv.amountuom",
                                "inputevents_mv.rate",
                                "inputevents_mv.rateuom",
                                "inputevents_mv.storetime",
                                "inputevents_mv.cgid",
                                "inputevents_mv.orderid",
                                "inputevents_mv.linkorderid",
                                "inputevents_mv.ordercategoryname",
                                "inputevents_mv.secondaryordercategoryname",
                                "inputevents_mv.ordercomponenttypedescription",
                                "inputevents_mv.ordercategorydescription",
                                "inputevents_mv.patientweight",
                                "inputevents_mv.totalamount",
                                "inputevents_mv.totalamountuom",
                                "inputevents_mv.isopenbag",
                                "inputevents_mv.continueinnextdept",
                                "inputevents_mv.cancelreason",
                                "inputevents_mv.statusdescription",
                                "inputevents_mv.comments_editedby",
                                "inputevents_mv.comments_canceledby",
                                "inputevents_mv.comments_date",
                                "inputevents_mv.originalamount",
                                "inputevents_mv.originalrate"
                            ],
                            "Recheck Cond": "(inputevents_mv.itemid = 221653)",
                            "Filter": "((inputevents_mv.statusdescription)::text <> 'Rewritten'::text)",
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Index Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Index Name": "inputevents_mv_idx05",
                                    "Index Cond": "(inputevents_mv.itemid = 221653)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv.icustay_id",
                                "row_number() OVER (?)",
                                "vasocv.starttime",
                                "vasocv.endtime",
                                "datetime_diff(vasocv.endtime, vasocv.starttime, 'HOUR'::text)"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv.icustay_id",
                                        "vasocv.starttime",
                                        "vasocv.endtime"
                                    ],
                                    "Sort Key": [
                                        "vasocv.icustay_id",
                                        "vasocv.starttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "vasocv",
                                            "Alias": "vasocv",
                                            "Output": [
                                                "vasocv.icustay_id",
                                                "vasocv.starttime",
                                                "vasocv.endtime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "vasomv.icustay_id",
                                "row_number() OVER (?)",
                                "vasomv.starttime",
                                "vasomv.endtime",
                                "datetime_diff(vasomv.endtime, vasomv.starttime, 'HOUR'::text)"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasomv.icustay_id",
                                        "vasomv.starttime",
                                        "vasomv.endtime"
                                    ],
                                    "Sort Key": [
                                        "vasomv.icustay_id",
                                        "vasomv.starttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "vasomv",
                                            "Alias": "vasomv",
                                            "Output": [
                                                "vasomv.icustay_id",
                                                "vasomv.starttime",
                                                "vasomv.endtime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.dopamine_dose": {
        "sql": "-- This query extracts dose+durations of dopamine administration\n\n-- Get drug administration data from CareVue first\nwith vasocv1 as\n(\n  select\n    icustay_id, charttime\n    -- case statement determining whether the ITEMID is an instance of vasopressor usage\n    , max(case when itemid in (30043,30307) then 1 else 0 end) as vaso -- dopamine\n\n    -- the 'stopped' column indicates if a vasopressor has been disconnected\n    , max(case when itemid in (30043,30307) and (stopped = 'Stopped' OR stopped like 'D/C%') then 1\n          else 0 end) as vaso_stopped\n\n    , max(case when itemid in (30043,30307) and rate is not null then 1 else 0 end) as vaso_null\n    , max(case when itemid in (30043,30307) then rate else null end) as vaso_rate\n    , max(case when itemid in (30043,30307) then amount else null end) as vaso_amount\n\n  FROM inputevents_cv\n  where itemid in\n  (\n        30043,30307 -- dopamine\n  )\n  group by icustay_id, charttime\n)\n, vasocv2 as\n(\n  select v.*\n    , sum(vaso_null) over (partition by icustay_id order by charttime) as vaso_partition\n  from\n    vasocv1 v\n)\n, vasocv3 as\n(\n  select v.*\n    , first_value(vaso_rate) over (partition by icustay_id, vaso_partition order by charttime) as vaso_prevrate_ifnull\n  from\n    vasocv2 v\n)\n, vasocv4 as\n(\nselect\n    icustay_id\n    , charttime\n    -- , (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) AS delta\n\n    , vaso\n    , vaso_rate\n    , vaso_amount\n    , vaso_stopped\n    , vaso_prevrate_ifnull\n\n    -- We define start time here\n    , case\n        when vaso = 0 then null\n\n        -- if this is the first instance of the vasoactive drug\n        when vaso_rate > 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso, vaso_null\n          order by charttime\n          )\n          is null\n          then 1\n\n        -- you often get a string of 0s\n        -- we decide not to set these as 1, just because it makes vasonum sequential\n        when vaso_rate = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- sometimes you get a string of NULL, associated with 0 volumes\n        -- same reason as before, we decide not to set these as 1\n        -- vaso_prevrate_ifnull is equal to the previous value *iff* the current value is null\n        when vaso_prevrate_ifnull = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- If the last recorded rate was 0, newvaso = 1\n        when LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) = 0\n          then 1\n\n        -- If the last recorded vaso was D/C'd, newvaso = 1\n        when\n          LAG(vaso_stopped,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 1 then 1\n\n        -- ** not sure if the below is needed\n        --when (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) > (interval '4 hours') then 1\n      else null\n      end as vaso_start\n\nFROM\n  vasocv3\n)\n-- propagate start/stop flags forward in time\n, vasocv5 as\n(\n  select v.*\n    , SUM(vaso_start) OVER (partition by icustay_id, vaso order by charttime) as vaso_first\nFROM\n  vasocv4 v\n)\n, vasocv6 as\n(\n  select v.*\n    -- We define end time here\n    , case\n        when vaso = 0\n          then null\n\n        -- If the recorded vaso was D/C'd, this is an end time\n        when vaso_stopped = 1\n          then vaso_first\n\n        -- If the rate is zero, this is the end time\n        when vaso_rate = 0\n          then vaso_first\n\n        -- the last row in the table is always a potential end time\n        -- this captures patients who die/are discharged while on vasopressors\n        -- in principle, this could add an extra end time for the vasopressor\n        -- however, since we later group on vaso_start, any extra end times are ignored\n        when LEAD(CHARTTIME,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) is null\n          then vaso_first\n\n        else null\n        end as vaso_stop\n    from vasocv5 v\n)\n\n-- -- if you want to look at the results of the table before grouping:\n-- select\n--   icustay_id, charttime, vaso, vaso_rate, vaso_amount\n--     , vaso_stopped\n--     , vaso_start\n--     , vaso_first\n--     , vaso_stop\n-- from vasocv6 order by icustay_id, charttime\n\n, vasocv7 as\n(\nselect\n  icustay_id\n  , charttime as starttime\n  , lead(charttime) OVER (partition by icustay_id, vaso_first order by charttime) as endtime\n  , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\nfrom vasocv6\nwhere\n  vaso_first is not null -- bogus data\nand\n  vaso_first != 0 -- sometimes *only* a rate of 0 appears, i.e. the drug is never actually delivered\nand\n  icustay_id is not null -- there are data for \"floating\" admissions, we don't worry about these\n)\n-- table of start/stop times for event\n, vasocv8 as\n(\n  select\n    icustay_id\n    , starttime, endtime\n    , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\n  from vasocv7\n  where endtime is not null\n  and vaso_rate > 0\n  and starttime != endtime\n)\n-- collapse these start/stop times down if the rate doesn't change\n, vasocv9 as\n(\n  select\n    icustay_id\n    , starttime, endtime\n    , case\n        when LAG(endtime) OVER (partition by icustay_id order by starttime, endtime) = starttime\n        AND  LAG(vaso_rate) OVER (partition by icustay_id order by starttime, endtime) = vaso_rate\n        THEN 0\n      else 1\n    end as vaso_groups\n    , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\n  from vasocv8\n  where endtime is not null\n  and vaso_rate > 0\n  and starttime != endtime\n)\n, vasocv10 as\n(\n  select\n    icustay_id\n    , starttime, endtime\n    , vaso_groups\n    , SUM(vaso_groups) OVER (partition by icustay_id order by starttime, endtime) as vaso_groups_sum\n    , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\n  from vasocv9\n)\n, vasocv as\n(\n  select icustay_id\n  , min(starttime) as starttime\n  , max(endtime) as endtime\n  , vaso_groups_sum\n  , vaso_rate\n  , sum(vaso_amount) as vaso_amount\n  from vasocv10\n  group by icustay_id, vaso_groups_sum, vaso_rate\n)\n-- now we extract the associated data for metavision patients\n, vasomv as\n(\n  select\n    icustay_id, linkorderid\n    , rate as vaso_rate\n    , amount as vaso_amount\n    , starttime\n    , endtime\n  from inputevents_mv\n  where itemid = 221662 -- dopamine\n  and statusdescription != 'Rewritten' -- only valid orders\n)\n-- now assign this data to every hour of the patient's stay\n-- vaso_amount for carevue is not accurate\nSELECT icustay_id\n  , starttime, endtime\n  , vaso_rate, vaso_amount\nfrom vasocv\nUNION ALL\nSELECT icustay_id\n  , starttime, endtime\n  , vaso_rate, vaso_amount\nfrom vasomv\norder by icustay_id, starttime",
        "tables": [
            "mimiciii_clinical.inputevents_cv",
            "mimiciii_clinical.inputevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "starttime": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "endtime": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "vaso_rate": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "vaso_amount": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ]
        },
        "table_name": "mimiciii_clinical.dopamine_dose",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "vasocv.icustay_id",
                "vasocv.starttime",
                "vasocv.endtime",
                "vasocv.vaso_rate",
                "vasocv.vaso_amount"
            ],
            "Sort Key": [
                "vasocv.icustay_id",
                "vasocv.starttime"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv1",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30043,30307}'::integer[])) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = ANY ('{30043,30307}'::integer[])) AND (((inputevents_cv.stopped)::text = 'Stopped'::text) OR ((inputevents_cv.stopped)::text ~~ 'D/C%'::text))) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = ANY ('{30043,30307}'::integer[])) AND (inputevents_cv.rate IS NOT NULL)) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30043,30307}'::integer[])) THEN inputevents_cv.rate ELSE NULL::double precision END)",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30043,30307}'::integer[])) THEN inputevents_cv.amount ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime",
                                "inputevents_cv.itemid",
                                "inputevents_cv.stopped",
                                "inputevents_cv.rate",
                                "inputevents_cv.amount"
                            ],
                            "Sort Key": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "inputevents_cv",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "inputevents_cv",
                                    "Output": [
                                        "inputevents_cv.icustay_id",
                                        "inputevents_cv.charttime",
                                        "inputevents_cv.itemid",
                                        "inputevents_cv.stopped",
                                        "inputevents_cv.rate",
                                        "inputevents_cv.amount"
                                    ],
                                    "Recheck Cond": "(inputevents_cv.itemid = ANY ('{30043,30307}'::integer[]))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "inputevents_cv_idx05",
                                            "Index Cond": "(inputevents_cv.itemid = ANY ('{30043,30307}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv2",
                    "Parallel Aware": false,
                    "Output": [
                        "v.icustay_id",
                        "v.charttime",
                        "v.vaso",
                        "v.vaso_stopped",
                        "v.vaso_null",
                        "v.vaso_rate",
                        "v.vaso_amount",
                        "sum(v.vaso_null) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v.icustay_id",
                                "v.charttime",
                                "v.vaso",
                                "v.vaso_stopped",
                                "v.vaso_null",
                                "v.vaso_rate",
                                "v.vaso_amount"
                            ],
                            "Sort Key": [
                                "v.icustay_id",
                                "v.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv1",
                                    "Alias": "v",
                                    "Output": [
                                        "v.icustay_id",
                                        "v.charttime",
                                        "v.vaso",
                                        "v.vaso_stopped",
                                        "v.vaso_null",
                                        "v.vaso_rate",
                                        "v.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv3",
                    "Parallel Aware": false,
                    "Output": [
                        "v_1.icustay_id",
                        "v_1.charttime",
                        "v_1.vaso",
                        "v_1.vaso_stopped",
                        "v_1.vaso_null",
                        "v_1.vaso_rate",
                        "v_1.vaso_amount",
                        "v_1.vaso_partition",
                        "first_value(v_1.vaso_rate) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_1.icustay_id",
                                "v_1.charttime",
                                "v_1.vaso_partition",
                                "v_1.vaso",
                                "v_1.vaso_stopped",
                                "v_1.vaso_null",
                                "v_1.vaso_rate",
                                "v_1.vaso_amount"
                            ],
                            "Sort Key": [
                                "v_1.icustay_id",
                                "v_1.vaso_partition",
                                "v_1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv2",
                                    "Alias": "v_1",
                                    "Output": [
                                        "v_1.icustay_id",
                                        "v_1.charttime",
                                        "v_1.vaso_partition",
                                        "v_1.vaso",
                                        "v_1.vaso_stopped",
                                        "v_1.vaso_null",
                                        "v_1.vaso_rate",
                                        "v_1.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv4",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv3.icustay_id",
                        "vasocv3.charttime",
                        "vasocv3.vaso",
                        "vasocv3.vaso_rate",
                        "vasocv3.vaso_amount",
                        "vasocv3.vaso_stopped",
                        "vasocv3.vaso_prevrate_ifnull",
                        "CASE WHEN (vasocv3.vaso = 0) THEN NULL::integer WHEN ((vasocv3.vaso_rate > '0'::double precision) AND ((lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)) IS NULL)) THEN 1 WHEN ((vasocv3.vaso_rate = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN ((vasocv3.vaso_prevrate_ifnull = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision) THEN 1 WHEN (lag(vasocv3.vaso_stopped, 1) OVER (?) = 1) THEN 1 ELSE NULL::integer END",
                        "vasocv3.vaso_null"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv3.icustay_id",
                                "vasocv3.charttime",
                                "vasocv3.vaso",
                                "vasocv3.vaso_null",
                                "vasocv3.vaso_rate",
                                "vasocv3.vaso_amount",
                                "vasocv3.vaso_stopped",
                                "vasocv3.vaso_prevrate_ifnull",
                                "(lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?))"
                            ],
                            "Sort Key": [
                                "vasocv3.icustay_id",
                                "vasocv3.vaso",
                                "vasocv3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "WindowAgg",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv3.icustay_id",
                                        "vasocv3.charttime",
                                        "vasocv3.vaso",
                                        "vasocv3.vaso_null",
                                        "vasocv3.vaso_rate",
                                        "vasocv3.vaso_amount",
                                        "vasocv3.vaso_stopped",
                                        "vasocv3.vaso_prevrate_ifnull",
                                        "lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.charttime",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.vaso_rate",
                                                "vasocv3.vaso_amount",
                                                "vasocv3.vaso_stopped",
                                                "vasocv3.vaso_prevrate_ifnull"
                                            ],
                                            "Sort Key": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "vasocv3",
                                                    "Alias": "vasocv3",
                                                    "Output": [
                                                        "vasocv3.icustay_id",
                                                        "vasocv3.charttime",
                                                        "vasocv3.vaso",
                                                        "vasocv3.vaso_null",
                                                        "vasocv3.vaso_rate",
                                                        "vasocv3.vaso_amount",
                                                        "vasocv3.vaso_stopped",
                                                        "vasocv3.vaso_prevrate_ifnull"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv5",
                    "Parallel Aware": false,
                    "Output": [
                        "v_2.icustay_id",
                        "v_2.charttime",
                        "v_2.vaso",
                        "v_2.vaso_rate",
                        "v_2.vaso_amount",
                        "v_2.vaso_stopped",
                        "v_2.vaso_prevrate_ifnull",
                        "v_2.vaso_start",
                        "sum(v_2.vaso_start) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_2.icustay_id",
                                "v_2.charttime",
                                "v_2.vaso",
                                "v_2.vaso_rate",
                                "v_2.vaso_amount",
                                "v_2.vaso_stopped",
                                "v_2.vaso_prevrate_ifnull",
                                "v_2.vaso_start"
                            ],
                            "Sort Key": [
                                "v_2.icustay_id",
                                "v_2.vaso",
                                "v_2.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv4",
                                    "Alias": "v_2",
                                    "Output": [
                                        "v_2.icustay_id",
                                        "v_2.charttime",
                                        "v_2.vaso",
                                        "v_2.vaso_rate",
                                        "v_2.vaso_amount",
                                        "v_2.vaso_stopped",
                                        "v_2.vaso_prevrate_ifnull",
                                        "v_2.vaso_start"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv6",
                    "Parallel Aware": false,
                    "Output": [
                        "v_3.icustay_id",
                        "v_3.charttime",
                        "v_3.vaso",
                        "v_3.vaso_rate",
                        "v_3.vaso_amount",
                        "v_3.vaso_stopped",
                        "v_3.vaso_prevrate_ifnull",
                        "v_3.vaso_start",
                        "v_3.vaso_first",
                        "CASE WHEN (v_3.vaso = 0) THEN NULL::bigint WHEN (v_3.vaso_stopped = 1) THEN v_3.vaso_first WHEN (v_3.vaso_rate = '0'::double precision) THEN v_3.vaso_first WHEN (lead(v_3.charttime, 1) OVER (?) IS NULL) THEN v_3.vaso_first ELSE NULL::bigint END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_3.icustay_id",
                                "v_3.charttime",
                                "v_3.vaso",
                                "v_3.vaso_rate",
                                "v_3.vaso_amount",
                                "v_3.vaso_stopped",
                                "v_3.vaso_prevrate_ifnull",
                                "v_3.vaso_start",
                                "v_3.vaso_first"
                            ],
                            "Sort Key": [
                                "v_3.icustay_id",
                                "v_3.vaso",
                                "v_3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv5",
                                    "Alias": "v_3",
                                    "Output": [
                                        "v_3.icustay_id",
                                        "v_3.charttime",
                                        "v_3.vaso",
                                        "v_3.vaso_rate",
                                        "v_3.vaso_amount",
                                        "v_3.vaso_stopped",
                                        "v_3.vaso_prevrate_ifnull",
                                        "v_3.vaso_start",
                                        "v_3.vaso_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv7",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv6.icustay_id",
                        "vasocv6.charttime",
                        "lead(vasocv6.charttime) OVER (?)",
                        "vasocv6.vaso",
                        "vasocv6.vaso_rate",
                        "vasocv6.vaso_amount",
                        "vasocv6.vaso_stop",
                        "vasocv6.vaso_start",
                        "vasocv6.vaso_first"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv6.icustay_id",
                                "vasocv6.charttime",
                                "vasocv6.vaso_first",
                                "vasocv6.vaso",
                                "vasocv6.vaso_rate",
                                "vasocv6.vaso_amount",
                                "vasocv6.vaso_stop",
                                "vasocv6.vaso_start"
                            ],
                            "Sort Key": [
                                "vasocv6.icustay_id",
                                "vasocv6.vaso_first",
                                "vasocv6.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv6",
                                    "Alias": "vasocv6",
                                    "Output": [
                                        "vasocv6.icustay_id",
                                        "vasocv6.charttime",
                                        "vasocv6.vaso_first",
                                        "vasocv6.vaso",
                                        "vasocv6.vaso_rate",
                                        "vasocv6.vaso_amount",
                                        "vasocv6.vaso_stop",
                                        "vasocv6.vaso_start"
                                    ],
                                    "Filter": "((vasocv6.vaso_first IS NOT NULL) AND (vasocv6.icustay_id IS NOT NULL) AND (vasocv6.vaso_first <> 0))"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv8",
                    "Parallel Aware": false,
                    "CTE Name": "vasocv7",
                    "Alias": "vasocv7",
                    "Output": [
                        "vasocv7.icustay_id",
                        "vasocv7.starttime",
                        "vasocv7.endtime",
                        "vasocv7.vaso",
                        "vasocv7.vaso_rate",
                        "vasocv7.vaso_amount",
                        "vasocv7.vaso_stop",
                        "vasocv7.vaso_start",
                        "vasocv7.vaso_first"
                    ],
                    "Filter": "((vasocv7.endtime IS NOT NULL) AND (vasocv7.vaso_rate > '0'::double precision) AND (vasocv7.starttime <> vasocv7.endtime))"
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv9",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv8.icustay_id",
                        "vasocv8.starttime",
                        "vasocv8.endtime",
                        "CASE WHEN ((lag(vasocv8.endtime) OVER (?) = vasocv8.starttime) AND (lag(vasocv8.vaso_rate) OVER (?) = vasocv8.vaso_rate)) THEN 0 ELSE 1 END",
                        "vasocv8.vaso",
                        "vasocv8.vaso_rate",
                        "vasocv8.vaso_amount",
                        "vasocv8.vaso_stop",
                        "vasocv8.vaso_start",
                        "vasocv8.vaso_first"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv8.icustay_id",
                                "vasocv8.starttime",
                                "vasocv8.endtime",
                                "vasocv8.vaso_rate",
                                "vasocv8.vaso",
                                "vasocv8.vaso_amount",
                                "vasocv8.vaso_stop",
                                "vasocv8.vaso_start",
                                "vasocv8.vaso_first"
                            ],
                            "Sort Key": [
                                "vasocv8.icustay_id",
                                "vasocv8.starttime",
                                "vasocv8.endtime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv8",
                                    "Alias": "vasocv8",
                                    "Output": [
                                        "vasocv8.icustay_id",
                                        "vasocv8.starttime",
                                        "vasocv8.endtime",
                                        "vasocv8.vaso_rate",
                                        "vasocv8.vaso",
                                        "vasocv8.vaso_amount",
                                        "vasocv8.vaso_stop",
                                        "vasocv8.vaso_start",
                                        "vasocv8.vaso_first"
                                    ],
                                    "Filter": "((vasocv8.endtime IS NOT NULL) AND (vasocv8.vaso_rate > '0'::double precision) AND (vasocv8.starttime <> vasocv8.endtime))"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv10",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv9.icustay_id",
                        "vasocv9.starttime",
                        "vasocv9.endtime",
                        "vasocv9.vaso_groups",
                        "sum(vasocv9.vaso_groups) OVER (?)",
                        "vasocv9.vaso",
                        "vasocv9.vaso_rate",
                        "vasocv9.vaso_amount",
                        "vasocv9.vaso_stop",
                        "vasocv9.vaso_start",
                        "vasocv9.vaso_first"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv9.icustay_id",
                                "vasocv9.starttime",
                                "vasocv9.endtime",
                                "vasocv9.vaso_groups",
                                "vasocv9.vaso",
                                "vasocv9.vaso_rate",
                                "vasocv9.vaso_amount",
                                "vasocv9.vaso_stop",
                                "vasocv9.vaso_start",
                                "vasocv9.vaso_first"
                            ],
                            "Sort Key": [
                                "vasocv9.icustay_id",
                                "vasocv9.starttime",
                                "vasocv9.endtime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv9",
                                    "Alias": "vasocv9",
                                    "Output": [
                                        "vasocv9.icustay_id",
                                        "vasocv9.starttime",
                                        "vasocv9.endtime",
                                        "vasocv9.vaso_groups",
                                        "vasocv9.vaso",
                                        "vasocv9.vaso_rate",
                                        "vasocv9.vaso_amount",
                                        "vasocv9.vaso_stop",
                                        "vasocv9.vaso_start",
                                        "vasocv9.vaso_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv10.icustay_id",
                        "min(vasocv10.starttime)",
                        "max(vasocv10.endtime)",
                        "vasocv10.vaso_groups_sum",
                        "vasocv10.vaso_rate",
                        "sum(vasocv10.vaso_amount)"
                    ],
                    "Group Key": [
                        "vasocv10.icustay_id",
                        "vasocv10.vaso_groups_sum",
                        "vasocv10.vaso_rate"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "vasocv10",
                            "Alias": "vasocv10",
                            "Output": [
                                "vasocv10.icustay_id",
                                "vasocv10.starttime",
                                "vasocv10.endtime",
                                "vasocv10.vaso_groups",
                                "vasocv10.vaso_groups_sum",
                                "vasocv10.vaso",
                                "vasocv10.vaso_rate",
                                "vasocv10.vaso_amount",
                                "vasocv10.vaso_stop",
                                "vasocv10.vaso_start",
                                "vasocv10.vaso_first"
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Bitmap Heap Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasomv",
                    "Parallel Aware": false,
                    "Relation Name": "inputevents_mv",
                    "Schema": "mimiciii_clinical",
                    "Alias": "inputevents_mv",
                    "Output": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid",
                        "inputevents_mv.rate",
                        "inputevents_mv.amount",
                        "inputevents_mv.starttime",
                        "inputevents_mv.endtime"
                    ],
                    "Recheck Cond": "(inputevents_mv.itemid = 221662)",
                    "Filter": "((inputevents_mv.statusdescription)::text <> 'Rewritten'::text)",
                    "Plans": [
                        {
                            "Node Type": "Bitmap Index Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Index Name": "inputevents_mv_idx05",
                            "Index Cond": "(inputevents_mv.itemid = 221662)"
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "vasocv",
                            "Alias": "vasocv",
                            "Output": [
                                "vasocv.icustay_id",
                                "vasocv.starttime",
                                "vasocv.endtime",
                                "vasocv.vaso_rate",
                                "vasocv.vaso_amount"
                            ]
                        },
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "vasomv",
                            "Alias": "vasomv",
                            "Output": [
                                "vasomv.icustay_id",
                                "vasomv.starttime",
                                "vasomv.endtime",
                                "vasomv.vaso_rate",
                                "vasomv.vaso_amount"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.dopamine_durations": {
        "sql": "-- This query extracts durations of dopamine administration\n-- Consecutive administrations are numbered 1, 2, ...\n-- Total time on the drug can be calculated from this table by grouping using ICUSTAY_ID\n\n-- Get drug administration data from CareVue first\nwith vasocv1 as\n(\n  select\n    icustay_id, charttime\n    -- case statement determining whether the ITEMID is an instance of vasopressor usage\n    , max(case when itemid in (30043,30307) then 1 else 0 end) as vaso -- dopamine\n\n    -- the 'stopped' column indicates if a vasopressor has been disconnected\n    , max(case when itemid in (30043,30307) and (stopped = 'Stopped' OR stopped like 'D/C%') then 1\n          else 0 end) as vaso_stopped\n\n    , max(case when itemid in (30043,30307) and rate is not null then 1 else 0 end) as vaso_null\n    , max(case when itemid in (30043,30307) then rate else null end) as vaso_rate\n    , max(case when itemid in (30043,30307) then amount else null end) as vaso_amount\n\n  FROM inputevents_cv\n  where itemid in\n  (\n        30043,30307 -- dopamine\n  )\n  group by icustay_id, charttime\n)\n, vasocv2 as\n(\n  select v.*\n    , sum(vaso_null) over (partition by icustay_id order by charttime) as vaso_partition\n  from\n    vasocv1 v\n)\n, vasocv3 as\n(\n  select v.*\n    , first_value(vaso_rate) over (partition by icustay_id, vaso_partition order by charttime) as vaso_prevrate_ifnull\n  from\n    vasocv2 v\n)\n, vasocv4 as\n(\nselect\n    icustay_id\n    , charttime\n    -- , (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) AS delta\n\n    , vaso\n    , vaso_rate\n    , vaso_amount\n    , vaso_stopped\n    , vaso_prevrate_ifnull\n\n    -- We define start time here\n    , case\n        when vaso = 0 then null\n\n        -- if this is the first instance of the vasoactive drug\n        when vaso_rate > 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso, vaso_null\n          order by charttime\n          )\n          is null\n          then 1\n\n        -- you often get a string of 0s\n        -- we decide not to set these as 1, just because it makes vasonum sequential\n        when vaso_rate = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- sometimes you get a string of NULL, associated with 0 volumes\n        -- same reason as before, we decide not to set these as 1\n        -- vaso_prevrate_ifnull is equal to the previous value *iff* the current value is null\n        when vaso_prevrate_ifnull = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- If the last recorded rate was 0, newvaso = 1\n        when LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) = 0\n          then 1\n\n        -- If the last recorded vaso was D/C'd, newvaso = 1\n        when\n          LAG(vaso_stopped,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 1 then 1\n\n        -- ** not sure if the below is needed\n        --when (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) > (interval '4 hours') then 1\n      else null\n      end as vaso_start\n\nFROM\n  vasocv3\n)\n-- propagate start/stop flags forward in time\n, vasocv5 as\n(\n  select v.*\n    , SUM(vaso_start) OVER (partition by icustay_id, vaso order by charttime) as vaso_first\nFROM\n  vasocv4 v\n)\n, vasocv6 as\n(\n  select v.*\n    -- We define end time here\n    , case\n        when vaso = 0\n          then null\n\n        -- If the recorded vaso was D/C'd, this is an end time\n        when vaso_stopped = 1\n          then vaso_first\n\n        -- If the rate is zero, this is the end time\n        when vaso_rate = 0\n          then vaso_first\n\n        -- the last row in the table is always a potential end time\n        -- this captures patients who die/are discharged while on vasopressors\n        -- in principle, this could add an extra end time for the vasopressor\n        -- however, since we later group on vaso_start, any extra end times are ignored\n        when LEAD(CHARTTIME,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) is null\n          then vaso_first\n\n        else null\n        end as vaso_stop\n    from vasocv5 v\n)\n\n-- -- if you want to look at the results of the table before grouping:\n-- select\n--   icustay_id, charttime, vaso, vaso_rate, vaso_amount\n--     , case when vaso_stopped = 1 then 'Y' else '' end as stopped\n--     , vaso_start\n--     , vaso_first\n--     , vaso_stop\n-- from vasocv6 order by charttime\n\n\n, vasocv as\n(\n-- below groups together vasopressor administrations into groups\nselect\n  icustay_id\n  -- the first non-null rate is considered the starttime\n  , min(case when vaso_rate is not null then charttime else null end) as starttime\n  -- the *first* time the first/last flags agree is the stop time for this duration\n  , min(case when vaso_first = vaso_stop then charttime else null end) as endtime\nfrom vasocv6\nwhere\n  vaso_first is not null -- bogus data\nand\n  vaso_first != 0 -- sometimes *only* a rate of 0 appears, i.e. the drug is never actually delivered\nand\n  icustay_id is not null -- there are data for \"floating\" admissions, we don't worry about these\ngroup by icustay_id, vaso_first\nhaving -- ensure start time is not the same as end time\n min(charttime) != min(case when vaso_first = vaso_stop then charttime else null end)\nand\n  max(vaso_rate) > 0 -- if the rate was always 0 or null, we consider it not a real drug delivery\n)\n\n-- now we extract the associated data for metavision patients\n, vasomv as\n(\n  select\n    icustay_id, linkorderid\n    , min(starttime) as starttime, max(endtime) as endtime\n  FROM inputevents_mv\n  where itemid = 221662 -- dopamine\n  and statusdescription != 'Rewritten' -- only valid orders\n  group by icustay_id, linkorderid\n)\n\nselect\n  icustay_id\n  -- generate a sequential integer for convenience\n  , ROW_NUMBER() over (partition by icustay_id order by starttime) as vasonum\n  , starttime, endtime\n  , DATETIME_DIFF(endtime, starttime, 'HOUR') AS duration_hours\n  -- add durations\nfrom\n  vasocv\n\nUNION ALL\n\nselect\n  icustay_id\n  , ROW_NUMBER() over (partition by icustay_id order by starttime) as vasonum\n  , starttime, endtime\n  , DATETIME_DIFF(endtime, starttime, 'HOUR') AS duration_hours\n  -- add durations\nfrom\n  vasomv\n\norder by icustay_id, vasonum",
        "tables": [
            "mimiciii_clinical.inputevents_cv",
            "mimiciii_clinical.inputevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "vasonum": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "starttime": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "endtime": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "duration_hours": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ]
        },
        "table_name": "mimiciii_clinical.dopamine_durations",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "vasocv.icustay_id",
                "(row_number() OVER (?))",
                "vasocv.starttime",
                "vasocv.endtime",
                "(datetime_diff(vasocv.endtime, vasocv.starttime, 'HOUR'::text))"
            ],
            "Sort Key": [
                "vasocv.icustay_id",
                "(row_number() OVER (?))"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv1",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30043,30307}'::integer[])) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = ANY ('{30043,30307}'::integer[])) AND (((inputevents_cv.stopped)::text = 'Stopped'::text) OR ((inputevents_cv.stopped)::text ~~ 'D/C%'::text))) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = ANY ('{30043,30307}'::integer[])) AND (inputevents_cv.rate IS NOT NULL)) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30043,30307}'::integer[])) THEN inputevents_cv.rate ELSE NULL::double precision END)",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30043,30307}'::integer[])) THEN inputevents_cv.amount ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime",
                                "inputevents_cv.itemid",
                                "inputevents_cv.stopped",
                                "inputevents_cv.rate",
                                "inputevents_cv.amount"
                            ],
                            "Sort Key": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "inputevents_cv",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "inputevents_cv",
                                    "Output": [
                                        "inputevents_cv.icustay_id",
                                        "inputevents_cv.charttime",
                                        "inputevents_cv.itemid",
                                        "inputevents_cv.stopped",
                                        "inputevents_cv.rate",
                                        "inputevents_cv.amount"
                                    ],
                                    "Recheck Cond": "(inputevents_cv.itemid = ANY ('{30043,30307}'::integer[]))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "inputevents_cv_idx05",
                                            "Index Cond": "(inputevents_cv.itemid = ANY ('{30043,30307}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv2",
                    "Parallel Aware": false,
                    "Output": [
                        "v.icustay_id",
                        "v.charttime",
                        "v.vaso",
                        "v.vaso_stopped",
                        "v.vaso_null",
                        "v.vaso_rate",
                        "v.vaso_amount",
                        "sum(v.vaso_null) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v.icustay_id",
                                "v.charttime",
                                "v.vaso",
                                "v.vaso_stopped",
                                "v.vaso_null",
                                "v.vaso_rate",
                                "v.vaso_amount"
                            ],
                            "Sort Key": [
                                "v.icustay_id",
                                "v.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv1",
                                    "Alias": "v",
                                    "Output": [
                                        "v.icustay_id",
                                        "v.charttime",
                                        "v.vaso",
                                        "v.vaso_stopped",
                                        "v.vaso_null",
                                        "v.vaso_rate",
                                        "v.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv3",
                    "Parallel Aware": false,
                    "Output": [
                        "v_1.icustay_id",
                        "v_1.charttime",
                        "v_1.vaso",
                        "v_1.vaso_stopped",
                        "v_1.vaso_null",
                        "v_1.vaso_rate",
                        "v_1.vaso_amount",
                        "v_1.vaso_partition",
                        "first_value(v_1.vaso_rate) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_1.icustay_id",
                                "v_1.charttime",
                                "v_1.vaso_partition",
                                "v_1.vaso",
                                "v_1.vaso_stopped",
                                "v_1.vaso_null",
                                "v_1.vaso_rate",
                                "v_1.vaso_amount"
                            ],
                            "Sort Key": [
                                "v_1.icustay_id",
                                "v_1.vaso_partition",
                                "v_1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv2",
                                    "Alias": "v_1",
                                    "Output": [
                                        "v_1.icustay_id",
                                        "v_1.charttime",
                                        "v_1.vaso_partition",
                                        "v_1.vaso",
                                        "v_1.vaso_stopped",
                                        "v_1.vaso_null",
                                        "v_1.vaso_rate",
                                        "v_1.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv4",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv3.icustay_id",
                        "vasocv3.charttime",
                        "vasocv3.vaso",
                        "vasocv3.vaso_rate",
                        "vasocv3.vaso_amount",
                        "vasocv3.vaso_stopped",
                        "vasocv3.vaso_prevrate_ifnull",
                        "CASE WHEN (vasocv3.vaso = 0) THEN NULL::integer WHEN ((vasocv3.vaso_rate > '0'::double precision) AND ((lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)) IS NULL)) THEN 1 WHEN ((vasocv3.vaso_rate = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN ((vasocv3.vaso_prevrate_ifnull = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision) THEN 1 WHEN (lag(vasocv3.vaso_stopped, 1) OVER (?) = 1) THEN 1 ELSE NULL::integer END",
                        "vasocv3.vaso_null"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv3.icustay_id",
                                "vasocv3.charttime",
                                "vasocv3.vaso",
                                "vasocv3.vaso_null",
                                "vasocv3.vaso_rate",
                                "vasocv3.vaso_amount",
                                "vasocv3.vaso_stopped",
                                "vasocv3.vaso_prevrate_ifnull",
                                "(lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?))"
                            ],
                            "Sort Key": [
                                "vasocv3.icustay_id",
                                "vasocv3.vaso",
                                "vasocv3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "WindowAgg",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv3.icustay_id",
                                        "vasocv3.charttime",
                                        "vasocv3.vaso",
                                        "vasocv3.vaso_null",
                                        "vasocv3.vaso_rate",
                                        "vasocv3.vaso_amount",
                                        "vasocv3.vaso_stopped",
                                        "vasocv3.vaso_prevrate_ifnull",
                                        "lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.charttime",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.vaso_rate",
                                                "vasocv3.vaso_amount",
                                                "vasocv3.vaso_stopped",
                                                "vasocv3.vaso_prevrate_ifnull"
                                            ],
                                            "Sort Key": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "vasocv3",
                                                    "Alias": "vasocv3",
                                                    "Output": [
                                                        "vasocv3.icustay_id",
                                                        "vasocv3.charttime",
                                                        "vasocv3.vaso",
                                                        "vasocv3.vaso_null",
                                                        "vasocv3.vaso_rate",
                                                        "vasocv3.vaso_amount",
                                                        "vasocv3.vaso_stopped",
                                                        "vasocv3.vaso_prevrate_ifnull"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv5",
                    "Parallel Aware": false,
                    "Output": [
                        "v_2.icustay_id",
                        "v_2.charttime",
                        "v_2.vaso",
                        "v_2.vaso_rate",
                        "v_2.vaso_amount",
                        "v_2.vaso_stopped",
                        "v_2.vaso_prevrate_ifnull",
                        "v_2.vaso_start",
                        "sum(v_2.vaso_start) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_2.icustay_id",
                                "v_2.charttime",
                                "v_2.vaso",
                                "v_2.vaso_rate",
                                "v_2.vaso_amount",
                                "v_2.vaso_stopped",
                                "v_2.vaso_prevrate_ifnull",
                                "v_2.vaso_start"
                            ],
                            "Sort Key": [
                                "v_2.icustay_id",
                                "v_2.vaso",
                                "v_2.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv4",
                                    "Alias": "v_2",
                                    "Output": [
                                        "v_2.icustay_id",
                                        "v_2.charttime",
                                        "v_2.vaso",
                                        "v_2.vaso_rate",
                                        "v_2.vaso_amount",
                                        "v_2.vaso_stopped",
                                        "v_2.vaso_prevrate_ifnull",
                                        "v_2.vaso_start"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv6",
                    "Parallel Aware": false,
                    "Output": [
                        "v_3.icustay_id",
                        "v_3.charttime",
                        "v_3.vaso",
                        "v_3.vaso_rate",
                        "v_3.vaso_amount",
                        "v_3.vaso_stopped",
                        "v_3.vaso_prevrate_ifnull",
                        "v_3.vaso_start",
                        "v_3.vaso_first",
                        "CASE WHEN (v_3.vaso = 0) THEN NULL::bigint WHEN (v_3.vaso_stopped = 1) THEN v_3.vaso_first WHEN (v_3.vaso_rate = '0'::double precision) THEN v_3.vaso_first WHEN (lead(v_3.charttime, 1) OVER (?) IS NULL) THEN v_3.vaso_first ELSE NULL::bigint END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_3.icustay_id",
                                "v_3.charttime",
                                "v_3.vaso",
                                "v_3.vaso_rate",
                                "v_3.vaso_amount",
                                "v_3.vaso_stopped",
                                "v_3.vaso_prevrate_ifnull",
                                "v_3.vaso_start",
                                "v_3.vaso_first"
                            ],
                            "Sort Key": [
                                "v_3.icustay_id",
                                "v_3.vaso",
                                "v_3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv5",
                                    "Alias": "v_3",
                                    "Output": [
                                        "v_3.icustay_id",
                                        "v_3.charttime",
                                        "v_3.vaso",
                                        "v_3.vaso_rate",
                                        "v_3.vaso_amount",
                                        "v_3.vaso_stopped",
                                        "v_3.vaso_prevrate_ifnull",
                                        "v_3.vaso_start",
                                        "v_3.vaso_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv6.icustay_id",
                        "min(CASE WHEN (vasocv6.vaso_rate IS NOT NULL) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)",
                        "min(CASE WHEN (vasocv6.vaso_first = vasocv6.vaso_stop) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)",
                        "vasocv6.vaso_first"
                    ],
                    "Group Key": [
                        "vasocv6.icustay_id",
                        "vasocv6.vaso_first"
                    ],
                    "Filter": "((min(vasocv6.charttime) <> min(CASE WHEN (vasocv6.vaso_first = vasocv6.vaso_stop) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)) AND (max(vasocv6.vaso_rate) > '0'::double precision))",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "vasocv6",
                            "Alias": "vasocv6",
                            "Output": [
                                "vasocv6.icustay_id",
                                "vasocv6.charttime",
                                "vasocv6.vaso",
                                "vasocv6.vaso_rate",
                                "vasocv6.vaso_amount",
                                "vasocv6.vaso_stopped",
                                "vasocv6.vaso_prevrate_ifnull",
                                "vasocv6.vaso_start",
                                "vasocv6.vaso_first",
                                "vasocv6.vaso_stop"
                            ],
                            "Filter": "((vasocv6.vaso_first IS NOT NULL) AND (vasocv6.icustay_id IS NOT NULL) AND (vasocv6.vaso_first <> 0))"
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasomv",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid",
                        "min(inputevents_mv.starttime)",
                        "max(inputevents_mv.endtime)"
                    ],
                    "Group Key": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Bitmap Heap Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "inputevents_mv",
                            "Schema": "mimiciii_clinical",
                            "Alias": "inputevents_mv",
                            "Output": [
                                "inputevents_mv.row_id",
                                "inputevents_mv.subject_id",
                                "inputevents_mv.hadm_id",
                                "inputevents_mv.icustay_id",
                                "inputevents_mv.starttime",
                                "inputevents_mv.endtime",
                                "inputevents_mv.itemid",
                                "inputevents_mv.amount",
                                "inputevents_mv.amountuom",
                                "inputevents_mv.rate",
                                "inputevents_mv.rateuom",
                                "inputevents_mv.storetime",
                                "inputevents_mv.cgid",
                                "inputevents_mv.orderid",
                                "inputevents_mv.linkorderid",
                                "inputevents_mv.ordercategoryname",
                                "inputevents_mv.secondaryordercategoryname",
                                "inputevents_mv.ordercomponenttypedescription",
                                "inputevents_mv.ordercategorydescription",
                                "inputevents_mv.patientweight",
                                "inputevents_mv.totalamount",
                                "inputevents_mv.totalamountuom",
                                "inputevents_mv.isopenbag",
                                "inputevents_mv.continueinnextdept",
                                "inputevents_mv.cancelreason",
                                "inputevents_mv.statusdescription",
                                "inputevents_mv.comments_editedby",
                                "inputevents_mv.comments_canceledby",
                                "inputevents_mv.comments_date",
                                "inputevents_mv.originalamount",
                                "inputevents_mv.originalrate"
                            ],
                            "Recheck Cond": "(inputevents_mv.itemid = 221662)",
                            "Filter": "((inputevents_mv.statusdescription)::text <> 'Rewritten'::text)",
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Index Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Index Name": "inputevents_mv_idx05",
                                    "Index Cond": "(inputevents_mv.itemid = 221662)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv.icustay_id",
                                "row_number() OVER (?)",
                                "vasocv.starttime",
                                "vasocv.endtime",
                                "datetime_diff(vasocv.endtime, vasocv.starttime, 'HOUR'::text)"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv.icustay_id",
                                        "vasocv.starttime",
                                        "vasocv.endtime"
                                    ],
                                    "Sort Key": [
                                        "vasocv.icustay_id",
                                        "vasocv.starttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "vasocv",
                                            "Alias": "vasocv",
                                            "Output": [
                                                "vasocv.icustay_id",
                                                "vasocv.starttime",
                                                "vasocv.endtime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "vasomv.icustay_id",
                                "row_number() OVER (?)",
                                "vasomv.starttime",
                                "vasomv.endtime",
                                "datetime_diff(vasomv.endtime, vasomv.starttime, 'HOUR'::text)"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasomv.icustay_id",
                                        "vasomv.starttime",
                                        "vasomv.endtime"
                                    ],
                                    "Sort Key": [
                                        "vasomv.icustay_id",
                                        "vasomv.starttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "vasomv",
                                            "Alias": "vasomv",
                                            "Output": [
                                                "vasomv.icustay_id",
                                                "vasomv.starttime",
                                                "vasomv.endtime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.epinephrine_dose": {
        "sql": "-- This query extracts dose+durations of epinephrine administration\n\n-- Requires the weightfirstday table\n\n-- Get drug administration data from CareVue first\nwith vasocv1 as\n(\n  select\n    cv.icustay_id, cv.charttime\n    -- case statement determining whether the ITEMID is an instance of vasopressor usage\n    , max(case when itemid in (30044,30119,30309) then 1 else 0 end) as vaso -- epinephrine\n\n    -- the 'stopped' column indicates if a vasopressor has been disconnected\n    , max(case when itemid in (30044,30119,30309) and (stopped = 'Stopped' OR stopped like 'D/C%') then 1\n          else 0 end) as vaso_stopped\n\n    , max(case when itemid in (30044,30119,30309) and rate is not null then 1 else 0 end) as vaso_null\n    , max(case\n            when itemid = 30044 and wd.weight is null then rate / 80.0 -- super rare to be missing weight... affects 2 patients for 14 rows\n            when itemid = 30044 then rate / wd.weight -- measured in mcgmin\n            when itemid in (30119,30309) then rate -- measured in mcgkgmin\n            else null\n          end) as vaso_rate\n    , max(case when itemid in (30044,30119,30309) then amount else null end) as vaso_amount\n\n  FROM inputevents_cv cv\n  left join \"mimic\".\"mimiciii_clinical\".\"weight_durations\" wd\n    on cv.icustay_id = wd.icustay_id\n    and cv.charttime between wd.starttime and wd.endtime\n  where itemid in\n  (\n        30044,30119,30309 -- epinephrine\n  )\n  and cv.icustay_id is not null\n  group by cv.icustay_id, charttime\n)\n, vasocv2 as\n(\n  select v.*\n    , sum(vaso_null) over (partition by icustay_id order by charttime) as vaso_partition\n  from\n    vasocv1 v\n)\n, vasocv3 as\n(\n  select v.*\n    , first_value(vaso_rate) over (partition by icustay_id, vaso_partition order by charttime) as vaso_prevrate_ifnull\n  from\n    vasocv2 v\n)\n, vasocv4 as\n(\nselect\n    icustay_id\n    , charttime\n    -- , (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) AS delta\n\n    , vaso\n    , vaso_rate\n    , vaso_amount\n    , vaso_stopped\n    , vaso_prevrate_ifnull\n\n    -- We define start time here\n    , case\n        when vaso = 0 then null\n\n        -- if this is the first instance of the vasoactive drug\n        when vaso_rate > 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso, vaso_null\n          order by charttime\n          )\n          is null\n          then 1\n\n        -- you often get a string of 0s\n        -- we decide not to set these as 1, just because it makes vasonum sequential\n        when vaso_rate = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- sometimes you get a string of NULL, associated with 0 volumes\n        -- same reason as before, we decide not to set these as 1\n        -- vaso_prevrate_ifnull is equal to the previous value *iff* the current value is null\n        when vaso_prevrate_ifnull = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- If the last recorded rate was 0, newvaso = 1\n        when LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) = 0\n          then 1\n\n        -- If the last recorded vaso was D/C'd, newvaso = 1\n        when\n          LAG(vaso_stopped,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 1 then 1\n\n        -- ** not sure if the below is needed\n        --when (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) > (interval '4 hours') then 1\n      else null\n      end as vaso_start\n\nFROM\n  vasocv3\n)\n-- propagate start/stop flags forward in time\n, vasocv5 as\n(\n  select v.*\n    , SUM(vaso_start) OVER (partition by icustay_id, vaso order by charttime) as vaso_first\nFROM\n  vasocv4 v\n)\n, vasocv6 as\n(\n  select v.*\n    -- We define end time here\n    , case\n        when vaso = 0\n          then null\n\n        -- If the recorded vaso was D/C'd, this is an end time\n        when vaso_stopped = 1\n          then vaso_first\n\n        -- If the rate is zero, this is the end time\n        when vaso_rate = 0\n          then vaso_first\n\n        -- the last row in the table is always a potential end time\n        -- this captures patients who die/are discharged while on vasopressors\n        -- in principle, this could add an extra end time for the vasopressor\n        -- however, since we later group on vaso_start, any extra end times are ignored\n        when LEAD(CHARTTIME,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) is null\n          then vaso_first\n\n        else null\n        end as vaso_stop\n    from vasocv5 v\n)\n\n-- -- if you want to look at the results of the table before grouping:\n-- select\n--   icustay_id, charttime, vaso, vaso_rate, vaso_amount\n--     , vaso_stopped\n--     , vaso_start\n--     , vaso_first\n--     , vaso_stop\n-- from vasocv6 order by icustay_id, charttime\n\n, vasocv7 as\n(\nselect\n  icustay_id\n  , charttime as starttime\n  , lead(charttime) OVER (partition by icustay_id, vaso_first order by charttime) as endtime\n  , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\nfrom vasocv6\nwhere\n  vaso_first is not null -- bogus data\nand\n  vaso_first != 0 -- sometimes *only* a rate of 0 appears, i.e. the drug is never actually delivered\nand\n  icustay_id is not null -- there are data for \"floating\" admissions, we don't worry about these\n)\n-- table of start/stop times for event\n, vasocv8 as\n(\n  select\n    icustay_id\n    , starttime, endtime\n    , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\n  from vasocv7\n  where endtime is not null\n  and vaso_rate > 0\n  and starttime != endtime\n)\n-- collapse these start/stop times down if the rate doesn't change\n, vasocv9 as\n(\n  select\n    icustay_id\n    , starttime, endtime\n    , case\n        when LAG(endtime) OVER (partition by icustay_id order by starttime, endtime) = starttime\n        AND  LAG(vaso_rate) OVER (partition by icustay_id order by starttime, endtime) = vaso_rate\n        THEN 0\n      else 1\n    end as vaso_groups\n    , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\n  from vasocv8\n  where endtime is not null\n  and vaso_rate > 0\n  and starttime != endtime\n)\n, vasocv10 as\n(\n  select\n    icustay_id\n    , starttime, endtime\n    , vaso_groups\n    , SUM(vaso_groups) OVER (partition by icustay_id order by starttime, endtime) as vaso_groups_sum\n    , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\n  from vasocv9\n)\n, vasocv as\n(\n  select icustay_id\n  , min(starttime) as starttime\n  , max(endtime) as endtime\n  , vaso_groups_sum\n  , vaso_rate\n  , sum(vaso_amount) as vaso_amount\n  from vasocv10\n  group by icustay_id, vaso_groups_sum, vaso_rate\n)\n-- now we extract the associated data for metavision patients\n, vasomv as\n(\n  select\n    icustay_id, linkorderid\n    , rate as vaso_rate\n    , amount as vaso_amount\n    , starttime\n    , endtime\n  from inputevents_mv\n  where itemid = 221289 -- epinephrine\n  and statusdescription != 'Rewritten' -- only valid orders\n)\n-- now assign this data to every hour of the patient's stay\n-- vaso_amount for carevue is not accurate\nSELECT icustay_id\n  , starttime, endtime\n  , vaso_rate, vaso_amount\nfrom vasocv\nUNION ALL\nSELECT icustay_id\n  , starttime, endtime\n  , vaso_rate, vaso_amount\nfrom vasomv\norder by icustay_id, starttime",
        "tables": [
            "mimiciii_clinical.inputevents_cv",
            "mimiciii_clinical.inputevents_mv",
            "mimiciii_clinical.weight_durations"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.weight_durations.endtime",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime",
                "mimiciii_clinical.weight_durations.weight"
            ],
            "starttime": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.weight_durations.endtime",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime",
                "mimiciii_clinical.weight_durations.weight"
            ],
            "endtime": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.weight_durations.endtime",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime",
                "mimiciii_clinical.weight_durations.weight"
            ],
            "vaso_rate": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.weight_durations.endtime",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime",
                "mimiciii_clinical.weight_durations.weight"
            ],
            "vaso_amount": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.weight_durations.endtime",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime",
                "mimiciii_clinical.weight_durations.weight"
            ]
        },
        "table_name": "mimiciii_clinical.epinephrine_dose",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "vasocv.icustay_id",
                "vasocv.starttime",
                "vasocv.endtime",
                "vasocv.vaso_rate",
                "vasocv.vaso_amount"
            ],
            "Sort Key": [
                "vasocv.icustay_id",
                "vasocv.starttime"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Finalize",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv1",
                    "Parallel Aware": false,
                    "Output": [
                        "cv.icustay_id",
                        "cv.charttime",
                        "max(CASE WHEN (cv.itemid = ANY ('{30044,30119,30309}'::integer[])) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((cv.itemid = ANY ('{30044,30119,30309}'::integer[])) AND (((cv.stopped)::text = 'Stopped'::text) OR ((cv.stopped)::text ~~ 'D/C%'::text))) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((cv.itemid = ANY ('{30044,30119,30309}'::integer[])) AND (cv.rate IS NOT NULL)) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((cv.itemid = 30044) AND (wd.weight IS NULL)) THEN (cv.rate / '80'::double precision) WHEN (cv.itemid = 30044) THEN (cv.rate / wd.weight) WHEN (cv.itemid = ANY ('{30119,30309}'::integer[])) THEN cv.rate ELSE NULL::double precision END)",
                        "max(CASE WHEN (cv.itemid = ANY ('{30044,30119,30309}'::integer[])) THEN cv.amount ELSE NULL::double precision END)",
                        "cv.charttime"
                    ],
                    "Group Key": [
                        "cv.icustay_id",
                        "cv.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Gather Merge",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "cv.icustay_id",
                                "cv.charttime",
                                "(PARTIAL max(CASE WHEN (cv.itemid = ANY ('{30044,30119,30309}'::integer[])) THEN 1 ELSE 0 END))",
                                "(PARTIAL max(CASE WHEN ((cv.itemid = ANY ('{30044,30119,30309}'::integer[])) AND (((cv.stopped)::text = 'Stopped'::text) OR ((cv.stopped)::text ~~ 'D/C%'::text))) THEN 1 ELSE 0 END))",
                                "(PARTIAL max(CASE WHEN ((cv.itemid = ANY ('{30044,30119,30309}'::integer[])) AND (cv.rate IS NOT NULL)) THEN 1 ELSE 0 END))",
                                "(PARTIAL max(CASE WHEN ((cv.itemid = 30044) AND (wd.weight IS NULL)) THEN (cv.rate / '80'::double precision) WHEN (cv.itemid = 30044) THEN (cv.rate / wd.weight) WHEN (cv.itemid = ANY ('{30119,30309}'::integer[])) THEN cv.rate ELSE NULL::double precision END))",
                                "(PARTIAL max(CASE WHEN (cv.itemid = ANY ('{30044,30119,30309}'::integer[])) THEN cv.amount ELSE NULL::double precision END))"
                            ],
                            "Workers Planned": 2,
                            "Plans": [
                                {
                                    "Node Type": "Aggregate",
                                    "Strategy": "Sorted",
                                    "Partial Mode": "Partial",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "cv.icustay_id",
                                        "cv.charttime",
                                        "PARTIAL max(CASE WHEN (cv.itemid = ANY ('{30044,30119,30309}'::integer[])) THEN 1 ELSE 0 END)",
                                        "PARTIAL max(CASE WHEN ((cv.itemid = ANY ('{30044,30119,30309}'::integer[])) AND (((cv.stopped)::text = 'Stopped'::text) OR ((cv.stopped)::text ~~ 'D/C%'::text))) THEN 1 ELSE 0 END)",
                                        "PARTIAL max(CASE WHEN ((cv.itemid = ANY ('{30044,30119,30309}'::integer[])) AND (cv.rate IS NOT NULL)) THEN 1 ELSE 0 END)",
                                        "PARTIAL max(CASE WHEN ((cv.itemid = 30044) AND (wd.weight IS NULL)) THEN (cv.rate / '80'::double precision) WHEN (cv.itemid = 30044) THEN (cv.rate / wd.weight) WHEN (cv.itemid = ANY ('{30119,30309}'::integer[])) THEN cv.rate ELSE NULL::double precision END)",
                                        "PARTIAL max(CASE WHEN (cv.itemid = ANY ('{30044,30119,30309}'::integer[])) THEN cv.amount ELSE NULL::double precision END)"
                                    ],
                                    "Group Key": [
                                        "cv.icustay_id",
                                        "cv.charttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "cv.icustay_id",
                                                "cv.charttime",
                                                "cv.itemid",
                                                "cv.stopped",
                                                "cv.rate",
                                                "wd.weight",
                                                "cv.amount"
                                            ],
                                            "Sort Key": [
                                                "cv.icustay_id",
                                                "cv.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Hash Join",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Join Type": "Left",
                                                    "Output": [
                                                        "cv.icustay_id",
                                                        "cv.charttime",
                                                        "cv.itemid",
                                                        "cv.stopped",
                                                        "cv.rate",
                                                        "wd.weight",
                                                        "cv.amount"
                                                    ],
                                                    "Inner Unique": false,
                                                    "Hash Cond": "(cv.icustay_id = wd.icustay_id)",
                                                    "Join Filter": "((cv.charttime >= wd.starttime) AND (cv.charttime <= wd.endtime))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Bitmap Heap Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": true,
                                                            "Relation Name": "inputevents_cv",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "cv",
                                                            "Output": [
                                                                "cv.icustay_id",
                                                                "cv.charttime",
                                                                "cv.itemid",
                                                                "cv.stopped",
                                                                "cv.rate",
                                                                "cv.amount"
                                                            ],
                                                            "Recheck Cond": "(cv.itemid = ANY ('{30044,30119,30309}'::integer[]))",
                                                            "Filter": "(cv.icustay_id IS NOT NULL)",
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Bitmap Index Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Index Name": "inputevents_cv_idx05",
                                                                    "Index Cond": "(cv.itemid = ANY ('{30044,30119,30309}'::integer[]))"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "Node Type": "Hash",
                                                            "Parent Relationship": "Inner",
                                                            "Parallel Aware": false,
                                                            "Output": [
                                                                "wd.weight",
                                                                "wd.icustay_id",
                                                                "wd.starttime",
                                                                "wd.endtime"
                                                            ],
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Seq Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Relation Name": "weight_durations",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "wd",
                                                                    "Output": [
                                                                        "wd.weight",
                                                                        "wd.icustay_id",
                                                                        "wd.starttime",
                                                                        "wd.endtime"
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv2",
                    "Parallel Aware": false,
                    "Output": [
                        "v.icustay_id",
                        "v.charttime",
                        "v.vaso",
                        "v.vaso_stopped",
                        "v.vaso_null",
                        "v.vaso_rate",
                        "v.vaso_amount",
                        "sum(v.vaso_null) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v.icustay_id",
                                "v.charttime",
                                "v.vaso",
                                "v.vaso_stopped",
                                "v.vaso_null",
                                "v.vaso_rate",
                                "v.vaso_amount"
                            ],
                            "Sort Key": [
                                "v.icustay_id",
                                "v.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv1",
                                    "Alias": "v",
                                    "Output": [
                                        "v.icustay_id",
                                        "v.charttime",
                                        "v.vaso",
                                        "v.vaso_stopped",
                                        "v.vaso_null",
                                        "v.vaso_rate",
                                        "v.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv3",
                    "Parallel Aware": false,
                    "Output": [
                        "v_1.icustay_id",
                        "v_1.charttime",
                        "v_1.vaso",
                        "v_1.vaso_stopped",
                        "v_1.vaso_null",
                        "v_1.vaso_rate",
                        "v_1.vaso_amount",
                        "v_1.vaso_partition",
                        "first_value(v_1.vaso_rate) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_1.icustay_id",
                                "v_1.charttime",
                                "v_1.vaso_partition",
                                "v_1.vaso",
                                "v_1.vaso_stopped",
                                "v_1.vaso_null",
                                "v_1.vaso_rate",
                                "v_1.vaso_amount"
                            ],
                            "Sort Key": [
                                "v_1.icustay_id",
                                "v_1.vaso_partition",
                                "v_1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv2",
                                    "Alias": "v_1",
                                    "Output": [
                                        "v_1.icustay_id",
                                        "v_1.charttime",
                                        "v_1.vaso_partition",
                                        "v_1.vaso",
                                        "v_1.vaso_stopped",
                                        "v_1.vaso_null",
                                        "v_1.vaso_rate",
                                        "v_1.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv4",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv3.icustay_id",
                        "vasocv3.charttime",
                        "vasocv3.vaso",
                        "vasocv3.vaso_rate",
                        "vasocv3.vaso_amount",
                        "vasocv3.vaso_stopped",
                        "vasocv3.vaso_prevrate_ifnull",
                        "CASE WHEN (vasocv3.vaso = 0) THEN NULL::integer WHEN ((vasocv3.vaso_rate > '0'::double precision) AND ((lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)) IS NULL)) THEN 1 WHEN ((vasocv3.vaso_rate = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN ((vasocv3.vaso_prevrate_ifnull = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision) THEN 1 WHEN (lag(vasocv3.vaso_stopped, 1) OVER (?) = 1) THEN 1 ELSE NULL::integer END",
                        "vasocv3.vaso_null"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv3.icustay_id",
                                "vasocv3.charttime",
                                "vasocv3.vaso",
                                "vasocv3.vaso_null",
                                "vasocv3.vaso_rate",
                                "vasocv3.vaso_amount",
                                "vasocv3.vaso_stopped",
                                "vasocv3.vaso_prevrate_ifnull",
                                "(lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?))"
                            ],
                            "Sort Key": [
                                "vasocv3.icustay_id",
                                "vasocv3.vaso",
                                "vasocv3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "WindowAgg",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv3.icustay_id",
                                        "vasocv3.charttime",
                                        "vasocv3.vaso",
                                        "vasocv3.vaso_null",
                                        "vasocv3.vaso_rate",
                                        "vasocv3.vaso_amount",
                                        "vasocv3.vaso_stopped",
                                        "vasocv3.vaso_prevrate_ifnull",
                                        "lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.charttime",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.vaso_rate",
                                                "vasocv3.vaso_amount",
                                                "vasocv3.vaso_stopped",
                                                "vasocv3.vaso_prevrate_ifnull"
                                            ],
                                            "Sort Key": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "vasocv3",
                                                    "Alias": "vasocv3",
                                                    "Output": [
                                                        "vasocv3.icustay_id",
                                                        "vasocv3.charttime",
                                                        "vasocv3.vaso",
                                                        "vasocv3.vaso_null",
                                                        "vasocv3.vaso_rate",
                                                        "vasocv3.vaso_amount",
                                                        "vasocv3.vaso_stopped",
                                                        "vasocv3.vaso_prevrate_ifnull"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv5",
                    "Parallel Aware": false,
                    "Output": [
                        "v_2.icustay_id",
                        "v_2.charttime",
                        "v_2.vaso",
                        "v_2.vaso_rate",
                        "v_2.vaso_amount",
                        "v_2.vaso_stopped",
                        "v_2.vaso_prevrate_ifnull",
                        "v_2.vaso_start",
                        "sum(v_2.vaso_start) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_2.icustay_id",
                                "v_2.charttime",
                                "v_2.vaso",
                                "v_2.vaso_rate",
                                "v_2.vaso_amount",
                                "v_2.vaso_stopped",
                                "v_2.vaso_prevrate_ifnull",
                                "v_2.vaso_start"
                            ],
                            "Sort Key": [
                                "v_2.icustay_id",
                                "v_2.vaso",
                                "v_2.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv4",
                                    "Alias": "v_2",
                                    "Output": [
                                        "v_2.icustay_id",
                                        "v_2.charttime",
                                        "v_2.vaso",
                                        "v_2.vaso_rate",
                                        "v_2.vaso_amount",
                                        "v_2.vaso_stopped",
                                        "v_2.vaso_prevrate_ifnull",
                                        "v_2.vaso_start"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv6",
                    "Parallel Aware": false,
                    "Output": [
                        "v_3.icustay_id",
                        "v_3.charttime",
                        "v_3.vaso",
                        "v_3.vaso_rate",
                        "v_3.vaso_amount",
                        "v_3.vaso_stopped",
                        "v_3.vaso_prevrate_ifnull",
                        "v_3.vaso_start",
                        "v_3.vaso_first",
                        "CASE WHEN (v_3.vaso = 0) THEN NULL::bigint WHEN (v_3.vaso_stopped = 1) THEN v_3.vaso_first WHEN (v_3.vaso_rate = '0'::double precision) THEN v_3.vaso_first WHEN (lead(v_3.charttime, 1) OVER (?) IS NULL) THEN v_3.vaso_first ELSE NULL::bigint END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_3.icustay_id",
                                "v_3.charttime",
                                "v_3.vaso",
                                "v_3.vaso_rate",
                                "v_3.vaso_amount",
                                "v_3.vaso_stopped",
                                "v_3.vaso_prevrate_ifnull",
                                "v_3.vaso_start",
                                "v_3.vaso_first"
                            ],
                            "Sort Key": [
                                "v_3.icustay_id",
                                "v_3.vaso",
                                "v_3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv5",
                                    "Alias": "v_3",
                                    "Output": [
                                        "v_3.icustay_id",
                                        "v_3.charttime",
                                        "v_3.vaso",
                                        "v_3.vaso_rate",
                                        "v_3.vaso_amount",
                                        "v_3.vaso_stopped",
                                        "v_3.vaso_prevrate_ifnull",
                                        "v_3.vaso_start",
                                        "v_3.vaso_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv7",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv6.icustay_id",
                        "vasocv6.charttime",
                        "lead(vasocv6.charttime) OVER (?)",
                        "vasocv6.vaso",
                        "vasocv6.vaso_rate",
                        "vasocv6.vaso_amount",
                        "vasocv6.vaso_stop",
                        "vasocv6.vaso_start",
                        "vasocv6.vaso_first"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv6.icustay_id",
                                "vasocv6.charttime",
                                "vasocv6.vaso_first",
                                "vasocv6.vaso",
                                "vasocv6.vaso_rate",
                                "vasocv6.vaso_amount",
                                "vasocv6.vaso_stop",
                                "vasocv6.vaso_start"
                            ],
                            "Sort Key": [
                                "vasocv6.icustay_id",
                                "vasocv6.vaso_first",
                                "vasocv6.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv6",
                                    "Alias": "vasocv6",
                                    "Output": [
                                        "vasocv6.icustay_id",
                                        "vasocv6.charttime",
                                        "vasocv6.vaso_first",
                                        "vasocv6.vaso",
                                        "vasocv6.vaso_rate",
                                        "vasocv6.vaso_amount",
                                        "vasocv6.vaso_stop",
                                        "vasocv6.vaso_start"
                                    ],
                                    "Filter": "((vasocv6.vaso_first IS NOT NULL) AND (vasocv6.icustay_id IS NOT NULL) AND (vasocv6.vaso_first <> 0))"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv8",
                    "Parallel Aware": false,
                    "CTE Name": "vasocv7",
                    "Alias": "vasocv7",
                    "Output": [
                        "vasocv7.icustay_id",
                        "vasocv7.starttime",
                        "vasocv7.endtime",
                        "vasocv7.vaso",
                        "vasocv7.vaso_rate",
                        "vasocv7.vaso_amount",
                        "vasocv7.vaso_stop",
                        "vasocv7.vaso_start",
                        "vasocv7.vaso_first"
                    ],
                    "Filter": "((vasocv7.endtime IS NOT NULL) AND (vasocv7.vaso_rate > '0'::double precision) AND (vasocv7.starttime <> vasocv7.endtime))"
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv9",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv8.icustay_id",
                        "vasocv8.starttime",
                        "vasocv8.endtime",
                        "CASE WHEN ((lag(vasocv8.endtime) OVER (?) = vasocv8.starttime) AND (lag(vasocv8.vaso_rate) OVER (?) = vasocv8.vaso_rate)) THEN 0 ELSE 1 END",
                        "vasocv8.vaso",
                        "vasocv8.vaso_rate",
                        "vasocv8.vaso_amount",
                        "vasocv8.vaso_stop",
                        "vasocv8.vaso_start",
                        "vasocv8.vaso_first"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv8.icustay_id",
                                "vasocv8.starttime",
                                "vasocv8.endtime",
                                "vasocv8.vaso_rate",
                                "vasocv8.vaso",
                                "vasocv8.vaso_amount",
                                "vasocv8.vaso_stop",
                                "vasocv8.vaso_start",
                                "vasocv8.vaso_first"
                            ],
                            "Sort Key": [
                                "vasocv8.icustay_id",
                                "vasocv8.starttime",
                                "vasocv8.endtime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv8",
                                    "Alias": "vasocv8",
                                    "Output": [
                                        "vasocv8.icustay_id",
                                        "vasocv8.starttime",
                                        "vasocv8.endtime",
                                        "vasocv8.vaso_rate",
                                        "vasocv8.vaso",
                                        "vasocv8.vaso_amount",
                                        "vasocv8.vaso_stop",
                                        "vasocv8.vaso_start",
                                        "vasocv8.vaso_first"
                                    ],
                                    "Filter": "((vasocv8.endtime IS NOT NULL) AND (vasocv8.vaso_rate > '0'::double precision) AND (vasocv8.starttime <> vasocv8.endtime))"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv10",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv9.icustay_id",
                        "vasocv9.starttime",
                        "vasocv9.endtime",
                        "vasocv9.vaso_groups",
                        "sum(vasocv9.vaso_groups) OVER (?)",
                        "vasocv9.vaso",
                        "vasocv9.vaso_rate",
                        "vasocv9.vaso_amount",
                        "vasocv9.vaso_stop",
                        "vasocv9.vaso_start",
                        "vasocv9.vaso_first"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv9.icustay_id",
                                "vasocv9.starttime",
                                "vasocv9.endtime",
                                "vasocv9.vaso_groups",
                                "vasocv9.vaso",
                                "vasocv9.vaso_rate",
                                "vasocv9.vaso_amount",
                                "vasocv9.vaso_stop",
                                "vasocv9.vaso_start",
                                "vasocv9.vaso_first"
                            ],
                            "Sort Key": [
                                "vasocv9.icustay_id",
                                "vasocv9.starttime",
                                "vasocv9.endtime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv9",
                                    "Alias": "vasocv9",
                                    "Output": [
                                        "vasocv9.icustay_id",
                                        "vasocv9.starttime",
                                        "vasocv9.endtime",
                                        "vasocv9.vaso_groups",
                                        "vasocv9.vaso",
                                        "vasocv9.vaso_rate",
                                        "vasocv9.vaso_amount",
                                        "vasocv9.vaso_stop",
                                        "vasocv9.vaso_start",
                                        "vasocv9.vaso_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv10.icustay_id",
                        "min(vasocv10.starttime)",
                        "max(vasocv10.endtime)",
                        "vasocv10.vaso_groups_sum",
                        "vasocv10.vaso_rate",
                        "sum(vasocv10.vaso_amount)"
                    ],
                    "Group Key": [
                        "vasocv10.icustay_id",
                        "vasocv10.vaso_groups_sum",
                        "vasocv10.vaso_rate"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "vasocv10",
                            "Alias": "vasocv10",
                            "Output": [
                                "vasocv10.icustay_id",
                                "vasocv10.starttime",
                                "vasocv10.endtime",
                                "vasocv10.vaso_groups",
                                "vasocv10.vaso_groups_sum",
                                "vasocv10.vaso",
                                "vasocv10.vaso_rate",
                                "vasocv10.vaso_amount",
                                "vasocv10.vaso_stop",
                                "vasocv10.vaso_start",
                                "vasocv10.vaso_first"
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Bitmap Heap Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasomv",
                    "Parallel Aware": false,
                    "Relation Name": "inputevents_mv",
                    "Schema": "mimiciii_clinical",
                    "Alias": "inputevents_mv",
                    "Output": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid",
                        "inputevents_mv.rate",
                        "inputevents_mv.amount",
                        "inputevents_mv.starttime",
                        "inputevents_mv.endtime"
                    ],
                    "Recheck Cond": "(inputevents_mv.itemid = 221289)",
                    "Filter": "((inputevents_mv.statusdescription)::text <> 'Rewritten'::text)",
                    "Plans": [
                        {
                            "Node Type": "Bitmap Index Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Index Name": "inputevents_mv_idx05",
                            "Index Cond": "(inputevents_mv.itemid = 221289)"
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "vasocv",
                            "Alias": "vasocv",
                            "Output": [
                                "vasocv.icustay_id",
                                "vasocv.starttime",
                                "vasocv.endtime",
                                "vasocv.vaso_rate",
                                "vasocv.vaso_amount"
                            ]
                        },
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "vasomv",
                            "Alias": "vasomv",
                            "Output": [
                                "vasomv.icustay_id",
                                "vasomv.starttime",
                                "vasomv.endtime",
                                "vasomv.vaso_rate",
                                "vasomv.vaso_amount"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.epinephrine_durations": {
        "sql": "-- This query extracts durations of epinephrine administration\n-- Consecutive administrations are numbered 1, 2, ...\n-- Total time on the drug can be calculated from this table by grouping using ICUSTAY_ID\n\n-- Get drug administration data from CareVue first\nwith vasocv1 as\n(\n  select\n    icustay_id, charttime\n    -- case statement determining whether the ITEMID is an instance of vasopressor usage\n    , max(case when itemid in (30044,30119,30309) then 1 else 0 end) as vaso -- epinephrine\n\n    -- the 'stopped' column indicates if a vasopressor has been disconnected\n    , max(case when itemid in (30044,30119,30309) and (stopped = 'Stopped' OR stopped like 'D/C%') then 1\n          else 0 end) as vaso_stopped\n\n    , max(case when itemid in (30044,30119,30309) and rate is not null then 1 else 0 end) as vaso_null\n    , max(case when itemid in (30044,30119,30309) then rate else null end) as vaso_rate\n    , max(case when itemid in (30044,30119,30309) then amount else null end) as vaso_amount\n\n  FROM inputevents_cv\n  where itemid in\n  (\n        30044,30119,30309 -- epinephrine\n  )\n  group by icustay_id, charttime\n)\n, vasocv2 as\n(\n  select v.*\n    , sum(vaso_null) over (partition by icustay_id order by charttime) as vaso_partition\n  from\n    vasocv1 v\n)\n, vasocv3 as\n(\n  select v.*\n    , first_value(vaso_rate) over (partition by icustay_id, vaso_partition order by charttime) as vaso_prevrate_ifnull\n  from\n    vasocv2 v\n)\n, vasocv4 as\n(\nselect\n    icustay_id\n    , charttime\n    -- , (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) AS delta\n\n    , vaso\n    , vaso_rate\n    , vaso_amount\n    , vaso_stopped\n    , vaso_prevrate_ifnull\n\n    -- We define start time here\n    , case\n        when vaso = 0 then null\n\n        -- if this is the first instance of the vasoactive drug\n        when vaso_rate > 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso, vaso_null\n          order by charttime\n          )\n          is null\n          then 1\n\n        -- you often get a string of 0s\n        -- we decide not to set these as 1, just because it makes vasonum sequential\n        when vaso_rate = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- sometimes you get a string of NULL, associated with 0 volumes\n        -- same reason as before, we decide not to set these as 1\n        -- vaso_prevrate_ifnull is equal to the previous value *iff* the current value is null\n        when vaso_prevrate_ifnull = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- If the last recorded rate was 0, newvaso = 1\n        when LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) = 0\n          then 1\n\n        -- If the last recorded vaso was D/C'd, newvaso = 1\n        when\n          LAG(vaso_stopped,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 1 then 1\n\n        -- ** not sure if the below is needed\n        --when (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) > (interval '4 hours') then 1\n      else null\n      end as vaso_start\n\nFROM\n  vasocv3\n)\n-- propagate start/stop flags forward in time\n, vasocv5 as\n(\n  select v.*\n    , SUM(vaso_start) OVER (partition by icustay_id, vaso order by charttime) as vaso_first\nFROM\n  vasocv4 v\n)\n, vasocv6 as\n(\n  select v.*\n    -- We define end time here\n    , case\n        when vaso = 0\n          then null\n\n        -- If the recorded vaso was D/C'd, this is an end time\n        when vaso_stopped = 1\n          then vaso_first\n\n        -- If the rate is zero, this is the end time\n        when vaso_rate = 0\n          then vaso_first\n\n        -- the last row in the table is always a potential end time\n        -- this captures patients who die/are discharged while on vasopressors\n        -- in principle, this could add an extra end time for the vasopressor\n        -- however, since we later group on vaso_start, any extra end times are ignored\n        when LEAD(CHARTTIME,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) is null\n          then vaso_first\n\n        else null\n        end as vaso_stop\n    from vasocv5 v\n)\n\n-- -- if you want to look at the results of the table before grouping:\n-- select\n--   icustay_id, charttime, vaso, vaso_rate, vaso_amount\n--     , case when vaso_stopped = 1 then 'Y' else '' end as stopped\n--     , vaso_start\n--     , vaso_first\n--     , vaso_stop\n-- from vasocv6 order by charttime\n\n\n, vasocv as\n(\n-- below groups together vasopressor administrations into groups\nselect\n  icustay_id\n  -- the first non-null rate is considered the starttime\n  , min(case when vaso_rate is not null then charttime else null end) as starttime\n  -- the *first* time the first/last flags agree is the stop time for this duration\n  , min(case when vaso_first = vaso_stop then charttime else null end) as endtime\nfrom vasocv6\nwhere\n  vaso_first is not null -- bogus data\nand\n  vaso_first != 0 -- sometimes *only* a rate of 0 appears, i.e. the drug is never actually delivered\nand\n  icustay_id is not null -- there are data for \"floating\" admissions, we don't worry about these\ngroup by icustay_id, vaso_first\nhaving -- ensure start time is not the same as end time\n min(charttime) != min(case when vaso_first = vaso_stop then charttime else null end)\nand\n  max(vaso_rate) > 0 -- if the rate was always 0 or null, we consider it not a real drug delivery\n)\n\n-- now we extract the associated data for metavision patients\n, vasomv as\n(\n  select\n    icustay_id, linkorderid\n    , min(starttime) as starttime, max(endtime) as endtime\n  FROM inputevents_mv\n  where itemid = 221289 -- epinephrine\n  and statusdescription != 'Rewritten' -- only valid orders\n  group by icustay_id, linkorderid\n)\n\nselect\n  icustay_id\n  -- generate a sequential integer for convenience\n  , ROW_NUMBER() over (partition by icustay_id order by starttime) as vasonum\n  , starttime, endtime\n  , DATETIME_DIFF(endtime, starttime, 'HOUR') AS duration_hours\n  -- add durations\nfrom\n  vasocv\n\nUNION ALL\n\nselect\n  icustay_id\n  , ROW_NUMBER() over (partition by icustay_id order by starttime) as vasonum\n  , starttime, endtime\n  , DATETIME_DIFF(endtime, starttime, 'HOUR') AS duration_hours\n  -- add durations\nfrom\n  vasomv\n\norder by icustay_id, vasonum",
        "tables": [
            "mimiciii_clinical.inputevents_cv",
            "mimiciii_clinical.inputevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "vasonum": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "starttime": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "endtime": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "duration_hours": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ]
        },
        "table_name": "mimiciii_clinical.epinephrine_durations",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "vasocv.icustay_id",
                "(row_number() OVER (?))",
                "vasocv.starttime",
                "vasocv.endtime",
                "(datetime_diff(vasocv.endtime, vasocv.starttime, 'HOUR'::text))"
            ],
            "Sort Key": [
                "vasocv.icustay_id",
                "(row_number() OVER (?))"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv1",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30044,30119,30309}'::integer[])) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = ANY ('{30044,30119,30309}'::integer[])) AND (((inputevents_cv.stopped)::text = 'Stopped'::text) OR ((inputevents_cv.stopped)::text ~~ 'D/C%'::text))) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = ANY ('{30044,30119,30309}'::integer[])) AND (inputevents_cv.rate IS NOT NULL)) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30044,30119,30309}'::integer[])) THEN inputevents_cv.rate ELSE NULL::double precision END)",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30044,30119,30309}'::integer[])) THEN inputevents_cv.amount ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime",
                                "inputevents_cv.itemid",
                                "inputevents_cv.stopped",
                                "inputevents_cv.rate",
                                "inputevents_cv.amount"
                            ],
                            "Sort Key": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "inputevents_cv",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "inputevents_cv",
                                    "Output": [
                                        "inputevents_cv.icustay_id",
                                        "inputevents_cv.charttime",
                                        "inputevents_cv.itemid",
                                        "inputevents_cv.stopped",
                                        "inputevents_cv.rate",
                                        "inputevents_cv.amount"
                                    ],
                                    "Recheck Cond": "(inputevents_cv.itemid = ANY ('{30044,30119,30309}'::integer[]))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "inputevents_cv_idx05",
                                            "Index Cond": "(inputevents_cv.itemid = ANY ('{30044,30119,30309}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv2",
                    "Parallel Aware": false,
                    "Output": [
                        "v.icustay_id",
                        "v.charttime",
                        "v.vaso",
                        "v.vaso_stopped",
                        "v.vaso_null",
                        "v.vaso_rate",
                        "v.vaso_amount",
                        "sum(v.vaso_null) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v.icustay_id",
                                "v.charttime",
                                "v.vaso",
                                "v.vaso_stopped",
                                "v.vaso_null",
                                "v.vaso_rate",
                                "v.vaso_amount"
                            ],
                            "Sort Key": [
                                "v.icustay_id",
                                "v.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv1",
                                    "Alias": "v",
                                    "Output": [
                                        "v.icustay_id",
                                        "v.charttime",
                                        "v.vaso",
                                        "v.vaso_stopped",
                                        "v.vaso_null",
                                        "v.vaso_rate",
                                        "v.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv3",
                    "Parallel Aware": false,
                    "Output": [
                        "v_1.icustay_id",
                        "v_1.charttime",
                        "v_1.vaso",
                        "v_1.vaso_stopped",
                        "v_1.vaso_null",
                        "v_1.vaso_rate",
                        "v_1.vaso_amount",
                        "v_1.vaso_partition",
                        "first_value(v_1.vaso_rate) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_1.icustay_id",
                                "v_1.charttime",
                                "v_1.vaso_partition",
                                "v_1.vaso",
                                "v_1.vaso_stopped",
                                "v_1.vaso_null",
                                "v_1.vaso_rate",
                                "v_1.vaso_amount"
                            ],
                            "Sort Key": [
                                "v_1.icustay_id",
                                "v_1.vaso_partition",
                                "v_1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv2",
                                    "Alias": "v_1",
                                    "Output": [
                                        "v_1.icustay_id",
                                        "v_1.charttime",
                                        "v_1.vaso_partition",
                                        "v_1.vaso",
                                        "v_1.vaso_stopped",
                                        "v_1.vaso_null",
                                        "v_1.vaso_rate",
                                        "v_1.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv4",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv3.icustay_id",
                        "vasocv3.charttime",
                        "vasocv3.vaso",
                        "vasocv3.vaso_rate",
                        "vasocv3.vaso_amount",
                        "vasocv3.vaso_stopped",
                        "vasocv3.vaso_prevrate_ifnull",
                        "CASE WHEN (vasocv3.vaso = 0) THEN NULL::integer WHEN ((vasocv3.vaso_rate > '0'::double precision) AND ((lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)) IS NULL)) THEN 1 WHEN ((vasocv3.vaso_rate = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN ((vasocv3.vaso_prevrate_ifnull = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision) THEN 1 WHEN (lag(vasocv3.vaso_stopped, 1) OVER (?) = 1) THEN 1 ELSE NULL::integer END",
                        "vasocv3.vaso_null"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv3.icustay_id",
                                "vasocv3.charttime",
                                "vasocv3.vaso",
                                "vasocv3.vaso_null",
                                "vasocv3.vaso_rate",
                                "vasocv3.vaso_amount",
                                "vasocv3.vaso_stopped",
                                "vasocv3.vaso_prevrate_ifnull",
                                "(lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?))"
                            ],
                            "Sort Key": [
                                "vasocv3.icustay_id",
                                "vasocv3.vaso",
                                "vasocv3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "WindowAgg",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv3.icustay_id",
                                        "vasocv3.charttime",
                                        "vasocv3.vaso",
                                        "vasocv3.vaso_null",
                                        "vasocv3.vaso_rate",
                                        "vasocv3.vaso_amount",
                                        "vasocv3.vaso_stopped",
                                        "vasocv3.vaso_prevrate_ifnull",
                                        "lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.charttime",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.vaso_rate",
                                                "vasocv3.vaso_amount",
                                                "vasocv3.vaso_stopped",
                                                "vasocv3.vaso_prevrate_ifnull"
                                            ],
                                            "Sort Key": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "vasocv3",
                                                    "Alias": "vasocv3",
                                                    "Output": [
                                                        "vasocv3.icustay_id",
                                                        "vasocv3.charttime",
                                                        "vasocv3.vaso",
                                                        "vasocv3.vaso_null",
                                                        "vasocv3.vaso_rate",
                                                        "vasocv3.vaso_amount",
                                                        "vasocv3.vaso_stopped",
                                                        "vasocv3.vaso_prevrate_ifnull"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv5",
                    "Parallel Aware": false,
                    "Output": [
                        "v_2.icustay_id",
                        "v_2.charttime",
                        "v_2.vaso",
                        "v_2.vaso_rate",
                        "v_2.vaso_amount",
                        "v_2.vaso_stopped",
                        "v_2.vaso_prevrate_ifnull",
                        "v_2.vaso_start",
                        "sum(v_2.vaso_start) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_2.icustay_id",
                                "v_2.charttime",
                                "v_2.vaso",
                                "v_2.vaso_rate",
                                "v_2.vaso_amount",
                                "v_2.vaso_stopped",
                                "v_2.vaso_prevrate_ifnull",
                                "v_2.vaso_start"
                            ],
                            "Sort Key": [
                                "v_2.icustay_id",
                                "v_2.vaso",
                                "v_2.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv4",
                                    "Alias": "v_2",
                                    "Output": [
                                        "v_2.icustay_id",
                                        "v_2.charttime",
                                        "v_2.vaso",
                                        "v_2.vaso_rate",
                                        "v_2.vaso_amount",
                                        "v_2.vaso_stopped",
                                        "v_2.vaso_prevrate_ifnull",
                                        "v_2.vaso_start"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv6",
                    "Parallel Aware": false,
                    "Output": [
                        "v_3.icustay_id",
                        "v_3.charttime",
                        "v_3.vaso",
                        "v_3.vaso_rate",
                        "v_3.vaso_amount",
                        "v_3.vaso_stopped",
                        "v_3.vaso_prevrate_ifnull",
                        "v_3.vaso_start",
                        "v_3.vaso_first",
                        "CASE WHEN (v_3.vaso = 0) THEN NULL::bigint WHEN (v_3.vaso_stopped = 1) THEN v_3.vaso_first WHEN (v_3.vaso_rate = '0'::double precision) THEN v_3.vaso_first WHEN (lead(v_3.charttime, 1) OVER (?) IS NULL) THEN v_3.vaso_first ELSE NULL::bigint END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_3.icustay_id",
                                "v_3.charttime",
                                "v_3.vaso",
                                "v_3.vaso_rate",
                                "v_3.vaso_amount",
                                "v_3.vaso_stopped",
                                "v_3.vaso_prevrate_ifnull",
                                "v_3.vaso_start",
                                "v_3.vaso_first"
                            ],
                            "Sort Key": [
                                "v_3.icustay_id",
                                "v_3.vaso",
                                "v_3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv5",
                                    "Alias": "v_3",
                                    "Output": [
                                        "v_3.icustay_id",
                                        "v_3.charttime",
                                        "v_3.vaso",
                                        "v_3.vaso_rate",
                                        "v_3.vaso_amount",
                                        "v_3.vaso_stopped",
                                        "v_3.vaso_prevrate_ifnull",
                                        "v_3.vaso_start",
                                        "v_3.vaso_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv6.icustay_id",
                        "min(CASE WHEN (vasocv6.vaso_rate IS NOT NULL) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)",
                        "min(CASE WHEN (vasocv6.vaso_first = vasocv6.vaso_stop) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)",
                        "vasocv6.vaso_first"
                    ],
                    "Group Key": [
                        "vasocv6.icustay_id",
                        "vasocv6.vaso_first"
                    ],
                    "Filter": "((min(vasocv6.charttime) <> min(CASE WHEN (vasocv6.vaso_first = vasocv6.vaso_stop) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)) AND (max(vasocv6.vaso_rate) > '0'::double precision))",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "vasocv6",
                            "Alias": "vasocv6",
                            "Output": [
                                "vasocv6.icustay_id",
                                "vasocv6.charttime",
                                "vasocv6.vaso",
                                "vasocv6.vaso_rate",
                                "vasocv6.vaso_amount",
                                "vasocv6.vaso_stopped",
                                "vasocv6.vaso_prevrate_ifnull",
                                "vasocv6.vaso_start",
                                "vasocv6.vaso_first",
                                "vasocv6.vaso_stop"
                            ],
                            "Filter": "((vasocv6.vaso_first IS NOT NULL) AND (vasocv6.icustay_id IS NOT NULL) AND (vasocv6.vaso_first <> 0))"
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasomv",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid",
                        "min(inputevents_mv.starttime)",
                        "max(inputevents_mv.endtime)"
                    ],
                    "Group Key": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Bitmap Heap Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "inputevents_mv",
                            "Schema": "mimiciii_clinical",
                            "Alias": "inputevents_mv",
                            "Output": [
                                "inputevents_mv.row_id",
                                "inputevents_mv.subject_id",
                                "inputevents_mv.hadm_id",
                                "inputevents_mv.icustay_id",
                                "inputevents_mv.starttime",
                                "inputevents_mv.endtime",
                                "inputevents_mv.itemid",
                                "inputevents_mv.amount",
                                "inputevents_mv.amountuom",
                                "inputevents_mv.rate",
                                "inputevents_mv.rateuom",
                                "inputevents_mv.storetime",
                                "inputevents_mv.cgid",
                                "inputevents_mv.orderid",
                                "inputevents_mv.linkorderid",
                                "inputevents_mv.ordercategoryname",
                                "inputevents_mv.secondaryordercategoryname",
                                "inputevents_mv.ordercomponenttypedescription",
                                "inputevents_mv.ordercategorydescription",
                                "inputevents_mv.patientweight",
                                "inputevents_mv.totalamount",
                                "inputevents_mv.totalamountuom",
                                "inputevents_mv.isopenbag",
                                "inputevents_mv.continueinnextdept",
                                "inputevents_mv.cancelreason",
                                "inputevents_mv.statusdescription",
                                "inputevents_mv.comments_editedby",
                                "inputevents_mv.comments_canceledby",
                                "inputevents_mv.comments_date",
                                "inputevents_mv.originalamount",
                                "inputevents_mv.originalrate"
                            ],
                            "Recheck Cond": "(inputevents_mv.itemid = 221289)",
                            "Filter": "((inputevents_mv.statusdescription)::text <> 'Rewritten'::text)",
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Index Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Index Name": "inputevents_mv_idx05",
                                    "Index Cond": "(inputevents_mv.itemid = 221289)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv.icustay_id",
                                "row_number() OVER (?)",
                                "vasocv.starttime",
                                "vasocv.endtime",
                                "datetime_diff(vasocv.endtime, vasocv.starttime, 'HOUR'::text)"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv.icustay_id",
                                        "vasocv.starttime",
                                        "vasocv.endtime"
                                    ],
                                    "Sort Key": [
                                        "vasocv.icustay_id",
                                        "vasocv.starttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "vasocv",
                                            "Alias": "vasocv",
                                            "Output": [
                                                "vasocv.icustay_id",
                                                "vasocv.starttime",
                                                "vasocv.endtime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "vasomv.icustay_id",
                                "row_number() OVER (?)",
                                "vasomv.starttime",
                                "vasomv.endtime",
                                "datetime_diff(vasomv.endtime, vasomv.starttime, 'HOUR'::text)"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasomv.icustay_id",
                                        "vasomv.starttime",
                                        "vasomv.endtime"
                                    ],
                                    "Sort Key": [
                                        "vasomv.icustay_id",
                                        "vasomv.starttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "vasomv",
                                            "Alias": "vasomv",
                                            "Output": [
                                                "vasomv.icustay_id",
                                                "vasomv.starttime",
                                                "vasomv.endtime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.isuprel_durations": {
        "sql": "-- This query extracts durations of isuprel administration\n-- Consecutive administrations are numbered 1, 2, ...\n-- Total time on the drug can be calculated from this table by grouping using ICUSTAY_ID\n\n-- Get drug administration data from CareVue first\nwith vasocv1 as\n(\n  select\n    icustay_id, charttime\n    -- case statement determining whether the ITEMID is an instance of vasopressor usage\n    , max(case when itemid = 30046 then 1 else 0 end) as vaso -- Isuprel\n\n    -- the 'stopped' column indicates if a vasopressor has been disconnected\n    , max(case when itemid = 30046 and (stopped = 'Stopped' OR stopped like 'D/C%') then 1\n          else 0 end) as vaso_stopped\n\n    , max(case when itemid = 30046 and rate is not null then 1 else 0 end) as vaso_null\n    , max(case when itemid = 30046 then rate else null end) as vaso_rate\n    , max(case when itemid = 30046 then amount else null end) as vaso_amount\n\n  FROM inputevents_cv\n  where itemid = 30046 -- Isuprel\n  group by icustay_id, charttime\n)\n, vasocv2 as\n(\n  select v.*\n    , sum(vaso_null) over (partition by icustay_id order by charttime) as vaso_partition\n  from\n    vasocv1 v\n)\n, vasocv3 as\n(\n  select v.*\n    , first_value(vaso_rate) over (partition by icustay_id, vaso_partition order by charttime) as vaso_prevrate_ifnull\n  from\n    vasocv2 v\n)\n, vasocv4 as\n(\nselect\n    icustay_id\n    , charttime\n    -- , (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) AS delta\n\n    , vaso\n    , vaso_rate\n    , vaso_amount\n    , vaso_stopped\n    , vaso_prevrate_ifnull\n\n    -- We define start time here\n    , case\n        when vaso = 0 then null\n\n        -- if this is the first instance of the vasoactive drug\n        when vaso_rate > 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso, vaso_null\n          order by charttime\n          )\n          is null\n          then 1\n\n        -- you often get a string of 0s\n        -- we decide not to set these as 1, just because it makes vasonum sequential\n        when vaso_rate = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- sometimes you get a string of NULL, associated with 0 volumes\n        -- same reason as before, we decide not to set these as 1\n        -- vaso_prevrate_ifnull is equal to the previous value *iff* the current value is null\n        when vaso_prevrate_ifnull = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- If the last recorded rate was 0, newvaso = 1\n        when LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) = 0\n          then 1\n\n        -- If the last recorded vaso was D/C'd, newvaso = 1\n        when\n          LAG(vaso_stopped,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 1 then 1\n\n        -- ** not sure if the below is needed\n        --when (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) > (interval '4 hours') then 1\n      else null\n      end as vaso_start\n\nFROM\n  vasocv3\n)\n-- propagate start/stop flags forward in time\n, vasocv5 as\n(\n  select v.*\n    , SUM(vaso_start) OVER (partition by icustay_id, vaso order by charttime) as vaso_first\nFROM\n  vasocv4 v\n)\n, vasocv6 as\n(\n  select v.*\n    -- We define end time here\n    , case\n        when vaso = 0\n          then null\n\n        -- If the recorded vaso was D/C'd, this is an end time\n        when vaso_stopped = 1\n          then vaso_first\n\n        -- If the rate is zero, this is the end time\n        when vaso_rate = 0\n          then vaso_first\n\n        -- the last row in the table is always a potential end time\n        -- this captures patients who die/are discharged while on vasopressors\n        -- in principle, this could add an extra end time for the vasopressor\n        -- however, since we later group on vaso_start, any extra end times are ignored\n        when LEAD(CHARTTIME,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) is null\n          then vaso_first\n\n        else null\n        end as vaso_stop\n    from vasocv5 v\n)\n\n-- -- if you want to look at the results of the table before grouping:\n-- select\n--   icustay_id, charttime, vaso, vaso_rate, vaso_amount\n--     , case when vaso_stopped = 1 then 'Y' else '' end as stopped\n--     , vaso_start\n--     , vaso_first\n--     , vaso_stop\n-- from vasocv6 order by charttime\n\n\n, vasocv as\n(\n-- below groups together vasopressor administrations into groups\nselect\n  icustay_id\n  -- the first non-null rate is considered the starttime\n  , min(case when vaso_rate is not null then charttime else null end) as starttime\n  -- the *first* time the first/last flags agree is the stop time for this duration\n  , min(case when vaso_first = vaso_stop then charttime else null end) as endtime\nfrom vasocv6\nwhere\n  vaso_first is not null -- bogus data\nand\n  vaso_first != 0 -- sometimes *only* a rate of 0 appears, i.e. the drug is never actually delivered\nand\n  icustay_id is not null -- there are data for \"floating\" admissions, we don't worry about these\ngroup by icustay_id, vaso_first\nhaving -- ensure start time is not the same as end time\n min(charttime) != min(case when vaso_first = vaso_stop then charttime else null end)\nand\n  max(vaso_rate) > 0 -- if the rate was always 0 or null, we consider it not a real drug delivery\n)\n\n-- now we extract the associated data for metavision patients\n, vasomv as\n(\n  select\n    icustay_id, linkorderid\n    , min(starttime) as starttime, max(endtime) as endtime\n  FROM inputevents_mv\n  where itemid = 227692 -- Isuprel\n  and statusdescription != 'Rewritten' -- only valid orders\n  group by icustay_id, linkorderid\n)\n\nselect\n  icustay_id\n  -- generate a sequential integer for convenience\n  , ROW_NUMBER() over (partition by icustay_id order by starttime) as vasonum\n  , starttime, endtime\n  , DATETIME_DIFF(endtime, starttime, 'HOUR') AS duration_hours\n  -- add durations\nfrom\n  vasocv\n\nUNION ALL\n\nselect\n  icustay_id\n  , ROW_NUMBER() over (partition by icustay_id order by starttime) as vasonum\n  , starttime, endtime\n  , DATETIME_DIFF(endtime, starttime, 'HOUR') AS duration_hours\n  -- add durations\nfrom\n  vasomv\n\norder by icustay_id, vasonum",
        "tables": [
            "mimiciii_clinical.inputevents_cv",
            "mimiciii_clinical.inputevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "vasonum": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "starttime": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "endtime": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "duration_hours": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ]
        },
        "table_name": "mimiciii_clinical.isuprel_durations",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "vasocv.icustay_id",
                "(row_number() OVER (?))",
                "vasocv.starttime",
                "vasocv.endtime",
                "(datetime_diff(vasocv.endtime, vasocv.starttime, 'HOUR'::text))"
            ],
            "Sort Key": [
                "vasocv.icustay_id",
                "(row_number() OVER (?))"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv1",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime",
                        "max(CASE WHEN (inputevents_cv.itemid = 30046) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = 30046) AND (((inputevents_cv.stopped)::text = 'Stopped'::text) OR ((inputevents_cv.stopped)::text ~~ 'D/C%'::text))) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = 30046) AND (inputevents_cv.rate IS NOT NULL)) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN (inputevents_cv.itemid = 30046) THEN inputevents_cv.rate ELSE NULL::double precision END)",
                        "max(CASE WHEN (inputevents_cv.itemid = 30046) THEN inputevents_cv.amount ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Index Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Scan Direction": "Forward",
                            "Index Name": "inputevents_cv_idx05",
                            "Relation Name": "inputevents_cv",
                            "Schema": "mimiciii_clinical",
                            "Alias": "inputevents_cv",
                            "Output": [
                                "inputevents_cv.row_id",
                                "inputevents_cv.subject_id",
                                "inputevents_cv.hadm_id",
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime",
                                "inputevents_cv.itemid",
                                "inputevents_cv.amount",
                                "inputevents_cv.amountuom",
                                "inputevents_cv.rate",
                                "inputevents_cv.rateuom",
                                "inputevents_cv.storetime",
                                "inputevents_cv.cgid",
                                "inputevents_cv.orderid",
                                "inputevents_cv.linkorderid",
                                "inputevents_cv.stopped",
                                "inputevents_cv.newbottle",
                                "inputevents_cv.originalamount",
                                "inputevents_cv.originalamountuom",
                                "inputevents_cv.originalroute",
                                "inputevents_cv.originalrate",
                                "inputevents_cv.originalrateuom",
                                "inputevents_cv.originalsite"
                            ],
                            "Index Cond": "(inputevents_cv.itemid = 30046)"
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv2",
                    "Parallel Aware": false,
                    "Output": [
                        "v.icustay_id",
                        "v.charttime",
                        "v.vaso",
                        "v.vaso_stopped",
                        "v.vaso_null",
                        "v.vaso_rate",
                        "v.vaso_amount",
                        "sum(v.vaso_null) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v.icustay_id",
                                "v.charttime",
                                "v.vaso",
                                "v.vaso_stopped",
                                "v.vaso_null",
                                "v.vaso_rate",
                                "v.vaso_amount"
                            ],
                            "Sort Key": [
                                "v.icustay_id",
                                "v.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv1",
                                    "Alias": "v",
                                    "Output": [
                                        "v.icustay_id",
                                        "v.charttime",
                                        "v.vaso",
                                        "v.vaso_stopped",
                                        "v.vaso_null",
                                        "v.vaso_rate",
                                        "v.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv3",
                    "Parallel Aware": false,
                    "Output": [
                        "v_1.icustay_id",
                        "v_1.charttime",
                        "v_1.vaso",
                        "v_1.vaso_stopped",
                        "v_1.vaso_null",
                        "v_1.vaso_rate",
                        "v_1.vaso_amount",
                        "v_1.vaso_partition",
                        "first_value(v_1.vaso_rate) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_1.icustay_id",
                                "v_1.charttime",
                                "v_1.vaso_partition",
                                "v_1.vaso",
                                "v_1.vaso_stopped",
                                "v_1.vaso_null",
                                "v_1.vaso_rate",
                                "v_1.vaso_amount"
                            ],
                            "Sort Key": [
                                "v_1.icustay_id",
                                "v_1.vaso_partition",
                                "v_1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv2",
                                    "Alias": "v_1",
                                    "Output": [
                                        "v_1.icustay_id",
                                        "v_1.charttime",
                                        "v_1.vaso_partition",
                                        "v_1.vaso",
                                        "v_1.vaso_stopped",
                                        "v_1.vaso_null",
                                        "v_1.vaso_rate",
                                        "v_1.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv4",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv3.icustay_id",
                        "vasocv3.charttime",
                        "vasocv3.vaso",
                        "vasocv3.vaso_rate",
                        "vasocv3.vaso_amount",
                        "vasocv3.vaso_stopped",
                        "vasocv3.vaso_prevrate_ifnull",
                        "CASE WHEN (vasocv3.vaso = 0) THEN NULL::integer WHEN ((vasocv3.vaso_rate > '0'::double precision) AND ((lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)) IS NULL)) THEN 1 WHEN ((vasocv3.vaso_rate = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN ((vasocv3.vaso_prevrate_ifnull = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision) THEN 1 WHEN (lag(vasocv3.vaso_stopped, 1) OVER (?) = 1) THEN 1 ELSE NULL::integer END",
                        "vasocv3.vaso_null"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv3.icustay_id",
                                "vasocv3.charttime",
                                "vasocv3.vaso",
                                "vasocv3.vaso_null",
                                "vasocv3.vaso_rate",
                                "vasocv3.vaso_amount",
                                "vasocv3.vaso_stopped",
                                "vasocv3.vaso_prevrate_ifnull",
                                "(lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?))"
                            ],
                            "Sort Key": [
                                "vasocv3.icustay_id",
                                "vasocv3.vaso",
                                "vasocv3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "WindowAgg",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv3.icustay_id",
                                        "vasocv3.charttime",
                                        "vasocv3.vaso",
                                        "vasocv3.vaso_null",
                                        "vasocv3.vaso_rate",
                                        "vasocv3.vaso_amount",
                                        "vasocv3.vaso_stopped",
                                        "vasocv3.vaso_prevrate_ifnull",
                                        "lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.charttime",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.vaso_rate",
                                                "vasocv3.vaso_amount",
                                                "vasocv3.vaso_stopped",
                                                "vasocv3.vaso_prevrate_ifnull"
                                            ],
                                            "Sort Key": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "vasocv3",
                                                    "Alias": "vasocv3",
                                                    "Output": [
                                                        "vasocv3.icustay_id",
                                                        "vasocv3.charttime",
                                                        "vasocv3.vaso",
                                                        "vasocv3.vaso_null",
                                                        "vasocv3.vaso_rate",
                                                        "vasocv3.vaso_amount",
                                                        "vasocv3.vaso_stopped",
                                                        "vasocv3.vaso_prevrate_ifnull"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv5",
                    "Parallel Aware": false,
                    "Output": [
                        "v_2.icustay_id",
                        "v_2.charttime",
                        "v_2.vaso",
                        "v_2.vaso_rate",
                        "v_2.vaso_amount",
                        "v_2.vaso_stopped",
                        "v_2.vaso_prevrate_ifnull",
                        "v_2.vaso_start",
                        "sum(v_2.vaso_start) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_2.icustay_id",
                                "v_2.charttime",
                                "v_2.vaso",
                                "v_2.vaso_rate",
                                "v_2.vaso_amount",
                                "v_2.vaso_stopped",
                                "v_2.vaso_prevrate_ifnull",
                                "v_2.vaso_start"
                            ],
                            "Sort Key": [
                                "v_2.icustay_id",
                                "v_2.vaso",
                                "v_2.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv4",
                                    "Alias": "v_2",
                                    "Output": [
                                        "v_2.icustay_id",
                                        "v_2.charttime",
                                        "v_2.vaso",
                                        "v_2.vaso_rate",
                                        "v_2.vaso_amount",
                                        "v_2.vaso_stopped",
                                        "v_2.vaso_prevrate_ifnull",
                                        "v_2.vaso_start"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv6",
                    "Parallel Aware": false,
                    "Output": [
                        "v_3.icustay_id",
                        "v_3.charttime",
                        "v_3.vaso",
                        "v_3.vaso_rate",
                        "v_3.vaso_amount",
                        "v_3.vaso_stopped",
                        "v_3.vaso_prevrate_ifnull",
                        "v_3.vaso_start",
                        "v_3.vaso_first",
                        "CASE WHEN (v_3.vaso = 0) THEN NULL::bigint WHEN (v_3.vaso_stopped = 1) THEN v_3.vaso_first WHEN (v_3.vaso_rate = '0'::double precision) THEN v_3.vaso_first WHEN (lead(v_3.charttime, 1) OVER (?) IS NULL) THEN v_3.vaso_first ELSE NULL::bigint END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_3.icustay_id",
                                "v_3.charttime",
                                "v_3.vaso",
                                "v_3.vaso_rate",
                                "v_3.vaso_amount",
                                "v_3.vaso_stopped",
                                "v_3.vaso_prevrate_ifnull",
                                "v_3.vaso_start",
                                "v_3.vaso_first"
                            ],
                            "Sort Key": [
                                "v_3.icustay_id",
                                "v_3.vaso",
                                "v_3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv5",
                                    "Alias": "v_3",
                                    "Output": [
                                        "v_3.icustay_id",
                                        "v_3.charttime",
                                        "v_3.vaso",
                                        "v_3.vaso_rate",
                                        "v_3.vaso_amount",
                                        "v_3.vaso_stopped",
                                        "v_3.vaso_prevrate_ifnull",
                                        "v_3.vaso_start",
                                        "v_3.vaso_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv6.icustay_id",
                        "min(CASE WHEN (vasocv6.vaso_rate IS NOT NULL) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)",
                        "min(CASE WHEN (vasocv6.vaso_first = vasocv6.vaso_stop) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)",
                        "vasocv6.vaso_first"
                    ],
                    "Group Key": [
                        "vasocv6.icustay_id",
                        "vasocv6.vaso_first"
                    ],
                    "Filter": "((min(vasocv6.charttime) <> min(CASE WHEN (vasocv6.vaso_first = vasocv6.vaso_stop) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)) AND (max(vasocv6.vaso_rate) > '0'::double precision))",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "vasocv6",
                            "Alias": "vasocv6",
                            "Output": [
                                "vasocv6.icustay_id",
                                "vasocv6.charttime",
                                "vasocv6.vaso",
                                "vasocv6.vaso_rate",
                                "vasocv6.vaso_amount",
                                "vasocv6.vaso_stopped",
                                "vasocv6.vaso_prevrate_ifnull",
                                "vasocv6.vaso_start",
                                "vasocv6.vaso_first",
                                "vasocv6.vaso_stop"
                            ],
                            "Filter": "((vasocv6.vaso_first IS NOT NULL) AND (vasocv6.icustay_id IS NOT NULL) AND (vasocv6.vaso_first <> 0))"
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasomv",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid",
                        "min(inputevents_mv.starttime)",
                        "max(inputevents_mv.endtime)"
                    ],
                    "Group Key": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Bitmap Heap Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "inputevents_mv",
                            "Schema": "mimiciii_clinical",
                            "Alias": "inputevents_mv",
                            "Output": [
                                "inputevents_mv.row_id",
                                "inputevents_mv.subject_id",
                                "inputevents_mv.hadm_id",
                                "inputevents_mv.icustay_id",
                                "inputevents_mv.starttime",
                                "inputevents_mv.endtime",
                                "inputevents_mv.itemid",
                                "inputevents_mv.amount",
                                "inputevents_mv.amountuom",
                                "inputevents_mv.rate",
                                "inputevents_mv.rateuom",
                                "inputevents_mv.storetime",
                                "inputevents_mv.cgid",
                                "inputevents_mv.orderid",
                                "inputevents_mv.linkorderid",
                                "inputevents_mv.ordercategoryname",
                                "inputevents_mv.secondaryordercategoryname",
                                "inputevents_mv.ordercomponenttypedescription",
                                "inputevents_mv.ordercategorydescription",
                                "inputevents_mv.patientweight",
                                "inputevents_mv.totalamount",
                                "inputevents_mv.totalamountuom",
                                "inputevents_mv.isopenbag",
                                "inputevents_mv.continueinnextdept",
                                "inputevents_mv.cancelreason",
                                "inputevents_mv.statusdescription",
                                "inputevents_mv.comments_editedby",
                                "inputevents_mv.comments_canceledby",
                                "inputevents_mv.comments_date",
                                "inputevents_mv.originalamount",
                                "inputevents_mv.originalrate"
                            ],
                            "Recheck Cond": "(inputevents_mv.itemid = 227692)",
                            "Filter": "((inputevents_mv.statusdescription)::text <> 'Rewritten'::text)",
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Index Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Index Name": "inputevents_mv_idx05",
                                    "Index Cond": "(inputevents_mv.itemid = 227692)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv.icustay_id",
                                "row_number() OVER (?)",
                                "vasocv.starttime",
                                "vasocv.endtime",
                                "datetime_diff(vasocv.endtime, vasocv.starttime, 'HOUR'::text)"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv.icustay_id",
                                        "vasocv.starttime",
                                        "vasocv.endtime"
                                    ],
                                    "Sort Key": [
                                        "vasocv.icustay_id",
                                        "vasocv.starttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "vasocv",
                                            "Alias": "vasocv",
                                            "Output": [
                                                "vasocv.icustay_id",
                                                "vasocv.starttime",
                                                "vasocv.endtime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "vasomv.icustay_id",
                                "row_number() OVER (?)",
                                "vasomv.starttime",
                                "vasomv.endtime",
                                "datetime_diff(vasomv.endtime, vasomv.starttime, 'HOUR'::text)"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasomv.icustay_id",
                                        "vasomv.starttime",
                                        "vasomv.endtime"
                                    ],
                                    "Sort Key": [
                                        "vasomv.icustay_id",
                                        "vasomv.starttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "vasomv",
                                            "Alias": "vasomv",
                                            "Output": [
                                                "vasomv.icustay_id",
                                                "vasomv.starttime",
                                                "vasomv.endtime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.milrinone_durations": {
        "sql": "-- This query extracts durations of milrinone administration\n-- Consecutive administrations are numbered 1, 2, ...\n-- Total time on the drug can be calculated from this table by grouping using ICUSTAY_ID\n\n-- Get drug administration data from CareVue first\nwith vasocv1 as\n(\n  select\n    icustay_id, charttime\n    -- case statement determining whether the ITEMID is an instance of vasopressor usage\n    , max(case when itemid = 30125 then 1 else 0 end) as vaso -- milrinone\n\n    -- the 'stopped' column indicates if a vasopressor has been disconnected\n    , max(case when itemid = 30125 and (stopped = 'Stopped' OR stopped like 'D/C%') then 1\n          else 0 end) as vaso_stopped\n\n    , max(case when itemid = 30125 and rate is not null then 1 else 0 end) as vaso_null\n    , max(case when itemid = 30125 then rate else null end) as vaso_rate\n    , max(case when itemid = 30125 then amount else null end) as vaso_amount\n\n  FROM inputevents_cv\n  where itemid = 30125 -- milrinone\n  group by icustay_id, charttime\n)\n, vasocv2 as\n(\n  select v.*\n    , sum(vaso_null) over (partition by icustay_id order by charttime) as vaso_partition\n  from\n    vasocv1 v\n)\n, vasocv3 as\n(\n  select v.*\n    , first_value(vaso_rate) over (partition by icustay_id, vaso_partition order by charttime) as vaso_prevrate_ifnull\n  from\n    vasocv2 v\n)\n, vasocv4 as\n(\nselect\n    icustay_id\n    , charttime\n    -- , (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) AS delta\n\n    , vaso\n    , vaso_rate\n    , vaso_amount\n    , vaso_stopped\n    , vaso_prevrate_ifnull\n\n    -- We define start time here\n    , case\n        when vaso = 0 then null\n\n        -- if this is the first instance of the vasoactive drug\n        when vaso_rate > 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso, vaso_null\n          order by charttime\n          )\n          is null\n          then 1\n\n        -- you often get a string of 0s\n        -- we decide not to set these as 1, just because it makes vasonum sequential\n        when vaso_rate = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- sometimes you get a string of NULL, associated with 0 volumes\n        -- same reason as before, we decide not to set these as 1\n        -- vaso_prevrate_ifnull is equal to the previous value *iff* the current value is null\n        when vaso_prevrate_ifnull = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- If the last recorded rate was 0, newvaso = 1\n        when LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) = 0\n          then 1\n\n        -- If the last recorded vaso was D/C'd, newvaso = 1\n        when\n          LAG(vaso_stopped,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 1 then 1\n\n        -- ** not sure if the below is needed\n        --when (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) > (interval '4 hours') then 1\n      else null\n      end as vaso_start\n\nFROM\n  vasocv3\n)\n-- propagate start/stop flags forward in time\n, vasocv5 as\n(\n  select v.*\n    , SUM(vaso_start) OVER (partition by icustay_id, vaso order by charttime) as vaso_first\nFROM\n  vasocv4 v\n)\n, vasocv6 as\n(\n  select v.*\n    -- We define end time here\n    , case\n        when vaso = 0\n          then null\n\n        -- If the recorded vaso was D/C'd, this is an end time\n        when vaso_stopped = 1\n          then vaso_first\n\n        -- If the rate is zero, this is the end time\n        when vaso_rate = 0\n          then vaso_first\n\n        -- the last row in the table is always a potential end time\n        -- this captures patients who die/are discharged while on vasopressors\n        -- in principle, this could add an extra end time for the vasopressor\n        -- however, since we later group on vaso_start, any extra end times are ignored\n        when LEAD(CHARTTIME,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) is null\n          then vaso_first\n\n        else null\n        end as vaso_stop\n    from vasocv5 v\n)\n\n-- -- if you want to look at the results of the table before grouping:\n-- select\n--   icustay_id, charttime, vaso, vaso_rate, vaso_amount\n--     , case when vaso_stopped = 1 then 'Y' else '' end as stopped\n--     , vaso_start\n--     , vaso_first\n--     , vaso_stop\n-- from vasocv6 order by charttime\n\n\n, vasocv as\n(\n-- below groups together vasopressor administrations into groups\nselect\n  icustay_id\n  -- the first non-null rate is considered the starttime\n  , min(case when vaso_rate is not null then charttime else null end) as starttime\n  -- the *first* time the first/last flags agree is the stop time for this duration\n  , min(case when vaso_first = vaso_stop then charttime else null end) as endtime\nfrom vasocv6\nwhere\n  vaso_first is not null -- bogus data\nand\n  vaso_first != 0 -- sometimes *only* a rate of 0 appears, i.e. the drug is never actually delivered\nand\n  icustay_id is not null -- there are data for \"floating\" admissions, we don't worry about these\ngroup by icustay_id, vaso_first\nhaving -- ensure start time is not the same as end time\n min(charttime) != min(case when vaso_first = vaso_stop then charttime else null end)\nand\n  max(vaso_rate) > 0 -- if the rate was always 0 or null, we consider it not a real drug delivery\n)\n\n-- now we extract the associated data for metavision patients\n, vasomv as\n(\n  select\n    icustay_id, linkorderid\n    , min(starttime) as starttime, max(endtime) as endtime\n  FROM inputevents_mv\n  where itemid = 221986 -- milrinone\n  and statusdescription != 'Rewritten' -- only valid orders\n  group by icustay_id, linkorderid\n)\n\nselect\n  icustay_id\n  -- generate a sequential integer for convenience\n  , ROW_NUMBER() over (partition by icustay_id order by starttime) as vasonum\n  , starttime, endtime\n  , DATETIME_DIFF(endtime, starttime, 'HOUR') AS duration_hours\n  -- add durations\nfrom\n  vasocv\n\nUNION ALL\n\nselect\n  icustay_id\n  , ROW_NUMBER() over (partition by icustay_id order by starttime) as vasonum\n  , starttime, endtime\n  , DATETIME_DIFF(endtime, starttime, 'HOUR') AS duration_hours\n  -- add durations\nfrom\n  vasomv\n\norder by icustay_id, vasonum",
        "tables": [
            "mimiciii_clinical.inputevents_cv",
            "mimiciii_clinical.inputevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "vasonum": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "starttime": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "endtime": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "duration_hours": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ]
        },
        "table_name": "mimiciii_clinical.milrinone_durations",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "vasocv.icustay_id",
                "(row_number() OVER (?))",
                "vasocv.starttime",
                "vasocv.endtime",
                "(datetime_diff(vasocv.endtime, vasocv.starttime, 'HOUR'::text))"
            ],
            "Sort Key": [
                "vasocv.icustay_id",
                "(row_number() OVER (?))"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv1",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime",
                        "max(CASE WHEN (inputevents_cv.itemid = 30125) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = 30125) AND (((inputevents_cv.stopped)::text = 'Stopped'::text) OR ((inputevents_cv.stopped)::text ~~ 'D/C%'::text))) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = 30125) AND (inputevents_cv.rate IS NOT NULL)) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN (inputevents_cv.itemid = 30125) THEN inputevents_cv.rate ELSE NULL::double precision END)",
                        "max(CASE WHEN (inputevents_cv.itemid = 30125) THEN inputevents_cv.amount ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime",
                                "inputevents_cv.itemid",
                                "inputevents_cv.stopped",
                                "inputevents_cv.rate",
                                "inputevents_cv.amount"
                            ],
                            "Sort Key": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "inputevents_cv",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "inputevents_cv",
                                    "Output": [
                                        "inputevents_cv.icustay_id",
                                        "inputevents_cv.charttime",
                                        "inputevents_cv.itemid",
                                        "inputevents_cv.stopped",
                                        "inputevents_cv.rate",
                                        "inputevents_cv.amount"
                                    ],
                                    "Recheck Cond": "(inputevents_cv.itemid = 30125)",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "inputevents_cv_idx05",
                                            "Index Cond": "(inputevents_cv.itemid = 30125)"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv2",
                    "Parallel Aware": false,
                    "Output": [
                        "v.icustay_id",
                        "v.charttime",
                        "v.vaso",
                        "v.vaso_stopped",
                        "v.vaso_null",
                        "v.vaso_rate",
                        "v.vaso_amount",
                        "sum(v.vaso_null) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v.icustay_id",
                                "v.charttime",
                                "v.vaso",
                                "v.vaso_stopped",
                                "v.vaso_null",
                                "v.vaso_rate",
                                "v.vaso_amount"
                            ],
                            "Sort Key": [
                                "v.icustay_id",
                                "v.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv1",
                                    "Alias": "v",
                                    "Output": [
                                        "v.icustay_id",
                                        "v.charttime",
                                        "v.vaso",
                                        "v.vaso_stopped",
                                        "v.vaso_null",
                                        "v.vaso_rate",
                                        "v.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv3",
                    "Parallel Aware": false,
                    "Output": [
                        "v_1.icustay_id",
                        "v_1.charttime",
                        "v_1.vaso",
                        "v_1.vaso_stopped",
                        "v_1.vaso_null",
                        "v_1.vaso_rate",
                        "v_1.vaso_amount",
                        "v_1.vaso_partition",
                        "first_value(v_1.vaso_rate) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_1.icustay_id",
                                "v_1.charttime",
                                "v_1.vaso_partition",
                                "v_1.vaso",
                                "v_1.vaso_stopped",
                                "v_1.vaso_null",
                                "v_1.vaso_rate",
                                "v_1.vaso_amount"
                            ],
                            "Sort Key": [
                                "v_1.icustay_id",
                                "v_1.vaso_partition",
                                "v_1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv2",
                                    "Alias": "v_1",
                                    "Output": [
                                        "v_1.icustay_id",
                                        "v_1.charttime",
                                        "v_1.vaso_partition",
                                        "v_1.vaso",
                                        "v_1.vaso_stopped",
                                        "v_1.vaso_null",
                                        "v_1.vaso_rate",
                                        "v_1.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv4",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv3.icustay_id",
                        "vasocv3.charttime",
                        "vasocv3.vaso",
                        "vasocv3.vaso_rate",
                        "vasocv3.vaso_amount",
                        "vasocv3.vaso_stopped",
                        "vasocv3.vaso_prevrate_ifnull",
                        "CASE WHEN (vasocv3.vaso = 0) THEN NULL::integer WHEN ((vasocv3.vaso_rate > '0'::double precision) AND ((lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)) IS NULL)) THEN 1 WHEN ((vasocv3.vaso_rate = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN ((vasocv3.vaso_prevrate_ifnull = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision) THEN 1 WHEN (lag(vasocv3.vaso_stopped, 1) OVER (?) = 1) THEN 1 ELSE NULL::integer END",
                        "vasocv3.vaso_null"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv3.icustay_id",
                                "vasocv3.charttime",
                                "vasocv3.vaso",
                                "vasocv3.vaso_null",
                                "vasocv3.vaso_rate",
                                "vasocv3.vaso_amount",
                                "vasocv3.vaso_stopped",
                                "vasocv3.vaso_prevrate_ifnull",
                                "(lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?))"
                            ],
                            "Sort Key": [
                                "vasocv3.icustay_id",
                                "vasocv3.vaso",
                                "vasocv3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "WindowAgg",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv3.icustay_id",
                                        "vasocv3.charttime",
                                        "vasocv3.vaso",
                                        "vasocv3.vaso_null",
                                        "vasocv3.vaso_rate",
                                        "vasocv3.vaso_amount",
                                        "vasocv3.vaso_stopped",
                                        "vasocv3.vaso_prevrate_ifnull",
                                        "lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.charttime",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.vaso_rate",
                                                "vasocv3.vaso_amount",
                                                "vasocv3.vaso_stopped",
                                                "vasocv3.vaso_prevrate_ifnull"
                                            ],
                                            "Sort Key": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "vasocv3",
                                                    "Alias": "vasocv3",
                                                    "Output": [
                                                        "vasocv3.icustay_id",
                                                        "vasocv3.charttime",
                                                        "vasocv3.vaso",
                                                        "vasocv3.vaso_null",
                                                        "vasocv3.vaso_rate",
                                                        "vasocv3.vaso_amount",
                                                        "vasocv3.vaso_stopped",
                                                        "vasocv3.vaso_prevrate_ifnull"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv5",
                    "Parallel Aware": false,
                    "Output": [
                        "v_2.icustay_id",
                        "v_2.charttime",
                        "v_2.vaso",
                        "v_2.vaso_rate",
                        "v_2.vaso_amount",
                        "v_2.vaso_stopped",
                        "v_2.vaso_prevrate_ifnull",
                        "v_2.vaso_start",
                        "sum(v_2.vaso_start) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_2.icustay_id",
                                "v_2.charttime",
                                "v_2.vaso",
                                "v_2.vaso_rate",
                                "v_2.vaso_amount",
                                "v_2.vaso_stopped",
                                "v_2.vaso_prevrate_ifnull",
                                "v_2.vaso_start"
                            ],
                            "Sort Key": [
                                "v_2.icustay_id",
                                "v_2.vaso",
                                "v_2.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv4",
                                    "Alias": "v_2",
                                    "Output": [
                                        "v_2.icustay_id",
                                        "v_2.charttime",
                                        "v_2.vaso",
                                        "v_2.vaso_rate",
                                        "v_2.vaso_amount",
                                        "v_2.vaso_stopped",
                                        "v_2.vaso_prevrate_ifnull",
                                        "v_2.vaso_start"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv6",
                    "Parallel Aware": false,
                    "Output": [
                        "v_3.icustay_id",
                        "v_3.charttime",
                        "v_3.vaso",
                        "v_3.vaso_rate",
                        "v_3.vaso_amount",
                        "v_3.vaso_stopped",
                        "v_3.vaso_prevrate_ifnull",
                        "v_3.vaso_start",
                        "v_3.vaso_first",
                        "CASE WHEN (v_3.vaso = 0) THEN NULL::bigint WHEN (v_3.vaso_stopped = 1) THEN v_3.vaso_first WHEN (v_3.vaso_rate = '0'::double precision) THEN v_3.vaso_first WHEN (lead(v_3.charttime, 1) OVER (?) IS NULL) THEN v_3.vaso_first ELSE NULL::bigint END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_3.icustay_id",
                                "v_3.charttime",
                                "v_3.vaso",
                                "v_3.vaso_rate",
                                "v_3.vaso_amount",
                                "v_3.vaso_stopped",
                                "v_3.vaso_prevrate_ifnull",
                                "v_3.vaso_start",
                                "v_3.vaso_first"
                            ],
                            "Sort Key": [
                                "v_3.icustay_id",
                                "v_3.vaso",
                                "v_3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv5",
                                    "Alias": "v_3",
                                    "Output": [
                                        "v_3.icustay_id",
                                        "v_3.charttime",
                                        "v_3.vaso",
                                        "v_3.vaso_rate",
                                        "v_3.vaso_amount",
                                        "v_3.vaso_stopped",
                                        "v_3.vaso_prevrate_ifnull",
                                        "v_3.vaso_start",
                                        "v_3.vaso_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv6.icustay_id",
                        "min(CASE WHEN (vasocv6.vaso_rate IS NOT NULL) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)",
                        "min(CASE WHEN (vasocv6.vaso_first = vasocv6.vaso_stop) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)",
                        "vasocv6.vaso_first"
                    ],
                    "Group Key": [
                        "vasocv6.icustay_id",
                        "vasocv6.vaso_first"
                    ],
                    "Filter": "((min(vasocv6.charttime) <> min(CASE WHEN (vasocv6.vaso_first = vasocv6.vaso_stop) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)) AND (max(vasocv6.vaso_rate) > '0'::double precision))",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "vasocv6",
                            "Alias": "vasocv6",
                            "Output": [
                                "vasocv6.icustay_id",
                                "vasocv6.charttime",
                                "vasocv6.vaso",
                                "vasocv6.vaso_rate",
                                "vasocv6.vaso_amount",
                                "vasocv6.vaso_stopped",
                                "vasocv6.vaso_prevrate_ifnull",
                                "vasocv6.vaso_start",
                                "vasocv6.vaso_first",
                                "vasocv6.vaso_stop"
                            ],
                            "Filter": "((vasocv6.vaso_first IS NOT NULL) AND (vasocv6.icustay_id IS NOT NULL) AND (vasocv6.vaso_first <> 0))"
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasomv",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid",
                        "min(inputevents_mv.starttime)",
                        "max(inputevents_mv.endtime)"
                    ],
                    "Group Key": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Bitmap Heap Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "inputevents_mv",
                            "Schema": "mimiciii_clinical",
                            "Alias": "inputevents_mv",
                            "Output": [
                                "inputevents_mv.row_id",
                                "inputevents_mv.subject_id",
                                "inputevents_mv.hadm_id",
                                "inputevents_mv.icustay_id",
                                "inputevents_mv.starttime",
                                "inputevents_mv.endtime",
                                "inputevents_mv.itemid",
                                "inputevents_mv.amount",
                                "inputevents_mv.amountuom",
                                "inputevents_mv.rate",
                                "inputevents_mv.rateuom",
                                "inputevents_mv.storetime",
                                "inputevents_mv.cgid",
                                "inputevents_mv.orderid",
                                "inputevents_mv.linkorderid",
                                "inputevents_mv.ordercategoryname",
                                "inputevents_mv.secondaryordercategoryname",
                                "inputevents_mv.ordercomponenttypedescription",
                                "inputevents_mv.ordercategorydescription",
                                "inputevents_mv.patientweight",
                                "inputevents_mv.totalamount",
                                "inputevents_mv.totalamountuom",
                                "inputevents_mv.isopenbag",
                                "inputevents_mv.continueinnextdept",
                                "inputevents_mv.cancelreason",
                                "inputevents_mv.statusdescription",
                                "inputevents_mv.comments_editedby",
                                "inputevents_mv.comments_canceledby",
                                "inputevents_mv.comments_date",
                                "inputevents_mv.originalamount",
                                "inputevents_mv.originalrate"
                            ],
                            "Recheck Cond": "(inputevents_mv.itemid = 221986)",
                            "Filter": "((inputevents_mv.statusdescription)::text <> 'Rewritten'::text)",
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Index Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Index Name": "inputevents_mv_idx05",
                                    "Index Cond": "(inputevents_mv.itemid = 221986)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv.icustay_id",
                                "row_number() OVER (?)",
                                "vasocv.starttime",
                                "vasocv.endtime",
                                "datetime_diff(vasocv.endtime, vasocv.starttime, 'HOUR'::text)"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv.icustay_id",
                                        "vasocv.starttime",
                                        "vasocv.endtime"
                                    ],
                                    "Sort Key": [
                                        "vasocv.icustay_id",
                                        "vasocv.starttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "vasocv",
                                            "Alias": "vasocv",
                                            "Output": [
                                                "vasocv.icustay_id",
                                                "vasocv.starttime",
                                                "vasocv.endtime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "vasomv.icustay_id",
                                "row_number() OVER (?)",
                                "vasomv.starttime",
                                "vasomv.endtime",
                                "datetime_diff(vasomv.endtime, vasomv.starttime, 'HOUR'::text)"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasomv.icustay_id",
                                        "vasomv.starttime",
                                        "vasomv.endtime"
                                    ],
                                    "Sort Key": [
                                        "vasomv.icustay_id",
                                        "vasomv.starttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "vasomv",
                                            "Alias": "vasomv",
                                            "Output": [
                                                "vasomv.icustay_id",
                                                "vasomv.starttime",
                                                "vasomv.endtime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.neuroblock_dose": {
        "sql": "-- This query extracts dose+durations of neuromuscular blocking agents\n-- Note: we assume that injections will be filtered for carevue as they will have starttime = stopttime.\n\n-- Get drug administration data from CareVue and MetaVision\n-- metavision is simple and only requires one temporary table\n\nwith drugmv as\n(\n  select\n      icustay_id, orderid\n    , rate as drug_rate\n    , amount as drug_amount\n    , starttime\n    , endtime\n  from inputevents_mv\n  where itemid in\n  (\n      222062 -- Vecuronium (664 rows, 154 infusion rows)\n    , 221555 -- Cisatracurium (9334 rows, 8970 infusion rows)\n  )\n  and statusdescription != 'Rewritten' -- only valid orders\n  and rate is not null -- only continuous infusions\n)\n, drugcv1 as\n(\n  select\n    icustay_id, charttime\n    -- where clause below ensures all rows are instance of the drug\n    , 1 as drug\n\n    -- the 'stopped' column indicates if a drug has been disconnected\n    , max(case when stopped in ('Stopped','D/C''d') then 1 else 0 end) as drug_stopped\n\n    -- we only include continuous infusions, therefore expect a rate\n    , max(case\n            -- for \"free form\" entries (itemid >= 40000) rate is not available\n            when itemid >= 40000 and amount is not null then 1\n            when itemid <  40000 and rate is not null then 1\n          else 0 end) as drug_null\n    , max(case\n            -- for \"free form\" entries (itemid >= 40000) rate is not available\n            when itemid >= 40000 then coalesce(rate, amount)\n          else rate end) as drug_rate\n    , max(amount) as drug_amount\n  from inputevents_cv\n  where itemid in\n  (\n      30114 -- Cisatracurium (63994 rows)\n    , 30138\t-- Vecuronium\t (5160 rows)\n    , 30113 -- Atracurium  (1163 rows)\n    -- Below rows are less frequent ad-hoc documentation, but worth including!\n    , 42174\t-- nimbex cc/hr (207 rows)\n    , 42385\t-- Cisatracurium gtt (156 rows)\n    , 41916\t-- NIMBEX\tinputevents_cv (136 rows)\n    , 42100\t-- cistatracurium\t(132 rows)\n    , 42045\t-- nimbex mcg/kg/min (78 rows)\n    , 42246 -- CISATRICARIUM CC/HR (70 rows)\n    , 42291\t-- NIMBEX CC/HR (48 rows)\n    , 42590\t-- nimbex\tinputevents_cv (38 rows)\n    , 42284\t-- CISATRACURIUM DRIP (9 rows)\n    , 45096\t-- Vecuronium drip (2 rows)\n  )\n  group by icustay_id, charttime\n  UNION\n  -- add data from chartevents\n  select\n    icustay_id, charttime\n    -- where clause below ensures all rows are instance of the drug\n    , 1 as drug\n\n    -- the 'stopped' column indicates if a drug has been disconnected\n    , max(case when stopped in ('Stopped','D/C''d') then 1 else 0 end) as drug_stopped\n    , max(case when valuenum <= 10 then 0 else 1 end) as drug_null\n\n    -- educated guess!\n    , max(case when valuenum <= 10 then valuenum else null end) as drug_rate\n    , max(case when valuenum  > 10 then valuenum else null end) as drug_amount\n  from chartevents\n  where itemid in\n  (\n      1856 -- Vecuronium mcg/min  (8 rows)\n    , 2164 -- NIMBEX MG/KG/HR  (243 rows)\n    , 2548 -- nimbex mg/kg/hr  (103 rows)\n    , 2285 -- nimbex mcg/kg/min  (85 rows)\n    , 2290 -- nimbex mcg/kg/m  (32 rows)\n    , 2670 -- nimbex  (38 rows)\n    , 2546 -- CISATRACURIUMMG/KG/H  (7 rows)\n    , 1098 -- cisatracurium mg/kg  (36 rows)\n    , 2390 -- cisatracurium mg/hr  (15 rows)\n    , 2511 -- CISATRACURIUM GTT  (4 rows)\n    , 1028 -- Cisatracurium  (208 rows)\n    , 1858 -- cisatracurium  (351 rows)\n  )\n  group by icustay_id, charttime\n\n)\n, drugcv2 as\n(\n  select v.*\n    , sum(drug_null) over (partition by icustay_id order by charttime) as drug_partition\n  from\n    drugcv1 v\n)\n, drugcv3 as\n(\n  select v.*\n    , first_value(drug_rate) over (partition by icustay_id, drug_partition order by charttime) as drug_prevrate_ifnull\n  from\n    drugcv2 v\n)\n, drugcv4 as\n(\nselect\n    icustay_id\n    , charttime\n    -- , (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, drug order by charttime))) AS delta\n\n    , drug\n    , drug_rate\n    , drug_amount\n    , drug_stopped\n    , drug_prevrate_ifnull\n\n    -- We define start time here\n    , case\n        when drug = 0 then null\n\n        -- if this is the first instance of the drug\n        when drug_rate > 0 and\n          LAG(drug_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, drug, drug_null\n          order by charttime\n          )\n          is null\n          then 1\n\n        -- you often get a string of 0s\n        -- we decide not to set these as 1, just because it makes drugnum sequential\n        when drug_rate = 0 and\n          LAG(drug_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, drug\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- sometimes you get a string of NULL, associated with 0 volumes\n        -- same reason as before, we decide not to set these as 1\n        -- drug_prevrate_ifnull is equal to the previous value *iff* the current value is null\n        when drug_prevrate_ifnull = 0 and\n          LAG(drug_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, drug\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- If the last recorded rate was 0, newdrug = 1\n        when LAG(drug_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, drug\n          order by charttime\n          ) = 0\n          then 1\n\n        -- If the last recorded drug was D/C'd, newdrug = 1\n        when\n          LAG(drug_stopped,1)\n          OVER\n          (\n          partition by icustay_id, drug\n          order by charttime\n          )\n          = 1 then 1\n\n        when (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, drug order by charttime))) > (interval '8 hours') then 1\n      else null\n      end as drug_start\n\nFROM\n  drugcv3\n)\n-- propagate start/stop flags forward in time\n, drugcv5 as\n(\n  select v.*\n    , SUM(drug_start) OVER (partition by icustay_id, drug order by charttime) as drug_first\nFROM\n  drugcv4 v\n)\n, drugcv6 as\n(\n  select v.*\n    -- We define end time here\n    , case\n        when drug = 0\n          then null\n\n        -- If the recorded drug was D/C'd, this is an end time\n        when drug_stopped = 1\n          then drug_first\n\n        -- If the rate is zero, this is the end time\n        when drug_rate = 0\n          then drug_first\n\n        -- the last row in the table is always a potential end time\n        -- this captures patients who die/are discharged while on drug\n        -- in principle, this could add an extra end time for the drug\n        -- however, since we later group on drug_start, any extra end times are ignored\n        when LEAD(CHARTTIME,1)\n          OVER\n          (\n          partition by icustay_id, drug\n          order by charttime\n          ) is null\n          then drug_first\n\n        else null\n        end as drug_stop\n    from drugcv5 v\n)\n\n-- -- if you want to look at the results of the table before grouping:\n-- select\n--   icustay_id, charttime, drug, drug_rate, drug_amount\n--     , drug_stopped\n--     , drug_start\n--     , drug_first\n--     , drug_stop\n-- from drugcv6 order by icustay_id, charttime\n\n, drugcv7 as\n(\nselect\n  icustay_id\n  , charttime as starttime\n  , lead(charttime) OVER (partition by icustay_id, drug_first order by charttime) as endtime\n  , drug, drug_rate, drug_amount, drug_stop, drug_start, drug_first\nfrom drugcv6\nwhere\n  drug_first is not null -- bogus data\nand\n  drug_first != 0 -- sometimes *only* a rate of 0 appears, i.e. the drug is never actually delivered\nand\n  icustay_id is not null -- there are data for \"floating\" admissions, we don't worry about these\n)\n-- table of start/stop times for event\n, drugcv8 as\n(\n  select\n    icustay_id\n    , starttime, endtime\n    , drug, drug_rate, drug_amount, drug_stop, drug_start, drug_first\n  from drugcv7\n  where endtime is not null\n  and drug_rate > 0\n  and starttime != endtime\n)\n-- collapse these start/stop times down if the rate doesn't change\n, drugcv9 as\n(\n  select\n    icustay_id\n    , starttime, endtime\n    , case\n        when LAG(endtime) OVER (partition by icustay_id order by starttime, endtime) = starttime\n        AND  LAG(drug_rate) OVER (partition by icustay_id order by starttime, endtime) = drug_rate\n        THEN 0\n      else 1\n    end as drug_groups\n    , drug, drug_rate, drug_amount, drug_stop, drug_start, drug_first\n  from drugcv8\n  where endtime is not null\n  and drug_rate > 0\n  and starttime != endtime\n)\n, drugcv10 as\n(\n  select\n    icustay_id\n    , starttime, endtime\n    , drug_groups\n    , SUM(drug_groups) OVER (partition by icustay_id order by starttime, endtime) as drug_groups_sum\n    , drug, drug_rate, drug_amount, drug_stop, drug_start, drug_first\n  from drugcv9\n)\n, drugcv as\n(\n  select icustay_id\n  , min(starttime) as starttime\n  , max(endtime) as endtime\n  , drug_groups_sum\n  , drug_rate\n  , sum(drug_amount) as drug_amount\n  from drugcv10\n  group by icustay_id, drug_groups_sum, drug_rate\n)\n-- now assign this data to every hour of the patient's stay\n-- drug_amount for carevue is not accurate\nSELECT icustay_id\n  , starttime, endtime\n  , drug_rate, drug_amount\nfrom drugcv\nUNION\nSELECT icustay_id\n  , starttime, endtime\n  , drug_rate, drug_amount\nfrom drugmv\norder by icustay_id, starttime",
        "tables": [
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.inputevents_cv",
            "mimiciii_clinical.inputevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.stopped",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "starttime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.stopped",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "endtime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.stopped",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "drug_rate": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.stopped",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "drug_amount": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.stopped",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ]
        },
        "table_name": "mimiciii_clinical.neuroblock_dose",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "drugcv.icustay_id",
                "drugcv.starttime",
                "drugcv.endtime",
                "drugcv.drug_rate",
                "drugcv.drug_amount"
            ],
            "Sort Key": [
                "drugcv.icustay_id",
                "drugcv.starttime"
            ],
            "Plans": [
                {
                    "Node Type": "Bitmap Heap Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE drugmv",
                    "Parallel Aware": false,
                    "Relation Name": "inputevents_mv",
                    "Schema": "mimiciii_clinical",
                    "Alias": "inputevents_mv",
                    "Output": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.orderid",
                        "inputevents_mv.rate",
                        "inputevents_mv.amount",
                        "inputevents_mv.starttime",
                        "inputevents_mv.endtime"
                    ],
                    "Recheck Cond": "(inputevents_mv.itemid = ANY ('{222062,221555}'::integer[]))",
                    "Filter": "((inputevents_mv.rate IS NOT NULL) AND ((inputevents_mv.statusdescription)::text <> 'Rewritten'::text))",
                    "Plans": [
                        {
                            "Node Type": "Bitmap Index Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Index Name": "inputevents_mv_idx05",
                            "Index Cond": "(inputevents_mv.itemid = ANY ('{222062,221555}'::integer[]))"
                        }
                    ]
                },
                {
                    "Node Type": "Unique",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE drugcv1",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime",
                        "(1)",
                        "(max(CASE WHEN ((inputevents_cv.stopped)::text = ANY ('{Stopped,D/C''d}'::text[])) THEN 1 ELSE 0 END))",
                        "(max(CASE WHEN ((inputevents_cv.itemid >= 40000) AND (inputevents_cv.amount IS NOT NULL)) THEN 1 WHEN ((inputevents_cv.itemid < 40000) AND (inputevents_cv.rate IS NOT NULL)) THEN 1 ELSE 0 END))",
                        "(max(CASE WHEN (inputevents_cv.itemid >= 40000) THEN COALESCE(inputevents_cv.rate, inputevents_cv.amount) ELSE inputevents_cv.rate END))",
                        "(max(inputevents_cv.amount))"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime",
                                "(1)",
                                "(max(CASE WHEN ((inputevents_cv.stopped)::text = ANY ('{Stopped,D/C''d}'::text[])) THEN 1 ELSE 0 END))",
                                "(max(CASE WHEN ((inputevents_cv.itemid >= 40000) AND (inputevents_cv.amount IS NOT NULL)) THEN 1 WHEN ((inputevents_cv.itemid < 40000) AND (inputevents_cv.rate IS NOT NULL)) THEN 1 ELSE 0 END))",
                                "(max(CASE WHEN (inputevents_cv.itemid >= 40000) THEN COALESCE(inputevents_cv.rate, inputevents_cv.amount) ELSE inputevents_cv.rate END))",
                                "(max(inputevents_cv.amount))"
                            ],
                            "Sort Key": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime",
                                "(1)",
                                "(max(CASE WHEN ((inputevents_cv.stopped)::text = ANY ('{Stopped,D/C''d}'::text[])) THEN 1 ELSE 0 END))",
                                "(max(CASE WHEN ((inputevents_cv.itemid >= 40000) AND (inputevents_cv.amount IS NOT NULL)) THEN 1 WHEN ((inputevents_cv.itemid < 40000) AND (inputevents_cv.rate IS NOT NULL)) THEN 1 ELSE 0 END))",
                                "(max(CASE WHEN (inputevents_cv.itemid >= 40000) THEN COALESCE(inputevents_cv.rate, inputevents_cv.amount) ELSE inputevents_cv.rate END))",
                                "(max(inputevents_cv.amount))"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Append",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Plans": [
                                        {
                                            "Node Type": "Aggregate",
                                            "Strategy": "Sorted",
                                            "Partial Mode": "Simple",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "inputevents_cv.icustay_id",
                                                "inputevents_cv.charttime",
                                                "1",
                                                "max(CASE WHEN ((inputevents_cv.stopped)::text = ANY ('{Stopped,D/C''d}'::text[])) THEN 1 ELSE 0 END)",
                                                "max(CASE WHEN ((inputevents_cv.itemid >= 40000) AND (inputevents_cv.amount IS NOT NULL)) THEN 1 WHEN ((inputevents_cv.itemid < 40000) AND (inputevents_cv.rate IS NOT NULL)) THEN 1 ELSE 0 END)",
                                                "max(CASE WHEN (inputevents_cv.itemid >= 40000) THEN COALESCE(inputevents_cv.rate, inputevents_cv.amount) ELSE inputevents_cv.rate END)",
                                                "max(inputevents_cv.amount)"
                                            ],
                                            "Group Key": [
                                                "inputevents_cv.icustay_id",
                                                "inputevents_cv.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Sort",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Output": [
                                                        "inputevents_cv.icustay_id",
                                                        "inputevents_cv.charttime",
                                                        "inputevents_cv.stopped",
                                                        "inputevents_cv.itemid",
                                                        "inputevents_cv.amount",
                                                        "inputevents_cv.rate"
                                                    ],
                                                    "Sort Key": [
                                                        "inputevents_cv.icustay_id",
                                                        "inputevents_cv.charttime"
                                                    ],
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Bitmap Heap Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "inputevents_cv",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "inputevents_cv",
                                                            "Output": [
                                                                "inputevents_cv.icustay_id",
                                                                "inputevents_cv.charttime",
                                                                "inputevents_cv.stopped",
                                                                "inputevents_cv.itemid",
                                                                "inputevents_cv.amount",
                                                                "inputevents_cv.rate"
                                                            ],
                                                            "Recheck Cond": "(inputevents_cv.itemid = ANY ('{30114,30138,30113,42174,42385,41916,42100,42045,42246,42291,42590,42284,45096}'::integer[]))",
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Bitmap Index Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Index Name": "inputevents_cv_idx05",
                                                                    "Index Cond": "(inputevents_cv.itemid = ANY ('{30114,30138,30113,42174,42385,41916,42100,42045,42246,42291,42590,42284,45096}'::integer[]))"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Aggregate",
                                            "Strategy": "Hashed",
                                            "Partial Mode": "Simple",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "chartevents_90.icustay_id",
                                                "chartevents_90.charttime",
                                                "1",
                                                "max(CASE WHEN ((chartevents_90.stopped)::text = ANY ('{Stopped,D/C''d}'::text[])) THEN 1 ELSE 0 END)",
                                                "max(CASE WHEN (chartevents_90.valuenum <= '10'::double precision) THEN 0 ELSE 1 END)",
                                                "max(CASE WHEN (chartevents_90.valuenum <= '10'::double precision) THEN chartevents_90.valuenum ELSE NULL::double precision END)",
                                                "max(CASE WHEN (chartevents_90.valuenum > '10'::double precision) THEN chartevents_90.valuenum ELSE NULL::double precision END)"
                                            ],
                                            "Group Key": [
                                                "chartevents_90.icustay_id",
                                                "chartevents_90.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Append",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Bitmap Heap Scan",
                                                            "Parent Relationship": "Member",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "chartevents_90",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "chartevents_90",
                                                            "Output": [
                                                                "chartevents_90.icustay_id",
                                                                "chartevents_90.charttime",
                                                                "chartevents_90.stopped",
                                                                "chartevents_90.valuenum"
                                                            ],
                                                            "Recheck Cond": "(chartevents_90.itemid = ANY ('{1856,2164,2548,2285,2290,2670,2546,1098,2390,2511,1028,1858}'::integer[]))",
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Bitmap Index Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Index Name": "chartevents_90_idx01",
                                                                    "Index Cond": "(chartevents_90.itemid = ANY ('{1856,2164,2548,2285,2290,2670,2546,1098,2390,2511,1028,1858}'::integer[]))"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "Node Type": "Index Scan",
                                                            "Parent Relationship": "Member",
                                                            "Parallel Aware": false,
                                                            "Scan Direction": "Forward",
                                                            "Index Name": "chartevents_94_idx01",
                                                            "Relation Name": "chartevents_94",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "chartevents_94",
                                                            "Output": [
                                                                "chartevents_94.icustay_id",
                                                                "chartevents_94.charttime",
                                                                "chartevents_94.stopped",
                                                                "chartevents_94.valuenum"
                                                            ],
                                                            "Index Cond": "(chartevents_94.itemid = ANY ('{1856,2164,2548,2285,2290,2670,2546,1098,2390,2511,1028,1858}'::integer[]))"
                                                        },
                                                        {
                                                            "Node Type": "Bitmap Heap Scan",
                                                            "Parent Relationship": "Member",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "chartevents_103",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "chartevents_103",
                                                            "Output": [
                                                                "chartevents_103.icustay_id",
                                                                "chartevents_103.charttime",
                                                                "chartevents_103.stopped",
                                                                "chartevents_103.valuenum"
                                                            ],
                                                            "Recheck Cond": "(chartevents_103.itemid = ANY ('{1856,2164,2548,2285,2290,2670,2546,1098,2390,2511,1028,1858}'::integer[]))",
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Bitmap Index Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Index Name": "chartevents_103_idx01",
                                                                    "Index Cond": "(chartevents_103.itemid = ANY ('{1856,2164,2548,2285,2290,2670,2546,1098,2390,2511,1028,1858}'::integer[]))"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "Node Type": "Bitmap Heap Scan",
                                                            "Parent Relationship": "Member",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "chartevents_104",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "chartevents_104",
                                                            "Output": [
                                                                "chartevents_104.icustay_id",
                                                                "chartevents_104.charttime",
                                                                "chartevents_104.stopped",
                                                                "chartevents_104.valuenum"
                                                            ],
                                                            "Recheck Cond": "(chartevents_104.itemid = ANY ('{1856,2164,2548,2285,2290,2670,2546,1098,2390,2511,1028,1858}'::integer[]))",
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Bitmap Index Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Index Name": "chartevents_104_idx01",
                                                                    "Index Cond": "(chartevents_104.itemid = ANY ('{1856,2164,2548,2285,2290,2670,2546,1098,2390,2511,1028,1858}'::integer[]))"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE drugcv2",
                    "Parallel Aware": false,
                    "Output": [
                        "v.icustay_id",
                        "v.charttime",
                        "v.drug",
                        "v.drug_stopped",
                        "v.drug_null",
                        "v.drug_rate",
                        "v.drug_amount",
                        "sum(v.drug_null) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v.icustay_id",
                                "v.charttime",
                                "v.drug",
                                "v.drug_stopped",
                                "v.drug_null",
                                "v.drug_rate",
                                "v.drug_amount"
                            ],
                            "Sort Key": [
                                "v.icustay_id",
                                "v.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "drugcv1",
                                    "Alias": "v",
                                    "Output": [
                                        "v.icustay_id",
                                        "v.charttime",
                                        "v.drug",
                                        "v.drug_stopped",
                                        "v.drug_null",
                                        "v.drug_rate",
                                        "v.drug_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE drugcv3",
                    "Parallel Aware": false,
                    "Output": [
                        "v_1.icustay_id",
                        "v_1.charttime",
                        "v_1.drug",
                        "v_1.drug_stopped",
                        "v_1.drug_null",
                        "v_1.drug_rate",
                        "v_1.drug_amount",
                        "v_1.drug_partition",
                        "first_value(v_1.drug_rate) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_1.icustay_id",
                                "v_1.charttime",
                                "v_1.drug_partition",
                                "v_1.drug",
                                "v_1.drug_stopped",
                                "v_1.drug_null",
                                "v_1.drug_rate",
                                "v_1.drug_amount"
                            ],
                            "Sort Key": [
                                "v_1.icustay_id",
                                "v_1.drug_partition",
                                "v_1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "drugcv2",
                                    "Alias": "v_1",
                                    "Output": [
                                        "v_1.icustay_id",
                                        "v_1.charttime",
                                        "v_1.drug_partition",
                                        "v_1.drug",
                                        "v_1.drug_stopped",
                                        "v_1.drug_null",
                                        "v_1.drug_rate",
                                        "v_1.drug_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE drugcv4",
                    "Parallel Aware": false,
                    "Output": [
                        "drugcv3.icustay_id",
                        "drugcv3.charttime",
                        "drugcv3.drug",
                        "drugcv3.drug_rate",
                        "drugcv3.drug_amount",
                        "drugcv3.drug_stopped",
                        "drugcv3.drug_prevrate_ifnull",
                        "CASE WHEN (drugcv3.drug = 0) THEN NULL::integer WHEN ((drugcv3.drug_rate > '0'::double precision) AND ((lag(drugcv3.drug_prevrate_ifnull, 1) OVER (?)) IS NULL)) THEN 1 WHEN ((drugcv3.drug_rate = '0'::double precision) AND (lag(drugcv3.drug_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN ((drugcv3.drug_prevrate_ifnull = '0'::double precision) AND (lag(drugcv3.drug_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN (lag(drugcv3.drug_prevrate_ifnull, 1) OVER (?) = '0'::double precision) THEN 1 WHEN (lag(drugcv3.drug_stopped, 1) OVER (?) = 1) THEN 1 WHEN ((drugcv3.charttime - lag(drugcv3.charttime, 1) OVER (?)) > '08:00:00'::interval) THEN 1 ELSE NULL::integer END",
                        "drugcv3.drug_null"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "drugcv3.icustay_id",
                                "drugcv3.charttime",
                                "drugcv3.drug",
                                "drugcv3.drug_null",
                                "drugcv3.drug_rate",
                                "drugcv3.drug_amount",
                                "drugcv3.drug_stopped",
                                "drugcv3.drug_prevrate_ifnull",
                                "(lag(drugcv3.drug_prevrate_ifnull, 1) OVER (?))"
                            ],
                            "Sort Key": [
                                "drugcv3.icustay_id",
                                "drugcv3.drug",
                                "drugcv3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "WindowAgg",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "drugcv3.icustay_id",
                                        "drugcv3.charttime",
                                        "drugcv3.drug",
                                        "drugcv3.drug_null",
                                        "drugcv3.drug_rate",
                                        "drugcv3.drug_amount",
                                        "drugcv3.drug_stopped",
                                        "drugcv3.drug_prevrate_ifnull",
                                        "lag(drugcv3.drug_prevrate_ifnull, 1) OVER (?)"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "drugcv3.icustay_id",
                                                "drugcv3.charttime",
                                                "drugcv3.drug",
                                                "drugcv3.drug_null",
                                                "drugcv3.drug_rate",
                                                "drugcv3.drug_amount",
                                                "drugcv3.drug_stopped",
                                                "drugcv3.drug_prevrate_ifnull"
                                            ],
                                            "Sort Key": [
                                                "drugcv3.icustay_id",
                                                "drugcv3.drug",
                                                "drugcv3.drug_null",
                                                "drugcv3.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "drugcv3",
                                                    "Alias": "drugcv3",
                                                    "Output": [
                                                        "drugcv3.icustay_id",
                                                        "drugcv3.charttime",
                                                        "drugcv3.drug",
                                                        "drugcv3.drug_null",
                                                        "drugcv3.drug_rate",
                                                        "drugcv3.drug_amount",
                                                        "drugcv3.drug_stopped",
                                                        "drugcv3.drug_prevrate_ifnull"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE drugcv5",
                    "Parallel Aware": false,
                    "Output": [
                        "v_2.icustay_id",
                        "v_2.charttime",
                        "v_2.drug",
                        "v_2.drug_rate",
                        "v_2.drug_amount",
                        "v_2.drug_stopped",
                        "v_2.drug_prevrate_ifnull",
                        "v_2.drug_start",
                        "sum(v_2.drug_start) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_2.icustay_id",
                                "v_2.charttime",
                                "v_2.drug",
                                "v_2.drug_rate",
                                "v_2.drug_amount",
                                "v_2.drug_stopped",
                                "v_2.drug_prevrate_ifnull",
                                "v_2.drug_start"
                            ],
                            "Sort Key": [
                                "v_2.icustay_id",
                                "v_2.drug",
                                "v_2.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "drugcv4",
                                    "Alias": "v_2",
                                    "Output": [
                                        "v_2.icustay_id",
                                        "v_2.charttime",
                                        "v_2.drug",
                                        "v_2.drug_rate",
                                        "v_2.drug_amount",
                                        "v_2.drug_stopped",
                                        "v_2.drug_prevrate_ifnull",
                                        "v_2.drug_start"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE drugcv6",
                    "Parallel Aware": false,
                    "Output": [
                        "v_3.icustay_id",
                        "v_3.charttime",
                        "v_3.drug",
                        "v_3.drug_rate",
                        "v_3.drug_amount",
                        "v_3.drug_stopped",
                        "v_3.drug_prevrate_ifnull",
                        "v_3.drug_start",
                        "v_3.drug_first",
                        "CASE WHEN (v_3.drug = 0) THEN NULL::bigint WHEN (v_3.drug_stopped = 1) THEN v_3.drug_first WHEN (v_3.drug_rate = '0'::double precision) THEN v_3.drug_first WHEN (lead(v_3.charttime, 1) OVER (?) IS NULL) THEN v_3.drug_first ELSE NULL::bigint END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_3.icustay_id",
                                "v_3.charttime",
                                "v_3.drug",
                                "v_3.drug_rate",
                                "v_3.drug_amount",
                                "v_3.drug_stopped",
                                "v_3.drug_prevrate_ifnull",
                                "v_3.drug_start",
                                "v_3.drug_first"
                            ],
                            "Sort Key": [
                                "v_3.icustay_id",
                                "v_3.drug",
                                "v_3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "drugcv5",
                                    "Alias": "v_3",
                                    "Output": [
                                        "v_3.icustay_id",
                                        "v_3.charttime",
                                        "v_3.drug",
                                        "v_3.drug_rate",
                                        "v_3.drug_amount",
                                        "v_3.drug_stopped",
                                        "v_3.drug_prevrate_ifnull",
                                        "v_3.drug_start",
                                        "v_3.drug_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE drugcv7",
                    "Parallel Aware": false,
                    "Output": [
                        "drugcv6.icustay_id",
                        "drugcv6.charttime",
                        "lead(drugcv6.charttime) OVER (?)",
                        "drugcv6.drug",
                        "drugcv6.drug_rate",
                        "drugcv6.drug_amount",
                        "drugcv6.drug_stop",
                        "drugcv6.drug_start",
                        "drugcv6.drug_first"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "drugcv6.icustay_id",
                                "drugcv6.charttime",
                                "drugcv6.drug_first",
                                "drugcv6.drug",
                                "drugcv6.drug_rate",
                                "drugcv6.drug_amount",
                                "drugcv6.drug_stop",
                                "drugcv6.drug_start"
                            ],
                            "Sort Key": [
                                "drugcv6.icustay_id",
                                "drugcv6.drug_first",
                                "drugcv6.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "drugcv6",
                                    "Alias": "drugcv6",
                                    "Output": [
                                        "drugcv6.icustay_id",
                                        "drugcv6.charttime",
                                        "drugcv6.drug_first",
                                        "drugcv6.drug",
                                        "drugcv6.drug_rate",
                                        "drugcv6.drug_amount",
                                        "drugcv6.drug_stop",
                                        "drugcv6.drug_start"
                                    ],
                                    "Filter": "((drugcv6.drug_first IS NOT NULL) AND (drugcv6.icustay_id IS NOT NULL) AND (drugcv6.drug_first <> 0))"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE drugcv8",
                    "Parallel Aware": false,
                    "CTE Name": "drugcv7",
                    "Alias": "drugcv7",
                    "Output": [
                        "drugcv7.icustay_id",
                        "drugcv7.starttime",
                        "drugcv7.endtime",
                        "drugcv7.drug",
                        "drugcv7.drug_rate",
                        "drugcv7.drug_amount",
                        "drugcv7.drug_stop",
                        "drugcv7.drug_start",
                        "drugcv7.drug_first"
                    ],
                    "Filter": "((drugcv7.endtime IS NOT NULL) AND (drugcv7.drug_rate > '0'::double precision) AND (drugcv7.starttime <> drugcv7.endtime))"
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE drugcv9",
                    "Parallel Aware": false,
                    "Output": [
                        "drugcv8.icustay_id",
                        "drugcv8.starttime",
                        "drugcv8.endtime",
                        "CASE WHEN ((lag(drugcv8.endtime) OVER (?) = drugcv8.starttime) AND (lag(drugcv8.drug_rate) OVER (?) = drugcv8.drug_rate)) THEN 0 ELSE 1 END",
                        "drugcv8.drug",
                        "drugcv8.drug_rate",
                        "drugcv8.drug_amount",
                        "drugcv8.drug_stop",
                        "drugcv8.drug_start",
                        "drugcv8.drug_first"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "drugcv8.icustay_id",
                                "drugcv8.starttime",
                                "drugcv8.endtime",
                                "drugcv8.drug_rate",
                                "drugcv8.drug",
                                "drugcv8.drug_amount",
                                "drugcv8.drug_stop",
                                "drugcv8.drug_start",
                                "drugcv8.drug_first"
                            ],
                            "Sort Key": [
                                "drugcv8.icustay_id",
                                "drugcv8.starttime",
                                "drugcv8.endtime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "drugcv8",
                                    "Alias": "drugcv8",
                                    "Output": [
                                        "drugcv8.icustay_id",
                                        "drugcv8.starttime",
                                        "drugcv8.endtime",
                                        "drugcv8.drug_rate",
                                        "drugcv8.drug",
                                        "drugcv8.drug_amount",
                                        "drugcv8.drug_stop",
                                        "drugcv8.drug_start",
                                        "drugcv8.drug_first"
                                    ],
                                    "Filter": "((drugcv8.endtime IS NOT NULL) AND (drugcv8.drug_rate > '0'::double precision) AND (drugcv8.starttime <> drugcv8.endtime))"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE drugcv10",
                    "Parallel Aware": false,
                    "Output": [
                        "drugcv9.icustay_id",
                        "drugcv9.starttime",
                        "drugcv9.endtime",
                        "drugcv9.drug_groups",
                        "sum(drugcv9.drug_groups) OVER (?)",
                        "drugcv9.drug",
                        "drugcv9.drug_rate",
                        "drugcv9.drug_amount",
                        "drugcv9.drug_stop",
                        "drugcv9.drug_start",
                        "drugcv9.drug_first"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "drugcv9.icustay_id",
                                "drugcv9.starttime",
                                "drugcv9.endtime",
                                "drugcv9.drug_groups",
                                "drugcv9.drug",
                                "drugcv9.drug_rate",
                                "drugcv9.drug_amount",
                                "drugcv9.drug_stop",
                                "drugcv9.drug_start",
                                "drugcv9.drug_first"
                            ],
                            "Sort Key": [
                                "drugcv9.icustay_id",
                                "drugcv9.starttime",
                                "drugcv9.endtime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "drugcv9",
                                    "Alias": "drugcv9",
                                    "Output": [
                                        "drugcv9.icustay_id",
                                        "drugcv9.starttime",
                                        "drugcv9.endtime",
                                        "drugcv9.drug_groups",
                                        "drugcv9.drug",
                                        "drugcv9.drug_rate",
                                        "drugcv9.drug_amount",
                                        "drugcv9.drug_stop",
                                        "drugcv9.drug_start",
                                        "drugcv9.drug_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE drugcv",
                    "Parallel Aware": false,
                    "Output": [
                        "drugcv10.icustay_id",
                        "min(drugcv10.starttime)",
                        "max(drugcv10.endtime)",
                        "drugcv10.drug_groups_sum",
                        "drugcv10.drug_rate",
                        "sum(drugcv10.drug_amount)"
                    ],
                    "Group Key": [
                        "drugcv10.icustay_id",
                        "drugcv10.drug_groups_sum",
                        "drugcv10.drug_rate"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "drugcv10",
                            "Alias": "drugcv10",
                            "Output": [
                                "drugcv10.icustay_id",
                                "drugcv10.starttime",
                                "drugcv10.endtime",
                                "drugcv10.drug_groups",
                                "drugcv10.drug_groups_sum",
                                "drugcv10.drug",
                                "drugcv10.drug_rate",
                                "drugcv10.drug_amount",
                                "drugcv10.drug_stop",
                                "drugcv10.drug_start",
                                "drugcv10.drug_first"
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "drugcv.icustay_id",
                        "drugcv.starttime",
                        "drugcv.endtime",
                        "drugcv.drug_rate",
                        "drugcv.drug_amount"
                    ],
                    "Group Key": [
                        "drugcv.icustay_id",
                        "drugcv.starttime",
                        "drugcv.endtime",
                        "drugcv.drug_rate",
                        "drugcv.drug_amount"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Append",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "CTE Name": "drugcv",
                                    "Alias": "drugcv",
                                    "Output": [
                                        "drugcv.icustay_id",
                                        "drugcv.starttime",
                                        "drugcv.endtime",
                                        "drugcv.drug_rate",
                                        "drugcv.drug_amount"
                                    ]
                                },
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "CTE Name": "drugmv",
                                    "Alias": "drugmv",
                                    "Output": [
                                        "drugmv.icustay_id",
                                        "drugmv.starttime",
                                        "drugmv.endtime",
                                        "drugmv.drug_rate",
                                        "drugmv.drug_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.norepinephrine_dose": {
        "sql": "-- This query extracts dose+durations of norepinephrine administration\n-- Total time on the drug can be calculated from this table by grouping using ICUSTAY_ID\n\n-- Get drug administration data from CareVue first\nwith vasocv1 as\n(\n  select\n    cv.icustay_id, cv.charttime\n    -- case statement determining whether the ITEMID is an instance of vasopressor usage\n    , max(case when itemid in (30047,30120) then 1 else 0 end) as vaso -- norepinephrine\n\n    -- the 'stopped' column indicates if a vasopressor has been disconnected\n    , max(case when itemid in (30047,30120) and (stopped = 'Stopped' OR stopped like 'D/C%') then 1\n          else 0 end) as vaso_stopped\n\n  -- case statement determining whether the ITEMID is an instance of vasopressor usage\n\n    , max(case when itemid in (30047,30120) and rate is not null then 1 else 0 end) as vaso_null\n    , max(case\n            when itemid = 30047 and wd.weight is null then rate / 80.0 -- this is rare, only affects a total of ~400 rows\n            when itemid = 30047 then rate / wd.weight -- measured in mcgmin\n            when itemid = 30120 then rate -- measured in mcgkgmin ** there are clear errors, perhaps actually mcgmin\n          else null end) as vaso_rate\n    , max(case when itemid in (30047,30120) then amount else null end) as vaso_amount\n\n  FROM inputevents_cv cv\n  left join \"mimic\".\"mimiciii_clinical\".\"weight_durations\" wd\n    on cv.icustay_id = wd.icustay_id\n    and cv.charttime between wd.starttime and wd.endtime\n  where itemid in (30047,30120) -- norepinephrine\n  and cv.icustay_id is not null\n  group by cv.icustay_id, cv.charttime\n)\n, vasocv2 as\n(\n  select v.*\n    , sum(vaso_null) over (partition by icustay_id order by charttime) as vaso_partition\n  from\n    vasocv1 v\n)\n, vasocv3 as\n(\n  select v.*\n    , first_value(vaso_rate) over (partition by icustay_id, vaso_partition order by charttime) as vaso_prevrate_ifnull\n  from\n    vasocv2 v\n)\n, vasocv4 as\n(\nselect\n    icustay_id\n    , charttime\n    -- , (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) AS delta\n\n    , vaso\n    , vaso_rate\n    , vaso_amount\n    , vaso_stopped\n    , vaso_prevrate_ifnull\n\n    -- We define start time here\n    , case\n        when vaso = 0 then null\n\n        -- if this is the first instance of the vasoactive drug\n        when vaso_rate > 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso, vaso_null\n          order by charttime\n          )\n          is null\n          then 1\n\n        -- you often get a string of 0s\n        -- we decide not to set these as 1, just because it makes vasonum sequential\n        when vaso_rate = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- sometimes you get a string of NULL, associated with 0 volumes\n        -- same reason as before, we decide not to set these as 1\n        -- vaso_prevrate_ifnull is equal to the previous value *iff* the current value is null\n        when vaso_prevrate_ifnull = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- If the last recorded rate was 0, newvaso = 1\n        when LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) = 0\n          then 1\n\n        -- If the last recorded vaso was D/C'd, newvaso = 1\n        when\n          LAG(vaso_stopped,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 1 then 1\n\n        -- ** not sure if the below is needed\n        --when (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) > (interval '4 hours') then 1\n      else null\n      end as vaso_start\n\nFROM\n  vasocv3\n)\n-- propagate start/stop flags forward in time\n, vasocv5 as\n(\n  select v.*\n    , SUM(vaso_start) OVER (partition by icustay_id, vaso order by charttime) as vaso_first\nFROM\n  vasocv4 v\n)\n, vasocv6 as\n(\n  select v.*\n    -- We define end time here\n    , case\n        when vaso = 0\n          then null\n\n        -- If the recorded vaso was D/C'd, this is an end time\n        when vaso_stopped = 1\n          then vaso_first\n\n        -- If the rate is zero, this is the end time\n        when vaso_rate = 0\n          then vaso_first\n\n        -- the last row in the table is always a potential end time\n        -- this captures patients who die/are discharged while on vasopressors\n        -- in principle, this could add an extra end time for the vasopressor\n        -- however, since we later group on vaso_start, any extra end times are ignored\n        when LEAD(CHARTTIME,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) is null\n          then vaso_first\n\n        else null\n        end as vaso_stop\n    from vasocv5 v\n)\n\n-- -- if you want to look at the results of the table before grouping:\n-- select\n--   icustay_id, charttime, vaso, vaso_rate, vaso_amount\n--     , vaso_stopped\n--     , vaso_start\n--     , vaso_first\n--     , vaso_stop\n-- from vasocv6 order by icustay_id, charttime\n\n, vasocv7 as\n(\nselect\n  icustay_id\n  , charttime as starttime\n  , lead(charttime) OVER (partition by icustay_id, vaso_first order by charttime) as endtime\n  , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\nfrom vasocv6\nwhere\n  vaso_first is not null -- bogus data\nand\n  vaso_first != 0 -- sometimes *only* a rate of 0 appears, i.e. the drug is never actually delivered\nand\n  icustay_id is not null -- there are data for \"floating\" admissions, we don't worry about these\n)\n-- table of start/stop times for event\n, vasocv8 as\n(\n  select\n    icustay_id\n    , starttime, endtime\n    , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\n  from vasocv7\n  where endtime is not null\n  and vaso_rate > 0\n  and starttime != endtime\n)\n-- collapse these start/stop times down if the rate doesn't change\n, vasocv9 as\n(\n  select\n    icustay_id\n    , starttime, endtime\n    , case\n        when LAG(endtime) OVER (partition by icustay_id order by starttime, endtime) = starttime\n        AND  LAG(vaso_rate) OVER (partition by icustay_id order by starttime, endtime) = vaso_rate\n        THEN 0\n      else 1\n    end as vaso_groups\n    , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\n  from vasocv8\n  where endtime is not null\n  and vaso_rate > 0\n  and starttime != endtime\n)\n, vasocv10 as\n(\n  select\n    icustay_id\n    , starttime, endtime\n    , vaso_groups\n    , SUM(vaso_groups) OVER (partition by icustay_id order by starttime, endtime) as vaso_groups_sum\n    , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\n  from vasocv9\n)\n, vasocv as\n(\n  select icustay_id\n  , min(starttime) as starttime\n  , max(endtime) as endtime\n  , vaso_groups_sum\n  , vaso_rate\n  , sum(vaso_amount) as vaso_amount\n  from vasocv10\n  group by icustay_id, vaso_groups_sum, vaso_rate\n)\n-- now we extract the associated data for metavision patients\n, vasomv as\n(\n  select\n    icustay_id, linkorderid\n    , rate as vaso_rate\n    , amount as vaso_amount\n    , starttime\n    , endtime\n  from inputevents_mv\n  where itemid = 221906 -- norepinephrine\n  and statusdescription != 'Rewritten' -- only valid orders\n)\n-- now assign this data to every hour of the patient's stay\n-- vaso_amount for carevue is not accurate\nSELECT icustay_id\n  , starttime, endtime\n  , vaso_rate, vaso_amount\nfrom vasocv\nUNION ALL\nSELECT icustay_id\n  , starttime, endtime\n  , vaso_rate, vaso_amount\nfrom vasomv\norder by icustay_id, starttime",
        "tables": [
            "mimiciii_clinical.inputevents_cv",
            "mimiciii_clinical.inputevents_mv",
            "mimiciii_clinical.weight_durations"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.weight_durations.endtime",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime",
                "mimiciii_clinical.weight_durations.weight"
            ],
            "starttime": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.weight_durations.endtime",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime",
                "mimiciii_clinical.weight_durations.weight"
            ],
            "endtime": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.weight_durations.endtime",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime",
                "mimiciii_clinical.weight_durations.weight"
            ],
            "vaso_rate": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.weight_durations.endtime",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime",
                "mimiciii_clinical.weight_durations.weight"
            ],
            "vaso_amount": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.weight_durations.endtime",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime",
                "mimiciii_clinical.weight_durations.weight"
            ]
        },
        "table_name": "mimiciii_clinical.norepinephrine_dose",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "vasocv.icustay_id",
                "vasocv.starttime",
                "vasocv.endtime",
                "vasocv.vaso_rate",
                "vasocv.vaso_amount"
            ],
            "Sort Key": [
                "vasocv.icustay_id",
                "vasocv.starttime"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Finalize",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv1",
                    "Parallel Aware": false,
                    "Output": [
                        "cv.icustay_id",
                        "cv.charttime",
                        "max(CASE WHEN (cv.itemid = ANY ('{30047,30120}'::integer[])) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((cv.itemid = ANY ('{30047,30120}'::integer[])) AND (((cv.stopped)::text = 'Stopped'::text) OR ((cv.stopped)::text ~~ 'D/C%'::text))) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((cv.itemid = ANY ('{30047,30120}'::integer[])) AND (cv.rate IS NOT NULL)) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((cv.itemid = 30047) AND (wd.weight IS NULL)) THEN (cv.rate / '80'::double precision) WHEN (cv.itemid = 30047) THEN (cv.rate / wd.weight) WHEN (cv.itemid = 30120) THEN cv.rate ELSE NULL::double precision END)",
                        "max(CASE WHEN (cv.itemid = ANY ('{30047,30120}'::integer[])) THEN cv.amount ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "cv.icustay_id",
                        "cv.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Gather Merge",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "cv.icustay_id",
                                "cv.charttime",
                                "(PARTIAL max(CASE WHEN (cv.itemid = ANY ('{30047,30120}'::integer[])) THEN 1 ELSE 0 END))",
                                "(PARTIAL max(CASE WHEN ((cv.itemid = ANY ('{30047,30120}'::integer[])) AND (((cv.stopped)::text = 'Stopped'::text) OR ((cv.stopped)::text ~~ 'D/C%'::text))) THEN 1 ELSE 0 END))",
                                "(PARTIAL max(CASE WHEN ((cv.itemid = ANY ('{30047,30120}'::integer[])) AND (cv.rate IS NOT NULL)) THEN 1 ELSE 0 END))",
                                "(PARTIAL max(CASE WHEN ((cv.itemid = 30047) AND (wd.weight IS NULL)) THEN (cv.rate / '80'::double precision) WHEN (cv.itemid = 30047) THEN (cv.rate / wd.weight) WHEN (cv.itemid = 30120) THEN cv.rate ELSE NULL::double precision END))",
                                "(PARTIAL max(CASE WHEN (cv.itemid = ANY ('{30047,30120}'::integer[])) THEN cv.amount ELSE NULL::double precision END))"
                            ],
                            "Workers Planned": 2,
                            "Plans": [
                                {
                                    "Node Type": "Aggregate",
                                    "Strategy": "Sorted",
                                    "Partial Mode": "Partial",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "cv.icustay_id",
                                        "cv.charttime",
                                        "PARTIAL max(CASE WHEN (cv.itemid = ANY ('{30047,30120}'::integer[])) THEN 1 ELSE 0 END)",
                                        "PARTIAL max(CASE WHEN ((cv.itemid = ANY ('{30047,30120}'::integer[])) AND (((cv.stopped)::text = 'Stopped'::text) OR ((cv.stopped)::text ~~ 'D/C%'::text))) THEN 1 ELSE 0 END)",
                                        "PARTIAL max(CASE WHEN ((cv.itemid = ANY ('{30047,30120}'::integer[])) AND (cv.rate IS NOT NULL)) THEN 1 ELSE 0 END)",
                                        "PARTIAL max(CASE WHEN ((cv.itemid = 30047) AND (wd.weight IS NULL)) THEN (cv.rate / '80'::double precision) WHEN (cv.itemid = 30047) THEN (cv.rate / wd.weight) WHEN (cv.itemid = 30120) THEN cv.rate ELSE NULL::double precision END)",
                                        "PARTIAL max(CASE WHEN (cv.itemid = ANY ('{30047,30120}'::integer[])) THEN cv.amount ELSE NULL::double precision END)"
                                    ],
                                    "Group Key": [
                                        "cv.icustay_id",
                                        "cv.charttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "cv.icustay_id",
                                                "cv.charttime",
                                                "cv.itemid",
                                                "cv.stopped",
                                                "cv.rate",
                                                "wd.weight",
                                                "cv.amount"
                                            ],
                                            "Sort Key": [
                                                "cv.icustay_id",
                                                "cv.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Merge Join",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Join Type": "Left",
                                                    "Output": [
                                                        "cv.icustay_id",
                                                        "cv.charttime",
                                                        "cv.itemid",
                                                        "cv.stopped",
                                                        "cv.rate",
                                                        "wd.weight",
                                                        "cv.amount"
                                                    ],
                                                    "Inner Unique": false,
                                                    "Merge Cond": "(cv.icustay_id = wd.icustay_id)",
                                                    "Join Filter": "((cv.charttime >= wd.starttime) AND (cv.charttime <= wd.endtime))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Sort",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Output": [
                                                                "cv.icustay_id",
                                                                "cv.charttime",
                                                                "cv.itemid",
                                                                "cv.stopped",
                                                                "cv.rate",
                                                                "cv.amount"
                                                            ],
                                                            "Sort Key": [
                                                                "cv.icustay_id"
                                                            ],
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "inputevents_cv",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "cv",
                                                                    "Output": [
                                                                        "cv.icustay_id",
                                                                        "cv.charttime",
                                                                        "cv.itemid",
                                                                        "cv.stopped",
                                                                        "cv.rate",
                                                                        "cv.amount"
                                                                    ],
                                                                    "Recheck Cond": "(cv.itemid = ANY ('{30047,30120}'::integer[]))",
                                                                    "Filter": "(cv.icustay_id IS NOT NULL)",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "inputevents_cv_idx05",
                                                                            "Index Cond": "(cv.itemid = ANY ('{30047,30120}'::integer[]))"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "Node Type": "Materialize",
                                                            "Parent Relationship": "Inner",
                                                            "Parallel Aware": false,
                                                            "Output": [
                                                                "wd.weight",
                                                                "wd.icustay_id",
                                                                "wd.starttime",
                                                                "wd.endtime"
                                                            ],
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Sort",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Output": [
                                                                        "wd.weight",
                                                                        "wd.icustay_id",
                                                                        "wd.starttime",
                                                                        "wd.endtime"
                                                                    ],
                                                                    "Sort Key": [
                                                                        "wd.icustay_id"
                                                                    ],
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Seq Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Relation Name": "weight_durations",
                                                                            "Schema": "mimiciii_clinical",
                                                                            "Alias": "wd",
                                                                            "Output": [
                                                                                "wd.weight",
                                                                                "wd.icustay_id",
                                                                                "wd.starttime",
                                                                                "wd.endtime"
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv2",
                    "Parallel Aware": false,
                    "Output": [
                        "v.icustay_id",
                        "v.charttime",
                        "v.vaso",
                        "v.vaso_stopped",
                        "v.vaso_null",
                        "v.vaso_rate",
                        "v.vaso_amount",
                        "sum(v.vaso_null) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v.icustay_id",
                                "v.charttime",
                                "v.vaso",
                                "v.vaso_stopped",
                                "v.vaso_null",
                                "v.vaso_rate",
                                "v.vaso_amount"
                            ],
                            "Sort Key": [
                                "v.icustay_id",
                                "v.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv1",
                                    "Alias": "v",
                                    "Output": [
                                        "v.icustay_id",
                                        "v.charttime",
                                        "v.vaso",
                                        "v.vaso_stopped",
                                        "v.vaso_null",
                                        "v.vaso_rate",
                                        "v.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv3",
                    "Parallel Aware": false,
                    "Output": [
                        "v_1.icustay_id",
                        "v_1.charttime",
                        "v_1.vaso",
                        "v_1.vaso_stopped",
                        "v_1.vaso_null",
                        "v_1.vaso_rate",
                        "v_1.vaso_amount",
                        "v_1.vaso_partition",
                        "first_value(v_1.vaso_rate) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_1.icustay_id",
                                "v_1.charttime",
                                "v_1.vaso_partition",
                                "v_1.vaso",
                                "v_1.vaso_stopped",
                                "v_1.vaso_null",
                                "v_1.vaso_rate",
                                "v_1.vaso_amount"
                            ],
                            "Sort Key": [
                                "v_1.icustay_id",
                                "v_1.vaso_partition",
                                "v_1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv2",
                                    "Alias": "v_1",
                                    "Output": [
                                        "v_1.icustay_id",
                                        "v_1.charttime",
                                        "v_1.vaso_partition",
                                        "v_1.vaso",
                                        "v_1.vaso_stopped",
                                        "v_1.vaso_null",
                                        "v_1.vaso_rate",
                                        "v_1.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv4",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv3.icustay_id",
                        "vasocv3.charttime",
                        "vasocv3.vaso",
                        "vasocv3.vaso_rate",
                        "vasocv3.vaso_amount",
                        "vasocv3.vaso_stopped",
                        "vasocv3.vaso_prevrate_ifnull",
                        "CASE WHEN (vasocv3.vaso = 0) THEN NULL::integer WHEN ((vasocv3.vaso_rate > '0'::double precision) AND ((lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)) IS NULL)) THEN 1 WHEN ((vasocv3.vaso_rate = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN ((vasocv3.vaso_prevrate_ifnull = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision) THEN 1 WHEN (lag(vasocv3.vaso_stopped, 1) OVER (?) = 1) THEN 1 ELSE NULL::integer END",
                        "vasocv3.vaso_null"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv3.icustay_id",
                                "vasocv3.charttime",
                                "vasocv3.vaso",
                                "vasocv3.vaso_null",
                                "vasocv3.vaso_rate",
                                "vasocv3.vaso_amount",
                                "vasocv3.vaso_stopped",
                                "vasocv3.vaso_prevrate_ifnull",
                                "(lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?))"
                            ],
                            "Sort Key": [
                                "vasocv3.icustay_id",
                                "vasocv3.vaso",
                                "vasocv3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "WindowAgg",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv3.icustay_id",
                                        "vasocv3.charttime",
                                        "vasocv3.vaso",
                                        "vasocv3.vaso_null",
                                        "vasocv3.vaso_rate",
                                        "vasocv3.vaso_amount",
                                        "vasocv3.vaso_stopped",
                                        "vasocv3.vaso_prevrate_ifnull",
                                        "lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.charttime",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.vaso_rate",
                                                "vasocv3.vaso_amount",
                                                "vasocv3.vaso_stopped",
                                                "vasocv3.vaso_prevrate_ifnull"
                                            ],
                                            "Sort Key": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "vasocv3",
                                                    "Alias": "vasocv3",
                                                    "Output": [
                                                        "vasocv3.icustay_id",
                                                        "vasocv3.charttime",
                                                        "vasocv3.vaso",
                                                        "vasocv3.vaso_null",
                                                        "vasocv3.vaso_rate",
                                                        "vasocv3.vaso_amount",
                                                        "vasocv3.vaso_stopped",
                                                        "vasocv3.vaso_prevrate_ifnull"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv5",
                    "Parallel Aware": false,
                    "Output": [
                        "v_2.icustay_id",
                        "v_2.charttime",
                        "v_2.vaso",
                        "v_2.vaso_rate",
                        "v_2.vaso_amount",
                        "v_2.vaso_stopped",
                        "v_2.vaso_prevrate_ifnull",
                        "v_2.vaso_start",
                        "sum(v_2.vaso_start) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_2.icustay_id",
                                "v_2.charttime",
                                "v_2.vaso",
                                "v_2.vaso_rate",
                                "v_2.vaso_amount",
                                "v_2.vaso_stopped",
                                "v_2.vaso_prevrate_ifnull",
                                "v_2.vaso_start"
                            ],
                            "Sort Key": [
                                "v_2.icustay_id",
                                "v_2.vaso",
                                "v_2.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv4",
                                    "Alias": "v_2",
                                    "Output": [
                                        "v_2.icustay_id",
                                        "v_2.charttime",
                                        "v_2.vaso",
                                        "v_2.vaso_rate",
                                        "v_2.vaso_amount",
                                        "v_2.vaso_stopped",
                                        "v_2.vaso_prevrate_ifnull",
                                        "v_2.vaso_start"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv6",
                    "Parallel Aware": false,
                    "Output": [
                        "v_3.icustay_id",
                        "v_3.charttime",
                        "v_3.vaso",
                        "v_3.vaso_rate",
                        "v_3.vaso_amount",
                        "v_3.vaso_stopped",
                        "v_3.vaso_prevrate_ifnull",
                        "v_3.vaso_start",
                        "v_3.vaso_first",
                        "CASE WHEN (v_3.vaso = 0) THEN NULL::bigint WHEN (v_3.vaso_stopped = 1) THEN v_3.vaso_first WHEN (v_3.vaso_rate = '0'::double precision) THEN v_3.vaso_first WHEN (lead(v_3.charttime, 1) OVER (?) IS NULL) THEN v_3.vaso_first ELSE NULL::bigint END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_3.icustay_id",
                                "v_3.charttime",
                                "v_3.vaso",
                                "v_3.vaso_rate",
                                "v_3.vaso_amount",
                                "v_3.vaso_stopped",
                                "v_3.vaso_prevrate_ifnull",
                                "v_3.vaso_start",
                                "v_3.vaso_first"
                            ],
                            "Sort Key": [
                                "v_3.icustay_id",
                                "v_3.vaso",
                                "v_3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv5",
                                    "Alias": "v_3",
                                    "Output": [
                                        "v_3.icustay_id",
                                        "v_3.charttime",
                                        "v_3.vaso",
                                        "v_3.vaso_rate",
                                        "v_3.vaso_amount",
                                        "v_3.vaso_stopped",
                                        "v_3.vaso_prevrate_ifnull",
                                        "v_3.vaso_start",
                                        "v_3.vaso_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv7",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv6.icustay_id",
                        "vasocv6.charttime",
                        "lead(vasocv6.charttime) OVER (?)",
                        "vasocv6.vaso",
                        "vasocv6.vaso_rate",
                        "vasocv6.vaso_amount",
                        "vasocv6.vaso_stop",
                        "vasocv6.vaso_start",
                        "vasocv6.vaso_first"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv6.icustay_id",
                                "vasocv6.charttime",
                                "vasocv6.vaso_first",
                                "vasocv6.vaso",
                                "vasocv6.vaso_rate",
                                "vasocv6.vaso_amount",
                                "vasocv6.vaso_stop",
                                "vasocv6.vaso_start"
                            ],
                            "Sort Key": [
                                "vasocv6.icustay_id",
                                "vasocv6.vaso_first",
                                "vasocv6.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv6",
                                    "Alias": "vasocv6",
                                    "Output": [
                                        "vasocv6.icustay_id",
                                        "vasocv6.charttime",
                                        "vasocv6.vaso_first",
                                        "vasocv6.vaso",
                                        "vasocv6.vaso_rate",
                                        "vasocv6.vaso_amount",
                                        "vasocv6.vaso_stop",
                                        "vasocv6.vaso_start"
                                    ],
                                    "Filter": "((vasocv6.vaso_first IS NOT NULL) AND (vasocv6.icustay_id IS NOT NULL) AND (vasocv6.vaso_first <> 0))"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv8",
                    "Parallel Aware": false,
                    "CTE Name": "vasocv7",
                    "Alias": "vasocv7",
                    "Output": [
                        "vasocv7.icustay_id",
                        "vasocv7.starttime",
                        "vasocv7.endtime",
                        "vasocv7.vaso",
                        "vasocv7.vaso_rate",
                        "vasocv7.vaso_amount",
                        "vasocv7.vaso_stop",
                        "vasocv7.vaso_start",
                        "vasocv7.vaso_first"
                    ],
                    "Filter": "((vasocv7.endtime IS NOT NULL) AND (vasocv7.vaso_rate > '0'::double precision) AND (vasocv7.starttime <> vasocv7.endtime))"
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv9",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv8.icustay_id",
                        "vasocv8.starttime",
                        "vasocv8.endtime",
                        "CASE WHEN ((lag(vasocv8.endtime) OVER (?) = vasocv8.starttime) AND (lag(vasocv8.vaso_rate) OVER (?) = vasocv8.vaso_rate)) THEN 0 ELSE 1 END",
                        "vasocv8.vaso",
                        "vasocv8.vaso_rate",
                        "vasocv8.vaso_amount",
                        "vasocv8.vaso_stop",
                        "vasocv8.vaso_start",
                        "vasocv8.vaso_first"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv8.icustay_id",
                                "vasocv8.starttime",
                                "vasocv8.endtime",
                                "vasocv8.vaso_rate",
                                "vasocv8.vaso",
                                "vasocv8.vaso_amount",
                                "vasocv8.vaso_stop",
                                "vasocv8.vaso_start",
                                "vasocv8.vaso_first"
                            ],
                            "Sort Key": [
                                "vasocv8.icustay_id",
                                "vasocv8.starttime",
                                "vasocv8.endtime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv8",
                                    "Alias": "vasocv8",
                                    "Output": [
                                        "vasocv8.icustay_id",
                                        "vasocv8.starttime",
                                        "vasocv8.endtime",
                                        "vasocv8.vaso_rate",
                                        "vasocv8.vaso",
                                        "vasocv8.vaso_amount",
                                        "vasocv8.vaso_stop",
                                        "vasocv8.vaso_start",
                                        "vasocv8.vaso_first"
                                    ],
                                    "Filter": "((vasocv8.endtime IS NOT NULL) AND (vasocv8.vaso_rate > '0'::double precision) AND (vasocv8.starttime <> vasocv8.endtime))"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv10",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv9.icustay_id",
                        "vasocv9.starttime",
                        "vasocv9.endtime",
                        "vasocv9.vaso_groups",
                        "sum(vasocv9.vaso_groups) OVER (?)",
                        "vasocv9.vaso",
                        "vasocv9.vaso_rate",
                        "vasocv9.vaso_amount",
                        "vasocv9.vaso_stop",
                        "vasocv9.vaso_start",
                        "vasocv9.vaso_first"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv9.icustay_id",
                                "vasocv9.starttime",
                                "vasocv9.endtime",
                                "vasocv9.vaso_groups",
                                "vasocv9.vaso",
                                "vasocv9.vaso_rate",
                                "vasocv9.vaso_amount",
                                "vasocv9.vaso_stop",
                                "vasocv9.vaso_start",
                                "vasocv9.vaso_first"
                            ],
                            "Sort Key": [
                                "vasocv9.icustay_id",
                                "vasocv9.starttime",
                                "vasocv9.endtime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv9",
                                    "Alias": "vasocv9",
                                    "Output": [
                                        "vasocv9.icustay_id",
                                        "vasocv9.starttime",
                                        "vasocv9.endtime",
                                        "vasocv9.vaso_groups",
                                        "vasocv9.vaso",
                                        "vasocv9.vaso_rate",
                                        "vasocv9.vaso_amount",
                                        "vasocv9.vaso_stop",
                                        "vasocv9.vaso_start",
                                        "vasocv9.vaso_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv10.icustay_id",
                        "min(vasocv10.starttime)",
                        "max(vasocv10.endtime)",
                        "vasocv10.vaso_groups_sum",
                        "vasocv10.vaso_rate",
                        "sum(vasocv10.vaso_amount)"
                    ],
                    "Group Key": [
                        "vasocv10.icustay_id",
                        "vasocv10.vaso_groups_sum",
                        "vasocv10.vaso_rate"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "vasocv10",
                            "Alias": "vasocv10",
                            "Output": [
                                "vasocv10.icustay_id",
                                "vasocv10.starttime",
                                "vasocv10.endtime",
                                "vasocv10.vaso_groups",
                                "vasocv10.vaso_groups_sum",
                                "vasocv10.vaso",
                                "vasocv10.vaso_rate",
                                "vasocv10.vaso_amount",
                                "vasocv10.vaso_stop",
                                "vasocv10.vaso_start",
                                "vasocv10.vaso_first"
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Bitmap Heap Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasomv",
                    "Parallel Aware": false,
                    "Relation Name": "inputevents_mv",
                    "Schema": "mimiciii_clinical",
                    "Alias": "inputevents_mv",
                    "Output": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid",
                        "inputevents_mv.rate",
                        "inputevents_mv.amount",
                        "inputevents_mv.starttime",
                        "inputevents_mv.endtime"
                    ],
                    "Recheck Cond": "(inputevents_mv.itemid = 221906)",
                    "Filter": "((inputevents_mv.statusdescription)::text <> 'Rewritten'::text)",
                    "Plans": [
                        {
                            "Node Type": "Bitmap Index Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Index Name": "inputevents_mv_idx05",
                            "Index Cond": "(inputevents_mv.itemid = 221906)"
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "vasocv",
                            "Alias": "vasocv",
                            "Output": [
                                "vasocv.icustay_id",
                                "vasocv.starttime",
                                "vasocv.endtime",
                                "vasocv.vaso_rate",
                                "vasocv.vaso_amount"
                            ]
                        },
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "vasomv",
                            "Alias": "vasomv",
                            "Output": [
                                "vasomv.icustay_id",
                                "vasomv.starttime",
                                "vasomv.endtime",
                                "vasomv.vaso_rate",
                                "vasomv.vaso_amount"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.norepinephrine_durations": {
        "sql": "-- This query extracts durations of norepinephrine administration\n-- Consecutive administrations are numbered 1, 2, ...\n-- Total time on the drug can be calculated from this table by grouping using ICUSTAY_ID\n\n-- Get drug administration data from CareVue first\nwith vasocv1 as\n(\n  select\n    icustay_id, charttime\n    -- case statement determining whether the ITEMID is an instance of vasopressor usage\n    , max(case when itemid in (30047,30120) then 1 else 0 end) as vaso -- norepinephrine\n\n    -- the 'stopped' column indicates if a vasopressor has been disconnected\n    , max(case when itemid in (30047,30120) and (stopped = 'Stopped' OR stopped like 'D/C%') then 1\n          else 0 end) as vaso_stopped\n\n    , max(case when itemid in (30047,30120) and rate is not null then 1 else 0 end) as vaso_null\n    , max(case when itemid in (30047,30120) then rate else null end) as vaso_rate\n    , max(case when itemid in (30047,30120) then amount else null end) as vaso_amount\n\n  FROM inputevents_cv\n  where itemid in (30047,30120) -- norepinephrine\n  group by icustay_id, charttime\n)\n, vasocv2 as\n(\n  select v.*\n    , sum(vaso_null) over (partition by icustay_id order by charttime) as vaso_partition\n  from\n    vasocv1 v\n)\n, vasocv3 as\n(\n  select v.*\n    , first_value(vaso_rate) over (partition by icustay_id, vaso_partition order by charttime) as vaso_prevrate_ifnull\n  from\n    vasocv2 v\n)\n, vasocv4 as\n(\nselect\n    icustay_id\n    , charttime\n    -- , (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) AS delta\n\n    , vaso\n    , vaso_rate\n    , vaso_amount\n    , vaso_stopped\n    , vaso_prevrate_ifnull\n\n    -- We define start time here\n    , case\n        when vaso = 0 then null\n\n        -- if this is the first instance of the vasoactive drug\n        when vaso_rate > 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso, vaso_null\n          order by charttime\n          )\n          is null\n          then 1\n\n        -- you often get a string of 0s\n        -- we decide not to set these as 1, just because it makes vasonum sequential\n        when vaso_rate = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- sometimes you get a string of NULL, associated with 0 volumes\n        -- same reason as before, we decide not to set these as 1\n        -- vaso_prevrate_ifnull is equal to the previous value *iff* the current value is null\n        when vaso_prevrate_ifnull = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- If the last recorded rate was 0, newvaso = 1\n        when LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) = 0\n          then 1\n\n        -- If the last recorded vaso was D/C'd, newvaso = 1\n        when\n          LAG(vaso_stopped,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 1 then 1\n\n        -- ** not sure if the below is needed\n        --when (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) > (interval '4 hours') then 1\n      else null\n      end as vaso_start\n\nFROM\n  vasocv3\n)\n-- propagate start/stop flags forward in time\n, vasocv5 as\n(\n  select v.*\n    , SUM(vaso_start) OVER (partition by icustay_id, vaso order by charttime) as vaso_first\nFROM\n  vasocv4 v\n)\n, vasocv6 as\n(\n  select v.*\n    -- We define end time here\n    , case\n        when vaso = 0\n          then null\n\n        -- If the recorded vaso was D/C'd, this is an end time\n        when vaso_stopped = 1\n          then vaso_first\n\n        -- If the rate is zero, this is the end time\n        when vaso_rate = 0\n          then vaso_first\n\n        -- the last row in the table is always a potential end time\n        -- this captures patients who die/are discharged while on vasopressors\n        -- in principle, this could add an extra end time for the vasopressor\n        -- however, since we later group on vaso_start, any extra end times are ignored\n        when LEAD(CHARTTIME,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) is null\n          then vaso_first\n\n        else null\n        end as vaso_stop\n    from vasocv5 v\n)\n\n-- -- if you want to look at the results of the carevue data before grouping:\n-- select\n--   icustay_id, charttime, vaso, vaso_rate, vaso_amount\n--     , case when vaso_stopped = 1 then 'Y' else '' end as stopped\n--     , vaso_start\n--     , vaso_first\n--     , vaso_stop\n-- from vasocv6 order by charttime\n\n, vasocv as\n(\n-- below groups together vasopressor administrations into groups\nselect\n  icustay_id\n  -- the first non-null rate is considered the starttime\n  , min(case when vaso_rate is not null then charttime else null end) as starttime\n  -- the *first* time the first/last flags agree is the stop time for this duration\n  , min(case when vaso_first = vaso_stop then charttime else null end) as endtime\nfrom vasocv6\nwhere\n  vaso_first is not null -- bogus data\nand\n  vaso_first != 0 -- sometimes *only* a rate of 0 appears, i.e. the drug is never actually delivered\nand\n  icustay_id is not null -- there are data for \"floating\" admissions, we don't worry about these\ngroup by icustay_id, vaso_first\nhaving -- ensure start time is not the same as end time\n min(charttime) != min(case when vaso_first = vaso_stop then charttime else null end)\nand\n  max(vaso_rate) > 0 -- if the rate was always 0 or null, we consider it not a real drug delivery\n)\n\n-- now we extract the associated data for metavision patients\n, vasomv as\n(\n  select\n    icustay_id, linkorderid\n    , min(starttime) as starttime, max(endtime) as endtime\n  FROM inputevents_mv\n  where itemid = 221906 -- norepinephrine\n  and statusdescription != 'Rewritten' -- only valid orders\n  group by icustay_id, linkorderid\n)\n\nselect\n  icustay_id\n  -- generate a sequential integer for convenience\n  , ROW_NUMBER() over (partition by icustay_id order by starttime) as vasonum\n  , starttime, endtime\n  , DATETIME_DIFF(endtime, starttime, 'HOUR') AS duration_hours\n  -- add durations\nfrom\n  vasocv\n\nUNION ALL\n\nselect\n  icustay_id\n  , ROW_NUMBER() over (partition by icustay_id order by starttime) as vasonum\n  , starttime, endtime\n  , DATETIME_DIFF(endtime, starttime, 'HOUR') AS duration_hours\n  -- add durations\nfrom\n  vasomv\n\norder by icustay_id, vasonum",
        "tables": [
            "mimiciii_clinical.inputevents_cv",
            "mimiciii_clinical.inputevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "vasonum": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "starttime": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "endtime": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "duration_hours": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ]
        },
        "table_name": "mimiciii_clinical.norepinephrine_durations",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "vasocv.icustay_id",
                "(row_number() OVER (?))",
                "vasocv.starttime",
                "vasocv.endtime",
                "(datetime_diff(vasocv.endtime, vasocv.starttime, 'HOUR'::text))"
            ],
            "Sort Key": [
                "vasocv.icustay_id",
                "(row_number() OVER (?))"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv1",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30047,30120}'::integer[])) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = ANY ('{30047,30120}'::integer[])) AND (((inputevents_cv.stopped)::text = 'Stopped'::text) OR ((inputevents_cv.stopped)::text ~~ 'D/C%'::text))) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = ANY ('{30047,30120}'::integer[])) AND (inputevents_cv.rate IS NOT NULL)) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30047,30120}'::integer[])) THEN inputevents_cv.rate ELSE NULL::double precision END)",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30047,30120}'::integer[])) THEN inputevents_cv.amount ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime",
                                "inputevents_cv.itemid",
                                "inputevents_cv.stopped",
                                "inputevents_cv.rate",
                                "inputevents_cv.amount"
                            ],
                            "Sort Key": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "inputevents_cv",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "inputevents_cv",
                                    "Output": [
                                        "inputevents_cv.icustay_id",
                                        "inputevents_cv.charttime",
                                        "inputevents_cv.itemid",
                                        "inputevents_cv.stopped",
                                        "inputevents_cv.rate",
                                        "inputevents_cv.amount"
                                    ],
                                    "Recheck Cond": "(inputevents_cv.itemid = ANY ('{30047,30120}'::integer[]))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "inputevents_cv_idx05",
                                            "Index Cond": "(inputevents_cv.itemid = ANY ('{30047,30120}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv2",
                    "Parallel Aware": false,
                    "Output": [
                        "v.icustay_id",
                        "v.charttime",
                        "v.vaso",
                        "v.vaso_stopped",
                        "v.vaso_null",
                        "v.vaso_rate",
                        "v.vaso_amount",
                        "sum(v.vaso_null) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v.icustay_id",
                                "v.charttime",
                                "v.vaso",
                                "v.vaso_stopped",
                                "v.vaso_null",
                                "v.vaso_rate",
                                "v.vaso_amount"
                            ],
                            "Sort Key": [
                                "v.icustay_id",
                                "v.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv1",
                                    "Alias": "v",
                                    "Output": [
                                        "v.icustay_id",
                                        "v.charttime",
                                        "v.vaso",
                                        "v.vaso_stopped",
                                        "v.vaso_null",
                                        "v.vaso_rate",
                                        "v.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv3",
                    "Parallel Aware": false,
                    "Output": [
                        "v_1.icustay_id",
                        "v_1.charttime",
                        "v_1.vaso",
                        "v_1.vaso_stopped",
                        "v_1.vaso_null",
                        "v_1.vaso_rate",
                        "v_1.vaso_amount",
                        "v_1.vaso_partition",
                        "first_value(v_1.vaso_rate) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_1.icustay_id",
                                "v_1.charttime",
                                "v_1.vaso_partition",
                                "v_1.vaso",
                                "v_1.vaso_stopped",
                                "v_1.vaso_null",
                                "v_1.vaso_rate",
                                "v_1.vaso_amount"
                            ],
                            "Sort Key": [
                                "v_1.icustay_id",
                                "v_1.vaso_partition",
                                "v_1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv2",
                                    "Alias": "v_1",
                                    "Output": [
                                        "v_1.icustay_id",
                                        "v_1.charttime",
                                        "v_1.vaso_partition",
                                        "v_1.vaso",
                                        "v_1.vaso_stopped",
                                        "v_1.vaso_null",
                                        "v_1.vaso_rate",
                                        "v_1.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv4",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv3.icustay_id",
                        "vasocv3.charttime",
                        "vasocv3.vaso",
                        "vasocv3.vaso_rate",
                        "vasocv3.vaso_amount",
                        "vasocv3.vaso_stopped",
                        "vasocv3.vaso_prevrate_ifnull",
                        "CASE WHEN (vasocv3.vaso = 0) THEN NULL::integer WHEN ((vasocv3.vaso_rate > '0'::double precision) AND ((lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)) IS NULL)) THEN 1 WHEN ((vasocv3.vaso_rate = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN ((vasocv3.vaso_prevrate_ifnull = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision) THEN 1 WHEN (lag(vasocv3.vaso_stopped, 1) OVER (?) = 1) THEN 1 ELSE NULL::integer END",
                        "vasocv3.vaso_null"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv3.icustay_id",
                                "vasocv3.charttime",
                                "vasocv3.vaso",
                                "vasocv3.vaso_null",
                                "vasocv3.vaso_rate",
                                "vasocv3.vaso_amount",
                                "vasocv3.vaso_stopped",
                                "vasocv3.vaso_prevrate_ifnull",
                                "(lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?))"
                            ],
                            "Sort Key": [
                                "vasocv3.icustay_id",
                                "vasocv3.vaso",
                                "vasocv3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "WindowAgg",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv3.icustay_id",
                                        "vasocv3.charttime",
                                        "vasocv3.vaso",
                                        "vasocv3.vaso_null",
                                        "vasocv3.vaso_rate",
                                        "vasocv3.vaso_amount",
                                        "vasocv3.vaso_stopped",
                                        "vasocv3.vaso_prevrate_ifnull",
                                        "lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.charttime",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.vaso_rate",
                                                "vasocv3.vaso_amount",
                                                "vasocv3.vaso_stopped",
                                                "vasocv3.vaso_prevrate_ifnull"
                                            ],
                                            "Sort Key": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "vasocv3",
                                                    "Alias": "vasocv3",
                                                    "Output": [
                                                        "vasocv3.icustay_id",
                                                        "vasocv3.charttime",
                                                        "vasocv3.vaso",
                                                        "vasocv3.vaso_null",
                                                        "vasocv3.vaso_rate",
                                                        "vasocv3.vaso_amount",
                                                        "vasocv3.vaso_stopped",
                                                        "vasocv3.vaso_prevrate_ifnull"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv5",
                    "Parallel Aware": false,
                    "Output": [
                        "v_2.icustay_id",
                        "v_2.charttime",
                        "v_2.vaso",
                        "v_2.vaso_rate",
                        "v_2.vaso_amount",
                        "v_2.vaso_stopped",
                        "v_2.vaso_prevrate_ifnull",
                        "v_2.vaso_start",
                        "sum(v_2.vaso_start) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_2.icustay_id",
                                "v_2.charttime",
                                "v_2.vaso",
                                "v_2.vaso_rate",
                                "v_2.vaso_amount",
                                "v_2.vaso_stopped",
                                "v_2.vaso_prevrate_ifnull",
                                "v_2.vaso_start"
                            ],
                            "Sort Key": [
                                "v_2.icustay_id",
                                "v_2.vaso",
                                "v_2.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv4",
                                    "Alias": "v_2",
                                    "Output": [
                                        "v_2.icustay_id",
                                        "v_2.charttime",
                                        "v_2.vaso",
                                        "v_2.vaso_rate",
                                        "v_2.vaso_amount",
                                        "v_2.vaso_stopped",
                                        "v_2.vaso_prevrate_ifnull",
                                        "v_2.vaso_start"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv6",
                    "Parallel Aware": false,
                    "Output": [
                        "v_3.icustay_id",
                        "v_3.charttime",
                        "v_3.vaso",
                        "v_3.vaso_rate",
                        "v_3.vaso_amount",
                        "v_3.vaso_stopped",
                        "v_3.vaso_prevrate_ifnull",
                        "v_3.vaso_start",
                        "v_3.vaso_first",
                        "CASE WHEN (v_3.vaso = 0) THEN NULL::bigint WHEN (v_3.vaso_stopped = 1) THEN v_3.vaso_first WHEN (v_3.vaso_rate = '0'::double precision) THEN v_3.vaso_first WHEN (lead(v_3.charttime, 1) OVER (?) IS NULL) THEN v_3.vaso_first ELSE NULL::bigint END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_3.icustay_id",
                                "v_3.charttime",
                                "v_3.vaso",
                                "v_3.vaso_rate",
                                "v_3.vaso_amount",
                                "v_3.vaso_stopped",
                                "v_3.vaso_prevrate_ifnull",
                                "v_3.vaso_start",
                                "v_3.vaso_first"
                            ],
                            "Sort Key": [
                                "v_3.icustay_id",
                                "v_3.vaso",
                                "v_3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv5",
                                    "Alias": "v_3",
                                    "Output": [
                                        "v_3.icustay_id",
                                        "v_3.charttime",
                                        "v_3.vaso",
                                        "v_3.vaso_rate",
                                        "v_3.vaso_amount",
                                        "v_3.vaso_stopped",
                                        "v_3.vaso_prevrate_ifnull",
                                        "v_3.vaso_start",
                                        "v_3.vaso_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv6.icustay_id",
                        "min(CASE WHEN (vasocv6.vaso_rate IS NOT NULL) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)",
                        "min(CASE WHEN (vasocv6.vaso_first = vasocv6.vaso_stop) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)",
                        "vasocv6.vaso_first"
                    ],
                    "Group Key": [
                        "vasocv6.icustay_id",
                        "vasocv6.vaso_first"
                    ],
                    "Filter": "((min(vasocv6.charttime) <> min(CASE WHEN (vasocv6.vaso_first = vasocv6.vaso_stop) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)) AND (max(vasocv6.vaso_rate) > '0'::double precision))",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv6.icustay_id",
                                "vasocv6.vaso_first",
                                "vasocv6.vaso_rate",
                                "vasocv6.charttime",
                                "vasocv6.vaso_stop"
                            ],
                            "Sort Key": [
                                "vasocv6.icustay_id",
                                "vasocv6.vaso_first"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv6",
                                    "Alias": "vasocv6",
                                    "Output": [
                                        "vasocv6.icustay_id",
                                        "vasocv6.vaso_first",
                                        "vasocv6.vaso_rate",
                                        "vasocv6.charttime",
                                        "vasocv6.vaso_stop"
                                    ],
                                    "Filter": "((vasocv6.vaso_first IS NOT NULL) AND (vasocv6.icustay_id IS NOT NULL) AND (vasocv6.vaso_first <> 0))"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasomv",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid",
                        "min(inputevents_mv.starttime)",
                        "max(inputevents_mv.endtime)"
                    ],
                    "Group Key": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "inputevents_mv.icustay_id",
                                "inputevents_mv.linkorderid",
                                "inputevents_mv.starttime",
                                "inputevents_mv.endtime"
                            ],
                            "Sort Key": [
                                "inputevents_mv.icustay_id",
                                "inputevents_mv.linkorderid"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "inputevents_mv",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "inputevents_mv",
                                    "Output": [
                                        "inputevents_mv.icustay_id",
                                        "inputevents_mv.linkorderid",
                                        "inputevents_mv.starttime",
                                        "inputevents_mv.endtime"
                                    ],
                                    "Recheck Cond": "(inputevents_mv.itemid = 221906)",
                                    "Filter": "((inputevents_mv.statusdescription)::text <> 'Rewritten'::text)",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "inputevents_mv_idx05",
                                            "Index Cond": "(inputevents_mv.itemid = 221906)"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv.icustay_id",
                                "row_number() OVER (?)",
                                "vasocv.starttime",
                                "vasocv.endtime",
                                "datetime_diff(vasocv.endtime, vasocv.starttime, 'HOUR'::text)"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv.icustay_id",
                                        "vasocv.starttime",
                                        "vasocv.endtime"
                                    ],
                                    "Sort Key": [
                                        "vasocv.icustay_id",
                                        "vasocv.starttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "vasocv",
                                            "Alias": "vasocv",
                                            "Output": [
                                                "vasocv.icustay_id",
                                                "vasocv.starttime",
                                                "vasocv.endtime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "vasomv.icustay_id",
                                "row_number() OVER (?)",
                                "vasomv.starttime",
                                "vasomv.endtime",
                                "datetime_diff(vasomv.endtime, vasomv.starttime, 'HOUR'::text)"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasomv.icustay_id",
                                        "vasomv.starttime",
                                        "vasomv.endtime"
                                    ],
                                    "Sort Key": [
                                        "vasomv.icustay_id",
                                        "vasomv.starttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "vasomv",
                                            "Alias": "vasomv",
                                            "Output": [
                                                "vasomv.icustay_id",
                                                "vasomv.starttime",
                                                "vasomv.endtime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.phenylephrine_dose": {
        "sql": "-- This query extracts dose+durations of phenylephrine administration\n\n-- Get drug administration data from CareVue first\nwith vasocv1 as\n(\n    select\n    icustay_id, charttime\n    -- case statement determining whether the ITEMID is an instance of vasopressor usage\n    , max(case when itemid in (30127,30128) then 1 else 0 end) as vaso -- phenylephrine\n\n    -- the 'stopped' column indicates if a vasopressor has been disconnected\n    , max(case when itemid in (30127,30128) and (stopped = 'Stopped' OR stopped like 'D/C%') then 1\n          else 0 end) as vaso_stopped\n\n    , max(case when itemid in (30127,30128) and rate is not null then 1 else 0 end) as vaso_null\n    , max(case when itemid in (30127,30128) then rate else null end) as vaso_rate\n    , max(case when itemid in (30127,30128) then amount else null end) as vaso_amount\n\n  FROM inputevents_cv\n  where itemid in (30127,30128) -- phenylephrine\n  group by icustay_id, charttime\n)\n, vasocv2 as\n(\n  select v.*\n    , sum(vaso_null) over (partition by icustay_id order by charttime) as vaso_partition\n  from\n    vasocv1 v\n)\n, vasocv3 as\n(\n  select v.*\n    , first_value(vaso_rate) over (partition by icustay_id, vaso_partition order by charttime) as vaso_prevrate_ifnull\n  from\n    vasocv2 v\n)\n, vasocv4 as\n(\nselect\n    icustay_id\n    , charttime\n    -- , (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) AS delta\n\n    , vaso\n    , vaso_rate\n    , vaso_amount\n    , vaso_stopped\n    , vaso_prevrate_ifnull\n\n    -- We define start time here\n    , case\n        when vaso = 0 then null\n\n        -- if this is the first instance of the vasoactive drug\n        when vaso_rate > 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso, vaso_null\n          order by charttime\n          )\n          is null\n          then 1\n\n        -- you often get a string of 0s\n        -- we decide not to set these as 1, just because it makes vasonum sequential\n        when vaso_rate = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- sometimes you get a string of NULL, associated with 0 volumes\n        -- same reason as before, we decide not to set these as 1\n        -- vaso_prevrate_ifnull is equal to the previous value *iff* the current value is null\n        when vaso_prevrate_ifnull = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- If the last recorded rate was 0, newvaso = 1\n        when LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) = 0\n          then 1\n\n        -- If the last recorded vaso was D/C'd, newvaso = 1\n        when\n          LAG(vaso_stopped,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 1 then 1\n\n        -- ** not sure if the below is needed\n        --when (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) > (interval '4 hours') then 1\n      else null\n      end as vaso_start\n\nFROM\n  vasocv3\n)\n-- propagate start/stop flags forward in time\n, vasocv5 as\n(\n  select v.*\n    , SUM(vaso_start) OVER (partition by icustay_id, vaso order by charttime) as vaso_first\nFROM\n  vasocv4 v\n)\n, vasocv6 as\n(\n  select v.*\n    -- We define end time here\n    , case\n        when vaso = 0\n          then null\n\n        -- If the recorded vaso was D/C'd, this is an end time\n        when vaso_stopped = 1\n          then vaso_first\n\n        -- If the rate is zero, this is the end time\n        when vaso_rate = 0\n          then vaso_first\n\n        -- the last row in the table is always a potential end time\n        -- this captures patients who die/are discharged while on vasopressors\n        -- in principle, this could add an extra end time for the vasopressor\n        -- however, since we later group on vaso_start, any extra end times are ignored\n        when LEAD(CHARTTIME,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) is null\n          then vaso_first\n\n        else null\n        end as vaso_stop\n    from vasocv5 v\n)\n\n-- -- if you want to look at the results of the table before grouping:\n-- select\n--   icustay_id, charttime, vaso, vaso_rate, vaso_amount\n--     , vaso_stopped\n--     , vaso_start\n--     , vaso_first\n--     , vaso_stop\n-- from vasocv6 order by icustay_id, charttime\n\n, vasocv7 as\n(\nselect\n  icustay_id\n  , charttime as starttime\n  , lead(charttime) OVER (partition by icustay_id, vaso_first order by charttime) as endtime\n  , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\nfrom vasocv6\nwhere\n  vaso_first is not null -- bogus data\nand\n  vaso_first != 0 -- sometimes *only* a rate of 0 appears, i.e. the drug is never actually delivered\nand\n  icustay_id is not null -- there are data for \"floating\" admissions, we don't worry about these\n)\n-- table of start/stop times for event\n, vasocv8 as\n(\n  select\n    icustay_id\n    , starttime, endtime\n    , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\n  from vasocv7\n  where endtime is not null\n  and vaso_rate > 0\n  and starttime != endtime\n)\n-- collapse these start/stop times down if the rate doesn't change\n, vasocv9 as\n(\n  select\n    icustay_id\n    , starttime, endtime\n    , case\n        when LAG(endtime) OVER (partition by icustay_id order by starttime, endtime) = starttime\n        AND  LAG(vaso_rate) OVER (partition by icustay_id order by starttime, endtime) = vaso_rate\n        THEN 0\n      else 1\n    end as vaso_groups\n    , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\n  from vasocv8\n  where endtime is not null\n  and vaso_rate > 0\n  and starttime != endtime\n)\n, vasocv10 as\n(\n  select\n    icustay_id\n    , starttime, endtime\n    , vaso_groups\n    , SUM(vaso_groups) OVER (partition by icustay_id order by starttime, endtime) as vaso_groups_sum\n    , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\n  from vasocv9\n)\n, vasocv as\n(\n  select icustay_id\n  , min(starttime) as starttime\n  , max(endtime) as endtime\n  , vaso_groups_sum\n  , vaso_rate\n  , sum(vaso_amount) as vaso_amount\n  from vasocv10\n  group by icustay_id, vaso_groups_sum, vaso_rate\n)\n-- now we extract the associated data for metavision patients\n, vasomv as\n(\n  select\n    icustay_id, linkorderid\n    , rate as vaso_rate\n    , amount as vaso_amount\n    , starttime\n    , endtime\n  from inputevents_mv\n  where itemid = 221749 -- phenylephrine\n  and statusdescription != 'Rewritten' -- only valid orders\n)\n-- now assign this data to every hour of the patient's stay\n-- vaso_amount for carevue is not accurate\nSELECT icustay_id\n  , starttime, endtime\n  , vaso_rate, vaso_amount\nfrom vasocv\nUNION ALL\nSELECT icustay_id\n  , starttime, endtime\n  , vaso_rate, vaso_amount\nfrom vasomv\norder by icustay_id, starttime",
        "tables": [
            "mimiciii_clinical.inputevents_cv",
            "mimiciii_clinical.inputevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "starttime": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "endtime": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "vaso_rate": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "vaso_amount": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ]
        },
        "table_name": "mimiciii_clinical.phenylephrine_dose",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "vasocv.icustay_id",
                "vasocv.starttime",
                "vasocv.endtime",
                "vasocv.vaso_rate",
                "vasocv.vaso_amount"
            ],
            "Sort Key": [
                "vasocv.icustay_id",
                "vasocv.starttime"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv1",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30127,30128}'::integer[])) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = ANY ('{30127,30128}'::integer[])) AND (((inputevents_cv.stopped)::text = 'Stopped'::text) OR ((inputevents_cv.stopped)::text ~~ 'D/C%'::text))) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = ANY ('{30127,30128}'::integer[])) AND (inputevents_cv.rate IS NOT NULL)) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30127,30128}'::integer[])) THEN inputevents_cv.rate ELSE NULL::double precision END)",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30127,30128}'::integer[])) THEN inputevents_cv.amount ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime",
                                "inputevents_cv.itemid",
                                "inputevents_cv.stopped",
                                "inputevents_cv.rate",
                                "inputevents_cv.amount"
                            ],
                            "Sort Key": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "inputevents_cv",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "inputevents_cv",
                                    "Output": [
                                        "inputevents_cv.icustay_id",
                                        "inputevents_cv.charttime",
                                        "inputevents_cv.itemid",
                                        "inputevents_cv.stopped",
                                        "inputevents_cv.rate",
                                        "inputevents_cv.amount"
                                    ],
                                    "Recheck Cond": "(inputevents_cv.itemid = ANY ('{30127,30128}'::integer[]))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "inputevents_cv_idx05",
                                            "Index Cond": "(inputevents_cv.itemid = ANY ('{30127,30128}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv2",
                    "Parallel Aware": false,
                    "Output": [
                        "v.icustay_id",
                        "v.charttime",
                        "v.vaso",
                        "v.vaso_stopped",
                        "v.vaso_null",
                        "v.vaso_rate",
                        "v.vaso_amount",
                        "sum(v.vaso_null) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v.icustay_id",
                                "v.charttime",
                                "v.vaso",
                                "v.vaso_stopped",
                                "v.vaso_null",
                                "v.vaso_rate",
                                "v.vaso_amount"
                            ],
                            "Sort Key": [
                                "v.icustay_id",
                                "v.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv1",
                                    "Alias": "v",
                                    "Output": [
                                        "v.icustay_id",
                                        "v.charttime",
                                        "v.vaso",
                                        "v.vaso_stopped",
                                        "v.vaso_null",
                                        "v.vaso_rate",
                                        "v.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv3",
                    "Parallel Aware": false,
                    "Output": [
                        "v_1.icustay_id",
                        "v_1.charttime",
                        "v_1.vaso",
                        "v_1.vaso_stopped",
                        "v_1.vaso_null",
                        "v_1.vaso_rate",
                        "v_1.vaso_amount",
                        "v_1.vaso_partition",
                        "first_value(v_1.vaso_rate) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_1.icustay_id",
                                "v_1.charttime",
                                "v_1.vaso_partition",
                                "v_1.vaso",
                                "v_1.vaso_stopped",
                                "v_1.vaso_null",
                                "v_1.vaso_rate",
                                "v_1.vaso_amount"
                            ],
                            "Sort Key": [
                                "v_1.icustay_id",
                                "v_1.vaso_partition",
                                "v_1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv2",
                                    "Alias": "v_1",
                                    "Output": [
                                        "v_1.icustay_id",
                                        "v_1.charttime",
                                        "v_1.vaso_partition",
                                        "v_1.vaso",
                                        "v_1.vaso_stopped",
                                        "v_1.vaso_null",
                                        "v_1.vaso_rate",
                                        "v_1.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv4",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv3.icustay_id",
                        "vasocv3.charttime",
                        "vasocv3.vaso",
                        "vasocv3.vaso_rate",
                        "vasocv3.vaso_amount",
                        "vasocv3.vaso_stopped",
                        "vasocv3.vaso_prevrate_ifnull",
                        "CASE WHEN (vasocv3.vaso = 0) THEN NULL::integer WHEN ((vasocv3.vaso_rate > '0'::double precision) AND ((lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)) IS NULL)) THEN 1 WHEN ((vasocv3.vaso_rate = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN ((vasocv3.vaso_prevrate_ifnull = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision) THEN 1 WHEN (lag(vasocv3.vaso_stopped, 1) OVER (?) = 1) THEN 1 ELSE NULL::integer END",
                        "vasocv3.vaso_null"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv3.icustay_id",
                                "vasocv3.charttime",
                                "vasocv3.vaso",
                                "vasocv3.vaso_null",
                                "vasocv3.vaso_rate",
                                "vasocv3.vaso_amount",
                                "vasocv3.vaso_stopped",
                                "vasocv3.vaso_prevrate_ifnull",
                                "(lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?))"
                            ],
                            "Sort Key": [
                                "vasocv3.icustay_id",
                                "vasocv3.vaso",
                                "vasocv3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "WindowAgg",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv3.icustay_id",
                                        "vasocv3.charttime",
                                        "vasocv3.vaso",
                                        "vasocv3.vaso_null",
                                        "vasocv3.vaso_rate",
                                        "vasocv3.vaso_amount",
                                        "vasocv3.vaso_stopped",
                                        "vasocv3.vaso_prevrate_ifnull",
                                        "lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.charttime",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.vaso_rate",
                                                "vasocv3.vaso_amount",
                                                "vasocv3.vaso_stopped",
                                                "vasocv3.vaso_prevrate_ifnull"
                                            ],
                                            "Sort Key": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "vasocv3",
                                                    "Alias": "vasocv3",
                                                    "Output": [
                                                        "vasocv3.icustay_id",
                                                        "vasocv3.charttime",
                                                        "vasocv3.vaso",
                                                        "vasocv3.vaso_null",
                                                        "vasocv3.vaso_rate",
                                                        "vasocv3.vaso_amount",
                                                        "vasocv3.vaso_stopped",
                                                        "vasocv3.vaso_prevrate_ifnull"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv5",
                    "Parallel Aware": false,
                    "Output": [
                        "v_2.icustay_id",
                        "v_2.charttime",
                        "v_2.vaso",
                        "v_2.vaso_rate",
                        "v_2.vaso_amount",
                        "v_2.vaso_stopped",
                        "v_2.vaso_prevrate_ifnull",
                        "v_2.vaso_start",
                        "sum(v_2.vaso_start) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_2.icustay_id",
                                "v_2.charttime",
                                "v_2.vaso",
                                "v_2.vaso_rate",
                                "v_2.vaso_amount",
                                "v_2.vaso_stopped",
                                "v_2.vaso_prevrate_ifnull",
                                "v_2.vaso_start"
                            ],
                            "Sort Key": [
                                "v_2.icustay_id",
                                "v_2.vaso",
                                "v_2.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv4",
                                    "Alias": "v_2",
                                    "Output": [
                                        "v_2.icustay_id",
                                        "v_2.charttime",
                                        "v_2.vaso",
                                        "v_2.vaso_rate",
                                        "v_2.vaso_amount",
                                        "v_2.vaso_stopped",
                                        "v_2.vaso_prevrate_ifnull",
                                        "v_2.vaso_start"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv6",
                    "Parallel Aware": false,
                    "Output": [
                        "v_3.icustay_id",
                        "v_3.charttime",
                        "v_3.vaso",
                        "v_3.vaso_rate",
                        "v_3.vaso_amount",
                        "v_3.vaso_stopped",
                        "v_3.vaso_prevrate_ifnull",
                        "v_3.vaso_start",
                        "v_3.vaso_first",
                        "CASE WHEN (v_3.vaso = 0) THEN NULL::bigint WHEN (v_3.vaso_stopped = 1) THEN v_3.vaso_first WHEN (v_3.vaso_rate = '0'::double precision) THEN v_3.vaso_first WHEN (lead(v_3.charttime, 1) OVER (?) IS NULL) THEN v_3.vaso_first ELSE NULL::bigint END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_3.icustay_id",
                                "v_3.charttime",
                                "v_3.vaso",
                                "v_3.vaso_rate",
                                "v_3.vaso_amount",
                                "v_3.vaso_stopped",
                                "v_3.vaso_prevrate_ifnull",
                                "v_3.vaso_start",
                                "v_3.vaso_first"
                            ],
                            "Sort Key": [
                                "v_3.icustay_id",
                                "v_3.vaso",
                                "v_3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv5",
                                    "Alias": "v_3",
                                    "Output": [
                                        "v_3.icustay_id",
                                        "v_3.charttime",
                                        "v_3.vaso",
                                        "v_3.vaso_rate",
                                        "v_3.vaso_amount",
                                        "v_3.vaso_stopped",
                                        "v_3.vaso_prevrate_ifnull",
                                        "v_3.vaso_start",
                                        "v_3.vaso_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv7",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv6.icustay_id",
                        "vasocv6.charttime",
                        "lead(vasocv6.charttime) OVER (?)",
                        "vasocv6.vaso",
                        "vasocv6.vaso_rate",
                        "vasocv6.vaso_amount",
                        "vasocv6.vaso_stop",
                        "vasocv6.vaso_start",
                        "vasocv6.vaso_first"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv6.icustay_id",
                                "vasocv6.charttime",
                                "vasocv6.vaso_first",
                                "vasocv6.vaso",
                                "vasocv6.vaso_rate",
                                "vasocv6.vaso_amount",
                                "vasocv6.vaso_stop",
                                "vasocv6.vaso_start"
                            ],
                            "Sort Key": [
                                "vasocv6.icustay_id",
                                "vasocv6.vaso_first",
                                "vasocv6.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv6",
                                    "Alias": "vasocv6",
                                    "Output": [
                                        "vasocv6.icustay_id",
                                        "vasocv6.charttime",
                                        "vasocv6.vaso_first",
                                        "vasocv6.vaso",
                                        "vasocv6.vaso_rate",
                                        "vasocv6.vaso_amount",
                                        "vasocv6.vaso_stop",
                                        "vasocv6.vaso_start"
                                    ],
                                    "Filter": "((vasocv6.vaso_first IS NOT NULL) AND (vasocv6.icustay_id IS NOT NULL) AND (vasocv6.vaso_first <> 0))"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv8",
                    "Parallel Aware": false,
                    "CTE Name": "vasocv7",
                    "Alias": "vasocv7",
                    "Output": [
                        "vasocv7.icustay_id",
                        "vasocv7.starttime",
                        "vasocv7.endtime",
                        "vasocv7.vaso",
                        "vasocv7.vaso_rate",
                        "vasocv7.vaso_amount",
                        "vasocv7.vaso_stop",
                        "vasocv7.vaso_start",
                        "vasocv7.vaso_first"
                    ],
                    "Filter": "((vasocv7.endtime IS NOT NULL) AND (vasocv7.vaso_rate > '0'::double precision) AND (vasocv7.starttime <> vasocv7.endtime))"
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv9",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv8.icustay_id",
                        "vasocv8.starttime",
                        "vasocv8.endtime",
                        "CASE WHEN ((lag(vasocv8.endtime) OVER (?) = vasocv8.starttime) AND (lag(vasocv8.vaso_rate) OVER (?) = vasocv8.vaso_rate)) THEN 0 ELSE 1 END",
                        "vasocv8.vaso",
                        "vasocv8.vaso_rate",
                        "vasocv8.vaso_amount",
                        "vasocv8.vaso_stop",
                        "vasocv8.vaso_start",
                        "vasocv8.vaso_first"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv8.icustay_id",
                                "vasocv8.starttime",
                                "vasocv8.endtime",
                                "vasocv8.vaso_rate",
                                "vasocv8.vaso",
                                "vasocv8.vaso_amount",
                                "vasocv8.vaso_stop",
                                "vasocv8.vaso_start",
                                "vasocv8.vaso_first"
                            ],
                            "Sort Key": [
                                "vasocv8.icustay_id",
                                "vasocv8.starttime",
                                "vasocv8.endtime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv8",
                                    "Alias": "vasocv8",
                                    "Output": [
                                        "vasocv8.icustay_id",
                                        "vasocv8.starttime",
                                        "vasocv8.endtime",
                                        "vasocv8.vaso_rate",
                                        "vasocv8.vaso",
                                        "vasocv8.vaso_amount",
                                        "vasocv8.vaso_stop",
                                        "vasocv8.vaso_start",
                                        "vasocv8.vaso_first"
                                    ],
                                    "Filter": "((vasocv8.endtime IS NOT NULL) AND (vasocv8.vaso_rate > '0'::double precision) AND (vasocv8.starttime <> vasocv8.endtime))"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv10",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv9.icustay_id",
                        "vasocv9.starttime",
                        "vasocv9.endtime",
                        "vasocv9.vaso_groups",
                        "sum(vasocv9.vaso_groups) OVER (?)",
                        "vasocv9.vaso",
                        "vasocv9.vaso_rate",
                        "vasocv9.vaso_amount",
                        "vasocv9.vaso_stop",
                        "vasocv9.vaso_start",
                        "vasocv9.vaso_first"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv9.icustay_id",
                                "vasocv9.starttime",
                                "vasocv9.endtime",
                                "vasocv9.vaso_groups",
                                "vasocv9.vaso",
                                "vasocv9.vaso_rate",
                                "vasocv9.vaso_amount",
                                "vasocv9.vaso_stop",
                                "vasocv9.vaso_start",
                                "vasocv9.vaso_first"
                            ],
                            "Sort Key": [
                                "vasocv9.icustay_id",
                                "vasocv9.starttime",
                                "vasocv9.endtime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv9",
                                    "Alias": "vasocv9",
                                    "Output": [
                                        "vasocv9.icustay_id",
                                        "vasocv9.starttime",
                                        "vasocv9.endtime",
                                        "vasocv9.vaso_groups",
                                        "vasocv9.vaso",
                                        "vasocv9.vaso_rate",
                                        "vasocv9.vaso_amount",
                                        "vasocv9.vaso_stop",
                                        "vasocv9.vaso_start",
                                        "vasocv9.vaso_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv10.icustay_id",
                        "min(vasocv10.starttime)",
                        "max(vasocv10.endtime)",
                        "vasocv10.vaso_groups_sum",
                        "vasocv10.vaso_rate",
                        "sum(vasocv10.vaso_amount)"
                    ],
                    "Group Key": [
                        "vasocv10.icustay_id",
                        "vasocv10.vaso_groups_sum",
                        "vasocv10.vaso_rate"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "vasocv10",
                            "Alias": "vasocv10",
                            "Output": [
                                "vasocv10.icustay_id",
                                "vasocv10.starttime",
                                "vasocv10.endtime",
                                "vasocv10.vaso_groups",
                                "vasocv10.vaso_groups_sum",
                                "vasocv10.vaso",
                                "vasocv10.vaso_rate",
                                "vasocv10.vaso_amount",
                                "vasocv10.vaso_stop",
                                "vasocv10.vaso_start",
                                "vasocv10.vaso_first"
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Bitmap Heap Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasomv",
                    "Parallel Aware": false,
                    "Relation Name": "inputevents_mv",
                    "Schema": "mimiciii_clinical",
                    "Alias": "inputevents_mv",
                    "Output": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid",
                        "inputevents_mv.rate",
                        "inputevents_mv.amount",
                        "inputevents_mv.starttime",
                        "inputevents_mv.endtime"
                    ],
                    "Recheck Cond": "(inputevents_mv.itemid = 221749)",
                    "Filter": "((inputevents_mv.statusdescription)::text <> 'Rewritten'::text)",
                    "Plans": [
                        {
                            "Node Type": "Bitmap Index Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Index Name": "inputevents_mv_idx05",
                            "Index Cond": "(inputevents_mv.itemid = 221749)"
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "vasocv",
                            "Alias": "vasocv",
                            "Output": [
                                "vasocv.icustay_id",
                                "vasocv.starttime",
                                "vasocv.endtime",
                                "vasocv.vaso_rate",
                                "vasocv.vaso_amount"
                            ]
                        },
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "vasomv",
                            "Alias": "vasomv",
                            "Output": [
                                "vasomv.icustay_id",
                                "vasomv.starttime",
                                "vasomv.endtime",
                                "vasomv.vaso_rate",
                                "vasomv.vaso_amount"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.phenylephrine_durations": {
        "sql": "-- This query extracts durations of phenylephrine administration\n-- Consecutive administrations are numbered 1, 2, ...\n-- Total time on the drug can be calculated from this table by grouping using ICUSTAY_ID\n\n-- Get drug administration data from CareVue first\nwith vasocv1 as\n(\n  select\n    icustay_id, charttime\n    -- case statement determining whether the ITEMID is an instance of vasopressor usage\n    , max(case when itemid in (30127,30128) then 1 else 0 end) as vaso -- phenylephrine\n\n    -- the 'stopped' column indicates if a vasopressor has been disconnected\n    , max(case when itemid in (30127,30128) and (stopped = 'Stopped' OR stopped like 'D/C%') then 1\n          else 0 end) as vaso_stopped\n\n    , max(case when itemid in (30127,30128) and rate is not null then 1 else 0 end) as vaso_null\n    , max(case when itemid in (30127,30128) then rate else null end) as vaso_rate\n    , max(case when itemid in (30127,30128) then amount else null end) as vaso_amount\n\n  FROM inputevents_cv\n  where itemid in\n  (\n        30127,30128 -- phenylephrine\n  )\n  group by icustay_id, charttime\n)\n, vasocv2 as\n(\n  select v.*\n    , sum(vaso_null) over (partition by icustay_id order by charttime) as vaso_partition\n  from\n    vasocv1 v\n)\n, vasocv3 as\n(\n  select v.*\n    , first_value(vaso_rate) over (partition by icustay_id, vaso_partition order by charttime) as vaso_prevrate_ifnull\n  from\n    vasocv2 v\n)\n, vasocv4 as\n(\nselect\n    icustay_id\n    , charttime\n    -- , (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) AS delta\n\n    , vaso\n    , vaso_rate\n    , vaso_amount\n    , vaso_stopped\n    , vaso_prevrate_ifnull\n\n    -- We define start time here\n    , case\n        when vaso = 0 then null\n\n        -- if this is the first instance of the vasoactive drug\n        when vaso_rate > 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso, vaso_null\n          order by charttime\n          )\n          is null\n          then 1\n\n        -- you often get a string of 0s\n        -- we decide not to set these as 1, just because it makes vasonum sequential\n        when vaso_rate = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- sometimes you get a string of NULL, associated with 0 volumes\n        -- same reason as before, we decide not to set these as 1\n        -- vaso_prevrate_ifnull is equal to the previous value *iff* the current value is null\n        when vaso_prevrate_ifnull = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- If the last recorded rate was 0, newvaso = 1\n        when LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) = 0\n          then 1\n\n        -- If the last recorded vaso was D/C'd, newvaso = 1\n        when\n          LAG(vaso_stopped,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 1 then 1\n\n        -- ** not sure if the below is needed\n        --when (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) > (interval '4 hours') then 1\n      else null\n      end as vaso_start\n\nFROM\n  vasocv3\n)\n-- propagate start/stop flags forward in time\n, vasocv5 as\n(\n  select v.*\n    , SUM(vaso_start) OVER (partition by icustay_id, vaso order by charttime) as vaso_first\nFROM\n  vasocv4 v\n)\n, vasocv6 as\n(\n  select v.*\n    -- We define end time here\n    , case\n        when vaso = 0\n          then null\n\n        -- If the recorded vaso was D/C'd, this is an end time\n        when vaso_stopped = 1\n          then vaso_first\n\n        -- If the rate is zero, this is the end time\n        when vaso_rate = 0\n          then vaso_first\n\n        -- the last row in the table is always a potential end time\n        -- this captures patients who die/are discharged while on vasopressors\n        -- in principle, this could add an extra end time for the vasopressor\n        -- however, since we later group on vaso_start, any extra end times are ignored\n        when LEAD(CHARTTIME,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) is null\n          then vaso_first\n\n        else null\n        end as vaso_stop\n    from vasocv5 v\n)\n\n-- -- if you want to look at the results of the table before grouping:\n-- select\n--   icustay_id, charttime, vaso, vaso_rate, vaso_amount\n--     , case when vaso_stopped = 1 then 'Y' else '' end as stopped\n--     , vaso_start\n--     , vaso_first\n--     , vaso_stop\n-- from vasocv6 order by charttime\n\n\n, vasocv as\n(\n-- below groups together vasopressor administrations into groups\nselect\n  icustay_id\n  -- the first non-null rate is considered the starttime\n  , min(case when vaso_rate is not null then charttime else null end) as starttime\n  -- the *first* time the first/last flags agree is the stop time for this duration\n  , min(case when vaso_first = vaso_stop then charttime else null end) as endtime\nfrom vasocv6\nwhere\n  vaso_first is not null -- bogus data\nand\n  vaso_first != 0 -- sometimes *only* a rate of 0 appears, i.e. the drug is never actually delivered\nand\n  icustay_id is not null -- there are data for \"floating\" admissions, we don't worry about these\ngroup by icustay_id, vaso_first\nhaving -- ensure start time is not the same as end time\n min(charttime) != min(case when vaso_first = vaso_stop then charttime else null end)\nand\n  max(vaso_rate) > 0 -- if the rate was always 0 or null, we consider it not a real drug delivery\n)\n\n-- now we extract the associated data for metavision patients\n, vasomv as\n(\n  select\n    icustay_id, linkorderid\n    , min(starttime) as starttime, max(endtime) as endtime\n  FROM inputevents_mv\n  where itemid = 221749 -- phenylephrine\n  and statusdescription != 'Rewritten' -- only valid orders\n  group by icustay_id, linkorderid\n)\n\nselect\n  icustay_id\n  -- generate a sequential integer for convenience\n  , ROW_NUMBER() over (partition by icustay_id order by starttime) as vasonum\n  , starttime, endtime\n  , DATETIME_DIFF(endtime, starttime, 'HOUR') AS duration_hours\n  -- add durations\nfrom\n  vasocv\n\nUNION ALL\n\nselect\n  icustay_id\n  , ROW_NUMBER() over (partition by icustay_id order by starttime) as vasonum\n  , starttime, endtime\n  , DATETIME_DIFF(endtime, starttime, 'HOUR') AS duration_hours\n  -- add durations\nfrom\n  vasomv\n\norder by icustay_id, vasonum",
        "tables": [
            "mimiciii_clinical.inputevents_cv",
            "mimiciii_clinical.inputevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "vasonum": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "starttime": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "endtime": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "duration_hours": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ]
        },
        "table_name": "mimiciii_clinical.phenylephrine_durations",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "vasocv.icustay_id",
                "(row_number() OVER (?))",
                "vasocv.starttime",
                "vasocv.endtime",
                "(datetime_diff(vasocv.endtime, vasocv.starttime, 'HOUR'::text))"
            ],
            "Sort Key": [
                "vasocv.icustay_id",
                "(row_number() OVER (?))"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv1",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30127,30128}'::integer[])) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = ANY ('{30127,30128}'::integer[])) AND (((inputevents_cv.stopped)::text = 'Stopped'::text) OR ((inputevents_cv.stopped)::text ~~ 'D/C%'::text))) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = ANY ('{30127,30128}'::integer[])) AND (inputevents_cv.rate IS NOT NULL)) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30127,30128}'::integer[])) THEN inputevents_cv.rate ELSE NULL::double precision END)",
                        "max(CASE WHEN (inputevents_cv.itemid = ANY ('{30127,30128}'::integer[])) THEN inputevents_cv.amount ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime",
                                "inputevents_cv.itemid",
                                "inputevents_cv.stopped",
                                "inputevents_cv.rate",
                                "inputevents_cv.amount"
                            ],
                            "Sort Key": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "inputevents_cv",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "inputevents_cv",
                                    "Output": [
                                        "inputevents_cv.icustay_id",
                                        "inputevents_cv.charttime",
                                        "inputevents_cv.itemid",
                                        "inputevents_cv.stopped",
                                        "inputevents_cv.rate",
                                        "inputevents_cv.amount"
                                    ],
                                    "Recheck Cond": "(inputevents_cv.itemid = ANY ('{30127,30128}'::integer[]))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "inputevents_cv_idx05",
                                            "Index Cond": "(inputevents_cv.itemid = ANY ('{30127,30128}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv2",
                    "Parallel Aware": false,
                    "Output": [
                        "v.icustay_id",
                        "v.charttime",
                        "v.vaso",
                        "v.vaso_stopped",
                        "v.vaso_null",
                        "v.vaso_rate",
                        "v.vaso_amount",
                        "sum(v.vaso_null) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v.icustay_id",
                                "v.charttime",
                                "v.vaso",
                                "v.vaso_stopped",
                                "v.vaso_null",
                                "v.vaso_rate",
                                "v.vaso_amount"
                            ],
                            "Sort Key": [
                                "v.icustay_id",
                                "v.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv1",
                                    "Alias": "v",
                                    "Output": [
                                        "v.icustay_id",
                                        "v.charttime",
                                        "v.vaso",
                                        "v.vaso_stopped",
                                        "v.vaso_null",
                                        "v.vaso_rate",
                                        "v.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv3",
                    "Parallel Aware": false,
                    "Output": [
                        "v_1.icustay_id",
                        "v_1.charttime",
                        "v_1.vaso",
                        "v_1.vaso_stopped",
                        "v_1.vaso_null",
                        "v_1.vaso_rate",
                        "v_1.vaso_amount",
                        "v_1.vaso_partition",
                        "first_value(v_1.vaso_rate) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_1.icustay_id",
                                "v_1.charttime",
                                "v_1.vaso_partition",
                                "v_1.vaso",
                                "v_1.vaso_stopped",
                                "v_1.vaso_null",
                                "v_1.vaso_rate",
                                "v_1.vaso_amount"
                            ],
                            "Sort Key": [
                                "v_1.icustay_id",
                                "v_1.vaso_partition",
                                "v_1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv2",
                                    "Alias": "v_1",
                                    "Output": [
                                        "v_1.icustay_id",
                                        "v_1.charttime",
                                        "v_1.vaso_partition",
                                        "v_1.vaso",
                                        "v_1.vaso_stopped",
                                        "v_1.vaso_null",
                                        "v_1.vaso_rate",
                                        "v_1.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv4",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv3.icustay_id",
                        "vasocv3.charttime",
                        "vasocv3.vaso",
                        "vasocv3.vaso_rate",
                        "vasocv3.vaso_amount",
                        "vasocv3.vaso_stopped",
                        "vasocv3.vaso_prevrate_ifnull",
                        "CASE WHEN (vasocv3.vaso = 0) THEN NULL::integer WHEN ((vasocv3.vaso_rate > '0'::double precision) AND ((lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)) IS NULL)) THEN 1 WHEN ((vasocv3.vaso_rate = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN ((vasocv3.vaso_prevrate_ifnull = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision) THEN 1 WHEN (lag(vasocv3.vaso_stopped, 1) OVER (?) = 1) THEN 1 ELSE NULL::integer END",
                        "vasocv3.vaso_null"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv3.icustay_id",
                                "vasocv3.charttime",
                                "vasocv3.vaso",
                                "vasocv3.vaso_null",
                                "vasocv3.vaso_rate",
                                "vasocv3.vaso_amount",
                                "vasocv3.vaso_stopped",
                                "vasocv3.vaso_prevrate_ifnull",
                                "(lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?))"
                            ],
                            "Sort Key": [
                                "vasocv3.icustay_id",
                                "vasocv3.vaso",
                                "vasocv3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "WindowAgg",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv3.icustay_id",
                                        "vasocv3.charttime",
                                        "vasocv3.vaso",
                                        "vasocv3.vaso_null",
                                        "vasocv3.vaso_rate",
                                        "vasocv3.vaso_amount",
                                        "vasocv3.vaso_stopped",
                                        "vasocv3.vaso_prevrate_ifnull",
                                        "lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.charttime",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.vaso_rate",
                                                "vasocv3.vaso_amount",
                                                "vasocv3.vaso_stopped",
                                                "vasocv3.vaso_prevrate_ifnull"
                                            ],
                                            "Sort Key": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "vasocv3",
                                                    "Alias": "vasocv3",
                                                    "Output": [
                                                        "vasocv3.icustay_id",
                                                        "vasocv3.charttime",
                                                        "vasocv3.vaso",
                                                        "vasocv3.vaso_null",
                                                        "vasocv3.vaso_rate",
                                                        "vasocv3.vaso_amount",
                                                        "vasocv3.vaso_stopped",
                                                        "vasocv3.vaso_prevrate_ifnull"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv5",
                    "Parallel Aware": false,
                    "Output": [
                        "v_2.icustay_id",
                        "v_2.charttime",
                        "v_2.vaso",
                        "v_2.vaso_rate",
                        "v_2.vaso_amount",
                        "v_2.vaso_stopped",
                        "v_2.vaso_prevrate_ifnull",
                        "v_2.vaso_start",
                        "sum(v_2.vaso_start) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_2.icustay_id",
                                "v_2.charttime",
                                "v_2.vaso",
                                "v_2.vaso_rate",
                                "v_2.vaso_amount",
                                "v_2.vaso_stopped",
                                "v_2.vaso_prevrate_ifnull",
                                "v_2.vaso_start"
                            ],
                            "Sort Key": [
                                "v_2.icustay_id",
                                "v_2.vaso",
                                "v_2.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv4",
                                    "Alias": "v_2",
                                    "Output": [
                                        "v_2.icustay_id",
                                        "v_2.charttime",
                                        "v_2.vaso",
                                        "v_2.vaso_rate",
                                        "v_2.vaso_amount",
                                        "v_2.vaso_stopped",
                                        "v_2.vaso_prevrate_ifnull",
                                        "v_2.vaso_start"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv6",
                    "Parallel Aware": false,
                    "Output": [
                        "v_3.icustay_id",
                        "v_3.charttime",
                        "v_3.vaso",
                        "v_3.vaso_rate",
                        "v_3.vaso_amount",
                        "v_3.vaso_stopped",
                        "v_3.vaso_prevrate_ifnull",
                        "v_3.vaso_start",
                        "v_3.vaso_first",
                        "CASE WHEN (v_3.vaso = 0) THEN NULL::bigint WHEN (v_3.vaso_stopped = 1) THEN v_3.vaso_first WHEN (v_3.vaso_rate = '0'::double precision) THEN v_3.vaso_first WHEN (lead(v_3.charttime, 1) OVER (?) IS NULL) THEN v_3.vaso_first ELSE NULL::bigint END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_3.icustay_id",
                                "v_3.charttime",
                                "v_3.vaso",
                                "v_3.vaso_rate",
                                "v_3.vaso_amount",
                                "v_3.vaso_stopped",
                                "v_3.vaso_prevrate_ifnull",
                                "v_3.vaso_start",
                                "v_3.vaso_first"
                            ],
                            "Sort Key": [
                                "v_3.icustay_id",
                                "v_3.vaso",
                                "v_3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv5",
                                    "Alias": "v_3",
                                    "Output": [
                                        "v_3.icustay_id",
                                        "v_3.charttime",
                                        "v_3.vaso",
                                        "v_3.vaso_rate",
                                        "v_3.vaso_amount",
                                        "v_3.vaso_stopped",
                                        "v_3.vaso_prevrate_ifnull",
                                        "v_3.vaso_start",
                                        "v_3.vaso_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv6.icustay_id",
                        "min(CASE WHEN (vasocv6.vaso_rate IS NOT NULL) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)",
                        "min(CASE WHEN (vasocv6.vaso_first = vasocv6.vaso_stop) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)",
                        "vasocv6.vaso_first"
                    ],
                    "Group Key": [
                        "vasocv6.icustay_id",
                        "vasocv6.vaso_first"
                    ],
                    "Filter": "((min(vasocv6.charttime) <> min(CASE WHEN (vasocv6.vaso_first = vasocv6.vaso_stop) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)) AND (max(vasocv6.vaso_rate) > '0'::double precision))",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv6.icustay_id",
                                "vasocv6.vaso_first",
                                "vasocv6.vaso_rate",
                                "vasocv6.charttime",
                                "vasocv6.vaso_stop"
                            ],
                            "Sort Key": [
                                "vasocv6.icustay_id",
                                "vasocv6.vaso_first"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv6",
                                    "Alias": "vasocv6",
                                    "Output": [
                                        "vasocv6.icustay_id",
                                        "vasocv6.vaso_first",
                                        "vasocv6.vaso_rate",
                                        "vasocv6.charttime",
                                        "vasocv6.vaso_stop"
                                    ],
                                    "Filter": "((vasocv6.vaso_first IS NOT NULL) AND (vasocv6.icustay_id IS NOT NULL) AND (vasocv6.vaso_first <> 0))"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasomv",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid",
                        "min(inputevents_mv.starttime)",
                        "max(inputevents_mv.endtime)"
                    ],
                    "Group Key": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "inputevents_mv.icustay_id",
                                "inputevents_mv.linkorderid",
                                "inputevents_mv.starttime",
                                "inputevents_mv.endtime"
                            ],
                            "Sort Key": [
                                "inputevents_mv.icustay_id",
                                "inputevents_mv.linkorderid"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "inputevents_mv",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "inputevents_mv",
                                    "Output": [
                                        "inputevents_mv.icustay_id",
                                        "inputevents_mv.linkorderid",
                                        "inputevents_mv.starttime",
                                        "inputevents_mv.endtime"
                                    ],
                                    "Recheck Cond": "(inputevents_mv.itemid = 221749)",
                                    "Filter": "((inputevents_mv.statusdescription)::text <> 'Rewritten'::text)",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "inputevents_mv_idx05",
                                            "Index Cond": "(inputevents_mv.itemid = 221749)"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv.icustay_id",
                                "row_number() OVER (?)",
                                "vasocv.starttime",
                                "vasocv.endtime",
                                "datetime_diff(vasocv.endtime, vasocv.starttime, 'HOUR'::text)"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv.icustay_id",
                                        "vasocv.starttime",
                                        "vasocv.endtime"
                                    ],
                                    "Sort Key": [
                                        "vasocv.icustay_id",
                                        "vasocv.starttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "vasocv",
                                            "Alias": "vasocv",
                                            "Output": [
                                                "vasocv.icustay_id",
                                                "vasocv.starttime",
                                                "vasocv.endtime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "vasomv.icustay_id",
                                "row_number() OVER (?)",
                                "vasomv.starttime",
                                "vasomv.endtime",
                                "datetime_diff(vasomv.endtime, vasomv.starttime, 'HOUR'::text)"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasomv.icustay_id",
                                        "vasomv.starttime",
                                        "vasomv.endtime"
                                    ],
                                    "Sort Key": [
                                        "vasomv.icustay_id",
                                        "vasomv.starttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "vasomv",
                                            "Alias": "vasomv",
                                            "Output": [
                                                "vasomv.icustay_id",
                                                "vasomv.starttime",
                                                "vasomv.endtime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.vasopressin_dose": {
        "sql": "-- This query extracts dose+durations of vasopressin administration\n\n-- Get drug administration data from CareVue first\nwith vasocv1 as\n(\n    select\n    icustay_id, charttime\n    -- case statement determining whether the ITEMID is an instance of vasopressor usage\n    , max(case when itemid = 30051 then 1 else 0 end) as vaso -- vasopressin\n\n    -- the 'stopped' column indicates if a vasopressor has been disconnected\n    , max(case when itemid = 30051 and (stopped = 'Stopped' OR stopped like 'D/C%') then 1\n          else 0 end) as vaso_stopped\n\n    , max(case when itemid = 30051 and rate is not null then 1 else 0 end) as vaso_null\n    , max(case when itemid = 30051 then rate else null end) as vaso_rate\n    , max(case when itemid = 30051 then amount else null end) as vaso_amount\n\n  FROM inputevents_cv\n  where itemid = 30051 -- vasopressin\n  group by icustay_id, charttime\n)\n, vasocv2 as\n(\n  select v.*\n    , sum(vaso_null) over (partition by icustay_id order by charttime) as vaso_partition\n  from\n    vasocv1 v\n)\n, vasocv3 as\n(\n  select v.*\n    , first_value(vaso_rate) over (partition by icustay_id, vaso_partition order by charttime) as vaso_prevrate_ifnull\n  from\n    vasocv2 v\n)\n, vasocv4 as\n(\nselect\n    icustay_id\n    , charttime\n    -- , (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) AS delta\n\n    , vaso\n    , vaso_rate\n    , vaso_amount\n    , vaso_stopped\n    , vaso_prevrate_ifnull\n\n    -- We define start time here\n    , case\n        when vaso = 0 then null\n\n        -- if this is the first instance of the vasoactive drug\n        when vaso_rate > 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso, vaso_null\n          order by charttime\n          )\n          is null\n          then 1\n\n        -- you often get a string of 0s\n        -- we decide not to set these as 1, just because it makes vasonum sequential\n        when vaso_rate = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- sometimes you get a string of NULL, associated with 0 volumes\n        -- same reason as before, we decide not to set these as 1\n        -- vaso_prevrate_ifnull is equal to the previous value *iff* the current value is null\n        when vaso_prevrate_ifnull = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- If the last recorded rate was 0, newvaso = 1\n        when LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) = 0\n          then 1\n\n        -- If the last recorded vaso was D/C'd, newvaso = 1\n        when\n          LAG(vaso_stopped,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 1 then 1\n\n        -- ** not sure if the below is needed\n        --when (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) > (interval '4 hours') then 1\n      else null\n      end as vaso_start\n\nFROM\n  vasocv3\n)\n-- propagate start/stop flags forward in time\n, vasocv5 as\n(\n  select v.*\n    , SUM(vaso_start) OVER (partition by icustay_id, vaso order by charttime) as vaso_first\nFROM\n  vasocv4 v\n)\n, vasocv6 as\n(\n  select v.*\n    -- We define end time here\n    , case\n        when vaso = 0\n          then null\n\n        -- If the recorded vaso was D/C'd, this is an end time\n        when vaso_stopped = 1\n          then vaso_first\n\n        -- If the rate is zero, this is the end time\n        when vaso_rate = 0\n          then vaso_first\n\n        -- the last row in the table is always a potential end time\n        -- this captures patients who die/are discharged while on vasopressors\n        -- in principle, this could add an extra end time for the vasopressor\n        -- however, since we later group on vaso_start, any extra end times are ignored\n        when LEAD(CHARTTIME,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) is null\n          then vaso_first\n\n        else null\n        end as vaso_stop\n    from vasocv5 v\n)\n\n-- -- if you want to look at the results of the table before grouping:\n-- select\n--   icustay_id, charttime, vaso, vaso_rate, vaso_amount\n--     , vaso_stopped\n--     , vaso_start\n--     , vaso_first\n--     , vaso_stop\n-- from vasocv6 order by icustay_id, charttime\n\n, vasocv7 as\n(\nselect\n  icustay_id\n  , charttime as starttime\n  , lead(charttime) OVER (partition by icustay_id, vaso_first order by charttime) as endtime\n  , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\nfrom vasocv6\nwhere\n  vaso_first is not null -- bogus data\nand\n  vaso_first != 0 -- sometimes *only* a rate of 0 appears, i.e. the drug is never actually delivered\nand\n  icustay_id is not null -- there are data for \"floating\" admissions, we don't worry about these\n)\n-- table of start/stop times for event\n, vasocv8 as\n(\n  select\n    icustay_id\n    , starttime, endtime\n    , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\n  from vasocv7\n  where endtime is not null\n  and vaso_rate > 0\n  and starttime != endtime\n)\n-- collapse these start/stop times down if the rate doesn't change\n, vasocv9 as\n(\n  select\n    icustay_id\n    , starttime, endtime\n    , case\n        when LAG(endtime) OVER (partition by icustay_id order by starttime, endtime) = starttime\n        AND  LAG(vaso_rate) OVER (partition by icustay_id order by starttime, endtime) = vaso_rate\n        THEN 0\n      else 1\n    end as vaso_groups\n    , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\n  from vasocv8\n  where endtime is not null\n  and vaso_rate > 0\n  and starttime != endtime\n)\n, vasocv10 as\n(\n  select\n    icustay_id\n    , starttime, endtime\n    , vaso_groups\n    , SUM(vaso_groups) OVER (partition by icustay_id order by starttime, endtime) as vaso_groups_sum\n    , vaso, vaso_rate, vaso_amount, vaso_stop, vaso_start, vaso_first\n  from vasocv9\n)\n, vasocv as\n(\n  select icustay_id\n  , min(starttime) as starttime\n  , max(endtime) as endtime\n  , vaso_groups_sum\n  , vaso_rate\n  , sum(vaso_amount) as vaso_amount\n  from vasocv10\n  group by icustay_id, vaso_groups_sum, vaso_rate\n)\n-- now we extract the associated data for metavision patients\n, vasomv as\n(\n  select\n    icustay_id, linkorderid\n    -- , CASE WHEN valueuom = 'units/min' THEN rate*60.0 ELSE rate END as vaso_rate\n    , rate as vaso_rate\n    , amount as vaso_amount\n    , starttime\n    , endtime\n  from inputevents_mv\n  where itemid = 222315 -- vasopressin\n  and statusdescription != 'Rewritten' -- only valid orders\n)\n-- now assign this data to every hour of the patient's stay\n-- vaso_amount for carevue is not accurate\nSELECT icustay_id\n  , starttime, endtime\n  , vaso_rate, vaso_amount\nfrom vasocv\nUNION ALL\nSELECT icustay_id\n  , starttime, endtime\n  , vaso_rate, vaso_amount\nfrom vasomv\norder by icustay_id, starttime",
        "tables": [
            "mimiciii_clinical.inputevents_cv",
            "mimiciii_clinical.inputevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "starttime": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "endtime": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "vaso_rate": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "vaso_amount": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ]
        },
        "table_name": "mimiciii_clinical.vasopressin_dose",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "vasocv.icustay_id",
                "vasocv.starttime",
                "vasocv.endtime",
                "vasocv.vaso_rate",
                "vasocv.vaso_amount"
            ],
            "Sort Key": [
                "vasocv.icustay_id",
                "vasocv.starttime"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv1",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime",
                        "max(CASE WHEN (inputevents_cv.itemid = 30051) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = 30051) AND (((inputevents_cv.stopped)::text = 'Stopped'::text) OR ((inputevents_cv.stopped)::text ~~ 'D/C%'::text))) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = 30051) AND (inputevents_cv.rate IS NOT NULL)) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN (inputevents_cv.itemid = 30051) THEN inputevents_cv.rate ELSE NULL::double precision END)",
                        "max(CASE WHEN (inputevents_cv.itemid = 30051) THEN inputevents_cv.amount ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime",
                                "inputevents_cv.itemid",
                                "inputevents_cv.stopped",
                                "inputevents_cv.rate",
                                "inputevents_cv.amount"
                            ],
                            "Sort Key": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "inputevents_cv",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "inputevents_cv",
                                    "Output": [
                                        "inputevents_cv.icustay_id",
                                        "inputevents_cv.charttime",
                                        "inputevents_cv.itemid",
                                        "inputevents_cv.stopped",
                                        "inputevents_cv.rate",
                                        "inputevents_cv.amount"
                                    ],
                                    "Recheck Cond": "(inputevents_cv.itemid = 30051)",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "inputevents_cv_idx05",
                                            "Index Cond": "(inputevents_cv.itemid = 30051)"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv2",
                    "Parallel Aware": false,
                    "Output": [
                        "v.icustay_id",
                        "v.charttime",
                        "v.vaso",
                        "v.vaso_stopped",
                        "v.vaso_null",
                        "v.vaso_rate",
                        "v.vaso_amount",
                        "sum(v.vaso_null) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v.icustay_id",
                                "v.charttime",
                                "v.vaso",
                                "v.vaso_stopped",
                                "v.vaso_null",
                                "v.vaso_rate",
                                "v.vaso_amount"
                            ],
                            "Sort Key": [
                                "v.icustay_id",
                                "v.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv1",
                                    "Alias": "v",
                                    "Output": [
                                        "v.icustay_id",
                                        "v.charttime",
                                        "v.vaso",
                                        "v.vaso_stopped",
                                        "v.vaso_null",
                                        "v.vaso_rate",
                                        "v.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv3",
                    "Parallel Aware": false,
                    "Output": [
                        "v_1.icustay_id",
                        "v_1.charttime",
                        "v_1.vaso",
                        "v_1.vaso_stopped",
                        "v_1.vaso_null",
                        "v_1.vaso_rate",
                        "v_1.vaso_amount",
                        "v_1.vaso_partition",
                        "first_value(v_1.vaso_rate) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_1.icustay_id",
                                "v_1.charttime",
                                "v_1.vaso_partition",
                                "v_1.vaso",
                                "v_1.vaso_stopped",
                                "v_1.vaso_null",
                                "v_1.vaso_rate",
                                "v_1.vaso_amount"
                            ],
                            "Sort Key": [
                                "v_1.icustay_id",
                                "v_1.vaso_partition",
                                "v_1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv2",
                                    "Alias": "v_1",
                                    "Output": [
                                        "v_1.icustay_id",
                                        "v_1.charttime",
                                        "v_1.vaso_partition",
                                        "v_1.vaso",
                                        "v_1.vaso_stopped",
                                        "v_1.vaso_null",
                                        "v_1.vaso_rate",
                                        "v_1.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv4",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv3.icustay_id",
                        "vasocv3.charttime",
                        "vasocv3.vaso",
                        "vasocv3.vaso_rate",
                        "vasocv3.vaso_amount",
                        "vasocv3.vaso_stopped",
                        "vasocv3.vaso_prevrate_ifnull",
                        "CASE WHEN (vasocv3.vaso = 0) THEN NULL::integer WHEN ((vasocv3.vaso_rate > '0'::double precision) AND ((lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)) IS NULL)) THEN 1 WHEN ((vasocv3.vaso_rate = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN ((vasocv3.vaso_prevrate_ifnull = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision) THEN 1 WHEN (lag(vasocv3.vaso_stopped, 1) OVER (?) = 1) THEN 1 ELSE NULL::integer END",
                        "vasocv3.vaso_null"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv3.icustay_id",
                                "vasocv3.charttime",
                                "vasocv3.vaso",
                                "vasocv3.vaso_null",
                                "vasocv3.vaso_rate",
                                "vasocv3.vaso_amount",
                                "vasocv3.vaso_stopped",
                                "vasocv3.vaso_prevrate_ifnull",
                                "(lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?))"
                            ],
                            "Sort Key": [
                                "vasocv3.icustay_id",
                                "vasocv3.vaso",
                                "vasocv3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "WindowAgg",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv3.icustay_id",
                                        "vasocv3.charttime",
                                        "vasocv3.vaso",
                                        "vasocv3.vaso_null",
                                        "vasocv3.vaso_rate",
                                        "vasocv3.vaso_amount",
                                        "vasocv3.vaso_stopped",
                                        "vasocv3.vaso_prevrate_ifnull",
                                        "lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.charttime",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.vaso_rate",
                                                "vasocv3.vaso_amount",
                                                "vasocv3.vaso_stopped",
                                                "vasocv3.vaso_prevrate_ifnull"
                                            ],
                                            "Sort Key": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "vasocv3",
                                                    "Alias": "vasocv3",
                                                    "Output": [
                                                        "vasocv3.icustay_id",
                                                        "vasocv3.charttime",
                                                        "vasocv3.vaso",
                                                        "vasocv3.vaso_null",
                                                        "vasocv3.vaso_rate",
                                                        "vasocv3.vaso_amount",
                                                        "vasocv3.vaso_stopped",
                                                        "vasocv3.vaso_prevrate_ifnull"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv5",
                    "Parallel Aware": false,
                    "Output": [
                        "v_2.icustay_id",
                        "v_2.charttime",
                        "v_2.vaso",
                        "v_2.vaso_rate",
                        "v_2.vaso_amount",
                        "v_2.vaso_stopped",
                        "v_2.vaso_prevrate_ifnull",
                        "v_2.vaso_start",
                        "sum(v_2.vaso_start) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_2.icustay_id",
                                "v_2.charttime",
                                "v_2.vaso",
                                "v_2.vaso_rate",
                                "v_2.vaso_amount",
                                "v_2.vaso_stopped",
                                "v_2.vaso_prevrate_ifnull",
                                "v_2.vaso_start"
                            ],
                            "Sort Key": [
                                "v_2.icustay_id",
                                "v_2.vaso",
                                "v_2.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv4",
                                    "Alias": "v_2",
                                    "Output": [
                                        "v_2.icustay_id",
                                        "v_2.charttime",
                                        "v_2.vaso",
                                        "v_2.vaso_rate",
                                        "v_2.vaso_amount",
                                        "v_2.vaso_stopped",
                                        "v_2.vaso_prevrate_ifnull",
                                        "v_2.vaso_start"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv6",
                    "Parallel Aware": false,
                    "Output": [
                        "v_3.icustay_id",
                        "v_3.charttime",
                        "v_3.vaso",
                        "v_3.vaso_rate",
                        "v_3.vaso_amount",
                        "v_3.vaso_stopped",
                        "v_3.vaso_prevrate_ifnull",
                        "v_3.vaso_start",
                        "v_3.vaso_first",
                        "CASE WHEN (v_3.vaso = 0) THEN NULL::bigint WHEN (v_3.vaso_stopped = 1) THEN v_3.vaso_first WHEN (v_3.vaso_rate = '0'::double precision) THEN v_3.vaso_first WHEN (lead(v_3.charttime, 1) OVER (?) IS NULL) THEN v_3.vaso_first ELSE NULL::bigint END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_3.icustay_id",
                                "v_3.charttime",
                                "v_3.vaso",
                                "v_3.vaso_rate",
                                "v_3.vaso_amount",
                                "v_3.vaso_stopped",
                                "v_3.vaso_prevrate_ifnull",
                                "v_3.vaso_start",
                                "v_3.vaso_first"
                            ],
                            "Sort Key": [
                                "v_3.icustay_id",
                                "v_3.vaso",
                                "v_3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv5",
                                    "Alias": "v_3",
                                    "Output": [
                                        "v_3.icustay_id",
                                        "v_3.charttime",
                                        "v_3.vaso",
                                        "v_3.vaso_rate",
                                        "v_3.vaso_amount",
                                        "v_3.vaso_stopped",
                                        "v_3.vaso_prevrate_ifnull",
                                        "v_3.vaso_start",
                                        "v_3.vaso_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv7",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv6.icustay_id",
                        "vasocv6.charttime",
                        "lead(vasocv6.charttime) OVER (?)",
                        "vasocv6.vaso",
                        "vasocv6.vaso_rate",
                        "vasocv6.vaso_amount",
                        "vasocv6.vaso_stop",
                        "vasocv6.vaso_start",
                        "vasocv6.vaso_first"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv6.icustay_id",
                                "vasocv6.charttime",
                                "vasocv6.vaso_first",
                                "vasocv6.vaso",
                                "vasocv6.vaso_rate",
                                "vasocv6.vaso_amount",
                                "vasocv6.vaso_stop",
                                "vasocv6.vaso_start"
                            ],
                            "Sort Key": [
                                "vasocv6.icustay_id",
                                "vasocv6.vaso_first",
                                "vasocv6.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv6",
                                    "Alias": "vasocv6",
                                    "Output": [
                                        "vasocv6.icustay_id",
                                        "vasocv6.charttime",
                                        "vasocv6.vaso_first",
                                        "vasocv6.vaso",
                                        "vasocv6.vaso_rate",
                                        "vasocv6.vaso_amount",
                                        "vasocv6.vaso_stop",
                                        "vasocv6.vaso_start"
                                    ],
                                    "Filter": "((vasocv6.vaso_first IS NOT NULL) AND (vasocv6.icustay_id IS NOT NULL) AND (vasocv6.vaso_first <> 0))"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv8",
                    "Parallel Aware": false,
                    "CTE Name": "vasocv7",
                    "Alias": "vasocv7",
                    "Output": [
                        "vasocv7.icustay_id",
                        "vasocv7.starttime",
                        "vasocv7.endtime",
                        "vasocv7.vaso",
                        "vasocv7.vaso_rate",
                        "vasocv7.vaso_amount",
                        "vasocv7.vaso_stop",
                        "vasocv7.vaso_start",
                        "vasocv7.vaso_first"
                    ],
                    "Filter": "((vasocv7.endtime IS NOT NULL) AND (vasocv7.vaso_rate > '0'::double precision) AND (vasocv7.starttime <> vasocv7.endtime))"
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv9",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv8.icustay_id",
                        "vasocv8.starttime",
                        "vasocv8.endtime",
                        "CASE WHEN ((lag(vasocv8.endtime) OVER (?) = vasocv8.starttime) AND (lag(vasocv8.vaso_rate) OVER (?) = vasocv8.vaso_rate)) THEN 0 ELSE 1 END",
                        "vasocv8.vaso",
                        "vasocv8.vaso_rate",
                        "vasocv8.vaso_amount",
                        "vasocv8.vaso_stop",
                        "vasocv8.vaso_start",
                        "vasocv8.vaso_first"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv8.icustay_id",
                                "vasocv8.starttime",
                                "vasocv8.endtime",
                                "vasocv8.vaso_rate",
                                "vasocv8.vaso",
                                "vasocv8.vaso_amount",
                                "vasocv8.vaso_stop",
                                "vasocv8.vaso_start",
                                "vasocv8.vaso_first"
                            ],
                            "Sort Key": [
                                "vasocv8.icustay_id",
                                "vasocv8.starttime",
                                "vasocv8.endtime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv8",
                                    "Alias": "vasocv8",
                                    "Output": [
                                        "vasocv8.icustay_id",
                                        "vasocv8.starttime",
                                        "vasocv8.endtime",
                                        "vasocv8.vaso_rate",
                                        "vasocv8.vaso",
                                        "vasocv8.vaso_amount",
                                        "vasocv8.vaso_stop",
                                        "vasocv8.vaso_start",
                                        "vasocv8.vaso_first"
                                    ],
                                    "Filter": "((vasocv8.endtime IS NOT NULL) AND (vasocv8.vaso_rate > '0'::double precision) AND (vasocv8.starttime <> vasocv8.endtime))"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv10",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv9.icustay_id",
                        "vasocv9.starttime",
                        "vasocv9.endtime",
                        "vasocv9.vaso_groups",
                        "sum(vasocv9.vaso_groups) OVER (?)",
                        "vasocv9.vaso",
                        "vasocv9.vaso_rate",
                        "vasocv9.vaso_amount",
                        "vasocv9.vaso_stop",
                        "vasocv9.vaso_start",
                        "vasocv9.vaso_first"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv9.icustay_id",
                                "vasocv9.starttime",
                                "vasocv9.endtime",
                                "vasocv9.vaso_groups",
                                "vasocv9.vaso",
                                "vasocv9.vaso_rate",
                                "vasocv9.vaso_amount",
                                "vasocv9.vaso_stop",
                                "vasocv9.vaso_start",
                                "vasocv9.vaso_first"
                            ],
                            "Sort Key": [
                                "vasocv9.icustay_id",
                                "vasocv9.starttime",
                                "vasocv9.endtime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv9",
                                    "Alias": "vasocv9",
                                    "Output": [
                                        "vasocv9.icustay_id",
                                        "vasocv9.starttime",
                                        "vasocv9.endtime",
                                        "vasocv9.vaso_groups",
                                        "vasocv9.vaso",
                                        "vasocv9.vaso_rate",
                                        "vasocv9.vaso_amount",
                                        "vasocv9.vaso_stop",
                                        "vasocv9.vaso_start",
                                        "vasocv9.vaso_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv10.icustay_id",
                        "min(vasocv10.starttime)",
                        "max(vasocv10.endtime)",
                        "vasocv10.vaso_groups_sum",
                        "vasocv10.vaso_rate",
                        "sum(vasocv10.vaso_amount)"
                    ],
                    "Group Key": [
                        "vasocv10.icustay_id",
                        "vasocv10.vaso_groups_sum",
                        "vasocv10.vaso_rate"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "vasocv10",
                            "Alias": "vasocv10",
                            "Output": [
                                "vasocv10.icustay_id",
                                "vasocv10.starttime",
                                "vasocv10.endtime",
                                "vasocv10.vaso_groups",
                                "vasocv10.vaso_groups_sum",
                                "vasocv10.vaso",
                                "vasocv10.vaso_rate",
                                "vasocv10.vaso_amount",
                                "vasocv10.vaso_stop",
                                "vasocv10.vaso_start",
                                "vasocv10.vaso_first"
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Bitmap Heap Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasomv",
                    "Parallel Aware": false,
                    "Relation Name": "inputevents_mv",
                    "Schema": "mimiciii_clinical",
                    "Alias": "inputevents_mv",
                    "Output": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid",
                        "inputevents_mv.rate",
                        "inputevents_mv.amount",
                        "inputevents_mv.starttime",
                        "inputevents_mv.endtime"
                    ],
                    "Recheck Cond": "(inputevents_mv.itemid = 222315)",
                    "Filter": "((inputevents_mv.statusdescription)::text <> 'Rewritten'::text)",
                    "Plans": [
                        {
                            "Node Type": "Bitmap Index Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Index Name": "inputevents_mv_idx05",
                            "Index Cond": "(inputevents_mv.itemid = 222315)"
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "vasocv",
                            "Alias": "vasocv",
                            "Output": [
                                "vasocv.icustay_id",
                                "vasocv.starttime",
                                "vasocv.endtime",
                                "vasocv.vaso_rate",
                                "vasocv.vaso_amount"
                            ]
                        },
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "vasomv",
                            "Alias": "vasomv",
                            "Output": [
                                "vasomv.icustay_id",
                                "vasomv.starttime",
                                "vasomv.endtime",
                                "vasomv.vaso_rate",
                                "vasomv.vaso_amount"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.vasopressin_durations": {
        "sql": "-- This query extracts durations of vasopressin administration\n-- Consecutive administrations are numbered 1, 2, ...\n-- Total time on the drug can be calculated from this table by grouping using ICUSTAY_ID\n\n-- Get drug administration data from CareVue first\nwith vasocv1 as\n(\n  select\n    icustay_id, charttime\n    -- case statement determining whether the ITEMID is an instance of vasopressor usage\n    , max(case when itemid = 30051 then 1 else 0 end) as vaso -- vasopressin\n\n    -- the 'stopped' column indicates if a vasopressor has been disconnected\n    , max(case when itemid = 30051 and (stopped = 'Stopped' OR stopped like 'D/C%') then 1\n          else 0 end) as vaso_stopped\n\n    , max(case when itemid = 30051 and rate is not null then 1 else 0 end) as vaso_null\n    , max(case when itemid = 30051 then rate else null end) as vaso_rate\n    , max(case when itemid = 30051 then amount else null end) as vaso_amount\n\n  FROM inputevents_cv\n  where itemid = 30051 -- vasopressin\n  group by icustay_id, charttime\n)\n, vasocv2 as\n(\n  select v.*\n    , sum(vaso_null) over (partition by icustay_id order by charttime) as vaso_partition\n  from\n    vasocv1 v\n)\n, vasocv3 as\n(\n  select v.*\n    , first_value(vaso_rate) over (partition by icustay_id, vaso_partition order by charttime) as vaso_prevrate_ifnull\n  from\n    vasocv2 v\n)\n, vasocv4 as\n(\nselect\n    icustay_id\n    , charttime\n    -- , (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) AS delta\n\n    , vaso\n    , vaso_rate\n    , vaso_amount\n    , vaso_stopped\n    , vaso_prevrate_ifnull\n\n    -- We define start time here\n    , case\n        when vaso = 0 then null\n\n        -- if this is the first instance of the vasoactive drug\n        when vaso_rate > 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso, vaso_null\n          order by charttime\n          )\n          is null\n          then 1\n\n        -- you often get a string of 0s\n        -- we decide not to set these as 1, just because it makes vasonum sequential\n        when vaso_rate = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- sometimes you get a string of NULL, associated with 0 volumes\n        -- same reason as before, we decide not to set these as 1\n        -- vaso_prevrate_ifnull is equal to the previous value *iff* the current value is null\n        when vaso_prevrate_ifnull = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- If the last recorded rate was 0, newvaso = 1\n        when LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) = 0\n          then 1\n\n        -- If the last recorded vaso was D/C'd, newvaso = 1\n        when\n          LAG(vaso_stopped,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          )\n          = 1 then 1\n\n        -- ** not sure if the below is needed\n        --when (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) > (interval '4 hours') then 1\n      else null\n      end as vaso_start\n\nFROM\n  vasocv3\n)\n-- propagate start/stop flags forward in time\n, vasocv5 as\n(\n  select v.*\n    , SUM(vaso_start) OVER (partition by icustay_id, vaso order by charttime) as vaso_first\nFROM\n  vasocv4 v\n)\n, vasocv6 as\n(\n  select v.*\n    -- We define end time here\n    , case\n        when vaso = 0\n          then null\n\n        -- If the recorded vaso was D/C'd, this is an end time\n        when vaso_stopped = 1\n          then vaso_first\n\n        -- If the rate is zero, this is the end time\n        when vaso_rate = 0\n          then vaso_first\n\n        -- the last row in the table is always a potential end time\n        -- this captures patients who die/are discharged while on vasopressors\n        -- in principle, this could add an extra end time for the vasopressor\n        -- however, since we later group on vaso_start, any extra end times are ignored\n        when LEAD(CHARTTIME,1)\n          OVER\n          (\n          partition by icustay_id, vaso\n          order by charttime\n          ) is null\n          then vaso_first\n\n        else null\n        end as vaso_stop\n    from vasocv5 v\n)\n\n-- -- if you want to look at the results of the table before grouping:\n-- select\n--   icustay_id, charttime, vaso, vaso_rate, vaso_amount\n--     , case when vaso_stopped = 1 then 'Y' else '' end as stopped\n--     , vaso_start\n--     , vaso_first\n--     , vaso_stop\n-- from vasocv6 order by charttime\n\n\n, vasocv as\n(\n-- below groups together vasopressor administrations into groups\nselect\n  icustay_id\n  -- the first non-null rate is considered the starttime\n  , min(case when vaso_rate is not null then charttime else null end) as starttime\n  -- the *first* time the first/last flags agree is the stop time for this duration\n  , min(case when vaso_first = vaso_stop then charttime else null end) as endtime\nfrom vasocv6\nwhere\n  vaso_first is not null -- bogus data\nand\n  vaso_first != 0 -- sometimes *only* a rate of 0 appears, i.e. the drug is never actually delivered\nand\n  icustay_id is not null -- there are data for \"floating\" admissions, we don't worry about these\ngroup by icustay_id, vaso_first\nhaving -- ensure start time is not the same as end time\n min(charttime) != min(case when vaso_first = vaso_stop then charttime else null end)\nand\n  max(vaso_rate) > 0 -- if the rate was always 0 or null, we consider it not a real drug delivery\n)\n\n-- now we extract the associated data for metavision patients\n, vasomv as\n(\n  select\n    icustay_id, linkorderid\n    , min(starttime) as starttime, max(endtime) as endtime\n  FROM inputevents_mv\n  where itemid = 222315 -- vasopressin\n  and statusdescription != 'Rewritten' -- only valid orders\n  group by icustay_id, linkorderid\n)\n\nselect\n  icustay_id\n  -- generate a sequential integer for convenience\n  , ROW_NUMBER() over (partition by icustay_id order by starttime) as vasonum\n  , starttime, endtime\n  , DATETIME_DIFF(endtime, starttime, 'HOUR') AS duration_hours\n  -- add durations\nfrom\n  vasocv\n\nUNION ALL\n\nselect\n  icustay_id\n  , ROW_NUMBER() over (partition by icustay_id order by starttime) as vasonum\n  , starttime, endtime\n  , DATETIME_DIFF(endtime, starttime, 'HOUR') AS duration_hours\n  -- add durations\nfrom\n  vasomv\n\norder by icustay_id, vasonum",
        "tables": [
            "mimiciii_clinical.inputevents_cv",
            "mimiciii_clinical.inputevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "vasonum": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "starttime": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "endtime": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "duration_hours": [
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ]
        },
        "table_name": "mimiciii_clinical.vasopressin_durations",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "vasocv.icustay_id",
                "(row_number() OVER (?))",
                "vasocv.starttime",
                "vasocv.endtime",
                "(datetime_diff(vasocv.endtime, vasocv.starttime, 'HOUR'::text))"
            ],
            "Sort Key": [
                "vasocv.icustay_id",
                "(row_number() OVER (?))"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv1",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime",
                        "max(CASE WHEN (inputevents_cv.itemid = 30051) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = 30051) AND (((inputevents_cv.stopped)::text = 'Stopped'::text) OR ((inputevents_cv.stopped)::text ~~ 'D/C%'::text))) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((inputevents_cv.itemid = 30051) AND (inputevents_cv.rate IS NOT NULL)) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN (inputevents_cv.itemid = 30051) THEN inputevents_cv.rate ELSE NULL::double precision END)",
                        "max(CASE WHEN (inputevents_cv.itemid = 30051) THEN inputevents_cv.amount ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime",
                                "inputevents_cv.itemid",
                                "inputevents_cv.stopped",
                                "inputevents_cv.rate",
                                "inputevents_cv.amount"
                            ],
                            "Sort Key": [
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "inputevents_cv",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "inputevents_cv",
                                    "Output": [
                                        "inputevents_cv.icustay_id",
                                        "inputevents_cv.charttime",
                                        "inputevents_cv.itemid",
                                        "inputevents_cv.stopped",
                                        "inputevents_cv.rate",
                                        "inputevents_cv.amount"
                                    ],
                                    "Recheck Cond": "(inputevents_cv.itemid = 30051)",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "inputevents_cv_idx05",
                                            "Index Cond": "(inputevents_cv.itemid = 30051)"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv2",
                    "Parallel Aware": false,
                    "Output": [
                        "v.icustay_id",
                        "v.charttime",
                        "v.vaso",
                        "v.vaso_stopped",
                        "v.vaso_null",
                        "v.vaso_rate",
                        "v.vaso_amount",
                        "sum(v.vaso_null) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v.icustay_id",
                                "v.charttime",
                                "v.vaso",
                                "v.vaso_stopped",
                                "v.vaso_null",
                                "v.vaso_rate",
                                "v.vaso_amount"
                            ],
                            "Sort Key": [
                                "v.icustay_id",
                                "v.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv1",
                                    "Alias": "v",
                                    "Output": [
                                        "v.icustay_id",
                                        "v.charttime",
                                        "v.vaso",
                                        "v.vaso_stopped",
                                        "v.vaso_null",
                                        "v.vaso_rate",
                                        "v.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv3",
                    "Parallel Aware": false,
                    "Output": [
                        "v_1.icustay_id",
                        "v_1.charttime",
                        "v_1.vaso",
                        "v_1.vaso_stopped",
                        "v_1.vaso_null",
                        "v_1.vaso_rate",
                        "v_1.vaso_amount",
                        "v_1.vaso_partition",
                        "first_value(v_1.vaso_rate) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_1.icustay_id",
                                "v_1.charttime",
                                "v_1.vaso_partition",
                                "v_1.vaso",
                                "v_1.vaso_stopped",
                                "v_1.vaso_null",
                                "v_1.vaso_rate",
                                "v_1.vaso_amount"
                            ],
                            "Sort Key": [
                                "v_1.icustay_id",
                                "v_1.vaso_partition",
                                "v_1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv2",
                                    "Alias": "v_1",
                                    "Output": [
                                        "v_1.icustay_id",
                                        "v_1.charttime",
                                        "v_1.vaso_partition",
                                        "v_1.vaso",
                                        "v_1.vaso_stopped",
                                        "v_1.vaso_null",
                                        "v_1.vaso_rate",
                                        "v_1.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv4",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv3.icustay_id",
                        "vasocv3.charttime",
                        "vasocv3.vaso",
                        "vasocv3.vaso_rate",
                        "vasocv3.vaso_amount",
                        "vasocv3.vaso_stopped",
                        "vasocv3.vaso_prevrate_ifnull",
                        "CASE WHEN (vasocv3.vaso = 0) THEN NULL::integer WHEN ((vasocv3.vaso_rate > '0'::double precision) AND ((lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)) IS NULL)) THEN 1 WHEN ((vasocv3.vaso_rate = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN ((vasocv3.vaso_prevrate_ifnull = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision) THEN 1 WHEN (lag(vasocv3.vaso_stopped, 1) OVER (?) = 1) THEN 1 ELSE NULL::integer END",
                        "vasocv3.vaso_null"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv3.icustay_id",
                                "vasocv3.charttime",
                                "vasocv3.vaso",
                                "vasocv3.vaso_null",
                                "vasocv3.vaso_rate",
                                "vasocv3.vaso_amount",
                                "vasocv3.vaso_stopped",
                                "vasocv3.vaso_prevrate_ifnull",
                                "(lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?))"
                            ],
                            "Sort Key": [
                                "vasocv3.icustay_id",
                                "vasocv3.vaso",
                                "vasocv3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "WindowAgg",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv3.icustay_id",
                                        "vasocv3.charttime",
                                        "vasocv3.vaso",
                                        "vasocv3.vaso_null",
                                        "vasocv3.vaso_rate",
                                        "vasocv3.vaso_amount",
                                        "vasocv3.vaso_stopped",
                                        "vasocv3.vaso_prevrate_ifnull",
                                        "lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.charttime",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.vaso_rate",
                                                "vasocv3.vaso_amount",
                                                "vasocv3.vaso_stopped",
                                                "vasocv3.vaso_prevrate_ifnull"
                                            ],
                                            "Sort Key": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "vasocv3",
                                                    "Alias": "vasocv3",
                                                    "Output": [
                                                        "vasocv3.icustay_id",
                                                        "vasocv3.charttime",
                                                        "vasocv3.vaso",
                                                        "vasocv3.vaso_null",
                                                        "vasocv3.vaso_rate",
                                                        "vasocv3.vaso_amount",
                                                        "vasocv3.vaso_stopped",
                                                        "vasocv3.vaso_prevrate_ifnull"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv5",
                    "Parallel Aware": false,
                    "Output": [
                        "v_2.icustay_id",
                        "v_2.charttime",
                        "v_2.vaso",
                        "v_2.vaso_rate",
                        "v_2.vaso_amount",
                        "v_2.vaso_stopped",
                        "v_2.vaso_prevrate_ifnull",
                        "v_2.vaso_start",
                        "sum(v_2.vaso_start) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_2.icustay_id",
                                "v_2.charttime",
                                "v_2.vaso",
                                "v_2.vaso_rate",
                                "v_2.vaso_amount",
                                "v_2.vaso_stopped",
                                "v_2.vaso_prevrate_ifnull",
                                "v_2.vaso_start"
                            ],
                            "Sort Key": [
                                "v_2.icustay_id",
                                "v_2.vaso",
                                "v_2.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv4",
                                    "Alias": "v_2",
                                    "Output": [
                                        "v_2.icustay_id",
                                        "v_2.charttime",
                                        "v_2.vaso",
                                        "v_2.vaso_rate",
                                        "v_2.vaso_amount",
                                        "v_2.vaso_stopped",
                                        "v_2.vaso_prevrate_ifnull",
                                        "v_2.vaso_start"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv6",
                    "Parallel Aware": false,
                    "Output": [
                        "v_3.icustay_id",
                        "v_3.charttime",
                        "v_3.vaso",
                        "v_3.vaso_rate",
                        "v_3.vaso_amount",
                        "v_3.vaso_stopped",
                        "v_3.vaso_prevrate_ifnull",
                        "v_3.vaso_start",
                        "v_3.vaso_first",
                        "CASE WHEN (v_3.vaso = 0) THEN NULL::bigint WHEN (v_3.vaso_stopped = 1) THEN v_3.vaso_first WHEN (v_3.vaso_rate = '0'::double precision) THEN v_3.vaso_first WHEN (lead(v_3.charttime, 1) OVER (?) IS NULL) THEN v_3.vaso_first ELSE NULL::bigint END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_3.icustay_id",
                                "v_3.charttime",
                                "v_3.vaso",
                                "v_3.vaso_rate",
                                "v_3.vaso_amount",
                                "v_3.vaso_stopped",
                                "v_3.vaso_prevrate_ifnull",
                                "v_3.vaso_start",
                                "v_3.vaso_first"
                            ],
                            "Sort Key": [
                                "v_3.icustay_id",
                                "v_3.vaso",
                                "v_3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv5",
                                    "Alias": "v_3",
                                    "Output": [
                                        "v_3.icustay_id",
                                        "v_3.charttime",
                                        "v_3.vaso",
                                        "v_3.vaso_rate",
                                        "v_3.vaso_amount",
                                        "v_3.vaso_stopped",
                                        "v_3.vaso_prevrate_ifnull",
                                        "v_3.vaso_start",
                                        "v_3.vaso_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv6.icustay_id",
                        "min(CASE WHEN (vasocv6.vaso_rate IS NOT NULL) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)",
                        "min(CASE WHEN (vasocv6.vaso_first = vasocv6.vaso_stop) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)",
                        "vasocv6.vaso_first"
                    ],
                    "Group Key": [
                        "vasocv6.icustay_id",
                        "vasocv6.vaso_first"
                    ],
                    "Filter": "((min(vasocv6.charttime) <> min(CASE WHEN (vasocv6.vaso_first = vasocv6.vaso_stop) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)) AND (max(vasocv6.vaso_rate) > '0'::double precision))",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "vasocv6",
                            "Alias": "vasocv6",
                            "Output": [
                                "vasocv6.icustay_id",
                                "vasocv6.charttime",
                                "vasocv6.vaso",
                                "vasocv6.vaso_rate",
                                "vasocv6.vaso_amount",
                                "vasocv6.vaso_stopped",
                                "vasocv6.vaso_prevrate_ifnull",
                                "vasocv6.vaso_start",
                                "vasocv6.vaso_first",
                                "vasocv6.vaso_stop"
                            ],
                            "Filter": "((vasocv6.vaso_first IS NOT NULL) AND (vasocv6.icustay_id IS NOT NULL) AND (vasocv6.vaso_first <> 0))"
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasomv",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid",
                        "min(inputevents_mv.starttime)",
                        "max(inputevents_mv.endtime)"
                    ],
                    "Group Key": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.linkorderid"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Bitmap Heap Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "inputevents_mv",
                            "Schema": "mimiciii_clinical",
                            "Alias": "inputevents_mv",
                            "Output": [
                                "inputevents_mv.row_id",
                                "inputevents_mv.subject_id",
                                "inputevents_mv.hadm_id",
                                "inputevents_mv.icustay_id",
                                "inputevents_mv.starttime",
                                "inputevents_mv.endtime",
                                "inputevents_mv.itemid",
                                "inputevents_mv.amount",
                                "inputevents_mv.amountuom",
                                "inputevents_mv.rate",
                                "inputevents_mv.rateuom",
                                "inputevents_mv.storetime",
                                "inputevents_mv.cgid",
                                "inputevents_mv.orderid",
                                "inputevents_mv.linkorderid",
                                "inputevents_mv.ordercategoryname",
                                "inputevents_mv.secondaryordercategoryname",
                                "inputevents_mv.ordercomponenttypedescription",
                                "inputevents_mv.ordercategorydescription",
                                "inputevents_mv.patientweight",
                                "inputevents_mv.totalamount",
                                "inputevents_mv.totalamountuom",
                                "inputevents_mv.isopenbag",
                                "inputevents_mv.continueinnextdept",
                                "inputevents_mv.cancelreason",
                                "inputevents_mv.statusdescription",
                                "inputevents_mv.comments_editedby",
                                "inputevents_mv.comments_canceledby",
                                "inputevents_mv.comments_date",
                                "inputevents_mv.originalamount",
                                "inputevents_mv.originalrate"
                            ],
                            "Recheck Cond": "(inputevents_mv.itemid = 222315)",
                            "Filter": "((inputevents_mv.statusdescription)::text <> 'Rewritten'::text)",
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Index Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Index Name": "inputevents_mv_idx05",
                                    "Index Cond": "(inputevents_mv.itemid = 222315)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv.icustay_id",
                                "row_number() OVER (?)",
                                "vasocv.starttime",
                                "vasocv.endtime",
                                "datetime_diff(vasocv.endtime, vasocv.starttime, 'HOUR'::text)"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv.icustay_id",
                                        "vasocv.starttime",
                                        "vasocv.endtime"
                                    ],
                                    "Sort Key": [
                                        "vasocv.icustay_id",
                                        "vasocv.starttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "vasocv",
                                            "Alias": "vasocv",
                                            "Output": [
                                                "vasocv.icustay_id",
                                                "vasocv.starttime",
                                                "vasocv.endtime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "vasomv.icustay_id",
                                "row_number() OVER (?)",
                                "vasomv.starttime",
                                "vasomv.endtime",
                                "datetime_diff(vasomv.endtime, vasomv.starttime, 'HOUR'::text)"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasomv.icustay_id",
                                        "vasomv.starttime",
                                        "vasomv.endtime"
                                    ],
                                    "Sort Key": [
                                        "vasomv.icustay_id",
                                        "vasomv.starttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "vasomv",
                                            "Alias": "vasomv",
                                            "Output": [
                                                "vasomv.icustay_id",
                                                "vasomv.starttime",
                                                "vasomv.endtime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.vasopressor_durations": {
        "sql": "-- This query extracts durations of vasopressor administration\n-- It groups together any administration of the below list of drugs:\n--  norepinephrine - 30047,30120,221906\n--  epinephrine - 30044,30119,30309,221289\n--  phenylephrine - 30127,30128,221749\n--  vasopressin - 30051,222315 (42273, 42802 also for 2 patients)\n--  dopamine - 30043,30307,221662\n--  dobutamine - 30042,30306,221653\n--  milrinone - 30125,221986\n\n-- Consecutive administrations are numbered 1, 2, ...\n-- Total time on the drug can be calculated from this table\n-- by grouping using ICUSTAY_ID\n\n-- select only the ITEMIDs from the inputevents_cv table related to vasopressors\nwith io_cv as\n(\n  select\n    icustay_id, charttime, itemid, stopped\n    -- ITEMIDs (42273, 42802) accidentally store rate in amount column\n    , case\n        when itemid in (42273, 42802)\n          then amount\n        else rate\n      end as rate\n    , case\n        when itemid in (42273, 42802)\n          then rate\n        else amount\n      end as amount\n  FROM inputevents_cv\n  where itemid in\n  (\n    30047,30120,30044,30119,30309,30127\n  , 30128,30051,30043,30307,30042,30306,30125\n  , 42273, 42802\n  )\n)\n-- select only the ITEMIDs from the inputevents_mv table related to vasopressors\n, io_mv as\n(\n  select\n    icustay_id, linkorderid, starttime, endtime\n  FROM inputevents_mv io\n  -- Subselect the vasopressor ITEMIDs\n  where itemid in\n  (\n  221906,221289,221749,222315,221662,221653,221986\n  )\n  and statusdescription != 'Rewritten' -- only valid orders\n)\n, vasocv1 as\n(\n  select\n    icustay_id, charttime, itemid\n    -- case statement determining whether the ITEMID is an instance of vasopressor usage\n    , 1 as vaso\n\n    -- the 'stopped' column indicates if a vasopressor has been disconnected\n    , max(case when (stopped = 'Stopped' OR stopped like 'D/C%') then 1\n          else 0 end) as vaso_stopped\n\n    , max(case when rate is not null then 1 else 0 end) as vaso_null\n    , max(rate) as vaso_rate\n    , max(amount) as vaso_amount\n\n  from io_cv\n  group by icustay_id, charttime, itemid\n)\n, vasocv2 as\n(\n  select v.*\n    , sum(vaso_null) over (partition by icustay_id, itemid order by charttime) as vaso_partition\n  from\n    vasocv1 v\n)\n, vasocv3 as\n(\n  select v.*\n    , first_value(vaso_rate) over (partition by icustay_id, itemid, vaso_partition order by charttime) as vaso_prevrate_ifnull\n  from\n    vasocv2 v\n)\n, vasocv4 as\n(\nselect\n    icustay_id\n    , charttime\n    , itemid\n    -- , (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) AS delta\n\n    , vaso\n    , vaso_rate\n    , vaso_amount\n    , vaso_stopped\n    , vaso_prevrate_ifnull\n\n    -- We define start time here\n    , case\n        when vaso = 0 then null\n\n        -- if this is the first instance of the vasoactive drug\n        when vaso_rate > 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, itemid, vaso, vaso_null\n          order by charttime\n          )\n          is null\n          then 1\n\n        -- you often get a string of 0s\n        -- we decide not to set these as 1, just because it makes vasonum sequential\n        when vaso_rate = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, itemid, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- sometimes you get a string of NULL, associated with 0 volumes\n        -- same reason as before, we decide not to set these as 1\n        -- vaso_prevrate_ifnull is equal to the previous value *iff* the current value is null\n        when vaso_prevrate_ifnull = 0 and\n          LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, itemid, vaso\n          order by charttime\n          )\n          = 0\n          then 0\n\n        -- If the last recorded rate was 0, newvaso = 1\n        when LAG(vaso_prevrate_ifnull,1)\n          OVER\n          (\n          partition by icustay_id, itemid, vaso\n          order by charttime\n          ) = 0\n          then 1\n\n        -- If the last recorded vaso was D/C'd, newvaso = 1\n        when\n          LAG(vaso_stopped,1)\n          OVER\n          (\n          partition by icustay_id, itemid, vaso\n          order by charttime\n          )\n          = 1 then 1\n\n        -- ** not sure if the below is needed\n        --when (CHARTTIME - (LAG(CHARTTIME, 1) OVER (partition by icustay_id, vaso order by charttime))) > (interval '4 hours') then 1\n      else null\n      end as vaso_start\n\nFROM\n  vasocv3\n)\n-- propagate start/stop flags forward in time\n, vasocv5 as\n(\n  select v.*\n    , SUM(vaso_start) OVER (partition by icustay_id, itemid, vaso order by charttime) as vaso_first\nFROM\n  vasocv4 v\n)\n, vasocv6 as\n(\n  select v.*\n    -- We define end time here\n    , case\n        when vaso = 0\n          then null\n\n        -- If the recorded vaso was D/C'd, this is an end time\n        when vaso_stopped = 1\n          then vaso_first\n\n        -- If the rate is zero, this is the end time\n        when vaso_rate = 0\n          then vaso_first\n\n        -- the last row in the table is always a potential end time\n        -- this captures patients who die/are discharged while on vasopressors\n        -- in principle, this could add an extra end time for the vasopressor\n        -- however, since we later group on vaso_start, any extra end times are ignored\n        when LEAD(CHARTTIME,1)\n          OVER\n          (\n          partition by icustay_id, itemid, vaso\n          order by charttime\n          ) is null\n          then vaso_first\n\n        else null\n        end as vaso_stop\n    from vasocv5 v\n)\n\n-- -- if you want to look at the results of the table before grouping:\n-- select\n--   icustay_id, charttime, vaso, vaso_rate, vaso_amount\n--     , case when vaso_stopped = 1 then 'Y' else '' end as stopped\n--     , vaso_start\n--     , vaso_first\n--     , vaso_stop\n-- from vasocv6 order by charttime\n\n\n, vasocv as\n(\n-- below groups together vasopressor administrations into groups\nselect\n  icustay_id\n  , itemid\n  -- the first non-null rate is considered the starttime\n  , min(case when vaso_rate is not null then charttime else null end) as starttime\n  -- the *first* time the first/last flags agree is the stop time for this duration\n  , min(case when vaso_first = vaso_stop then charttime else null end) as endtime\nfrom vasocv6\nwhere\n  vaso_first is not null -- bogus data\nand\n  vaso_first != 0 -- sometimes *only* a rate of 0 appears, i.e. the drug is never actually delivered\nand\n  icustay_id is not null -- there are data for \"floating\" admissions, we don't worry about these\ngroup by icustay_id, itemid, vaso_first\nhaving -- ensure start time is not the same as end time\n min(charttime) != min(case when vaso_first = vaso_stop then charttime else null end)\nand\n  max(vaso_rate) > 0 -- if the rate was always 0 or null, we consider it not a real drug delivery\n)\n-- we do not group by ITEMID in below query\n-- this is because we want to collapse all vasopressors together\n, vasocv_grp as\n(\nSELECT\n  s1.icustay_id,\n  s1.starttime,\n  MIN(t1.endtime) AS endtime\nFROM vasocv s1\nINNER JOIN vasocv t1\n  ON  s1.icustay_id = t1.icustay_id\n  AND s1.starttime <= t1.endtime\n  AND NOT EXISTS(SELECT * FROM vasocv t2\n                 WHERE t1.icustay_id = t2.icustay_id\n                 AND t1.endtime >= t2.starttime\n                 AND t1.endtime < t2.endtime)\nWHERE NOT EXISTS(SELECT * FROM vasocv s2\n                 WHERE s1.icustay_id = s2.icustay_id\n                 AND s1.starttime > s2.starttime\n                 AND s1.starttime <= s2.endtime)\nGROUP BY s1.icustay_id, s1.starttime\nORDER BY s1.icustay_id, s1.starttime\n)\n-- now we extract the associated data for metavision patients\n-- do not need to group by itemid because we group by linkorderid\n, vasomv as\n(\n  select\n    icustay_id, linkorderid\n    , min(starttime) as starttime, max(endtime) as endtime\n  from io_mv\n  group by icustay_id, linkorderid\n)\n, vasomv_grp as\n(\nSELECT\n  s1.icustay_id,\n  s1.starttime,\n  MIN(t1.endtime) AS endtime\nFROM vasomv s1\nINNER JOIN vasomv t1\n  ON  s1.icustay_id = t1.icustay_id\n  AND s1.starttime <= t1.endtime\n  AND NOT EXISTS(SELECT * FROM vasomv t2\n                 WHERE t1.icustay_id = t2.icustay_id\n                 AND t1.endtime >= t2.starttime\n                 AND t1.endtime < t2.endtime)\nWHERE NOT EXISTS(SELECT * FROM vasomv s2\n                 WHERE s1.icustay_id = s2.icustay_id\n                 AND s1.starttime > s2.starttime\n                 AND s1.starttime <= s2.endtime)\nGROUP BY s1.icustay_id, s1.starttime\nORDER BY s1.icustay_id, s1.starttime\n)\nselect\n  icustay_id\n  -- generate a sequential integer for convenience\n  , ROW_NUMBER() over (partition by icustay_id order by starttime) as vasonum\n  , starttime, endtime\n  , DATETIME_DIFF(endtime, starttime, 'HOUR') AS duration_hours\n  -- add durations\nfrom\n  vasocv_grp\n\nUNION ALL\n\nselect\n  icustay_id\n  , ROW_NUMBER() over (partition by icustay_id order by starttime) as vasonum\n  , starttime, endtime\n  , DATETIME_DIFF(endtime, starttime, 'HOUR') AS duration_hours\n  -- add durations\nfrom\n  vasomv_grp\n\norder by icustay_id, vasonum",
        "tables": [
            "mimiciii_clinical.inputevents_cv",
            "mimiciii_clinical.inputevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "vasonum": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "starttime": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "endtime": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "duration_hours": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ]
        },
        "table_name": "mimiciii_clinical.vasopressor_durations",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "vasocv_grp.icustay_id",
                "(row_number() OVER (?))",
                "vasocv_grp.starttime",
                "vasocv_grp.endtime",
                "(datetime_diff(vasocv_grp.endtime, vasocv_grp.starttime, 'HOUR'::text))"
            ],
            "Sort Key": [
                "vasocv_grp.icustay_id",
                "(row_number() OVER (?))"
            ],
            "Plans": [
                {
                    "Node Type": "Bitmap Heap Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE io_cv",
                    "Parallel Aware": false,
                    "Relation Name": "inputevents_cv",
                    "Schema": "mimiciii_clinical",
                    "Alias": "inputevents_cv",
                    "Output": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime",
                        "inputevents_cv.itemid",
                        "inputevents_cv.stopped",
                        "CASE WHEN (inputevents_cv.itemid = ANY ('{42273,42802}'::integer[])) THEN inputevents_cv.amount ELSE inputevents_cv.rate END",
                        "CASE WHEN (inputevents_cv.itemid = ANY ('{42273,42802}'::integer[])) THEN inputevents_cv.rate ELSE inputevents_cv.amount END"
                    ],
                    "Recheck Cond": "(inputevents_cv.itemid = ANY ('{30047,30120,30044,30119,30309,30127,30128,30051,30043,30307,30042,30306,30125,42273,42802}'::integer[]))",
                    "Plans": [
                        {
                            "Node Type": "Bitmap Index Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Index Name": "inputevents_cv_idx05",
                            "Index Cond": "(inputevents_cv.itemid = ANY ('{30047,30120,30044,30119,30309,30127,30128,30051,30043,30307,30042,30306,30125,42273,42802}'::integer[]))"
                        }
                    ]
                },
                {
                    "Node Type": "Bitmap Heap Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE io_mv",
                    "Parallel Aware": false,
                    "Relation Name": "inputevents_mv",
                    "Schema": "mimiciii_clinical",
                    "Alias": "io",
                    "Output": [
                        "io.icustay_id",
                        "io.linkorderid",
                        "io.starttime",
                        "io.endtime"
                    ],
                    "Recheck Cond": "(io.itemid = ANY ('{221906,221289,221749,222315,221662,221653,221986}'::integer[]))",
                    "Filter": "((io.statusdescription)::text <> 'Rewritten'::text)",
                    "Plans": [
                        {
                            "Node Type": "Bitmap Index Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Index Name": "inputevents_mv_idx05",
                            "Index Cond": "(io.itemid = ANY ('{221906,221289,221749,222315,221662,221653,221986}'::integer[]))"
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv1",
                    "Parallel Aware": false,
                    "Output": [
                        "io_cv.icustay_id",
                        "io_cv.charttime",
                        "io_cv.itemid",
                        "1",
                        "max(CASE WHEN (((io_cv.stopped)::text = 'Stopped'::text) OR ((io_cv.stopped)::text ~~ 'D/C%'::text)) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN (io_cv.rate IS NOT NULL) THEN 1 ELSE 0 END)",
                        "max(io_cv.rate)",
                        "max(io_cv.amount)"
                    ],
                    "Group Key": [
                        "io_cv.icustay_id",
                        "io_cv.charttime",
                        "io_cv.itemid"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "io_cv.icustay_id",
                                "io_cv.charttime",
                                "io_cv.itemid",
                                "io_cv.stopped",
                                "io_cv.rate",
                                "io_cv.amount"
                            ],
                            "Sort Key": [
                                "io_cv.icustay_id",
                                "io_cv.charttime",
                                "io_cv.itemid"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "io_cv",
                                    "Alias": "io_cv",
                                    "Output": [
                                        "io_cv.icustay_id",
                                        "io_cv.charttime",
                                        "io_cv.itemid",
                                        "io_cv.stopped",
                                        "io_cv.rate",
                                        "io_cv.amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv2",
                    "Parallel Aware": false,
                    "Output": [
                        "v.icustay_id",
                        "v.charttime",
                        "v.itemid",
                        "v.vaso",
                        "v.vaso_stopped",
                        "v.vaso_null",
                        "v.vaso_rate",
                        "v.vaso_amount",
                        "sum(v.vaso_null) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v.icustay_id",
                                "v.charttime",
                                "v.itemid",
                                "v.vaso",
                                "v.vaso_stopped",
                                "v.vaso_null",
                                "v.vaso_rate",
                                "v.vaso_amount"
                            ],
                            "Sort Key": [
                                "v.icustay_id",
                                "v.itemid",
                                "v.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv1",
                                    "Alias": "v",
                                    "Output": [
                                        "v.icustay_id",
                                        "v.charttime",
                                        "v.itemid",
                                        "v.vaso",
                                        "v.vaso_stopped",
                                        "v.vaso_null",
                                        "v.vaso_rate",
                                        "v.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv3",
                    "Parallel Aware": false,
                    "Output": [
                        "v_1.icustay_id",
                        "v_1.charttime",
                        "v_1.itemid",
                        "v_1.vaso",
                        "v_1.vaso_stopped",
                        "v_1.vaso_null",
                        "v_1.vaso_rate",
                        "v_1.vaso_amount",
                        "v_1.vaso_partition",
                        "first_value(v_1.vaso_rate) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_1.icustay_id",
                                "v_1.charttime",
                                "v_1.itemid",
                                "v_1.vaso_partition",
                                "v_1.vaso",
                                "v_1.vaso_stopped",
                                "v_1.vaso_null",
                                "v_1.vaso_rate",
                                "v_1.vaso_amount"
                            ],
                            "Sort Key": [
                                "v_1.icustay_id",
                                "v_1.itemid",
                                "v_1.vaso_partition",
                                "v_1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv2",
                                    "Alias": "v_1",
                                    "Output": [
                                        "v_1.icustay_id",
                                        "v_1.charttime",
                                        "v_1.itemid",
                                        "v_1.vaso_partition",
                                        "v_1.vaso",
                                        "v_1.vaso_stopped",
                                        "v_1.vaso_null",
                                        "v_1.vaso_rate",
                                        "v_1.vaso_amount"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv4",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv3.icustay_id",
                        "vasocv3.charttime",
                        "vasocv3.itemid",
                        "vasocv3.vaso",
                        "vasocv3.vaso_rate",
                        "vasocv3.vaso_amount",
                        "vasocv3.vaso_stopped",
                        "vasocv3.vaso_prevrate_ifnull",
                        "CASE WHEN (vasocv3.vaso = 0) THEN NULL::integer WHEN ((vasocv3.vaso_rate > '0'::double precision) AND ((lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)) IS NULL)) THEN 1 WHEN ((vasocv3.vaso_rate = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN ((vasocv3.vaso_prevrate_ifnull = '0'::double precision) AND (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision)) THEN 0 WHEN (lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?) = '0'::double precision) THEN 1 WHEN (lag(vasocv3.vaso_stopped, 1) OVER (?) = 1) THEN 1 ELSE NULL::integer END",
                        "vasocv3.vaso_null"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv3.icustay_id",
                                "vasocv3.charttime",
                                "vasocv3.itemid",
                                "vasocv3.vaso",
                                "vasocv3.vaso_null",
                                "vasocv3.vaso_rate",
                                "vasocv3.vaso_amount",
                                "vasocv3.vaso_stopped",
                                "vasocv3.vaso_prevrate_ifnull",
                                "(lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?))"
                            ],
                            "Sort Key": [
                                "vasocv3.icustay_id",
                                "vasocv3.itemid",
                                "vasocv3.vaso",
                                "vasocv3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "WindowAgg",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv3.icustay_id",
                                        "vasocv3.charttime",
                                        "vasocv3.itemid",
                                        "vasocv3.vaso",
                                        "vasocv3.vaso_null",
                                        "vasocv3.vaso_rate",
                                        "vasocv3.vaso_amount",
                                        "vasocv3.vaso_stopped",
                                        "vasocv3.vaso_prevrate_ifnull",
                                        "lag(vasocv3.vaso_prevrate_ifnull, 1) OVER (?)"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.charttime",
                                                "vasocv3.itemid",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.vaso_rate",
                                                "vasocv3.vaso_amount",
                                                "vasocv3.vaso_stopped",
                                                "vasocv3.vaso_prevrate_ifnull"
                                            ],
                                            "Sort Key": [
                                                "vasocv3.icustay_id",
                                                "vasocv3.itemid",
                                                "vasocv3.vaso",
                                                "vasocv3.vaso_null",
                                                "vasocv3.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "vasocv3",
                                                    "Alias": "vasocv3",
                                                    "Output": [
                                                        "vasocv3.icustay_id",
                                                        "vasocv3.charttime",
                                                        "vasocv3.itemid",
                                                        "vasocv3.vaso",
                                                        "vasocv3.vaso_null",
                                                        "vasocv3.vaso_rate",
                                                        "vasocv3.vaso_amount",
                                                        "vasocv3.vaso_stopped",
                                                        "vasocv3.vaso_prevrate_ifnull"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv5",
                    "Parallel Aware": false,
                    "Output": [
                        "v_2.icustay_id",
                        "v_2.charttime",
                        "v_2.itemid",
                        "v_2.vaso",
                        "v_2.vaso_rate",
                        "v_2.vaso_amount",
                        "v_2.vaso_stopped",
                        "v_2.vaso_prevrate_ifnull",
                        "v_2.vaso_start",
                        "sum(v_2.vaso_start) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_2.icustay_id",
                                "v_2.charttime",
                                "v_2.itemid",
                                "v_2.vaso",
                                "v_2.vaso_rate",
                                "v_2.vaso_amount",
                                "v_2.vaso_stopped",
                                "v_2.vaso_prevrate_ifnull",
                                "v_2.vaso_start"
                            ],
                            "Sort Key": [
                                "v_2.icustay_id",
                                "v_2.itemid",
                                "v_2.vaso",
                                "v_2.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv4",
                                    "Alias": "v_2",
                                    "Output": [
                                        "v_2.icustay_id",
                                        "v_2.charttime",
                                        "v_2.itemid",
                                        "v_2.vaso",
                                        "v_2.vaso_rate",
                                        "v_2.vaso_amount",
                                        "v_2.vaso_stopped",
                                        "v_2.vaso_prevrate_ifnull",
                                        "v_2.vaso_start"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv6",
                    "Parallel Aware": false,
                    "Output": [
                        "v_3.icustay_id",
                        "v_3.charttime",
                        "v_3.itemid",
                        "v_3.vaso",
                        "v_3.vaso_rate",
                        "v_3.vaso_amount",
                        "v_3.vaso_stopped",
                        "v_3.vaso_prevrate_ifnull",
                        "v_3.vaso_start",
                        "v_3.vaso_first",
                        "CASE WHEN (v_3.vaso = 0) THEN NULL::bigint WHEN (v_3.vaso_stopped = 1) THEN v_3.vaso_first WHEN (v_3.vaso_rate = '0'::double precision) THEN v_3.vaso_first WHEN (lead(v_3.charttime, 1) OVER (?) IS NULL) THEN v_3.vaso_first ELSE NULL::bigint END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "v_3.icustay_id",
                                "v_3.charttime",
                                "v_3.itemid",
                                "v_3.vaso",
                                "v_3.vaso_rate",
                                "v_3.vaso_amount",
                                "v_3.vaso_stopped",
                                "v_3.vaso_prevrate_ifnull",
                                "v_3.vaso_start",
                                "v_3.vaso_first"
                            ],
                            "Sort Key": [
                                "v_3.icustay_id",
                                "v_3.itemid",
                                "v_3.vaso",
                                "v_3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vasocv5",
                                    "Alias": "v_3",
                                    "Output": [
                                        "v_3.icustay_id",
                                        "v_3.charttime",
                                        "v_3.itemid",
                                        "v_3.vaso",
                                        "v_3.vaso_rate",
                                        "v_3.vaso_amount",
                                        "v_3.vaso_stopped",
                                        "v_3.vaso_prevrate_ifnull",
                                        "v_3.vaso_start",
                                        "v_3.vaso_first"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv",
                    "Parallel Aware": false,
                    "Output": [
                        "vasocv6.icustay_id",
                        "vasocv6.itemid",
                        "min(CASE WHEN (vasocv6.vaso_rate IS NOT NULL) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)",
                        "min(CASE WHEN (vasocv6.vaso_first = vasocv6.vaso_stop) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)",
                        "vasocv6.vaso_first"
                    ],
                    "Group Key": [
                        "vasocv6.icustay_id",
                        "vasocv6.itemid",
                        "vasocv6.vaso_first"
                    ],
                    "Filter": "((min(vasocv6.charttime) <> min(CASE WHEN (vasocv6.vaso_first = vasocv6.vaso_stop) THEN vasocv6.charttime ELSE NULL::timestamp without time zone END)) AND (max(vasocv6.vaso_rate) > '0'::double precision))",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "vasocv6",
                            "Alias": "vasocv6",
                            "Output": [
                                "vasocv6.icustay_id",
                                "vasocv6.charttime",
                                "vasocv6.itemid",
                                "vasocv6.vaso",
                                "vasocv6.vaso_rate",
                                "vasocv6.vaso_amount",
                                "vasocv6.vaso_stopped",
                                "vasocv6.vaso_prevrate_ifnull",
                                "vasocv6.vaso_start",
                                "vasocv6.vaso_first",
                                "vasocv6.vaso_stop"
                            ],
                            "Filter": "((vasocv6.vaso_first IS NOT NULL) AND (vasocv6.icustay_id IS NOT NULL) AND (vasocv6.vaso_first <> 0))"
                        }
                    ]
                },
                {
                    "Node Type": "Sort",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasocv_grp",
                    "Parallel Aware": false,
                    "Output": [
                        "s1.icustay_id",
                        "s1.starttime",
                        "(min(t1.endtime))"
                    ],
                    "Sort Key": [
                        "s1.icustay_id",
                        "s1.starttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Aggregate",
                            "Strategy": "Hashed",
                            "Partial Mode": "Simple",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "s1.icustay_id",
                                "s1.starttime",
                                "min(t1.endtime)"
                            ],
                            "Group Key": [
                                "s1.icustay_id",
                                "s1.starttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Merge Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "s1.icustay_id",
                                        "s1.starttime",
                                        "t1.endtime"
                                    ],
                                    "Inner Unique": false,
                                    "Merge Cond": "(s1.icustay_id = t1.icustay_id)",
                                    "Join Filter": "(s1.starttime <= t1.endtime)",
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "s1.icustay_id",
                                                "s1.starttime"
                                            ],
                                            "Sort Key": [
                                                "s1.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Hash Join",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Join Type": "Anti",
                                                    "Output": [
                                                        "s1.icustay_id",
                                                        "s1.starttime"
                                                    ],
                                                    "Inner Unique": false,
                                                    "Hash Cond": "(s1.icustay_id = s2.icustay_id)",
                                                    "Join Filter": "((s1.starttime > s2.starttime) AND (s1.starttime <= s2.endtime))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "CTE Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "CTE Name": "vasocv",
                                                            "Alias": "s1",
                                                            "Output": [
                                                                "s1.icustay_id",
                                                                "s1.itemid",
                                                                "s1.starttime",
                                                                "s1.endtime"
                                                            ]
                                                        },
                                                        {
                                                            "Node Type": "Hash",
                                                            "Parent Relationship": "Inner",
                                                            "Parallel Aware": false,
                                                            "Output": [
                                                                "s2.icustay_id",
                                                                "s2.starttime",
                                                                "s2.endtime"
                                                            ],
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "CTE Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "CTE Name": "vasocv",
                                                                    "Alias": "s2",
                                                                    "Output": [
                                                                        "s2.icustay_id",
                                                                        "s2.starttime",
                                                                        "s2.endtime"
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "t1.endtime",
                                                "t1.icustay_id"
                                            ],
                                            "Sort Key": [
                                                "t1.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Hash Join",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Join Type": "Anti",
                                                    "Output": [
                                                        "t1.endtime",
                                                        "t1.icustay_id"
                                                    ],
                                                    "Inner Unique": false,
                                                    "Hash Cond": "(t1.icustay_id = t2.icustay_id)",
                                                    "Join Filter": "((t1.endtime >= t2.starttime) AND (t1.endtime < t2.endtime))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "CTE Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "CTE Name": "vasocv",
                                                            "Alias": "t1",
                                                            "Output": [
                                                                "t1.icustay_id",
                                                                "t1.itemid",
                                                                "t1.starttime",
                                                                "t1.endtime"
                                                            ]
                                                        },
                                                        {
                                                            "Node Type": "Hash",
                                                            "Parent Relationship": "Inner",
                                                            "Parallel Aware": false,
                                                            "Output": [
                                                                "t2.icustay_id",
                                                                "t2.starttime",
                                                                "t2.endtime"
                                                            ],
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "CTE Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "CTE Name": "vasocv",
                                                                    "Alias": "t2",
                                                                    "Output": [
                                                                        "t2.icustay_id",
                                                                        "t2.starttime",
                                                                        "t2.endtime"
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasomv",
                    "Parallel Aware": false,
                    "Output": [
                        "io_mv.icustay_id",
                        "io_mv.linkorderid",
                        "min(io_mv.starttime)",
                        "max(io_mv.endtime)"
                    ],
                    "Group Key": [
                        "io_mv.icustay_id",
                        "io_mv.linkorderid"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "io_mv",
                            "Alias": "io_mv",
                            "Output": [
                                "io_mv.icustay_id",
                                "io_mv.linkorderid",
                                "io_mv.starttime",
                                "io_mv.endtime"
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Sort",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vasomv_grp",
                    "Parallel Aware": false,
                    "Output": [
                        "s1_1.icustay_id",
                        "s1_1.starttime",
                        "(min(t1_1.endtime))"
                    ],
                    "Sort Key": [
                        "s1_1.icustay_id",
                        "s1_1.starttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Aggregate",
                            "Strategy": "Hashed",
                            "Partial Mode": "Simple",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "s1_1.icustay_id",
                                "s1_1.starttime",
                                "min(t1_1.endtime)"
                            ],
                            "Group Key": [
                                "s1_1.icustay_id",
                                "s1_1.starttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Merge Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "s1_1.icustay_id",
                                        "s1_1.starttime",
                                        "t1_1.endtime"
                                    ],
                                    "Inner Unique": false,
                                    "Merge Cond": "(s1_1.icustay_id = t1_1.icustay_id)",
                                    "Join Filter": "(s1_1.starttime <= t1_1.endtime)",
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "s1_1.icustay_id",
                                                "s1_1.starttime"
                                            ],
                                            "Sort Key": [
                                                "s1_1.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Hash Join",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Join Type": "Anti",
                                                    "Output": [
                                                        "s1_1.icustay_id",
                                                        "s1_1.starttime"
                                                    ],
                                                    "Inner Unique": false,
                                                    "Hash Cond": "(s1_1.icustay_id = s2_1.icustay_id)",
                                                    "Join Filter": "((s1_1.starttime > s2_1.starttime) AND (s1_1.starttime <= s2_1.endtime))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "CTE Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "CTE Name": "vasomv",
                                                            "Alias": "s1_1",
                                                            "Output": [
                                                                "s1_1.icustay_id",
                                                                "s1_1.linkorderid",
                                                                "s1_1.starttime",
                                                                "s1_1.endtime"
                                                            ]
                                                        },
                                                        {
                                                            "Node Type": "Hash",
                                                            "Parent Relationship": "Inner",
                                                            "Parallel Aware": false,
                                                            "Output": [
                                                                "s2_1.icustay_id",
                                                                "s2_1.starttime",
                                                                "s2_1.endtime"
                                                            ],
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "CTE Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "CTE Name": "vasomv",
                                                                    "Alias": "s2_1",
                                                                    "Output": [
                                                                        "s2_1.icustay_id",
                                                                        "s2_1.starttime",
                                                                        "s2_1.endtime"
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "t1_1.endtime",
                                                "t1_1.icustay_id"
                                            ],
                                            "Sort Key": [
                                                "t1_1.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Hash Join",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Join Type": "Anti",
                                                    "Output": [
                                                        "t1_1.endtime",
                                                        "t1_1.icustay_id"
                                                    ],
                                                    "Inner Unique": false,
                                                    "Hash Cond": "(t1_1.icustay_id = t2_1.icustay_id)",
                                                    "Join Filter": "((t1_1.endtime >= t2_1.starttime) AND (t1_1.endtime < t2_1.endtime))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "CTE Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "CTE Name": "vasomv",
                                                            "Alias": "t1_1",
                                                            "Output": [
                                                                "t1_1.icustay_id",
                                                                "t1_1.linkorderid",
                                                                "t1_1.starttime",
                                                                "t1_1.endtime"
                                                            ]
                                                        },
                                                        {
                                                            "Node Type": "Hash",
                                                            "Parent Relationship": "Inner",
                                                            "Parallel Aware": false,
                                                            "Output": [
                                                                "t2_1.icustay_id",
                                                                "t2_1.starttime",
                                                                "t2_1.endtime"
                                                            ],
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "CTE Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "CTE Name": "vasomv",
                                                                    "Alias": "t2_1",
                                                                    "Output": [
                                                                        "t2_1.icustay_id",
                                                                        "t2_1.starttime",
                                                                        "t2_1.endtime"
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "vasocv_grp.icustay_id",
                                "row_number() OVER (?)",
                                "vasocv_grp.starttime",
                                "vasocv_grp.endtime",
                                "datetime_diff(vasocv_grp.endtime, vasocv_grp.starttime, 'HOUR'::text)"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasocv_grp.icustay_id",
                                        "vasocv_grp.starttime",
                                        "vasocv_grp.endtime"
                                    ],
                                    "Sort Key": [
                                        "vasocv_grp.icustay_id",
                                        "vasocv_grp.starttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "vasocv_grp",
                                            "Alias": "vasocv_grp",
                                            "Output": [
                                                "vasocv_grp.icustay_id",
                                                "vasocv_grp.starttime",
                                                "vasocv_grp.endtime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "vasomv_grp.icustay_id",
                                "row_number() OVER (?)",
                                "vasomv_grp.starttime",
                                "vasomv_grp.endtime",
                                "datetime_diff(vasomv_grp.endtime, vasomv_grp.starttime, 'HOUR'::text)"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vasomv_grp.icustay_id",
                                        "vasomv_grp.starttime",
                                        "vasomv_grp.endtime"
                                    ],
                                    "Sort Key": [
                                        "vasomv_grp.icustay_id",
                                        "vasomv_grp.starttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "vasomv_grp",
                                            "Alias": "vasomv_grp",
                                            "Output": [
                                                "vasomv_grp.icustay_id",
                                                "vasomv_grp.starttime",
                                                "vasomv_grp.endtime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.ventilation_durations": {
        "sql": "-- This query extracts the duration of mechanical ventilation\n-- The main goal of the query is to aggregate sequential ventilator settings\n-- into single mechanical ventilation \"events\". The start and end time of these\n-- events can then be used for various purposes: calculating the total duration\n-- of mechanical ventilation, cross-checking values (e.g. PaO2:FiO2 on vent), etc\n\n-- The query's logic is roughly:\n--    1) The presence of a mechanical ventilation setting starts a new ventilation event\n--    2) Any instance of a setting in the next 8 hours continues the event\n--    3) Certain elements end the current ventilation event\n--        a) documented extubation ends the current ventilation\n--        b) initiation of non-invasive vent and/or oxygen ends the current vent\n\n-- See the ventilation_classification.sql query for step 1 of the above.\n-- This query has the logic for converting events into durations.\nwith vd0 as\n(\n  select\n    icustay_id\n    -- this carries over the previous charttime which had a mechanical ventilation event\n    , case\n        when MechVent=1 then\n          LAG(CHARTTIME, 1) OVER (partition by icustay_id, MechVent order by charttime)\n        else null\n      end as charttime_lag\n    , charttime\n    , MechVent\n    , OxygenTherapy\n    , Extubated\n    , SelfExtubated\n  from \"mimic\".\"mimiciii_clinical\".\"ventilation_classification\"\n)\n, vd1 as\n(\n  select\n      icustay_id\n      , charttime_lag\n      , charttime\n      , MechVent\n      , OxygenTherapy\n      , Extubated\n      , SelfExtubated\n\n      -- if this is a mechanical ventilation event, we calculate the time since the last event\n      , case\n          -- if the current observation indicates mechanical ventilation is present\n          -- calculate the time since the last vent event\n          when MechVent=1 then\n            DATETIME_DIFF(CHARTTIME, charttime_lag, 'MINUTE')/60\n          else null\n        end as ventduration\n\n      , LAG(Extubated,1)\n      OVER\n      (\n      partition by icustay_id, case when MechVent=1 or Extubated=1 then 1 else 0 end\n      order by charttime\n      ) as ExtubatedLag\n\n      -- now we determine if the current mech vent event is a \"new\", i.e. they've just been intubated\n      , case\n        -- if there is an extubation flag, we mark any subsequent ventilation as a new ventilation event\n          --when Extubated = 1 then 0 -- extubation is *not* a new ventilation event, the *subsequent* row is\n          when\n            LAG(Extubated,1)\n            OVER\n            (\n            partition by icustay_id, case when MechVent=1 or Extubated=1 then 1 else 0 end\n            order by charttime\n            )\n            = 1 then 1\n          -- if patient has initiated oxygen therapy, and is not currently vented, start a newvent\n          when MechVent = 0 and OxygenTherapy = 1 then 1\n            -- if there is less than 8 hours between vent settings, we do not treat this as a new ventilation event\n          when CHARTTIME > DATETIME_ADD(charttime_lag, INTERVAL '8' HOUR)\n            then 1\n        else 0\n        end as newvent\n  -- use the staging table with only vent settings from chart events\n  FROM vd0 ventsettings\n)\n, vd2 as\n(\n  select vd1.*\n  -- create a cumulative sum of the instances of new ventilation\n  -- this results in a monotonic integer assigned to each instance of ventilation\n  , case when MechVent=1 or Extubated = 1 then\n      SUM( newvent )\n      OVER ( partition by icustay_id order by charttime )\n    else null end\n    as ventnum\n  --- now we convert CHARTTIME of ventilator settings into durations\n  from vd1\n)\n-- create the durations for each mechanical ventilation instance\nselect icustay_id\n  -- regenerate ventnum so it's sequential\n  , ROW_NUMBER() over (partition by icustay_id order by ventnum) as ventnum\n  , min(charttime) as starttime\n  , max(charttime) as endtime\n  , DATETIME_DIFF(max(charttime), min(charttime), 'MINUTE')/60 AS duration_hours\nfrom vd2\ngroup by icustay_id, vd2.ventnum\nhaving min(charttime) != max(charttime)\n-- patient had to be mechanically ventilated at least once\n-- i.e. max(mechvent) should be 1\n-- this excludes a frequent situation of NIV/oxygen before intub\n-- in these cases, ventnum=0 and max(mechvent)=0, so they are ignored\nand max(mechvent) = 1\norder by icustay_id, ventnum",
        "tables": [
            "mimiciii_clinical.ventilation_classification"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.ventilation_classification.charttime",
                "mimiciii_clinical.ventilation_classification.extubated",
                "mimiciii_clinical.ventilation_classification.icustay_id",
                "mimiciii_clinical.ventilation_classification.mechvent",
                "mimiciii_clinical.ventilation_classification.oxygentherapy"
            ],
            "ventnum": [
                "mimiciii_clinical.ventilation_classification.charttime",
                "mimiciii_clinical.ventilation_classification.extubated",
                "mimiciii_clinical.ventilation_classification.icustay_id",
                "mimiciii_clinical.ventilation_classification.mechvent",
                "mimiciii_clinical.ventilation_classification.oxygentherapy"
            ],
            "starttime": [
                "mimiciii_clinical.ventilation_classification.charttime",
                "mimiciii_clinical.ventilation_classification.extubated",
                "mimiciii_clinical.ventilation_classification.icustay_id",
                "mimiciii_clinical.ventilation_classification.mechvent",
                "mimiciii_clinical.ventilation_classification.oxygentherapy"
            ],
            "endtime": [
                "mimiciii_clinical.ventilation_classification.charttime",
                "mimiciii_clinical.ventilation_classification.extubated",
                "mimiciii_clinical.ventilation_classification.icustay_id",
                "mimiciii_clinical.ventilation_classification.mechvent",
                "mimiciii_clinical.ventilation_classification.oxygentherapy"
            ],
            "duration_hours": [
                "mimiciii_clinical.ventilation_classification.charttime",
                "mimiciii_clinical.ventilation_classification.extubated",
                "mimiciii_clinical.ventilation_classification.icustay_id",
                "mimiciii_clinical.ventilation_classification.mechvent",
                "mimiciii_clinical.ventilation_classification.oxygentherapy"
            ]
        },
        "table_name": "mimiciii_clinical.ventilation_durations",
        "plan": {
            "Node Type": "Result",
            "Parallel Aware": false,
            "Output": [
                "vd2.icustay_id",
                "(row_number() OVER (?))",
                "(min(vd2.charttime))",
                "(max(vd2.charttime))",
                "(datetime_diff((max(vd2.charttime)), (min(vd2.charttime)), 'MINUTE'::text) / '60'::numeric)",
                "vd2.ventnum"
            ],
            "Plans": [
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vd0",
                    "Parallel Aware": false,
                    "Output": [
                        "ventilation_classification.icustay_id",
                        "CASE WHEN (ventilation_classification.mechvent = 1) THEN lag(ventilation_classification.charttime, 1) OVER (?) ELSE NULL::timestamp without time zone END",
                        "ventilation_classification.charttime",
                        "ventilation_classification.mechvent",
                        "ventilation_classification.oxygentherapy",
                        "ventilation_classification.extubated",
                        "ventilation_classification.selfextubated"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ventilation_classification.icustay_id",
                                "ventilation_classification.charttime",
                                "ventilation_classification.mechvent",
                                "ventilation_classification.oxygentherapy",
                                "ventilation_classification.extubated",
                                "ventilation_classification.selfextubated"
                            ],
                            "Sort Key": [
                                "ventilation_classification.icustay_id",
                                "ventilation_classification.mechvent",
                                "ventilation_classification.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "ventilation_classification",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ventilation_classification",
                                    "Output": [
                                        "ventilation_classification.icustay_id",
                                        "ventilation_classification.charttime",
                                        "ventilation_classification.mechvent",
                                        "ventilation_classification.oxygentherapy",
                                        "ventilation_classification.extubated",
                                        "ventilation_classification.selfextubated"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vd1",
                    "Parallel Aware": false,
                    "Output": [
                        "ventsettings.icustay_id",
                        "ventsettings.charttime_lag",
                        "ventsettings.charttime",
                        "ventsettings.mechvent",
                        "ventsettings.oxygentherapy",
                        "ventsettings.extubated",
                        "ventsettings.selfextubated",
                        "CASE WHEN (ventsettings.mechvent = 1) THEN (datetime_diff(ventsettings.charttime, ventsettings.charttime_lag, 'MINUTE'::text) / '60'::numeric) ELSE NULL::numeric END",
                        "lag(ventsettings.extubated, 1) OVER (?)",
                        "CASE WHEN (lag(ventsettings.extubated, 1) OVER (?) = 1) THEN 1 WHEN ((ventsettings.mechvent = 0) AND (ventsettings.oxygentherapy = 1)) THEN 1 WHEN (ventsettings.charttime > datetime_add(ventsettings.charttime_lag, '08:00:00'::interval hour)) THEN 1 ELSE 0 END",
                        "(CASE WHEN ((ventsettings.mechvent = 1) OR (ventsettings.extubated = 1)) THEN 1 ELSE 0 END)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ventsettings.icustay_id",
                                "ventsettings.charttime",
                                "(CASE WHEN ((ventsettings.mechvent = 1) OR (ventsettings.extubated = 1)) THEN 1 ELSE 0 END)",
                                "ventsettings.charttime_lag",
                                "ventsettings.mechvent",
                                "ventsettings.oxygentherapy",
                                "ventsettings.extubated",
                                "ventsettings.selfextubated"
                            ],
                            "Sort Key": [
                                "ventsettings.icustay_id",
                                "(CASE WHEN ((ventsettings.mechvent = 1) OR (ventsettings.extubated = 1)) THEN 1 ELSE 0 END)",
                                "ventsettings.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vd0",
                                    "Alias": "ventsettings",
                                    "Output": [
                                        "ventsettings.icustay_id",
                                        "ventsettings.charttime",
                                        "CASE WHEN ((ventsettings.mechvent = 1) OR (ventsettings.extubated = 1)) THEN 1 ELSE 0 END",
                                        "ventsettings.charttime_lag",
                                        "ventsettings.mechvent",
                                        "ventsettings.oxygentherapy",
                                        "ventsettings.extubated",
                                        "ventsettings.selfextubated"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vd2",
                    "Parallel Aware": false,
                    "Output": [
                        "vd1.icustay_id",
                        "vd1.charttime_lag",
                        "vd1.charttime",
                        "vd1.mechvent",
                        "vd1.oxygentherapy",
                        "vd1.extubated",
                        "vd1.selfextubated",
                        "vd1.ventduration",
                        "vd1.extubatedlag",
                        "vd1.newvent",
                        "CASE WHEN ((vd1.mechvent = 1) OR (vd1.extubated = 1)) THEN sum(vd1.newvent) OVER (?) ELSE NULL::bigint END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vd1.icustay_id",
                                "vd1.charttime",
                                "vd1.charttime_lag",
                                "vd1.mechvent",
                                "vd1.oxygentherapy",
                                "vd1.extubated",
                                "vd1.selfextubated",
                                "vd1.ventduration",
                                "vd1.extubatedlag",
                                "vd1.newvent"
                            ],
                            "Sort Key": [
                                "vd1.icustay_id",
                                "vd1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "vd1",
                                    "Alias": "vd1",
                                    "Output": [
                                        "vd1.icustay_id",
                                        "vd1.charttime",
                                        "vd1.charttime_lag",
                                        "vd1.mechvent",
                                        "vd1.oxygentherapy",
                                        "vd1.extubated",
                                        "vd1.selfextubated",
                                        "vd1.ventduration",
                                        "vd1.extubatedlag",
                                        "vd1.newvent"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Sort",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "vd2.icustay_id",
                        "(row_number() OVER (?))",
                        "(min(vd2.charttime))",
                        "(max(vd2.charttime))",
                        "vd2.ventnum"
                    ],
                    "Sort Key": [
                        "vd2.icustay_id",
                        "(row_number() OVER (?))"
                    ],
                    "Plans": [
                        {
                            "Node Type": "WindowAgg",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "vd2.icustay_id",
                                "row_number() OVER (?)",
                                "(min(vd2.charttime))",
                                "(max(vd2.charttime))",
                                "vd2.ventnum"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Aggregate",
                                    "Strategy": "Sorted",
                                    "Partial Mode": "Simple",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vd2.icustay_id",
                                        "vd2.ventnum",
                                        "min(vd2.charttime)",
                                        "max(vd2.charttime)"
                                    ],
                                    "Group Key": [
                                        "vd2.icustay_id",
                                        "vd2.ventnum"
                                    ],
                                    "Filter": "((min(vd2.charttime) <> max(vd2.charttime)) AND (max(vd2.mechvent) = 1))",
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "vd2.icustay_id",
                                                "vd2.ventnum",
                                                "vd2.charttime",
                                                "vd2.mechvent"
                                            ],
                                            "Sort Key": [
                                                "vd2.icustay_id",
                                                "vd2.ventnum"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "vd2",
                                                    "Alias": "vd2",
                                                    "Output": [
                                                        "vd2.icustay_id",
                                                        "vd2.ventnum",
                                                        "vd2.charttime",
                                                        "vd2.mechvent"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.weight_durations": {
        "sql": "-- This query extracts weights for adult ICU patients with start/stop times\n-- if an admission weight is given, then this is assigned from intime to outtime\n\n-- This query extracts weights for adult ICU patients with start/stop times\n-- if an admission weight is given, then this is assigned from intime to outtime\nWITH wt_neonate AS\n( \n    SELECT c.icustay_id, c.charttime\n    , MAX(CASE WHEN c.itemid = 3580 THEN c.valuenum END) as wt_kg\n    , MAX(CASE WHEN c.itemid = 3581 THEN c.valuenum END) as wt_lb\n    , MAX(CASE WHEN c.itemid = 3582 THEN c.valuenum END) as wt_oz\n    FROM chartevents c\n    WHERE c.itemid in (3580, 3581, 3582)\n    AND c.icustay_id IS NOT NULL\n    AND COALESCE(c.error, 0) = 0\n    -- wt_oz/wt_lb/wt_kg are only 0 erroneously, so drop these rows\n    AND c.valuenum > 0\n  -- a separate query was run to manually verify only 1 value exists per\n  -- icustay_id/charttime/itemid grouping\n  -- therefore, we can use max() across itemid to collapse these values to 1 row per group\n    GROUP BY c.icustay_id, c.charttime\n)\n, birth_wt AS\n(\n    SELECT c.icustay_id, c.charttime\n    , MAX(\n      CASE\n      WHEN c.itemid = 4183 THEN\n        -- clean free-text birth weight data\n        CASE\n          -- ignore value if there are any non-numeric characters\n          WHEN REGEXP_CONTAINS(c.value, '[^0-9\\\\.]') THEN NULL \n          -- convert grams to kd\n          WHEN CAST(c.value AS NUMERIC) > 100 THEN CAST(c.value AS NUMERIC)/1000\n          -- keep kg as is, filtering bad values (largest baby ever born was conveniently 9.98kg)\n          WHEN CAST(c.value AS NUMERIC) < 10 THEN CAST(c.value AS NUMERIC)\n          -- ignore other values (those between 10-100) - junk data\n        ELSE NULL END\n      -- itemid 3723 happily has all numeric data - also doesn't store any grams data\n      WHEN c.itemid = 3723 AND c.valuenum < 10 THEN c.valuenum\n      ELSE NULL END) as wt_kg\n    FROM chartevents c\n    WHERE c.itemid in (3723, 4183)\n    AND c.icustay_id IS NOT NULL\n    AND COALESCE(c.error, 0) = 0\n  -- a separate query was run to manually verify only 1 value exists per\n  -- icustay_id/charttime/itemid grouping\n  -- therefore, we can use max() across itemid to collapse these values to 1 row per group\n    GROUP BY c.icustay_id, c.charttime\n)\n, wt_stg as\n(\n    SELECT\n        c.icustay_id\n      , c.charttime\n      , case when c.itemid in (762,226512) then 'admit'\n          else 'daily' end as weight_type\n      -- TODO: eliminate obvious outliers if there is a reasonable weight\n      , c.valuenum as weight\n    FROM chartevents c\n    WHERE c.valuenum IS NOT NULL\n      AND c.itemid in\n      (\n          762,226512 -- Admit Wt\n        , 763,224639 -- Daily Weight\n      )\n      AND c.icustay_id IS NOT NULL\n      AND c.valuenum > 0\n      -- exclude rows marked as error\n      AND COALESCE(c.error, 0) = 0\n    UNION ALL\n    SELECT\n        n.icustay_id\n      , n.charttime\n      , 'daily' AS weight_type\n      , CASE\n          WHEN wt_kg IS NOT NULL THEN wt_kg\n          WHEN wt_lb IS NOT NULL THEN wt_lb*0.45359237 + wt_oz*0.0283495231\n        ELSE NULL END AS weight\n    FROM wt_neonate n\n    UNION ALL\n    SELECT\n        b.icustay_id\n      , b.charttime\n      -- birth weight of neonates is treated as admission weight\n      , 'admit' AS weight_type\n      , wt_kg as weight\n    FROM birth_wt b\n)\n-- get more weights from echo - completes data for ~2500 patients\n-- we only use echo data if there is *no* charted data\n-- we impute the median echo weight for their entire ICU stay\n, echo as\n(\n  select\n    ie.icustay_id\n    , ec.charttime\n    , 'echo' AS weight_type\n    , 0.453592*ec.weight as weight\n  from icustays ie\n  inner join \"mimic\".\"mimiciii_clinical\".\"echo_data\" ec\n    on ie.hadm_id = ec.hadm_id\n  where ec.weight is not null\n  and ie.icustay_id not in (select distinct icustay_id from wt_stg)\n)\n, wt_stg0 AS\n(\n  SELECT icustay_id, charttime, weight_type, weight\n  FROM wt_stg\n  UNION ALL\n  SELECT icustay_id, charttime, weight_type, weight\n  FROM echo\n)\n-- assign ascending row number\n, wt_stg1 as\n(\n  select\n      icustay_id\n    , charttime\n    , weight_type\n    , weight\n    , ROW_NUMBER() OVER (partition by icustay_id, weight_type order by charttime) as rn\n  from wt_stg0\n  WHERE weight IS NOT NULL\n)\n-- change charttime to intime for the first admission weight recorded\n, wt_stg2 AS\n(\n  SELECT \n      wt_stg1.icustay_id\n    , ie.intime, ie.outtime\n    , case when wt_stg1.weight_type = 'admit' and wt_stg1.rn = 1\n        then DATETIME_SUB(ie.intime, INTERVAL '2' HOUR)\n      else wt_stg1.charttime end as starttime\n    , wt_stg1.weight\n  from wt_stg1\n  INNER JOIN icustays ie\n    on ie.icustay_id = wt_stg1.icustay_id\n)\n, wt_stg3 as\n(\n  select\n    icustay_id\n    , intime, outtime\n    , starttime\n    , coalesce(\n        LEAD(starttime) OVER (PARTITION BY icustay_id ORDER BY starttime),\n        DATETIME_ADD(GREATEST(outtime, starttime), INTERVAL '2' HOUR)\n      ) as endtime\n    , weight\n  from wt_stg2\n)\n-- this table is the start/stop times from admit/daily weight in charted data\n, wt1 as\n(\n  select\n      icustay_id\n    , starttime\n    , coalesce(endtime,\n      LEAD(starttime) OVER (partition by icustay_id order by starttime),\n      -- impute ICU discharge as the end of the final weight measurement\n      -- plus a 2 hour \"fuzziness\" window\n      DATETIME_ADD(outtime, INTERVAL '2' HOUR)\n    ) as endtime\n    , weight\n  from wt_stg3\n)\n-- if the intime for the patient is < the first charted daily weight\n-- then we will have a \"gap\" at the start of their stay\n-- to prevent this, we look for these gaps and backfill the first weight\n-- this adds (153255-149657)=3598 rows, meaning this fix helps for up to 3598 icustay_id\n, wt_fix as\n(\n  select ie.icustay_id\n    -- we add a 2 hour \"fuzziness\" window\n    , DATETIME_SUB(ie.intime, INTERVAL '2' HOUR) as starttime\n    , wt.starttime as endtime\n    , wt.weight\n  from icustays ie\n  inner join\n  -- the below subquery returns one row for each unique icustay_id\n  -- the row contains: the first starttime and the corresponding weight\n  (\n    SELECT wt1.icustay_id, wt1.starttime, wt1.weight\n    , ROW_NUMBER() OVER (PARTITION BY wt1.icustay_id ORDER BY wt1.starttime) as rn\n    FROM wt1\n  ) wt\n    ON  ie.icustay_id = wt.icustay_id\n    AND wt.rn = 1\n    and ie.intime < wt.starttime\n)\n-- add the backfill rows to the main weight table\nselect\n    wt1.icustay_id\n  , wt1.starttime\n  , wt1.endtime\n  , wt1.weight\nfrom wt1\nUNION ALL\nSELECT\n    wt_fix.icustay_id\n  , wt_fix.starttime\n  , wt_fix.endtime\n  , wt_fix.weight\nfrom wt_fix",
        "tables": [
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.echo_data",
            "mimiciii_clinical.icustays"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.hadm_id",
                "mimiciii_clinical.echo_data.weight",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime"
            ],
            "starttime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.hadm_id",
                "mimiciii_clinical.echo_data.weight",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime"
            ],
            "endtime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.hadm_id",
                "mimiciii_clinical.echo_data.weight",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime"
            ],
            "weight": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.hadm_id",
                "mimiciii_clinical.echo_data.weight",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime"
            ]
        },
        "table_name": "mimiciii_clinical.weight_durations",
        "plan": {
            "Node Type": "Append",
            "Parallel Aware": false,
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE wt_neonate",
                    "Parallel Aware": false,
                    "Output": [
                        "c.icustay_id",
                        "c.charttime",
                        "max(CASE WHEN (c.itemid = 3580) THEN c.valuenum ELSE NULL::double precision END)",
                        "max(CASE WHEN (c.itemid = 3581) THEN c.valuenum ELSE NULL::double precision END)",
                        "max(CASE WHEN (c.itemid = 3582) THEN c.valuenum ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "c.icustay_id",
                        "c.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "c.icustay_id",
                                "c.charttime",
                                "c.itemid",
                                "c.valuenum"
                            ],
                            "Sort Key": [
                                "c.icustay_id",
                                "c.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Append",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_112",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "c",
                                            "Output": [
                                                "c.icustay_id",
                                                "c.charttime",
                                                "c.itemid",
                                                "c.valuenum"
                                            ],
                                            "Recheck Cond": "(c.itemid = ANY ('{3580,3581,3582}'::integer[]))",
                                            "Filter": "((c.icustay_id IS NOT NULL) AND (c.valuenum > '0'::double precision) AND (COALESCE(c.error, 0) = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_112_idx01",
                                                    "Index Cond": "(c.itemid = ANY ('{3580,3581,3582}'::integer[]))"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE birth_wt",
                    "Parallel Aware": false,
                    "Output": [
                        "c_1.icustay_id",
                        "c_1.charttime",
                        "max(CASE WHEN (c_1.itemid = 4183) THEN (CASE WHEN regexp_contains((c_1.value)::text, '[^0-9\\\\.]'::text) THEN NULL::numeric WHEN ((c_1.value)::numeric > '100'::numeric) THEN ((c_1.value)::numeric / '1000'::numeric) WHEN ((c_1.value)::numeric < '10'::numeric) THEN (c_1.value)::numeric ELSE NULL::numeric END)::double precision WHEN ((c_1.itemid = 3723) AND (c_1.valuenum < '10'::double precision)) THEN c_1.valuenum ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "c_1.icustay_id",
                        "c_1.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "c_1.icustay_id",
                                "c_1.charttime",
                                "c_1.itemid",
                                "c_1.value",
                                "c_1.valuenum"
                            ],
                            "Sort Key": [
                                "c_1.icustay_id",
                                "c_1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Append",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_121",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "c_1",
                                            "Output": [
                                                "c_1.icustay_id",
                                                "c_1.charttime",
                                                "c_1.itemid",
                                                "c_1.value",
                                                "c_1.valuenum"
                                            ],
                                            "Recheck Cond": "(c_1.itemid = ANY ('{3723,4183}'::integer[]))",
                                            "Filter": "((c_1.icustay_id IS NOT NULL) AND (COALESCE(c_1.error, 0) = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_121_idx01",
                                                    "Index Cond": "(c_1.itemid = ANY ('{3723,4183}'::integer[]))"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE wt_stg",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "Result",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "c_2.icustay_id",
                                "c_2.charttime",
                                "CASE WHEN (c_2.itemid = ANY ('{762,226512}'::integer[])) THEN 'admit'::text ELSE 'daily'::text END",
                                "c_2.valuenum"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Append",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_88",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "c_2",
                                            "Output": [
                                                "c_2.icustay_id",
                                                "c_2.charttime",
                                                "c_2.itemid",
                                                "c_2.valuenum"
                                            ],
                                            "Recheck Cond": "(c_2.itemid = ANY ('{762,226512,763,224639}'::integer[]))",
                                            "Filter": "((c_2.valuenum IS NOT NULL) AND (c_2.icustay_id IS NOT NULL) AND (c_2.valuenum > '0'::double precision) AND (COALESCE(c_2.error, 0) = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_88_idx01",
                                                    "Index Cond": "(c_2.itemid = ANY ('{762,226512,763,224639}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_190",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "c_3",
                                            "Output": [
                                                "c_3.icustay_id",
                                                "c_3.charttime",
                                                "c_3.itemid",
                                                "c_3.valuenum"
                                            ],
                                            "Recheck Cond": "(c_3.itemid = ANY ('{762,226512,763,224639}'::integer[]))",
                                            "Filter": "((c_3.valuenum IS NOT NULL) AND (c_3.icustay_id IS NOT NULL) AND (c_3.valuenum > '0'::double precision) AND (COALESCE(c_3.error, 0) = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_190_idx01",
                                                    "Index Cond": "(c_3.itemid = ANY ('{762,226512,763,224639}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_201",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "c_4",
                                            "Output": [
                                                "c_4.icustay_id",
                                                "c_4.charttime",
                                                "c_4.itemid",
                                                "c_4.valuenum"
                                            ],
                                            "Recheck Cond": "(c_4.itemid = ANY ('{762,226512,763,224639}'::integer[]))",
                                            "Filter": "((c_4.valuenum IS NOT NULL) AND (c_4.icustay_id IS NOT NULL) AND (c_4.valuenum > '0'::double precision) AND (COALESCE(c_4.error, 0) = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_201_idx01",
                                                    "Index Cond": "(c_4.itemid = ANY ('{762,226512,763,224639}'::integer[]))"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "wt_neonate",
                            "Alias": "n",
                            "Output": [
                                "n.icustay_id",
                                "n.charttime",
                                "'daily'::text",
                                "CASE WHEN (n.wt_kg IS NOT NULL) THEN n.wt_kg WHEN (n.wt_lb IS NOT NULL) THEN ((n.wt_lb * '0.45359237'::double precision) + (n.wt_oz * '0.0283495231'::double precision)) ELSE NULL::double precision END"
                            ]
                        },
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "birth_wt",
                            "Alias": "b",
                            "Output": [
                                "b.icustay_id",
                                "b.charttime",
                                "'admit'::text",
                                "b.wt_kg"
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Nested Loop",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE echo",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "ie.icustay_id",
                        "ec.charttime",
                        "'echo'::text",
                        "(0.453592 * ec.weight)"
                    ],
                    "Inner Unique": false,
                    "Plans": [
                        {
                            "Node Type": "Seq Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "echo_data",
                            "Schema": "mimiciii_clinical",
                            "Alias": "ec",
                            "Output": [
                                "ec.row_id",
                                "ec.subject_id",
                                "ec.hadm_id",
                                "ec.chartdate",
                                "ec.charttime",
                                "ec.indication",
                                "ec.height",
                                "ec.weight",
                                "ec.bsa",
                                "ec.bp",
                                "ec.bpsys",
                                "ec.bpdias",
                                "ec.hr",
                                "ec.status",
                                "ec.test",
                                "ec.doppler",
                                "ec.contrast",
                                "ec.technicalquality"
                            ],
                            "Filter": "(ec.weight IS NOT NULL)"
                        },
                        {
                            "Node Type": "Index Scan",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Scan Direction": "Forward",
                            "Index Name": "icustays_idx06",
                            "Relation Name": "icustays",
                            "Schema": "mimiciii_clinical",
                            "Alias": "ie",
                            "Output": [
                                "ie.row_id",
                                "ie.subject_id",
                                "ie.hadm_id",
                                "ie.icustay_id",
                                "ie.dbsource",
                                "ie.first_careunit",
                                "ie.last_careunit",
                                "ie.first_wardid",
                                "ie.last_wardid",
                                "ie.intime",
                                "ie.outtime",
                                "ie.los"
                            ],
                            "Index Cond": "(ie.hadm_id = ec.hadm_id)",
                            "Filter": "(NOT (hashed SubPlan 4))",
                            "Plans": [
                                {
                                    "Node Type": "Aggregate",
                                    "Strategy": "Hashed",
                                    "Partial Mode": "Simple",
                                    "Parent Relationship": "SubPlan",
                                    "Subplan Name": "SubPlan 4",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "wt_stg.icustay_id"
                                    ],
                                    "Group Key": [
                                        "wt_stg.icustay_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "wt_stg",
                                            "Alias": "wt_stg",
                                            "Output": [
                                                "wt_stg.icustay_id",
                                                "wt_stg.charttime",
                                                "wt_stg.weight_type",
                                                "wt_stg.weight"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE wt_stg0",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "wt_stg",
                            "Alias": "wt_stg_1",
                            "Output": [
                                "wt_stg_1.icustay_id",
                                "wt_stg_1.charttime",
                                "wt_stg_1.weight_type",
                                "wt_stg_1.weight"
                            ]
                        },
                        {
                            "Node Type": "Subquery Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Alias": "*SELECT* 2",
                            "Output": [
                                "\"*SELECT* 2\".icustay_id",
                                "\"*SELECT* 2\".charttime",
                                "\"*SELECT* 2\".weight_type",
                                "\"*SELECT* 2\".weight"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Subquery",
                                    "Parallel Aware": false,
                                    "CTE Name": "echo",
                                    "Alias": "echo",
                                    "Output": [
                                        "echo.icustay_id",
                                        "echo.charttime",
                                        "echo.weight_type",
                                        "echo.weight"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE wt_stg1",
                    "Parallel Aware": false,
                    "Output": [
                        "wt_stg0.icustay_id",
                        "wt_stg0.charttime",
                        "wt_stg0.weight_type",
                        "wt_stg0.weight",
                        "row_number() OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "wt_stg0.icustay_id",
                                "wt_stg0.charttime",
                                "wt_stg0.weight_type",
                                "wt_stg0.weight"
                            ],
                            "Sort Key": [
                                "wt_stg0.icustay_id",
                                "wt_stg0.weight_type",
                                "wt_stg0.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "wt_stg0",
                                    "Alias": "wt_stg0",
                                    "Output": [
                                        "wt_stg0.icustay_id",
                                        "wt_stg0.charttime",
                                        "wt_stg0.weight_type",
                                        "wt_stg0.weight"
                                    ],
                                    "Filter": "(wt_stg0.weight IS NOT NULL)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE wt_stg2",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "wt_stg1.icustay_id",
                        "ie_1.intime",
                        "ie_1.outtime",
                        "CASE WHEN ((wt_stg1.weight_type = 'admit'::text) AND (wt_stg1.rn = 1)) THEN datetime_sub(ie_1.intime, '02:00:00'::interval hour) ELSE wt_stg1.charttime END",
                        "wt_stg1.weight"
                    ],
                    "Inner Unique": true,
                    "Hash Cond": "(wt_stg1.icustay_id = ie_1.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "wt_stg1",
                            "Alias": "wt_stg1",
                            "Output": [
                                "wt_stg1.icustay_id",
                                "wt_stg1.charttime",
                                "wt_stg1.weight_type",
                                "wt_stg1.weight",
                                "wt_stg1.rn"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "ie_1.intime",
                                "ie_1.outtime",
                                "ie_1.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "icustays",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ie_1",
                                    "Output": [
                                        "ie_1.intime",
                                        "ie_1.outtime",
                                        "ie_1.icustay_id"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE wt_stg3",
                    "Parallel Aware": false,
                    "Output": [
                        "wt_stg2.icustay_id",
                        "wt_stg2.intime",
                        "wt_stg2.outtime",
                        "wt_stg2.starttime",
                        "COALESCE(lead(wt_stg2.starttime) OVER (?), datetime_add(GREATEST(wt_stg2.outtime, wt_stg2.starttime), '02:00:00'::interval hour))",
                        "wt_stg2.weight"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "wt_stg2.icustay_id",
                                "wt_stg2.starttime",
                                "wt_stg2.intime",
                                "wt_stg2.outtime",
                                "wt_stg2.weight"
                            ],
                            "Sort Key": [
                                "wt_stg2.icustay_id",
                                "wt_stg2.starttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "wt_stg2",
                                    "Alias": "wt_stg2",
                                    "Output": [
                                        "wt_stg2.icustay_id",
                                        "wt_stg2.starttime",
                                        "wt_stg2.intime",
                                        "wt_stg2.outtime",
                                        "wt_stg2.weight"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE wt1",
                    "Parallel Aware": false,
                    "Output": [
                        "wt_stg3.icustay_id",
                        "wt_stg3.starttime",
                        "COALESCE(wt_stg3.endtime, lead(wt_stg3.starttime) OVER (?), datetime_add(wt_stg3.outtime, '02:00:00'::interval hour))",
                        "wt_stg3.weight"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "wt_stg3.icustay_id",
                                "wt_stg3.starttime",
                                "wt_stg3.endtime",
                                "wt_stg3.outtime",
                                "wt_stg3.weight"
                            ],
                            "Sort Key": [
                                "wt_stg3.icustay_id",
                                "wt_stg3.starttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "wt_stg3",
                                    "Alias": "wt_stg3",
                                    "Output": [
                                        "wt_stg3.icustay_id",
                                        "wt_stg3.starttime",
                                        "wt_stg3.endtime",
                                        "wt_stg3.outtime",
                                        "wt_stg3.weight"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Nested Loop",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE wt_fix",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "ie_2.icustay_id",
                        "datetime_sub(ie_2.intime, '02:00:00'::interval hour)",
                        "wt.starttime",
                        "wt.weight"
                    ],
                    "Inner Unique": true,
                    "Plans": [
                        {
                            "Node Type": "Subquery Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Alias": "wt",
                            "Output": [
                                "wt.icustay_id",
                                "wt.starttime",
                                "wt.weight",
                                "wt.rn"
                            ],
                            "Filter": "(wt.rn = 1)",
                            "Plans": [
                                {
                                    "Node Type": "WindowAgg",
                                    "Parent Relationship": "Subquery",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "wt1_1.icustay_id",
                                        "wt1_1.starttime",
                                        "wt1_1.weight",
                                        "row_number() OVER (?)"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "wt1_1.icustay_id",
                                                "wt1_1.starttime",
                                                "wt1_1.weight"
                                            ],
                                            "Sort Key": [
                                                "wt1_1.icustay_id",
                                                "wt1_1.starttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "wt1",
                                                    "Alias": "wt1_1",
                                                    "Output": [
                                                        "wt1_1.icustay_id",
                                                        "wt1_1.starttime",
                                                        "wt1_1.weight"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Index Scan",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Scan Direction": "Forward",
                            "Index Name": "icustays_idx02",
                            "Relation Name": "icustays",
                            "Schema": "mimiciii_clinical",
                            "Alias": "ie_2",
                            "Output": [
                                "ie_2.row_id",
                                "ie_2.subject_id",
                                "ie_2.hadm_id",
                                "ie_2.icustay_id",
                                "ie_2.dbsource",
                                "ie_2.first_careunit",
                                "ie_2.last_careunit",
                                "ie_2.first_wardid",
                                "ie_2.last_wardid",
                                "ie_2.intime",
                                "ie_2.outtime",
                                "ie_2.los"
                            ],
                            "Index Cond": "(ie_2.icustay_id = wt.icustay_id)",
                            "Filter": "(ie_2.intime < wt.starttime)"
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "Member",
                    "Parallel Aware": false,
                    "CTE Name": "wt1",
                    "Alias": "wt1",
                    "Output": [
                        "wt1.icustay_id",
                        "wt1.starttime",
                        "wt1.endtime",
                        "wt1.weight"
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "Member",
                    "Parallel Aware": false,
                    "CTE Name": "wt_fix",
                    "Alias": "wt_fix",
                    "Output": [
                        "wt_fix.icustay_id",
                        "wt_fix.starttime",
                        "wt_fix.endtime",
                        "wt_fix.weight"
                    ]
                }
            ]
        }
    },
    "model.mimic.ventilation_classification": {
        "sql": "-- Identify The presence of a mechanical ventilation using settings\nselect\n  icustay_id, charttime\n  -- case statement determining whether it is an instance of mech vent\n  , max(\n    case\n      when itemid is null or value is null then 0 -- can't have null values\n      when itemid = 720 and value != 'Other/Remarks' THEN 1  -- VentTypeRecorded\n      when itemid = 223848 and value != 'Other' THEN 1\n      when itemid = 223849 then 1 -- ventilator mode\n      when itemid = 467 and value = 'Ventilator' THEN 1 -- O2 delivery device == ventilator\n      when itemid in\n        (\n        445, 448, 449, 450, 1340, 1486, 1600, 224687 -- minute volume\n        , 639, 654, 681, 682, 683, 684,224685,224684,224686 -- tidal volume\n        , 218,436,535,444,459,224697,224695,224696,224746,224747 -- High/Low/Peak/Mean/Neg insp force (\"RespPressure\")\n        , 221,1,1211,1655,2000,226873,224738,224419,224750,227187 -- Insp pressure\n        , 543 -- PlateauPressure\n        , 5865,5866,224707,224709,224705,224706 -- APRV pressure\n        , 60,437,505,506,686,220339,224700 -- PEEP\n        , 3459 -- high pressure relief\n        , 501,502,503,224702 -- PCV\n        , 223,667,668,669,670,671,672 -- TCPCV\n        , 224701 -- PSVlevel\n        )\n        THEN 1\n      else 0\n    end\n    ) as MechVent\n    , max(\n      case\n        -- initiation of oxygen therapy indicates the ventilation has ended\n        when itemid = 226732 and value in\n        (\n          'Nasal cannula', -- 153714 observations\n          'Face tent', -- 24601 observations\n          'Aerosol-cool', -- 24560 observations\n          'Trach mask ', -- 16435 observations\n          'High flow neb', -- 10785 observations\n          'Non-rebreather', -- 5182 observations\n          'Venti mask ', -- 1947 observations\n          'Medium conc mask ', -- 1888 observations\n          'T-piece', -- 1135 observations\n          'High flow nasal cannula', -- 925 observations\n          'Ultrasonic neb', -- 9 observations\n          'Vapomist' -- 3 observations\n        ) then 1\n        when itemid = 467 and value in\n        (\n          'Cannula', -- 278252 observations\n          'Nasal Cannula', -- 248299 observations\n          -- 'None', -- 95498 observations\n          'Face Tent', -- 35766 observations\n          'Aerosol-Cool', -- 33919 observations\n          'Trach Mask', -- 32655 observations\n          'Hi Flow Neb', -- 14070 observations\n          'Non-Rebreather', -- 10856 observations\n          'Venti Mask', -- 4279 observations\n          'Medium Conc Mask', -- 2114 observations\n          'Vapotherm', -- 1655 observations\n          'T-Piece', -- 779 observations\n          'Hood', -- 670 observations\n          'Hut', -- 150 observations\n          'TranstrachealCat', -- 78 observations\n          'Heated Neb', -- 37 observations\n          'Ultrasonic Neb' -- 2 observations\n        ) then 1\n      else 0\n      end\n    ) as OxygenTherapy\n    , max(\n      case when itemid is null or value is null then 0\n        -- extubated indicates ventilation event has ended\n        when itemid = 640 and value = 'Extubated' then 1\n        when itemid = 640 and value = 'Self Extubation' then 1\n      else 0\n      end\n      )\n      as Extubated\n    , max(\n      case when itemid is null or value is null then 0\n        when itemid = 640 and value = 'Self Extubation' then 1\n      else 0\n      end\n      )\n      as SelfExtubated\nfrom chartevents ce\nwhere ce.value is not null\n-- exclude rows marked as error\nand (ce.error != 1 or ce.error IS NULL)\nand itemid in\n(\n    -- the below are settings used to indicate ventilation\n      720, 223849 -- vent mode\n    , 223848 -- vent type\n    , 445, 448, 449, 450, 1340, 1486, 1600, 224687 -- minute volume\n    , 639, 654, 681, 682, 683, 684,224685,224684,224686 -- tidal volume\n    , 218,436,535,444,224697,224695,224696,224746,224747 -- High/Low/Peak/Mean (\"RespPressure\")\n    , 221,1,1211,1655,2000,226873,224738,224419,224750,227187 -- Insp pressure\n    , 543 -- PlateauPressure\n    , 5865,5866,224707,224709,224705,224706 -- APRV pressure\n    , 60,437,505,506,686,220339,224700 -- PEEP\n    , 3459 -- high pressure relief\n    , 501,502,503,224702 -- PCV\n    , 223,667,668,669,670,671,672 -- TCPCV\n    , 224701 -- PSVlevel\n\n    -- the below are settings used to indicate extubation\n    , 640 -- extubated\n\n    -- the below indicate oxygen/NIV, i.e. the end of a mechanical vent event\n    , 468 -- O2 Delivery Device#2\n    , 469 -- O2 Delivery Mode\n    , 470 -- O2 Flow (lpm)\n    , 471 -- O2 Flow (lpm) #2\n    , 227287 -- O2 Flow (additional cannula)\n    , 226732 -- O2 Delivery Device(s)\n    , 223834 -- O2 Flow\n\n    -- used in both oxygen + vent calculation\n    , 467 -- O2 Delivery Device\n)\ngroup by icustay_id, charttime\nUNION DISTINCT\n-- add in the extubation flags from procedureevents_mv\n-- note that we only need the start time for the extubation\n-- (extubation is always charted as ending 1 minute after it started)\nselect\n  icustay_id, starttime as charttime\n  , 0 as MechVent\n  , 0 as OxygenTherapy\n  , 1 as Extubated\n  , case when itemid = 225468 then 1 else 0 end as SelfExtubated\nfrom procedureevents_mv\nwhere itemid in\n(\n  227194 -- \"Extubation\"\n, 225468 -- \"Unplanned Extubation (patient-initiated)\"\n, 225477 -- \"Unplanned Extubation (non-patient initiated)\"\n)",
        "tables": [
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.procedureevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.starttime"
            ],
            "charttime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.starttime"
            ],
            "mechvent": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.starttime"
            ],
            "oxygentherapy": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.starttime"
            ],
            "extubated": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.starttime"
            ],
            "selfextubated": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.starttime"
            ]
        },
        "table_name": "mimiciii_clinical.ventilation_classification",
        "plan": {
            "Node Type": "Aggregate",
            "Strategy": "Hashed",
            "Partial Mode": "Simple",
            "Parallel Aware": false,
            "Output": [
                "ce.icustay_id",
                "ce.charttime",
                "(max(CASE WHEN ((ce.itemid IS NULL) OR (ce.value IS NULL)) THEN 0 WHEN ((ce.itemid = 720) AND ((ce.value)::text <> 'Other/Remarks'::text)) THEN 1 WHEN ((ce.itemid = 223848) AND ((ce.value)::text <> 'Other'::text)) THEN 1 WHEN (ce.itemid = 223849) THEN 1 WHEN ((ce.itemid = 467) AND ((ce.value)::text = 'Ventilator'::text)) THEN 1 WHEN (ce.itemid = ANY ('{445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,459,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701}'::integer[])) THEN 1 ELSE 0 END))",
                "(max(CASE WHEN ((ce.itemid = 226732) AND ((ce.value)::text = ANY ('{\"Nasal cannula\",\"Face tent\",Aerosol-cool,\"Trach mask \",\"High flow neb\",Non-rebreather,\"Venti mask \",\"Medium conc mask \",T-piece,\"High flow nasal cannula\",\"Ultrasonic neb\",Vapomist}'::text[]))) THEN 1 WHEN ((ce.itemid = 467) AND ((ce.value)::text = ANY ('{Cannula,\"Nasal Cannula\",\"Face Tent\",Aerosol-Cool,\"Trach Mask\",\"Hi Flow Neb\",Non-Rebreather,\"Venti Mask\",\"Medium Conc Mask\",Vapotherm,T-Piece,Hood,Hut,TranstrachealCat,\"Heated Neb\",\"Ultrasonic Neb\"}'::text[]))) THEN 1 ELSE 0 END))",
                "(max(CASE WHEN ((ce.itemid IS NULL) OR (ce.value IS NULL)) THEN 0 WHEN ((ce.itemid = 640) AND ((ce.value)::text = 'Extubated'::text)) THEN 1 WHEN ((ce.itemid = 640) AND ((ce.value)::text = 'Self Extubation'::text)) THEN 1 ELSE 0 END))",
                "(max(CASE WHEN ((ce.itemid IS NULL) OR (ce.value IS NULL)) THEN 0 WHEN ((ce.itemid = 640) AND ((ce.value)::text = 'Self Extubation'::text)) THEN 1 ELSE 0 END))"
            ],
            "Group Key": [
                "ce.icustay_id",
                "ce.charttime",
                "(max(CASE WHEN ((ce.itemid IS NULL) OR (ce.value IS NULL)) THEN 0 WHEN ((ce.itemid = 720) AND ((ce.value)::text <> 'Other/Remarks'::text)) THEN 1 WHEN ((ce.itemid = 223848) AND ((ce.value)::text <> 'Other'::text)) THEN 1 WHEN (ce.itemid = 223849) THEN 1 WHEN ((ce.itemid = 467) AND ((ce.value)::text = 'Ventilator'::text)) THEN 1 WHEN (ce.itemid = ANY ('{445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,459,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701}'::integer[])) THEN 1 ELSE 0 END))",
                "(max(CASE WHEN ((ce.itemid = 226732) AND ((ce.value)::text = ANY ('{\"Nasal cannula\",\"Face tent\",Aerosol-cool,\"Trach mask \",\"High flow neb\",Non-rebreather,\"Venti mask \",\"Medium conc mask \",T-piece,\"High flow nasal cannula\",\"Ultrasonic neb\",Vapomist}'::text[]))) THEN 1 WHEN ((ce.itemid = 467) AND ((ce.value)::text = ANY ('{Cannula,\"Nasal Cannula\",\"Face Tent\",Aerosol-Cool,\"Trach Mask\",\"Hi Flow Neb\",Non-Rebreather,\"Venti Mask\",\"Medium Conc Mask\",Vapotherm,T-Piece,Hood,Hut,TranstrachealCat,\"Heated Neb\",\"Ultrasonic Neb\"}'::text[]))) THEN 1 ELSE 0 END))",
                "(max(CASE WHEN ((ce.itemid IS NULL) OR (ce.value IS NULL)) THEN 0 WHEN ((ce.itemid = 640) AND ((ce.value)::text = 'Extubated'::text)) THEN 1 WHEN ((ce.itemid = 640) AND ((ce.value)::text = 'Self Extubation'::text)) THEN 1 ELSE 0 END))",
                "(max(CASE WHEN ((ce.itemid IS NULL) OR (ce.value IS NULL)) THEN 0 WHEN ((ce.itemid = 640) AND ((ce.value)::text = 'Self Extubation'::text)) THEN 1 ELSE 0 END))"
            ],
            "Plans": [
                {
                    "Node Type": "Append",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "Aggregate",
                            "Strategy": "Sorted",
                            "Partial Mode": "Finalize",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "ce.icustay_id",
                                "ce.charttime",
                                "max(CASE WHEN ((ce.itemid IS NULL) OR (ce.value IS NULL)) THEN 0 WHEN ((ce.itemid = 720) AND ((ce.value)::text <> 'Other/Remarks'::text)) THEN 1 WHEN ((ce.itemid = 223848) AND ((ce.value)::text <> 'Other'::text)) THEN 1 WHEN (ce.itemid = 223849) THEN 1 WHEN ((ce.itemid = 467) AND ((ce.value)::text = 'Ventilator'::text)) THEN 1 WHEN (ce.itemid = ANY ('{445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,459,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701}'::integer[])) THEN 1 ELSE 0 END)",
                                "max(CASE WHEN ((ce.itemid = 226732) AND ((ce.value)::text = ANY ('{\"Nasal cannula\",\"Face tent\",Aerosol-cool,\"Trach mask \",\"High flow neb\",Non-rebreather,\"Venti mask \",\"Medium conc mask \",T-piece,\"High flow nasal cannula\",\"Ultrasonic neb\",Vapomist}'::text[]))) THEN 1 WHEN ((ce.itemid = 467) AND ((ce.value)::text = ANY ('{Cannula,\"Nasal Cannula\",\"Face Tent\",Aerosol-Cool,\"Trach Mask\",\"Hi Flow Neb\",Non-Rebreather,\"Venti Mask\",\"Medium Conc Mask\",Vapotherm,T-Piece,Hood,Hut,TranstrachealCat,\"Heated Neb\",\"Ultrasonic Neb\"}'::text[]))) THEN 1 ELSE 0 END)",
                                "max(CASE WHEN ((ce.itemid IS NULL) OR (ce.value IS NULL)) THEN 0 WHEN ((ce.itemid = 640) AND ((ce.value)::text = 'Extubated'::text)) THEN 1 WHEN ((ce.itemid = 640) AND ((ce.value)::text = 'Self Extubation'::text)) THEN 1 ELSE 0 END)",
                                "max(CASE WHEN ((ce.itemid IS NULL) OR (ce.value IS NULL)) THEN 0 WHEN ((ce.itemid = 640) AND ((ce.value)::text = 'Self Extubation'::text)) THEN 1 ELSE 0 END)"
                            ],
                            "Group Key": [
                                "ce.icustay_id",
                                "ce.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Gather Merge",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "ce.icustay_id",
                                        "ce.charttime",
                                        "(PARTIAL max(CASE WHEN ((ce.itemid IS NULL) OR (ce.value IS NULL)) THEN 0 WHEN ((ce.itemid = 720) AND ((ce.value)::text <> 'Other/Remarks'::text)) THEN 1 WHEN ((ce.itemid = 223848) AND ((ce.value)::text <> 'Other'::text)) THEN 1 WHEN (ce.itemid = 223849) THEN 1 WHEN ((ce.itemid = 467) AND ((ce.value)::text = 'Ventilator'::text)) THEN 1 WHEN (ce.itemid = ANY ('{445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,459,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701}'::integer[])) THEN 1 ELSE 0 END))",
                                        "(PARTIAL max(CASE WHEN ((ce.itemid = 226732) AND ((ce.value)::text = ANY ('{\"Nasal cannula\",\"Face tent\",Aerosol-cool,\"Trach mask \",\"High flow neb\",Non-rebreather,\"Venti mask \",\"Medium conc mask \",T-piece,\"High flow nasal cannula\",\"Ultrasonic neb\",Vapomist}'::text[]))) THEN 1 WHEN ((ce.itemid = 467) AND ((ce.value)::text = ANY ('{Cannula,\"Nasal Cannula\",\"Face Tent\",Aerosol-Cool,\"Trach Mask\",\"Hi Flow Neb\",Non-Rebreather,\"Venti Mask\",\"Medium Conc Mask\",Vapotherm,T-Piece,Hood,Hut,TranstrachealCat,\"Heated Neb\",\"Ultrasonic Neb\"}'::text[]))) THEN 1 ELSE 0 END))",
                                        "(PARTIAL max(CASE WHEN ((ce.itemid IS NULL) OR (ce.value IS NULL)) THEN 0 WHEN ((ce.itemid = 640) AND ((ce.value)::text = 'Extubated'::text)) THEN 1 WHEN ((ce.itemid = 640) AND ((ce.value)::text = 'Self Extubation'::text)) THEN 1 ELSE 0 END))",
                                        "(PARTIAL max(CASE WHEN ((ce.itemid IS NULL) OR (ce.value IS NULL)) THEN 0 WHEN ((ce.itemid = 640) AND ((ce.value)::text = 'Self Extubation'::text)) THEN 1 ELSE 0 END))"
                                    ],
                                    "Workers Planned": 2,
                                    "Plans": [
                                        {
                                            "Node Type": "Aggregate",
                                            "Strategy": "Sorted",
                                            "Partial Mode": "Partial",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ce.icustay_id",
                                                "ce.charttime",
                                                "PARTIAL max(CASE WHEN ((ce.itemid IS NULL) OR (ce.value IS NULL)) THEN 0 WHEN ((ce.itemid = 720) AND ((ce.value)::text <> 'Other/Remarks'::text)) THEN 1 WHEN ((ce.itemid = 223848) AND ((ce.value)::text <> 'Other'::text)) THEN 1 WHEN (ce.itemid = 223849) THEN 1 WHEN ((ce.itemid = 467) AND ((ce.value)::text = 'Ventilator'::text)) THEN 1 WHEN (ce.itemid = ANY ('{445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,459,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701}'::integer[])) THEN 1 ELSE 0 END)",
                                                "PARTIAL max(CASE WHEN ((ce.itemid = 226732) AND ((ce.value)::text = ANY ('{\"Nasal cannula\",\"Face tent\",Aerosol-cool,\"Trach mask \",\"High flow neb\",Non-rebreather,\"Venti mask \",\"Medium conc mask \",T-piece,\"High flow nasal cannula\",\"Ultrasonic neb\",Vapomist}'::text[]))) THEN 1 WHEN ((ce.itemid = 467) AND ((ce.value)::text = ANY ('{Cannula,\"Nasal Cannula\",\"Face Tent\",Aerosol-Cool,\"Trach Mask\",\"Hi Flow Neb\",Non-Rebreather,\"Venti Mask\",\"Medium Conc Mask\",Vapotherm,T-Piece,Hood,Hut,TranstrachealCat,\"Heated Neb\",\"Ultrasonic Neb\"}'::text[]))) THEN 1 ELSE 0 END)",
                                                "PARTIAL max(CASE WHEN ((ce.itemid IS NULL) OR (ce.value IS NULL)) THEN 0 WHEN ((ce.itemid = 640) AND ((ce.value)::text = 'Extubated'::text)) THEN 1 WHEN ((ce.itemid = 640) AND ((ce.value)::text = 'Self Extubation'::text)) THEN 1 ELSE 0 END)",
                                                "PARTIAL max(CASE WHEN ((ce.itemid IS NULL) OR (ce.value IS NULL)) THEN 0 WHEN ((ce.itemid = 640) AND ((ce.value)::text = 'Self Extubation'::text)) THEN 1 ELSE 0 END)"
                                            ],
                                            "Group Key": [
                                                "ce.icustay_id",
                                                "ce.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Sort",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Output": [
                                                        "ce.icustay_id",
                                                        "ce.charttime",
                                                        "ce.itemid",
                                                        "ce.value"
                                                    ],
                                                    "Sort Key": [
                                                        "ce.icustay_id",
                                                        "ce.charttime"
                                                    ],
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Append",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_1",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce",
                                                                    "Output": [
                                                                        "ce.icustay_id",
                                                                        "ce.charttime",
                                                                        "ce.itemid",
                                                                        "ce.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce.value IS NOT NULL) AND ((ce.error <> 1) OR (ce.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_1_idx01",
                                                                            "Index Cond": "(ce.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_13",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_1",
                                                                    "Output": [
                                                                        "ce_1.icustay_id",
                                                                        "ce_1.charttime",
                                                                        "ce_1.itemid",
                                                                        "ce_1.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce_1.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_1.value IS NOT NULL) AND ((ce_1.error <> 1) OR (ce_1.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_13_idx01",
                                                                            "Index Cond": "(ce_1.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_33",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_2",
                                                                    "Output": [
                                                                        "ce_2.icustay_id",
                                                                        "ce_2.charttime",
                                                                        "ce_2.itemid",
                                                                        "ce_2.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce_2.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_2.value IS NOT NULL) AND ((ce_2.error <> 1) OR (ce_2.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_33_idx01",
                                                                            "Index Cond": "(ce_2.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_40",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_3",
                                                                    "Output": [
                                                                        "ce_3.icustay_id",
                                                                        "ce_3.charttime",
                                                                        "ce_3.itemid",
                                                                        "ce_3.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce_3.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_3.value IS NOT NULL) AND ((ce_3.error <> 1) OR (ce_3.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_40_idx01",
                                                                            "Index Cond": "(ce_3.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Index Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Scan Direction": "Forward",
                                                                    "Index Name": "chartevents_45_idx01",
                                                                    "Relation Name": "chartevents_45",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_4",
                                                                    "Output": [
                                                                        "ce_4.icustay_id",
                                                                        "ce_4.charttime",
                                                                        "ce_4.itemid",
                                                                        "ce_4.value"
                                                                    ],
                                                                    "Index Cond": "(ce_4.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_4.value IS NOT NULL) AND ((ce_4.error <> 1) OR (ce_4.error IS NULL)))"
                                                                },
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_46",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_5",
                                                                    "Output": [
                                                                        "ce_5.icustay_id",
                                                                        "ce_5.charttime",
                                                                        "ce_5.itemid",
                                                                        "ce_5.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce_5.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_5.value IS NOT NULL) AND ((ce_5.error <> 1) OR (ce_5.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_46_idx01",
                                                                            "Index Cond": "(ce_5.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_49",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_6",
                                                                    "Output": [
                                                                        "ce_6.icustay_id",
                                                                        "ce_6.charttime",
                                                                        "ce_6.itemid",
                                                                        "ce_6.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce_6.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_6.value IS NOT NULL) AND ((ce_6.error <> 1) OR (ce_6.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_49_idx01",
                                                                            "Index Cond": "(ce_6.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Seq Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_67",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_7",
                                                                    "Output": [
                                                                        "ce_7.icustay_id",
                                                                        "ce_7.charttime",
                                                                        "ce_7.itemid",
                                                                        "ce_7.value"
                                                                    ],
                                                                    "Filter": "((ce_7.value IS NOT NULL) AND ((ce_7.error <> 1) OR (ce_7.error IS NULL)) AND (ce_7.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[])))"
                                                                },
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_68",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_8",
                                                                    "Output": [
                                                                        "ce_8.icustay_id",
                                                                        "ce_8.charttime",
                                                                        "ce_8.itemid",
                                                                        "ce_8.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce_8.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_8.value IS NOT NULL) AND ((ce_8.error <> 1) OR (ce_8.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_68_idx01",
                                                                            "Index Cond": "(ce_8.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_70",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_9",
                                                                    "Output": [
                                                                        "ce_9.icustay_id",
                                                                        "ce_9.charttime",
                                                                        "ce_9.itemid",
                                                                        "ce_9.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce_9.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_9.value IS NOT NULL) AND ((ce_9.error <> 1) OR (ce_9.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_70_idx01",
                                                                            "Index Cond": "(ce_9.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_72",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_10",
                                                                    "Output": [
                                                                        "ce_10.icustay_id",
                                                                        "ce_10.charttime",
                                                                        "ce_10.itemid",
                                                                        "ce_10.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce_10.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_10.value IS NOT NULL) AND ((ce_10.error <> 1) OR (ce_10.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_72_idx01",
                                                                            "Index Cond": "(ce_10.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Seq Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_79",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_11",
                                                                    "Output": [
                                                                        "ce_11.icustay_id",
                                                                        "ce_11.charttime",
                                                                        "ce_11.itemid",
                                                                        "ce_11.value"
                                                                    ],
                                                                    "Filter": "((ce_11.value IS NOT NULL) AND ((ce_11.error <> 1) OR (ce_11.error IS NULL)) AND (ce_11.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[])))"
                                                                },
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_84",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_12",
                                                                    "Output": [
                                                                        "ce_12.icustay_id",
                                                                        "ce_12.charttime",
                                                                        "ce_12.itemid",
                                                                        "ce_12.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce_12.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_12.value IS NOT NULL) AND ((ce_12.error <> 1) OR (ce_12.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_84_idx01",
                                                                            "Index Cond": "(ce_12.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_96",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_13",
                                                                    "Output": [
                                                                        "ce_13.icustay_id",
                                                                        "ce_13.charttime",
                                                                        "ce_13.itemid",
                                                                        "ce_13.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce_13.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_13.value IS NOT NULL) AND ((ce_13.error <> 1) OR (ce_13.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_96_idx01",
                                                                            "Index Cond": "(ce_13.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_98",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_14",
                                                                    "Output": [
                                                                        "ce_14.icustay_id",
                                                                        "ce_14.charttime",
                                                                        "ce_14.itemid",
                                                                        "ce_14.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce_14.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_14.value IS NOT NULL) AND ((ce_14.error <> 1) OR (ce_14.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_98_idx01",
                                                                            "Index Cond": "(ce_14.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_100",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_15",
                                                                    "Output": [
                                                                        "ce_15.icustay_id",
                                                                        "ce_15.charttime",
                                                                        "ce_15.itemid",
                                                                        "ce_15.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce_15.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_15.value IS NOT NULL) AND ((ce_15.error <> 1) OR (ce_15.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_100_idx01",
                                                                            "Index Cond": "(ce_15.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_103",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_16",
                                                                    "Output": [
                                                                        "ce_16.icustay_id",
                                                                        "ce_16.charttime",
                                                                        "ce_16.itemid",
                                                                        "ce_16.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce_16.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_16.value IS NOT NULL) AND ((ce_16.error <> 1) OR (ce_16.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_103_idx01",
                                                                            "Index Cond": "(ce_16.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_110",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_17",
                                                                    "Output": [
                                                                        "ce_17.icustay_id",
                                                                        "ce_17.charttime",
                                                                        "ce_17.itemid",
                                                                        "ce_17.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce_17.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_17.value IS NOT NULL) AND ((ce_17.error <> 1) OR (ce_17.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_110_idx01",
                                                                            "Index Cond": "(ce_17.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_130",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_18",
                                                                    "Output": [
                                                                        "ce_18.icustay_id",
                                                                        "ce_18.charttime",
                                                                        "ce_18.itemid",
                                                                        "ce_18.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce_18.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_18.value IS NOT NULL) AND ((ce_18.error <> 1) OR (ce_18.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_130_idx01",
                                                                            "Index Cond": "(ce_18.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_171",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_19",
                                                                    "Output": [
                                                                        "ce_19.icustay_id",
                                                                        "ce_19.charttime",
                                                                        "ce_19.itemid",
                                                                        "ce_19.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce_19.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_19.value IS NOT NULL) AND ((ce_19.error <> 1) OR (ce_19.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_171_idx01",
                                                                            "Index Cond": "(ce_19.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_175",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_20",
                                                                    "Output": [
                                                                        "ce_20.icustay_id",
                                                                        "ce_20.charttime",
                                                                        "ce_20.itemid",
                                                                        "ce_20.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce_20.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_20.value IS NOT NULL) AND ((ce_20.error <> 1) OR (ce_20.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_175_idx01",
                                                                            "Index Cond": "(ce_20.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_190",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_21",
                                                                    "Output": [
                                                                        "ce_21.icustay_id",
                                                                        "ce_21.charttime",
                                                                        "ce_21.itemid",
                                                                        "ce_21.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce_21.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_21.value IS NOT NULL) AND ((ce_21.error <> 1) OR (ce_21.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_190_idx01",
                                                                            "Index Cond": "(ce_21.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_194",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_22",
                                                                    "Output": [
                                                                        "ce_22.icustay_id",
                                                                        "ce_22.charttime",
                                                                        "ce_22.itemid",
                                                                        "ce_22.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce_22.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_22.value IS NOT NULL) AND ((ce_22.error <> 1) OR (ce_22.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_194_idx01",
                                                                            "Index Cond": "(ce_22.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_195",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_23",
                                                                    "Output": [
                                                                        "ce_23.icustay_id",
                                                                        "ce_23.charttime",
                                                                        "ce_23.itemid",
                                                                        "ce_23.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce_23.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_23.value IS NOT NULL) AND ((ce_23.error <> 1) OR (ce_23.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_195_idx01",
                                                                            "Index Cond": "(ce_23.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_201",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_24",
                                                                    "Output": [
                                                                        "ce_24.icustay_id",
                                                                        "ce_24.charttime",
                                                                        "ce_24.itemid",
                                                                        "ce_24.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce_24.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_24.value IS NOT NULL) AND ((ce_24.error <> 1) OR (ce_24.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_201_idx01",
                                                                            "Index Cond": "(ce_24.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Bitmap Heap Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": true,
                                                                    "Relation Name": "chartevents_202",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "ce_25",
                                                                    "Output": [
                                                                        "ce_25.icustay_id",
                                                                        "ce_25.charttime",
                                                                        "ce_25.itemid",
                                                                        "ce_25.value"
                                                                    ],
                                                                    "Recheck Cond": "(ce_25.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))",
                                                                    "Filter": "((ce_25.value IS NOT NULL) AND ((ce_25.error <> 1) OR (ce_25.error IS NULL)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Index Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Index Name": "chartevents_202_idx01",
                                                                            "Index Cond": "(ce_25.itemid = ANY ('{720,223849,223848,445,448,449,450,1340,1486,1600,224687,639,654,681,682,683,684,224685,224684,224686,218,436,535,444,224697,224695,224696,224746,224747,221,1,1211,1655,2000,226873,224738,224419,224750,227187,543,5865,5866,224707,224709,224705,224706,60,437,505,506,686,220339,224700,3459,501,502,503,224702,223,667,668,669,670,671,672,224701,640,468,469,470,471,227287,226732,223834,467}'::integer[]))"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Bitmap Heap Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Relation Name": "procedureevents_mv",
                            "Schema": "mimiciii_clinical",
                            "Alias": "procedureevents_mv",
                            "Output": [
                                "procedureevents_mv.icustay_id",
                                "procedureevents_mv.starttime",
                                "0",
                                "0",
                                "1",
                                "CASE WHEN (procedureevents_mv.itemid = 225468) THEN 1 ELSE 0 END"
                            ],
                            "Recheck Cond": "(procedureevents_mv.itemid = ANY ('{227194,225468,225477}'::integer[]))",
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Index Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Index Name": "procedureevents_mv_idx05",
                                    "Index Cond": "(procedureevents_mv.itemid = ANY ('{227194,225468,225477}'::integer[]))"
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.blood_gas_first_day": {
        "sql": "-- The aim of this query is to pivot entries related to blood gases and\n-- chemistry values which were found in LABEVENTS\n\n-- things to check:\n--  when a mixed venous/arterial blood sample are taken at the same time, is the store time different?\n\nwith pvt as\n( -- begin query that extracts the data\n  select ie.subject_id, ie.hadm_id, ie.icustay_id\n  -- here we assign labels to ITEMIDs\n  -- this also fuses together multiple ITEMIDs containing the same data\n      , case\n        when itemid = 50800 then 'SPECIMEN'\n        when itemid = 50801 then 'AADO2'\n        when itemid = 50802 then 'BASEEXCESS'\n        when itemid = 50803 then 'BICARBONATE'\n        when itemid = 50804 then 'TOTALCO2'\n        when itemid = 50805 then 'CARBOXYHEMOGLOBIN'\n        when itemid = 50806 then 'CHLORIDE'\n        when itemid = 50808 then 'CALCIUM'\n        when itemid = 50809 then 'GLUCOSE'\n        when itemid = 50810 then 'HEMATOCRIT'\n        when itemid = 50811 then 'HEMOGLOBIN'\n        when itemid = 50812 then 'INTUBATED'\n        when itemid = 50813 then 'LACTATE'\n        when itemid = 50814 then 'METHEMOGLOBIN'\n        when itemid = 50815 then 'O2FLOW'\n        when itemid = 50816 then 'FIO2'\n        when itemid = 50817 then 'SO2' -- OXYGENSATURATION\n        when itemid = 50818 then 'PCO2'\n        when itemid = 50819 then 'PEEP'\n        when itemid = 50820 then 'PH'\n        when itemid = 50821 then 'PO2'\n        when itemid = 50822 then 'POTASSIUM'\n        when itemid = 50823 then 'REQUIREDO2'\n        when itemid = 50824 then 'SODIUM'\n        when itemid = 50825 then 'TEMPERATURE'\n        when itemid = 50826 then 'TIDALVOLUME'\n        when itemid = 50827 then 'VENTILATIONRATE'\n        when itemid = 50828 then 'VENTILATOR'\n        else null\n        end as label\n        , charttime\n        , value\n        -- add in some sanity checks on the values\n        , case\n          when valuenum <= 0 and itemid != 50802 then null -- allow negative baseexcess\n          when itemid = 50810 and valuenum > 100 then null -- hematocrit\n          -- ensure FiO2 is a valid number between 21-100\n          -- mistakes are rare (<100 obs out of ~100,000)\n          -- there are 862 obs of valuenum == 20 - some people round down!\n          -- rather than risk imputing garbage data for FiO2, we simply NULL invalid values\n          when itemid = 50816 and valuenum < 20 then null\n          when itemid = 50816 and valuenum > 100 then null\n          when itemid = 50817 and valuenum > 100 then null -- O2 sat\n          when itemid = 50815 and valuenum >  70 then null -- O2 flow\n          when itemid = 50821 and valuenum > 800 then null -- PO2\n           -- conservative upper limit\n        else valuenum\n        end as valuenum\n\n    FROM icustays ie\n    left join labevents le\n      on le.subject_id = ie.subject_id and le.hadm_id = ie.hadm_id\n      and le.charttime between (DATETIME_SUB(ie.intime, INTERVAL '6' HOUR)) and (DATETIME_ADD(ie.intime, INTERVAL '1' DAY))\n      and le.ITEMID in\n      -- blood gases\n      (\n        50800, 50801, 50802, 50803, 50804, 50805, 50806, 50807, 50808, 50809\n        , 50810, 50811, 50812, 50813, 50814, 50815, 50816, 50817, 50818, 50819\n        , 50820, 50821, 50822, 50823, 50824, 50825, 50826, 50827, 50828\n        , 51545\n      )\n)\nselect pvt.SUBJECT_ID, pvt.HADM_ID, pvt.ICUSTAY_ID, pvt.CHARTTIME\n, max(case when label = 'SPECIMEN' then value else null end) as specimen\n, max(case when label = 'AADO2' then valuenum else null end) as aado2\n, max(case when label = 'BASEEXCESS' then valuenum else null end) as baseexcess\n, max(case when label = 'BICARBONATE' then valuenum else null end) as bicarbonate\n, max(case when label = 'TOTALCO2' then valuenum else null end) as totalco2\n, max(case when label = 'CARBOXYHEMOGLOBIN' then valuenum else null end) as carboxyhemoglobin\n, max(case when label = 'CHLORIDE' then valuenum else null end) as chloride\n, max(case when label = 'CALCIUM' then valuenum else null end) as calcium\n, max(case when label = 'GLUCOSE' then valuenum else null end) as glucose\n, max(case when label = 'HEMATOCRIT' then valuenum else null end) as hematocrit\n, max(case when label = 'HEMOGLOBIN' then valuenum else null end) as hemoglobin\n, max(case when label = 'INTUBATED' then valuenum else null end) as intubated\n, max(case when label = 'LACTATE' then valuenum else null end) as lactate\n, max(case when label = 'METHEMOGLOBIN' then valuenum else null end) as methemoglobin\n, max(case when label = 'O2FLOW' then valuenum else null end) as o2flow\n, max(case when label = 'FIO2' then valuenum else null end) as fio2\n, max(case when label = 'SO2' then valuenum else null end) as so2 -- OXYGENSATURATION\n, max(case when label = 'PCO2' then valuenum else null end) as pco2\n, max(case when label = 'PEEP' then valuenum else null end) as peep\n, max(case when label = 'PH' then valuenum else null end) as ph\n, max(case when label = 'PO2' then valuenum else null end) as po2\n, max(case when label = 'POTASSIUM' then valuenum else null end) as potassium\n, max(case when label = 'REQUIREDO2' then valuenum else null end) as requiredo2\n, max(case when label = 'SODIUM' then valuenum else null end) as sodium\n, max(case when label = 'TEMPERATURE' then valuenum else null end) as temperature\n, max(case when label = 'TIDALVOLUME' then valuenum else null end) as tidalvolume\n, max(case when label = 'VENTILATIONRATE' then valuenum else null end) as ventilationrate\n, max(case when label = 'VENTILATOR' then valuenum else null end) as ventilator\nfrom pvt\ngroup by pvt.subject_id, pvt.hadm_id, pvt.icustay_id, pvt.CHARTTIME\norder by pvt.subject_id, pvt.hadm_id, pvt.icustay_id, pvt.CHARTTIME",
        "tables": [
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.labevents"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id"
            ],
            "hadm_id": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id"
            ],
            "icustay_id": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id"
            ],
            "charttime": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id"
            ],
            "specimen": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.value"
            ],
            "aado2": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "baseexcess": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "bicarbonate": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "totalco2": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "carboxyhemoglobin": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "chloride": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "calcium": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "glucose": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "hematocrit": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "hemoglobin": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "intubated": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "lactate": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "methemoglobin": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "o2flow": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "fio2": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "so2": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "pco2": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "peep": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "ph": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "po2": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "potassium": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "requiredo2": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "sodium": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "temperature": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "tidalvolume": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "ventilationrate": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "ventilator": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ]
        },
        "table_name": "mimiciii_clinical.blood_gas_first_day",
        "plan": {
            "Node Type": "Aggregate",
            "Strategy": "Sorted",
            "Partial Mode": "Simple",
            "Parallel Aware": false,
            "Output": [
                "pvt.subject_id",
                "pvt.hadm_id",
                "pvt.icustay_id",
                "pvt.charttime",
                "max((CASE WHEN (pvt.label = 'SPECIMEN'::text) THEN pvt.value ELSE NULL::character varying END)::text)",
                "max(CASE WHEN (pvt.label = 'AADO2'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'BASEEXCESS'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'BICARBONATE'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'TOTALCO2'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'CARBOXYHEMOGLOBIN'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'CHLORIDE'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'CALCIUM'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'GLUCOSE'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'HEMATOCRIT'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'HEMOGLOBIN'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'INTUBATED'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'LACTATE'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'METHEMOGLOBIN'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'O2FLOW'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'FIO2'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'SO2'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'PCO2'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'PEEP'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'PH'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'PO2'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'POTASSIUM'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'REQUIREDO2'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'SODIUM'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'TEMPERATURE'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'TIDALVOLUME'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'VENTILATIONRATE'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                "max(CASE WHEN (pvt.label = 'VENTILATOR'::text) THEN pvt.valuenum ELSE NULL::double precision END)"
            ],
            "Group Key": [
                "pvt.subject_id",
                "pvt.hadm_id",
                "pvt.icustay_id",
                "pvt.charttime"
            ],
            "Plans": [
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE pvt",
                    "Parallel Aware": false,
                    "Join Type": "Right",
                    "Output": [
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id",
                        "CASE WHEN (le.itemid = 50800) THEN 'SPECIMEN'::text WHEN (le.itemid = 50801) THEN 'AADO2'::text WHEN (le.itemid = 50802) THEN 'BASEEXCESS'::text WHEN (le.itemid = 50803) THEN 'BICARBONATE'::text WHEN (le.itemid = 50804) THEN 'TOTALCO2'::text WHEN (le.itemid = 50805) THEN 'CARBOXYHEMOGLOBIN'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50808) THEN 'CALCIUM'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50812) THEN 'INTUBATED'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 50814) THEN 'METHEMOGLOBIN'::text WHEN (le.itemid = 50815) THEN 'O2FLOW'::text WHEN (le.itemid = 50816) THEN 'FIO2'::text WHEN (le.itemid = 50817) THEN 'SO2'::text WHEN (le.itemid = 50818) THEN 'PCO2'::text WHEN (le.itemid = 50819) THEN 'PEEP'::text WHEN (le.itemid = 50820) THEN 'PH'::text WHEN (le.itemid = 50821) THEN 'PO2'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50823) THEN 'REQUIREDO2'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50825) THEN 'TEMPERATURE'::text WHEN (le.itemid = 50826) THEN 'TIDALVOLUME'::text WHEN (le.itemid = 50827) THEN 'VENTILATIONRATE'::text WHEN (le.itemid = 50828) THEN 'VENTILATOR'::text ELSE NULL::text END",
                        "le.charttime",
                        "le.value",
                        "CASE WHEN ((le.valuenum <= '0'::double precision) AND (le.itemid <> 50802)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50816) AND (le.valuenum < '20'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50816) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50817) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50815) AND (le.valuenum > '70'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50821) AND (le.valuenum > '800'::double precision)) THEN NULL::double precision ELSE le.valuenum END"
                    ],
                    "Inner Unique": false,
                    "Hash Cond": "((le.subject_id = ie.subject_id) AND (le.hadm_id = ie.hadm_id))",
                    "Join Filter": "((le.charttime >= datetime_sub(ie.intime, '06:00:00'::interval hour)) AND (le.charttime <= datetime_add(ie.intime, '1 day'::interval day)))",
                    "Plans": [
                        {
                            "Node Type": "Bitmap Heap Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "labevents",
                            "Schema": "mimiciii_clinical",
                            "Alias": "le",
                            "Output": [
                                "le.row_id",
                                "le.subject_id",
                                "le.hadm_id",
                                "le.itemid",
                                "le.charttime",
                                "le.value",
                                "le.valuenum",
                                "le.valueuom",
                                "le.flag"
                            ],
                            "Recheck Cond": "(le.itemid = ANY ('{50800,50801,50802,50803,50804,50805,50806,50807,50808,50809,50810,50811,50812,50813,50814,50815,50816,50817,50818,50819,50820,50821,50822,50823,50824,50825,50826,50827,50828,51545}'::integer[]))",
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Index Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Index Name": "labevents_idx03",
                                    "Index Cond": "(le.itemid = ANY ('{50800,50801,50802,50803,50804,50805,50806,50807,50808,50809,50810,50811,50812,50813,50814,50815,50816,50817,50818,50819,50820,50821,50822,50823,50824,50825,50826,50827,50828,51545}'::integer[]))"
                                }
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "ie.subject_id",
                                "ie.hadm_id",
                                "ie.icustay_id",
                                "ie.intime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "icustays",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ie",
                                    "Output": [
                                        "ie.subject_id",
                                        "ie.hadm_id",
                                        "ie.icustay_id",
                                        "ie.intime"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Sort",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "pvt.subject_id",
                        "pvt.hadm_id",
                        "pvt.icustay_id",
                        "pvt.charttime",
                        "pvt.label",
                        "pvt.value",
                        "pvt.valuenum"
                    ],
                    "Sort Key": [
                        "pvt.subject_id",
                        "pvt.hadm_id",
                        "pvt.icustay_id",
                        "pvt.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "pvt",
                            "Alias": "pvt",
                            "Output": [
                                "pvt.subject_id",
                                "pvt.hadm_id",
                                "pvt.icustay_id",
                                "pvt.charttime",
                                "pvt.label",
                                "pvt.value",
                                "pvt.valuenum"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.blood_gas_first_day_arterial": {
        "sql": "with stg_spo2 as\n(\n  select subject_id, hadm_id, icustay_id, charttime\n    -- max here is just used to group SpO2 by charttime\n    , max(case when valuenum <= 0 or valuenum > 100 then null else valuenum end) as SpO2\n  FROM chartevents\n  -- o2 sat\n  where ITEMID in\n  (\n    646 -- SpO2\n  , 220277 -- O2 saturation pulseoxymetry\n  )\n  group by subject_id, hadm_id, icustay_id, charttime\n)\n, stg_fio2 as\n(\n  select subject_id, hadm_id, icustay_id, charttime\n    -- pre-process the FiO2s to ensure they are between 21-100%\n    , max(\n        case\n          when itemid = 223835\n            then case\n              when valuenum > 0 and valuenum <= 1\n                then valuenum * 100\n              -- improperly input data - looks like O2 flow in litres\n              when valuenum > 1 and valuenum < 21\n                then null\n              when valuenum >= 21 and valuenum <= 100\n                then valuenum\n              else null end -- unphysiological\n        when itemid in (3420, 3422)\n        -- all these values are well formatted\n            then valuenum\n        when itemid = 190 and valuenum > 0.20 and valuenum < 1\n        -- well formatted but not in %\n            then valuenum * 100\n      else null end\n    ) as fio2_chartevents\n  FROM chartevents\n  where ITEMID in\n  (\n    3420 -- FiO2\n  , 190 -- FiO2 set\n  , 223835 -- Inspired O2 Fraction (FiO2)\n  , 3422 -- FiO2 [measured]\n  )\n  -- exclude rows marked as error\n  AND (error IS NULL OR error = 0)\n  group by subject_id, hadm_id, icustay_id, charttime\n)\n, stg2 as\n(\nselect bg.*\n  , ROW_NUMBER() OVER (partition by bg.icustay_id, bg.charttime order by s1.charttime DESC) as lastRowSpO2\n  , s1.spo2\nfrom \"mimic\".\"mimiciii_clinical\".\"blood_gas_first_day\" bg\nleft join stg_spo2 s1\n  -- same patient\n  on  bg.icustay_id = s1.icustay_id\n  -- spo2 occurred at most 2 hours before this blood gas\n  and s1.charttime >= DATETIME_SUB(bg.charttime, INTERVAL '2' HOUR)\n  and s1.charttime <= bg.charttime\nwhere bg.po2 is not null\n)\n, stg3 as\n(\nselect bg.*\n  , ROW_NUMBER() OVER (partition by bg.icustay_id, bg.charttime order by s2.charttime DESC) as lastRowFiO2\n  , s2.fio2_chartevents\n\n  -- create our specimen prediction\n  ,  1/(1+exp(-(-0.02544\n  +    0.04598 * po2\n  + coalesce(-0.15356 * spo2             , -0.15356 *   97.49420 +    0.13429)\n  + coalesce( 0.00621 * fio2_chartevents ,  0.00621 *   51.49550 +   -0.24958)\n  + coalesce( 0.10559 * hemoglobin       ,  0.10559 *   10.32307 +    0.05954)\n  + coalesce( 0.13251 * so2              ,  0.13251 *   93.66539 +   -0.23172)\n  + coalesce(-0.01511 * pco2             , -0.01511 *   42.08866 +   -0.01630)\n  + coalesce( 0.01480 * fio2             ,  0.01480 *   63.97836 +   -0.31142)\n  + coalesce(-0.00200 * aado2            , -0.00200 *  442.21186 +   -0.01328)\n  + coalesce(-0.03220 * bicarbonate      , -0.03220 *   22.96894 +   -0.06535)\n  + coalesce( 0.05384 * totalco2         ,  0.05384 *   24.72632 +   -0.01405)\n  + coalesce( 0.08202 * lactate          ,  0.08202 *    3.06436 +    0.06038)\n  + coalesce( 0.10956 * ph               ,  0.10956 *    7.36233 +   -0.00617)\n  + coalesce( 0.00848 * o2flow           ,  0.00848 *    7.59362 +   -0.35803)\n  ))) as SPECIMEN_PROB\nfrom stg2 bg\nleft join stg_fio2 s2\n  -- same patient\n  on  bg.icustay_id = s2.icustay_id\n  -- fio2 occurred at most 4 hours before this blood gas\n  and s2.charttime between DATETIME_SUB(bg.charttime, INTERVAL '4' HOUR) and bg.charttime\nwhere bg.lastRowSpO2 = 1 -- only the row with the most recent SpO2 (if no SpO2 found lastRowSpO2 = 1)\n)\n\nselect subject_id, hadm_id,\nicustay_id, charttime\n, specimen -- raw data indicating sample type, only present 80% of the time\n\n-- prediction of specimen for missing data\n, case\n      when SPECIMEN is not null then SPECIMEN\n      when SPECIMEN_PROB > 0.75 then 'ART'\n    else null end as SPECIMEN_PRED\n, specimen_prob\n-- oxygen related parameters\n, so2, spo2 -- note spo2 is FROM chartevents\n, po2, pco2\n, fio2_chartevents, fio2\n, aado2\n-- also calculate AADO2\n, case\n    when  PO2 is not null\n      and pco2 is not null\n      and coalesce(fio2, fio2_chartevents) is not null\n     -- multiple by 100 because FiO2 is in a % but should be a fraction\n      then (coalesce(fio2, fio2_chartevents)/100) * (760 - 47) - (pco2/0.8) - po2\n    else null\n  end as AADO2_calc\n, case\n    when PO2 is not null and coalesce(fio2, fio2_chartevents) is not null\n     -- multiply by 100 because FiO2 is in a % but should be a fraction\n      then 100*PO2/(coalesce(fio2, fio2_chartevents))\n    else null\n  end as PaO2FiO2\n-- acid-base parameters\n, ph, baseexcess\n, bicarbonate, totalco2\n\n-- blood count parameters\n, hematocrit\n, hemoglobin\n, carboxyhemoglobin\n, methemoglobin\n\n-- chemistry\n, chloride, calcium\n, temperature\n, potassium, sodium\n, lactate\n, glucose\n\n-- ventilation stuff that's sometimes input\n, intubated, tidalvolume, ventilationrate, ventilator\n, peep, o2flow\n, requiredo2\n\nfrom stg3\nwhere lastRowFiO2 = 1 -- only the most recent FiO2\n-- restrict it to *only* arterial samples\nand (specimen = 'ART' or specimen_prob > 0.75)\norder by icustay_id, charttime",
        "tables": [
            "mimiciii_clinical.blood_gas_first_day",
            "mimiciii_clinical.chartevents"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.subject_id",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "hadm_id": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hadm_id",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "icustay_id": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "charttime": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "specimen": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "specimen_pred": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "specimen_prob": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "so2": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "spo2": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "po2": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "pco2": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "fio2_chartevents": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "fio2": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "aado2": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "aado2_calc": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "pao2fio2": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "ph": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "baseexcess": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.baseexcess",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "bicarbonate": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "totalco2": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "hematocrit": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hematocrit",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "hemoglobin": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "carboxyhemoglobin": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.carboxyhemoglobin",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "methemoglobin": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.methemoglobin",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "chloride": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.chloride",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "calcium": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.calcium",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "temperature": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.temperature",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "potassium": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.potassium",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "sodium": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.sodium",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "lactate": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "glucose": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.glucose",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "intubated": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.intubated",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "tidalvolume": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.tidalvolume",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "ventilationrate": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.blood_gas_first_day.ventilationrate",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "ventilator": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.blood_gas_first_day.ventilator",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "peep": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.peep",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "o2flow": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "requiredo2": [
                "mimiciii_clinical.blood_gas_first_day.aado2",
                "mimiciii_clinical.blood_gas_first_day.bicarbonate",
                "mimiciii_clinical.blood_gas_first_day.charttime",
                "mimiciii_clinical.blood_gas_first_day.fio2",
                "mimiciii_clinical.blood_gas_first_day.hemoglobin",
                "mimiciii_clinical.blood_gas_first_day.icustay_id",
                "mimiciii_clinical.blood_gas_first_day.lactate",
                "mimiciii_clinical.blood_gas_first_day.o2flow",
                "mimiciii_clinical.blood_gas_first_day.pco2",
                "mimiciii_clinical.blood_gas_first_day.ph",
                "mimiciii_clinical.blood_gas_first_day.po2",
                "mimiciii_clinical.blood_gas_first_day.requiredo2",
                "mimiciii_clinical.blood_gas_first_day.so2",
                "mimiciii_clinical.blood_gas_first_day.specimen",
                "mimiciii_clinical.blood_gas_first_day.totalco2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum"
            ]
        },
        "table_name": "mimiciii_clinical.blood_gas_first_day_arterial",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "stg3.subject_id",
                "stg3.hadm_id",
                "stg3.icustay_id",
                "stg3.charttime",
                "stg3.specimen",
                "(CASE WHEN (stg3.specimen IS NOT NULL) THEN stg3.specimen WHEN (stg3.specimen_prob > '0.75'::double precision) THEN 'ART'::text ELSE NULL::text END)",
                "stg3.specimen_prob",
                "stg3.so2",
                "stg3.spo2",
                "stg3.po2",
                "stg3.pco2",
                "stg3.fio2_chartevents",
                "stg3.fio2",
                "stg3.aado2",
                "(CASE WHEN ((stg3.po2 IS NOT NULL) AND (stg3.pco2 IS NOT NULL) AND (COALESCE(stg3.fio2, stg3.fio2_chartevents) IS NOT NULL)) THEN ((((COALESCE(stg3.fio2, stg3.fio2_chartevents) / '100'::double precision) * '713'::double precision) - (stg3.pco2 / '0.8'::double precision)) - stg3.po2) ELSE NULL::double precision END)",
                "(CASE WHEN ((stg3.po2 IS NOT NULL) AND (COALESCE(stg3.fio2, stg3.fio2_chartevents) IS NOT NULL)) THEN (('100'::double precision * stg3.po2) / COALESCE(stg3.fio2, stg3.fio2_chartevents)) ELSE NULL::double precision END)",
                "stg3.ph",
                "stg3.baseexcess",
                "stg3.bicarbonate",
                "stg3.totalco2",
                "stg3.hematocrit",
                "stg3.hemoglobin",
                "stg3.carboxyhemoglobin",
                "stg3.methemoglobin",
                "stg3.chloride",
                "stg3.calcium",
                "stg3.temperature",
                "stg3.potassium",
                "stg3.sodium",
                "stg3.lactate",
                "stg3.glucose",
                "stg3.intubated",
                "stg3.tidalvolume",
                "stg3.ventilationrate",
                "stg3.ventilator",
                "stg3.peep",
                "stg3.o2flow",
                "stg3.requiredo2"
            ],
            "Sort Key": [
                "stg3.icustay_id",
                "stg3.charttime"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE stg_spo2",
                    "Parallel Aware": false,
                    "Output": [
                        "chartevents_69.subject_id",
                        "chartevents_69.hadm_id",
                        "chartevents_69.icustay_id",
                        "chartevents_69.charttime",
                        "max(CASE WHEN ((chartevents_69.valuenum <= '0'::double precision) OR (chartevents_69.valuenum > '100'::double precision)) THEN NULL::double precision ELSE chartevents_69.valuenum END)"
                    ],
                    "Group Key": [
                        "chartevents_69.subject_id",
                        "chartevents_69.hadm_id",
                        "chartevents_69.icustay_id",
                        "chartevents_69.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "chartevents_69.subject_id",
                                "chartevents_69.hadm_id",
                                "chartevents_69.icustay_id",
                                "chartevents_69.charttime",
                                "chartevents_69.valuenum"
                            ],
                            "Sort Key": [
                                "chartevents_69.subject_id",
                                "chartevents_69.hadm_id",
                                "chartevents_69.icustay_id",
                                "chartevents_69.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Append",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_69",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "chartevents_69",
                                            "Output": [
                                                "chartevents_69.subject_id",
                                                "chartevents_69.hadm_id",
                                                "chartevents_69.icustay_id",
                                                "chartevents_69.charttime",
                                                "chartevents_69.valuenum"
                                            ],
                                            "Filter": "(chartevents_69.itemid = ANY ('{646,220277}'::integer[]))"
                                        },
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_170",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "chartevents_170",
                                            "Output": [
                                                "chartevents_170.subject_id",
                                                "chartevents_170.hadm_id",
                                                "chartevents_170.icustay_id",
                                                "chartevents_170.charttime",
                                                "chartevents_170.valuenum"
                                            ],
                                            "Filter": "(chartevents_170.itemid = ANY ('{646,220277}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE stg_fio2",
                    "Parallel Aware": false,
                    "Output": [
                        "chartevents_27.subject_id",
                        "chartevents_27.hadm_id",
                        "chartevents_27.icustay_id",
                        "chartevents_27.charttime",
                        "max(CASE WHEN (chartevents_27.itemid = 223835) THEN CASE WHEN ((chartevents_27.valuenum > '0'::double precision) AND (chartevents_27.valuenum <= '1'::double precision)) THEN (chartevents_27.valuenum * '100'::double precision) WHEN ((chartevents_27.valuenum > '1'::double precision) AND (chartevents_27.valuenum < '21'::double precision)) THEN NULL::double precision WHEN ((chartevents_27.valuenum >= '21'::double precision) AND (chartevents_27.valuenum <= '100'::double precision)) THEN chartevents_27.valuenum ELSE NULL::double precision END WHEN (chartevents_27.itemid = ANY ('{3420,3422}'::integer[])) THEN chartevents_27.valuenum WHEN ((chartevents_27.itemid = 190) AND (chartevents_27.valuenum > '0.2'::double precision) AND (chartevents_27.valuenum < '1'::double precision)) THEN (chartevents_27.valuenum * '100'::double precision) ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "chartevents_27.subject_id",
                        "chartevents_27.hadm_id",
                        "chartevents_27.icustay_id",
                        "chartevents_27.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "chartevents_27.subject_id",
                                "chartevents_27.hadm_id",
                                "chartevents_27.icustay_id",
                                "chartevents_27.charttime",
                                "chartevents_27.itemid",
                                "chartevents_27.valuenum"
                            ],
                            "Sort Key": [
                                "chartevents_27.subject_id",
                                "chartevents_27.hadm_id",
                                "chartevents_27.icustay_id",
                                "chartevents_27.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Append",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_27",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "chartevents_27",
                                            "Output": [
                                                "chartevents_27.subject_id",
                                                "chartevents_27.hadm_id",
                                                "chartevents_27.icustay_id",
                                                "chartevents_27.charttime",
                                                "chartevents_27.itemid",
                                                "chartevents_27.valuenum"
                                            ],
                                            "Recheck Cond": "(chartevents_27.itemid = ANY ('{3420,190,223835,3422}'::integer[]))",
                                            "Filter": "((chartevents_27.error IS NULL) OR (chartevents_27.error = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_27_idx01",
                                                    "Index Cond": "(chartevents_27.itemid = ANY ('{3420,190,223835,3422}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_107",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "chartevents_107",
                                            "Output": [
                                                "chartevents_107.subject_id",
                                                "chartevents_107.hadm_id",
                                                "chartevents_107.icustay_id",
                                                "chartevents_107.charttime",
                                                "chartevents_107.itemid",
                                                "chartevents_107.valuenum"
                                            ],
                                            "Filter": "(((chartevents_107.error IS NULL) OR (chartevents_107.error = 0)) AND (chartevents_107.itemid = ANY ('{3420,190,223835,3422}'::integer[])))"
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_108",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "chartevents_108",
                                            "Output": [
                                                "chartevents_108.subject_id",
                                                "chartevents_108.hadm_id",
                                                "chartevents_108.icustay_id",
                                                "chartevents_108.charttime",
                                                "chartevents_108.itemid",
                                                "chartevents_108.valuenum"
                                            ],
                                            "Recheck Cond": "(chartevents_108.itemid = ANY ('{3420,190,223835,3422}'::integer[]))",
                                            "Filter": "((chartevents_108.error IS NULL) OR (chartevents_108.error = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_108_idx01",
                                                    "Index Cond": "(chartevents_108.itemid = ANY ('{3420,190,223835,3422}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_175",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "chartevents_175",
                                            "Output": [
                                                "chartevents_175.subject_id",
                                                "chartevents_175.hadm_id",
                                                "chartevents_175.icustay_id",
                                                "chartevents_175.charttime",
                                                "chartevents_175.itemid",
                                                "chartevents_175.valuenum"
                                            ],
                                            "Recheck Cond": "(chartevents_175.itemid = ANY ('{3420,190,223835,3422}'::integer[]))",
                                            "Filter": "((chartevents_175.error IS NULL) OR (chartevents_175.error = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_175_idx01",
                                                    "Index Cond": "(chartevents_175.itemid = ANY ('{3420,190,223835,3422}'::integer[]))"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE stg2",
                    "Parallel Aware": false,
                    "Output": [
                        "bg.subject_id",
                        "bg.hadm_id",
                        "bg.icustay_id",
                        "bg.charttime",
                        "bg.specimen",
                        "bg.aado2",
                        "bg.baseexcess",
                        "bg.bicarbonate",
                        "bg.totalco2",
                        "bg.carboxyhemoglobin",
                        "bg.chloride",
                        "bg.calcium",
                        "bg.glucose",
                        "bg.hematocrit",
                        "bg.hemoglobin",
                        "bg.intubated",
                        "bg.lactate",
                        "bg.methemoglobin",
                        "bg.o2flow",
                        "bg.fio2",
                        "bg.so2",
                        "bg.pco2",
                        "bg.peep",
                        "bg.ph",
                        "bg.po2",
                        "bg.potassium",
                        "bg.requiredo2",
                        "bg.sodium",
                        "bg.temperature",
                        "bg.tidalvolume",
                        "bg.ventilationrate",
                        "bg.ventilator",
                        "row_number() OVER (?)",
                        "s1.spo2",
                        "s1.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "bg.icustay_id",
                                "bg.charttime",
                                "s1.charttime",
                                "bg.subject_id",
                                "bg.hadm_id",
                                "bg.specimen",
                                "bg.aado2",
                                "bg.baseexcess",
                                "bg.bicarbonate",
                                "bg.totalco2",
                                "bg.carboxyhemoglobin",
                                "bg.chloride",
                                "bg.calcium",
                                "bg.glucose",
                                "bg.hematocrit",
                                "bg.hemoglobin",
                                "bg.intubated",
                                "bg.lactate",
                                "bg.methemoglobin",
                                "bg.o2flow",
                                "bg.fio2",
                                "bg.so2",
                                "bg.pco2",
                                "bg.peep",
                                "bg.ph",
                                "bg.po2",
                                "bg.potassium",
                                "bg.requiredo2",
                                "bg.sodium",
                                "bg.temperature",
                                "bg.tidalvolume",
                                "bg.ventilationrate",
                                "bg.ventilator",
                                "s1.spo2"
                            ],
                            "Sort Key": [
                                "bg.icustay_id",
                                "bg.charttime",
                                "s1.charttime DESC"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Right",
                                    "Output": [
                                        "bg.icustay_id",
                                        "bg.charttime",
                                        "s1.charttime",
                                        "bg.subject_id",
                                        "bg.hadm_id",
                                        "bg.specimen",
                                        "bg.aado2",
                                        "bg.baseexcess",
                                        "bg.bicarbonate",
                                        "bg.totalco2",
                                        "bg.carboxyhemoglobin",
                                        "bg.chloride",
                                        "bg.calcium",
                                        "bg.glucose",
                                        "bg.hematocrit",
                                        "bg.hemoglobin",
                                        "bg.intubated",
                                        "bg.lactate",
                                        "bg.methemoglobin",
                                        "bg.o2flow",
                                        "bg.fio2",
                                        "bg.so2",
                                        "bg.pco2",
                                        "bg.peep",
                                        "bg.ph",
                                        "bg.po2",
                                        "bg.potassium",
                                        "bg.requiredo2",
                                        "bg.sodium",
                                        "bg.temperature",
                                        "bg.tidalvolume",
                                        "bg.ventilationrate",
                                        "bg.ventilator",
                                        "s1.spo2"
                                    ],
                                    "Inner Unique": false,
                                    "Hash Cond": "(s1.icustay_id = bg.icustay_id)",
                                    "Join Filter": "((s1.charttime <= bg.charttime) AND (s1.charttime >= datetime_sub(bg.charttime, '02:00:00'::interval hour)))",
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "stg_spo2",
                                            "Alias": "s1",
                                            "Output": [
                                                "s1.spo2",
                                                "s1.charttime",
                                                "s1.icustay_id"
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "bg.subject_id",
                                                "bg.hadm_id",
                                                "bg.icustay_id",
                                                "bg.charttime",
                                                "bg.specimen",
                                                "bg.aado2",
                                                "bg.baseexcess",
                                                "bg.bicarbonate",
                                                "bg.totalco2",
                                                "bg.carboxyhemoglobin",
                                                "bg.chloride",
                                                "bg.calcium",
                                                "bg.glucose",
                                                "bg.hematocrit",
                                                "bg.hemoglobin",
                                                "bg.intubated",
                                                "bg.lactate",
                                                "bg.methemoglobin",
                                                "bg.o2flow",
                                                "bg.fio2",
                                                "bg.so2",
                                                "bg.pco2",
                                                "bg.peep",
                                                "bg.ph",
                                                "bg.po2",
                                                "bg.potassium",
                                                "bg.requiredo2",
                                                "bg.sodium",
                                                "bg.temperature",
                                                "bg.tidalvolume",
                                                "bg.ventilationrate",
                                                "bg.ventilator"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "blood_gas_first_day",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "bg",
                                                    "Output": [
                                                        "bg.subject_id",
                                                        "bg.hadm_id",
                                                        "bg.icustay_id",
                                                        "bg.charttime",
                                                        "bg.specimen",
                                                        "bg.aado2",
                                                        "bg.baseexcess",
                                                        "bg.bicarbonate",
                                                        "bg.totalco2",
                                                        "bg.carboxyhemoglobin",
                                                        "bg.chloride",
                                                        "bg.calcium",
                                                        "bg.glucose",
                                                        "bg.hematocrit",
                                                        "bg.hemoglobin",
                                                        "bg.intubated",
                                                        "bg.lactate",
                                                        "bg.methemoglobin",
                                                        "bg.o2flow",
                                                        "bg.fio2",
                                                        "bg.so2",
                                                        "bg.pco2",
                                                        "bg.peep",
                                                        "bg.ph",
                                                        "bg.po2",
                                                        "bg.potassium",
                                                        "bg.requiredo2",
                                                        "bg.sodium",
                                                        "bg.temperature",
                                                        "bg.tidalvolume",
                                                        "bg.ventilationrate",
                                                        "bg.ventilator"
                                                    ],
                                                    "Filter": "(bg.po2 IS NOT NULL)"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE stg3",
                    "Parallel Aware": false,
                    "Output": [
                        "bg_1.subject_id",
                        "bg_1.hadm_id",
                        "bg_1.icustay_id",
                        "bg_1.charttime",
                        "bg_1.specimen",
                        "bg_1.aado2",
                        "bg_1.baseexcess",
                        "bg_1.bicarbonate",
                        "bg_1.totalco2",
                        "bg_1.carboxyhemoglobin",
                        "bg_1.chloride",
                        "bg_1.calcium",
                        "bg_1.glucose",
                        "bg_1.hematocrit",
                        "bg_1.hemoglobin",
                        "bg_1.intubated",
                        "bg_1.lactate",
                        "bg_1.methemoglobin",
                        "bg_1.o2flow",
                        "bg_1.fio2",
                        "bg_1.so2",
                        "bg_1.pco2",
                        "bg_1.peep",
                        "bg_1.ph",
                        "bg_1.po2",
                        "bg_1.potassium",
                        "bg_1.requiredo2",
                        "bg_1.sodium",
                        "bg_1.temperature",
                        "bg_1.tidalvolume",
                        "bg_1.ventilationrate",
                        "bg_1.ventilator",
                        "bg_1.lastrowspo2",
                        "bg_1.spo2",
                        "row_number() OVER (?)",
                        "s2.fio2_chartevents",
                        "('1'::double precision / ('1'::double precision + exp((- ((((((((((((('-0.02544'::double precision + ('0.04598'::double precision * bg_1.po2)) + COALESCE(('-0.15356'::double precision * bg_1.spo2), '-14.836919352'::double precision)) + COALESCE(('0.00621'::double precision * s2.fio2_chartevents), '0.070207055'::double precision)) + COALESCE(('0.10559'::double precision * bg_1.hemoglobin), '1.1495529613'::double precision)) + COALESCE(('0.13251'::double precision * bg_1.so2), '12.1798808289'::double precision)) + COALESCE(('-0.01511'::double precision * bg_1.pco2), '-0.6522596526'::double precision)) + COALESCE(('0.0148'::double precision * bg_1.fio2), '0.635459728'::double precision)) + COALESCE(('-0.002'::double precision * bg_1.aado2), '-0.89770372'::double precision)) + COALESCE(('-0.0322'::double precision * bg_1.bicarbonate), '-0.804949868'::double precision)) + COALESCE(('0.05384'::double precision * bg_1.totalco2), '1.3172150688'::double precision)) + COALESCE(('0.08202'::double precision * bg_1.lactate), '0.3117188072'::double precision)) + COALESCE(('0.10956'::double precision * bg_1.ph), '0.8004468748'::double precision)) + COALESCE(('0.00848'::double precision * bg_1.o2flow), '-0.2936361024'::double precision))))))",
                        "s2.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "bg_1.icustay_id",
                                "bg_1.charttime",
                                "s2.charttime",
                                "bg_1.subject_id",
                                "bg_1.hadm_id",
                                "bg_1.specimen",
                                "bg_1.aado2",
                                "bg_1.baseexcess",
                                "bg_1.bicarbonate",
                                "bg_1.totalco2",
                                "bg_1.carboxyhemoglobin",
                                "bg_1.chloride",
                                "bg_1.calcium",
                                "bg_1.glucose",
                                "bg_1.hematocrit",
                                "bg_1.hemoglobin",
                                "bg_1.intubated",
                                "bg_1.lactate",
                                "bg_1.methemoglobin",
                                "bg_1.o2flow",
                                "bg_1.fio2",
                                "bg_1.so2",
                                "bg_1.pco2",
                                "bg_1.peep",
                                "bg_1.ph",
                                "bg_1.po2",
                                "bg_1.potassium",
                                "bg_1.requiredo2",
                                "bg_1.sodium",
                                "bg_1.temperature",
                                "bg_1.tidalvolume",
                                "bg_1.ventilationrate",
                                "bg_1.ventilator",
                                "bg_1.lastrowspo2",
                                "bg_1.spo2",
                                "s2.fio2_chartevents"
                            ],
                            "Sort Key": [
                                "bg_1.icustay_id",
                                "bg_1.charttime",
                                "s2.charttime DESC"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Merge Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Left",
                                    "Output": [
                                        "bg_1.icustay_id",
                                        "bg_1.charttime",
                                        "s2.charttime",
                                        "bg_1.subject_id",
                                        "bg_1.hadm_id",
                                        "bg_1.specimen",
                                        "bg_1.aado2",
                                        "bg_1.baseexcess",
                                        "bg_1.bicarbonate",
                                        "bg_1.totalco2",
                                        "bg_1.carboxyhemoglobin",
                                        "bg_1.chloride",
                                        "bg_1.calcium",
                                        "bg_1.glucose",
                                        "bg_1.hematocrit",
                                        "bg_1.hemoglobin",
                                        "bg_1.intubated",
                                        "bg_1.lactate",
                                        "bg_1.methemoglobin",
                                        "bg_1.o2flow",
                                        "bg_1.fio2",
                                        "bg_1.so2",
                                        "bg_1.pco2",
                                        "bg_1.peep",
                                        "bg_1.ph",
                                        "bg_1.po2",
                                        "bg_1.potassium",
                                        "bg_1.requiredo2",
                                        "bg_1.sodium",
                                        "bg_1.temperature",
                                        "bg_1.tidalvolume",
                                        "bg_1.ventilationrate",
                                        "bg_1.ventilator",
                                        "bg_1.lastrowspo2",
                                        "bg_1.spo2",
                                        "s2.fio2_chartevents"
                                    ],
                                    "Inner Unique": false,
                                    "Merge Cond": "(bg_1.icustay_id = s2.icustay_id)",
                                    "Join Filter": "((s2.charttime <= bg_1.charttime) AND (s2.charttime >= datetime_sub(bg_1.charttime, '04:00:00'::interval hour)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "bg_1.subject_id",
                                                "bg_1.hadm_id",
                                                "bg_1.icustay_id",
                                                "bg_1.charttime",
                                                "bg_1.specimen",
                                                "bg_1.aado2",
                                                "bg_1.baseexcess",
                                                "bg_1.bicarbonate",
                                                "bg_1.totalco2",
                                                "bg_1.carboxyhemoglobin",
                                                "bg_1.chloride",
                                                "bg_1.calcium",
                                                "bg_1.glucose",
                                                "bg_1.hematocrit",
                                                "bg_1.hemoglobin",
                                                "bg_1.intubated",
                                                "bg_1.lactate",
                                                "bg_1.methemoglobin",
                                                "bg_1.o2flow",
                                                "bg_1.fio2",
                                                "bg_1.so2",
                                                "bg_1.pco2",
                                                "bg_1.peep",
                                                "bg_1.ph",
                                                "bg_1.po2",
                                                "bg_1.potassium",
                                                "bg_1.requiredo2",
                                                "bg_1.sodium",
                                                "bg_1.temperature",
                                                "bg_1.tidalvolume",
                                                "bg_1.ventilationrate",
                                                "bg_1.ventilator",
                                                "bg_1.lastrowspo2",
                                                "bg_1.spo2"
                                            ],
                                            "Sort Key": [
                                                "bg_1.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "stg2",
                                                    "Alias": "bg_1",
                                                    "Output": [
                                                        "bg_1.subject_id",
                                                        "bg_1.hadm_id",
                                                        "bg_1.icustay_id",
                                                        "bg_1.charttime",
                                                        "bg_1.specimen",
                                                        "bg_1.aado2",
                                                        "bg_1.baseexcess",
                                                        "bg_1.bicarbonate",
                                                        "bg_1.totalco2",
                                                        "bg_1.carboxyhemoglobin",
                                                        "bg_1.chloride",
                                                        "bg_1.calcium",
                                                        "bg_1.glucose",
                                                        "bg_1.hematocrit",
                                                        "bg_1.hemoglobin",
                                                        "bg_1.intubated",
                                                        "bg_1.lactate",
                                                        "bg_1.methemoglobin",
                                                        "bg_1.o2flow",
                                                        "bg_1.fio2",
                                                        "bg_1.so2",
                                                        "bg_1.pco2",
                                                        "bg_1.peep",
                                                        "bg_1.ph",
                                                        "bg_1.po2",
                                                        "bg_1.potassium",
                                                        "bg_1.requiredo2",
                                                        "bg_1.sodium",
                                                        "bg_1.temperature",
                                                        "bg_1.tidalvolume",
                                                        "bg_1.ventilationrate",
                                                        "bg_1.ventilator",
                                                        "bg_1.lastrowspo2",
                                                        "bg_1.spo2"
                                                    ],
                                                    "Filter": "(bg_1.lastrowspo2 = 1)"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Materialize",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "s2.fio2_chartevents",
                                                "s2.charttime",
                                                "s2.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Sort",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Output": [
                                                        "s2.fio2_chartevents",
                                                        "s2.charttime",
                                                        "s2.icustay_id"
                                                    ],
                                                    "Sort Key": [
                                                        "s2.icustay_id"
                                                    ],
                                                    "Plans": [
                                                        {
                                                            "Node Type": "CTE Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "CTE Name": "stg_fio2",
                                                            "Alias": "s2",
                                                            "Output": [
                                                                "s2.fio2_chartevents",
                                                                "s2.charttime",
                                                                "s2.icustay_id"
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "CTE Name": "stg3",
                    "Alias": "stg3",
                    "Output": [
                        "stg3.subject_id",
                        "stg3.hadm_id",
                        "stg3.icustay_id",
                        "stg3.charttime",
                        "stg3.specimen",
                        "CASE WHEN (stg3.specimen IS NOT NULL) THEN stg3.specimen WHEN (stg3.specimen_prob > '0.75'::double precision) THEN 'ART'::text ELSE NULL::text END",
                        "stg3.specimen_prob",
                        "stg3.so2",
                        "stg3.spo2",
                        "stg3.po2",
                        "stg3.pco2",
                        "stg3.fio2_chartevents",
                        "stg3.fio2",
                        "stg3.aado2",
                        "CASE WHEN ((stg3.po2 IS NOT NULL) AND (stg3.pco2 IS NOT NULL) AND (COALESCE(stg3.fio2, stg3.fio2_chartevents) IS NOT NULL)) THEN ((((COALESCE(stg3.fio2, stg3.fio2_chartevents) / '100'::double precision) * '713'::double precision) - (stg3.pco2 / '0.8'::double precision)) - stg3.po2) ELSE NULL::double precision END",
                        "CASE WHEN ((stg3.po2 IS NOT NULL) AND (COALESCE(stg3.fio2, stg3.fio2_chartevents) IS NOT NULL)) THEN (('100'::double precision * stg3.po2) / COALESCE(stg3.fio2, stg3.fio2_chartevents)) ELSE NULL::double precision END",
                        "stg3.ph",
                        "stg3.baseexcess",
                        "stg3.bicarbonate",
                        "stg3.totalco2",
                        "stg3.hematocrit",
                        "stg3.hemoglobin",
                        "stg3.carboxyhemoglobin",
                        "stg3.methemoglobin",
                        "stg3.chloride",
                        "stg3.calcium",
                        "stg3.temperature",
                        "stg3.potassium",
                        "stg3.sodium",
                        "stg3.lactate",
                        "stg3.glucose",
                        "stg3.intubated",
                        "stg3.tidalvolume",
                        "stg3.ventilationrate",
                        "stg3.ventilator",
                        "stg3.peep",
                        "stg3.o2flow",
                        "stg3.requiredo2"
                    ],
                    "Filter": "((stg3.lastrowfio2 = 1) AND ((stg3.specimen = 'ART'::text) OR (stg3.specimen_prob > '0.75'::double precision)))"
                }
            ]
        }
    },
    "model.mimic.gcs_first_day": {
        "sql": "-- ITEMIDs used:\n\n-- CAREVUE\n--    723 as GCSVerbal\n--    454 as GCSMotor\n--    184 as GCSEyes\n\n-- METAVISION\n--    223900 GCS - Verbal Response\n--    223901 GCS - Motor Response\n--    220739 GCS - Eye Opening\n\n-- The code combines the ITEMIDs into the carevue itemids, then pivots those\n-- So 223900 is changed to 723, then the ITEMID 723 is pivoted to form GCSVerbal\n\n-- Note:\n--  The GCS for sedated patients is defaulted to 15 in this code.\n--  This is in line with how the data is meant to be collected.\n--  e.g., from the SAPS II publication:\n--    For sedated patients, the Glasgow Coma Score before sedation was used.\n--    This was ascertained either from interviewing the physician who ordered the sedation,\n--    or by reviewing the patient's medical record.\n\nwith base as\n(\n  SELECT pvt.ICUSTAY_ID\n  , pvt.charttime\n\n  -- Easier names - note we coalesced Metavision and CareVue IDs below\n  , max(case when pvt.itemid = 454 then pvt.valuenum else null end) as GCSMotor\n  , max(case when pvt.itemid = 723 then pvt.valuenum else null end) as GCSVerbal\n  , max(case when pvt.itemid = 184 then pvt.valuenum else null end) as GCSEyes\n\n  -- If verbal was set to 0 in the below select, then this is an intubated patient\n  , case\n      when max(case when pvt.itemid = 723 then pvt.valuenum else null end) = 0\n    then 1\n    else 0\n    end as EndoTrachFlag\n\n  , ROW_NUMBER ()\n          OVER (PARTITION BY pvt.ICUSTAY_ID ORDER BY pvt.charttime ASC) as rn\n\n  FROM  (\n  select l.ICUSTAY_ID\n  -- merge the ITEMIDs so that the pivot applies to both metavision/carevue data\n  , case\n      when l.ITEMID in (723,223900) then 723\n      when l.ITEMID in (454,223901) then 454\n      when l.ITEMID in (184,220739) then 184\n      else l.ITEMID end\n    as ITEMID\n\n  -- convert the data into a number, reserving a value of 0 for ET/Trach\n  , case\n      -- endotrach/vent is assigned a value of 0, later parsed specially\n      when l.ITEMID = 723 and l.VALUE = '1.0 ET/Trach' then 0 -- carevue\n      when l.ITEMID = 223900 and l.VALUE = 'No Response-ETT' then 0 -- metavision\n\n      else VALUENUM\n      end\n    as VALUENUM\n  , l.CHARTTIME\n  FROM chartevents l\n\n  -- get intime for charttime subselection\n  inner join icustays b\n    on l.icustay_id = b.icustay_id\n\n  -- Isolate the desired GCS variables\n  where l.ITEMID in\n  (\n    -- 198 -- GCS\n    -- GCS components, CareVue\n    184, 454, 723\n    -- GCS components, Metavision\n    , 223900, 223901, 220739\n  )\n  -- Only get data for the first 24 hours\n  and l.charttime between b.intime and DATETIME_ADD(b.intime, INTERVAL '1' DAY)\n  -- exclude rows marked as error\n  AND (l.error IS NULL OR l.error = 0)\n  ) pvt\n  group by pvt.ICUSTAY_ID, pvt.charttime\n)\n, gcs as (\n  select b.*\n  , b2.GCSVerbal as GCSVerbalPrev\n  , b2.GCSMotor as GCSMotorPrev\n  , b2.GCSEyes as GCSEyesPrev\n  -- Calculate GCS, factoring in special case when they are intubated and prev vals\n  -- note that the coalesce are used to implement the following if:\n  --  if current value exists, use it\n  --  if previous value exists, use it\n  --  otherwise, default to normal\n  , case\n      -- replace GCS during sedation with 15\n      when b.GCSVerbal = 0\n        then 15\n      when b.GCSVerbal is null and b2.GCSVerbal = 0\n        then 15\n      -- if previously they were intub, but they aren't now, do not use previous GCS values\n      when b2.GCSVerbal = 0\n        then\n            coalesce(b.GCSMotor,6)\n          + coalesce(b.GCSVerbal,5)\n          + coalesce(b.GCSEyes,4)\n      -- otherwise, add up score normally, imputing previous value if none available at current time\n      else\n            coalesce(b.GCSMotor,coalesce(b2.GCSMotor,6))\n          + coalesce(b.GCSVerbal,coalesce(b2.GCSVerbal,5))\n          + coalesce(b.GCSEyes,coalesce(b2.GCSEyes,4))\n      end as GCS\n\n  from base b\n  -- join to itself within 6 hours to get previous value\n  left join base b2\n    on b.ICUSTAY_ID = b2.ICUSTAY_ID and b.rn = b2.rn+1 and b2.charttime > DATETIME_SUB(b.charttime, INTERVAL '6' HOUR)\n)\n, gcs_final as (\n  select gcs.*\n  -- This sorts the data by GCS, so rn=1 is the the lowest GCS values to keep\n  , ROW_NUMBER ()\n          OVER (PARTITION BY gcs.ICUSTAY_ID\n                ORDER BY gcs.GCS\n               ) as IsMinGCS\n  from gcs\n)\nselect ie.subject_id, ie.hadm_id, ie.icustay_id\n-- The minimum GCS is determined by the above row partition, we only join if IsMinGCS=1\n, GCS as mingcs\n, coalesce(GCSMotor,GCSMotorPrev) as gcsmotor\n, coalesce(GCSVerbal,GCSVerbalPrev) as gcsverbal\n, coalesce(GCSEyes,GCSEyesPrev) as gcseyes\n, EndoTrachFlag as endotrachflag\n\n-- subselect down to the cohort of eligible patients\nFROM icustays ie\nleft join gcs_final gs\n  on ie.icustay_id = gs.icustay_id and gs.IsMinGCS = 1\nORDER BY ie.icustay_id",
        "tables": [
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.icustays"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "hadm_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime"
            ],
            "icustay_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime"
            ],
            "mingcs": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime"
            ],
            "gcsmotor": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime"
            ],
            "gcsverbal": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime"
            ],
            "gcseyes": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime"
            ],
            "endotrachflag": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime"
            ]
        },
        "table_name": "mimiciii_clinical.gcs_first_day",
        "plan": {
            "Node Type": "Merge Join",
            "Parallel Aware": false,
            "Join Type": "Left",
            "Output": [
                "ie.subject_id",
                "ie.hadm_id",
                "ie.icustay_id",
                "gs.gcs",
                "COALESCE(gs.gcsmotor, gs.gcsmotorprev)",
                "COALESCE(gs.gcsverbal, gs.gcsverbalprev)",
                "COALESCE(gs.gcseyes, gs.gcseyesprev)",
                "gs.endotrachflag"
            ],
            "Inner Unique": false,
            "Merge Cond": "(ie.icustay_id = gs.icustay_id)",
            "Plans": [
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE base",
                    "Parallel Aware": false,
                    "Output": [
                        "l.icustay_id",
                        "l.charttime",
                        "(max(CASE WHEN (CASE WHEN (l.itemid = ANY ('{723,223900}'::integer[])) THEN 723 WHEN (l.itemid = ANY ('{454,223901}'::integer[])) THEN 454 WHEN (l.itemid = ANY ('{184,220739}'::integer[])) THEN 184 ELSE l.itemid END = 454) THEN CASE WHEN ((l.itemid = 723) AND ((l.value)::text = '1.0 ET/Trach'::text)) THEN '0'::double precision WHEN ((l.itemid = 223900) AND ((l.value)::text = 'No Response-ETT'::text)) THEN '0'::double precision ELSE l.valuenum END ELSE NULL::double precision END))",
                        "(max(CASE WHEN (CASE WHEN (l.itemid = ANY ('{723,223900}'::integer[])) THEN 723 WHEN (l.itemid = ANY ('{454,223901}'::integer[])) THEN 454 WHEN (l.itemid = ANY ('{184,220739}'::integer[])) THEN 184 ELSE l.itemid END = 723) THEN CASE WHEN ((l.itemid = 723) AND ((l.value)::text = '1.0 ET/Trach'::text)) THEN '0'::double precision WHEN ((l.itemid = 223900) AND ((l.value)::text = 'No Response-ETT'::text)) THEN '0'::double precision ELSE l.valuenum END ELSE NULL::double precision END))",
                        "(max(CASE WHEN (CASE WHEN (l.itemid = ANY ('{723,223900}'::integer[])) THEN 723 WHEN (l.itemid = ANY ('{454,223901}'::integer[])) THEN 454 WHEN (l.itemid = ANY ('{184,220739}'::integer[])) THEN 184 ELSE l.itemid END = 184) THEN CASE WHEN ((l.itemid = 723) AND ((l.value)::text = '1.0 ET/Trach'::text)) THEN '0'::double precision WHEN ((l.itemid = 223900) AND ((l.value)::text = 'No Response-ETT'::text)) THEN '0'::double precision ELSE l.valuenum END ELSE NULL::double precision END))",
                        "CASE WHEN ((max(CASE WHEN (CASE WHEN (l.itemid = ANY ('{723,223900}'::integer[])) THEN 723 WHEN (l.itemid = ANY ('{454,223901}'::integer[])) THEN 454 WHEN (l.itemid = ANY ('{184,220739}'::integer[])) THEN 184 ELSE l.itemid END = 723) THEN CASE WHEN ((l.itemid = 723) AND ((l.value)::text = '1.0 ET/Trach'::text)) THEN '0'::double precision WHEN ((l.itemid = 223900) AND ((l.value)::text = 'No Response-ETT'::text)) THEN '0'::double precision ELSE l.valuenum END ELSE NULL::double precision END)) = '0'::double precision) THEN 1 ELSE 0 END",
                        "row_number() OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Aggregate",
                            "Strategy": "Sorted",
                            "Partial Mode": "Simple",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "l.icustay_id",
                                "l.charttime",
                                "max(CASE WHEN (CASE WHEN (l.itemid = ANY ('{723,223900}'::integer[])) THEN 723 WHEN (l.itemid = ANY ('{454,223901}'::integer[])) THEN 454 WHEN (l.itemid = ANY ('{184,220739}'::integer[])) THEN 184 ELSE l.itemid END = 454) THEN CASE WHEN ((l.itemid = 723) AND ((l.value)::text = '1.0 ET/Trach'::text)) THEN '0'::double precision WHEN ((l.itemid = 223900) AND ((l.value)::text = 'No Response-ETT'::text)) THEN '0'::double precision ELSE l.valuenum END ELSE NULL::double precision END)",
                                "max(CASE WHEN (CASE WHEN (l.itemid = ANY ('{723,223900}'::integer[])) THEN 723 WHEN (l.itemid = ANY ('{454,223901}'::integer[])) THEN 454 WHEN (l.itemid = ANY ('{184,220739}'::integer[])) THEN 184 ELSE l.itemid END = 723) THEN CASE WHEN ((l.itemid = 723) AND ((l.value)::text = '1.0 ET/Trach'::text)) THEN '0'::double precision WHEN ((l.itemid = 223900) AND ((l.value)::text = 'No Response-ETT'::text)) THEN '0'::double precision ELSE l.valuenum END ELSE NULL::double precision END)",
                                "max(CASE WHEN (CASE WHEN (l.itemid = ANY ('{723,223900}'::integer[])) THEN 723 WHEN (l.itemid = ANY ('{454,223901}'::integer[])) THEN 454 WHEN (l.itemid = ANY ('{184,220739}'::integer[])) THEN 184 ELSE l.itemid END = 184) THEN CASE WHEN ((l.itemid = 723) AND ((l.value)::text = '1.0 ET/Trach'::text)) THEN '0'::double precision WHEN ((l.itemid = 223900) AND ((l.value)::text = 'No Response-ETT'::text)) THEN '0'::double precision ELSE l.valuenum END ELSE NULL::double precision END)"
                            ],
                            "Group Key": [
                                "l.icustay_id",
                                "l.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "l.icustay_id",
                                        "l.charttime",
                                        "l.itemid",
                                        "l.value",
                                        "l.valuenum"
                                    ],
                                    "Sort Key": [
                                        "l.icustay_id",
                                        "l.charttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Hash Join",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Join Type": "Inner",
                                            "Output": [
                                                "l.icustay_id",
                                                "l.charttime",
                                                "l.itemid",
                                                "l.value",
                                                "l.valuenum"
                                            ],
                                            "Inner Unique": true,
                                            "Hash Cond": "(l.icustay_id = b.icustay_id)",
                                            "Join Filter": "((l.charttime >= b.intime) AND (l.charttime <= datetime_add(b.intime, '1 day'::interval day)))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Append",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Seq Scan",
                                                            "Parent Relationship": "Member",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "chartevents_26",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "l",
                                                            "Output": [
                                                                "l.icustay_id",
                                                                "l.charttime",
                                                                "l.itemid",
                                                                "l.value",
                                                                "l.valuenum"
                                                            ],
                                                            "Filter": "(((l.error IS NULL) OR (l.error = 0)) AND (l.itemid = ANY ('{184,454,723,223900,223901,220739}'::integer[])))"
                                                        },
                                                        {
                                                            "Node Type": "Seq Scan",
                                                            "Parent Relationship": "Member",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "chartevents_41",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "l_1",
                                                            "Output": [
                                                                "l_1.icustay_id",
                                                                "l_1.charttime",
                                                                "l_1.itemid",
                                                                "l_1.value",
                                                                "l_1.valuenum"
                                                            ],
                                                            "Filter": "(((l_1.error IS NULL) OR (l_1.error = 0)) AND (l_1.itemid = ANY ('{184,454,723,223900,223901,220739}'::integer[])))"
                                                        },
                                                        {
                                                            "Node Type": "Seq Scan",
                                                            "Parent Relationship": "Member",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "chartevents_85",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "l_2",
                                                            "Output": [
                                                                "l_2.icustay_id",
                                                                "l_2.charttime",
                                                                "l_2.itemid",
                                                                "l_2.value",
                                                                "l_2.valuenum"
                                                            ],
                                                            "Filter": "(((l_2.error IS NULL) OR (l_2.error = 0)) AND (l_2.itemid = ANY ('{184,454,723,223900,223901,220739}'::integer[])))"
                                                        },
                                                        {
                                                            "Node Type": "Bitmap Heap Scan",
                                                            "Parent Relationship": "Member",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "chartevents_171",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "l_3",
                                                            "Output": [
                                                                "l_3.icustay_id",
                                                                "l_3.charttime",
                                                                "l_3.itemid",
                                                                "l_3.value",
                                                                "l_3.valuenum"
                                                            ],
                                                            "Recheck Cond": "(l_3.itemid = ANY ('{184,454,723,223900,223901,220739}'::integer[]))",
                                                            "Filter": "((l_3.error IS NULL) OR (l_3.error = 0))",
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Bitmap Index Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Index Name": "chartevents_171_idx01",
                                                                    "Index Cond": "(l_3.itemid = ANY ('{184,454,723,223900,223901,220739}'::integer[]))"
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "Node Type": "Bitmap Heap Scan",
                                                            "Parent Relationship": "Member",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "chartevents_177",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "l_4",
                                                            "Output": [
                                                                "l_4.icustay_id",
                                                                "l_4.charttime",
                                                                "l_4.itemid",
                                                                "l_4.value",
                                                                "l_4.valuenum"
                                                            ],
                                                            "Recheck Cond": "(l_4.itemid = ANY ('{184,454,723,223900,223901,220739}'::integer[]))",
                                                            "Filter": "((l_4.error IS NULL) OR (l_4.error = 0))",
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Bitmap Index Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Index Name": "chartevents_177_idx01",
                                                                    "Index Cond": "(l_4.itemid = ANY ('{184,454,723,223900,223901,220739}'::integer[]))"
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "Node Type": "Hash",
                                                    "Parent Relationship": "Inner",
                                                    "Parallel Aware": false,
                                                    "Output": [
                                                        "b.icustay_id",
                                                        "b.intime"
                                                    ],
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Seq Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "icustays",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "b",
                                                            "Output": [
                                                                "b.icustay_id",
                                                                "b.intime"
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE gcs",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "b_1.icustay_id",
                        "b_1.charttime",
                        "b_1.gcsmotor",
                        "b_1.gcsverbal",
                        "b_1.gcseyes",
                        "b_1.endotrachflag",
                        "b_1.rn",
                        "b2.gcsverbal",
                        "b2.gcsmotor",
                        "b2.gcseyes",
                        "CASE WHEN (b_1.gcsverbal = '0'::double precision) THEN '15'::double precision WHEN ((b_1.gcsverbal IS NULL) AND (b2.gcsverbal = '0'::double precision)) THEN '15'::double precision WHEN (b2.gcsverbal = '0'::double precision) THEN ((COALESCE(b_1.gcsmotor, '6'::double precision) + COALESCE(b_1.gcsverbal, '5'::double precision)) + COALESCE(b_1.gcseyes, '4'::double precision)) ELSE ((COALESCE(b_1.gcsmotor, COALESCE(b2.gcsmotor, '6'::double precision)) + COALESCE(b_1.gcsverbal, COALESCE(b2.gcsverbal, '5'::double precision))) + COALESCE(b_1.gcseyes, COALESCE(b2.gcseyes, '4'::double precision))) END"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "((b_1.icustay_id = b2.icustay_id) AND (b_1.rn = ((b2.rn + 1))))",
                    "Join Filter": "(b2.charttime > datetime_sub(b_1.charttime, '06:00:00'::interval hour))",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "b_1.icustay_id",
                                "b_1.charttime",
                                "b_1.gcsmotor",
                                "b_1.gcsverbal",
                                "b_1.gcseyes",
                                "b_1.endotrachflag",
                                "b_1.rn"
                            ],
                            "Sort Key": [
                                "b_1.icustay_id",
                                "b_1.rn"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "base",
                                    "Alias": "b_1",
                                    "Output": [
                                        "b_1.icustay_id",
                                        "b_1.charttime",
                                        "b_1.gcsmotor",
                                        "b_1.gcsverbal",
                                        "b_1.gcseyes",
                                        "b_1.endotrachflag",
                                        "b_1.rn"
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "b2.gcsverbal",
                                "b2.gcsmotor",
                                "b2.gcseyes",
                                "b2.icustay_id",
                                "b2.rn",
                                "b2.charttime",
                                "((b2.rn + 1))"
                            ],
                            "Sort Key": [
                                "b2.icustay_id",
                                "((b2.rn + 1))"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "base",
                                    "Alias": "b2",
                                    "Output": [
                                        "b2.gcsverbal",
                                        "b2.gcsmotor",
                                        "b2.gcseyes",
                                        "b2.icustay_id",
                                        "b2.rn",
                                        "b2.charttime",
                                        "(b2.rn + 1)"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE gcs_final",
                    "Parallel Aware": false,
                    "Output": [
                        "gcs.icustay_id",
                        "gcs.charttime",
                        "gcs.gcsmotor",
                        "gcs.gcsverbal",
                        "gcs.gcseyes",
                        "gcs.endotrachflag",
                        "gcs.rn",
                        "gcs.gcsverbalprev",
                        "gcs.gcsmotorprev",
                        "gcs.gcseyesprev",
                        "gcs.gcs",
                        "row_number() OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "gcs.icustay_id",
                                "gcs.gcs",
                                "gcs.charttime",
                                "gcs.gcsmotor",
                                "gcs.gcsverbal",
                                "gcs.gcseyes",
                                "gcs.endotrachflag",
                                "gcs.rn",
                                "gcs.gcsverbalprev",
                                "gcs.gcsmotorprev",
                                "gcs.gcseyesprev"
                            ],
                            "Sort Key": [
                                "gcs.icustay_id",
                                "gcs.gcs"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "gcs",
                                    "Alias": "gcs",
                                    "Output": [
                                        "gcs.icustay_id",
                                        "gcs.gcs",
                                        "gcs.charttime",
                                        "gcs.gcsmotor",
                                        "gcs.gcsverbal",
                                        "gcs.gcseyes",
                                        "gcs.endotrachflag",
                                        "gcs.rn",
                                        "gcs.gcsverbalprev",
                                        "gcs.gcsmotorprev",
                                        "gcs.gcseyesprev"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Index Scan",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Scan Direction": "Forward",
                    "Index Name": "icustays_idx02",
                    "Relation Name": "icustays",
                    "Schema": "mimiciii_clinical",
                    "Alias": "ie",
                    "Output": [
                        "ie.row_id",
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id",
                        "ie.dbsource",
                        "ie.first_careunit",
                        "ie.last_careunit",
                        "ie.first_wardid",
                        "ie.last_wardid",
                        "ie.intime",
                        "ie.outtime",
                        "ie.los"
                    ]
                },
                {
                    "Node Type": "Sort",
                    "Parent Relationship": "Inner",
                    "Parallel Aware": false,
                    "Output": [
                        "gs.gcs",
                        "gs.gcsmotor",
                        "gs.gcsmotorprev",
                        "gs.gcsverbal",
                        "gs.gcsverbalprev",
                        "gs.gcseyes",
                        "gs.gcseyesprev",
                        "gs.endotrachflag",
                        "gs.icustay_id"
                    ],
                    "Sort Key": [
                        "gs.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "gcs_final",
                            "Alias": "gs",
                            "Output": [
                                "gs.gcs",
                                "gs.gcsmotor",
                                "gs.gcsmotorprev",
                                "gs.gcsverbal",
                                "gs.gcsverbalprev",
                                "gs.gcseyes",
                                "gs.gcseyesprev",
                                "gs.endotrachflag",
                                "gs.icustay_id"
                            ],
                            "Filter": "(gs.ismingcs = 1)"
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.height_first_day": {
        "sql": "-- This query extracts heights for adult ICU patients.\n-- It uses all information from the patient's first ICU day.\n-- This is done for consistency with other queries - it's not necessarily needed.\n-- Height is unlikely to change throughout a patient's stay.\n\n-- ** Requires the echodata view, generated by concepts/echo-data.sql\n\n-- staging table to ensure all heights are in centimeters\nwith ce0 as\n(\n    SELECT\n      c.icustay_id\n      , case\n        -- convert inches to centimetres\n          when itemid in (920, 1394, 4187, 3486)\n              then valuenum * 2.54\n            else valuenum\n        end as Height\n    FROM chartevents c\n    inner join icustays ie\n        on c.icustay_id = ie.icustay_id\n        and c.charttime <= DATETIME_ADD(ie.intime, INTERVAL '1' DAY)\n        and c.charttime > DATETIME_SUB(ie.intime, INTERVAL '1' DAY) -- some fuzziness for admit time\n    WHERE c.valuenum IS NOT NULL\n    AND c.itemid in (226730,920, 1394, 4187, 3486,3485,4188) -- height\n    AND c.valuenum != 0\n    -- exclude rows marked as error\n    AND (c.error IS NULL OR c.error = 0)\n)\n, ce as\n(\n    SELECT\n        icustay_id\n        -- extract the median height from the chart to add robustness against outliers\n        , AVG(height) as Height_chart\n    from ce0\n    where height > 100\n    group by icustay_id\n)\n-- requires the echo-data.sql query to run\n-- this adds heights from the free-text echo notes\n, echo as\n(\n    select\n        ec.subject_id\n        -- all echo heights are in inches\n        , 2.54*AVG(height) as Height_Echo\n    from \"mimic\".\"mimiciii_clinical\".\"echo_data\" ec\n    inner join icustays ie\n        on ec.subject_id = ie.subject_id\n        and ec.charttime < DATETIME_ADD(ie.intime, INTERVAL '1' DAY)\n    where height is not null\n    and height*2.54 > 100\n    group by ec.subject_id\n)\nselect\n    ie.icustay_id\n    , coalesce(ce.Height_chart, ec.Height_Echo) as height\n\n    -- components\n    , ce.height_chart\n    , ec.height_echo\nFROM icustays ie\n\n-- filter to only adults\ninner join patients pat\n    on ie.subject_id = pat.subject_id\n    and ie.intime > DATETIME_ADD(pat.dob, INTERVAL '1' YEAR)\n\nleft join ce\n    on ie.icustay_id = ce.icustay_id\n\nleft join echo ec\n    on ie.subject_id = ec.subject_id",
        "tables": [
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.echo_data",
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.height",
                "mimiciii_clinical.echo_data.subject_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "height": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.height",
                "mimiciii_clinical.echo_data.subject_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "height_chart": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.height",
                "mimiciii_clinical.echo_data.subject_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "height_echo": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.height",
                "mimiciii_clinical.echo_data.subject_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.height_first_day",
        "plan": {
            "Node Type": "Hash Join",
            "Parallel Aware": false,
            "Join Type": "Left",
            "Output": [
                "ie.icustay_id",
                "COALESCE(ce.height_chart, (ec.height_echo)::double precision)",
                "ce.height_chart",
                "ec.height_echo"
            ],
            "Inner Unique": false,
            "Hash Cond": "(ie.subject_id = ec.subject_id)",
            "Plans": [
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE ce0",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "c.icustay_id",
                        "CASE WHEN (c.itemid = ANY ('{920,1394,4187,3486}'::integer[])) THEN (c.valuenum * '2.54'::double precision) ELSE c.valuenum END"
                    ],
                    "Inner Unique": true,
                    "Hash Cond": "(c.icustay_id = ie_1.icustay_id)",
                    "Join Filter": "((c.charttime <= datetime_add(ie_1.intime, '1 day'::interval day)) AND (c.charttime > datetime_sub(ie_1.intime, '1 day'::interval day)))",
                    "Plans": [
                        {
                            "Node Type": "Append",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_90",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "c",
                                    "Output": [
                                        "c.icustay_id",
                                        "c.itemid",
                                        "c.valuenum",
                                        "c.charttime"
                                    ],
                                    "Recheck Cond": "(c.itemid = ANY ('{226730,920,1394,4187,3486,3485,4188}'::integer[]))",
                                    "Filter": "((c.valuenum IS NOT NULL) AND (c.valuenum <> '0'::double precision) AND ((c.error IS NULL) OR (c.error = 0)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_90_idx01",
                                            "Index Cond": "(c.itemid = ANY ('{226730,920,1394,4187,3486,3485,4188}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_98",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "c_1",
                                    "Output": [
                                        "c_1.icustay_id",
                                        "c_1.itemid",
                                        "c_1.valuenum",
                                        "c_1.charttime"
                                    ],
                                    "Recheck Cond": "(c_1.itemid = ANY ('{226730,920,1394,4187,3486,3485,4188}'::integer[]))",
                                    "Filter": "((c_1.valuenum IS NOT NULL) AND (c_1.valuenum <> '0'::double precision) AND ((c_1.error IS NULL) OR (c_1.error = 0)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_98_idx01",
                                            "Index Cond": "(c_1.itemid = ANY ('{226730,920,1394,4187,3486,3485,4188}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_110",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "c_2",
                                    "Output": [
                                        "c_2.icustay_id",
                                        "c_2.itemid",
                                        "c_2.valuenum",
                                        "c_2.charttime"
                                    ],
                                    "Recheck Cond": "(c_2.itemid = ANY ('{226730,920,1394,4187,3486,3485,4188}'::integer[]))",
                                    "Filter": "((c_2.valuenum IS NOT NULL) AND (c_2.valuenum <> '0'::double precision) AND ((c_2.error IS NULL) OR (c_2.error = 0)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_110_idx01",
                                            "Index Cond": "(c_2.itemid = ANY ('{226730,920,1394,4187,3486,3485,4188}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_121",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "c_3",
                                    "Output": [
                                        "c_3.icustay_id",
                                        "c_3.itemid",
                                        "c_3.valuenum",
                                        "c_3.charttime"
                                    ],
                                    "Recheck Cond": "(c_3.itemid = ANY ('{226730,920,1394,4187,3486,3485,4188}'::integer[]))",
                                    "Filter": "((c_3.valuenum IS NOT NULL) AND (c_3.valuenum <> '0'::double precision) AND ((c_3.error IS NULL) OR (c_3.error = 0)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_121_idx01",
                                            "Index Cond": "(c_3.itemid = ANY ('{226730,920,1394,4187,3486,3485,4188}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_201",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "c_4",
                                    "Output": [
                                        "c_4.icustay_id",
                                        "c_4.itemid",
                                        "c_4.valuenum",
                                        "c_4.charttime"
                                    ],
                                    "Recheck Cond": "(c_4.itemid = ANY ('{226730,920,1394,4187,3486,3485,4188}'::integer[]))",
                                    "Filter": "((c_4.valuenum IS NOT NULL) AND (c_4.valuenum <> '0'::double precision) AND ((c_4.error IS NULL) OR (c_4.error = 0)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_201_idx01",
                                            "Index Cond": "(c_4.itemid = ANY ('{226730,920,1394,4187,3486,3485,4188}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "ie_1.icustay_id",
                                "ie_1.intime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "icustays",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ie_1",
                                    "Output": [
                                        "ie_1.icustay_id",
                                        "ie_1.intime"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE ce",
                    "Parallel Aware": false,
                    "Output": [
                        "ce0.icustay_id",
                        "avg(ce0.height)"
                    ],
                    "Group Key": [
                        "ce0.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "ce0",
                            "Alias": "ce0",
                            "Output": [
                                "ce0.icustay_id",
                                "ce0.height"
                            ],
                            "Filter": "(ce0.height > '100'::double precision)"
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE echo",
                    "Parallel Aware": false,
                    "Output": [
                        "ec_1.subject_id",
                        "(2.54 * avg(ec_1.height))"
                    ],
                    "Group Key": [
                        "ec_1.subject_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ec_1.subject_id",
                                "ec_1.height"
                            ],
                            "Sort Key": [
                                "ec_1.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Nested Loop",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "ec_1.subject_id",
                                        "ec_1.height"
                                    ],
                                    "Inner Unique": false,
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "echo_data",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ec_1",
                                            "Output": [
                                                "ec_1.row_id",
                                                "ec_1.subject_id",
                                                "ec_1.hadm_id",
                                                "ec_1.chartdate",
                                                "ec_1.charttime",
                                                "ec_1.indication",
                                                "ec_1.height",
                                                "ec_1.weight",
                                                "ec_1.bsa",
                                                "ec_1.bp",
                                                "ec_1.bpsys",
                                                "ec_1.bpdias",
                                                "ec_1.hr",
                                                "ec_1.status",
                                                "ec_1.test",
                                                "ec_1.doppler",
                                                "ec_1.contrast",
                                                "ec_1.technicalquality"
                                            ],
                                            "Filter": "((ec_1.height IS NOT NULL) AND ((ec_1.height * 2.54) > '100'::numeric))"
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "icustays_idx01",
                                            "Relation Name": "icustays",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ie_2",
                                            "Output": [
                                                "ie_2.row_id",
                                                "ie_2.subject_id",
                                                "ie_2.hadm_id",
                                                "ie_2.icustay_id",
                                                "ie_2.dbsource",
                                                "ie_2.first_careunit",
                                                "ie_2.last_careunit",
                                                "ie_2.first_wardid",
                                                "ie_2.last_wardid",
                                                "ie_2.intime",
                                                "ie_2.outtime",
                                                "ie_2.los"
                                            ],
                                            "Index Cond": "(ie_2.subject_id = ec_1.subject_id)",
                                            "Filter": "(ec_1.charttime < datetime_add(ie_2.intime, '1 day'::interval day))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Join Type": "Right",
                    "Output": [
                        "ie.icustay_id",
                        "ie.subject_id",
                        "ce.height_chart"
                    ],
                    "Inner Unique": false,
                    "Hash Cond": "(ce.icustay_id = ie.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "ce",
                            "Alias": "ce",
                            "Output": [
                                "ce.icustay_id",
                                "ce.height_chart"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "ie.icustay_id",
                                "ie.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "ie.icustay_id",
                                        "ie.subject_id"
                                    ],
                                    "Inner Unique": true,
                                    "Hash Cond": "(ie.subject_id = pat.subject_id)",
                                    "Join Filter": "(ie.intime > datetime_add(pat.dob, '1 year'::interval year))",
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "icustays",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ie",
                                            "Output": [
                                                "ie.row_id",
                                                "ie.subject_id",
                                                "ie.hadm_id",
                                                "ie.icustay_id",
                                                "ie.dbsource",
                                                "ie.first_careunit",
                                                "ie.last_careunit",
                                                "ie.first_wardid",
                                                "ie.last_wardid",
                                                "ie.intime",
                                                "ie.outtime",
                                                "ie.los"
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "pat.subject_id",
                                                "pat.dob"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "patients",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "pat",
                                                    "Output": [
                                                        "pat.subject_id",
                                                        "pat.dob"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Hash",
                    "Parent Relationship": "Inner",
                    "Parallel Aware": false,
                    "Output": [
                        "ec.height_echo",
                        "ec.subject_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "echo",
                            "Alias": "ec",
                            "Output": [
                                "ec.height_echo",
                                "ec.subject_id"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.labs_first_day": {
        "sql": "-- This query pivots lab values taken in the first 24 hours of a patient's stay\n\n-- Have already confirmed that the unit of measurement is always the same: null or the correct unit\n\nSELECT\n  pvt.subject_id, pvt.hadm_id, pvt.icustay_id\n\n  , min(CASE WHEN label = 'ANION GAP' THEN valuenum ELSE NULL END) AS aniongap_min\n  , max(CASE WHEN label = 'ANION GAP' THEN valuenum ELSE NULL END) AS aniongap_max\n  , min(CASE WHEN label = 'ALBUMIN' THEN valuenum ELSE NULL END) AS albumin_min\n  , max(CASE WHEN label = 'ALBUMIN' THEN valuenum ELSE NULL END) AS albumin_max\n  , min(CASE WHEN label = 'BANDS' THEN valuenum ELSE NULL END) AS bands_min\n  , max(CASE WHEN label = 'BANDS' THEN valuenum ELSE NULL END) AS bands_max\n  , min(CASE WHEN label = 'BICARBONATE' THEN valuenum ELSE NULL END) AS bicarbonate_min\n  , max(CASE WHEN label = 'BICARBONATE' THEN valuenum ELSE NULL END) AS bicarbonate_max\n  , min(CASE WHEN label = 'BILIRUBIN' THEN valuenum ELSE NULL END) AS bilirubin_min\n  , max(CASE WHEN label = 'BILIRUBIN' THEN valuenum ELSE NULL END) AS bilirubin_max\n  , min(CASE WHEN label = 'CREATININE' THEN valuenum ELSE NULL END) AS creatinine_min\n  , max(CASE WHEN label = 'CREATININE' THEN valuenum ELSE NULL END) AS creatinine_max\n  , min(CASE WHEN label = 'CHLORIDE' THEN valuenum ELSE NULL END) AS chloride_min\n  , max(CASE WHEN label = 'CHLORIDE' THEN valuenum ELSE NULL END) AS chloride_max\n  , min(CASE WHEN label = 'GLUCOSE' THEN valuenum ELSE NULL END) AS glucose_min\n  , max(CASE WHEN label = 'GLUCOSE' THEN valuenum ELSE NULL END) AS glucose_max\n  , min(CASE WHEN label = 'HEMATOCRIT' THEN valuenum ELSE NULL END) AS hematocrit_min\n  , max(CASE WHEN label = 'HEMATOCRIT' THEN valuenum ELSE NULL END) AS hematocrit_max\n  , min(CASE WHEN label = 'HEMOGLOBIN' THEN valuenum ELSE NULL END) AS hemoglobin_min\n  , max(CASE WHEN label = 'HEMOGLOBIN' THEN valuenum ELSE NULL END) AS hemoglobin_max\n  , min(CASE WHEN label = 'LACTATE' THEN valuenum ELSE NULL END) AS lactate_min\n  , max(CASE WHEN label = 'LACTATE' THEN valuenum ELSE NULL END) AS lactate_max\n  , min(CASE WHEN label = 'PLATELET' THEN valuenum ELSE NULL END) AS platelet_min\n  , max(CASE WHEN label = 'PLATELET' THEN valuenum ELSE NULL END) AS platelet_max\n  , min(CASE WHEN label = 'POTASSIUM' THEN valuenum ELSE NULL END) AS potassium_min\n  , max(CASE WHEN label = 'POTASSIUM' THEN valuenum ELSE NULL END) AS potassium_max\n  , min(CASE WHEN label = 'PTT' THEN valuenum ELSE NULL END) AS ptt_min\n  , max(CASE WHEN label = 'PTT' THEN valuenum ELSE NULL END) AS ptt_max\n  , min(CASE WHEN label = 'INR' THEN valuenum ELSE NULL END) AS inr_min\n  , max(CASE WHEN label = 'INR' THEN valuenum ELSE NULL END) AS inr_max\n  , min(CASE WHEN label = 'PT' THEN valuenum ELSE NULL END) AS pt_min\n  , max(CASE WHEN label = 'PT' THEN valuenum ELSE NULL END) AS pt_max\n  , min(CASE WHEN label = 'SODIUM' THEN valuenum ELSE NULL END) AS sodium_min\n  , max(CASE WHEN label = 'SODIUM' THEN valuenum ELSE NULL END) AS sodium_max\n  , min(CASE WHEN label = 'BUN' THEN valuenum ELSE NULL END) AS bun_min\n  , max(CASE WHEN label = 'BUN' THEN valuenum ELSE NULL END) AS bun_max\n  , min(CASE WHEN label = 'WBC' THEN valuenum ELSE NULL END) AS wbc_min\n  , max(CASE WHEN label = 'WBC' THEN valuenum ELSE NULL END) AS wbc_max\n\n\nFROM\n( -- begin query that extracts the data\n  SELECT ie.subject_id, ie.hadm_id, ie.icustay_id\n  -- here we assign labels to ITEMIDs\n  -- this also fuses together multiple ITEMIDs containing the same data\n  , CASE\n        WHEN itemid = 50868 THEN 'ANION GAP'\n        WHEN itemid = 50862 THEN 'ALBUMIN'\n        WHEN itemid = 51144 THEN 'BANDS'\n        WHEN itemid = 50882 THEN 'BICARBONATE'\n        WHEN itemid = 50885 THEN 'BILIRUBIN'\n        WHEN itemid = 50912 THEN 'CREATININE'\n        WHEN itemid = 50806 THEN 'CHLORIDE'\n        WHEN itemid = 50902 THEN 'CHLORIDE'\n        WHEN itemid = 50809 THEN 'GLUCOSE'\n        WHEN itemid = 50931 THEN 'GLUCOSE'\n        WHEN itemid = 50810 THEN 'HEMATOCRIT'\n        WHEN itemid = 51221 THEN 'HEMATOCRIT'\n        WHEN itemid = 50811 THEN 'HEMOGLOBIN'\n        WHEN itemid = 51222 THEN 'HEMOGLOBIN'\n        WHEN itemid = 50813 THEN 'LACTATE'\n        WHEN itemid = 51265 THEN 'PLATELET'\n        WHEN itemid = 50822 THEN 'POTASSIUM'\n        WHEN itemid = 50971 THEN 'POTASSIUM'\n        WHEN itemid = 51275 THEN 'PTT'\n        WHEN itemid = 51237 THEN 'INR'\n        WHEN itemid = 51274 THEN 'PT'\n        WHEN itemid = 50824 THEN 'SODIUM'\n        WHEN itemid = 50983 THEN 'SODIUM'\n        WHEN itemid = 51006 THEN 'BUN'\n        WHEN itemid = 51300 THEN 'WBC'\n        WHEN itemid = 51301 THEN 'WBC'\n      ELSE null\n    END as label\n  , -- add in some sanity checks on the values\n  -- the where clause below requires all valuenum to be > 0, so these are only upper limit checks\n    CASE\n      WHEN itemid = 50862 and valuenum >    10 THEN null -- g/dL 'ALBUMIN'\n      WHEN itemid = 50868 and valuenum > 10000 THEN null -- mEq/L 'ANION GAP'\n      WHEN itemid = 51144 and valuenum <     0 THEN null -- immature band forms, %\n      WHEN itemid = 51144 and valuenum >   100 THEN null -- immature band forms, %\n      WHEN itemid = 50882 and valuenum > 10000 THEN null -- mEq/L 'BICARBONATE'\n      WHEN itemid = 50885 and valuenum >   150 THEN null -- mg/dL 'BILIRUBIN'\n      WHEN itemid = 50806 and valuenum > 10000 THEN null -- mEq/L 'CHLORIDE'\n      WHEN itemid = 50902 and valuenum > 10000 THEN null -- mEq/L 'CHLORIDE'\n      WHEN itemid = 50912 and valuenum >   150 THEN null -- mg/dL 'CREATININE'\n      WHEN itemid = 50809 and valuenum > 10000 THEN null -- mg/dL 'GLUCOSE'\n      WHEN itemid = 50931 and valuenum > 10000 THEN null -- mg/dL 'GLUCOSE'\n      WHEN itemid = 50810 and valuenum >   100 THEN null -- % 'HEMATOCRIT'\n      WHEN itemid = 51221 and valuenum >   100 THEN null -- % 'HEMATOCRIT'\n      WHEN itemid = 50811 and valuenum >    50 THEN null -- g/dL 'HEMOGLOBIN'\n      WHEN itemid = 51222 and valuenum >    50 THEN null -- g/dL 'HEMOGLOBIN'\n      WHEN itemid = 50813 and valuenum >    50 THEN null -- mmol/L 'LACTATE'\n      WHEN itemid = 51265 and valuenum > 10000 THEN null -- K/uL 'PLATELET'\n      WHEN itemid = 50822 and valuenum >    30 THEN null -- mEq/L 'POTASSIUM'\n      WHEN itemid = 50971 and valuenum >    30 THEN null -- mEq/L 'POTASSIUM'\n      WHEN itemid = 51275 and valuenum >   150 THEN null -- sec 'PTT'\n      WHEN itemid = 51237 and valuenum >    50 THEN null -- 'INR'\n      WHEN itemid = 51274 and valuenum >   150 THEN null -- sec 'PT'\n      WHEN itemid = 50824 and valuenum >   200 THEN null -- mEq/L == mmol/L 'SODIUM'\n      WHEN itemid = 50983 and valuenum >   200 THEN null -- mEq/L == mmol/L 'SODIUM'\n      WHEN itemid = 51006 and valuenum >   300 THEN null -- 'BUN'\n      WHEN itemid = 51300 and valuenum >  1000 THEN null -- 'WBC'\n      WHEN itemid = 51301 and valuenum >  1000 THEN null -- 'WBC'\n    ELSE le.valuenum\n    END as valuenum\n\n  FROM icustays ie\n\n  LEFT JOIN labevents le\n    ON le.subject_id = ie.subject_id AND le.hadm_id = ie.hadm_id\n    AND le.charttime BETWEEN (DATETIME_SUB(ie.intime, INTERVAL '6' HOUR)) AND (DATETIME_ADD(ie.intime, INTERVAL '1' DAY))\n    AND le.ITEMID in\n    (\n      -- comment is: LABEL | CATEGORY | FLUID | NUMBER OF ROWS IN LABEVENTS\n      50868, -- ANION GAP | CHEMISTRY | BLOOD | 769895\n      50862, -- ALBUMIN | CHEMISTRY | BLOOD | 146697\n      51144, -- BANDS - hematology\n      50882, -- BICARBONATE | CHEMISTRY | BLOOD | 780733\n      50885, -- BILIRUBIN, TOTAL | CHEMISTRY | BLOOD | 238277\n      50912, -- CREATININE | CHEMISTRY | BLOOD | 797476\n      50902, -- CHLORIDE | CHEMISTRY | BLOOD | 795568\n      50806, -- CHLORIDE, WHOLE BLOOD | BLOOD GAS | BLOOD | 48187\n      50931, -- GLUCOSE | CHEMISTRY | BLOOD | 748981\n      50809, -- GLUCOSE | BLOOD GAS | BLOOD | 196734\n      51221, -- HEMATOCRIT | HEMATOLOGY | BLOOD | 881846\n      50810, -- HEMATOCRIT, CALCULATED | BLOOD GAS | BLOOD | 89715\n      51222, -- HEMOGLOBIN | HEMATOLOGY | BLOOD | 752523\n      50811, -- HEMOGLOBIN | BLOOD GAS | BLOOD | 89712\n      50813, -- LACTATE | BLOOD GAS | BLOOD | 187124\n      51265, -- PLATELET COUNT | HEMATOLOGY | BLOOD | 778444\n      50971, -- POTASSIUM | CHEMISTRY | BLOOD | 845825\n      50822, -- POTASSIUM, WHOLE BLOOD | BLOOD GAS | BLOOD | 192946\n      51275, -- PTT | HEMATOLOGY | BLOOD | 474937\n      51237, -- INR(PT) | HEMATOLOGY | BLOOD | 471183\n      51274, -- PT | HEMATOLOGY | BLOOD | 469090\n      50983, -- SODIUM | CHEMISTRY | BLOOD | 808489\n      50824, -- SODIUM, WHOLE BLOOD | BLOOD GAS | BLOOD | 71503\n      51006, -- UREA NITROGEN | CHEMISTRY | BLOOD | 791925\n      51301, -- WHITE BLOOD CELLS | HEMATOLOGY | BLOOD | 753301\n      51300  -- WBC COUNT | HEMATOLOGY | BLOOD | 2371\n    )\n    AND valuenum IS NOT null AND valuenum > 0 -- lab values cannot be 0 and cannot be negative\n) pvt\nGROUP BY pvt.subject_id, pvt.hadm_id, pvt.icustay_id\nORDER BY pvt.subject_id, pvt.hadm_id, pvt.icustay_id",
        "tables": [
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.labevents"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "hadm_id": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "icustay_id": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "aniongap_min": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "aniongap_max": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "albumin_min": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "albumin_max": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "bands_min": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "bands_max": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "bicarbonate_min": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "bicarbonate_max": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "bilirubin_min": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "bilirubin_max": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "creatinine_min": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "creatinine_max": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "chloride_min": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "chloride_max": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "glucose_min": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "glucose_max": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "hematocrit_min": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "hematocrit_max": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "hemoglobin_min": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "hemoglobin_max": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "lactate_min": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "lactate_max": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "platelet_min": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "platelet_max": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "potassium_min": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "potassium_max": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "ptt_min": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "ptt_max": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "inr_min": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "inr_max": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "pt_min": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "pt_max": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "sodium_min": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "sodium_max": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "bun_min": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "bun_max": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "wbc_min": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "wbc_max": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ]
        },
        "table_name": "mimiciii_clinical.labs_first_day",
        "plan": {
            "Node Type": "Aggregate",
            "Strategy": "Sorted",
            "Partial Mode": "Simple",
            "Parallel Aware": false,
            "Output": [
                "ie.subject_id",
                "ie.hadm_id",
                "ie.icustay_id",
                "min(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'ANION GAP'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'ANION GAP'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'ALBUMIN'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'ALBUMIN'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'BANDS'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'BANDS'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'BICARBONATE'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'BICARBONATE'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'BILIRUBIN'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'BILIRUBIN'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'CREATININE'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'CREATININE'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'CHLORIDE'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'CHLORIDE'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'GLUCOSE'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'GLUCOSE'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'HEMATOCRIT'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'HEMATOCRIT'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'HEMOGLOBIN'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'HEMOGLOBIN'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'LACTATE'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'LACTATE'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'PLATELET'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'PLATELET'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'POTASSIUM'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'POTASSIUM'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'PTT'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'PTT'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'INR'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'INR'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'PT'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'PT'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'SODIUM'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'SODIUM'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'BUN'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'BUN'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'WBC'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN (le.itemid = 50868) THEN 'ANION GAP'::text WHEN (le.itemid = 50862) THEN 'ALBUMIN'::text WHEN (le.itemid = 51144) THEN 'BANDS'::text WHEN (le.itemid = 50882) THEN 'BICARBONATE'::text WHEN (le.itemid = 50885) THEN 'BILIRUBIN'::text WHEN (le.itemid = 50912) THEN 'CREATININE'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50902) THEN 'CHLORIDE'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50931) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 51221) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 51222) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 51265) THEN 'PLATELET'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50971) THEN 'POTASSIUM'::text WHEN (le.itemid = 51275) THEN 'PTT'::text WHEN (le.itemid = 51237) THEN 'INR'::text WHEN (le.itemid = 51274) THEN 'PT'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50983) THEN 'SODIUM'::text WHEN (le.itemid = 51006) THEN 'BUN'::text WHEN (le.itemid = 51300) THEN 'WBC'::text WHEN (le.itemid = 51301) THEN 'WBC'::text ELSE NULL::text END = 'WBC'::text) THEN CASE WHEN ((le.itemid = 50862) AND (le.valuenum > '10'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50868) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum < '0'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51144) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50882) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50885) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50806) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50902) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50912) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50809) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50931) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51221) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50811) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51222) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50813) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51265) AND (le.valuenum > '10000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50822) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50971) AND (le.valuenum > '30'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51275) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51237) AND (le.valuenum > '50'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51274) AND (le.valuenum > '150'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50824) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50983) AND (le.valuenum > '200'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51006) AND (le.valuenum > '300'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51300) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 51301) AND (le.valuenum > '1000'::double precision)) THEN NULL::double precision ELSE le.valuenum END ELSE NULL::double precision END)"
            ],
            "Group Key": [
                "ie.subject_id",
                "ie.hadm_id",
                "ie.icustay_id"
            ],
            "Plans": [
                {
                    "Node Type": "Sort",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id",
                        "le.itemid",
                        "le.valuenum"
                    ],
                    "Sort Key": [
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Right",
                            "Output": [
                                "ie.subject_id",
                                "ie.hadm_id",
                                "ie.icustay_id",
                                "le.itemid",
                                "le.valuenum"
                            ],
                            "Inner Unique": false,
                            "Hash Cond": "((le.subject_id = ie.subject_id) AND (le.hadm_id = ie.hadm_id))",
                            "Join Filter": "((le.charttime >= datetime_sub(ie.intime, '06:00:00'::interval hour)) AND (le.charttime <= datetime_add(ie.intime, '1 day'::interval day)))",
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "labevents",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "le",
                                    "Output": [
                                        "le.row_id",
                                        "le.subject_id",
                                        "le.hadm_id",
                                        "le.itemid",
                                        "le.charttime",
                                        "le.value",
                                        "le.valuenum",
                                        "le.valueuom",
                                        "le.flag"
                                    ],
                                    "Recheck Cond": "(le.itemid = ANY ('{50868,50862,51144,50882,50885,50912,50902,50806,50931,50809,51221,50810,51222,50811,50813,51265,50971,50822,51275,51237,51274,50983,50824,51006,51301,51300}'::integer[]))",
                                    "Filter": "((le.valuenum IS NOT NULL) AND (le.valuenum > '0'::double precision))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "labevents_idx03",
                                            "Index Cond": "(le.itemid = ANY ('{50868,50862,51144,50882,50885,50912,50902,50806,50931,50809,51221,50810,51222,50811,50813,51265,50971,50822,51275,51237,51274,50983,50824,51006,51301,51300}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "ie.subject_id",
                                        "ie.hadm_id",
                                        "ie.icustay_id",
                                        "ie.intime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "icustays",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ie",
                                            "Output": [
                                                "ie.subject_id",
                                                "ie.hadm_id",
                                                "ie.icustay_id",
                                                "ie.intime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.rrt_first_day": {
        "sql": "-- determines if patients received any dialysis during their stay\n\n-- Some example aggregate queries which summarize the data here..\n-- This query estimates 6.7% of ICU patients received RRT.\n    -- select count(rrt.icustay_id) as numobs\n    -- , sum(rrt) as numrrt\n    -- , sum(case when rrt=1 then 1 else 0 end)*100.0 / count(rrt.icustay_id)\n    -- as percent_rrt\n    -- from rrt\n    -- inner join icustays ie on rrt.icustay_id = ie.icustay_id\n    -- inner join patients p\n    -- on rrt.subject_id = p.subject_id\n    -- and p.dob < ie.intime - interval '1' year\n    -- inner join admissions adm\n    -- on rrt.hadm_id = adm.hadm_id\n\n-- This query estimates that 4.6% of first ICU stays received RRT.\n    -- select\n    --   count(rrt.icustay_id) as numobs\n    --   , sum(rrt) as numrrt\n    --   , sum(case when rrt=1 then 1 else 0 end)*100.0 / count(rrt.icustay_id)\n    -- as percent_rrt\n    -- from\n    -- (\n    -- select ie.icustay_id, rrt.rrt\n    --   , ROW_NUMBER() over (partition by ie.subject_id order by ie.intime) rn\n    -- from rrt\n    -- inner join icustays ie\n    --   on rrt.icustay_id = ie.icustay_id\n    -- inner join patients p\n    --   on rrt.subject_id = p.subject_id\n    -- and p.dob < ie.intime - interval '1' year\n    -- inner join admissions adm\n    --   on rrt.hadm_id = adm.hadm_id\n    -- ) rrt\n    -- where rn = 1\n\nwith cv as\n(\n  select ie.icustay_id\n    , max(\n        case\n          when ce.itemid in (152,148,149,146,147,151,150) and value is not null then 1\n          when ce.itemid in (229,235,241,247,253,259,265,271) and value = 'Dialysis Line' then 1\n          when ce.itemid = 582 and value in ('CAVH Start','CAVH D/C','CVVHD Start','CVVHD D/C','Hemodialysis st','Hemodialysis end') then 1\n        else 0 end\n        ) as RRT\n  FROM icustays ie\n  inner join chartevents ce\n    on ie.icustay_id = ce.icustay_id\n    and ce.itemid in\n    (\n       152 -- \"Dialysis Type\"61449\n      ,148 -- \"Dialysis Access Site\"60335\n      ,149 -- \"Dialysis Access Type\"60030\n      ,146 -- \"Dialysate Flow ml/hr\"57445\n      ,147 -- \"Dialysate Infusing\"56605\n      ,151 -- \"Dialysis Site Appear\"37345\n      ,150 -- \"Dialysis Machine\"27472\n      ,229 -- INV Line#1 [Type]\n      ,235 -- INV Line#2 [Type]\n      ,241 -- INV Line#3 [Type]\n      ,247 -- INV Line#4 [Type]\n      ,253 -- INV Line#5 [Type]\n      ,259 -- INV Line#6 [Type]\n      ,265 -- INV Line#7 [Type]\n      ,271 -- INV Line#8 [Type]\n      ,582 -- Procedures\n    )\n    and ce.value is not null\n    and ce.charttime between ie.intime and DATETIME_ADD(ie.intime, INTERVAL '1' DAY)\n  where ie.dbsource = 'carevue'\n  group by ie.icustay_id\n)\n, mv_ce as\n(\n  select ie.icustay_id\n    , 1 as RRT\n  FROM icustays ie\n  inner join chartevents ce\n    on ie.icustay_id = ce.icustay_id\n    and ce.charttime between ie.intime and DATETIME_ADD(ie.intime, INTERVAL '1' DAY)\n    and itemid in\n    (\n      -- Checkboxes\n        226118 -- | Dialysis Catheter placed in outside facility      | Access Lines - Invasive | chartevents        | Checkbox\n      , 227357 -- | Dialysis Catheter Dressing Occlusive              | Access Lines - Invasive | chartevents        | Checkbox\n      , 225725 -- | Dialysis Catheter Tip Cultured                    | Access Lines - Invasive | chartevents        | Checkbox\n      -- Numeric values\n      , 226499 -- | Hemodialysis Output                               | Dialysis                | chartevents        | Numeric\n      , 224154 -- | Dialysate Rate                                    | Dialysis                | chartevents        | Numeric\n      , 225810 -- | Dwell Time (Peritoneal Dialysis)                  | Dialysis                | chartevents        | Numeric\n      , 227639 -- | Medication Added Amount  #2 (Peritoneal Dialysis) | Dialysis                | chartevents        | Numeric\n      , 225183 -- | Current Goal                     | Dialysis | chartevents        | Numeric\n      , 227438 -- | Volume not removed               | Dialysis | chartevents        | Numeric\n      , 224191 -- | Hourly Patient Fluid Removal     | Dialysis | chartevents        | Numeric\n      , 225806 -- | Volume In (PD)                   | Dialysis | chartevents        | Numeric\n      , 225807 -- | Volume Out (PD)                  | Dialysis | chartevents        | Numeric\n      , 228004 -- | Citrate (ACD-A)                  | Dialysis | chartevents        | Numeric\n      , 228005 -- | PBP (Prefilter) Replacement Rate | Dialysis | chartevents        | Numeric\n      , 228006 -- | Post Filter Replacement Rate     | Dialysis | chartevents        | Numeric\n      , 224144 -- | Blood Flow (ml/min)              | Dialysis | chartevents        | Numeric\n      , 224145 -- | Heparin Dose (per hour)          | Dialysis | chartevents        | Numeric\n      , 224149 -- | Access Pressure                  | Dialysis | chartevents        | Numeric\n      , 224150 -- | Filter Pressure                  | Dialysis | chartevents        | Numeric\n      , 224151 -- | Effluent Pressure                | Dialysis | chartevents        | Numeric\n      , 224152 -- | Return Pressure                  | Dialysis | chartevents        | Numeric\n      , 224153 -- | Replacement Rate                 | Dialysis | chartevents        | Numeric\n      , 224404 -- | ART Lumen Volume                 | Dialysis | chartevents        | Numeric\n      , 224406 -- | VEN Lumen Volume                 | Dialysis | chartevents        | Numeric\n      , 226457 -- | Ultrafiltrate Output             | Dialysis | chartevents        | Numeric\n    )\n    and valuenum > 0 -- also ensures it's not null\n  group by ie.icustay_id\n)\n, mv_ie as\n(\n  select ie.icustay_id\n    , 1 as RRT\n  FROM icustays ie\n  inner join inputevents_mv tt\n    on ie.icustay_id = tt.icustay_id\n    and tt.starttime between ie.intime and DATETIME_ADD(ie.intime, INTERVAL '1' DAY)\n    and itemid in\n    (\n        227536 --\tKCl (CRRT)\tMedications\tinputevents_mv\tSolution\n      , 227525 --\tCalcium Gluconate (CRRT)\tMedications\tinputevents_mv\tSolution\n    )\n    and amount > 0 -- also ensures it's not null\n  group by ie.icustay_id\n)\n, mv_de as\n(\n  select ie.icustay_id\n    , 1 as RRT\n  FROM icustays ie\n  inner join datetimeevents tt\n    on ie.icustay_id = tt.icustay_id\n    and tt.charttime between ie.intime and DATETIME_ADD(ie.intime, INTERVAL '1' DAY)\n    and itemid in\n    (\n      -- TODO: unsure how to handle \"Last dialysis\"\n      --  225128 -- | Last dialysis                                     | Adm History/FHPA        | datetimeevents     | Date time\n        225318 -- | Dialysis Catheter Cap Change                      | Access Lines - Invasive | datetimeevents     | Date time\n      , 225319 -- | Dialysis Catheter Change over Wire Date           | Access Lines - Invasive | datetimeevents     | Date time\n      , 225321 -- | Dialysis Catheter Dressing Change                 | Access Lines - Invasive | datetimeevents     | Date time\n      , 225322 -- | Dialysis Catheter Insertion Date                  | Access Lines - Invasive | datetimeevents     | Date time\n      , 225324 -- | Dialysis CatheterTubing Change                    | Access Lines - Invasive | datetimeevents     | Date time\n    )\n  group by ie.icustay_id\n)\n, mv_pe as\n(\n    select ie.icustay_id\n      , 1 as RRT\n    FROM icustays ie\n    inner join procedureevents_mv tt\n      on ie.icustay_id = tt.icustay_id\n      and tt.starttime between ie.intime and DATETIME_ADD(ie.intime, INTERVAL '1' DAY)\n      and itemid in\n      (\n          225441 -- | Hemodialysis                                      | 4-Procedures            | procedureevents_mv | Process\n        , 225802 -- | Dialysis - CRRT                                   | Dialysis                | procedureevents_mv | Process\n        , 225803 -- | Dialysis - CVVHD                                  | Dialysis                | procedureevents_mv | Process\n        , 225805 -- | Peritoneal Dialysis                               | Dialysis                | procedureevents_mv | Process\n        , 224270 -- | Dialysis Catheter                                 | Access Lines - Invasive | procedureevents_mv | Process\n        , 225809 -- | Dialysis - CVVHDF                                 | Dialysis                | procedureevents_mv | Process\n        , 225955 -- | Dialysis - SCUF                                   | Dialysis                | procedureevents_mv | Process\n        , 225436 -- | CRRT Filter Change               | Dialysis | procedureevents_mv | Process\n      )\n    group by ie.icustay_id\n)\nselect ie.subject_id, ie.hadm_id, ie.icustay_id\n  , case\n      when cv.RRT = 1 then 1\n      when mv_ce.RRT = 1 then 1\n      when mv_ie.RRT = 1 then 1\n      when mv_de.RRT = 1 then 1\n      when mv_pe.RRT = 1 then 1\n      else 0\n    end as rrt\nFROM icustays ie\nleft join cv\n  on ie.icustay_id = cv.icustay_id\nleft join mv_ce\n  on ie.icustay_id = mv_ce.icustay_id\nleft join mv_ie\n  on ie.icustay_id = mv_ie.icustay_id\nleft join mv_de\n  on ie.icustay_id = mv_de.icustay_id\nleft join mv_pe\n  on ie.icustay_id = mv_pe.icustay_id\norder by ie.icustay_id",
        "tables": [
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.datetimeevents",
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.inputevents_mv",
            "mimiciii_clinical.procedureevents_mv"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.datetimeevents.charttime",
                "mimiciii_clinical.datetimeevents.icustay_id",
                "mimiciii_clinical.datetimeevents.itemid",
                "mimiciii_clinical.icustays.dbsource",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.starttime"
            ],
            "hadm_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.datetimeevents.charttime",
                "mimiciii_clinical.datetimeevents.icustay_id",
                "mimiciii_clinical.datetimeevents.itemid",
                "mimiciii_clinical.icustays.dbsource",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.starttime"
            ],
            "icustay_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.datetimeevents.charttime",
                "mimiciii_clinical.datetimeevents.icustay_id",
                "mimiciii_clinical.datetimeevents.itemid",
                "mimiciii_clinical.icustays.dbsource",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.starttime"
            ],
            "rrt": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.datetimeevents.charttime",
                "mimiciii_clinical.datetimeevents.icustay_id",
                "mimiciii_clinical.datetimeevents.itemid",
                "mimiciii_clinical.icustays.dbsource",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.starttime"
            ]
        },
        "table_name": "mimiciii_clinical.rrt_first_day",
        "plan": {
            "Node Type": "Merge Join",
            "Parallel Aware": false,
            "Join Type": "Left",
            "Output": [
                "ie.subject_id",
                "ie.hadm_id",
                "ie.icustay_id",
                "CASE WHEN (cv.rrt = 1) THEN 1 WHEN (mv_ce.rrt = 1) THEN 1 WHEN (mv_ie.rrt = 1) THEN 1 WHEN (mv_de.rrt = 1) THEN 1 WHEN (mv_pe.rrt = 1) THEN 1 ELSE 0 END"
            ],
            "Inner Unique": false,
            "Merge Cond": "(ie.icustay_id = mv_pe.icustay_id)",
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cv",
                    "Parallel Aware": false,
                    "Output": [
                        "ie_1.icustay_id",
                        "max(CASE WHEN ((ce.itemid = ANY ('{152,148,149,146,147,151,150}'::integer[])) AND (ce.value IS NOT NULL)) THEN 1 WHEN ((ce.itemid = ANY ('{229,235,241,247,253,259,265,271}'::integer[])) AND ((ce.value)::text = 'Dialysis Line'::text)) THEN 1 WHEN ((ce.itemid = 582) AND ((ce.value)::text = ANY ('{\"CAVH Start\",\"CAVH D/C\",\"CVVHD Start\",\"CVVHD D/C\",\"Hemodialysis st\",\"Hemodialysis end\"}'::text[]))) THEN 1 ELSE 0 END)"
                    ],
                    "Group Key": [
                        "ie_1.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "ie_1.icustay_id",
                                "ce.itemid",
                                "ce.value"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "(ce.icustay_id = ie_1.icustay_id)",
                            "Join Filter": "((ce.charttime >= ie_1.intime) AND (ce.charttime <= datetime_add(ie_1.intime, '1 day'::interval day)))",
                            "Plans": [
                                {
                                    "Node Type": "Append",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_19",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce",
                                            "Output": [
                                                "ce.itemid",
                                                "ce.value",
                                                "ce.icustay_id",
                                                "ce.charttime"
                                            ],
                                            "Recheck Cond": "(ce.itemid = ANY ('{152,148,149,146,147,151,150,229,235,241,247,253,259,265,271,582}'::integer[]))",
                                            "Filter": "(ce.value IS NOT NULL)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_19_idx01",
                                                    "Index Cond": "(ce.itemid = ANY ('{152,148,149,146,147,151,150,229,235,241,247,253,259,265,271,582}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_33",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_1",
                                            "Output": [
                                                "ce_1.itemid",
                                                "ce_1.value",
                                                "ce_1.icustay_id",
                                                "ce_1.charttime"
                                            ],
                                            "Recheck Cond": "(ce_1.itemid = ANY ('{152,148,149,146,147,151,150,229,235,241,247,253,259,265,271,582}'::integer[]))",
                                            "Filter": "(ce_1.value IS NOT NULL)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_33_idx01",
                                                    "Index Cond": "(ce_1.itemid = ANY ('{152,148,149,146,147,151,150,229,235,241,247,253,259,265,271,582}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_34",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_2",
                                            "Output": [
                                                "ce_2.itemid",
                                                "ce_2.value",
                                                "ce_2.icustay_id",
                                                "ce_2.charttime"
                                            ],
                                            "Recheck Cond": "(ce_2.itemid = ANY ('{152,148,149,146,147,151,150,229,235,241,247,253,259,265,271,582}'::integer[]))",
                                            "Filter": "(ce_2.value IS NOT NULL)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_34_idx01",
                                                    "Index Cond": "(ce_2.itemid = ANY ('{152,148,149,146,147,151,150,229,235,241,247,253,259,265,271,582}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_55",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_3",
                                            "Output": [
                                                "ce_3.itemid",
                                                "ce_3.value",
                                                "ce_3.icustay_id",
                                                "ce_3.charttime"
                                            ],
                                            "Recheck Cond": "(ce_3.itemid = ANY ('{152,148,149,146,147,151,150,229,235,241,247,253,259,265,271,582}'::integer[]))",
                                            "Filter": "(ce_3.value IS NOT NULL)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_55_idx01",
                                                    "Index Cond": "(ce_3.itemid = ANY ('{152,148,149,146,147,151,150,229,235,241,247,253,259,265,271,582}'::integer[]))"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "ie_1.icustay_id",
                                        "ie_1.intime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "icustays",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ie_1",
                                            "Output": [
                                                "ie_1.icustay_id",
                                                "ie_1.intime"
                                            ],
                                            "Filter": "((ie_1.dbsource)::text = 'carevue'::text)"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE mv_ce",
                    "Parallel Aware": false,
                    "Output": [
                        "ie_2.icustay_id",
                        "1"
                    ],
                    "Group Key": [
                        "ie_2.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "ie_2.icustay_id"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "(ce_4.icustay_id = ie_2.icustay_id)",
                            "Join Filter": "((ce_4.charttime >= ie_2.intime) AND (ce_4.charttime <= datetime_add(ie_2.intime, '1 day'::interval day)))",
                            "Plans": [
                                {
                                    "Node Type": "Append",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_189",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_4",
                                            "Output": [
                                                "ce_4.icustay_id",
                                                "ce_4.charttime"
                                            ],
                                            "Recheck Cond": "(ce_4.itemid = ANY ('{226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457}'::integer[]))",
                                            "Filter": "(ce_4.valuenum > '0'::double precision)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_189_idx01",
                                                    "Index Cond": "(ce_4.itemid = ANY ('{226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_190",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_5",
                                            "Output": [
                                                "ce_5.icustay_id",
                                                "ce_5.charttime"
                                            ],
                                            "Recheck Cond": "(ce_5.itemid = ANY ('{226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457}'::integer[]))",
                                            "Filter": "(ce_5.valuenum > '0'::double precision)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_190_idx01",
                                                    "Index Cond": "(ce_5.itemid = ANY ('{226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_198",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_6",
                                            "Output": [
                                                "ce_6.icustay_id",
                                                "ce_6.charttime"
                                            ],
                                            "Recheck Cond": "(ce_6.itemid = ANY ('{226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457}'::integer[]))",
                                            "Filter": "(ce_6.valuenum > '0'::double precision)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_198_idx01",
                                                    "Index Cond": "(ce_6.itemid = ANY ('{226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_199",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_7",
                                            "Output": [
                                                "ce_7.icustay_id",
                                                "ce_7.charttime"
                                            ],
                                            "Recheck Cond": "(ce_7.itemid = ANY ('{226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457}'::integer[]))",
                                            "Filter": "(ce_7.valuenum > '0'::double precision)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_199_idx01",
                                                    "Index Cond": "(ce_7.itemid = ANY ('{226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_200",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_8",
                                            "Output": [
                                                "ce_8.icustay_id",
                                                "ce_8.charttime"
                                            ],
                                            "Recheck Cond": "(ce_8.itemid = ANY ('{226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457}'::integer[]))",
                                            "Filter": "(ce_8.valuenum > '0'::double precision)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_200_idx01",
                                                    "Index Cond": "(ce_8.itemid = ANY ('{226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_202",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_9",
                                            "Output": [
                                                "ce_9.icustay_id",
                                                "ce_9.charttime"
                                            ],
                                            "Recheck Cond": "(ce_9.itemid = ANY ('{226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457}'::integer[]))",
                                            "Filter": "(ce_9.valuenum > '0'::double precision)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_202_idx01",
                                                    "Index Cond": "(ce_9.itemid = ANY ('{226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_203",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_10",
                                            "Output": [
                                                "ce_10.icustay_id",
                                                "ce_10.charttime"
                                            ],
                                            "Recheck Cond": "(ce_10.itemid = ANY ('{226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457}'::integer[]))",
                                            "Filter": "(ce_10.valuenum > '0'::double precision)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_203_idx01",
                                                    "Index Cond": "(ce_10.itemid = ANY ('{226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_207",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_11",
                                            "Output": [
                                                "ce_11.icustay_id",
                                                "ce_11.charttime"
                                            ],
                                            "Recheck Cond": "(ce_11.itemid = ANY ('{226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457}'::integer[]))",
                                            "Filter": "(ce_11.valuenum > '0'::double precision)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_207_idx01",
                                                    "Index Cond": "(ce_11.itemid = ANY ('{226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457}'::integer[]))"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "ie_2.icustay_id",
                                        "ie_2.intime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "icustays",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ie_2",
                                            "Output": [
                                                "ie_2.icustay_id",
                                                "ie_2.intime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Group",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE mv_ie",
                    "Parallel Aware": false,
                    "Output": [
                        "ie_3.icustay_id",
                        "1"
                    ],
                    "Group Key": [
                        "ie_3.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ie_3.icustay_id"
                            ],
                            "Sort Key": [
                                "ie_3.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "ie_3.icustay_id"
                                    ],
                                    "Inner Unique": true,
                                    "Hash Cond": "(tt.icustay_id = ie_3.icustay_id)",
                                    "Join Filter": "((tt.starttime >= ie_3.intime) AND (tt.starttime <= datetime_add(ie_3.intime, '1 day'::interval day)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "inputevents_mv",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "tt",
                                            "Output": [
                                                "tt.row_id",
                                                "tt.subject_id",
                                                "tt.hadm_id",
                                                "tt.icustay_id",
                                                "tt.starttime",
                                                "tt.endtime",
                                                "tt.itemid",
                                                "tt.amount",
                                                "tt.amountuom",
                                                "tt.rate",
                                                "tt.rateuom",
                                                "tt.storetime",
                                                "tt.cgid",
                                                "tt.orderid",
                                                "tt.linkorderid",
                                                "tt.ordercategoryname",
                                                "tt.secondaryordercategoryname",
                                                "tt.ordercomponenttypedescription",
                                                "tt.ordercategorydescription",
                                                "tt.patientweight",
                                                "tt.totalamount",
                                                "tt.totalamountuom",
                                                "tt.isopenbag",
                                                "tt.continueinnextdept",
                                                "tt.cancelreason",
                                                "tt.statusdescription",
                                                "tt.comments_editedby",
                                                "tt.comments_canceledby",
                                                "tt.comments_date",
                                                "tt.originalamount",
                                                "tt.originalrate"
                                            ],
                                            "Recheck Cond": "(tt.itemid = ANY ('{227536,227525}'::integer[]))",
                                            "Filter": "(tt.amount > '0'::double precision)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "inputevents_mv_idx05",
                                                    "Index Cond": "(tt.itemid = ANY ('{227536,227525}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ie_3.icustay_id",
                                                "ie_3.intime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "icustays",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ie_3",
                                                    "Output": [
                                                        "ie_3.icustay_id",
                                                        "ie_3.intime"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Group",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE mv_de",
                    "Parallel Aware": false,
                    "Output": [
                        "ie_4.icustay_id",
                        "1"
                    ],
                    "Group Key": [
                        "ie_4.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ie_4.icustay_id"
                            ],
                            "Sort Key": [
                                "ie_4.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "ie_4.icustay_id"
                                    ],
                                    "Inner Unique": true,
                                    "Hash Cond": "(tt_1.icustay_id = ie_4.icustay_id)",
                                    "Join Filter": "((tt_1.charttime >= ie_4.intime) AND (tt_1.charttime <= datetime_add(ie_4.intime, '1 day'::interval day)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "datetimeevents_idx02",
                                            "Relation Name": "datetimeevents",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "tt_1",
                                            "Output": [
                                                "tt_1.row_id",
                                                "tt_1.subject_id",
                                                "tt_1.hadm_id",
                                                "tt_1.icustay_id",
                                                "tt_1.itemid",
                                                "tt_1.charttime",
                                                "tt_1.storetime",
                                                "tt_1.cgid",
                                                "tt_1.value",
                                                "tt_1.valueuom",
                                                "tt_1.warning",
                                                "tt_1.error",
                                                "tt_1.resultstatus",
                                                "tt_1.stopped"
                                            ],
                                            "Index Cond": "(tt_1.itemid = ANY ('{225318,225319,225321,225322,225324}'::integer[]))"
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ie_4.icustay_id",
                                                "ie_4.intime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "icustays",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ie_4",
                                                    "Output": [
                                                        "ie_4.icustay_id",
                                                        "ie_4.intime"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Group",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE mv_pe",
                    "Parallel Aware": false,
                    "Output": [
                        "ie_5.icustay_id",
                        "1"
                    ],
                    "Group Key": [
                        "ie_5.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ie_5.icustay_id"
                            ],
                            "Sort Key": [
                                "ie_5.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "ie_5.icustay_id"
                                    ],
                                    "Inner Unique": true,
                                    "Hash Cond": "(tt_2.icustay_id = ie_5.icustay_id)",
                                    "Join Filter": "((tt_2.starttime >= ie_5.intime) AND (tt_2.starttime <= datetime_add(ie_5.intime, '1 day'::interval day)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "procedureevents_mv",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "tt_2",
                                            "Output": [
                                                "tt_2.row_id",
                                                "tt_2.subject_id",
                                                "tt_2.hadm_id",
                                                "tt_2.icustay_id",
                                                "tt_2.starttime",
                                                "tt_2.endtime",
                                                "tt_2.itemid",
                                                "tt_2.value",
                                                "tt_2.valueuom",
                                                "tt_2.location",
                                                "tt_2.locationcategory",
                                                "tt_2.storetime",
                                                "tt_2.cgid",
                                                "tt_2.orderid",
                                                "tt_2.linkorderid",
                                                "tt_2.ordercategoryname",
                                                "tt_2.secondaryordercategoryname",
                                                "tt_2.ordercategorydescription",
                                                "tt_2.isopenbag",
                                                "tt_2.continueinnextdept",
                                                "tt_2.cancelreason",
                                                "tt_2.statusdescription",
                                                "tt_2.comments_editedby",
                                                "tt_2.comments_canceledby",
                                                "tt_2.comments_date"
                                            ],
                                            "Recheck Cond": "(tt_2.itemid = ANY ('{225441,225802,225803,225805,224270,225809,225955,225436}'::integer[]))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "procedureevents_mv_idx05",
                                                    "Index Cond": "(tt_2.itemid = ANY ('{225441,225802,225803,225805,224270,225809,225955,225436}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ie_5.icustay_id",
                                                "ie_5.intime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "icustays",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ie_5",
                                                    "Output": [
                                                        "ie_5.icustay_id",
                                                        "ie_5.intime"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id",
                        "cv.rrt",
                        "mv_ce.rrt",
                        "mv_ie.rrt",
                        "mv_de.rrt"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "(ie.icustay_id = mv_de.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "Merge Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Left",
                            "Output": [
                                "ie.subject_id",
                                "ie.hadm_id",
                                "ie.icustay_id",
                                "cv.rrt",
                                "mv_ce.rrt",
                                "mv_ie.rrt"
                            ],
                            "Inner Unique": false,
                            "Merge Cond": "(ie.icustay_id = mv_ie.icustay_id)",
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "ie.subject_id",
                                        "ie.hadm_id",
                                        "ie.icustay_id",
                                        "cv.rrt",
                                        "mv_ce.rrt"
                                    ],
                                    "Sort Key": [
                                        "ie.icustay_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Hash Join",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Join Type": "Right",
                                            "Output": [
                                                "ie.subject_id",
                                                "ie.hadm_id",
                                                "ie.icustay_id",
                                                "cv.rrt",
                                                "mv_ce.rrt"
                                            ],
                                            "Inner Unique": false,
                                            "Hash Cond": "(cv.icustay_id = ie.icustay_id)",
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "cv",
                                                    "Alias": "cv",
                                                    "Output": [
                                                        "cv.icustay_id",
                                                        "cv.rrt"
                                                    ]
                                                },
                                                {
                                                    "Node Type": "Hash",
                                                    "Parent Relationship": "Inner",
                                                    "Parallel Aware": false,
                                                    "Output": [
                                                        "ie.subject_id",
                                                        "ie.hadm_id",
                                                        "ie.icustay_id",
                                                        "mv_ce.rrt"
                                                    ],
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Hash Join",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Join Type": "Right",
                                                            "Output": [
                                                                "ie.subject_id",
                                                                "ie.hadm_id",
                                                                "ie.icustay_id",
                                                                "mv_ce.rrt"
                                                            ],
                                                            "Inner Unique": true,
                                                            "Hash Cond": "(mv_ce.icustay_id = ie.icustay_id)",
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "CTE Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "CTE Name": "mv_ce",
                                                                    "Alias": "mv_ce",
                                                                    "Output": [
                                                                        "mv_ce.icustay_id",
                                                                        "mv_ce.rrt"
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Hash",
                                                                    "Parent Relationship": "Inner",
                                                                    "Parallel Aware": false,
                                                                    "Output": [
                                                                        "ie.subject_id",
                                                                        "ie.hadm_id",
                                                                        "ie.icustay_id"
                                                                    ],
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Seq Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Relation Name": "icustays",
                                                                            "Schema": "mimiciii_clinical",
                                                                            "Alias": "ie",
                                                                            "Output": [
                                                                                "ie.subject_id",
                                                                                "ie.hadm_id",
                                                                                "ie.icustay_id"
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "mv_ie.rrt",
                                        "mv_ie.icustay_id"
                                    ],
                                    "Sort Key": [
                                        "mv_ie.icustay_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "mv_ie",
                                            "Alias": "mv_ie",
                                            "Output": [
                                                "mv_ie.rrt",
                                                "mv_ie.icustay_id"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "mv_de.rrt",
                                "mv_de.icustay_id"
                            ],
                            "Sort Key": [
                                "mv_de.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "mv_de",
                                    "Alias": "mv_de",
                                    "Output": [
                                        "mv_de.rrt",
                                        "mv_de.icustay_id"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Sort",
                    "Parent Relationship": "Inner",
                    "Parallel Aware": false,
                    "Output": [
                        "mv_pe.rrt",
                        "mv_pe.icustay_id"
                    ],
                    "Sort Key": [
                        "mv_pe.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "mv_pe",
                            "Alias": "mv_pe",
                            "Output": [
                                "mv_pe.rrt",
                                "mv_pe.icustay_id"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.urine_output_first_day": {
        "sql": "-- ------------------------------------------------------------------\n-- Purpose: Create a view of the urine output for each ICUSTAY_ID over the first 24 hours.\n-- ------------------------------------------------------------------\n\nselect\n  -- patient identifiers\n  ie.subject_id, ie.hadm_id, ie.icustay_id\n\n  -- volumes associated with urine output ITEMIDs\n  , sum(\n      -- we consider input of GU irrigant as a negative volume\n      case\n        when oe.itemid = 227488 and oe.value > 0 then -1*oe.value\n        else oe.value\n    end) as urineoutput\nFROM icustays ie\n-- Join to the outputevents table to get urine output\nleft join outputevents oe\n-- join on all patient identifiers\non ie.subject_id = oe.subject_id and ie.hadm_id = oe.hadm_id and ie.icustay_id = oe.icustay_id\n-- and ensure the data occurs during the first day\nand oe.charttime between ie.intime and (DATETIME_ADD(ie.intime, INTERVAL '1' DAY)) -- first ICU day\nwhere itemid in\n(\n-- these are the most frequently occurring urine output observations in CareVue\n40055, -- \"Urine Out Foley\"\n43175, -- \"Urine .\"\n40069, -- \"Urine Out Void\"\n40094, -- \"Urine Out Condom Cath\"\n40715, -- \"Urine Out Suprapubic\"\n40473, -- \"Urine Out IleoConduit\"\n40085, -- \"Urine Out Incontinent\"\n40057, -- \"Urine Out Rt Nephrostomy\"\n40056, -- \"Urine Out Lt Nephrostomy\"\n40405, -- \"Urine Out Other\"\n40428, -- \"Urine Out Straight Cath\"\n40086,--\tUrine Out Incontinent\n40096, -- \"Urine Out Ureteral Stent #1\"\n40651, -- \"Urine Out Ureteral Stent #2\"\n\n-- these are the most frequently occurring urine output observations in MetaVision\n226559, -- \"Foley\"\n226560, -- \"Void\"\n226561, -- \"Condom Cath\"\n226584, -- \"Ileoconduit\"\n226563, -- \"Suprapubic\"\n226564, -- \"R Nephrostomy\"\n226565, -- \"L Nephrostomy\"\n226567, --\tStraight Cath\n226557, -- R Ureteral Stent\n226558, -- L Ureteral Stent\n227488, -- GU Irrigant Volume In\n227489  -- GU Irrigant/Urine Volume Out\n)\ngroup by ie.subject_id, ie.hadm_id, ie.icustay_id\norder by ie.subject_id, ie.hadm_id, ie.icustay_id",
        "tables": [
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.outputevents"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.outputevents.charttime",
                "mimiciii_clinical.outputevents.hadm_id",
                "mimiciii_clinical.outputevents.icustay_id",
                "mimiciii_clinical.outputevents.itemid",
                "mimiciii_clinical.outputevents.subject_id"
            ],
            "hadm_id": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.outputevents.charttime",
                "mimiciii_clinical.outputevents.hadm_id",
                "mimiciii_clinical.outputevents.icustay_id",
                "mimiciii_clinical.outputevents.itemid",
                "mimiciii_clinical.outputevents.subject_id"
            ],
            "icustay_id": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.outputevents.charttime",
                "mimiciii_clinical.outputevents.hadm_id",
                "mimiciii_clinical.outputevents.icustay_id",
                "mimiciii_clinical.outputevents.itemid",
                "mimiciii_clinical.outputevents.subject_id"
            ],
            "urineoutput": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.outputevents.charttime",
                "mimiciii_clinical.outputevents.hadm_id",
                "mimiciii_clinical.outputevents.icustay_id",
                "mimiciii_clinical.outputevents.itemid",
                "mimiciii_clinical.outputevents.subject_id",
                "mimiciii_clinical.outputevents.value"
            ]
        },
        "table_name": "mimiciii_clinical.urine_output_first_day",
        "plan": {
            "Node Type": "Aggregate",
            "Strategy": "Sorted",
            "Partial Mode": "Simple",
            "Parallel Aware": false,
            "Output": [
                "ie.subject_id",
                "ie.hadm_id",
                "ie.icustay_id",
                "sum(CASE WHEN ((oe.itemid = 227488) AND (oe.value > '0'::double precision)) THEN ('-1'::double precision * oe.value) ELSE oe.value END)"
            ],
            "Group Key": [
                "ie.subject_id",
                "ie.hadm_id",
                "ie.icustay_id"
            ],
            "Plans": [
                {
                    "Node Type": "Sort",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id",
                        "oe.itemid",
                        "oe.value"
                    ],
                    "Sort Key": [
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "ie.subject_id",
                                "ie.hadm_id",
                                "ie.icustay_id",
                                "oe.itemid",
                                "oe.value"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "((oe.subject_id = ie.subject_id) AND (oe.hadm_id = ie.hadm_id) AND (oe.icustay_id = ie.icustay_id))",
                            "Join Filter": "((oe.charttime >= ie.intime) AND (oe.charttime <= datetime_add(ie.intime, '1 day'::interval day)))",
                            "Plans": [
                                {
                                    "Node Type": "Index Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Scan Direction": "Forward",
                                    "Index Name": "outputevents_idx02",
                                    "Relation Name": "outputevents",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "oe",
                                    "Output": [
                                        "oe.row_id",
                                        "oe.subject_id",
                                        "oe.hadm_id",
                                        "oe.icustay_id",
                                        "oe.charttime",
                                        "oe.itemid",
                                        "oe.value",
                                        "oe.valueuom",
                                        "oe.storetime",
                                        "oe.cgid",
                                        "oe.stopped",
                                        "oe.newbottle",
                                        "oe.iserror"
                                    ],
                                    "Index Cond": "(oe.itemid = ANY ('{40055,43175,40069,40094,40715,40473,40085,40057,40056,40405,40428,40086,40096,40651,226559,226560,226561,226584,226563,226564,226565,226567,226557,226558,227488,227489}'::integer[]))"
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "ie.subject_id",
                                        "ie.hadm_id",
                                        "ie.icustay_id",
                                        "ie.intime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "icustays",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ie",
                                            "Output": [
                                                "ie.subject_id",
                                                "ie.hadm_id",
                                                "ie.icustay_id",
                                                "ie.intime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.ventilation_first_day": {
        "sql": "-- Determines if a patient is ventilated on the first day of their ICU stay.\n-- Creates a table with the result.\n-- Requires the ventilation_durations table, generated by ../ventilation-durations.sql\n\nselect\n  ie.subject_id, ie.hadm_id, ie.icustay_id\n  -- if vd.icustay_id is not null, then they have a valid ventilation event\n  -- in this case, we say they are ventilated\n  -- otherwise, they are not\n  , max(case\n      when vd.icustay_id is not null then 1\n    else 0 end) as vent\nFROM icustays ie\nleft join \"mimic\".\"mimiciii_clinical\".\"ventilation_durations\" vd\n  on ie.icustay_id = vd.icustay_id\n  and\n  (\n    -- ventilation duration overlaps with ICU admission -> vented on admission\n    (vd.starttime <= ie.intime and vd.endtime >= ie.intime)\n    -- ventilation started during the first day\n    OR (vd.starttime >= ie.intime and vd.starttime <= DATETIME_ADD(ie.intime, INTERVAL '1' DAY))\n  )\ngroup by ie.subject_id, ie.hadm_id, ie.icustay_id\norder by ie.subject_id, ie.hadm_id, ie.icustay_id",
        "tables": [
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.ventilation_durations"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime"
            ],
            "hadm_id": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime"
            ],
            "icustay_id": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime"
            ],
            "vent": [
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime"
            ]
        },
        "table_name": "mimiciii_clinical.ventilation_first_day",
        "plan": {
            "Node Type": "Aggregate",
            "Strategy": "Sorted",
            "Partial Mode": "Simple",
            "Parallel Aware": false,
            "Output": [
                "ie.subject_id",
                "ie.hadm_id",
                "ie.icustay_id",
                "max(CASE WHEN (vd.icustay_id IS NOT NULL) THEN 1 ELSE 0 END)"
            ],
            "Group Key": [
                "ie.subject_id",
                "ie.hadm_id",
                "ie.icustay_id"
            ],
            "Plans": [
                {
                    "Node Type": "Sort",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id",
                        "vd.icustay_id"
                    ],
                    "Sort Key": [
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Right",
                            "Output": [
                                "ie.subject_id",
                                "ie.hadm_id",
                                "ie.icustay_id",
                                "vd.icustay_id"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "(vd.icustay_id = ie.icustay_id)",
                            "Join Filter": "(((vd.starttime <= ie.intime) AND (vd.endtime >= ie.intime)) OR ((vd.starttime >= ie.intime) AND (vd.starttime <= datetime_add(ie.intime, '1 day'::interval day))))",
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "ventilation_durations",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "vd",
                                    "Output": [
                                        "vd.icustay_id",
                                        "vd.ventnum",
                                        "vd.starttime",
                                        "vd.endtime",
                                        "vd.duration_hours"
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "ie.subject_id",
                                        "ie.hadm_id",
                                        "ie.icustay_id",
                                        "ie.intime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "icustays",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ie",
                                            "Output": [
                                                "ie.subject_id",
                                                "ie.hadm_id",
                                                "ie.icustay_id",
                                                "ie.intime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.weight_first_day": {
        "sql": "-- This query extracts weights for adult ICU patients on their first ICU day.\n-- It does *not* use any information after the first ICU day, as weight is\n-- sometimes used to monitor fluid balance.\n\n-- ** Requires the echodata view, generated by concepts/echo-data.sql\n\nwith ce as\n(\n    SELECT\n      c.icustay_id\n      -- we take the avg value from roughly first day\n      -- TODO: eliminate obvious outliers if there is a reasonable weight\n      -- (e.g. weight of 180kg and 90kg would remove 180kg instead of taking the median)\n      , AVG(VALUENUM) as Weight_Admit\n    FROM chartevents c\n    inner join icustays ie\n        on c.icustay_id = ie.icustay_id\n        and c.charttime <= DATETIME_ADD(ie.intime, INTERVAL '1' DAY)\n        and c.charttime > DATETIME_SUB(ie.intime, INTERVAL '1' DAY) -- some fuzziness for admit time\n    WHERE c.valuenum IS NOT NULL\n    AND c.itemid in (762,226512) -- Admit Wt\n    AND c.valuenum != 0\n    -- exclude rows marked as error\n    AND (c.error IS NULL OR c.error = 0)\n    group by c.icustay_id\n)\n, dwt as\n(\n    SELECT\n      c.icustay_id\n      , AVG(VALUENUM) as Weight_Daily\n    FROM chartevents c\n    INNER JOIN icustays ie\n        on c.icustay_id = ie.icustay_id\n        and c.charttime <= DATETIME_ADD(ie.intime, INTERVAL '1' DAY)\n        and c.charttime > DATETIME_SUB(ie.intime, INTERVAL '1' DAY) -- some fuzziness for admit time\n    WHERE c.valuenum IS NOT NULL\n    AND c.itemid in (763,224639) -- Daily Weight\n    AND c.valuenum != 0\n    -- exclude rows marked as error\n    AND (c.error IS NULL OR c.error = 0)\n    group by c.icustay_id\n)\n-- we split in-hospital/out of hospital echoes as we would like to prioritize in-hospital data\n, echo_hadm as\n(\n    select\n        ie.icustay_id\n        , 0.453592*AVG(weight) as Weight_EchoInHosp\n    from \"mimic\".\"mimiciii_clinical\".\"echo_data\" ec\n    inner join icustays ie\n        on ec.hadm_id = ie.hadm_id\n        and ec.charttime < DATETIME_ADD(ie.intime, INTERVAL '1' DAY)\n    where\n            ec.HADM_ID is not null\n        and ec.weight is not null\n    group by ie.icustay_id\n)\n, echo_nohadm as\n(\n    select\n        ie.icustay_id\n        , 0.453592*AVG(weight) as Weight_EchoPreHosp\n    from \"mimic\".\"mimiciii_clinical\".\"echo_data\" ec\n    inner join icustays ie\n        on ie.subject_id = ec.subject_id\n        and ie.intime < DATETIME_ADD(ec.charttime, INTERVAL '1' MONTH)\n        and ie.intime > ec.charttime\n    where\n            ec.HADM_ID is null\n        and ec.weight is not null\n    group by ie.icustay_id\n)\nselect\n    ie.icustay_id\n    , round(cast(\n    case\n        when ce.icustay_id is not null\n            then ce.Weight_Admit\n        when dwt.icustay_id is not null\n            then dwt.Weight_Daily\n        when eh.icustay_id is not null\n            then eh.Weight_EchoInHosp\n        when enh.icustay_id is not null\n            then enh.Weight_EchoPreHosp\n        else null end\n        as numeric), 2)\n    as weight\n\n    -- components\n    , ce.weight_admit\n    , dwt.weight_daily\n    , eh.weight_echoinhosp\n    , enh.weight_echoprehosp\n\nFROM icustays ie\n\n-- filter to only adults\ninner join patients pat\n    on ie.subject_id = pat.subject_id\n    and ie.intime > DATETIME_ADD(pat.dob, INTERVAL '1' YEAR)\n\n-- admission weight\nleft join ce\n    on ie.icustay_id = ce.icustay_id\n\n-- daily weights\nleft join dwt\n    on ie.icustay_id = dwt.icustay_id\n\n-- in-hospital echo weight\nleft join echo_hadm eh\n    on ie.icustay_id = eh.icustay_id\n\n-- pre-hospitalization echo weights\nleft join echo_nohadm enh\n    on ie.icustay_id = enh.icustay_id\norder by ie.icustay_id",
        "tables": [
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.echo_data",
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.hadm_id",
                "mimiciii_clinical.echo_data.subject_id",
                "mimiciii_clinical.echo_data.weight",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "weight": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.hadm_id",
                "mimiciii_clinical.echo_data.subject_id",
                "mimiciii_clinical.echo_data.weight",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "weight_admit": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.hadm_id",
                "mimiciii_clinical.echo_data.subject_id",
                "mimiciii_clinical.echo_data.weight",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "weight_daily": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.hadm_id",
                "mimiciii_clinical.echo_data.subject_id",
                "mimiciii_clinical.echo_data.weight",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "weight_echoinhosp": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.hadm_id",
                "mimiciii_clinical.echo_data.subject_id",
                "mimiciii_clinical.echo_data.weight",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ],
            "weight_echoprehosp": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.hadm_id",
                "mimiciii_clinical.echo_data.subject_id",
                "mimiciii_clinical.echo_data.weight",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.weight_first_day",
        "plan": {
            "Node Type": "Merge Join",
            "Parallel Aware": false,
            "Join Type": "Left",
            "Output": [
                "ie.icustay_id",
                "round((CASE WHEN (ce.icustay_id IS NOT NULL) THEN ce.weight_admit WHEN (dwt.icustay_id IS NOT NULL) THEN dwt.weight_daily WHEN (eh.icustay_id IS NOT NULL) THEN (eh.weight_echoinhosp)::double precision WHEN (enh.icustay_id IS NOT NULL) THEN (enh.weight_echoprehosp)::double precision ELSE NULL::double precision END)::numeric, 2)",
                "ce.weight_admit",
                "dwt.weight_daily",
                "eh.weight_echoinhosp",
                "enh.weight_echoprehosp"
            ],
            "Inner Unique": false,
            "Merge Cond": "(ie.icustay_id = enh.icustay_id)",
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE ce",
                    "Parallel Aware": false,
                    "Output": [
                        "c.icustay_id",
                        "avg(c.valuenum)"
                    ],
                    "Group Key": [
                        "c.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "c.icustay_id",
                                "c.valuenum"
                            ],
                            "Sort Key": [
                                "c.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "c.icustay_id",
                                        "c.valuenum"
                                    ],
                                    "Inner Unique": true,
                                    "Hash Cond": "(c.icustay_id = ie_1.icustay_id)",
                                    "Join Filter": "((c.charttime <= datetime_add(ie_1.intime, '1 day'::interval day)) AND (c.charttime > datetime_sub(ie_1.intime, '1 day'::interval day)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Append",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Heap Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_88",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "c",
                                                    "Output": [
                                                        "c.icustay_id",
                                                        "c.valuenum",
                                                        "c.charttime"
                                                    ],
                                                    "Recheck Cond": "(c.itemid = ANY ('{762,226512}'::integer[]))",
                                                    "Filter": "((c.valuenum IS NOT NULL) AND (c.valuenum <> '0'::double precision) AND ((c.error IS NULL) OR (c.error = 0)))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Bitmap Index Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Index Name": "chartevents_88_idx01",
                                                            "Index Cond": "(c.itemid = ANY ('{762,226512}'::integer[]))"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "Node Type": "Bitmap Heap Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_201",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "c_1",
                                                    "Output": [
                                                        "c_1.icustay_id",
                                                        "c_1.valuenum",
                                                        "c_1.charttime"
                                                    ],
                                                    "Recheck Cond": "(c_1.itemid = ANY ('{762,226512}'::integer[]))",
                                                    "Filter": "((c_1.valuenum IS NOT NULL) AND (c_1.valuenum <> '0'::double precision) AND ((c_1.error IS NULL) OR (c_1.error = 0)))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Bitmap Index Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Index Name": "chartevents_201_idx01",
                                                            "Index Cond": "(c_1.itemid = ANY ('{762,226512}'::integer[]))"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ie_1.icustay_id",
                                                "ie_1.intime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "icustays",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ie_1",
                                                    "Output": [
                                                        "ie_1.icustay_id",
                                                        "ie_1.intime"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE dwt",
                    "Parallel Aware": false,
                    "Output": [
                        "c_2.icustay_id",
                        "avg(c_2.valuenum)"
                    ],
                    "Group Key": [
                        "c_2.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "c_2.icustay_id",
                                "c_2.valuenum"
                            ],
                            "Sort Key": [
                                "c_2.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "c_2.icustay_id",
                                        "c_2.valuenum"
                                    ],
                                    "Inner Unique": true,
                                    "Hash Cond": "(c_2.icustay_id = ie_2.icustay_id)",
                                    "Join Filter": "((c_2.charttime <= datetime_add(ie_2.intime, '1 day'::interval day)) AND (c_2.charttime > datetime_sub(ie_2.intime, '1 day'::interval day)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Append",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Heap Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_88",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "c_2",
                                                    "Output": [
                                                        "c_2.icustay_id",
                                                        "c_2.valuenum",
                                                        "c_2.charttime"
                                                    ],
                                                    "Recheck Cond": "(c_2.itemid = ANY ('{763,224639}'::integer[]))",
                                                    "Filter": "((c_2.valuenum IS NOT NULL) AND (c_2.valuenum <> '0'::double precision) AND ((c_2.error IS NULL) OR (c_2.error = 0)))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Bitmap Index Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Index Name": "chartevents_88_idx01",
                                                            "Index Cond": "(c_2.itemid = ANY ('{763,224639}'::integer[]))"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "Node Type": "Bitmap Heap Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_190",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "c_3",
                                                    "Output": [
                                                        "c_3.icustay_id",
                                                        "c_3.valuenum",
                                                        "c_3.charttime"
                                                    ],
                                                    "Recheck Cond": "(c_3.itemid = ANY ('{763,224639}'::integer[]))",
                                                    "Filter": "((c_3.valuenum IS NOT NULL) AND (c_3.valuenum <> '0'::double precision) AND ((c_3.error IS NULL) OR (c_3.error = 0)))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Bitmap Index Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Index Name": "chartevents_190_idx01",
                                                            "Index Cond": "(c_3.itemid = ANY ('{763,224639}'::integer[]))"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ie_2.icustay_id",
                                                "ie_2.intime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "icustays",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ie_2",
                                                    "Output": [
                                                        "ie_2.icustay_id",
                                                        "ie_2.intime"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE echo_hadm",
                    "Parallel Aware": false,
                    "Output": [
                        "ie_3.icustay_id",
                        "(0.453592 * avg(ec.weight))"
                    ],
                    "Group Key": [
                        "ie_3.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ie_3.icustay_id",
                                "ec.weight"
                            ],
                            "Sort Key": [
                                "ie_3.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Nested Loop",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "ie_3.icustay_id",
                                        "ec.weight"
                                    ],
                                    "Inner Unique": false,
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "echo_data",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ec",
                                            "Output": [
                                                "ec.row_id",
                                                "ec.subject_id",
                                                "ec.hadm_id",
                                                "ec.chartdate",
                                                "ec.charttime",
                                                "ec.indication",
                                                "ec.height",
                                                "ec.weight",
                                                "ec.bsa",
                                                "ec.bp",
                                                "ec.bpsys",
                                                "ec.bpdias",
                                                "ec.hr",
                                                "ec.status",
                                                "ec.test",
                                                "ec.doppler",
                                                "ec.contrast",
                                                "ec.technicalquality"
                                            ],
                                            "Filter": "((ec.hadm_id IS NOT NULL) AND (ec.weight IS NOT NULL))"
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "icustays_idx06",
                                            "Relation Name": "icustays",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ie_3",
                                            "Output": [
                                                "ie_3.row_id",
                                                "ie_3.subject_id",
                                                "ie_3.hadm_id",
                                                "ie_3.icustay_id",
                                                "ie_3.dbsource",
                                                "ie_3.first_careunit",
                                                "ie_3.last_careunit",
                                                "ie_3.first_wardid",
                                                "ie_3.last_wardid",
                                                "ie_3.intime",
                                                "ie_3.outtime",
                                                "ie_3.los"
                                            ],
                                            "Index Cond": "(ie_3.hadm_id = ec.hadm_id)",
                                            "Filter": "(ec.charttime < datetime_add(ie_3.intime, '1 day'::interval day))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE echo_nohadm",
                    "Parallel Aware": false,
                    "Output": [
                        "ie_4.icustay_id",
                        "(0.453592 * avg(ec_1.weight))"
                    ],
                    "Group Key": [
                        "ie_4.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ie_4.icustay_id",
                                "ec_1.weight"
                            ],
                            "Sort Key": [
                                "ie_4.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Nested Loop",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "ie_4.icustay_id",
                                        "ec_1.weight"
                                    ],
                                    "Inner Unique": false,
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "echo_data",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ec_1",
                                            "Output": [
                                                "ec_1.row_id",
                                                "ec_1.subject_id",
                                                "ec_1.hadm_id",
                                                "ec_1.chartdate",
                                                "ec_1.charttime",
                                                "ec_1.indication",
                                                "ec_1.height",
                                                "ec_1.weight",
                                                "ec_1.bsa",
                                                "ec_1.bp",
                                                "ec_1.bpsys",
                                                "ec_1.bpdias",
                                                "ec_1.hr",
                                                "ec_1.status",
                                                "ec_1.test",
                                                "ec_1.doppler",
                                                "ec_1.contrast",
                                                "ec_1.technicalquality"
                                            ],
                                            "Filter": "((ec_1.hadm_id IS NULL) AND (ec_1.weight IS NOT NULL))"
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "icustays_idx01",
                                            "Relation Name": "icustays",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ie_4",
                                            "Output": [
                                                "ie_4.row_id",
                                                "ie_4.subject_id",
                                                "ie_4.hadm_id",
                                                "ie_4.icustay_id",
                                                "ie_4.dbsource",
                                                "ie_4.first_careunit",
                                                "ie_4.last_careunit",
                                                "ie_4.first_wardid",
                                                "ie_4.last_wardid",
                                                "ie_4.intime",
                                                "ie_4.outtime",
                                                "ie_4.los"
                                            ],
                                            "Index Cond": "(ie_4.subject_id = ec_1.subject_id)",
                                            "Filter": "((ie_4.intime > ec_1.charttime) AND (ie_4.intime < datetime_add(ec_1.charttime, '1 mon'::interval month)))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "ie.icustay_id",
                        "ce.icustay_id",
                        "ce.weight_admit",
                        "dwt.icustay_id",
                        "dwt.weight_daily",
                        "eh.icustay_id",
                        "eh.weight_echoinhosp"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "(ie.icustay_id = eh.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "Merge Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Left",
                            "Output": [
                                "ie.icustay_id",
                                "ce.icustay_id",
                                "ce.weight_admit",
                                "dwt.icustay_id",
                                "dwt.weight_daily"
                            ],
                            "Inner Unique": false,
                            "Merge Cond": "(ie.icustay_id = dwt.icustay_id)",
                            "Plans": [
                                {
                                    "Node Type": "Merge Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Left",
                                    "Output": [
                                        "ie.icustay_id",
                                        "ce.icustay_id",
                                        "ce.weight_admit"
                                    ],
                                    "Inner Unique": false,
                                    "Merge Cond": "(ie.icustay_id = ce.icustay_id)",
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ie.icustay_id"
                                            ],
                                            "Sort Key": [
                                                "ie.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Hash Join",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Join Type": "Inner",
                                                    "Output": [
                                                        "ie.icustay_id"
                                                    ],
                                                    "Inner Unique": true,
                                                    "Hash Cond": "(ie.subject_id = pat.subject_id)",
                                                    "Join Filter": "(ie.intime > datetime_add(pat.dob, '1 year'::interval year))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Seq Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "icustays",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "ie",
                                                            "Output": [
                                                                "ie.row_id",
                                                                "ie.subject_id",
                                                                "ie.hadm_id",
                                                                "ie.icustay_id",
                                                                "ie.dbsource",
                                                                "ie.first_careunit",
                                                                "ie.last_careunit",
                                                                "ie.first_wardid",
                                                                "ie.last_wardid",
                                                                "ie.intime",
                                                                "ie.outtime",
                                                                "ie.los"
                                                            ]
                                                        },
                                                        {
                                                            "Node Type": "Hash",
                                                            "Parent Relationship": "Inner",
                                                            "Parallel Aware": false,
                                                            "Output": [
                                                                "pat.subject_id",
                                                                "pat.dob"
                                                            ],
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Seq Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Relation Name": "patients",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "pat",
                                                                    "Output": [
                                                                        "pat.subject_id",
                                                                        "pat.dob"
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ce.icustay_id",
                                                "ce.weight_admit"
                                            ],
                                            "Sort Key": [
                                                "ce.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "ce",
                                                    "Alias": "ce",
                                                    "Output": [
                                                        "ce.icustay_id",
                                                        "ce.weight_admit"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "dwt.icustay_id",
                                        "dwt.weight_daily"
                                    ],
                                    "Sort Key": [
                                        "dwt.icustay_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "dwt",
                                            "Alias": "dwt",
                                            "Output": [
                                                "dwt.icustay_id",
                                                "dwt.weight_daily"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "eh.icustay_id",
                                "eh.weight_echoinhosp"
                            ],
                            "Sort Key": [
                                "eh.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "echo_hadm",
                                    "Alias": "eh",
                                    "Output": [
                                        "eh.icustay_id",
                                        "eh.weight_echoinhosp"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Sort",
                    "Parent Relationship": "Inner",
                    "Parallel Aware": false,
                    "Output": [
                        "enh.icustay_id",
                        "enh.weight_echoprehosp"
                    ],
                    "Sort Key": [
                        "enh.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "echo_nohadm",
                            "Alias": "enh",
                            "Output": [
                                "enh.icustay_id",
                                "enh.weight_echoprehosp"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.vitals_first_day": {
        "sql": "SELECT pvt.subject_id, pvt.hadm_id, pvt.icustay_id\n\n-- Easier names\n, min(case when VitalID = 1 then valuenum ELSE NULL END) AS heartrate_min\n, max(case when VitalID = 1 then valuenum ELSE NULL END) AS heartrate_max\n, avg(case when VitalID = 1 then valuenum ELSE NULL END) AS heartrate_mean\n, min(case when VitalID = 2 then valuenum ELSE NULL END) AS sysbp_min\n, max(case when VitalID = 2 then valuenum ELSE NULL END) AS sysbp_max\n, avg(case when VitalID = 2 then valuenum ELSE NULL END) AS sysbp_mean\n, min(case when VitalID = 3 then valuenum ELSE NULL END) AS diasbp_min\n, max(case when VitalID = 3 then valuenum ELSE NULL END) AS diasbp_max\n, avg(case when VitalID = 3 then valuenum ELSE NULL END) AS diasbp_mean\n, min(case when VitalID = 4 then valuenum ELSE NULL END) AS meanbp_min\n, max(case when VitalID = 4 then valuenum ELSE NULL END) AS meanbp_max\n, avg(case when VitalID = 4 then valuenum ELSE NULL END) AS meanbp_mean\n, min(case when VitalID = 5 then valuenum ELSE NULL END) AS resprate_min\n, max(case when VitalID = 5 then valuenum ELSE NULL END) AS resprate_max\n, avg(case when VitalID = 5 then valuenum ELSE NULL END) AS resprate_mean\n, min(case when VitalID = 6 then valuenum ELSE NULL END) AS tempc_min\n, max(case when VitalID = 6 then valuenum ELSE NULL END) AS tempc_max\n, avg(case when VitalID = 6 then valuenum ELSE NULL END) AS tempc_mean\n, min(case when VitalID = 7 then valuenum ELSE NULL END) AS spo2_min\n, max(case when VitalID = 7 then valuenum ELSE NULL END) AS spo2_max\n, avg(case when VitalID = 7 then valuenum ELSE NULL END) AS spo2_mean\n, min(case when VitalID = 8 then valuenum ELSE NULL END) AS glucose_min\n, max(case when VitalID = 8 then valuenum ELSE NULL END) AS glucose_max\n, avg(case when VitalID = 8 then valuenum ELSE NULL END) AS glucose_mean\n\nFROM  (\n  select ie.subject_id, ie.hadm_id, ie.icustay_id\n  , case\n    when itemid in (211,220045) and valuenum > 0 and valuenum < 300 then 1 -- HeartRate\n    when itemid in (51,442,455,6701,220179,220050) and valuenum > 0 and valuenum < 400 then 2 -- SysBP\n    when itemid in (8368,8440,8441,8555,220180,220051) and valuenum > 0 and valuenum < 300 then 3 -- DiasBP\n    when itemid in (456,52,6702,443,220052,220181,225312) and valuenum > 0 and valuenum < 300 then 4 -- MeanBP\n    when itemid in (615,618,220210,224690) and valuenum > 0 and valuenum < 70 then 5 -- RespRate\n    when itemid in (223761,678) and valuenum > 70 and valuenum < 120  then 6 -- TempF, converted to degC in valuenum call\n    when itemid in (223762,676) and valuenum > 10 and valuenum < 50  then 6 -- TempC\n    when itemid in (646,220277) and valuenum > 0 and valuenum <= 100 then 7 -- SpO2\n    when itemid in (807,811,1529,3745,3744,225664,220621,226537) and valuenum > 0 then 8 -- Glucose\n\n    else null end as vitalid\n      -- convert F to C\n  , case when itemid in (223761,678) then (valuenum-32)/1.8 else valuenum end as valuenum\n\n  from icustays ie\n  left join chartevents ce\n  on ie.icustay_id = ce.icustay_id\n  and ce.charttime between ie.intime and DATETIME_ADD(ie.intime, INTERVAL '1' DAY)\n  and DATETIME_DIFF(ce.charttime, ie.intime, 'SECOND') > 0\n  and DATETIME_DIFF(ce.charttime, ie.intime, 'HOUR') <= 24\n  -- exclude rows marked as error\n  and (ce.error IS NULL or ce.error = 0)\n  where ce.itemid in\n  (\n  -- HEART RATE\n  211, --\"Heart Rate\"\n  220045, --\"Heart Rate\"\n\n  -- Systolic/diastolic\n\n  51, --\tArterial BP [Systolic]\n  442, --\tManual BP [Systolic]\n  455, --\tNBP [Systolic]\n  6701, --\tArterial BP #2 [Systolic]\n  220179, --\tNon Invasive Blood Pressure systolic\n  220050, --\tArterial Blood Pressure systolic\n\n  8368, --\tArterial BP [Diastolic]\n  8440, --\tManual BP [Diastolic]\n  8441, --\tNBP [Diastolic]\n  8555, --\tArterial BP #2 [Diastolic]\n  220180, --\tNon Invasive Blood Pressure diastolic\n  220051, --\tArterial Blood Pressure diastolic\n\n\n  -- MEAN ARTERIAL PRESSURE\n  456, --\"NBP Mean\"\n  52, --\"Arterial BP Mean\"\n  6702, --\tArterial BP Mean #2\n  443, --\tManual BP Mean(calc)\n  220052, --\"Arterial Blood Pressure mean\"\n  220181, --\"Non Invasive Blood Pressure mean\"\n  225312, --\"ART BP mean\"\n\n  -- RESPIRATORY RATE\n  618,--\tRespiratory Rate\n  615,--\tResp Rate (Total)\n  220210,--\tRespiratory Rate\n  224690, --\tRespiratory Rate (Total)\n\n\n  -- SPO2, peripheral\n  646, 220277,\n\n  -- GLUCOSE, both lab and fingerstick\n  807,--\tFingerstick Glucose\n  811,--\tGlucose (70-105)\n  1529,--\tGlucose\n  3745,--\tBloodGlucose\n  3744,--\tBlood Glucose\n  225664,--\tGlucose finger stick\n  220621,--\tGlucose (serum)\n  226537,--\tGlucose (whole blood)\n\n  -- TEMPERATURE\n  223762, -- \"Temperature Celsius\"\n  676,\t-- \"Temperature C\"\n  223761, -- \"Temperature Fahrenheit\"\n  678 --\t\"Temperature F\"\n\n  )\n) pvt\ngroup by pvt.subject_id, pvt.hadm_id, pvt.icustay_id\norder by pvt.subject_id, pvt.hadm_id, pvt.icustay_id",
        "tables": [
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.icustays"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "hadm_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "icustay_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "heartrate_min": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "heartrate_max": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "heartrate_mean": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "sysbp_min": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "sysbp_max": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "sysbp_mean": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "diasbp_min": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "diasbp_max": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "diasbp_mean": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "meanbp_min": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "meanbp_max": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "meanbp_mean": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "resprate_min": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "resprate_max": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "resprate_mean": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "tempc_min": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "tempc_max": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "tempc_mean": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "spo2_min": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "spo2_max": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "spo2_mean": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "glucose_min": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "glucose_max": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ],
            "glucose_mean": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.vitals_first_day",
        "plan": {
            "Node Type": "Aggregate",
            "Strategy": "Sorted",
            "Partial Mode": "Simple",
            "Parallel Aware": false,
            "Output": [
                "ie.subject_id",
                "ie.hadm_id",
                "ie.icustay_id",
                "min(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 1) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 1) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "avg(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 1) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 2) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 2) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "avg(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 2) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 3) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 3) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "avg(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 3) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 4) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 4) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "avg(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 4) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 5) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 5) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "avg(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 5) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 6) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 6) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "avg(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 6) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 7) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 7) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "avg(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 7) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "min(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 8) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "max(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 8) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)",
                "avg(CASE WHEN (CASE WHEN ((ce.itemid = ANY ('{211,220045}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 1 WHEN ((ce.itemid = ANY ('{51,442,455,6701,220179,220050}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '400'::double precision)) THEN 2 WHEN ((ce.itemid = ANY ('{8368,8440,8441,8555,220180,220051}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 3 WHEN ((ce.itemid = ANY ('{456,52,6702,443,220052,220181,225312}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '300'::double precision)) THEN 4 WHEN ((ce.itemid = ANY ('{615,618,220210,224690}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum < '70'::double precision)) THEN 5 WHEN ((ce.itemid = ANY ('{223761,678}'::integer[])) AND (ce.valuenum > '70'::double precision) AND (ce.valuenum < '120'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{223762,676}'::integer[])) AND (ce.valuenum > '10'::double precision) AND (ce.valuenum < '50'::double precision)) THEN 6 WHEN ((ce.itemid = ANY ('{646,220277}'::integer[])) AND (ce.valuenum > '0'::double precision) AND (ce.valuenum <= '100'::double precision)) THEN 7 WHEN ((ce.itemid = ANY ('{807,811,1529,3745,3744,225664,220621,226537}'::integer[])) AND (ce.valuenum > '0'::double precision)) THEN 8 ELSE NULL::integer END = 8) THEN CASE WHEN (ce.itemid = ANY ('{223761,678}'::integer[])) THEN ((ce.valuenum - '32'::double precision) / '1.8'::double precision) ELSE ce.valuenum END ELSE NULL::double precision END)"
            ],
            "Group Key": [
                "ie.subject_id",
                "ie.hadm_id",
                "ie.icustay_id"
            ],
            "Plans": [
                {
                    "Node Type": "Sort",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id",
                        "ce.itemid",
                        "ce.valuenum"
                    ],
                    "Sort Key": [
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "ie.subject_id",
                                "ie.hadm_id",
                                "ie.icustay_id",
                                "ce.itemid",
                                "ce.valuenum"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "(ce.icustay_id = ie.icustay_id)",
                            "Join Filter": "((ce.charttime >= ie.intime) AND (ce.charttime <= datetime_add(ie.intime, '1 day'::interval day)) AND (datetime_diff(ce.charttime, ie.intime, 'SECOND'::text) > '0'::numeric) AND (datetime_diff(ce.charttime, ie.intime, 'HOUR'::text) <= '24'::numeric))",
                            "Plans": [
                                {
                                    "Node Type": "Append",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Plans": [
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "chartevents_9_idx01",
                                            "Relation Name": "chartevents_9",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce",
                                            "Output": [
                                                "ce.itemid",
                                                "ce.valuenum",
                                                "ce.icustay_id",
                                                "ce.charttime"
                                            ],
                                            "Index Cond": "(ce.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce.error IS NULL) OR (ce.error = 0))"
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "chartevents_10_idx01",
                                            "Relation Name": "chartevents_10",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_1",
                                            "Output": [
                                                "ce_1.itemid",
                                                "ce_1.valuenum",
                                                "ce_1.icustay_id",
                                                "ce_1.charttime"
                                            ],
                                            "Index Cond": "(ce_1.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_1.error IS NULL) OR (ce_1.error = 0))"
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "chartevents_31_idx01",
                                            "Relation Name": "chartevents_31",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_2",
                                            "Output": [
                                                "ce_2.itemid",
                                                "ce_2.valuenum",
                                                "ce_2.icustay_id",
                                                "ce_2.charttime"
                                            ],
                                            "Index Cond": "(ce_2.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_2.error IS NULL) OR (ce_2.error = 0))"
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_40",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_3",
                                            "Output": [
                                                "ce_3.itemid",
                                                "ce_3.valuenum",
                                                "ce_3.icustay_id",
                                                "ce_3.charttime"
                                            ],
                                            "Recheck Cond": "(ce_3.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_3.error IS NULL) OR (ce_3.error = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_40_idx01",
                                                    "Index Cond": "(ce_3.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "chartevents_42_idx01",
                                            "Relation Name": "chartevents_42",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_4",
                                            "Output": [
                                                "ce_4.itemid",
                                                "ce_4.valuenum",
                                                "ce_4.icustay_id",
                                                "ce_4.charttime"
                                            ],
                                            "Index Cond": "(ce_4.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_4.error IS NULL) OR (ce_4.error = 0))"
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "chartevents_43_idx01",
                                            "Relation Name": "chartevents_43",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_5",
                                            "Output": [
                                                "ce_5.itemid",
                                                "ce_5.valuenum",
                                                "ce_5.icustay_id",
                                                "ce_5.charttime"
                                            ],
                                            "Index Cond": "(ce_5.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_5.error IS NULL) OR (ce_5.error = 0))"
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_60",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_6",
                                            "Output": [
                                                "ce_6.itemid",
                                                "ce_6.valuenum",
                                                "ce_6.icustay_id",
                                                "ce_6.charttime"
                                            ],
                                            "Recheck Cond": "(ce_6.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_6.error IS NULL) OR (ce_6.error = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_60_idx01",
                                                    "Index Cond": "(ce_6.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "chartevents_62_idx01",
                                            "Relation Name": "chartevents_62",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_7",
                                            "Output": [
                                                "ce_7.itemid",
                                                "ce_7.valuenum",
                                                "ce_7.icustay_id",
                                                "ce_7.charttime"
                                            ],
                                            "Index Cond": "(ce_7.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_7.error IS NULL) OR (ce_7.error = 0))"
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "chartevents_69_idx01",
                                            "Relation Name": "chartevents_69",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_8",
                                            "Output": [
                                                "ce_8.itemid",
                                                "ce_8.valuenum",
                                                "ce_8.icustay_id",
                                                "ce_8.charttime"
                                            ],
                                            "Index Cond": "(ce_8.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_8.error IS NULL) OR (ce_8.error = 0))"
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "chartevents_74_idx01",
                                            "Relation Name": "chartevents_74",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_9",
                                            "Output": [
                                                "ce_9.itemid",
                                                "ce_9.valuenum",
                                                "ce_9.icustay_id",
                                                "ce_9.charttime"
                                            ],
                                            "Index Cond": "(ce_9.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_9.error IS NULL) OR (ce_9.error = 0))"
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "chartevents_76_idx01",
                                            "Relation Name": "chartevents_76",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_10",
                                            "Output": [
                                                "ce_10.itemid",
                                                "ce_10.valuenum",
                                                "ce_10.icustay_id",
                                                "ce_10.charttime"
                                            ],
                                            "Index Cond": "(ce_10.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_10.error IS NULL) OR (ce_10.error = 0))"
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_88",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_11",
                                            "Output": [
                                                "ce_11.itemid",
                                                "ce_11.valuenum",
                                                "ce_11.icustay_id",
                                                "ce_11.charttime"
                                            ],
                                            "Recheck Cond": "(ce_11.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_11.error IS NULL) OR (ce_11.error = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_88_idx01",
                                                    "Index Cond": "(ce_11.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_100",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_12",
                                            "Output": [
                                                "ce_12.itemid",
                                                "ce_12.valuenum",
                                                "ce_12.icustay_id",
                                                "ce_12.charttime"
                                            ],
                                            "Recheck Cond": "(ce_12.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_12.error IS NULL) OR (ce_12.error = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_100_idx01",
                                                    "Index Cond": "(ce_12.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_121",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_13",
                                            "Output": [
                                                "ce_13.itemid",
                                                "ce_13.valuenum",
                                                "ce_13.icustay_id",
                                                "ce_13.charttime"
                                            ],
                                            "Recheck Cond": "(ce_13.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_13.error IS NULL) OR (ce_13.error = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_121_idx01",
                                                    "Index Cond": "(ce_13.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_130",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_14",
                                            "Output": [
                                                "ce_14.itemid",
                                                "ce_14.valuenum",
                                                "ce_14.icustay_id",
                                                "ce_14.charttime"
                                            ],
                                            "Recheck Cond": "(ce_14.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_14.error IS NULL) OR (ce_14.error = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_130_idx01",
                                                    "Index Cond": "(ce_14.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "chartevents_133_idx01",
                                            "Relation Name": "chartevents_133",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_15",
                                            "Output": [
                                                "ce_15.itemid",
                                                "ce_15.valuenum",
                                                "ce_15.icustay_id",
                                                "ce_15.charttime"
                                            ],
                                            "Index Cond": "(ce_15.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_15.error IS NULL) OR (ce_15.error = 0))"
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_134",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_16",
                                            "Output": [
                                                "ce_16.itemid",
                                                "ce_16.valuenum",
                                                "ce_16.icustay_id",
                                                "ce_16.charttime"
                                            ],
                                            "Recheck Cond": "(ce_16.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_16.error IS NULL) OR (ce_16.error = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_134_idx01",
                                                    "Index Cond": "(ce_16.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "chartevents_135_idx01",
                                            "Relation Name": "chartevents_135",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_17",
                                            "Output": [
                                                "ce_17.itemid",
                                                "ce_17.valuenum",
                                                "ce_17.icustay_id",
                                                "ce_17.charttime"
                                            ],
                                            "Index Cond": "(ce_17.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_17.error IS NULL) OR (ce_17.error = 0))"
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "chartevents_153_idx01",
                                            "Relation Name": "chartevents_153",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_18",
                                            "Output": [
                                                "ce_18.itemid",
                                                "ce_18.valuenum",
                                                "ce_18.icustay_id",
                                                "ce_18.charttime"
                                            ],
                                            "Index Cond": "(ce_18.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_18.error IS NULL) OR (ce_18.error = 0))"
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "chartevents_155_idx01",
                                            "Relation Name": "chartevents_155",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_19",
                                            "Output": [
                                                "ce_19.itemid",
                                                "ce_19.valuenum",
                                                "ce_19.icustay_id",
                                                "ce_19.charttime"
                                            ],
                                            "Index Cond": "(ce_19.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_19.error IS NULL) OR (ce_19.error = 0))"
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "chartevents_159_idx01",
                                            "Relation Name": "chartevents_159",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_20",
                                            "Output": [
                                                "ce_20.itemid",
                                                "ce_20.valuenum",
                                                "ce_20.icustay_id",
                                                "ce_20.charttime"
                                            ],
                                            "Index Cond": "(ce_20.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_20.error IS NULL) OR (ce_20.error = 0))"
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "chartevents_160_idx01",
                                            "Relation Name": "chartevents_160",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_21",
                                            "Output": [
                                                "ce_21.itemid",
                                                "ce_21.valuenum",
                                                "ce_21.icustay_id",
                                                "ce_21.charttime"
                                            ],
                                            "Index Cond": "(ce_21.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_21.error IS NULL) OR (ce_21.error = 0))"
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "chartevents_161_idx01",
                                            "Relation Name": "chartevents_161",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_22",
                                            "Output": [
                                                "ce_22.itemid",
                                                "ce_22.valuenum",
                                                "ce_22.icustay_id",
                                                "ce_22.charttime"
                                            ],
                                            "Index Cond": "(ce_22.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_22.error IS NULL) OR (ce_22.error = 0))"
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "chartevents_164_idx01",
                                            "Relation Name": "chartevents_164",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_23",
                                            "Output": [
                                                "ce_23.itemid",
                                                "ce_23.valuenum",
                                                "ce_23.icustay_id",
                                                "ce_23.charttime"
                                            ],
                                            "Index Cond": "(ce_23.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_23.error IS NULL) OR (ce_23.error = 0))"
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "chartevents_165_idx01",
                                            "Relation Name": "chartevents_165",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_24",
                                            "Output": [
                                                "ce_24.itemid",
                                                "ce_24.valuenum",
                                                "ce_24.icustay_id",
                                                "ce_24.charttime"
                                            ],
                                            "Index Cond": "(ce_24.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_24.error IS NULL) OR (ce_24.error = 0))"
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "chartevents_166_idx01",
                                            "Relation Name": "chartevents_166",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_25",
                                            "Output": [
                                                "ce_25.itemid",
                                                "ce_25.valuenum",
                                                "ce_25.icustay_id",
                                                "ce_25.charttime"
                                            ],
                                            "Index Cond": "(ce_25.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_25.error IS NULL) OR (ce_25.error = 0))"
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "chartevents_168_idx01",
                                            "Relation Name": "chartevents_168",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_26",
                                            "Output": [
                                                "ce_26.itemid",
                                                "ce_26.valuenum",
                                                "ce_26.icustay_id",
                                                "ce_26.charttime"
                                            ],
                                            "Index Cond": "(ce_26.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_26.error IS NULL) OR (ce_26.error = 0))"
                                        },
                                        {
                                            "Node Type": "Index Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Scan Direction": "Forward",
                                            "Index Name": "chartevents_170_idx01",
                                            "Relation Name": "chartevents_170",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_27",
                                            "Output": [
                                                "ce_27.itemid",
                                                "ce_27.valuenum",
                                                "ce_27.icustay_id",
                                                "ce_27.charttime"
                                            ],
                                            "Index Cond": "(ce_27.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_27.error IS NULL) OR (ce_27.error = 0))"
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_171",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_28",
                                            "Output": [
                                                "ce_28.itemid",
                                                "ce_28.valuenum",
                                                "ce_28.icustay_id",
                                                "ce_28.charttime"
                                            ],
                                            "Recheck Cond": "(ce_28.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_28.error IS NULL) OR (ce_28.error = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_171_idx01",
                                                    "Index Cond": "(ce_28.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_172",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_29",
                                            "Output": [
                                                "ce_29.itemid",
                                                "ce_29.valuenum",
                                                "ce_29.icustay_id",
                                                "ce_29.charttime"
                                            ],
                                            "Recheck Cond": "(ce_29.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_29.error IS NULL) OR (ce_29.error = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_172_idx01",
                                                    "Index Cond": "(ce_29.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_194",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_30",
                                            "Output": [
                                                "ce_30.itemid",
                                                "ce_30.valuenum",
                                                "ce_30.icustay_id",
                                                "ce_30.charttime"
                                            ],
                                            "Recheck Cond": "(ce_30.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_30.error IS NULL) OR (ce_30.error = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_194_idx01",
                                                    "Index Cond": "(ce_30.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_198",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_31",
                                            "Output": [
                                                "ce_31.itemid",
                                                "ce_31.valuenum",
                                                "ce_31.icustay_id",
                                                "ce_31.charttime"
                                            ],
                                            "Recheck Cond": "(ce_31.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_31.error IS NULL) OR (ce_31.error = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_198_idx01",
                                                    "Index Cond": "(ce_31.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_199",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_32",
                                            "Output": [
                                                "ce_32.itemid",
                                                "ce_32.valuenum",
                                                "ce_32.icustay_id",
                                                "ce_32.charttime"
                                            ],
                                            "Recheck Cond": "(ce_32.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_32.error IS NULL) OR (ce_32.error = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_199_idx01",
                                                    "Index Cond": "(ce_32.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_201",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_33",
                                            "Output": [
                                                "ce_33.itemid",
                                                "ce_33.valuenum",
                                                "ce_33.icustay_id",
                                                "ce_33.charttime"
                                            ],
                                            "Recheck Cond": "(ce_33.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))",
                                            "Filter": "((ce_33.error IS NULL) OR (ce_33.error = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_201_idx01",
                                                    "Index Cond": "(ce_33.itemid = ANY ('{211,220045,51,442,455,6701,220179,220050,8368,8440,8441,8555,220180,220051,456,52,6702,443,220052,220181,225312,618,615,220210,224690,646,220277,807,811,1529,3745,3744,225664,220621,226537,223762,676,223761,678}'::integer[]))"
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "ie.subject_id",
                                        "ie.hadm_id",
                                        "ie.icustay_id",
                                        "ie.intime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "icustays",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ie",
                                            "Output": [
                                                "ie.subject_id",
                                                "ie.hadm_id",
                                                "ie.icustay_id",
                                                "ie.intime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.colloid_bolus": {
        "sql": "-- received colloid before admission\n-- 226365  --  OR Colloid Intake\n-- 226376  --  PACU Colloid Intake\n\nwith t1 as\n(\n  select\n    mv.icustay_id\n  , mv.starttime as charttime\n  -- standardize the units to millilitres\n  -- also metavision has floating point precision.. but we only care down to the mL\n  , round(case\n      when mv.amountuom = 'L'\n        then mv.amount * 1000.0\n      when mv.amountuom = 'ml'\n        then mv.amount\n    else null end) as amount\n  from inputevents_mv mv\n  where mv.itemid in\n  (\n    220864, --\tAlbumin 5%\t7466 132 7466\n    220862, --\tAlbumin 25%\t9851 174 9851\n    225174, --\tHetastarch (Hespan) 6%\t82 1 82\n    225795, --\tDextran 40\t38 3 38\n    225796  --  Dextran 70\n    -- below ITEMIDs not in use\n   -- 220861 | Albumin (Human) 20%\n   -- 220863 | Albumin (Human) 4%\n  )\n  and mv.statusdescription != 'Rewritten'\n  and\n  -- in MetaVision, these ITEMIDs never appear with a null rate\n  -- so it is sufficient to check the rate is > 100\n    (\n      (mv.rateuom = 'mL/hour' and mv.rate > 100)\n      OR (mv.rateuom = 'mL/min' and mv.rate > (100/60.0))\n      OR (mv.rateuom = 'mL/kg/hour' and (mv.rate*mv.patientweight) > 100)\n    )\n)\n, t2 as\n(\n  select\n    cv.icustay_id\n  , cv.charttime\n  -- carevue always has units in millilitres (or null)\n  , round(cv.amount) as amount\n  from inputevents_cv cv\n  where cv.itemid in\n  (\n   30008 --\tAlbumin 5%\n  ,30009 --\tAlbumin 25%\n  ,42832 --\talbumin 12.5%\n  ,40548 --\tALBUMIN\n  ,45403 --\talbumin\n  ,44203 --\tAlbumin 12.5%\n  ,30181 -- Serum Albumin 5%\n  ,46564 -- Albumin\n  ,43237 -- 25% Albumin\n  ,43353 -- Albumin (human) 25%\n\n  ,30012 --\tHespan\n  ,46313 --\t6% Hespan\n\n  ,30011 -- Dextran 40\n  ,30016 -- Dextrose 10%\n  ,42975 --\tDEXTRAN DRIP\n  ,42944 --\tdextran\n  ,46336 --\t10% Dextran 40/D5W\n  ,46729 --\tDextran\n  ,40033 --\tDEXTRAN\n  ,45410 --\t10% Dextran 40\n  ,42731 -- Dextran40 10%\n  )\n  and cv.amount > 100\n  and cv.amount < 2000\n)\n-- some colloids are charted in chartevents\n, t3 as\n(\n  select\n    ce.icustay_id\n  , ce.charttime\n  -- carevue always has units in millilitres (or null)\n  , round(ce.valuenum) as amount\n  from chartevents ce\n  where ce.itemid in\n  (\n      2510 --\tDEXTRAN LML 10%\n    , 3087 --\tDEXTRAN 40  10%\n    , 6937 --\tDextran\n    , 3087 -- DEXTRAN 40  10%\n    , 3088 --\tDEXTRAN 40%\n  )\n  and ce.valuenum is not null\n  and ce.valuenum > 100\n  and ce.valuenum < 2000\n)\nselect\n    icustay_id\n  , charttime\n  , sum(amount) as colloid_bolus\nfrom t1\n-- just because the rate was high enough, does *not* mean the final amount was\nwhere amount > 100\ngroup by t1.icustay_id, t1.charttime\nUNION ALL\nselect\n    icustay_id\n  , charttime\n  , sum(amount) as colloid_bolus\nfrom t2\ngroup by t2.icustay_id, t2.charttime\nUNION ALL \nselect\n    icustay_id\n  , charttime\n  , sum(amount) as colloid_bolus\nfrom t3\ngroup by t3.icustay_id, t3.charttime\norder by icustay_id, charttime",
        "tables": [
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.inputevents_cv",
            "mimiciii_clinical.inputevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.amountuom",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.patientweight",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.rateuom",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "charttime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.amountuom",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.patientweight",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.rateuom",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "colloid_bolus": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.amountuom",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.patientweight",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.rateuom",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ]
        },
        "table_name": "mimiciii_clinical.colloid_bolus",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "t1.icustay_id",
                "t1.charttime",
                "(sum(t1.amount))"
            ],
            "Sort Key": [
                "t1.icustay_id",
                "t1.charttime"
            ],
            "Plans": [
                {
                    "Node Type": "Bitmap Heap Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE t1",
                    "Parallel Aware": false,
                    "Relation Name": "inputevents_mv",
                    "Schema": "mimiciii_clinical",
                    "Alias": "mv",
                    "Output": [
                        "mv.icustay_id",
                        "mv.starttime",
                        "round(CASE WHEN ((mv.amountuom)::text = 'L'::text) THEN (mv.amount * '1000'::double precision) WHEN ((mv.amountuom)::text = 'ml'::text) THEN mv.amount ELSE NULL::double precision END)"
                    ],
                    "Recheck Cond": "(mv.itemid = ANY ('{220864,220862,225174,225795,225796}'::integer[]))",
                    "Filter": "(((mv.statusdescription)::text <> 'Rewritten'::text) AND ((((mv.rateuom)::text = 'mL/hour'::text) AND (mv.rate > '100'::double precision)) OR (((mv.rateuom)::text = 'mL/min'::text) AND (mv.rate > '1.66666666666667'::double precision)) OR (((mv.rateuom)::text = 'mL/kg/hour'::text) AND ((mv.rate * mv.patientweight) > '100'::double precision))))",
                    "Plans": [
                        {
                            "Node Type": "Bitmap Index Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Index Name": "inputevents_mv_idx05",
                            "Index Cond": "(mv.itemid = ANY ('{220864,220862,225174,225795,225796}'::integer[]))"
                        }
                    ]
                },
                {
                    "Node Type": "Bitmap Heap Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE t2",
                    "Parallel Aware": false,
                    "Relation Name": "inputevents_cv",
                    "Schema": "mimiciii_clinical",
                    "Alias": "cv",
                    "Output": [
                        "cv.icustay_id",
                        "cv.charttime",
                        "round(cv.amount)"
                    ],
                    "Recheck Cond": "(cv.itemid = ANY ('{30008,30009,42832,40548,45403,44203,30181,46564,43237,43353,30012,46313,30011,30016,42975,42944,46336,46729,40033,45410,42731}'::integer[]))",
                    "Filter": "((cv.amount > '100'::double precision) AND (cv.amount < '2000'::double precision))",
                    "Plans": [
                        {
                            "Node Type": "Bitmap Index Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Index Name": "inputevents_cv_idx05",
                            "Index Cond": "(cv.itemid = ANY ('{30008,30009,42832,40548,45403,44203,30181,46564,43237,43353,30012,46313,30011,30016,42975,42944,46336,46729,40033,45410,42731}'::integer[]))"
                        }
                    ]
                },
                {
                    "Node Type": "Result",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE t3",
                    "Parallel Aware": false,
                    "Output": [
                        "ce.icustay_id",
                        "ce.charttime",
                        "round(ce.valuenum)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Append",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Plans": [
                                {
                                    "Node Type": "Index Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Scan Direction": "Forward",
                                    "Index Name": "chartevents_104_idx01",
                                    "Relation Name": "chartevents_104",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ce",
                                    "Output": [
                                        "ce.icustay_id",
                                        "ce.charttime",
                                        "ce.valuenum"
                                    ],
                                    "Index Cond": "(ce.itemid = ANY ('{2510,3087,6937,3087,3088}'::integer[]))",
                                    "Filter": "((ce.valuenum IS NOT NULL) AND (ce.valuenum > '100'::double precision) AND (ce.valuenum < '2000'::double precision))"
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_130",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ce_1",
                                    "Output": [
                                        "ce_1.icustay_id",
                                        "ce_1.charttime",
                                        "ce_1.valuenum"
                                    ],
                                    "Recheck Cond": "(ce_1.itemid = ANY ('{2510,3087,6937,3087,3088}'::integer[]))",
                                    "Filter": "((ce_1.valuenum IS NOT NULL) AND (ce_1.valuenum > '100'::double precision) AND (ce_1.valuenum < '2000'::double precision))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_130_idx01",
                                            "Index Cond": "(ce_1.itemid = ANY ('{2510,3087,6937,3087,3088}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "Aggregate",
                            "Strategy": "Hashed",
                            "Partial Mode": "Simple",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "t1.icustay_id",
                                "t1.charttime",
                                "sum(t1.amount)"
                            ],
                            "Group Key": [
                                "t1.icustay_id",
                                "t1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "t1",
                                    "Alias": "t1",
                                    "Output": [
                                        "t1.icustay_id",
                                        "t1.charttime",
                                        "t1.amount"
                                    ],
                                    "Filter": "(t1.amount > '100'::double precision)"
                                }
                            ]
                        },
                        {
                            "Node Type": "Aggregate",
                            "Strategy": "Hashed",
                            "Partial Mode": "Simple",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "t2.icustay_id",
                                "t2.charttime",
                                "sum(t2.amount)"
                            ],
                            "Group Key": [
                                "t2.icustay_id",
                                "t2.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "t2",
                                    "Alias": "t2",
                                    "Output": [
                                        "t2.icustay_id",
                                        "t2.charttime",
                                        "t2.amount"
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Aggregate",
                            "Strategy": "Hashed",
                            "Partial Mode": "Simple",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "t3.icustay_id",
                                "t3.charttime",
                                "sum(t3.amount)"
                            ],
                            "Group Key": [
                                "t3.icustay_id",
                                "t3.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "t3",
                                    "Alias": "t3",
                                    "Output": [
                                        "t3.icustay_id",
                                        "t3.charttime",
                                        "t3.amount"
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.crystalloid_bolus": {
        "sql": "with t1 as\n(\n  select\n    mv.icustay_id\n  , mv.starttime as charttime\n  -- standardize the units to millilitres\n  -- also metavision has floating point precision.. but we only care down to the mL\n  , round(case\n      when mv.amountuom = 'L'\n        then mv.amount * 1000.0\n      when mv.amountuom = 'ml'\n        then mv.amount\n    else null end) as amount\n  from inputevents_mv mv\n  where mv.itemid in\n  (\n    -- 225943 Solution\n    225158, -- NaCl 0.9%\n    225828, -- LR\n    225944, -- Sterile Water\n    225797, -- Free Water\n\t  225159, -- NaCl 0.45%\n\t  -- 225161, -- NaCl 3% (Hypertonic Saline)\n\t  225823, -- D5 1/2NS\n\t  225825, -- D5NS\n\t  225827, -- D5LR\n\t  225941, -- D5 1/4NS\n\t  226089 -- Piggyback\n  )\n  and mv.statusdescription != 'Rewritten'\n  and\n  -- in MetaVision, these ITEMIDs appear with a null rate IFF endtime=starttime + 1 minute\n  -- so it is sufficient to:\n  --    (1) check the rate is > 240 if it exists or\n  --    (2) ensure the rate is null and amount > 240 ml\n    (\n      (mv.rate is not null and mv.rateuom = 'mL/hour' and mv.rate > 248)\n      OR (mv.rate is not null and mv.rateuom = 'mL/min' and mv.rate > (248/60.0))\n      OR (mv.rate is null and mv.amountuom = 'L' and mv.amount > 0.248)\n      OR (mv.rate is null and mv.amountuom = 'ml' and mv.amount > 248)\n    )\n)\n, t2 as\n(\n  select\n    cv.icustay_id\n  , cv.charttime\n  -- carevue always has units in millilitres\n  , round(cv.amount) as amount\n  from inputevents_cv cv\n  where cv.itemid in\n  (\n    30015 -- \"D5/.45NS\" -- mixed colloids and crystalloids\n  , 30018 --\t.9% Normal Saline\n  , 30020 -- .45% Normal Saline\n  , 30021 --\tLactated Ringers\n  , 30058 --\tFree Water Bolus\n  , 30060 -- D5NS\n  , 30061 -- D5RL\n  , 30063 --\tIV Piggyback\n  , 30065 --\tSterile Water\n  -- , 30143 -- 3% Normal Saline\n  , 30159 -- D5 Ringers Lact.\n  , 30160 -- D5 Normal Saline\n  , 30169 --\tSterile H20_GU\n  , 30190 -- NS .9%\n  , 40850 --\tns bolus\n  , 41491 --\tfluid bolus\n  , 42639 --\tbolus\n  , 42187 --\tfree h20\n  , 43819 --\t1:1 NS Repletion.\n  , 41430 --\tfree water boluses\n  , 40712 --\tfree H20\n  , 44160 --\tBOLUS\n  , 42383 --\tcc for cc replace\n  , 42297 --\tFluid bolus\n  , 42453 --\tFluid Bolus\n  , 40872 --\tfree water\n  , 41915 --\tFREE WATER\n  , 41490 --\tNS bolus\n  , 46501 --\tH2O Bolus\n  , 45045 --\tWaterBolus\n  , 41984 --\tFREE H20\n  , 41371 --\tns fluid bolus\n  , 41582 --\tfree h20 bolus\n  , 41322 --\trl bolus\n  , 40778 --\tFree H2O\n  , 41896 --\tivf boluses\n  , 41428 --\tns .9% bolus\n  , 43936 --\tFREE WATER BOLUSES\n  , 44200 --\tFLUID BOLUS\n  , 41619 --\tfrfee water boluses\n  , 40424 --\tfree H2O\n  , 41457 --\tFree H20 intake\n  , 41581 --\tWater bolus\n  , 42844 --\tNS fluid bolus\n  , 42429 --\tFree water\n  , 41356 --\tIV Bolus\n  , 40532 --\tFREE H2O\n  , 42548 --\tNS Bolus\n  , 44184 --\tLR Bolus\n  , 44521 --\tLR bolus\n  , 44741 --\tNS FLUID BOLUS\n  , 44126 --\tfl bolus\n  , 44110 --\tRL BOLUS\n  , 44633 --\tns boluses\n  , 44983 --\tBolus NS\n  , 44815 --\tLR BOLUS\n  , 43986 --\tiv bolus\n  , 45079 --\t500 cc ns bolus\n  , 46781 --\tlr bolus\n  , 45155 --\tns cc/cc replacement\n  , 43909 --\tH20 BOlus\n  , 41467 --\tNS IV bolus\n  , 44367 --\tLR\n  , 41743 --\twater bolus\n  , 40423 --\tBolus\n  , 44263 --\tfluid bolus ns\n  , 42749 --\tfluid bolus NS\n  , 45480 --\t500cc ns bolus\n  , 44491 --\t.9NS bolus\n  , 41695 --\tNS fluid boluses\n  , 46169 --\tfree water bolus.\n  , 41580 --\tfree h2o bolus\n  , 41392 --\tns b\n  , 45989 --\tNS Fluid Bolus\n  , 45137 --\tNS cc/cc\n  , 45154 --\tFree H20 bolus\n  , 44053 --\tnormal saline bolus\n  , 41416 --\tfree h2o boluses\n  , 44761 --\tFree H20\n  , 41237 --\tns fluid boluses\n  , 44426 --\tbolus ns\n  , 43975 --\tFREE H20 BOLUSES\n  , 44894 --\tN/s 500 ml bolus\n  , 41380 --\tnsbolus\n  , 42671 --\tfree h2o\n  )\n  and cv.amount > 248\n  and cv.amount <= 2000\n  and cv.amountuom = 'ml'\n)\nselect\n    icustay_id\n  , charttime\n  , sum(amount) as crystalloid_bolus\nfrom t1\n-- just because the rate was high enough, does *not* mean the final amount was\nwhere amount > 248\ngroup by t1.icustay_id, t1.charttime\nUNION\nselect\n    icustay_id\n  , charttime\n  , sum(amount) as crystalloid_bolus\nfrom t2\ngroup by t2.icustay_id, t2.charttime\norder by icustay_id, charttime",
        "tables": [
            "mimiciii_clinical.inputevents_cv",
            "mimiciii_clinical.inputevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.amountuom",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.amountuom",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.rateuom",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "charttime": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.amountuom",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.amountuom",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.rateuom",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ],
            "crystalloid_bolus": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.amountuom",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.amountuom",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.rateuom",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription"
            ]
        },
        "table_name": "mimiciii_clinical.crystalloid_bolus",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "t1.icustay_id",
                "t1.charttime",
                "(sum(t1.amount))"
            ],
            "Sort Key": [
                "t1.icustay_id",
                "t1.charttime"
            ],
            "Plans": [
                {
                    "Node Type": "Gather",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE t1",
                    "Parallel Aware": false,
                    "Output": [
                        "mv.icustay_id",
                        "mv.starttime",
                        "(round(CASE WHEN ((mv.amountuom)::text = 'L'::text) THEN (mv.amount * '1000'::double precision) WHEN ((mv.amountuom)::text = 'ml'::text) THEN mv.amount ELSE NULL::double precision END))"
                    ],
                    "Workers Planned": 2,
                    "Single Copy": false,
                    "Plans": [
                        {
                            "Node Type": "Bitmap Heap Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": true,
                            "Relation Name": "inputevents_mv",
                            "Schema": "mimiciii_clinical",
                            "Alias": "mv",
                            "Output": [
                                "mv.icustay_id",
                                "mv.starttime",
                                "round(CASE WHEN ((mv.amountuom)::text = 'L'::text) THEN (mv.amount * '1000'::double precision) WHEN ((mv.amountuom)::text = 'ml'::text) THEN mv.amount ELSE NULL::double precision END)"
                            ],
                            "Recheck Cond": "(mv.itemid = ANY ('{225158,225828,225944,225797,225159,225823,225825,225827,225941,226089}'::integer[]))",
                            "Filter": "(((mv.statusdescription)::text <> 'Rewritten'::text) AND (((mv.rate IS NOT NULL) AND ((mv.rateuom)::text = 'mL/hour'::text) AND (mv.rate > '248'::double precision)) OR ((mv.rate IS NOT NULL) AND ((mv.rateuom)::text = 'mL/min'::text) AND (mv.rate > '4.13333333333333'::double precision)) OR ((mv.rate IS NULL) AND ((mv.amountuom)::text = 'L'::text) AND (mv.amount > '0.248'::double precision)) OR ((mv.rate IS NULL) AND ((mv.amountuom)::text = 'ml'::text) AND (mv.amount > '248'::double precision))))",
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Index Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Index Name": "inputevents_mv_idx05",
                                    "Index Cond": "(mv.itemid = ANY ('{225158,225828,225944,225797,225159,225823,225825,225827,225941,226089}'::integer[]))"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Gather",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE t2",
                    "Parallel Aware": false,
                    "Output": [
                        "cv.icustay_id",
                        "cv.charttime",
                        "(round(cv.amount))"
                    ],
                    "Workers Planned": 2,
                    "Single Copy": false,
                    "Plans": [
                        {
                            "Node Type": "Bitmap Heap Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": true,
                            "Relation Name": "inputevents_cv",
                            "Schema": "mimiciii_clinical",
                            "Alias": "cv",
                            "Output": [
                                "cv.icustay_id",
                                "cv.charttime",
                                "round(cv.amount)"
                            ],
                            "Recheck Cond": "(cv.itemid = ANY ('{30015,30018,30020,30021,30058,30060,30061,30063,30065,30159,30160,30169,30190,40850,41491,42639,42187,43819,41430,40712,44160,42383,42297,42453,40872,41915,41490,46501,45045,41984,41371,41582,41322,40778,41896,41428,43936,44200,41619,40424,41457,41581,42844,42429,41356,40532,42548,44184,44521,44741,44126,44110,44633,44983,44815,43986,45079,46781,45155,43909,41467,44367,41743,40423,44263,42749,45480,44491,41695,46169,41580,41392,45989,45137,45154,44053,41416,44761,41237,44426,43975,44894,41380,42671}'::integer[]))",
                            "Filter": "((cv.amount > '248'::double precision) AND (cv.amount <= '2000'::double precision) AND ((cv.amountuom)::text = 'ml'::text))",
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Index Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Index Name": "inputevents_cv_idx05",
                                    "Index Cond": "(cv.itemid = ANY ('{30015,30018,30020,30021,30058,30060,30061,30063,30065,30159,30160,30169,30190,40850,41491,42639,42187,43819,41430,40712,44160,42383,42297,42453,40872,41915,41490,46501,45045,41984,41371,41582,41322,40778,41896,41428,43936,44200,41619,40424,41457,41581,42844,42429,41356,40532,42548,44184,44521,44741,44126,44110,44633,44983,44815,43986,45079,46781,45155,43909,41467,44367,41743,40423,44263,42749,45480,44491,41695,46169,41580,41392,45989,45137,45154,44053,41416,44761,41237,44426,43975,44894,41380,42671}'::integer[]))"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "t1.icustay_id",
                        "t1.charttime",
                        "(sum(t1.amount))"
                    ],
                    "Group Key": [
                        "t1.icustay_id",
                        "t1.charttime",
                        "(sum(t1.amount))"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Append",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Plans": [
                                {
                                    "Node Type": "Aggregate",
                                    "Strategy": "Hashed",
                                    "Partial Mode": "Simple",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "t1.icustay_id",
                                        "t1.charttime",
                                        "sum(t1.amount)"
                                    ],
                                    "Group Key": [
                                        "t1.icustay_id",
                                        "t1.charttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "t1",
                                            "Alias": "t1",
                                            "Output": [
                                                "t1.icustay_id",
                                                "t1.charttime",
                                                "t1.amount"
                                            ],
                                            "Filter": "(t1.amount > '248'::double precision)"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Aggregate",
                                    "Strategy": "Hashed",
                                    "Partial Mode": "Simple",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "t2.icustay_id",
                                        "t2.charttime",
                                        "sum(t2.amount)"
                                    ],
                                    "Group Key": [
                                        "t2.icustay_id",
                                        "t2.charttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "t2",
                                            "Alias": "t2",
                                            "Output": [
                                                "t2.icustay_id",
                                                "t2.charttime",
                                                "t2.amount"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.ffp_transfusion": {
        "sql": "-- Retrieves instances of fresh frozen plasma transfusions\nWITH raw_ffp AS (\n  SELECT\n      CASE\n        WHEN amount IS NOT NULL THEN amount\n        WHEN stopped IS NOT NULL THEN 0\n        -- impute 200 mL when unit is not documented\n        -- this is an approximation which holds ~90% of the time\n        ELSE 200\n      END AS amount\n    , amountuom\n    , icustay_id\n    , charttime\n  FROM inputevents_cv\n  WHERE itemid IN\n  (\n    30005,  -- Fresh Frozen Plasma\n    30180   -- Fresh Froz Plasma\n  )\n  AND amount > 0\n  AND icustay_id IS NOT NULL\n  UNION ALL\n  SELECT amount\n    , amountuom\n    , icustay_id\n    , endtime AS charttime\n  FROM inputevents_mv\n  WHERE itemid in\n  (\n    220970   -- Fresh Frozen Plasma\n  )\n  AND amount > 0\n  AND icustay_id IS NOT NULL\n),\npre_icu_ffp as (\n  SELECT\n    sum(amount) as amount, icustay_id\n  FROM inputevents_cv\n  WHERE itemid IN (\n    44172,  -- FFP GTT         \n    44236,  -- E.R. FFP        \n    46410,  -- angio FFP\n    46418,  -- ER ffp\n    46684,  -- ER FFP\n    44819,  -- FFP ON FARR 2\n    46530,  -- Floor FFP       \n    44044,  -- FFP Drip\n    46122,  -- ER in FFP\n    45669,  -- ED FFP\n    42323   -- er ffp\n  )\n  AND amount > 0\n  AND icustay_id IS NOT NULL\n  GROUP BY icustay_id\n  UNION ALL\n  SELECT\n    sum(amount) as amount, icustay_id\n  FROM inputevents_mv\n  WHERE itemid IN (\n    227072  -- PACU FFP Intake\n  )\n  AND amount > 0\n  AND icustay_id IS NOT NULL\n  GROUP BY icustay_id\n),\ncumulative AS (\n  SELECT\n    sum(amount) over (PARTITION BY icustay_id ORDER BY charttime DESC) AS amount\n    , amountuom\n    , icustay_id\n    , charttime\n    , DATETIME_DIFF(lag(charttime) over (PARTITION BY icustay_id ORDER BY charttime ASC), charttime, 'HOUR') AS delta\n  FROM raw_ffp\n)\n-- We consider any transfusions started within 1 hr of the last one\n-- to be part of the same event\nSELECT\n    cm.icustay_id\n  , cm.charttime\n  , ROUND(CAST(cm.amount AS numeric) - CASE\n      WHEN ROW_NUMBER() OVER w = 1 THEN CAST(0 AS numeric)\n      ELSE cast(lag(cm.amount) OVER w AS numeric)\n    END, 2) AS amount\n  , ROUND(CAST(cm.amount AS numeric) + CASE\n      WHEN pre.amount IS NULL THEN CAST(0 AS numeric)\n      ELSE CAST(pre.amount AS numeric)\n    END, 2) AS totalamount\n  , cm.amountuom\nFROM cumulative AS cm\nLEFT JOIN pre_icu_ffp AS pre\n  USING (icustay_id)\nWHERE delta IS NULL OR delta < -1\nWINDOW w AS (PARTITION BY cm.icustay_id ORDER BY cm.charttime DESC)\nORDER BY icustay_id, charttime",
        "tables": [
            "mimiciii_clinical.inputevents_cv",
            "mimiciii_clinical.inputevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.amountuom",
                "mimiciii_clinical.inputevents_cv.cgid",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.hadm_id",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.linkorderid",
                "mimiciii_clinical.inputevents_cv.newbottle",
                "mimiciii_clinical.inputevents_cv.orderid",
                "mimiciii_clinical.inputevents_cv.originalamount",
                "mimiciii_clinical.inputevents_cv.originalamountuom",
                "mimiciii_clinical.inputevents_cv.originalrate",
                "mimiciii_clinical.inputevents_cv.originalrateuom",
                "mimiciii_clinical.inputevents_cv.originalroute",
                "mimiciii_clinical.inputevents_cv.originalsite",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.rateuom",
                "mimiciii_clinical.inputevents_cv.row_id",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_cv.storetime",
                "mimiciii_clinical.inputevents_cv.subject_id",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.amountuom",
                "mimiciii_clinical.inputevents_mv.cancelreason",
                "mimiciii_clinical.inputevents_mv.cgid",
                "mimiciii_clinical.inputevents_mv.comments_canceledby",
                "mimiciii_clinical.inputevents_mv.comments_date",
                "mimiciii_clinical.inputevents_mv.comments_editedby",
                "mimiciii_clinical.inputevents_mv.continueinnextdept",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.hadm_id",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.isopenbag",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.ordercategorydescription",
                "mimiciii_clinical.inputevents_mv.ordercategoryname",
                "mimiciii_clinical.inputevents_mv.ordercomponenttypedescription",
                "mimiciii_clinical.inputevents_mv.orderid",
                "mimiciii_clinical.inputevents_mv.originalamount",
                "mimiciii_clinical.inputevents_mv.originalrate",
                "mimiciii_clinical.inputevents_mv.patientweight",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.rateuom",
                "mimiciii_clinical.inputevents_mv.row_id",
                "mimiciii_clinical.inputevents_mv.secondaryordercategoryname",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.inputevents_mv.storetime",
                "mimiciii_clinical.inputevents_mv.subject_id",
                "mimiciii_clinical.inputevents_mv.totalamount",
                "mimiciii_clinical.inputevents_mv.totalamountuom"
            ],
            "charttime": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.amountuom",
                "mimiciii_clinical.inputevents_cv.cgid",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.hadm_id",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.linkorderid",
                "mimiciii_clinical.inputevents_cv.newbottle",
                "mimiciii_clinical.inputevents_cv.orderid",
                "mimiciii_clinical.inputevents_cv.originalamount",
                "mimiciii_clinical.inputevents_cv.originalamountuom",
                "mimiciii_clinical.inputevents_cv.originalrate",
                "mimiciii_clinical.inputevents_cv.originalrateuom",
                "mimiciii_clinical.inputevents_cv.originalroute",
                "mimiciii_clinical.inputevents_cv.originalsite",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.rateuom",
                "mimiciii_clinical.inputevents_cv.row_id",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_cv.storetime",
                "mimiciii_clinical.inputevents_cv.subject_id",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.amountuom",
                "mimiciii_clinical.inputevents_mv.cancelreason",
                "mimiciii_clinical.inputevents_mv.cgid",
                "mimiciii_clinical.inputevents_mv.comments_canceledby",
                "mimiciii_clinical.inputevents_mv.comments_date",
                "mimiciii_clinical.inputevents_mv.comments_editedby",
                "mimiciii_clinical.inputevents_mv.continueinnextdept",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.hadm_id",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.isopenbag",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.ordercategorydescription",
                "mimiciii_clinical.inputevents_mv.ordercategoryname",
                "mimiciii_clinical.inputevents_mv.ordercomponenttypedescription",
                "mimiciii_clinical.inputevents_mv.orderid",
                "mimiciii_clinical.inputevents_mv.originalamount",
                "mimiciii_clinical.inputevents_mv.originalrate",
                "mimiciii_clinical.inputevents_mv.patientweight",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.rateuom",
                "mimiciii_clinical.inputevents_mv.row_id",
                "mimiciii_clinical.inputevents_mv.secondaryordercategoryname",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.inputevents_mv.storetime",
                "mimiciii_clinical.inputevents_mv.subject_id",
                "mimiciii_clinical.inputevents_mv.totalamount",
                "mimiciii_clinical.inputevents_mv.totalamountuom"
            ],
            "amount": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.amountuom",
                "mimiciii_clinical.inputevents_cv.cgid",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.hadm_id",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.linkorderid",
                "mimiciii_clinical.inputevents_cv.newbottle",
                "mimiciii_clinical.inputevents_cv.orderid",
                "mimiciii_clinical.inputevents_cv.originalamount",
                "mimiciii_clinical.inputevents_cv.originalamountuom",
                "mimiciii_clinical.inputevents_cv.originalrate",
                "mimiciii_clinical.inputevents_cv.originalrateuom",
                "mimiciii_clinical.inputevents_cv.originalroute",
                "mimiciii_clinical.inputevents_cv.originalsite",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.rateuom",
                "mimiciii_clinical.inputevents_cv.row_id",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_cv.storetime",
                "mimiciii_clinical.inputevents_cv.subject_id",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.amountuom",
                "mimiciii_clinical.inputevents_mv.cancelreason",
                "mimiciii_clinical.inputevents_mv.cgid",
                "mimiciii_clinical.inputevents_mv.comments_canceledby",
                "mimiciii_clinical.inputevents_mv.comments_date",
                "mimiciii_clinical.inputevents_mv.comments_editedby",
                "mimiciii_clinical.inputevents_mv.continueinnextdept",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.hadm_id",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.isopenbag",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.ordercategorydescription",
                "mimiciii_clinical.inputevents_mv.ordercategoryname",
                "mimiciii_clinical.inputevents_mv.ordercomponenttypedescription",
                "mimiciii_clinical.inputevents_mv.orderid",
                "mimiciii_clinical.inputevents_mv.originalamount",
                "mimiciii_clinical.inputevents_mv.originalrate",
                "mimiciii_clinical.inputevents_mv.patientweight",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.rateuom",
                "mimiciii_clinical.inputevents_mv.row_id",
                "mimiciii_clinical.inputevents_mv.secondaryordercategoryname",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.inputevents_mv.storetime",
                "mimiciii_clinical.inputevents_mv.subject_id",
                "mimiciii_clinical.inputevents_mv.totalamount",
                "mimiciii_clinical.inputevents_mv.totalamountuom"
            ],
            "totalamount": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.amountuom",
                "mimiciii_clinical.inputevents_cv.cgid",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.hadm_id",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.linkorderid",
                "mimiciii_clinical.inputevents_cv.newbottle",
                "mimiciii_clinical.inputevents_cv.orderid",
                "mimiciii_clinical.inputevents_cv.originalamount",
                "mimiciii_clinical.inputevents_cv.originalamountuom",
                "mimiciii_clinical.inputevents_cv.originalrate",
                "mimiciii_clinical.inputevents_cv.originalrateuom",
                "mimiciii_clinical.inputevents_cv.originalroute",
                "mimiciii_clinical.inputevents_cv.originalsite",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.rateuom",
                "mimiciii_clinical.inputevents_cv.row_id",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_cv.storetime",
                "mimiciii_clinical.inputevents_cv.subject_id",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.amountuom",
                "mimiciii_clinical.inputevents_mv.cancelreason",
                "mimiciii_clinical.inputevents_mv.cgid",
                "mimiciii_clinical.inputevents_mv.comments_canceledby",
                "mimiciii_clinical.inputevents_mv.comments_date",
                "mimiciii_clinical.inputevents_mv.comments_editedby",
                "mimiciii_clinical.inputevents_mv.continueinnextdept",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.hadm_id",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.isopenbag",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.ordercategorydescription",
                "mimiciii_clinical.inputevents_mv.ordercategoryname",
                "mimiciii_clinical.inputevents_mv.ordercomponenttypedescription",
                "mimiciii_clinical.inputevents_mv.orderid",
                "mimiciii_clinical.inputevents_mv.originalamount",
                "mimiciii_clinical.inputevents_mv.originalrate",
                "mimiciii_clinical.inputevents_mv.patientweight",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.rateuom",
                "mimiciii_clinical.inputevents_mv.row_id",
                "mimiciii_clinical.inputevents_mv.secondaryordercategoryname",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.inputevents_mv.storetime",
                "mimiciii_clinical.inputevents_mv.subject_id",
                "mimiciii_clinical.inputevents_mv.totalamount",
                "mimiciii_clinical.inputevents_mv.totalamountuom"
            ],
            "amountuom": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.amountuom",
                "mimiciii_clinical.inputevents_cv.cgid",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.hadm_id",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.linkorderid",
                "mimiciii_clinical.inputevents_cv.newbottle",
                "mimiciii_clinical.inputevents_cv.orderid",
                "mimiciii_clinical.inputevents_cv.originalamount",
                "mimiciii_clinical.inputevents_cv.originalamountuom",
                "mimiciii_clinical.inputevents_cv.originalrate",
                "mimiciii_clinical.inputevents_cv.originalrateuom",
                "mimiciii_clinical.inputevents_cv.originalroute",
                "mimiciii_clinical.inputevents_cv.originalsite",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.rateuom",
                "mimiciii_clinical.inputevents_cv.row_id",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_cv.storetime",
                "mimiciii_clinical.inputevents_cv.subject_id",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.amountuom",
                "mimiciii_clinical.inputevents_mv.cancelreason",
                "mimiciii_clinical.inputevents_mv.cgid",
                "mimiciii_clinical.inputevents_mv.comments_canceledby",
                "mimiciii_clinical.inputevents_mv.comments_date",
                "mimiciii_clinical.inputevents_mv.comments_editedby",
                "mimiciii_clinical.inputevents_mv.continueinnextdept",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.hadm_id",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.isopenbag",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.ordercategorydescription",
                "mimiciii_clinical.inputevents_mv.ordercategoryname",
                "mimiciii_clinical.inputevents_mv.ordercomponenttypedescription",
                "mimiciii_clinical.inputevents_mv.orderid",
                "mimiciii_clinical.inputevents_mv.originalamount",
                "mimiciii_clinical.inputevents_mv.originalrate",
                "mimiciii_clinical.inputevents_mv.patientweight",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.rateuom",
                "mimiciii_clinical.inputevents_mv.row_id",
                "mimiciii_clinical.inputevents_mv.secondaryordercategoryname",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.inputevents_mv.storetime",
                "mimiciii_clinical.inputevents_mv.subject_id",
                "mimiciii_clinical.inputevents_mv.totalamount",
                "mimiciii_clinical.inputevents_mv.totalamountuom"
            ]
        },
        "table_name": "mimiciii_clinical.ffp_transfusion",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "cm.icustay_id",
                "cm.charttime",
                "(round(((cm.amount)::numeric - CASE WHEN (row_number() OVER (?) = 1) THEN '0'::numeric ELSE (lag(cm.amount) OVER (?))::numeric END), 2))",
                "(round(((cm.amount)::numeric + CASE WHEN (pre.amount IS NULL) THEN '0'::numeric ELSE (pre.amount)::numeric END), 2))",
                "cm.amountuom"
            ],
            "Sort Key": [
                "cm.icustay_id",
                "cm.charttime"
            ],
            "Plans": [
                {
                    "Node Type": "Append",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE raw_ffp",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "Index Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Scan Direction": "Forward",
                            "Index Name": "inputevents_cv_idx05",
                            "Relation Name": "inputevents_cv",
                            "Schema": "mimiciii_clinical",
                            "Alias": "inputevents_cv",
                            "Output": [
                                "CASE WHEN (inputevents_cv.amount IS NOT NULL) THEN inputevents_cv.amount WHEN (inputevents_cv.stopped IS NOT NULL) THEN '0'::double precision ELSE '200'::double precision END",
                                "inputevents_cv.amountuom",
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime"
                            ],
                            "Index Cond": "(inputevents_cv.itemid = ANY ('{30005,30180}'::integer[]))",
                            "Filter": "((inputevents_cv.icustay_id IS NOT NULL) AND (inputevents_cv.amount > '0'::double precision))"
                        },
                        {
                            "Node Type": "Bitmap Heap Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Relation Name": "inputevents_mv",
                            "Schema": "mimiciii_clinical",
                            "Alias": "inputevents_mv",
                            "Output": [
                                "inputevents_mv.amount",
                                "inputevents_mv.amountuom",
                                "inputevents_mv.icustay_id",
                                "inputevents_mv.endtime"
                            ],
                            "Recheck Cond": "(inputevents_mv.itemid = 220970)",
                            "Filter": "((inputevents_mv.icustay_id IS NOT NULL) AND (inputevents_mv.amount > '0'::double precision))",
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Index Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Index Name": "inputevents_mv_idx05",
                                    "Index Cond": "(inputevents_mv.itemid = 220970)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE pre_icu_ffp",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "Aggregate",
                            "Strategy": "Hashed",
                            "Partial Mode": "Simple",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "sum(inputevents_cv_1.amount)",
                                "inputevents_cv_1.icustay_id"
                            ],
                            "Group Key": [
                                "inputevents_cv_1.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "inputevents_cv",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "inputevents_cv_1",
                                    "Output": [
                                        "inputevents_cv_1.row_id",
                                        "inputevents_cv_1.subject_id",
                                        "inputevents_cv_1.hadm_id",
                                        "inputevents_cv_1.icustay_id",
                                        "inputevents_cv_1.charttime",
                                        "inputevents_cv_1.itemid",
                                        "inputevents_cv_1.amount",
                                        "inputevents_cv_1.amountuom",
                                        "inputevents_cv_1.rate",
                                        "inputevents_cv_1.rateuom",
                                        "inputevents_cv_1.storetime",
                                        "inputevents_cv_1.cgid",
                                        "inputevents_cv_1.orderid",
                                        "inputevents_cv_1.linkorderid",
                                        "inputevents_cv_1.stopped",
                                        "inputevents_cv_1.newbottle",
                                        "inputevents_cv_1.originalamount",
                                        "inputevents_cv_1.originalamountuom",
                                        "inputevents_cv_1.originalroute",
                                        "inputevents_cv_1.originalrate",
                                        "inputevents_cv_1.originalrateuom",
                                        "inputevents_cv_1.originalsite"
                                    ],
                                    "Recheck Cond": "(inputevents_cv_1.itemid = ANY ('{44172,44236,46410,46418,46684,44819,46530,44044,46122,45669,42323}'::integer[]))",
                                    "Filter": "((inputevents_cv_1.icustay_id IS NOT NULL) AND (inputevents_cv_1.amount > '0'::double precision))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "inputevents_cv_idx05",
                                            "Index Cond": "(inputevents_cv_1.itemid = ANY ('{44172,44236,46410,46418,46684,44819,46530,44044,46122,45669,42323}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Aggregate",
                            "Strategy": "Hashed",
                            "Partial Mode": "Simple",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "sum(inputevents_mv_1.amount)",
                                "inputevents_mv_1.icustay_id"
                            ],
                            "Group Key": [
                                "inputevents_mv_1.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "inputevents_mv",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "inputevents_mv_1",
                                    "Output": [
                                        "inputevents_mv_1.row_id",
                                        "inputevents_mv_1.subject_id",
                                        "inputevents_mv_1.hadm_id",
                                        "inputevents_mv_1.icustay_id",
                                        "inputevents_mv_1.starttime",
                                        "inputevents_mv_1.endtime",
                                        "inputevents_mv_1.itemid",
                                        "inputevents_mv_1.amount",
                                        "inputevents_mv_1.amountuom",
                                        "inputevents_mv_1.rate",
                                        "inputevents_mv_1.rateuom",
                                        "inputevents_mv_1.storetime",
                                        "inputevents_mv_1.cgid",
                                        "inputevents_mv_1.orderid",
                                        "inputevents_mv_1.linkorderid",
                                        "inputevents_mv_1.ordercategoryname",
                                        "inputevents_mv_1.secondaryordercategoryname",
                                        "inputevents_mv_1.ordercomponenttypedescription",
                                        "inputevents_mv_1.ordercategorydescription",
                                        "inputevents_mv_1.patientweight",
                                        "inputevents_mv_1.totalamount",
                                        "inputevents_mv_1.totalamountuom",
                                        "inputevents_mv_1.isopenbag",
                                        "inputevents_mv_1.continueinnextdept",
                                        "inputevents_mv_1.cancelreason",
                                        "inputevents_mv_1.statusdescription",
                                        "inputevents_mv_1.comments_editedby",
                                        "inputevents_mv_1.comments_canceledby",
                                        "inputevents_mv_1.comments_date",
                                        "inputevents_mv_1.originalamount",
                                        "inputevents_mv_1.originalrate"
                                    ],
                                    "Recheck Cond": "(inputevents_mv_1.itemid = 227072)",
                                    "Filter": "((inputevents_mv_1.icustay_id IS NOT NULL) AND (inputevents_mv_1.amount > '0'::double precision))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "inputevents_mv_idx05",
                                            "Index Cond": "(inputevents_mv_1.itemid = 227072)"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cumulative",
                    "Parallel Aware": false,
                    "Output": [
                        "(sum(raw_ffp.amount) OVER (?))",
                        "raw_ffp.amountuom",
                        "raw_ffp.icustay_id",
                        "raw_ffp.charttime",
                        "datetime_diff(lag(raw_ffp.charttime) OVER (?), raw_ffp.charttime, 'HOUR'::text)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "raw_ffp.icustay_id",
                                "raw_ffp.charttime",
                                "raw_ffp.amount",
                                "raw_ffp.amountuom",
                                "(sum(raw_ffp.amount) OVER (?))"
                            ],
                            "Sort Key": [
                                "raw_ffp.icustay_id",
                                "raw_ffp.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "WindowAgg",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "raw_ffp.icustay_id",
                                        "raw_ffp.charttime",
                                        "raw_ffp.amount",
                                        "raw_ffp.amountuom",
                                        "sum(raw_ffp.amount) OVER (?)"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "raw_ffp.icustay_id",
                                                "raw_ffp.charttime",
                                                "raw_ffp.amount",
                                                "raw_ffp.amountuom"
                                            ],
                                            "Sort Key": [
                                                "raw_ffp.icustay_id",
                                                "raw_ffp.charttime DESC"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "raw_ffp",
                                                    "Alias": "raw_ffp",
                                                    "Output": [
                                                        "raw_ffp.icustay_id",
                                                        "raw_ffp.charttime",
                                                        "raw_ffp.amount",
                                                        "raw_ffp.amountuom"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "cm.icustay_id",
                        "cm.charttime",
                        "round(((cm.amount)::numeric - CASE WHEN (row_number() OVER (?) = 1) THEN '0'::numeric ELSE (lag(cm.amount) OVER (?))::numeric END), 2)",
                        "round(((cm.amount)::numeric + CASE WHEN (pre.amount IS NULL) THEN '0'::numeric ELSE (pre.amount)::numeric END), 2)",
                        "cm.amountuom"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "cm.icustay_id",
                                "cm.charttime",
                                "cm.amount",
                                "pre.amount",
                                "cm.amountuom"
                            ],
                            "Sort Key": [
                                "cm.icustay_id",
                                "cm.charttime DESC"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Merge Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Left",
                                    "Output": [
                                        "cm.icustay_id",
                                        "cm.charttime",
                                        "cm.amount",
                                        "pre.amount",
                                        "cm.amountuom"
                                    ],
                                    "Inner Unique": false,
                                    "Merge Cond": "(cm.icustay_id = pre.icustay_id)",
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "cm.icustay_id",
                                                "cm.charttime",
                                                "cm.amount",
                                                "cm.amountuom"
                                            ],
                                            "Sort Key": [
                                                "cm.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "cumulative",
                                                    "Alias": "cm",
                                                    "Output": [
                                                        "cm.icustay_id",
                                                        "cm.charttime",
                                                        "cm.amount",
                                                        "cm.amountuom"
                                                    ],
                                                    "Filter": "((cm.delta IS NULL) OR (cm.delta < '-1'::numeric))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "pre.amount",
                                                "pre.icustay_id"
                                            ],
                                            "Sort Key": [
                                                "pre.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "pre_icu_ffp",
                                                    "Alias": "pre",
                                                    "Output": [
                                                        "pre.amount",
                                                        "pre.icustay_id"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.rbc_transfusion": {
        "sql": "-- Retrieves instances of red blood cell transfusions\nwith raw_rbc as (\n  SELECT\n      CASE\n        WHEN amount IS NOT NULL THEN amount\n        WHEN stopped IS NOT NULL THEN 0\n        -- impute 375 mL when unit is not documented\n        ELSE 375\n      END AS amount\n    , amountuom\n    , icustay_id\n    , charttime\n  FROM inputevents_cv\n  WHERE itemid IN\n  (\n    30179,  -- PRBC's\n    30001,  -- Packed RBC's\n    30004   -- Washed PRBC's\n  )\n  AND icustay_id IS NOT NULL\n  UNION ALL\n  SELECT amount\n    , amountuom\n    , icustay_id\n    , endtime AS charttime\n  FROM inputevents_mv\n  WHERE itemid in\n  (\n    225168   -- Packed Red Blood Cells\n  )\n  AND amount > 0\n  AND icustay_id IS NOT NULL\n),\npre_icu_rbc as (\n  SELECT\n    sum(amount) as amount, icustay_id\n  FROM inputevents_cv\n  WHERE itemid IN (\n    42324,  -- er prbc\n    42588,  -- VICU PRBC\n    42239,  -- CC7 PRBC\n    46407,  -- ED PRBC\n    46612,  -- E.R. prbc\n    46124,  -- er in prbc\n    42740   -- prbc in er\n  )\n  AND amount > 0\n  AND icustay_id IS NOT NULL\n  GROUP BY icustay_id\n  UNION ALL\n  SELECT\n    sum(amount) as amount, icustay_id\n  FROM inputevents_mv\n  WHERE itemid IN (\n    227070  -- PACU Packed RBC Intake\n  )\n  AND amount > 0\n  AND icustay_id IS NOT NULL\n  GROUP BY icustay_id\n),\ncumulative AS (\n  SELECT\n    sum(amount) over (PARTITION BY icustay_id ORDER BY charttime DESC) AS amount\n    , amountuom\n    , icustay_id\n    , charttime\n    , DATETIME_DIFF(lag(charttime) over (PARTITION BY icustay_id ORDER BY charttime ASC), charttime, 'HOUR') AS delta\n  FROM raw_rbc\n)\n-- We consider any transfusions started within 1 hr of the last one\n-- to be part of the same event\nSELECT\n    cm.icustay_id\n  , cm.charttime\n  , ROUND(CAST(cm.amount AS numeric) - CASE\n      WHEN ROW_NUMBER() OVER w = 1 THEN CAST(0 AS numeric)\n      ELSE CAST(lag(cm.amount) OVER w AS numeric)\n    END, 2) AS amount\n  , ROUND(CAST(cm.amount AS numeric) + CASE\n      WHEN CAST(pre.amount AS numeric) IS NULL THEN CAST(0 AS numeric)\n      ELSE CAST(pre.amount AS numeric)\n    END, 2) AS totalamount\n  , cm.amountuom\nFROM cumulative AS cm\nLEFT JOIN pre_icu_rbc AS pre\n  USING (icustay_id)\nWHERE delta IS NULL OR delta < -1\nWINDOW w AS (PARTITION BY cm.icustay_id ORDER BY cm.charttime DESC)\nORDER BY icustay_id, charttime",
        "tables": [
            "mimiciii_clinical.inputevents_cv",
            "mimiciii_clinical.inputevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.amountuom",
                "mimiciii_clinical.inputevents_cv.cgid",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.hadm_id",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.linkorderid",
                "mimiciii_clinical.inputevents_cv.newbottle",
                "mimiciii_clinical.inputevents_cv.orderid",
                "mimiciii_clinical.inputevents_cv.originalamount",
                "mimiciii_clinical.inputevents_cv.originalamountuom",
                "mimiciii_clinical.inputevents_cv.originalrate",
                "mimiciii_clinical.inputevents_cv.originalrateuom",
                "mimiciii_clinical.inputevents_cv.originalroute",
                "mimiciii_clinical.inputevents_cv.originalsite",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.rateuom",
                "mimiciii_clinical.inputevents_cv.row_id",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_cv.storetime",
                "mimiciii_clinical.inputevents_cv.subject_id",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.amountuom",
                "mimiciii_clinical.inputevents_mv.cancelreason",
                "mimiciii_clinical.inputevents_mv.cgid",
                "mimiciii_clinical.inputevents_mv.comments_canceledby",
                "mimiciii_clinical.inputevents_mv.comments_date",
                "mimiciii_clinical.inputevents_mv.comments_editedby",
                "mimiciii_clinical.inputevents_mv.continueinnextdept",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.hadm_id",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.isopenbag",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.ordercategorydescription",
                "mimiciii_clinical.inputevents_mv.ordercategoryname",
                "mimiciii_clinical.inputevents_mv.ordercomponenttypedescription",
                "mimiciii_clinical.inputevents_mv.orderid",
                "mimiciii_clinical.inputevents_mv.originalamount",
                "mimiciii_clinical.inputevents_mv.originalrate",
                "mimiciii_clinical.inputevents_mv.patientweight",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.rateuom",
                "mimiciii_clinical.inputevents_mv.row_id",
                "mimiciii_clinical.inputevents_mv.secondaryordercategoryname",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.inputevents_mv.storetime",
                "mimiciii_clinical.inputevents_mv.subject_id",
                "mimiciii_clinical.inputevents_mv.totalamount",
                "mimiciii_clinical.inputevents_mv.totalamountuom"
            ],
            "charttime": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.amountuom",
                "mimiciii_clinical.inputevents_cv.cgid",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.hadm_id",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.linkorderid",
                "mimiciii_clinical.inputevents_cv.newbottle",
                "mimiciii_clinical.inputevents_cv.orderid",
                "mimiciii_clinical.inputevents_cv.originalamount",
                "mimiciii_clinical.inputevents_cv.originalamountuom",
                "mimiciii_clinical.inputevents_cv.originalrate",
                "mimiciii_clinical.inputevents_cv.originalrateuom",
                "mimiciii_clinical.inputevents_cv.originalroute",
                "mimiciii_clinical.inputevents_cv.originalsite",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.rateuom",
                "mimiciii_clinical.inputevents_cv.row_id",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_cv.storetime",
                "mimiciii_clinical.inputevents_cv.subject_id",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.amountuom",
                "mimiciii_clinical.inputevents_mv.cancelreason",
                "mimiciii_clinical.inputevents_mv.cgid",
                "mimiciii_clinical.inputevents_mv.comments_canceledby",
                "mimiciii_clinical.inputevents_mv.comments_date",
                "mimiciii_clinical.inputevents_mv.comments_editedby",
                "mimiciii_clinical.inputevents_mv.continueinnextdept",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.hadm_id",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.isopenbag",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.ordercategorydescription",
                "mimiciii_clinical.inputevents_mv.ordercategoryname",
                "mimiciii_clinical.inputevents_mv.ordercomponenttypedescription",
                "mimiciii_clinical.inputevents_mv.orderid",
                "mimiciii_clinical.inputevents_mv.originalamount",
                "mimiciii_clinical.inputevents_mv.originalrate",
                "mimiciii_clinical.inputevents_mv.patientweight",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.rateuom",
                "mimiciii_clinical.inputevents_mv.row_id",
                "mimiciii_clinical.inputevents_mv.secondaryordercategoryname",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.inputevents_mv.storetime",
                "mimiciii_clinical.inputevents_mv.subject_id",
                "mimiciii_clinical.inputevents_mv.totalamount",
                "mimiciii_clinical.inputevents_mv.totalamountuom"
            ],
            "amount": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.amountuom",
                "mimiciii_clinical.inputevents_cv.cgid",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.hadm_id",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.linkorderid",
                "mimiciii_clinical.inputevents_cv.newbottle",
                "mimiciii_clinical.inputevents_cv.orderid",
                "mimiciii_clinical.inputevents_cv.originalamount",
                "mimiciii_clinical.inputevents_cv.originalamountuom",
                "mimiciii_clinical.inputevents_cv.originalrate",
                "mimiciii_clinical.inputevents_cv.originalrateuom",
                "mimiciii_clinical.inputevents_cv.originalroute",
                "mimiciii_clinical.inputevents_cv.originalsite",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.rateuom",
                "mimiciii_clinical.inputevents_cv.row_id",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_cv.storetime",
                "mimiciii_clinical.inputevents_cv.subject_id",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.amountuom",
                "mimiciii_clinical.inputevents_mv.cancelreason",
                "mimiciii_clinical.inputevents_mv.cgid",
                "mimiciii_clinical.inputevents_mv.comments_canceledby",
                "mimiciii_clinical.inputevents_mv.comments_date",
                "mimiciii_clinical.inputevents_mv.comments_editedby",
                "mimiciii_clinical.inputevents_mv.continueinnextdept",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.hadm_id",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.isopenbag",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.ordercategorydescription",
                "mimiciii_clinical.inputevents_mv.ordercategoryname",
                "mimiciii_clinical.inputevents_mv.ordercomponenttypedescription",
                "mimiciii_clinical.inputevents_mv.orderid",
                "mimiciii_clinical.inputevents_mv.originalamount",
                "mimiciii_clinical.inputevents_mv.originalrate",
                "mimiciii_clinical.inputevents_mv.patientweight",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.rateuom",
                "mimiciii_clinical.inputevents_mv.row_id",
                "mimiciii_clinical.inputevents_mv.secondaryordercategoryname",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.inputevents_mv.storetime",
                "mimiciii_clinical.inputevents_mv.subject_id",
                "mimiciii_clinical.inputevents_mv.totalamount",
                "mimiciii_clinical.inputevents_mv.totalamountuom"
            ],
            "totalamount": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.amountuom",
                "mimiciii_clinical.inputevents_cv.cgid",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.hadm_id",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.linkorderid",
                "mimiciii_clinical.inputevents_cv.newbottle",
                "mimiciii_clinical.inputevents_cv.orderid",
                "mimiciii_clinical.inputevents_cv.originalamount",
                "mimiciii_clinical.inputevents_cv.originalamountuom",
                "mimiciii_clinical.inputevents_cv.originalrate",
                "mimiciii_clinical.inputevents_cv.originalrateuom",
                "mimiciii_clinical.inputevents_cv.originalroute",
                "mimiciii_clinical.inputevents_cv.originalsite",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.rateuom",
                "mimiciii_clinical.inputevents_cv.row_id",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_cv.storetime",
                "mimiciii_clinical.inputevents_cv.subject_id",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.amountuom",
                "mimiciii_clinical.inputevents_mv.cancelreason",
                "mimiciii_clinical.inputevents_mv.cgid",
                "mimiciii_clinical.inputevents_mv.comments_canceledby",
                "mimiciii_clinical.inputevents_mv.comments_date",
                "mimiciii_clinical.inputevents_mv.comments_editedby",
                "mimiciii_clinical.inputevents_mv.continueinnextdept",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.hadm_id",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.isopenbag",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.ordercategorydescription",
                "mimiciii_clinical.inputevents_mv.ordercategoryname",
                "mimiciii_clinical.inputevents_mv.ordercomponenttypedescription",
                "mimiciii_clinical.inputevents_mv.orderid",
                "mimiciii_clinical.inputevents_mv.originalamount",
                "mimiciii_clinical.inputevents_mv.originalrate",
                "mimiciii_clinical.inputevents_mv.patientweight",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.rateuom",
                "mimiciii_clinical.inputevents_mv.row_id",
                "mimiciii_clinical.inputevents_mv.secondaryordercategoryname",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.inputevents_mv.storetime",
                "mimiciii_clinical.inputevents_mv.subject_id",
                "mimiciii_clinical.inputevents_mv.totalamount",
                "mimiciii_clinical.inputevents_mv.totalamountuom"
            ],
            "amountuom": [
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.amountuom",
                "mimiciii_clinical.inputevents_cv.cgid",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.hadm_id",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.linkorderid",
                "mimiciii_clinical.inputevents_cv.newbottle",
                "mimiciii_clinical.inputevents_cv.orderid",
                "mimiciii_clinical.inputevents_cv.originalamount",
                "mimiciii_clinical.inputevents_cv.originalamountuom",
                "mimiciii_clinical.inputevents_cv.originalrate",
                "mimiciii_clinical.inputevents_cv.originalrateuom",
                "mimiciii_clinical.inputevents_cv.originalroute",
                "mimiciii_clinical.inputevents_cv.originalsite",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_cv.rateuom",
                "mimiciii_clinical.inputevents_cv.row_id",
                "mimiciii_clinical.inputevents_cv.stopped",
                "mimiciii_clinical.inputevents_cv.storetime",
                "mimiciii_clinical.inputevents_cv.subject_id",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.amountuom",
                "mimiciii_clinical.inputevents_mv.cancelreason",
                "mimiciii_clinical.inputevents_mv.cgid",
                "mimiciii_clinical.inputevents_mv.comments_canceledby",
                "mimiciii_clinical.inputevents_mv.comments_date",
                "mimiciii_clinical.inputevents_mv.comments_editedby",
                "mimiciii_clinical.inputevents_mv.continueinnextdept",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.hadm_id",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.isopenbag",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.linkorderid",
                "mimiciii_clinical.inputevents_mv.ordercategorydescription",
                "mimiciii_clinical.inputevents_mv.ordercategoryname",
                "mimiciii_clinical.inputevents_mv.ordercomponenttypedescription",
                "mimiciii_clinical.inputevents_mv.orderid",
                "mimiciii_clinical.inputevents_mv.originalamount",
                "mimiciii_clinical.inputevents_mv.originalrate",
                "mimiciii_clinical.inputevents_mv.patientweight",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.rateuom",
                "mimiciii_clinical.inputevents_mv.row_id",
                "mimiciii_clinical.inputevents_mv.secondaryordercategoryname",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.inputevents_mv.storetime",
                "mimiciii_clinical.inputevents_mv.subject_id",
                "mimiciii_clinical.inputevents_mv.totalamount",
                "mimiciii_clinical.inputevents_mv.totalamountuom"
            ]
        },
        "table_name": "mimiciii_clinical.rbc_transfusion",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "cm.icustay_id",
                "cm.charttime",
                "(round(((cm.amount)::numeric - CASE WHEN (row_number() OVER (?) = 1) THEN '0'::numeric ELSE (lag(cm.amount) OVER (?))::numeric END), 2))",
                "(round(((cm.amount)::numeric + CASE WHEN ((pre.amount)::numeric IS NULL) THEN '0'::numeric ELSE (pre.amount)::numeric END), 2))",
                "cm.amountuom"
            ],
            "Sort Key": [
                "cm.icustay_id",
                "cm.charttime"
            ],
            "Plans": [
                {
                    "Node Type": "Append",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE raw_rbc",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "Index Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Scan Direction": "Forward",
                            "Index Name": "inputevents_cv_idx05",
                            "Relation Name": "inputevents_cv",
                            "Schema": "mimiciii_clinical",
                            "Alias": "inputevents_cv",
                            "Output": [
                                "CASE WHEN (inputevents_cv.amount IS NOT NULL) THEN inputevents_cv.amount WHEN (inputevents_cv.stopped IS NOT NULL) THEN '0'::double precision ELSE '375'::double precision END",
                                "inputevents_cv.amountuom",
                                "inputevents_cv.icustay_id",
                                "inputevents_cv.charttime"
                            ],
                            "Index Cond": "(inputevents_cv.itemid = ANY ('{30179,30001,30004}'::integer[]))",
                            "Filter": "(inputevents_cv.icustay_id IS NOT NULL)"
                        },
                        {
                            "Node Type": "Bitmap Heap Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Relation Name": "inputevents_mv",
                            "Schema": "mimiciii_clinical",
                            "Alias": "inputevents_mv",
                            "Output": [
                                "inputevents_mv.amount",
                                "inputevents_mv.amountuom",
                                "inputevents_mv.icustay_id",
                                "inputevents_mv.endtime"
                            ],
                            "Recheck Cond": "(inputevents_mv.itemid = 225168)",
                            "Filter": "((inputevents_mv.icustay_id IS NOT NULL) AND (inputevents_mv.amount > '0'::double precision))",
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Index Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Index Name": "inputevents_mv_idx05",
                                    "Index Cond": "(inputevents_mv.itemid = 225168)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE pre_icu_rbc",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "Aggregate",
                            "Strategy": "Hashed",
                            "Partial Mode": "Simple",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "sum(inputevents_cv_1.amount)",
                                "inputevents_cv_1.icustay_id"
                            ],
                            "Group Key": [
                                "inputevents_cv_1.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "inputevents_cv",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "inputevents_cv_1",
                                    "Output": [
                                        "inputevents_cv_1.row_id",
                                        "inputevents_cv_1.subject_id",
                                        "inputevents_cv_1.hadm_id",
                                        "inputevents_cv_1.icustay_id",
                                        "inputevents_cv_1.charttime",
                                        "inputevents_cv_1.itemid",
                                        "inputevents_cv_1.amount",
                                        "inputevents_cv_1.amountuom",
                                        "inputevents_cv_1.rate",
                                        "inputevents_cv_1.rateuom",
                                        "inputevents_cv_1.storetime",
                                        "inputevents_cv_1.cgid",
                                        "inputevents_cv_1.orderid",
                                        "inputevents_cv_1.linkorderid",
                                        "inputevents_cv_1.stopped",
                                        "inputevents_cv_1.newbottle",
                                        "inputevents_cv_1.originalamount",
                                        "inputevents_cv_1.originalamountuom",
                                        "inputevents_cv_1.originalroute",
                                        "inputevents_cv_1.originalrate",
                                        "inputevents_cv_1.originalrateuom",
                                        "inputevents_cv_1.originalsite"
                                    ],
                                    "Recheck Cond": "(inputevents_cv_1.itemid = ANY ('{42324,42588,42239,46407,46612,46124,42740}'::integer[]))",
                                    "Filter": "((inputevents_cv_1.icustay_id IS NOT NULL) AND (inputevents_cv_1.amount > '0'::double precision))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "inputevents_cv_idx05",
                                            "Index Cond": "(inputevents_cv_1.itemid = ANY ('{42324,42588,42239,46407,46612,46124,42740}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Aggregate",
                            "Strategy": "Hashed",
                            "Partial Mode": "Simple",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "Output": [
                                "sum(inputevents_mv_1.amount)",
                                "inputevents_mv_1.icustay_id"
                            ],
                            "Group Key": [
                                "inputevents_mv_1.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "inputevents_mv",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "inputevents_mv_1",
                                    "Output": [
                                        "inputevents_mv_1.row_id",
                                        "inputevents_mv_1.subject_id",
                                        "inputevents_mv_1.hadm_id",
                                        "inputevents_mv_1.icustay_id",
                                        "inputevents_mv_1.starttime",
                                        "inputevents_mv_1.endtime",
                                        "inputevents_mv_1.itemid",
                                        "inputevents_mv_1.amount",
                                        "inputevents_mv_1.amountuom",
                                        "inputevents_mv_1.rate",
                                        "inputevents_mv_1.rateuom",
                                        "inputevents_mv_1.storetime",
                                        "inputevents_mv_1.cgid",
                                        "inputevents_mv_1.orderid",
                                        "inputevents_mv_1.linkorderid",
                                        "inputevents_mv_1.ordercategoryname",
                                        "inputevents_mv_1.secondaryordercategoryname",
                                        "inputevents_mv_1.ordercomponenttypedescription",
                                        "inputevents_mv_1.ordercategorydescription",
                                        "inputevents_mv_1.patientweight",
                                        "inputevents_mv_1.totalamount",
                                        "inputevents_mv_1.totalamountuom",
                                        "inputevents_mv_1.isopenbag",
                                        "inputevents_mv_1.continueinnextdept",
                                        "inputevents_mv_1.cancelreason",
                                        "inputevents_mv_1.statusdescription",
                                        "inputevents_mv_1.comments_editedby",
                                        "inputevents_mv_1.comments_canceledby",
                                        "inputevents_mv_1.comments_date",
                                        "inputevents_mv_1.originalamount",
                                        "inputevents_mv_1.originalrate"
                                    ],
                                    "Recheck Cond": "(inputevents_mv_1.itemid = 227070)",
                                    "Filter": "((inputevents_mv_1.icustay_id IS NOT NULL) AND (inputevents_mv_1.amount > '0'::double precision))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "inputevents_mv_idx05",
                                            "Index Cond": "(inputevents_mv_1.itemid = 227070)"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cumulative",
                    "Parallel Aware": false,
                    "Output": [
                        "(sum(raw_rbc.amount) OVER (?))",
                        "raw_rbc.amountuom",
                        "raw_rbc.icustay_id",
                        "raw_rbc.charttime",
                        "datetime_diff(lag(raw_rbc.charttime) OVER (?), raw_rbc.charttime, 'HOUR'::text)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "raw_rbc.icustay_id",
                                "raw_rbc.charttime",
                                "raw_rbc.amount",
                                "raw_rbc.amountuom",
                                "(sum(raw_rbc.amount) OVER (?))"
                            ],
                            "Sort Key": [
                                "raw_rbc.icustay_id",
                                "raw_rbc.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "WindowAgg",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "raw_rbc.icustay_id",
                                        "raw_rbc.charttime",
                                        "raw_rbc.amount",
                                        "raw_rbc.amountuom",
                                        "sum(raw_rbc.amount) OVER (?)"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "raw_rbc.icustay_id",
                                                "raw_rbc.charttime",
                                                "raw_rbc.amount",
                                                "raw_rbc.amountuom"
                                            ],
                                            "Sort Key": [
                                                "raw_rbc.icustay_id",
                                                "raw_rbc.charttime DESC"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "raw_rbc",
                                                    "Alias": "raw_rbc",
                                                    "Output": [
                                                        "raw_rbc.icustay_id",
                                                        "raw_rbc.charttime",
                                                        "raw_rbc.amount",
                                                        "raw_rbc.amountuom"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "cm.icustay_id",
                        "cm.charttime",
                        "round(((cm.amount)::numeric - CASE WHEN (row_number() OVER (?) = 1) THEN '0'::numeric ELSE (lag(cm.amount) OVER (?))::numeric END), 2)",
                        "round(((cm.amount)::numeric + CASE WHEN ((pre.amount)::numeric IS NULL) THEN '0'::numeric ELSE (pre.amount)::numeric END), 2)",
                        "cm.amountuom"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "cm.icustay_id",
                                "cm.charttime",
                                "cm.amount",
                                "pre.amount",
                                "cm.amountuom"
                            ],
                            "Sort Key": [
                                "cm.icustay_id",
                                "cm.charttime DESC"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Merge Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Left",
                                    "Output": [
                                        "cm.icustay_id",
                                        "cm.charttime",
                                        "cm.amount",
                                        "pre.amount",
                                        "cm.amountuom"
                                    ],
                                    "Inner Unique": false,
                                    "Merge Cond": "(cm.icustay_id = pre.icustay_id)",
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "cm.icustay_id",
                                                "cm.charttime",
                                                "cm.amount",
                                                "cm.amountuom"
                                            ],
                                            "Sort Key": [
                                                "cm.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "cumulative",
                                                    "Alias": "cm",
                                                    "Output": [
                                                        "cm.icustay_id",
                                                        "cm.charttime",
                                                        "cm.amount",
                                                        "cm.amountuom"
                                                    ],
                                                    "Filter": "((cm.delta IS NULL) OR (cm.delta < '-1'::numeric))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "pre.amount",
                                                "pre.icustay_id"
                                            ],
                                            "Sort Key": [
                                                "pre.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "pre_icu_rbc",
                                                    "Alias": "pre",
                                                    "Output": [
                                                        "pre.amount",
                                                        "pre.icustay_id"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.urine_output": {
        "sql": "-- First we drop the table if it exists\nselect oe.icustay_id, oe.charttime\n, SUM(\n    -- we consider input of GU irrigant as a negative volume\n    case when oe.itemid = 227488 then -1*value\n    else value end\n  ) as value\nfrom outputevents oe\nwhere oe.itemid in\n(\n  -- these are the most frequently occurring urine output observations in CareVue\n  40055, -- \"Urine Out Foley\"\n  43175, -- \"Urine .\"\n  40069, -- \"Urine Out Void\"\n  40094, -- \"Urine Out Condom Cath\"\n  40715, -- \"Urine Out Suprapubic\"\n  40473, -- \"Urine Out IleoConduit\"\n  40085, -- \"Urine Out Incontinent\"\n  40057, -- \"Urine Out Rt Nephrostomy\"\n  40056, -- \"Urine Out Lt Nephrostomy\"\n  40405, -- \"Urine Out Other\"\n  40428, -- \"Urine Out Straight Cath\"\n  40086,--\tUrine Out Incontinent\n  40096, -- \"Urine Out Ureteral Stent #1\"\n  40651, -- \"Urine Out Ureteral Stent #2\"\n\n  -- these are the most frequently occurring urine output observations in MetaVision\n  226559, -- \"Foley\"\n  226560, -- \"Void\"\n  226561, -- \"Condom Cath\"\n  226584, -- \"Ileoconduit\"\n  226563, -- \"Suprapubic\"\n  226564, -- \"R Nephrostomy\"\n  226565, -- \"L Nephrostomy\"\n  226567, --\tStraight Cath\n  226557, -- R Ureteral Stent\n  226558, -- L Ureteral Stent\n  227488, -- GU Irrigant Volume In\n  227489  -- GU Irrigant/Urine Volume Out\n)\nand oe.value < 5000 -- sanity check on urine value\nand oe.icustay_id is not null\ngroup by icustay_id, charttime",
        "tables": [
            "mimiciii_clinical.outputevents"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.outputevents.icustay_id",
                "mimiciii_clinical.outputevents.itemid",
                "mimiciii_clinical.outputevents.value"
            ],
            "charttime": [
                "mimiciii_clinical.outputevents.charttime",
                "mimiciii_clinical.outputevents.icustay_id",
                "mimiciii_clinical.outputevents.itemid",
                "mimiciii_clinical.outputevents.value"
            ],
            "value": [
                "mimiciii_clinical.outputevents.icustay_id",
                "mimiciii_clinical.outputevents.itemid",
                "mimiciii_clinical.outputevents.value"
            ]
        },
        "table_name": "mimiciii_clinical.urine_output",
        "plan": {
            "Node Type": "Aggregate",
            "Strategy": "Sorted",
            "Partial Mode": "Finalize",
            "Parallel Aware": false,
            "Output": [
                "icustay_id",
                "charttime",
                "sum(CASE WHEN (itemid = 227488) THEN ('-1'::double precision * value) ELSE value END)"
            ],
            "Group Key": [
                "oe.icustay_id",
                "oe.charttime"
            ],
            "Plans": [
                {
                    "Node Type": "Gather Merge",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "icustay_id",
                        "charttime",
                        "(PARTIAL sum(CASE WHEN (itemid = 227488) THEN ('-1'::double precision * value) ELSE value END))"
                    ],
                    "Workers Planned": 2,
                    "Plans": [
                        {
                            "Node Type": "Aggregate",
                            "Strategy": "Sorted",
                            "Partial Mode": "Partial",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "icustay_id",
                                "charttime",
                                "PARTIAL sum(CASE WHEN (itemid = 227488) THEN ('-1'::double precision * value) ELSE value END)"
                            ],
                            "Group Key": [
                                "oe.icustay_id",
                                "oe.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "icustay_id",
                                        "charttime",
                                        "itemid",
                                        "value"
                                    ],
                                    "Sort Key": [
                                        "oe.icustay_id",
                                        "oe.charttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": true,
                                            "Relation Name": "outputevents",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "oe",
                                            "Output": [
                                                "icustay_id",
                                                "charttime",
                                                "itemid",
                                                "value"
                                            ],
                                            "Filter": "((oe.icustay_id IS NOT NULL) AND (oe.value < '5000'::double precision) AND (oe.itemid = ANY ('{40055,43175,40069,40094,40715,40473,40085,40057,40056,40405,40428,40086,40096,40651,226559,226560,226561,226584,226563,226564,226565,226567,226557,226558,227488,227489}'::integer[])))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.auroc": {
        "sql": "-- Calculate the AUROC of age for predicting in-hospital mortality\n-- You can easily calculate the AUROC of any model you'd like by:\n--  Replacing \"PRED\" with your predictor\n--  Replacing \"TAR\" with the target (*must* be a binary target)\n\nwith datatable as (\nselect\n  -- name the predictor \"PRED\"\n  cast(adm.admittime as date) - cast(pat.dob as date) as PRED -- age is our predictor\n  -- name the target variable \"TAR\"\n  , case when adm.deathtime is not null then 1 else 0 end as TAR -- in-hospital mortality\nFROM admissions adm\ninner join patients pat\n  on adm.subject_id = pat.subject_id\n)\n, datacs as (\nselect\n  TAR\n  -- calculate the cumulative sum of negative targets, then multiply by positive targets\n  -- this has the effect of returning 0 for negative targets, and the # of negative targets below each positive target\n  , TAR * SUM(1-TAR) OVER (ORDER BY PRED ASC ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS AUROC\nfrom datatable\n)\nselect\n  -- Calculate the AUROC as:\n  --    SUM( number of negative targets below each positive target )\n  -- /  number of possible negative/positive target pairs\n  round(sum(AUROC) / (sum(TAR)*sum(1-TAR)),4) as AUROC\nfrom datacs",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "auroc": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.deathtime",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.auroc",
        "plan": {
            "Node Type": "Aggregate",
            "Strategy": "Plain",
            "Partial Mode": "Simple",
            "Parallel Aware": false,
            "Output": [
                "round((sum(datacs.auroc) / ((sum(datacs.tar) * sum((1 - datacs.tar))))::numeric), 4)"
            ],
            "Plans": [
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE datatable",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "((adm.admittime)::date - (pat.dob)::date)",
                        "CASE WHEN (adm.deathtime IS NOT NULL) THEN 1 ELSE 0 END"
                    ],
                    "Inner Unique": true,
                    "Hash Cond": "(adm.subject_id = pat.subject_id)",
                    "Plans": [
                        {
                            "Node Type": "Seq Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "admissions",
                            "Schema": "mimiciii_clinical",
                            "Alias": "adm",
                            "Output": [
                                "adm.row_id",
                                "adm.subject_id",
                                "adm.hadm_id",
                                "adm.admittime",
                                "adm.dischtime",
                                "adm.deathtime",
                                "adm.admission_type",
                                "adm.admission_location",
                                "adm.discharge_location",
                                "adm.insurance",
                                "adm.language",
                                "adm.religion",
                                "adm.marital_status",
                                "adm.ethnicity",
                                "adm.edregtime",
                                "adm.edouttime",
                                "adm.diagnosis",
                                "adm.hospital_expire_flag",
                                "adm.has_chartevents_data"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "pat.dob",
                                "pat.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "patients",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "pat",
                                    "Output": [
                                        "pat.dob",
                                        "pat.subject_id"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE datacs",
                    "Parallel Aware": false,
                    "Output": [
                        "datatable.tar",
                        "(datatable.tar * sum((1 - datatable.tar)) OVER (?))",
                        "datatable.pred"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "datatable.pred",
                                "datatable.tar"
                            ],
                            "Sort Key": [
                                "datatable.pred"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "datatable",
                                    "Alias": "datatable",
                                    "Output": [
                                        "datatable.pred",
                                        "datatable.tar"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "CTE Name": "datacs",
                    "Alias": "datacs",
                    "Output": [
                        "datacs.tar",
                        "datacs.auroc"
                    ]
                }
            ]
        }
    },
    "model.mimic.kdigo_creatinine": {
        "sql": "-- Extract all creatinine values FROM labevents around patient's ICU stay\nwith cr as\n(\nselect\n    ie.icustay_id\n  , ie.intime, ie.outtime\n  , le.valuenum as creat\n  , le.charttime\n  FROM icustays ie\n  left join labevents le\n    on ie.subject_id = le.subject_id\n    and le.ITEMID = 50912\n    and le.VALUENUM is not null\n    and DATETIME_DIFF(le.charttime, ie.intime, 'HOUR') <= (7*24-6)\n    and le.CHARTTIME >= DATETIME_SUB(ie.intime, INTERVAL '6 HOUR')\n    and le.CHARTTIME <= DATETIME_ADD(ie.intime, INTERVAL '7 DAY')\n)\n-- add in the lowest value in the previous 48 hours/7 days\nSELECT\n  cr.icustay_id\n  , cr.charttime\n  , cr.creat\n  , MIN(cr48.creat) AS creat_low_past_48hr\n  , MIN(cr7.creat) AS creat_low_past_7day\nFROM cr\n-- add in all creatinine values in the last 48 hours\nLEFT JOIN cr cr48\n  ON cr.icustay_id = cr48.icustay_id\n  AND cr48.charttime <  cr.charttime\n  AND DATETIME_DIFF(cr.charttime, cr48.charttime, 'HOUR') <= 48\n-- add in all creatinine values in the last 7 days\nLEFT JOIN cr cr7\n  ON cr.icustay_id = cr7.icustay_id\n  AND cr7.charttime <  cr.charttime\n  AND DATETIME_DIFF(cr.charttime, cr7.charttime, 'DAY') <= 7\nGROUP BY cr.icustay_id, cr.charttime, cr.creat\nORDER BY cr.icustay_id, cr.charttime, cr.creat",
        "tables": [
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.labevents"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "charttime": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "creat": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "creat_low_past_48hr": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "creat_low_past_7day": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.subject_id",
                "mimiciii_clinical.labevents.valuenum"
            ]
        },
        "table_name": "mimiciii_clinical.kdigo_creatinine",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "cr.icustay_id",
                "cr.charttime",
                "cr.creat",
                "(min(cr48.creat))",
                "(min(cr7.creat))"
            ],
            "Sort Key": [
                "cr.icustay_id",
                "cr.charttime",
                "cr.creat"
            ],
            "Plans": [
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cr",
                    "Parallel Aware": false,
                    "Join Type": "Right",
                    "Output": [
                        "ie.icustay_id",
                        "ie.intime",
                        "ie.outtime",
                        "le.valuenum",
                        "le.charttime"
                    ],
                    "Inner Unique": false,
                    "Hash Cond": "(le.subject_id = ie.subject_id)",
                    "Join Filter": "((datetime_diff(le.charttime, ie.intime, 'HOUR'::text) <= '162'::numeric) AND (le.charttime >= datetime_sub(ie.intime, '06:00:00'::interval)) AND (le.charttime <= datetime_add(ie.intime, '7 days'::interval)))",
                    "Plans": [
                        {
                            "Node Type": "Bitmap Heap Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "labevents",
                            "Schema": "mimiciii_clinical",
                            "Alias": "le",
                            "Output": [
                                "le.row_id",
                                "le.subject_id",
                                "le.hadm_id",
                                "le.itemid",
                                "le.charttime",
                                "le.value",
                                "le.valuenum",
                                "le.valueuom",
                                "le.flag"
                            ],
                            "Recheck Cond": "(le.itemid = 50912)",
                            "Filter": "(le.valuenum IS NOT NULL)",
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Index Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Index Name": "labevents_idx03",
                                    "Index Cond": "(le.itemid = 50912)"
                                }
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "ie.icustay_id",
                                "ie.intime",
                                "ie.outtime",
                                "ie.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "icustays",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ie",
                                    "Output": [
                                        "ie.icustay_id",
                                        "ie.intime",
                                        "ie.outtime",
                                        "ie.subject_id"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "cr.icustay_id",
                        "cr.charttime",
                        "cr.creat",
                        "min(cr48.creat)",
                        "min(cr7.creat)"
                    ],
                    "Group Key": [
                        "cr.icustay_id",
                        "cr.charttime",
                        "cr.creat"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Merge Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Left",
                            "Output": [
                                "cr.icustay_id",
                                "cr.charttime",
                                "cr.creat",
                                "cr48.creat",
                                "cr7.creat"
                            ],
                            "Inner Unique": false,
                            "Merge Cond": "(cr.icustay_id = cr7.icustay_id)",
                            "Join Filter": "((cr7.charttime < cr.charttime) AND (datetime_diff(cr.charttime, cr7.charttime, 'DAY'::text) <= '7'::numeric))",
                            "Plans": [
                                {
                                    "Node Type": "Merge Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Left",
                                    "Output": [
                                        "cr.icustay_id",
                                        "cr.charttime",
                                        "cr.creat",
                                        "cr48.creat"
                                    ],
                                    "Inner Unique": false,
                                    "Merge Cond": "(cr.icustay_id = cr48.icustay_id)",
                                    "Join Filter": "((cr48.charttime < cr.charttime) AND (datetime_diff(cr.charttime, cr48.charttime, 'HOUR'::text) <= '48'::numeric))",
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "cr.icustay_id",
                                                "cr.charttime",
                                                "cr.creat"
                                            ],
                                            "Sort Key": [
                                                "cr.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "cr",
                                                    "Alias": "cr",
                                                    "Output": [
                                                        "cr.icustay_id",
                                                        "cr.charttime",
                                                        "cr.creat"
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "cr48.creat",
                                                "cr48.icustay_id",
                                                "cr48.charttime"
                                            ],
                                            "Sort Key": [
                                                "cr48.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "cr",
                                                    "Alias": "cr48",
                                                    "Output": [
                                                        "cr48.creat",
                                                        "cr48.icustay_id",
                                                        "cr48.charttime"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "cr7.creat",
                                        "cr7.icustay_id",
                                        "cr7.charttime"
                                    ],
                                    "Sort Key": [
                                        "cr7.icustay_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "cr",
                                            "Alias": "cr7",
                                            "Output": [
                                                "cr7.creat",
                                                "cr7.icustay_id",
                                                "cr7.charttime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.kdigo_stages": {
        "sql": "-- This query checks if the patient had AKI according to KDIGO.\n-- AKI is calculated every time a creatinine or urine output measurement occurs.\n-- Baseline creatinine is defined as the lowest creatinine in the past 7 days.\n\n-- get creatinine stages\nwith cr_stg AS\n(\n  SELECT\n    cr.icustay_id\n    , cr.charttime\n    , cr.creat\n    , case\n        -- 3x baseline\n        when cr.creat >= (cr.creat_low_past_7day*3.0) then 3\n        -- *OR* cr >= 4.0 with associated increase\n        when cr.creat >= 4\n        -- For patients reaching Stage 3 by SCr >4.0 mg/dl\n        -- require that the patient first achieve ... acute increase >= 0.3 within 48 hr\n        -- *or* an increase of >= 1.5 times baseline\n        and (cr.creat_low_past_48hr <= 3.7 OR cr.creat >= (1.5*cr.creat_low_past_7day))\n            then 3 \n        -- TODO: initiation of RRT\n        when cr.creat >= (cr.creat_low_past_7day*2.0) then 2\n        when cr.creat >= (cr.creat_low_past_48hr+0.3) then 1\n        when cr.creat >= (cr.creat_low_past_7day*1.5) then 1\n    else 0 end as aki_stage_creat\n  FROM \"mimic\".\"mimiciii_clinical\".\"kdigo_creatinine\" cr\n)\n-- stages for UO / creat\n, uo_stg as\n(\n  select\n      uo.icustay_id\n    , uo.charttime\n    , uo.weight\n    , uo.uo_rt_6hr\n    , uo.uo_rt_12hr\n    , uo.uo_rt_24hr\n    -- AKI stages according to urine output\n    , CASE\n        WHEN uo.uo_rt_6hr IS NULL THEN NULL\n        -- require patient to be in ICU for at least 6 hours to stage UO\n        WHEN uo.charttime <= DATETIME_ADD(ie.intime, INTERVAL '6' HOUR) THEN 0\n        -- require the UO rate to be calculated over half the period\n        -- i.e. for uo rate over 24 hours, require documentation at least 12 hr apart\n        WHEN uo.uo_tm_24hr >= 11 AND uo.uo_rt_24hr < 0.3 THEN 3\n        WHEN uo.uo_tm_12hr >= 5 AND uo.uo_rt_12hr = 0 THEN 3\n        WHEN uo.uo_tm_12hr >= 5 AND uo.uo_rt_12hr < 0.5 THEN 2\n        WHEN uo.uo_tm_6hr >= 2 AND uo.uo_rt_6hr  < 0.5 THEN 1\n    ELSE 0 END AS aki_stage_uo\n  from \"mimic\".\"mimiciii_clinical\".\"kdigo_uo\" uo\n  INNER JOIN icustays ie\n    ON uo.icustay_id = ie.icustay_id\n)\n-- get all charttimes documented\n, tm_stg AS\n(\n    SELECT\n      icustay_id, charttime\n    FROM cr_stg\n    UNION DISTINCT\n    SELECT\n      icustay_id, charttime\n    FROM uo_stg\n)\nselect\n    ie.icustay_id\n  , tm.charttime\n  , cr.creat\n  , cr.aki_stage_creat\n  , uo.uo_rt_6hr\n  , uo.uo_rt_12hr\n  , uo.uo_rt_24hr\n  , uo.aki_stage_uo\n  -- Classify AKI using both creatinine/urine output criteria\n  , GREATEST(\n      COALESCE(cr.aki_stage_creat, 0),\n      COALESCE(uo.aki_stage_uo, 0)\n    ) AS aki_stage\nFROM icustays ie\n-- get all possible charttimes as listed in tm_stg\nLEFT JOIN tm_stg tm\n  ON ie.icustay_id = tm.icustay_id\nLEFT JOIN cr_stg cr\n  ON ie.icustay_id = cr.icustay_id\n  AND tm.charttime = cr.charttime\nLEFT JOIN uo_stg uo\n  ON ie.icustay_id = uo.icustay_id\n  AND tm.charttime = uo.charttime\norder by ie.icustay_id, tm.charttime",
        "tables": [
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.kdigo_creatinine",
            "mimiciii_clinical.kdigo_uo"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.kdigo_creatinine.charttime",
                "mimiciii_clinical.kdigo_creatinine.icustay_id",
                "mimiciii_clinical.kdigo_uo.charttime",
                "mimiciii_clinical.kdigo_uo.icustay_id"
            ],
            "charttime": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.kdigo_creatinine.charttime",
                "mimiciii_clinical.kdigo_creatinine.icustay_id",
                "mimiciii_clinical.kdigo_uo.charttime",
                "mimiciii_clinical.kdigo_uo.icustay_id"
            ],
            "creat": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.kdigo_creatinine.charttime",
                "mimiciii_clinical.kdigo_creatinine.creat",
                "mimiciii_clinical.kdigo_creatinine.icustay_id",
                "mimiciii_clinical.kdigo_uo.charttime",
                "mimiciii_clinical.kdigo_uo.icustay_id"
            ],
            "aki_stage_creat": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.kdigo_creatinine.charttime",
                "mimiciii_clinical.kdigo_creatinine.creat",
                "mimiciii_clinical.kdigo_creatinine.creat_low_past_48hr",
                "mimiciii_clinical.kdigo_creatinine.creat_low_past_7day",
                "mimiciii_clinical.kdigo_creatinine.icustay_id",
                "mimiciii_clinical.kdigo_uo.charttime",
                "mimiciii_clinical.kdigo_uo.icustay_id"
            ],
            "uo_rt_6hr": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.kdigo_creatinine.charttime",
                "mimiciii_clinical.kdigo_creatinine.icustay_id",
                "mimiciii_clinical.kdigo_uo.charttime",
                "mimiciii_clinical.kdigo_uo.icustay_id",
                "mimiciii_clinical.kdigo_uo.uo_rt_6hr"
            ],
            "uo_rt_12hr": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.kdigo_creatinine.charttime",
                "mimiciii_clinical.kdigo_creatinine.icustay_id",
                "mimiciii_clinical.kdigo_uo.charttime",
                "mimiciii_clinical.kdigo_uo.icustay_id",
                "mimiciii_clinical.kdigo_uo.uo_rt_12hr"
            ],
            "uo_rt_24hr": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.kdigo_creatinine.charttime",
                "mimiciii_clinical.kdigo_creatinine.icustay_id",
                "mimiciii_clinical.kdigo_uo.charttime",
                "mimiciii_clinical.kdigo_uo.icustay_id",
                "mimiciii_clinical.kdigo_uo.uo_rt_24hr"
            ],
            "aki_stage_uo": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.kdigo_creatinine.charttime",
                "mimiciii_clinical.kdigo_creatinine.icustay_id",
                "mimiciii_clinical.kdigo_uo.charttime",
                "mimiciii_clinical.kdigo_uo.icustay_id",
                "mimiciii_clinical.kdigo_uo.uo_rt_12hr",
                "mimiciii_clinical.kdigo_uo.uo_rt_24hr",
                "mimiciii_clinical.kdigo_uo.uo_rt_6hr",
                "mimiciii_clinical.kdigo_uo.uo_tm_12hr",
                "mimiciii_clinical.kdigo_uo.uo_tm_24hr",
                "mimiciii_clinical.kdigo_uo.uo_tm_6hr"
            ],
            "aki_stage": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.kdigo_creatinine.charttime",
                "mimiciii_clinical.kdigo_creatinine.creat",
                "mimiciii_clinical.kdigo_creatinine.creat_low_past_48hr",
                "mimiciii_clinical.kdigo_creatinine.creat_low_past_7day",
                "mimiciii_clinical.kdigo_creatinine.icustay_id",
                "mimiciii_clinical.kdigo_uo.charttime",
                "mimiciii_clinical.kdigo_uo.icustay_id",
                "mimiciii_clinical.kdigo_uo.uo_rt_12hr",
                "mimiciii_clinical.kdigo_uo.uo_rt_24hr",
                "mimiciii_clinical.kdigo_uo.uo_rt_6hr",
                "mimiciii_clinical.kdigo_uo.uo_tm_12hr",
                "mimiciii_clinical.kdigo_uo.uo_tm_24hr",
                "mimiciii_clinical.kdigo_uo.uo_tm_6hr"
            ]
        },
        "table_name": "mimiciii_clinical.kdigo_stages",
        "plan": {
            "Node Type": "Merge Join",
            "Parallel Aware": false,
            "Join Type": "Left",
            "Output": [
                "ie.icustay_id",
                "tm.charttime",
                "cr.creat",
                "cr.aki_stage_creat",
                "uo.uo_rt_6hr",
                "uo.uo_rt_12hr",
                "uo.uo_rt_24hr",
                "uo.aki_stage_uo",
                "GREATEST(COALESCE(cr.aki_stage_creat, 0), COALESCE(uo.aki_stage_uo, 0))"
            ],
            "Inner Unique": false,
            "Merge Cond": "((ie.icustay_id = uo.icustay_id) AND (tm.charttime = uo.charttime))",
            "Plans": [
                {
                    "Node Type": "Seq Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cr_stg",
                    "Parallel Aware": false,
                    "Relation Name": "kdigo_creatinine",
                    "Schema": "mimiciii_clinical",
                    "Alias": "cr_1",
                    "Output": [
                        "cr_1.icustay_id",
                        "cr_1.charttime",
                        "cr_1.creat",
                        "CASE WHEN (cr_1.creat >= (cr_1.creat_low_past_7day * '3'::double precision)) THEN 3 WHEN ((cr_1.creat >= '4'::double precision) AND ((cr_1.creat_low_past_48hr <= '3.7'::double precision) OR (cr_1.creat >= ('1.5'::double precision * cr_1.creat_low_past_7day)))) THEN 3 WHEN (cr_1.creat >= (cr_1.creat_low_past_7day * '2'::double precision)) THEN 2 WHEN (cr_1.creat >= (cr_1.creat_low_past_48hr + '0.3'::double precision)) THEN 1 WHEN (cr_1.creat >= (cr_1.creat_low_past_7day * '1.5'::double precision)) THEN 1 ELSE 0 END"
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE uo_stg",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "uo_1.icustay_id",
                        "uo_1.charttime",
                        "uo_1.weight",
                        "uo_1.uo_rt_6hr",
                        "uo_1.uo_rt_12hr",
                        "uo_1.uo_rt_24hr",
                        "CASE WHEN (uo_1.uo_rt_6hr IS NULL) THEN NULL::integer WHEN (uo_1.charttime <= datetime_add(ie_1.intime, '06:00:00'::interval hour)) THEN 0 WHEN ((uo_1.uo_tm_24hr >= '11'::numeric) AND (uo_1.uo_rt_24hr < 0.3)) THEN 3 WHEN ((uo_1.uo_tm_12hr >= '5'::numeric) AND (uo_1.uo_rt_12hr = '0'::numeric)) THEN 3 WHEN ((uo_1.uo_tm_12hr >= '5'::numeric) AND (uo_1.uo_rt_12hr < 0.5)) THEN 2 WHEN ((uo_1.uo_tm_6hr >= '2'::numeric) AND (uo_1.uo_rt_6hr < 0.5)) THEN 1 ELSE 0 END"
                    ],
                    "Inner Unique": true,
                    "Hash Cond": "(uo_1.icustay_id = ie_1.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "Seq Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "kdigo_uo",
                            "Schema": "mimiciii_clinical",
                            "Alias": "uo_1",
                            "Output": [
                                "uo_1.icustay_id",
                                "uo_1.charttime",
                                "uo_1.weight",
                                "uo_1.urineoutput_6hr",
                                "uo_1.urineoutput_12hr",
                                "uo_1.urineoutput_24hr",
                                "uo_1.uo_rt_6hr",
                                "uo_1.uo_rt_12hr",
                                "uo_1.uo_rt_24hr",
                                "uo_1.uo_tm_6hr",
                                "uo_1.uo_tm_12hr",
                                "uo_1.uo_tm_24hr"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "ie_1.intime",
                                "ie_1.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "icustays",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ie_1",
                                    "Output": [
                                        "ie_1.intime",
                                        "ie_1.icustay_id"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Unique",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE tm_stg",
                    "Parallel Aware": false,
                    "Output": [
                        "cr_stg.icustay_id",
                        "cr_stg.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "cr_stg.icustay_id",
                                "cr_stg.charttime"
                            ],
                            "Sort Key": [
                                "cr_stg.icustay_id",
                                "cr_stg.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Append",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "CTE Name": "cr_stg",
                                            "Alias": "cr_stg",
                                            "Output": [
                                                "cr_stg.icustay_id",
                                                "cr_stg.charttime"
                                            ]
                                        },
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "CTE Name": "uo_stg",
                                            "Alias": "uo_stg",
                                            "Output": [
                                                "uo_stg.icustay_id",
                                                "uo_stg.charttime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "ie.icustay_id",
                        "tm.charttime",
                        "cr.creat",
                        "cr.aki_stage_creat"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "((ie.icustay_id = cr.icustay_id) AND (tm.charttime = cr.charttime))",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ie.icustay_id",
                                "tm.charttime"
                            ],
                            "Sort Key": [
                                "ie.icustay_id",
                                "tm.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Right",
                                    "Output": [
                                        "ie.icustay_id",
                                        "tm.charttime"
                                    ],
                                    "Inner Unique": true,
                                    "Hash Cond": "(tm.icustay_id = ie.icustay_id)",
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "tm_stg",
                                            "Alias": "tm",
                                            "Output": [
                                                "tm.icustay_id",
                                                "tm.charttime"
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ie.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "icustays",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ie",
                                                    "Output": [
                                                        "ie.icustay_id"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Materialize",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "cr.creat",
                                "cr.aki_stage_creat",
                                "cr.icustay_id",
                                "cr.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "cr.creat",
                                        "cr.aki_stage_creat",
                                        "cr.icustay_id",
                                        "cr.charttime"
                                    ],
                                    "Sort Key": [
                                        "cr.icustay_id",
                                        "cr.charttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "cr_stg",
                                            "Alias": "cr",
                                            "Output": [
                                                "cr.creat",
                                                "cr.aki_stage_creat",
                                                "cr.icustay_id",
                                                "cr.charttime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Materialize",
                    "Parent Relationship": "Inner",
                    "Parallel Aware": false,
                    "Output": [
                        "uo.uo_rt_6hr",
                        "uo.uo_rt_12hr",
                        "uo.uo_rt_24hr",
                        "uo.aki_stage_uo",
                        "uo.icustay_id",
                        "uo.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "uo.uo_rt_6hr",
                                "uo.uo_rt_12hr",
                                "uo.uo_rt_24hr",
                                "uo.aki_stage_uo",
                                "uo.icustay_id",
                                "uo.charttime"
                            ],
                            "Sort Key": [
                                "uo.icustay_id",
                                "uo.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "uo_stg",
                                    "Alias": "uo",
                                    "Output": [
                                        "uo.uo_rt_6hr",
                                        "uo.uo_rt_12hr",
                                        "uo.uo_rt_24hr",
                                        "uo.aki_stage_uo",
                                        "uo.icustay_id",
                                        "uo.charttime"
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.kdigo_stages_48hr": {
        "sql": "-- This query checks if the patient had AKI during the first 48 hours of their ICU\n-- stay according to the KDIGO guideline.\n-- https://kdigo.org/wp-content/uploads/2016/10/KDIGO-2012-AKI-Guideline-English.pdf\n\n-- get the worst staging of creatinine in the first 48 hours\n\nselect\n    ie.icustay_id\n  , ie.charttime_creat as charttime_creat\n  , ie.creat\n  , ie.aki_stage_creat\n  , ie.charttime_uo as charttime_uo\n  , ie.uo_rt_6hr\n  , ie.uo_rt_12hr\n  , ie.uo_rt_24hr\n  , ie.aki_stage_uo\n\n  -- Classify AKI using both creatinine/urine output criteria\n  , GREATEST(\n      COALESCE(ie.aki_stage_creat, 0),\n      COALESCE(ie.aki_stage_uo, 0)\n    ) AS aki_stage_48hr\n  , CASE WHEN ie.aki_stage_creat > 0 OR ie.aki_stage_uo > 0 THEN 1 ELSE 0 END AS aki_48hr\n\nFROM \"mimic\".\"mimiciii_clinical\".\"tmp_kdigo_stages_7day_48hrs\" ie\nwhere DATETIME_DIFF(ie.charttime_creat, ie.intime, 'HOUR') <= 48",
        "tables": [
            "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.charttime_creat",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.icustay_id",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.intime"
            ],
            "charttime_creat": [
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.charttime_creat",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.intime"
            ],
            "creat": [
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.charttime_creat",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.creat",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.intime"
            ],
            "aki_stage_creat": [
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.aki_stage_creat",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.charttime_creat",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.intime"
            ],
            "charttime_uo": [
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.charttime_creat",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.charttime_uo",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.intime"
            ],
            "uo_rt_6hr": [
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.charttime_creat",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.intime",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.uo_rt_6hr"
            ],
            "uo_rt_12hr": [
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.charttime_creat",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.intime",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.uo_rt_12hr"
            ],
            "uo_rt_24hr": [
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.charttime_creat",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.intime",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.uo_rt_24hr"
            ],
            "aki_stage_uo": [
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.aki_stage_uo",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.charttime_creat",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.intime"
            ],
            "aki_stage_48hr": [
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.aki_stage_creat",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.aki_stage_uo",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.charttime_creat",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.intime"
            ],
            "aki_48hr": [
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.aki_stage_creat",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.aki_stage_uo",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.charttime_creat",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.intime"
            ]
        },
        "table_name": "mimiciii_clinical.kdigo_stages_48hr",
        "plan": {
            "Node Type": "Seq Scan",
            "Parallel Aware": false,
            "Relation Name": "tmp_kdigo_stages_7day_48hrs",
            "Schema": "mimiciii_clinical",
            "Alias": "ie",
            "Output": [
                "icustay_id",
                "charttime_creat",
                "creat",
                "aki_stage_creat",
                "charttime_uo",
                "uo_rt_6hr",
                "uo_rt_12hr",
                "uo_rt_24hr",
                "aki_stage_uo",
                "GREATEST(COALESCE(aki_stage_creat, 0), COALESCE(aki_stage_uo, 0))",
                "CASE WHEN ((aki_stage_creat > 0) OR (aki_stage_uo > 0)) THEN 1 ELSE 0 END"
            ],
            "Filter": "(datetime_diff(ie.charttime_creat, ie.intime, 'HOUR'::text) <= '48'::numeric)"
        }
    },
    "model.mimic.kdigo_stages_7day": {
        "sql": "select\n    ie.icustay_id\n  , ie.charttime_creat as charttime_creat\n  , ie.creat\n  , ie.aki_stage_creat\n  , ie.charttime_uo as charttime_uo\n  , ie.uo_rt_6hr\n  , ie.uo_rt_12hr\n  , ie.uo_rt_24hr\n  , ie.aki_stage_uo\n\n  -- Classify AKI using both creatinine/urine output criteria\n  , GREATEST(\n      COALESCE(ie.aki_stage_creat, 0),\n      COALESCE(ie.aki_stage_uo, 0)\n    ) AS aki_stage_7day\n  , CASE WHEN ie.aki_stage_creat > 0 OR ie.aki_stage_uo > 0 THEN 1 ELSE 0 END AS aki_7day\n\nFROM \"mimic\".\"mimiciii_clinical\".\"tmp_kdigo_stages_7day_48hrs\" ie",
        "tables": [
            "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.icustay_id"
            ],
            "charttime_creat": [
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.charttime_creat"
            ],
            "creat": [
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.creat"
            ],
            "aki_stage_creat": [
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.aki_stage_creat"
            ],
            "charttime_uo": [
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.charttime_uo"
            ],
            "uo_rt_6hr": [
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.uo_rt_6hr"
            ],
            "uo_rt_12hr": [
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.uo_rt_12hr"
            ],
            "uo_rt_24hr": [
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.uo_rt_24hr"
            ],
            "aki_stage_uo": [
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.aki_stage_uo"
            ],
            "aki_stage_7day": [
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.aki_stage_creat",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.aki_stage_uo"
            ],
            "aki_7day": [
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.aki_stage_creat",
                "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs.aki_stage_uo"
            ]
        },
        "table_name": "mimiciii_clinical.kdigo_stages_7day",
        "plan": {
            "Node Type": "Seq Scan",
            "Parallel Aware": false,
            "Relation Name": "tmp_kdigo_stages_7day_48hrs",
            "Schema": "mimiciii_clinical",
            "Alias": "ie",
            "Output": [
                "icustay_id",
                "charttime_creat",
                "creat",
                "aki_stage_creat",
                "charttime_uo",
                "uo_rt_6hr",
                "uo_rt_12hr",
                "uo_rt_24hr",
                "aki_stage_uo",
                "GREATEST(COALESCE(aki_stage_creat, 0), COALESCE(aki_stage_uo, 0))",
                "CASE WHEN ((aki_stage_creat > 0) OR (aki_stage_uo > 0)) THEN 1 ELSE 0 END"
            ]
        }
    },
    "model.mimic.kdigo_uo": {
        "sql": "with ur_stg as (\n   select io.icustay_id, io.charttime\n  -- we have joined each row to all rows preceding within 24 hours\n  -- we can now sum these rows to get total UO over the last 24 hours\n  -- we can use case statements to restrict it to only the last 6/12 hours\n  -- therefore we have three sums:\n  -- 1) over a 6 hour period\n  -- 2) over a 12 hour period\n  -- 3) over a 24 hour period\n\n  -- note that we assume data charted at charttime corresponds to 1 hour of UO\n  -- therefore we use '5' and '11' to restrict the period, rather than 6/12\n  -- this assumption may overestimate UO rate when documentation is done less than hourly\n  , sum(case when DATETIME_DIFF(io.charttime, iosum.charttime, 'HOUR') <= 5\n      then iosum.VALUE\n    else null end) as urineoutput_6hr\n  , sum(case when DATETIME_DIFF(io.charttime, iosum.charttime, 'HOUR') <= 11\n      then iosum.VALUE\n    else null end) as urineoutput_12hr\n  -- 24 hours\n  , sum(iosum.VALUE) as urineoutput_24hr\n\n  -- retain the earliest time used for each summation\n  -- this is later used to tabulate rates\n  , MIN(case when io.charttime <= DATETIME_ADD(iosum.charttime, INTERVAL '5 HOUR')\n      then iosum.charttime\n    else null end)\n    AS starttime_6hr\n  , MIN(case when io.charttime <= DATETIME_ADD(iosum.charttime, INTERVAL '11 HOUR')\n      then iosum.charttime\n    else null end)\n    AS starttime_12hr\n  , MIN(iosum.charttime) AS starttime_24hr\n  from \"mimic\".\"mimiciii_clinical\".\"urine_output\" io\n  -- this join gives you all UO measurements over a 24 hour period\n  left join \"mimic\".\"mimiciii_clinical\".\"urine_output\" iosum\n    on  io.icustay_id = iosum.icustay_id\n    and io.charttime >= iosum.charttime\n    and io.charttime <= (DATETIME_ADD(iosum.charttime, INTERVAL '23 HOUR'))\n  group by io.icustay_id, io.charttime\n   ),\n   ur_stg2 as (\n   select\n    icustay_id\n  , charttime\n  , urineoutput_6hr\n  , urineoutput_12hr\n  , urineoutput_24hr\n  -- calculate time over which we summed UO\n  -- note: adding 1 hour as we assume data charted corresponds to previous hour\n  -- i.e. if documentation is:\n  --  10:00, 100 mL\n  --  11:00, 50 mL\n  -- then this is two hours of documentation, even though (11:00 - 10:00) is 1 hour\n  , ROUND(DATETIME_DIFF(charttime, starttime_6hr, 'HOUR'), 4) + 1 AS uo_tm_6hr\n  , ROUND(DATETIME_DIFF(charttime, starttime_12hr, 'HOUR'), 4) + 1 AS uo_tm_12hr\n  , ROUND(DATETIME_DIFF(charttime, starttime_24hr, 'HOUR'), 4) + 1 AS uo_tm_24hr\n  from ur_stg  \n   \n   )\n   select\n  ur.icustay_id\n, ur.charttime\n, wd.weight\n, ur.urineoutput_6hr\n, ur.urineoutput_12hr\n, ur.urineoutput_24hr\n, ROUND(CAST((ur.urineoutput_6hr/wd.weight/uo_tm_6hr) AS NUMERIC), 4) AS uo_rt_6hr\n, ROUND(CAST((ur.urineoutput_12hr/wd.weight/uo_tm_12hr) AS NUMERIC), 4) AS uo_rt_12hr\n, ROUND(CAST((ur.urineoutput_24hr/wd.weight/uo_tm_24hr) AS NUMERIC), 4) AS uo_rt_24hr\n-- time of earliest UO measurement that was used to calculate the rate\n, uo_tm_6hr\n, uo_tm_12hr\n, uo_tm_24hr\nfrom ur_stg2 ur\nleft join \"mimic\".\"mimiciii_clinical\".\"weight_durations\" wd\n  on  ur.icustay_id = wd.icustay_id\n  and ur.charttime >= wd.starttime\n  and ur.charttime <  wd.endtime\norder by icustay_id, charttime",
        "tables": [
            "mimiciii_clinical.urine_output",
            "mimiciii_clinical.weight_durations"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.urine_output.charttime",
                "mimiciii_clinical.urine_output.icustay_id",
                "mimiciii_clinical.weight_durations.endtime",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime"
            ],
            "charttime": [
                "mimiciii_clinical.urine_output.charttime",
                "mimiciii_clinical.urine_output.icustay_id",
                "mimiciii_clinical.weight_durations.endtime",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime"
            ],
            "weight": [
                "mimiciii_clinical.urine_output.charttime",
                "mimiciii_clinical.urine_output.icustay_id",
                "mimiciii_clinical.weight_durations.endtime",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime",
                "mimiciii_clinical.weight_durations.weight"
            ],
            "urineoutput_6hr": [
                "mimiciii_clinical.urine_output.charttime",
                "mimiciii_clinical.urine_output.icustay_id",
                "mimiciii_clinical.urine_output.value",
                "mimiciii_clinical.weight_durations.endtime",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime"
            ],
            "urineoutput_12hr": [
                "mimiciii_clinical.urine_output.charttime",
                "mimiciii_clinical.urine_output.icustay_id",
                "mimiciii_clinical.urine_output.value",
                "mimiciii_clinical.weight_durations.endtime",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime"
            ],
            "urineoutput_24hr": [
                "mimiciii_clinical.urine_output.charttime",
                "mimiciii_clinical.urine_output.icustay_id",
                "mimiciii_clinical.urine_output.value",
                "mimiciii_clinical.weight_durations.endtime",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime"
            ],
            "uo_rt_6hr": [
                "mimiciii_clinical.urine_output.charttime",
                "mimiciii_clinical.urine_output.icustay_id",
                "mimiciii_clinical.urine_output.value",
                "mimiciii_clinical.weight_durations.endtime",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime",
                "mimiciii_clinical.weight_durations.weight"
            ],
            "uo_rt_12hr": [
                "mimiciii_clinical.urine_output.charttime",
                "mimiciii_clinical.urine_output.icustay_id",
                "mimiciii_clinical.urine_output.value",
                "mimiciii_clinical.weight_durations.endtime",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime",
                "mimiciii_clinical.weight_durations.weight"
            ],
            "uo_rt_24hr": [
                "mimiciii_clinical.urine_output.charttime",
                "mimiciii_clinical.urine_output.icustay_id",
                "mimiciii_clinical.urine_output.value",
                "mimiciii_clinical.weight_durations.endtime",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime",
                "mimiciii_clinical.weight_durations.weight"
            ],
            "uo_tm_6hr": [
                "mimiciii_clinical.urine_output.charttime",
                "mimiciii_clinical.urine_output.icustay_id",
                "mimiciii_clinical.weight_durations.endtime",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime"
            ],
            "uo_tm_12hr": [
                "mimiciii_clinical.urine_output.charttime",
                "mimiciii_clinical.urine_output.icustay_id",
                "mimiciii_clinical.weight_durations.endtime",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime"
            ],
            "uo_tm_24hr": [
                "mimiciii_clinical.urine_output.charttime",
                "mimiciii_clinical.urine_output.icustay_id",
                "mimiciii_clinical.weight_durations.endtime",
                "mimiciii_clinical.weight_durations.icustay_id",
                "mimiciii_clinical.weight_durations.starttime"
            ]
        },
        "table_name": "mimiciii_clinical.kdigo_uo",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "ur.icustay_id",
                "ur.charttime",
                "wd.weight",
                "ur.urineoutput_6hr",
                "ur.urineoutput_12hr",
                "ur.urineoutput_24hr",
                "(round((((ur.urineoutput_6hr / wd.weight) / (ur.uo_tm_6hr)::double precision))::numeric, 4))",
                "(round((((ur.urineoutput_12hr / wd.weight) / (ur.uo_tm_12hr)::double precision))::numeric, 4))",
                "(round((((ur.urineoutput_24hr / wd.weight) / (ur.uo_tm_24hr)::double precision))::numeric, 4))",
                "ur.uo_tm_6hr",
                "ur.uo_tm_12hr",
                "ur.uo_tm_24hr"
            ],
            "Sort Key": [
                "ur.icustay_id",
                "ur.charttime"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE ur_stg",
                    "Parallel Aware": false,
                    "Output": [
                        "io.icustay_id",
                        "io.charttime",
                        "sum(CASE WHEN (datetime_diff(io.charttime, iosum.charttime, 'HOUR'::text) <= '5'::numeric) THEN iosum.value ELSE NULL::double precision END)",
                        "sum(CASE WHEN (datetime_diff(io.charttime, iosum.charttime, 'HOUR'::text) <= '11'::numeric) THEN iosum.value ELSE NULL::double precision END)",
                        "sum(iosum.value)",
                        "min(CASE WHEN (io.charttime <= datetime_add(iosum.charttime, '05:00:00'::interval)) THEN iosum.charttime ELSE NULL::timestamp without time zone END)",
                        "min(CASE WHEN (io.charttime <= datetime_add(iosum.charttime, '11:00:00'::interval)) THEN iosum.charttime ELSE NULL::timestamp without time zone END)",
                        "min(iosum.charttime)"
                    ],
                    "Group Key": [
                        "io.icustay_id",
                        "io.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "io.icustay_id",
                                "io.charttime",
                                "iosum.charttime",
                                "iosum.value"
                            ],
                            "Sort Key": [
                                "io.icustay_id",
                                "io.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Merge Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Left",
                                    "Output": [
                                        "io.icustay_id",
                                        "io.charttime",
                                        "iosum.charttime",
                                        "iosum.value"
                                    ],
                                    "Inner Unique": false,
                                    "Merge Cond": "(io.icustay_id = iosum.icustay_id)",
                                    "Join Filter": "((io.charttime >= iosum.charttime) AND (io.charttime <= datetime_add(iosum.charttime, '23:00:00'::interval)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "io.icustay_id",
                                                "io.charttime"
                                            ],
                                            "Sort Key": [
                                                "io.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "urine_output",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "io",
                                                    "Output": [
                                                        "io.icustay_id",
                                                        "io.charttime"
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Materialize",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "iosum.charttime",
                                                "iosum.value",
                                                "iosum.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Sort",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Output": [
                                                        "iosum.charttime",
                                                        "iosum.value",
                                                        "iosum.icustay_id"
                                                    ],
                                                    "Sort Key": [
                                                        "iosum.icustay_id"
                                                    ],
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Seq Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "urine_output",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "iosum",
                                                            "Output": [
                                                                "iosum.charttime",
                                                                "iosum.value",
                                                                "iosum.icustay_id"
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE ur_stg2",
                    "Parallel Aware": false,
                    "CTE Name": "ur_stg",
                    "Alias": "ur_stg",
                    "Output": [
                        "ur_stg.icustay_id",
                        "ur_stg.charttime",
                        "ur_stg.urineoutput_6hr",
                        "ur_stg.urineoutput_12hr",
                        "ur_stg.urineoutput_24hr",
                        "(round(datetime_diff(ur_stg.charttime, ur_stg.starttime_6hr, 'HOUR'::text), 4) + '1'::numeric)",
                        "(round(datetime_diff(ur_stg.charttime, ur_stg.starttime_12hr, 'HOUR'::text), 4) + '1'::numeric)",
                        "(round(datetime_diff(ur_stg.charttime, ur_stg.starttime_24hr, 'HOUR'::text), 4) + '1'::numeric)"
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "ur.icustay_id",
                        "ur.charttime",
                        "wd.weight",
                        "ur.urineoutput_6hr",
                        "ur.urineoutput_12hr",
                        "ur.urineoutput_24hr",
                        "round((((ur.urineoutput_6hr / wd.weight) / (ur.uo_tm_6hr)::double precision))::numeric, 4)",
                        "round((((ur.urineoutput_12hr / wd.weight) / (ur.uo_tm_12hr)::double precision))::numeric, 4)",
                        "round((((ur.urineoutput_24hr / wd.weight) / (ur.uo_tm_24hr)::double precision))::numeric, 4)",
                        "ur.uo_tm_6hr",
                        "ur.uo_tm_12hr",
                        "ur.uo_tm_24hr"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "(ur.icustay_id = wd.icustay_id)",
                    "Join Filter": "((ur.charttime >= wd.starttime) AND (ur.charttime < wd.endtime))",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ur.icustay_id",
                                "ur.charttime",
                                "ur.urineoutput_6hr",
                                "ur.urineoutput_12hr",
                                "ur.urineoutput_24hr",
                                "ur.uo_tm_6hr",
                                "ur.uo_tm_12hr",
                                "ur.uo_tm_24hr"
                            ],
                            "Sort Key": [
                                "ur.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "ur_stg2",
                                    "Alias": "ur",
                                    "Output": [
                                        "ur.icustay_id",
                                        "ur.charttime",
                                        "ur.urineoutput_6hr",
                                        "ur.urineoutput_12hr",
                                        "ur.urineoutput_24hr",
                                        "ur.uo_tm_6hr",
                                        "ur.uo_tm_12hr",
                                        "ur.uo_tm_24hr"
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Materialize",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "wd.weight",
                                "wd.icustay_id",
                                "wd.starttime",
                                "wd.endtime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "wd.weight",
                                        "wd.icustay_id",
                                        "wd.starttime",
                                        "wd.endtime"
                                    ],
                                    "Sort Key": [
                                        "wd.icustay_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "weight_durations",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "wd",
                                            "Output": [
                                                "wd.weight",
                                                "wd.icustay_id",
                                                "wd.starttime",
                                                "wd.endtime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.meld": {
        "sql": "-- Model for end-stage liver disease (MELD)\n-- This model is used to determine prognosis and receipt of liver transplantation.\n\n-- Reference:\n--  Kamath PS, Wiesner RH, Malinchoc M, Kremers W, Therneau TM,\n--  Kosberg CL, D'Amico G, Dickson ER, Kim WR.\n--  A model to predict survival in patients with end-stage liver disease.\n--  Hepatology. 2001 Feb33(2):464-70.\n\n\n-- Updated January 2016 to include serum sodium, see:\n--  https://optn.transplant.hrsa.gov/news/meld-serum-sodium-policy-changes/\n\n-- Here is the relevant portion of the policy note:\n--    9.1.D MELD Score\n--    Candidates who are at least 12 years old receive an initial MELD(i) score equal to:\n--    0.957 x ln(creatinine mg/dL) + 0.378 x ln(bilirubin mg/dL) + 1.120 x ln(INR) + 0.643\n\n--    Laboratory values less than 1.0 will be set to 1.0 when calculating a candidate\u2019s MELD\n--    score.\n\n--    The following candidates will receive a creatinine value of 4.0 mg/dL:\n--    - Candidates with a creatinine value greater than 4.0 mg/dL\n--    - Candidates who received two or more dialysis treatments within the prior week\n--    - Candidates who received 24 hours of continuous veno-venous hemodialysis (CVVHD) within the prior week\n\n--    The maximum MELD score is 40. The MELD score derived from this calculation will be rounded to the tenth decimal place and then multiplied by 10.\n\n--    For candidates with an initial MELD score greater than 11, The MELD score is then recalculated as follows:\n--    MELD = MELD(i) + 1.32*(137-Na) \u2013 [0.033*MELD(i)*(137-Na)]\n--    Sodium values less than 125 mmol/L will be set to 125, and values greater than 137 mmol/L will be set to 137.\n\n\n\n-- TODO needed in this code:\n--  1. identify 2x dialysis in the past week, or 24 hours of CVVH\n--      at the moment it just checks for any dialysis on the day\n--  2. adjust the serum sodium using the corresponding glucose measurement\n--      Measured sodium + 0.024 * (Serum glucose - 100)   (Hiller, 1999)\n\nwith cohort as\n(\n  select ie.subject_id, ie.hadm_id, ie.icustay_id\n        , ie.intime\n        , ie.outtime\n\n        , labs.creatinine_max\n        , labs.bilirubin_max\n        , labs.inr_max\n        , labs.sodium_min\n\n        , r.rrt\n\n  FROM icustays ie\n  inner join admissions adm\n    on ie.hadm_id = adm.hadm_id\n  inner join patients pat\n    on ie.subject_id = pat.subject_id\n\n  -- join to custom tables to get more data....\n  left join \"mimic\".\"mimiciii_clinical\".\"labs_first_day\" labs\n    on ie.icustay_id = labs.icustay_id\n  left join rrt_first_day r\n    on ie.icustay_id = r.icustay_id\n)\n, score as\n(\n  select subject_id, hadm_id, icustay_id\n    , rrt\n    , creatinine_max\n    , bilirubin_max\n    , inr_max\n    , sodium_min\n\n    -- TODO: Corrected Sodium\n    , case\n        when sodium_min is null\n          then 0.0\n        when sodium_min > 137\n          then 0.0\n        when sodium_min < 125\n          then 12.0 -- 137 - 125 = 12\n        else 137.0-sodium_min\n      end as sodium_score\n\n    -- if hemodialysis, value for Creatinine is automatically set to 4.0\n    , case\n        when rrt = 1 or creatinine_max > 4.0\n          then (0.957 * ln(4))\n        -- if creatinine < 1, score is 1\n        when creatinine_max < 1\n          then (0.957 * ln(1))\n        else 0.957 * coalesce(ln(creatinine_max),ln(1))\n      end as creatinine_score\n\n    , case\n        -- if value < 1, score is 1\n        when bilirubin_max < 1\n          then 0.378 * ln(1)\n        else 0.378 * coalesce(ln(bilirubin_max),ln(1))\n      end as bilirubin_score\n\n    , case\n        when inr_max < 1\n          then ( 1.120 * ln(1) + 0.643 )\n        else ( 1.120 * coalesce(ln(inr_max),ln(1)) + 0.643 )\n      end as inr_score\n\n  from cohort\n)\n, score2 as\n(\n  select\n    subject_id, hadm_id, icustay_id\n    , rrt\n    , creatinine_max\n    , bilirubin_max\n    , inr_max\n    , sodium_min\n\n    , creatinine_score\n    , sodium_score\n    , bilirubin_score\n    , inr_score\n\n    , case\n        when (creatinine_score + bilirubin_score + inr_score) > 40\n          then 40.0\n        else\n          round(cast(creatinine_score + bilirubin_score + inr_score as numeric),1)*10\n        end as meld_initial\n  from score\n)\nselect\n  subject_id, hadm_id, icustay_id\n\n  -- MELD Score without sodium change\n  , meld_initial\n\n  -- MELD Score (2016) = MELD*10 + 1.32*(137-Na) \u2013 [0.033*MELD*10*(137-Na)]\n  , case\n      when meld_initial > 11\n        then meld_initial + 1.32*sodium_score - 0.033*meld_initial*sodium_score\n      else\n        meld_initial\n      end as meld\n\n  -- original variables\n  , rrt\n  , creatinine_max\n  , bilirubin_max\n  , inr_max\n  , sodium_min\n\nfrom score2\norder by icustay_id",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.labs_first_day",
            "mimiciii_clinical.patients",
            "mimiciii_clinical.rrt_first_day"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.rrt_first_day.icustay_id"
            ],
            "hadm_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.rrt_first_day.icustay_id"
            ],
            "icustay_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.rrt_first_day.icustay_id"
            ],
            "meld_initial": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.bilirubin_max",
                "mimiciii_clinical.labs_first_day.creatinine_max",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.inr_max",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.rrt_first_day.icustay_id",
                "mimiciii_clinical.rrt_first_day.rrt"
            ],
            "meld": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.bilirubin_max",
                "mimiciii_clinical.labs_first_day.creatinine_max",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.inr_max",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.rrt_first_day.icustay_id",
                "mimiciii_clinical.rrt_first_day.rrt"
            ],
            "rrt": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.rrt_first_day.icustay_id",
                "mimiciii_clinical.rrt_first_day.rrt"
            ],
            "creatinine_max": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.creatinine_max",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.rrt_first_day.icustay_id"
            ],
            "bilirubin_max": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.bilirubin_max",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.rrt_first_day.icustay_id"
            ],
            "inr_max": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.inr_max",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.rrt_first_day.icustay_id"
            ],
            "sodium_min": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.sodium_min",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.rrt_first_day.icustay_id"
            ]
        },
        "table_name": "mimiciii_clinical.meld",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "score2.subject_id",
                "score2.hadm_id",
                "score2.icustay_id",
                "score2.meld_initial",
                "(CASE WHEN (score2.meld_initial > '11'::numeric) THEN (((score2.meld_initial)::double precision + ('1.32'::double precision * score2.sodium_score)) - (((0.033 * score2.meld_initial))::double precision * score2.sodium_score)) ELSE (score2.meld_initial)::double precision END)",
                "score2.rrt",
                "score2.creatinine_max",
                "score2.bilirubin_max",
                "score2.inr_max",
                "score2.sodium_min"
            ],
            "Sort Key": [
                "score2.icustay_id"
            ],
            "Plans": [
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cohort",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id",
                        "ie.intime",
                        "ie.outtime",
                        "labs.creatinine_max",
                        "labs.bilirubin_max",
                        "labs.inr_max",
                        "labs.sodium_min",
                        "r.rrt"
                    ],
                    "Inner Unique": false,
                    "Hash Cond": "(ie.icustay_id = r.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Inner",
                            "Output": [
                                "ie.subject_id",
                                "ie.hadm_id",
                                "ie.icustay_id",
                                "ie.intime",
                                "ie.outtime",
                                "labs.creatinine_max",
                                "labs.bilirubin_max",
                                "labs.inr_max",
                                "labs.sodium_min"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "(ie.subject_id = pat.subject_id)",
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "ie.subject_id",
                                        "ie.hadm_id",
                                        "ie.icustay_id",
                                        "ie.intime",
                                        "ie.outtime",
                                        "labs.creatinine_max",
                                        "labs.bilirubin_max",
                                        "labs.inr_max",
                                        "labs.sodium_min"
                                    ],
                                    "Inner Unique": true,
                                    "Hash Cond": "(ie.hadm_id = adm.hadm_id)",
                                    "Plans": [
                                        {
                                            "Node Type": "Hash Join",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Join Type": "Right",
                                            "Output": [
                                                "ie.subject_id",
                                                "ie.hadm_id",
                                                "ie.icustay_id",
                                                "ie.intime",
                                                "ie.outtime",
                                                "labs.creatinine_max",
                                                "labs.bilirubin_max",
                                                "labs.inr_max",
                                                "labs.sodium_min"
                                            ],
                                            "Inner Unique": true,
                                            "Hash Cond": "(labs.icustay_id = ie.icustay_id)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "labs_first_day",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "labs",
                                                    "Output": [
                                                        "labs.creatinine_max",
                                                        "labs.bilirubin_max",
                                                        "labs.inr_max",
                                                        "labs.sodium_min",
                                                        "labs.icustay_id"
                                                    ]
                                                },
                                                {
                                                    "Node Type": "Hash",
                                                    "Parent Relationship": "Inner",
                                                    "Parallel Aware": false,
                                                    "Output": [
                                                        "ie.subject_id",
                                                        "ie.hadm_id",
                                                        "ie.icustay_id",
                                                        "ie.intime",
                                                        "ie.outtime"
                                                    ],
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Seq Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "icustays",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "ie",
                                                            "Output": [
                                                                "ie.subject_id",
                                                                "ie.hadm_id",
                                                                "ie.icustay_id",
                                                                "ie.intime",
                                                                "ie.outtime"
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "adm.hadm_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "admissions",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "adm",
                                                    "Output": [
                                                        "adm.hadm_id"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "pat.subject_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "patients",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "pat",
                                            "Output": [
                                                "pat.subject_id"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "r.rrt",
                                "r.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "rrt_first_day",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "r",
                                    "Output": [
                                        "r.rrt",
                                        "r.icustay_id"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE score",
                    "Parallel Aware": false,
                    "CTE Name": "cohort",
                    "Alias": "cohort",
                    "Output": [
                        "cohort.subject_id",
                        "cohort.hadm_id",
                        "cohort.icustay_id",
                        "cohort.rrt",
                        "cohort.creatinine_max",
                        "cohort.bilirubin_max",
                        "cohort.inr_max",
                        "cohort.sodium_min",
                        "CASE WHEN (cohort.sodium_min IS NULL) THEN '0'::double precision WHEN (cohort.sodium_min > '137'::double precision) THEN '0'::double precision WHEN (cohort.sodium_min < '125'::double precision) THEN '12'::double precision ELSE ('137'::double precision - cohort.sodium_min) END",
                        "CASE WHEN ((cohort.rrt = 1) OR (cohort.creatinine_max > '4'::double precision)) THEN '1.32668370359174'::double precision WHEN (cohort.creatinine_max < '1'::double precision) THEN '0'::double precision ELSE ('0.957'::double precision * COALESCE(ln(cohort.creatinine_max), '0'::double precision)) END",
                        "CASE WHEN (cohort.bilirubin_max < '1'::double precision) THEN '0'::double precision ELSE ('0.378'::double precision * COALESCE(ln(cohort.bilirubin_max), '0'::double precision)) END",
                        "CASE WHEN (cohort.inr_max < '1'::double precision) THEN '0.643'::double precision ELSE (('1.12'::double precision * COALESCE(ln(cohort.inr_max), '0'::double precision)) + '0.643'::double precision) END"
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE score2",
                    "Parallel Aware": false,
                    "CTE Name": "score",
                    "Alias": "score",
                    "Output": [
                        "score.subject_id",
                        "score.hadm_id",
                        "score.icustay_id",
                        "score.rrt",
                        "score.creatinine_max",
                        "score.bilirubin_max",
                        "score.inr_max",
                        "score.sodium_min",
                        "score.creatinine_score",
                        "score.sodium_score",
                        "score.bilirubin_score",
                        "score.inr_score",
                        "CASE WHEN (((score.creatinine_score + score.bilirubin_score) + score.inr_score) > '40'::double precision) THEN 40.0 ELSE (round((((score.creatinine_score + score.bilirubin_score) + score.inr_score))::numeric, 1) * '10'::numeric) END"
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "CTE Name": "score2",
                    "Alias": "score2",
                    "Output": [
                        "score2.subject_id",
                        "score2.hadm_id",
                        "score2.icustay_id",
                        "score2.meld_initial",
                        "CASE WHEN (score2.meld_initial > '11'::numeric) THEN (((score2.meld_initial)::double precision + ('1.32'::double precision * score2.sodium_score)) - (((0.033 * score2.meld_initial))::double precision * score2.sodium_score)) ELSE (score2.meld_initial)::double precision END",
                        "score2.rrt",
                        "score2.creatinine_max",
                        "score2.bilirubin_max",
                        "score2.inr_max",
                        "score2.sodium_min"
                    ]
                }
            ]
        }
    },
    "model.mimic.tmp_kdigo_stages_7day_48hrs": {
        "sql": "-- This query checks if the patient had AKI during the first 7 days of their ICU\n-- stay according to the KDIGO guideline.\n-- https://kdigo.org/wp-content/uploads/2016/10/KDIGO-2012-AKI-Guideline-English.pdf\n\n-- get the worst staging of creatinine in the first 48 hours\nWITH cr_aki AS\n(\n  SELECT\n    k.icustay_id\n    , k.charttime\n    , k.creat\n    , k.aki_stage_creat\n    , ROW_NUMBER() OVER (PARTITION BY k.icustay_id ORDER BY k.aki_stage_creat DESC, k.creat DESC) AS rn\n    , ie.intime\n  FROM icustays ie\n  INNER JOIN \"mimic\".\"mimiciii_clinical\".\"kdigo_stages\" k\n    ON ie.icustay_id = k.icustay_id\n  WHERE DATETIME_DIFF(k.charttime, ie.intime, 'HOUR') > -6\n  AND DATETIME_DIFF(k.charttime, ie.intime, 'DAY') <= 7\n  AND k.aki_stage_creat IS NOT NULL\n)\n-- get the worst staging of urine output in the first 48 hours\n, uo_aki AS\n(\n  SELECT\n    k.icustay_id\n    , k.charttime\n    , k.uo_rt_6hr\n    , k.uo_rt_12hr\n    , k.uo_rt_24hr\n    , k.aki_stage_uo\n    , ROW_NUMBER() OVER \n    (\n      PARTITION BY k.icustay_id\n      ORDER BY k.aki_stage_uo DESC, k.uo_rt_24hr DESC, k.uo_rt_12hr DESC, k.uo_rt_6hr DESC\n    ) AS rn\n  FROM icustays ie\n  INNER JOIN \"mimic\".\"mimiciii_clinical\".\"kdigo_stages\" k\n    ON ie.icustay_id = k.icustay_id\n  WHERE DATETIME_DIFF(k.charttime, ie.intime, 'HOUR') > -6\n  AND DATETIME_DIFF(k.charttime, ie.intime, 'DAY') <= 7\n  AND k.aki_stage_uo IS NOT NULL\n)\n-- final table is aki_stage, include worst cr/uo for convenience\nselect\n    ie.icustay_id\n  , cr.charttime as charttime_creat\n  , cr.creat\n  , cr.aki_stage_creat\n  , uo.charttime as charttime_uo\n  , uo.uo_rt_6hr\n  , uo.uo_rt_12hr\n  , uo.uo_rt_24hr\n  , uo.aki_stage_uo\n  , ie.intime\n\nFROM icustays ie\nLEFT JOIN cr_aki cr\n  ON ie.icustay_id = cr.icustay_id\n  AND cr.rn = 1\nLEFT JOIN uo_aki uo\n  ON ie.icustay_id = uo.icustay_id\n  AND uo.rn = 1\norder by ie.icustay_id",
        "tables": [
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.kdigo_stages"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.kdigo_stages.aki_stage_creat",
                "mimiciii_clinical.kdigo_stages.aki_stage_uo",
                "mimiciii_clinical.kdigo_stages.charttime",
                "mimiciii_clinical.kdigo_stages.icustay_id"
            ],
            "charttime_creat": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.kdigo_stages.aki_stage_creat",
                "mimiciii_clinical.kdigo_stages.aki_stage_uo",
                "mimiciii_clinical.kdigo_stages.charttime",
                "mimiciii_clinical.kdigo_stages.icustay_id"
            ],
            "creat": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.kdigo_stages.aki_stage_creat",
                "mimiciii_clinical.kdigo_stages.aki_stage_uo",
                "mimiciii_clinical.kdigo_stages.charttime",
                "mimiciii_clinical.kdigo_stages.creat",
                "mimiciii_clinical.kdigo_stages.icustay_id"
            ],
            "aki_stage_creat": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.kdigo_stages.aki_stage_creat",
                "mimiciii_clinical.kdigo_stages.aki_stage_uo",
                "mimiciii_clinical.kdigo_stages.charttime",
                "mimiciii_clinical.kdigo_stages.icustay_id"
            ],
            "charttime_uo": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.kdigo_stages.aki_stage_creat",
                "mimiciii_clinical.kdigo_stages.aki_stage_uo",
                "mimiciii_clinical.kdigo_stages.charttime",
                "mimiciii_clinical.kdigo_stages.icustay_id"
            ],
            "uo_rt_6hr": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.kdigo_stages.aki_stage_creat",
                "mimiciii_clinical.kdigo_stages.aki_stage_uo",
                "mimiciii_clinical.kdigo_stages.charttime",
                "mimiciii_clinical.kdigo_stages.icustay_id",
                "mimiciii_clinical.kdigo_stages.uo_rt_6hr"
            ],
            "uo_rt_12hr": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.kdigo_stages.aki_stage_creat",
                "mimiciii_clinical.kdigo_stages.aki_stage_uo",
                "mimiciii_clinical.kdigo_stages.charttime",
                "mimiciii_clinical.kdigo_stages.icustay_id",
                "mimiciii_clinical.kdigo_stages.uo_rt_12hr"
            ],
            "uo_rt_24hr": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.kdigo_stages.aki_stage_creat",
                "mimiciii_clinical.kdigo_stages.aki_stage_uo",
                "mimiciii_clinical.kdigo_stages.charttime",
                "mimiciii_clinical.kdigo_stages.icustay_id",
                "mimiciii_clinical.kdigo_stages.uo_rt_24hr"
            ],
            "aki_stage_uo": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.kdigo_stages.aki_stage_creat",
                "mimiciii_clinical.kdigo_stages.aki_stage_uo",
                "mimiciii_clinical.kdigo_stages.charttime",
                "mimiciii_clinical.kdigo_stages.icustay_id"
            ],
            "intime": [
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.kdigo_stages.aki_stage_creat",
                "mimiciii_clinical.kdigo_stages.aki_stage_uo",
                "mimiciii_clinical.kdigo_stages.charttime",
                "mimiciii_clinical.kdigo_stages.icustay_id"
            ]
        },
        "table_name": "mimiciii_clinical.tmp_kdigo_stages_7day_48hrs",
        "plan": {
            "Node Type": "Merge Join",
            "Parallel Aware": false,
            "Join Type": "Left",
            "Output": [
                "ie.icustay_id",
                "cr.charttime",
                "cr.creat",
                "cr.aki_stage_creat",
                "uo.charttime",
                "uo.uo_rt_6hr",
                "uo.uo_rt_12hr",
                "uo.uo_rt_24hr",
                "uo.aki_stage_uo",
                "ie.intime"
            ],
            "Inner Unique": false,
            "Merge Cond": "(ie.icustay_id = uo.icustay_id)",
            "Plans": [
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cr_aki",
                    "Parallel Aware": false,
                    "Output": [
                        "k.icustay_id",
                        "k.charttime",
                        "k.creat",
                        "k.aki_stage_creat",
                        "row_number() OVER (?)",
                        "ie_1.intime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "k.icustay_id",
                                "k.creat",
                                "k.aki_stage_creat",
                                "k.charttime",
                                "ie_1.intime"
                            ],
                            "Sort Key": [
                                "k.icustay_id",
                                "k.aki_stage_creat DESC",
                                "k.creat DESC"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "k.icustay_id",
                                        "k.creat",
                                        "k.aki_stage_creat",
                                        "k.charttime",
                                        "ie_1.intime"
                                    ],
                                    "Inner Unique": true,
                                    "Hash Cond": "(k.icustay_id = ie_1.icustay_id)",
                                    "Join Filter": "((datetime_diff(k.charttime, ie_1.intime, 'HOUR'::text) > '-6'::numeric) AND (datetime_diff(k.charttime, ie_1.intime, 'DAY'::text) <= '7'::numeric))",
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "kdigo_stages",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "k",
                                            "Output": [
                                                "k.icustay_id",
                                                "k.charttime",
                                                "k.creat",
                                                "k.aki_stage_creat",
                                                "k.uo_rt_6hr",
                                                "k.uo_rt_12hr",
                                                "k.uo_rt_24hr",
                                                "k.aki_stage_uo",
                                                "k.aki_stage"
                                            ],
                                            "Filter": "(k.aki_stage_creat IS NOT NULL)"
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ie_1.intime",
                                                "ie_1.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "icustays",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ie_1",
                                                    "Output": [
                                                        "ie_1.intime",
                                                        "ie_1.icustay_id"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE uo_aki",
                    "Parallel Aware": false,
                    "Output": [
                        "k_1.icustay_id",
                        "k_1.charttime",
                        "k_1.uo_rt_6hr",
                        "k_1.uo_rt_12hr",
                        "k_1.uo_rt_24hr",
                        "k_1.aki_stage_uo",
                        "row_number() OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "k_1.icustay_id",
                                "k_1.uo_rt_6hr",
                                "k_1.uo_rt_12hr",
                                "k_1.uo_rt_24hr",
                                "k_1.aki_stage_uo",
                                "k_1.charttime"
                            ],
                            "Sort Key": [
                                "k_1.icustay_id",
                                "k_1.aki_stage_uo DESC",
                                "k_1.uo_rt_24hr DESC",
                                "k_1.uo_rt_12hr DESC",
                                "k_1.uo_rt_6hr DESC"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "k_1.icustay_id",
                                        "k_1.uo_rt_6hr",
                                        "k_1.uo_rt_12hr",
                                        "k_1.uo_rt_24hr",
                                        "k_1.aki_stage_uo",
                                        "k_1.charttime"
                                    ],
                                    "Inner Unique": true,
                                    "Hash Cond": "(k_1.icustay_id = ie_2.icustay_id)",
                                    "Join Filter": "((datetime_diff(k_1.charttime, ie_2.intime, 'HOUR'::text) > '-6'::numeric) AND (datetime_diff(k_1.charttime, ie_2.intime, 'DAY'::text) <= '7'::numeric))",
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "kdigo_stages",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "k_1",
                                            "Output": [
                                                "k_1.icustay_id",
                                                "k_1.charttime",
                                                "k_1.creat",
                                                "k_1.aki_stage_creat",
                                                "k_1.uo_rt_6hr",
                                                "k_1.uo_rt_12hr",
                                                "k_1.uo_rt_24hr",
                                                "k_1.aki_stage_uo",
                                                "k_1.aki_stage"
                                            ],
                                            "Filter": "(k_1.aki_stage_uo IS NOT NULL)"
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ie_2.icustay_id",
                                                "ie_2.intime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "icustays",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ie_2",
                                                    "Output": [
                                                        "ie_2.icustay_id",
                                                        "ie_2.intime"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "ie.icustay_id",
                        "ie.intime",
                        "cr.charttime",
                        "cr.creat",
                        "cr.aki_stage_creat"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "(ie.icustay_id = cr.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "Index Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Scan Direction": "Forward",
                            "Index Name": "icustays_idx02",
                            "Relation Name": "icustays",
                            "Schema": "mimiciii_clinical",
                            "Alias": "ie",
                            "Output": [
                                "ie.row_id",
                                "ie.subject_id",
                                "ie.hadm_id",
                                "ie.icustay_id",
                                "ie.dbsource",
                                "ie.first_careunit",
                                "ie.last_careunit",
                                "ie.first_wardid",
                                "ie.last_wardid",
                                "ie.intime",
                                "ie.outtime",
                                "ie.los"
                            ]
                        },
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "cr.charttime",
                                "cr.creat",
                                "cr.aki_stage_creat",
                                "cr.icustay_id"
                            ],
                            "Sort Key": [
                                "cr.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "cr_aki",
                                    "Alias": "cr",
                                    "Output": [
                                        "cr.charttime",
                                        "cr.creat",
                                        "cr.aki_stage_creat",
                                        "cr.icustay_id"
                                    ],
                                    "Filter": "(cr.rn = 1)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Sort",
                    "Parent Relationship": "Inner",
                    "Parallel Aware": false,
                    "Output": [
                        "uo.charttime",
                        "uo.uo_rt_6hr",
                        "uo.uo_rt_12hr",
                        "uo.uo_rt_24hr",
                        "uo.aki_stage_uo",
                        "uo.icustay_id"
                    ],
                    "Sort Key": [
                        "uo.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "uo_aki",
                            "Alias": "uo",
                            "Output": [
                                "uo.charttime",
                                "uo.uo_rt_6hr",
                                "uo.uo_rt_12hr",
                                "uo.uo_rt_24hr",
                                "uo.aki_stage_uo",
                                "uo.icustay_id"
                            ],
                            "Filter": "(uo.rn = 1)"
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.pivoted_bg": {
        "sql": "-- The aim of this query is to pivot entries related to blood gases and\n-- chemistry values which were found in LABEVENTS\n\n-- create a table which has fuzzy boundaries on ICU admission\n-- involves first creating a lag/lead version of intime/outtime\nwith i as\n(\n  select\n    subject_id, icustay_id, intime, outtime\n    , lag (outtime) over (partition by subject_id order by intime) as outtime_lag\n    , lead (intime) over (partition by subject_id order by intime) as intime_lead\n  FROM icustays\n)\n, iid_assign as\n(\n  select\n    i.subject_id, i.icustay_id\n    -- this rule is:\n    --  if there are two hospitalizations within 24 hours, set the start/stop\n    --  time as half way between the two admissions\n    , case\n        when i.outtime_lag is not null\n        and i.outtime_lag > (DATETIME_SUB(i.intime, INTERVAL '24' HOUR))\n          then DATETIME_SUB(i.intime, (cast(round((DATETIME_DIFF(i.intime, i.outtime_lag, 'hour')/2)) as integer) || 'HOUR')::INTERVAL)\n      else DATETIME_SUB(i.intime, INTERVAL '12' HOUR)\n      end as data_start\n    , case\n        when i.intime_lead is not null\n        and i.intime_lead < (DATETIME_ADD(i.outtime, INTERVAL '24' HOUR))\n          then DATETIME_ADD(i.outtime, (cast(round((DATETIME_DIFF(i.intime_lead, i.outtime, 'minute')/2)) as integer) || 'MINUTE')::INTERVAL)\n      else (DATETIME_ADD(i.outtime, INTERVAL '12' HOUR))\n      end as data_end\n    from i\n)\n, pvt as\n( -- begin query that extracts the data\n  select le.hadm_id\n  -- here we assign labels to ITEMIDs\n  -- this also fuses together multiple ITEMIDs containing the same data\n      , case\n        when itemid = 50800 then 'SPECIMEN'\n        when itemid = 50801 then 'AADO2'\n        when itemid = 50802 then 'BASEEXCESS'\n        when itemid = 50803 then 'BICARBONATE'\n        when itemid = 50804 then 'TOTALCO2'\n        when itemid = 50805 then 'CARBOXYHEMOGLOBIN'\n        when itemid = 50806 then 'CHLORIDE'\n        when itemid = 50808 then 'CALCIUM'\n        when itemid = 50809 then 'GLUCOSE'\n        when itemid = 50810 then 'HEMATOCRIT'\n        when itemid = 50811 then 'HEMOGLOBIN'\n        when itemid = 50812 then 'INTUBATED'\n        when itemid = 50813 then 'LACTATE'\n        when itemid = 50814 then 'METHEMOGLOBIN'\n        when itemid = 50815 then 'O2FLOW'\n        when itemid = 50816 then 'FIO2'\n        when itemid = 50817 then 'SO2' -- OXYGENSATURATION\n        when itemid = 50818 then 'PCO2'\n        when itemid = 50819 then 'PEEP'\n        when itemid = 50820 then 'PH'\n        when itemid = 50821 then 'PO2'\n        when itemid = 50822 then 'POTASSIUM'\n        when itemid = 50823 then 'REQUIREDO2'\n        when itemid = 50824 then 'SODIUM'\n        when itemid = 50825 then 'TEMPERATURE'\n        when itemid = 50826 then 'TIDALVOLUME'\n        when itemid = 50827 then 'VENTILATIONRATE'\n        when itemid = 50828 then 'VENTILATOR'\n        else null\n        end as label\n        , charttime\n        , value\n        -- add in some sanity checks on the values\n        , case\n          when valuenum <= 0 then null\n          when itemid = 50810 and valuenum > 100 then null -- hematocrit\n          -- ensure FiO2 is a valid number between 21-100\n          -- mistakes are rare (<100 obs out of ~100,000)\n          -- there are 862 obs of valuenum == 20 - some people round down!\n          -- rather than risk imputing garbage data for FiO2, we simply NULL invalid values\n          when itemid = 50816 and valuenum < 20 then null\n          when itemid = 50816 and valuenum > 100 then null\n          when itemid = 50817 and valuenum > 100 then null -- O2 sat\n          when itemid = 50815 and valuenum >  70 then null -- O2 flow\n          when itemid = 50821 and valuenum > 800 then null -- PO2\n           -- conservative upper limit\n        else valuenum\n        end as valuenum\n    FROM labevents le\n    where le.ITEMID in\n    -- blood gases\n    (\n      50800, 50801, 50802, 50803, 50804, 50805, 50806, 50807, 50808, 50809\n      , 50810, 50811, 50812, 50813, 50814, 50815, 50816, 50817, 50818, 50819\n      , 50820, 50821, 50822, 50823, 50824, 50825, 50826, 50827, 50828\n      , 51545\n    )\n)\n, grp as\n(\n  select pvt.hadm_id, pvt.charttime\n  , max(case when label = 'SPECIMEN' then value else null end) as specimen\n  , avg(case when label = 'AADO2' then valuenum else null end) as aado2\n  , avg(case when label = 'BASEEXCESS' then valuenum else null end) as baseexcess\n  , avg(case when label = 'BICARBONATE' then valuenum else null end) as bicarbonate\n  , avg(case when label = 'TOTALCO2' then valuenum else null end) as totalco2\n  , avg(case when label = 'CARBOXYHEMOGLOBIN' then valuenum else null end) as carboxyhemoglobin\n  , avg(case when label = 'CHLORIDE' then valuenum else null end) as chloride\n  , avg(case when label = 'CALCIUM' then valuenum else null end) as calcium\n  , avg(case when label = 'GLUCOSE' then valuenum else null end) as glucose\n  , avg(case when label = 'HEMATOCRIT' then valuenum else null end) as hematocrit\n  , avg(case when label = 'HEMOGLOBIN' then valuenum else null end) as hemoglobin\n  , avg(case when label = 'INTUBATED' then valuenum else null end) as intubated\n  , avg(case when label = 'LACTATE' then valuenum else null end) as lactate\n  , avg(case when label = 'METHEMOGLOBIN' then valuenum else null end) as methemoglobin\n  , avg(case when label = 'O2FLOW' then valuenum else null end) as o2flow\n  , avg(case when label = 'FIO2' then valuenum else null end) as fio2\n  , avg(case when label = 'SO2' then valuenum else null end) as so2 -- OXYGENSATURATION\n  , avg(case when label = 'PCO2' then valuenum else null end) as pco2\n  , avg(case when label = 'PEEP' then valuenum else null end) as peep\n  , avg(case when label = 'PH' then valuenum else null end) as ph\n  , avg(case when label = 'PO2' then valuenum else null end) as po2\n  , avg(case when label = 'POTASSIUM' then valuenum else null end) as potassium\n  , avg(case when label = 'REQUIREDO2' then valuenum else null end) as requiredo2\n  , avg(case when label = 'SODIUM' then valuenum else null end) as sodium\n  , avg(case when label = 'TEMPERATURE' then valuenum else null end) as temperature\n  , avg(case when label = 'TIDALVOLUME' then valuenum else null end) as tidalvolume\n  , max(case when label = 'VENTILATIONRATE' then valuenum else null end) as ventilationrate\n  , max(case when label = 'VENTILATOR' then valuenum else null end) as ventilator\n  from pvt\n  group by pvt.hadm_id, pvt.charttime\n  -- remove observations if there is more than one specimen listed\n  -- we do not know whether these are arterial or mixed venous, etc...\n  -- happily this is a small fraction of the total number of observations\n  having sum(case when label = 'SPECIMEN' then 1 else 0 end)<2\n)\nselect\n  iid.icustay_id, grp.*\nfrom grp\ninner join admissions adm\n  on grp.hadm_id = adm.hadm_id\nleft join iid_assign iid\n  on adm.subject_id = iid.subject_id\n  and grp.charttime >= iid.data_start\n  and grp.charttime < iid.data_end\norder by grp.hadm_id, grp.charttime",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.labevents"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid"
            ],
            "hadm_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid"
            ],
            "charttime": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid"
            ],
            "specimen": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.value"
            ],
            "aado2": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "baseexcess": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "bicarbonate": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "totalco2": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "carboxyhemoglobin": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "chloride": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "calcium": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "glucose": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "hematocrit": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "hemoglobin": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "intubated": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "lactate": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "methemoglobin": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "o2flow": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "fio2": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "so2": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "pco2": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "peep": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "ph": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "po2": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "potassium": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "requiredo2": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "sodium": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "temperature": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "tidalvolume": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "ventilationrate": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ],
            "ventilator": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ]
        },
        "table_name": "mimiciii_clinical.pivoted_bg",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "iid.icustay_id",
                "grp.hadm_id",
                "grp.charttime",
                "grp.specimen",
                "grp.aado2",
                "grp.baseexcess",
                "grp.bicarbonate",
                "grp.totalco2",
                "grp.carboxyhemoglobin",
                "grp.chloride",
                "grp.calcium",
                "grp.glucose",
                "grp.hematocrit",
                "grp.hemoglobin",
                "grp.intubated",
                "grp.lactate",
                "grp.methemoglobin",
                "grp.o2flow",
                "grp.fio2",
                "grp.so2",
                "grp.pco2",
                "grp.peep",
                "grp.ph",
                "grp.po2",
                "grp.potassium",
                "grp.requiredo2",
                "grp.sodium",
                "grp.temperature",
                "grp.tidalvolume",
                "grp.ventilationrate",
                "grp.ventilator"
            ],
            "Sort Key": [
                "grp.hadm_id",
                "grp.charttime"
            ],
            "Plans": [
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE i",
                    "Parallel Aware": false,
                    "Output": [
                        "icustays.subject_id",
                        "icustays.icustay_id",
                        "icustays.intime",
                        "icustays.outtime",
                        "lag(icustays.outtime) OVER (?)",
                        "lead(icustays.intime) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "icustays.subject_id",
                                "icustays.intime",
                                "icustays.icustay_id",
                                "icustays.outtime"
                            ],
                            "Sort Key": [
                                "icustays.subject_id",
                                "icustays.intime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "icustays",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "icustays",
                                    "Output": [
                                        "icustays.subject_id",
                                        "icustays.intime",
                                        "icustays.icustay_id",
                                        "icustays.outtime"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE iid_assign",
                    "Parallel Aware": false,
                    "CTE Name": "i",
                    "Alias": "i",
                    "Output": [
                        "i.subject_id",
                        "i.icustay_id",
                        "CASE WHEN ((i.outtime_lag IS NOT NULL) AND (i.outtime_lag > datetime_sub(i.intime, '24:00:00'::interval hour))) THEN datetime_sub(i.intime, ((((round((datetime_diff(i.intime, i.outtime_lag, 'hour'::text) / '2'::numeric), 0))::integer)::text || 'HOUR'::text))::interval) ELSE datetime_sub(i.intime, '12:00:00'::interval hour) END",
                        "CASE WHEN ((i.intime_lead IS NOT NULL) AND (i.intime_lead < datetime_add(i.outtime, '24:00:00'::interval hour))) THEN datetime_add(i.outtime, ((((round((datetime_diff(i.intime_lead, i.outtime, 'minute'::text) / '2'::numeric), 0))::integer)::text || 'MINUTE'::text))::interval) ELSE datetime_add(i.outtime, '12:00:00'::interval hour) END"
                    ]
                },
                {
                    "Node Type": "Bitmap Heap Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE pvt",
                    "Parallel Aware": false,
                    "Relation Name": "labevents",
                    "Schema": "mimiciii_clinical",
                    "Alias": "le",
                    "Output": [
                        "le.hadm_id",
                        "CASE WHEN (le.itemid = 50800) THEN 'SPECIMEN'::text WHEN (le.itemid = 50801) THEN 'AADO2'::text WHEN (le.itemid = 50802) THEN 'BASEEXCESS'::text WHEN (le.itemid = 50803) THEN 'BICARBONATE'::text WHEN (le.itemid = 50804) THEN 'TOTALCO2'::text WHEN (le.itemid = 50805) THEN 'CARBOXYHEMOGLOBIN'::text WHEN (le.itemid = 50806) THEN 'CHLORIDE'::text WHEN (le.itemid = 50808) THEN 'CALCIUM'::text WHEN (le.itemid = 50809) THEN 'GLUCOSE'::text WHEN (le.itemid = 50810) THEN 'HEMATOCRIT'::text WHEN (le.itemid = 50811) THEN 'HEMOGLOBIN'::text WHEN (le.itemid = 50812) THEN 'INTUBATED'::text WHEN (le.itemid = 50813) THEN 'LACTATE'::text WHEN (le.itemid = 50814) THEN 'METHEMOGLOBIN'::text WHEN (le.itemid = 50815) THEN 'O2FLOW'::text WHEN (le.itemid = 50816) THEN 'FIO2'::text WHEN (le.itemid = 50817) THEN 'SO2'::text WHEN (le.itemid = 50818) THEN 'PCO2'::text WHEN (le.itemid = 50819) THEN 'PEEP'::text WHEN (le.itemid = 50820) THEN 'PH'::text WHEN (le.itemid = 50821) THEN 'PO2'::text WHEN (le.itemid = 50822) THEN 'POTASSIUM'::text WHEN (le.itemid = 50823) THEN 'REQUIREDO2'::text WHEN (le.itemid = 50824) THEN 'SODIUM'::text WHEN (le.itemid = 50825) THEN 'TEMPERATURE'::text WHEN (le.itemid = 50826) THEN 'TIDALVOLUME'::text WHEN (le.itemid = 50827) THEN 'VENTILATIONRATE'::text WHEN (le.itemid = 50828) THEN 'VENTILATOR'::text ELSE NULL::text END",
                        "le.charttime",
                        "le.value",
                        "CASE WHEN (le.valuenum <= '0'::double precision) THEN NULL::double precision WHEN ((le.itemid = 50810) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50816) AND (le.valuenum < '20'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50816) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50817) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50815) AND (le.valuenum > '70'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50821) AND (le.valuenum > '800'::double precision)) THEN NULL::double precision ELSE le.valuenum END"
                    ],
                    "Recheck Cond": "(le.itemid = ANY ('{50800,50801,50802,50803,50804,50805,50806,50807,50808,50809,50810,50811,50812,50813,50814,50815,50816,50817,50818,50819,50820,50821,50822,50823,50824,50825,50826,50827,50828,51545}'::integer[]))",
                    "Plans": [
                        {
                            "Node Type": "Bitmap Index Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Index Name": "labevents_idx03",
                            "Index Cond": "(le.itemid = ANY ('{50800,50801,50802,50803,50804,50805,50806,50807,50808,50809,50810,50811,50812,50813,50814,50815,50816,50817,50818,50819,50820,50821,50822,50823,50824,50825,50826,50827,50828,51545}'::integer[]))"
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE grp",
                    "Parallel Aware": false,
                    "Output": [
                        "pvt.hadm_id",
                        "pvt.charttime",
                        "max((CASE WHEN (pvt.label = 'SPECIMEN'::text) THEN pvt.value ELSE NULL::character varying END)::text)",
                        "avg(CASE WHEN (pvt.label = 'AADO2'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'BASEEXCESS'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'BICARBONATE'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'TOTALCO2'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'CARBOXYHEMOGLOBIN'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'CHLORIDE'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'CALCIUM'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'GLUCOSE'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'HEMATOCRIT'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'HEMOGLOBIN'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'INTUBATED'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'LACTATE'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'METHEMOGLOBIN'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'O2FLOW'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'FIO2'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'SO2'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'PCO2'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'PEEP'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'PH'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'PO2'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'POTASSIUM'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'REQUIREDO2'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'SODIUM'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'TEMPERATURE'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "avg(CASE WHEN (pvt.label = 'TIDALVOLUME'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "max(CASE WHEN (pvt.label = 'VENTILATIONRATE'::text) THEN pvt.valuenum ELSE NULL::double precision END)",
                        "max(CASE WHEN (pvt.label = 'VENTILATOR'::text) THEN pvt.valuenum ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "pvt.hadm_id",
                        "pvt.charttime"
                    ],
                    "Filter": "(sum(CASE WHEN (pvt.label = 'SPECIMEN'::text) THEN 1 ELSE 0 END) < 2)",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "pvt.hadm_id",
                                "pvt.charttime",
                                "pvt.label",
                                "pvt.value",
                                "pvt.valuenum"
                            ],
                            "Sort Key": [
                                "pvt.hadm_id",
                                "pvt.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "pvt",
                                    "Alias": "pvt",
                                    "Output": [
                                        "pvt.hadm_id",
                                        "pvt.charttime",
                                        "pvt.label",
                                        "pvt.value",
                                        "pvt.valuenum"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Join Type": "Right",
                    "Output": [
                        "iid.icustay_id",
                        "grp.hadm_id",
                        "grp.charttime",
                        "grp.specimen",
                        "grp.aado2",
                        "grp.baseexcess",
                        "grp.bicarbonate",
                        "grp.totalco2",
                        "grp.carboxyhemoglobin",
                        "grp.chloride",
                        "grp.calcium",
                        "grp.glucose",
                        "grp.hematocrit",
                        "grp.hemoglobin",
                        "grp.intubated",
                        "grp.lactate",
                        "grp.methemoglobin",
                        "grp.o2flow",
                        "grp.fio2",
                        "grp.so2",
                        "grp.pco2",
                        "grp.peep",
                        "grp.ph",
                        "grp.po2",
                        "grp.potassium",
                        "grp.requiredo2",
                        "grp.sodium",
                        "grp.temperature",
                        "grp.tidalvolume",
                        "grp.ventilationrate",
                        "grp.ventilator"
                    ],
                    "Inner Unique": false,
                    "Hash Cond": "(iid.subject_id = adm.subject_id)",
                    "Join Filter": "((grp.charttime >= iid.data_start) AND (grp.charttime < iid.data_end))",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "iid_assign",
                            "Alias": "iid",
                            "Output": [
                                "iid.icustay_id",
                                "iid.subject_id",
                                "iid.data_start",
                                "iid.data_end"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "grp.hadm_id",
                                "grp.charttime",
                                "grp.specimen",
                                "grp.aado2",
                                "grp.baseexcess",
                                "grp.bicarbonate",
                                "grp.totalco2",
                                "grp.carboxyhemoglobin",
                                "grp.chloride",
                                "grp.calcium",
                                "grp.glucose",
                                "grp.hematocrit",
                                "grp.hemoglobin",
                                "grp.intubated",
                                "grp.lactate",
                                "grp.methemoglobin",
                                "grp.o2flow",
                                "grp.fio2",
                                "grp.so2",
                                "grp.pco2",
                                "grp.peep",
                                "grp.ph",
                                "grp.po2",
                                "grp.potassium",
                                "grp.requiredo2",
                                "grp.sodium",
                                "grp.temperature",
                                "grp.tidalvolume",
                                "grp.ventilationrate",
                                "grp.ventilator",
                                "adm.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "grp.hadm_id",
                                        "grp.charttime",
                                        "grp.specimen",
                                        "grp.aado2",
                                        "grp.baseexcess",
                                        "grp.bicarbonate",
                                        "grp.totalco2",
                                        "grp.carboxyhemoglobin",
                                        "grp.chloride",
                                        "grp.calcium",
                                        "grp.glucose",
                                        "grp.hematocrit",
                                        "grp.hemoglobin",
                                        "grp.intubated",
                                        "grp.lactate",
                                        "grp.methemoglobin",
                                        "grp.o2flow",
                                        "grp.fio2",
                                        "grp.so2",
                                        "grp.pco2",
                                        "grp.peep",
                                        "grp.ph",
                                        "grp.po2",
                                        "grp.potassium",
                                        "grp.requiredo2",
                                        "grp.sodium",
                                        "grp.temperature",
                                        "grp.tidalvolume",
                                        "grp.ventilationrate",
                                        "grp.ventilator",
                                        "adm.subject_id"
                                    ],
                                    "Inner Unique": true,
                                    "Hash Cond": "(grp.hadm_id = adm.hadm_id)",
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "grp",
                                            "Alias": "grp",
                                            "Output": [
                                                "grp.hadm_id",
                                                "grp.charttime",
                                                "grp.specimen",
                                                "grp.aado2",
                                                "grp.baseexcess",
                                                "grp.bicarbonate",
                                                "grp.totalco2",
                                                "grp.carboxyhemoglobin",
                                                "grp.chloride",
                                                "grp.calcium",
                                                "grp.glucose",
                                                "grp.hematocrit",
                                                "grp.hemoglobin",
                                                "grp.intubated",
                                                "grp.lactate",
                                                "grp.methemoglobin",
                                                "grp.o2flow",
                                                "grp.fio2",
                                                "grp.so2",
                                                "grp.pco2",
                                                "grp.peep",
                                                "grp.ph",
                                                "grp.po2",
                                                "grp.potassium",
                                                "grp.requiredo2",
                                                "grp.sodium",
                                                "grp.temperature",
                                                "grp.tidalvolume",
                                                "grp.ventilationrate",
                                                "grp.ventilator"
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "adm.hadm_id",
                                                "adm.subject_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "admissions",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "adm",
                                                    "Output": [
                                                        "adm.hadm_id",
                                                        "adm.subject_id"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.pivoted_bg_art": {
        "sql": "-- This query requires the pivoted_bg table to be generated.\n-- It extracts only arterial blood gas samples - either explicitly stated or \n-- inferred by a hard-coded logistic regression model.\nwith stg_spo2 as\n(\n  select hadm_id, charttime\n    -- avg here is just used to group SpO2 by charttime\n    , avg(valuenum) as spo2\n  FROM chartevents\n  -- o2 sat\n  where ITEMID in\n  (\n    646 -- SpO2\n  , 220277 -- O2 saturation pulseoxymetry\n  )\n  and valuenum > 0 and valuenum <= 100\n  group by hadm_id, charttime\n)\n, stg_fio2 as\n(\n  select hadm_id, charttime\n    -- pre-process the FiO2s to ensure they are between 21-100%\n    , max(\n        case\n          when itemid = 223835\n            then case\n              when valuenum > 0 and valuenum <= 1\n                then valuenum * 100\n              -- improperly input data - looks like O2 flow in litres\n              when valuenum > 1 and valuenum < 21\n                then null\n              when valuenum >= 21 and valuenum <= 100\n                then valuenum\n              else null end -- unphysiological\n        when itemid in (3420, 3422)\n        -- all these values are well formatted\n            then valuenum\n        when itemid = 190 and valuenum > 0.20 and valuenum < 1\n        -- well formatted but not in %\n            then valuenum * 100\n      else null end\n    ) as fio2_chartevents\n  FROM chartevents\n  where ITEMID in\n  (\n    3420 -- FiO2\n  , 190 -- FiO2 set\n  , 223835 -- Inspired O2 Fraction (FiO2)\n  , 3422 -- FiO2 [measured]\n  )\n  and valuenum > 0 and valuenum < 100\n  -- exclude rows marked as error\n  AND (error IS NULL OR error != 1)\n  group by hadm_id, charttime\n)\n, stg2 as\n(\nselect bg.*\n  , row_number() OVER (partition by bg.hadm_id, bg.charttime order by s1.charttime DESC) as lastrowspo2\n  , s1.spo2\nfrom \"mimic\".\"mimiciii_clinical\".\"pivoted_bg\" bg\nleft join stg_spo2 s1\n  -- same hospitalization\n  on  bg.hadm_id = s1.hadm_id\n  -- spo2 occurred at most 2 hours before this blood gas\n  and s1.charttime between DATETIME_SUB(bg.charttime, INTERVAL '2' HOUR) and bg.charttime\nwhere bg.po2 is not null\n)\n, stg3 as\n(\nselect bg.*\n  , row_number() OVER (partition by bg.hadm_id, bg.charttime order by s2.charttime DESC) as lastrowfio2\n  , s2.fio2_chartevents\n\n  -- create our specimen prediction\n  ,  1/(1+exp(-(-0.02544\n  +    0.04598 * po2\n  + coalesce(-0.15356 * spo2             , -0.15356 *   97.49420 +    0.13429)\n  + coalesce( 0.00621 * fio2_chartevents ,  0.00621 *   51.49550 +   -0.24958)\n  + coalesce( 0.10559 * hemoglobin       ,  0.10559 *   10.32307 +    0.05954)\n  + coalesce( 0.13251 * so2              ,  0.13251 *   93.66539 +   -0.23172)\n  + coalesce(-0.01511 * pco2             , -0.01511 *   42.08866 +   -0.01630)\n  + coalesce( 0.01480 * fio2             ,  0.01480 *   63.97836 +   -0.31142)\n  + coalesce(-0.00200 * aado2            , -0.00200 *  442.21186 +   -0.01328)\n  + coalesce(-0.03220 * bicarbonate      , -0.03220 *   22.96894 +   -0.06535)\n  + coalesce( 0.05384 * totalco2         ,  0.05384 *   24.72632 +   -0.01405)\n  + coalesce( 0.08202 * lactate          ,  0.08202 *    3.06436 +    0.06038)\n  + coalesce( 0.10956 * ph               ,  0.10956 *    7.36233 +   -0.00617)\n  + coalesce( 0.00848 * o2flow           ,  0.00848 *    7.59362 +   -0.35803)\n  ))) as specimen_prob\nfrom stg2 bg\nleft join stg_fio2 s2\n  -- same patient\n  on  bg.hadm_id = s2.hadm_id\n  -- fio2 occurred at most 4 hours before this blood gas\n  and s2.charttime between DATETIME_SUB(bg.charttime, INTERVAL '4' HOUR) and bg.charttime\n  and s2.fio2_chartevents > 0\nwhere bg.lastRowSpO2 = 1 -- only the row with the most recent SpO2 (if no SpO2 found lastRowSpO2 = 1)\n)\nselect\n    stg3.hadm_id\n  , stg3.icustay_id\n  , stg3.charttime\n  , specimen -- raw data indicating sample type, only present 80% of the time\n  -- prediction of specimen for missing data\n  , case\n        when SPECIMEN is not null then SPECIMEN\n        when SPECIMEN_PROB > 0.75 then 'ART'\n      else null end as specimen_pred\n  , specimen_prob\n\n  -- oxygen related parameters\n  , so2, spo2 -- note spo2 is FROM chartevents\n  , po2, pco2\n  , fio2_chartevents, fio2\n  , aado2\n  -- also calculate AADO2\n  , case\n      when  PO2 is not null\n        and pco2 is not null\n        and coalesce(FIO2, fio2_chartevents) is not null\n       -- multiple by 100 because FiO2 is in a % but should be a fraction\n        then (coalesce(FIO2, fio2_chartevents)/100) * (760 - 47) - (pco2/0.8) - po2\n      else null\n    end as aado2_calc\n  , case\n      when PO2 is not null and coalesce(FIO2, fio2_chartevents) is not null\n       -- multiply by 100 because FiO2 is in a % but should be a fraction\n        then 100*PO2/(coalesce(FIO2, fio2_chartevents))\n      else null\n    end as pao2fio2ratio\n  -- acid-base parameters\n  , ph, baseexcess\n  , bicarbonate, totalco2\n\n  -- blood count parameters\n  , hematocrit\n  , hemoglobin\n  , carboxyhemoglobin\n  , methemoglobin\n\n  -- chemistry\n  , chloride, calcium\n  , temperature\n  , potassium, sodium\n  , lactate\n  , glucose\n\n  -- ventilation stuff that's sometimes input\n  , intubated, tidalvolume, ventilationrate, ventilator\n  , peep, o2flow\n  , requiredo2\nfrom stg3\nwhere lastRowFiO2 = 1 -- only the most recent FiO2\n-- restrict it to *only* arterial samples\nand (specimen = 'ART' or specimen_prob > 0.75)\norder by hadm_id, charttime",
        "tables": [
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.pivoted_bg"
        ],
        "columns": {
            "hadm_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "icustay_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.icustay_id",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "charttime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "specimen": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "specimen_pred": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "specimen_prob": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "so2": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "spo2": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "po2": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "pco2": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "fio2_chartevents": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "fio2": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "aado2": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "aado2_calc": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "pao2fio2ratio": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "ph": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "baseexcess": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.baseexcess",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "bicarbonate": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "totalco2": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "hematocrit": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hematocrit",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "hemoglobin": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "carboxyhemoglobin": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.carboxyhemoglobin",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "methemoglobin": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.methemoglobin",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "chloride": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.chloride",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "calcium": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.calcium",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "temperature": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.temperature",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "potassium": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.potassium",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "sodium": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.sodium",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "lactate": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "glucose": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.glucose",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "intubated": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.intubated",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "tidalvolume": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.tidalvolume",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "ventilationrate": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2",
                "mimiciii_clinical.pivoted_bg.ventilationrate"
            ],
            "ventilator": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2",
                "mimiciii_clinical.pivoted_bg.ventilator"
            ],
            "peep": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.peep",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "o2flow": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ],
            "requiredo2": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.pivoted_bg.aado2",
                "mimiciii_clinical.pivoted_bg.bicarbonate",
                "mimiciii_clinical.pivoted_bg.charttime",
                "mimiciii_clinical.pivoted_bg.fio2",
                "mimiciii_clinical.pivoted_bg.hadm_id",
                "mimiciii_clinical.pivoted_bg.hemoglobin",
                "mimiciii_clinical.pivoted_bg.lactate",
                "mimiciii_clinical.pivoted_bg.o2flow",
                "mimiciii_clinical.pivoted_bg.pco2",
                "mimiciii_clinical.pivoted_bg.ph",
                "mimiciii_clinical.pivoted_bg.po2",
                "mimiciii_clinical.pivoted_bg.requiredo2",
                "mimiciii_clinical.pivoted_bg.so2",
                "mimiciii_clinical.pivoted_bg.specimen",
                "mimiciii_clinical.pivoted_bg.totalco2"
            ]
        },
        "table_name": "mimiciii_clinical.pivoted_bg_art",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "stg3.hadm_id",
                "stg3.icustay_id",
                "stg3.charttime",
                "stg3.specimen",
                "(CASE WHEN (stg3.specimen IS NOT NULL) THEN stg3.specimen WHEN (stg3.specimen_prob > '0.75'::double precision) THEN 'ART'::text ELSE NULL::text END)",
                "stg3.specimen_prob",
                "stg3.so2",
                "stg3.spo2",
                "stg3.po2",
                "stg3.pco2",
                "stg3.fio2_chartevents",
                "stg3.fio2",
                "stg3.aado2",
                "(CASE WHEN ((stg3.po2 IS NOT NULL) AND (stg3.pco2 IS NOT NULL) AND (COALESCE(stg3.fio2, stg3.fio2_chartevents) IS NOT NULL)) THEN ((((COALESCE(stg3.fio2, stg3.fio2_chartevents) / '100'::double precision) * '713'::double precision) - (stg3.pco2 / '0.8'::double precision)) - stg3.po2) ELSE NULL::double precision END)",
                "(CASE WHEN ((stg3.po2 IS NOT NULL) AND (COALESCE(stg3.fio2, stg3.fio2_chartevents) IS NOT NULL)) THEN (('100'::double precision * stg3.po2) / COALESCE(stg3.fio2, stg3.fio2_chartevents)) ELSE NULL::double precision END)",
                "stg3.ph",
                "stg3.baseexcess",
                "stg3.bicarbonate",
                "stg3.totalco2",
                "stg3.hematocrit",
                "stg3.hemoglobin",
                "stg3.carboxyhemoglobin",
                "stg3.methemoglobin",
                "stg3.chloride",
                "stg3.calcium",
                "stg3.temperature",
                "stg3.potassium",
                "stg3.sodium",
                "stg3.lactate",
                "stg3.glucose",
                "stg3.intubated",
                "stg3.tidalvolume",
                "stg3.ventilationrate",
                "stg3.ventilator",
                "stg3.peep",
                "stg3.o2flow",
                "stg3.requiredo2"
            ],
            "Sort Key": [
                "stg3.hadm_id",
                "stg3.charttime"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE stg_spo2",
                    "Parallel Aware": false,
                    "Output": [
                        "chartevents_69.hadm_id",
                        "chartevents_69.charttime",
                        "avg(chartevents_69.valuenum)"
                    ],
                    "Group Key": [
                        "chartevents_69.hadm_id",
                        "chartevents_69.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "chartevents_69.hadm_id",
                                "chartevents_69.charttime",
                                "chartevents_69.valuenum"
                            ],
                            "Sort Key": [
                                "chartevents_69.hadm_id",
                                "chartevents_69.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Append",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_69",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "chartevents_69",
                                            "Output": [
                                                "chartevents_69.hadm_id",
                                                "chartevents_69.charttime",
                                                "chartevents_69.valuenum"
                                            ],
                                            "Filter": "((chartevents_69.itemid = ANY ('{646,220277}'::integer[])) AND (chartevents_69.valuenum > '0'::double precision) AND (chartevents_69.valuenum <= '100'::double precision))"
                                        },
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "Relation Name": "chartevents_170",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "chartevents_170",
                                            "Output": [
                                                "chartevents_170.hadm_id",
                                                "chartevents_170.charttime",
                                                "chartevents_170.valuenum"
                                            ],
                                            "Filter": "((chartevents_170.itemid = ANY ('{646,220277}'::integer[])) AND (chartevents_170.valuenum > '0'::double precision) AND (chartevents_170.valuenum <= '100'::double precision))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE stg_fio2",
                    "Parallel Aware": false,
                    "Output": [
                        "chartevents_27.hadm_id",
                        "chartevents_27.charttime",
                        "max(CASE WHEN (chartevents_27.itemid = 223835) THEN CASE WHEN ((chartevents_27.valuenum > '0'::double precision) AND (chartevents_27.valuenum <= '1'::double precision)) THEN (chartevents_27.valuenum * '100'::double precision) WHEN ((chartevents_27.valuenum > '1'::double precision) AND (chartevents_27.valuenum < '21'::double precision)) THEN NULL::double precision WHEN ((chartevents_27.valuenum >= '21'::double precision) AND (chartevents_27.valuenum <= '100'::double precision)) THEN chartevents_27.valuenum ELSE NULL::double precision END WHEN (chartevents_27.itemid = ANY ('{3420,3422}'::integer[])) THEN chartevents_27.valuenum WHEN ((chartevents_27.itemid = 190) AND (chartevents_27.valuenum > '0.2'::double precision) AND (chartevents_27.valuenum < '1'::double precision)) THEN (chartevents_27.valuenum * '100'::double precision) ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "chartevents_27.hadm_id",
                        "chartevents_27.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Append",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_27",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "chartevents_27",
                                    "Output": [
                                        "chartevents_27.hadm_id",
                                        "chartevents_27.charttime",
                                        "chartevents_27.itemid",
                                        "chartevents_27.valuenum"
                                    ],
                                    "Recheck Cond": "(chartevents_27.itemid = ANY ('{3420,190,223835,3422}'::integer[]))",
                                    "Filter": "((chartevents_27.valuenum > '0'::double precision) AND (chartevents_27.valuenum < '100'::double precision) AND ((chartevents_27.error IS NULL) OR (chartevents_27.error <> 1)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_27_idx01",
                                            "Index Cond": "(chartevents_27.itemid = ANY ('{3420,190,223835,3422}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_107",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "chartevents_107",
                                    "Output": [
                                        "chartevents_107.hadm_id",
                                        "chartevents_107.charttime",
                                        "chartevents_107.itemid",
                                        "chartevents_107.valuenum"
                                    ],
                                    "Filter": "((chartevents_107.valuenum > '0'::double precision) AND (chartevents_107.valuenum < '100'::double precision) AND ((chartevents_107.error IS NULL) OR (chartevents_107.error <> 1)) AND (chartevents_107.itemid = ANY ('{3420,190,223835,3422}'::integer[])))"
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_108",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "chartevents_108",
                                    "Output": [
                                        "chartevents_108.hadm_id",
                                        "chartevents_108.charttime",
                                        "chartevents_108.itemid",
                                        "chartevents_108.valuenum"
                                    ],
                                    "Recheck Cond": "(chartevents_108.itemid = ANY ('{3420,190,223835,3422}'::integer[]))",
                                    "Filter": "((chartevents_108.valuenum > '0'::double precision) AND (chartevents_108.valuenum < '100'::double precision) AND ((chartevents_108.error IS NULL) OR (chartevents_108.error <> 1)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_108_idx01",
                                            "Index Cond": "(chartevents_108.itemid = ANY ('{3420,190,223835,3422}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_175",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "chartevents_175",
                                    "Output": [
                                        "chartevents_175.hadm_id",
                                        "chartevents_175.charttime",
                                        "chartevents_175.itemid",
                                        "chartevents_175.valuenum"
                                    ],
                                    "Recheck Cond": "(chartevents_175.itemid = ANY ('{3420,190,223835,3422}'::integer[]))",
                                    "Filter": "((chartevents_175.valuenum > '0'::double precision) AND (chartevents_175.valuenum < '100'::double precision) AND ((chartevents_175.error IS NULL) OR (chartevents_175.error <> 1)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_175_idx01",
                                            "Index Cond": "(chartevents_175.itemid = ANY ('{3420,190,223835,3422}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE stg2",
                    "Parallel Aware": false,
                    "Output": [
                        "bg.icustay_id",
                        "bg.hadm_id",
                        "bg.charttime",
                        "bg.specimen",
                        "bg.aado2",
                        "bg.baseexcess",
                        "bg.bicarbonate",
                        "bg.totalco2",
                        "bg.carboxyhemoglobin",
                        "bg.chloride",
                        "bg.calcium",
                        "bg.glucose",
                        "bg.hematocrit",
                        "bg.hemoglobin",
                        "bg.intubated",
                        "bg.lactate",
                        "bg.methemoglobin",
                        "bg.o2flow",
                        "bg.fio2",
                        "bg.so2",
                        "bg.pco2",
                        "bg.peep",
                        "bg.ph",
                        "bg.po2",
                        "bg.potassium",
                        "bg.requiredo2",
                        "bg.sodium",
                        "bg.temperature",
                        "bg.tidalvolume",
                        "bg.ventilationrate",
                        "bg.ventilator",
                        "row_number() OVER (?)",
                        "s1.spo2",
                        "s1.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "bg.hadm_id",
                                "bg.charttime",
                                "s1.charttime",
                                "bg.icustay_id",
                                "bg.specimen",
                                "bg.aado2",
                                "bg.baseexcess",
                                "bg.bicarbonate",
                                "bg.totalco2",
                                "bg.carboxyhemoglobin",
                                "bg.chloride",
                                "bg.calcium",
                                "bg.glucose",
                                "bg.hematocrit",
                                "bg.hemoglobin",
                                "bg.intubated",
                                "bg.lactate",
                                "bg.methemoglobin",
                                "bg.o2flow",
                                "bg.fio2",
                                "bg.so2",
                                "bg.pco2",
                                "bg.peep",
                                "bg.ph",
                                "bg.po2",
                                "bg.potassium",
                                "bg.requiredo2",
                                "bg.sodium",
                                "bg.temperature",
                                "bg.tidalvolume",
                                "bg.ventilationrate",
                                "bg.ventilator",
                                "s1.spo2"
                            ],
                            "Sort Key": [
                                "bg.hadm_id",
                                "bg.charttime",
                                "s1.charttime DESC"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Right",
                                    "Output": [
                                        "bg.hadm_id",
                                        "bg.charttime",
                                        "s1.charttime",
                                        "bg.icustay_id",
                                        "bg.specimen",
                                        "bg.aado2",
                                        "bg.baseexcess",
                                        "bg.bicarbonate",
                                        "bg.totalco2",
                                        "bg.carboxyhemoglobin",
                                        "bg.chloride",
                                        "bg.calcium",
                                        "bg.glucose",
                                        "bg.hematocrit",
                                        "bg.hemoglobin",
                                        "bg.intubated",
                                        "bg.lactate",
                                        "bg.methemoglobin",
                                        "bg.o2flow",
                                        "bg.fio2",
                                        "bg.so2",
                                        "bg.pco2",
                                        "bg.peep",
                                        "bg.ph",
                                        "bg.po2",
                                        "bg.potassium",
                                        "bg.requiredo2",
                                        "bg.sodium",
                                        "bg.temperature",
                                        "bg.tidalvolume",
                                        "bg.ventilationrate",
                                        "bg.ventilator",
                                        "s1.spo2"
                                    ],
                                    "Inner Unique": false,
                                    "Hash Cond": "(s1.hadm_id = bg.hadm_id)",
                                    "Join Filter": "((s1.charttime <= bg.charttime) AND (s1.charttime >= datetime_sub(bg.charttime, '02:00:00'::interval hour)))",
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "stg_spo2",
                                            "Alias": "s1",
                                            "Output": [
                                                "s1.spo2",
                                                "s1.charttime",
                                                "s1.hadm_id"
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "bg.icustay_id",
                                                "bg.hadm_id",
                                                "bg.charttime",
                                                "bg.specimen",
                                                "bg.aado2",
                                                "bg.baseexcess",
                                                "bg.bicarbonate",
                                                "bg.totalco2",
                                                "bg.carboxyhemoglobin",
                                                "bg.chloride",
                                                "bg.calcium",
                                                "bg.glucose",
                                                "bg.hematocrit",
                                                "bg.hemoglobin",
                                                "bg.intubated",
                                                "bg.lactate",
                                                "bg.methemoglobin",
                                                "bg.o2flow",
                                                "bg.fio2",
                                                "bg.so2",
                                                "bg.pco2",
                                                "bg.peep",
                                                "bg.ph",
                                                "bg.po2",
                                                "bg.potassium",
                                                "bg.requiredo2",
                                                "bg.sodium",
                                                "bg.temperature",
                                                "bg.tidalvolume",
                                                "bg.ventilationrate",
                                                "bg.ventilator"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "pivoted_bg",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "bg",
                                                    "Output": [
                                                        "bg.icustay_id",
                                                        "bg.hadm_id",
                                                        "bg.charttime",
                                                        "bg.specimen",
                                                        "bg.aado2",
                                                        "bg.baseexcess",
                                                        "bg.bicarbonate",
                                                        "bg.totalco2",
                                                        "bg.carboxyhemoglobin",
                                                        "bg.chloride",
                                                        "bg.calcium",
                                                        "bg.glucose",
                                                        "bg.hematocrit",
                                                        "bg.hemoglobin",
                                                        "bg.intubated",
                                                        "bg.lactate",
                                                        "bg.methemoglobin",
                                                        "bg.o2flow",
                                                        "bg.fio2",
                                                        "bg.so2",
                                                        "bg.pco2",
                                                        "bg.peep",
                                                        "bg.ph",
                                                        "bg.po2",
                                                        "bg.potassium",
                                                        "bg.requiredo2",
                                                        "bg.sodium",
                                                        "bg.temperature",
                                                        "bg.tidalvolume",
                                                        "bg.ventilationrate",
                                                        "bg.ventilator"
                                                    ],
                                                    "Filter": "(bg.po2 IS NOT NULL)"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE stg3",
                    "Parallel Aware": false,
                    "Output": [
                        "bg_1.icustay_id",
                        "bg_1.hadm_id",
                        "bg_1.charttime",
                        "bg_1.specimen",
                        "bg_1.aado2",
                        "bg_1.baseexcess",
                        "bg_1.bicarbonate",
                        "bg_1.totalco2",
                        "bg_1.carboxyhemoglobin",
                        "bg_1.chloride",
                        "bg_1.calcium",
                        "bg_1.glucose",
                        "bg_1.hematocrit",
                        "bg_1.hemoglobin",
                        "bg_1.intubated",
                        "bg_1.lactate",
                        "bg_1.methemoglobin",
                        "bg_1.o2flow",
                        "bg_1.fio2",
                        "bg_1.so2",
                        "bg_1.pco2",
                        "bg_1.peep",
                        "bg_1.ph",
                        "bg_1.po2",
                        "bg_1.potassium",
                        "bg_1.requiredo2",
                        "bg_1.sodium",
                        "bg_1.temperature",
                        "bg_1.tidalvolume",
                        "bg_1.ventilationrate",
                        "bg_1.ventilator",
                        "bg_1.lastrowspo2",
                        "bg_1.spo2",
                        "row_number() OVER (?)",
                        "s2.fio2_chartevents",
                        "('1'::double precision / ('1'::double precision + exp((- ((((((((((((('-0.02544'::double precision + ('0.04598'::double precision * bg_1.po2)) + COALESCE(('-0.15356'::double precision * bg_1.spo2), '-14.836919352'::double precision)) + COALESCE(('0.00621'::double precision * s2.fio2_chartevents), '0.070207055'::double precision)) + COALESCE(('0.10559'::double precision * bg_1.hemoglobin), '1.1495529613'::double precision)) + COALESCE(('0.13251'::double precision * bg_1.so2), '12.1798808289'::double precision)) + COALESCE(('-0.01511'::double precision * bg_1.pco2), '-0.6522596526'::double precision)) + COALESCE(('0.0148'::double precision * bg_1.fio2), '0.635459728'::double precision)) + COALESCE(('-0.002'::double precision * bg_1.aado2), '-0.89770372'::double precision)) + COALESCE(('-0.0322'::double precision * bg_1.bicarbonate), '-0.804949868'::double precision)) + COALESCE(('0.05384'::double precision * bg_1.totalco2), '1.3172150688'::double precision)) + COALESCE(('0.08202'::double precision * bg_1.lactate), '0.3117188072'::double precision)) + COALESCE(('0.10956'::double precision * bg_1.ph), '0.8004468748'::double precision)) + COALESCE(('0.00848'::double precision * bg_1.o2flow), '-0.2936361024'::double precision))))))",
                        "s2.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "bg_1.hadm_id",
                                "bg_1.charttime",
                                "s2.charttime",
                                "bg_1.icustay_id",
                                "bg_1.specimen",
                                "bg_1.aado2",
                                "bg_1.baseexcess",
                                "bg_1.bicarbonate",
                                "bg_1.totalco2",
                                "bg_1.carboxyhemoglobin",
                                "bg_1.chloride",
                                "bg_1.calcium",
                                "bg_1.glucose",
                                "bg_1.hematocrit",
                                "bg_1.hemoglobin",
                                "bg_1.intubated",
                                "bg_1.lactate",
                                "bg_1.methemoglobin",
                                "bg_1.o2flow",
                                "bg_1.fio2",
                                "bg_1.so2",
                                "bg_1.pco2",
                                "bg_1.peep",
                                "bg_1.ph",
                                "bg_1.po2",
                                "bg_1.potassium",
                                "bg_1.requiredo2",
                                "bg_1.sodium",
                                "bg_1.temperature",
                                "bg_1.tidalvolume",
                                "bg_1.ventilationrate",
                                "bg_1.ventilator",
                                "bg_1.lastrowspo2",
                                "bg_1.spo2",
                                "s2.fio2_chartevents"
                            ],
                            "Sort Key": [
                                "bg_1.hadm_id",
                                "bg_1.charttime",
                                "s2.charttime DESC"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Merge Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Left",
                                    "Output": [
                                        "bg_1.hadm_id",
                                        "bg_1.charttime",
                                        "s2.charttime",
                                        "bg_1.icustay_id",
                                        "bg_1.specimen",
                                        "bg_1.aado2",
                                        "bg_1.baseexcess",
                                        "bg_1.bicarbonate",
                                        "bg_1.totalco2",
                                        "bg_1.carboxyhemoglobin",
                                        "bg_1.chloride",
                                        "bg_1.calcium",
                                        "bg_1.glucose",
                                        "bg_1.hematocrit",
                                        "bg_1.hemoglobin",
                                        "bg_1.intubated",
                                        "bg_1.lactate",
                                        "bg_1.methemoglobin",
                                        "bg_1.o2flow",
                                        "bg_1.fio2",
                                        "bg_1.so2",
                                        "bg_1.pco2",
                                        "bg_1.peep",
                                        "bg_1.ph",
                                        "bg_1.po2",
                                        "bg_1.potassium",
                                        "bg_1.requiredo2",
                                        "bg_1.sodium",
                                        "bg_1.temperature",
                                        "bg_1.tidalvolume",
                                        "bg_1.ventilationrate",
                                        "bg_1.ventilator",
                                        "bg_1.lastrowspo2",
                                        "bg_1.spo2",
                                        "s2.fio2_chartevents"
                                    ],
                                    "Inner Unique": false,
                                    "Merge Cond": "(bg_1.hadm_id = s2.hadm_id)",
                                    "Join Filter": "((s2.charttime <= bg_1.charttime) AND (s2.charttime >= datetime_sub(bg_1.charttime, '04:00:00'::interval hour)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "bg_1.icustay_id",
                                                "bg_1.hadm_id",
                                                "bg_1.charttime",
                                                "bg_1.specimen",
                                                "bg_1.aado2",
                                                "bg_1.baseexcess",
                                                "bg_1.bicarbonate",
                                                "bg_1.totalco2",
                                                "bg_1.carboxyhemoglobin",
                                                "bg_1.chloride",
                                                "bg_1.calcium",
                                                "bg_1.glucose",
                                                "bg_1.hematocrit",
                                                "bg_1.hemoglobin",
                                                "bg_1.intubated",
                                                "bg_1.lactate",
                                                "bg_1.methemoglobin",
                                                "bg_1.o2flow",
                                                "bg_1.fio2",
                                                "bg_1.so2",
                                                "bg_1.pco2",
                                                "bg_1.peep",
                                                "bg_1.ph",
                                                "bg_1.po2",
                                                "bg_1.potassium",
                                                "bg_1.requiredo2",
                                                "bg_1.sodium",
                                                "bg_1.temperature",
                                                "bg_1.tidalvolume",
                                                "bg_1.ventilationrate",
                                                "bg_1.ventilator",
                                                "bg_1.lastrowspo2",
                                                "bg_1.spo2"
                                            ],
                                            "Sort Key": [
                                                "bg_1.hadm_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "stg2",
                                                    "Alias": "bg_1",
                                                    "Output": [
                                                        "bg_1.icustay_id",
                                                        "bg_1.hadm_id",
                                                        "bg_1.charttime",
                                                        "bg_1.specimen",
                                                        "bg_1.aado2",
                                                        "bg_1.baseexcess",
                                                        "bg_1.bicarbonate",
                                                        "bg_1.totalco2",
                                                        "bg_1.carboxyhemoglobin",
                                                        "bg_1.chloride",
                                                        "bg_1.calcium",
                                                        "bg_1.glucose",
                                                        "bg_1.hematocrit",
                                                        "bg_1.hemoglobin",
                                                        "bg_1.intubated",
                                                        "bg_1.lactate",
                                                        "bg_1.methemoglobin",
                                                        "bg_1.o2flow",
                                                        "bg_1.fio2",
                                                        "bg_1.so2",
                                                        "bg_1.pco2",
                                                        "bg_1.peep",
                                                        "bg_1.ph",
                                                        "bg_1.po2",
                                                        "bg_1.potassium",
                                                        "bg_1.requiredo2",
                                                        "bg_1.sodium",
                                                        "bg_1.temperature",
                                                        "bg_1.tidalvolume",
                                                        "bg_1.ventilationrate",
                                                        "bg_1.ventilator",
                                                        "bg_1.lastrowspo2",
                                                        "bg_1.spo2"
                                                    ],
                                                    "Filter": "(bg_1.lastrowspo2 = 1)"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "s2.fio2_chartevents",
                                                "s2.charttime",
                                                "s2.hadm_id"
                                            ],
                                            "Sort Key": [
                                                "s2.hadm_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "stg_fio2",
                                                    "Alias": "s2",
                                                    "Output": [
                                                        "s2.fio2_chartevents",
                                                        "s2.charttime",
                                                        "s2.hadm_id"
                                                    ],
                                                    "Filter": "(s2.fio2_chartevents > '0'::double precision)"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "CTE Name": "stg3",
                    "Alias": "stg3",
                    "Output": [
                        "stg3.hadm_id",
                        "stg3.icustay_id",
                        "stg3.charttime",
                        "stg3.specimen",
                        "CASE WHEN (stg3.specimen IS NOT NULL) THEN stg3.specimen WHEN (stg3.specimen_prob > '0.75'::double precision) THEN 'ART'::text ELSE NULL::text END",
                        "stg3.specimen_prob",
                        "stg3.so2",
                        "stg3.spo2",
                        "stg3.po2",
                        "stg3.pco2",
                        "stg3.fio2_chartevents",
                        "stg3.fio2",
                        "stg3.aado2",
                        "CASE WHEN ((stg3.po2 IS NOT NULL) AND (stg3.pco2 IS NOT NULL) AND (COALESCE(stg3.fio2, stg3.fio2_chartevents) IS NOT NULL)) THEN ((((COALESCE(stg3.fio2, stg3.fio2_chartevents) / '100'::double precision) * '713'::double precision) - (stg3.pco2 / '0.8'::double precision)) - stg3.po2) ELSE NULL::double precision END",
                        "CASE WHEN ((stg3.po2 IS NOT NULL) AND (COALESCE(stg3.fio2, stg3.fio2_chartevents) IS NOT NULL)) THEN (('100'::double precision * stg3.po2) / COALESCE(stg3.fio2, stg3.fio2_chartevents)) ELSE NULL::double precision END",
                        "stg3.ph",
                        "stg3.baseexcess",
                        "stg3.bicarbonate",
                        "stg3.totalco2",
                        "stg3.hematocrit",
                        "stg3.hemoglobin",
                        "stg3.carboxyhemoglobin",
                        "stg3.methemoglobin",
                        "stg3.chloride",
                        "stg3.calcium",
                        "stg3.temperature",
                        "stg3.potassium",
                        "stg3.sodium",
                        "stg3.lactate",
                        "stg3.glucose",
                        "stg3.intubated",
                        "stg3.tidalvolume",
                        "stg3.ventilationrate",
                        "stg3.ventilator",
                        "stg3.peep",
                        "stg3.o2flow",
                        "stg3.requiredo2"
                    ],
                    "Filter": "((stg3.lastrowfio2 = 1) AND ((stg3.specimen = 'ART'::text) OR (stg3.specimen_prob > '0.75'::double precision)))"
                }
            ]
        }
    },
    "model.mimic.pivoted_fio2": {
        "sql": "with pvt as\n( -- begin query that extracts the data\n  select le.hadm_id\n  , le.charttime\n  -- here we assign labels to ITEMIDs\n  -- this also fuses together multiple ITEMIDs containing the same data\n    -- add in some sanity checks on the values\n    , ROUND(MAX((case\n        when valuenum <= 0 then null\n        -- ensure FiO2 is a valid number between 21-100\n        -- mistakes are rare (<100 obs out of ~100,000)\n        -- there are 862 obs of valuenum == 20 - some people round down!\n        -- rather than risk imputing garbage data for FiO2, we simply NULL invalid values\n        when itemid = 50816 and valuenum < 20 then null\n        when itemid = 50816 and valuenum > 100 then null\n    ELSE valuenum END))::numeric, 2) AS valuenum\n    FROM labevents le\n    where le.ITEMID = 50816\n    GROUP BY le.hadm_id, le.charttime\n)\n, stg_fio2 as\n(\n  select hadm_id, charttime\n    -- pre-process the FiO2s to ensure they are between 21-100%\n    , ROUND((MAX(\n        case\n          when itemid = 223835\n            then case\n              when valuenum > 0 and valuenum <= 1\n                then valuenum * 100\n              -- improperly input data - looks like O2 flow in litres\n              when valuenum > 1 and valuenum < 21\n                then null\n              when valuenum >= 21 and valuenum <= 100\n                then valuenum\n              else null end -- unphysiological\n        when itemid in (3420, 3422)\n        -- all these values are well formatted\n            then valuenum\n        when itemid = 190 and valuenum > 0.20 and valuenum < 1\n        -- well formatted but not in %\n            then valuenum * 100\n      else null end\n    ))::numeric, 2) as fio2_chartevents\n  FROM chartevents\n  where ITEMID in\n  (\n    3420 -- FiO2\n  , 190 -- FiO2 set\n  , 223835 -- Inspired O2 Fraction (FiO2)\n  , 3422 -- FiO2 [measured]\n  )\n  and valuenum > 0 and valuenum < 100\n  -- exclude rows marked as error\n  AND (error IS NULL OR error != 1)\n  group by hadm_id, charttime\n)\nselect\n  ie.icustay_id\n  , COALESCE(pvt.charttime, fi.charttime) AS charttime\n  , COALESCE(pvt.valuenum, fi.fio2_chartevents) AS fio2\nfrom \n(\n    -- one row per icustay_id/charttime\n    SELECT hadm_id, charttime\n    from pvt\n    UNION DISTINCT\n    SELECT hadm_id, charttime\n    from stg_fio2\n) base\nINNER JOIN icustays ie\n  on base.hadm_id = ie.hadm_id\n  AND base.charttime >= DATETIME_SUB(ie.intime, INTERVAL '12' HOUR)\n  AND base.charttime <= DATETIME_ADD(ie.outtime, INTERVAL '12' HOUR)\nLEFT JOIN pvt\n  ON base.hadm_id = pvt.hadm_id\n  AND base.charttime = pvt.charttime\nLEFT JOIN stg_fio2 fi\n  ON base.hadm_id = fi.hadm_id\n  AND base.charttime = fi.charttime\nORDER BY icustay_id, charttime",
        "tables": [
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.labevents"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid"
            ],
            "charttime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid"
            ],
            "fio2": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.hadm_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.labevents.charttime",
                "mimiciii_clinical.labevents.hadm_id",
                "mimiciii_clinical.labevents.itemid",
                "mimiciii_clinical.labevents.valuenum"
            ]
        },
        "table_name": "mimiciii_clinical.pivoted_fio2",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "ie.icustay_id",
                "(COALESCE(pvt.charttime, fi.charttime))",
                "(COALESCE(pvt.valuenum, fi.fio2_chartevents))"
            ],
            "Sort Key": [
                "ie.icustay_id",
                "(COALESCE(pvt.charttime, fi.charttime))"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE pvt",
                    "Parallel Aware": false,
                    "Output": [
                        "le.hadm_id",
                        "le.charttime",
                        "round((max(CASE WHEN (le.valuenum <= '0'::double precision) THEN NULL::double precision WHEN ((le.itemid = 50816) AND (le.valuenum < '20'::double precision)) THEN NULL::double precision WHEN ((le.itemid = 50816) AND (le.valuenum > '100'::double precision)) THEN NULL::double precision ELSE le.valuenum END))::numeric, 2)"
                    ],
                    "Group Key": [
                        "le.hadm_id",
                        "le.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "le.hadm_id",
                                "le.charttime",
                                "le.valuenum",
                                "le.itemid"
                            ],
                            "Sort Key": [
                                "le.hadm_id",
                                "le.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "labevents",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "le",
                                    "Output": [
                                        "le.hadm_id",
                                        "le.charttime",
                                        "le.valuenum",
                                        "le.itemid"
                                    ],
                                    "Recheck Cond": "(le.itemid = 50816)",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "labevents_idx03",
                                            "Index Cond": "(le.itemid = 50816)"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE stg_fio2",
                    "Parallel Aware": false,
                    "Output": [
                        "chartevents_27.hadm_id",
                        "chartevents_27.charttime",
                        "round((max(CASE WHEN (chartevents_27.itemid = 223835) THEN CASE WHEN ((chartevents_27.valuenum > '0'::double precision) AND (chartevents_27.valuenum <= '1'::double precision)) THEN (chartevents_27.valuenum * '100'::double precision) WHEN ((chartevents_27.valuenum > '1'::double precision) AND (chartevents_27.valuenum < '21'::double precision)) THEN NULL::double precision WHEN ((chartevents_27.valuenum >= '21'::double precision) AND (chartevents_27.valuenum <= '100'::double precision)) THEN chartevents_27.valuenum ELSE NULL::double precision END WHEN (chartevents_27.itemid = ANY ('{3420,3422}'::integer[])) THEN chartevents_27.valuenum WHEN ((chartevents_27.itemid = 190) AND (chartevents_27.valuenum > '0.2'::double precision) AND (chartevents_27.valuenum < '1'::double precision)) THEN (chartevents_27.valuenum * '100'::double precision) ELSE NULL::double precision END))::numeric, 2)"
                    ],
                    "Group Key": [
                        "chartevents_27.hadm_id",
                        "chartevents_27.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Append",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_27",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "chartevents_27",
                                    "Output": [
                                        "chartevents_27.hadm_id",
                                        "chartevents_27.charttime",
                                        "chartevents_27.itemid",
                                        "chartevents_27.valuenum"
                                    ],
                                    "Recheck Cond": "(chartevents_27.itemid = ANY ('{3420,190,223835,3422}'::integer[]))",
                                    "Filter": "((chartevents_27.valuenum > '0'::double precision) AND (chartevents_27.valuenum < '100'::double precision) AND ((chartevents_27.error IS NULL) OR (chartevents_27.error <> 1)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_27_idx01",
                                            "Index Cond": "(chartevents_27.itemid = ANY ('{3420,190,223835,3422}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_107",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "chartevents_107",
                                    "Output": [
                                        "chartevents_107.hadm_id",
                                        "chartevents_107.charttime",
                                        "chartevents_107.itemid",
                                        "chartevents_107.valuenum"
                                    ],
                                    "Filter": "((chartevents_107.valuenum > '0'::double precision) AND (chartevents_107.valuenum < '100'::double precision) AND ((chartevents_107.error IS NULL) OR (chartevents_107.error <> 1)) AND (chartevents_107.itemid = ANY ('{3420,190,223835,3422}'::integer[])))"
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_108",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "chartevents_108",
                                    "Output": [
                                        "chartevents_108.hadm_id",
                                        "chartevents_108.charttime",
                                        "chartevents_108.itemid",
                                        "chartevents_108.valuenum"
                                    ],
                                    "Recheck Cond": "(chartevents_108.itemid = ANY ('{3420,190,223835,3422}'::integer[]))",
                                    "Filter": "((chartevents_108.valuenum > '0'::double precision) AND (chartevents_108.valuenum < '100'::double precision) AND ((chartevents_108.error IS NULL) OR (chartevents_108.error <> 1)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_108_idx01",
                                            "Index Cond": "(chartevents_108.itemid = ANY ('{3420,190,223835,3422}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_175",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "chartevents_175",
                                    "Output": [
                                        "chartevents_175.hadm_id",
                                        "chartevents_175.charttime",
                                        "chartevents_175.itemid",
                                        "chartevents_175.valuenum"
                                    ],
                                    "Recheck Cond": "(chartevents_175.itemid = ANY ('{3420,190,223835,3422}'::integer[]))",
                                    "Filter": "((chartevents_175.valuenum > '0'::double precision) AND (chartevents_175.valuenum < '100'::double precision) AND ((chartevents_175.error IS NULL) OR (chartevents_175.error <> 1)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_175_idx01",
                                            "Index Cond": "(chartevents_175.itemid = ANY ('{3420,190,223835,3422}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "ie.icustay_id",
                        "COALESCE(pvt.charttime, fi.charttime)",
                        "COALESCE(pvt.valuenum, fi.fio2_chartevents)"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "((pvt_1.hadm_id = pvt.hadm_id) AND (pvt_1.charttime = pvt.charttime))",
                    "Plans": [
                        {
                            "Node Type": "Merge Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Left",
                            "Output": [
                                "pvt_1.hadm_id",
                                "pvt_1.charttime",
                                "ie.icustay_id",
                                "fi.charttime",
                                "fi.fio2_chartevents"
                            ],
                            "Inner Unique": false,
                            "Merge Cond": "((pvt_1.hadm_id = fi.hadm_id) AND (pvt_1.charttime = fi.charttime))",
                            "Plans": [
                                {
                                    "Node Type": "Merge Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "pvt_1.hadm_id",
                                        "pvt_1.charttime",
                                        "ie.icustay_id"
                                    ],
                                    "Inner Unique": false,
                                    "Merge Cond": "(pvt_1.hadm_id = ie.hadm_id)",
                                    "Join Filter": "((pvt_1.charttime >= datetime_sub(ie.intime, '12:00:00'::interval hour)) AND (pvt_1.charttime <= datetime_add(ie.outtime, '12:00:00'::interval hour)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Unique",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "pvt_1.hadm_id",
                                                "pvt_1.charttime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Sort",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Output": [
                                                        "pvt_1.hadm_id",
                                                        "pvt_1.charttime"
                                                    ],
                                                    "Sort Key": [
                                                        "pvt_1.hadm_id",
                                                        "pvt_1.charttime"
                                                    ],
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Append",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "CTE Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": false,
                                                                    "CTE Name": "pvt",
                                                                    "Alias": "pvt_1",
                                                                    "Output": [
                                                                        "pvt_1.hadm_id",
                                                                        "pvt_1.charttime"
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "CTE Scan",
                                                                    "Parent Relationship": "Member",
                                                                    "Parallel Aware": false,
                                                                    "CTE Name": "stg_fio2",
                                                                    "Alias": "stg_fio2",
                                                                    "Output": [
                                                                        "stg_fio2.hadm_id",
                                                                        "stg_fio2.charttime"
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Materialize",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ie.row_id",
                                                "ie.subject_id",
                                                "ie.hadm_id",
                                                "ie.icustay_id",
                                                "ie.dbsource",
                                                "ie.first_careunit",
                                                "ie.last_careunit",
                                                "ie.first_wardid",
                                                "ie.last_wardid",
                                                "ie.intime",
                                                "ie.outtime",
                                                "ie.los"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Scan Direction": "Forward",
                                                    "Index Name": "icustays_idx06",
                                                    "Relation Name": "icustays",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ie",
                                                    "Output": [
                                                        "ie.row_id",
                                                        "ie.subject_id",
                                                        "ie.hadm_id",
                                                        "ie.icustay_id",
                                                        "ie.dbsource",
                                                        "ie.first_careunit",
                                                        "ie.last_careunit",
                                                        "ie.first_wardid",
                                                        "ie.last_wardid",
                                                        "ie.intime",
                                                        "ie.outtime",
                                                        "ie.los"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "fi.charttime",
                                        "fi.fio2_chartevents",
                                        "fi.hadm_id"
                                    ],
                                    "Sort Key": [
                                        "fi.hadm_id",
                                        "fi.charttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "stg_fio2",
                                            "Alias": "fi",
                                            "Output": [
                                                "fi.charttime",
                                                "fi.fio2_chartevents",
                                                "fi.hadm_id"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Materialize",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "pvt.charttime",
                                "pvt.valuenum",
                                "pvt.hadm_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "pvt.charttime",
                                        "pvt.valuenum",
                                        "pvt.hadm_id"
                                    ],
                                    "Sort Key": [
                                        "pvt.hadm_id",
                                        "pvt.charttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "pvt",
                                            "Alias": "pvt",
                                            "Output": [
                                                "pvt.charttime",
                                                "pvt.valuenum",
                                                "pvt.hadm_id"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.pivoted_gcs": {
        "sql": "-- This query extracts the Glasgow Coma Scale, a measure of neurological function.\n-- The query has a few special rules:\n--    (1) The verbal component can be set to 0 if the patient is ventilated.\n--    This is corrected to 5 - the overall GCS is set to 15 in these cases.\n--    (2) Often only one of three components is documented. The other components\n--    are carried forward.\n\n-- ITEMIDs used:\n\n-- CAREVUE\n--    723 as gcsverbal\n--    454 as gcsmotor\n--    184 as gcseyes\n\n-- METAVISION\n--    223900 GCS - Verbal Response\n--    223901 GCS - Motor Response\n--    220739 GCS - Eye Opening\n\n-- The code combines the ITEMIDs into the carevue itemids, then pivots those\n-- So 223900 is changed to 723, then the ITEMID 723 is pivoted to form gcsverbal\n\n-- Note:\n--  The GCS for sedated patients is defaulted to 15 in this code.\n--  This is in line with how the data is meant to be collected.\n--  e.g., from the SAPS II publication:\n--    For sedated patients, the Glasgow Coma Score before sedation was used.\n--    This was ascertained either from interviewing the physician who ordered the sedation,\n--    or by reviewing the patient's medical record.\n\nwith base as\n(\n  select ce.icustay_id, ce.charttime\n  -- pivot each value into its own column\n  , max(case when ce.ITEMID in (454,223901) then ce.valuenum else null end) as gcsmotor\n  , max(case\n      when ce.ITEMID = 723 and ce.VALUE = '1.0 ET/Trach' then 0\n      when ce.ITEMID = 223900 and ce.VALUE = 'No Response-ETT' then 0\n      when ce.ITEMID in (723,223900) then ce.valuenum\n      else null \n    end) as gcsverbal\n  , max(case when ce.ITEMID in (184,220739) then ce.valuenum else null end) as gcseyes\n  -- convert the data into a number, reserving a value of 0 for ET/Trach\n  , max(case\n      -- endotrach/vent is assigned a value of 0, later parsed specially\n      when ce.ITEMID = 723 and ce.VALUE = '1.0 ET/Trach' then 1 -- carevue\n      when ce.ITEMID = 223900 and ce.VALUE = 'No Response-ETT' then 1 -- metavision\n    else 0 end)\n    as endotrachflag\n  , ROW_NUMBER ()\n          OVER (PARTITION BY ce.icustay_id ORDER BY ce.charttime ASC) as rn\n  FROM chartevents ce\n  -- Isolate the desired GCS variables\n  where ce.ITEMID in\n  (\n    -- 198 -- GCS\n    -- GCS components, CareVue\n    184, 454, 723\n    -- GCS components, Metavision\n    , 223900, 223901, 220739\n  )\n  -- exclude rows marked as error\n  AND (ce.error IS NULL OR ce.error != 1)\n  group by ce.icustay_id, ce.charttime\n)\n, gcs_stg0 as (\n  select b.*\n  , b2.gcsverbal as gcsverbalprev\n  , b2.gcsmotor as gcsmotorprev\n  , b2.gcseyes as gcseyesprev\n  -- Calculate GCS, factoring in special case when they are intubated and prev vals\n  -- note that the coalesce are used to implement the following if:\n  --  if current value exists, use it\n  --  if previous value exists, use it\n  --  otherwise, default to normal\n  , case\n      -- replace GCS during sedation with 15\n      when b.gcsverbal = 0\n        then 15\n      when b.gcsverbal is null and b2.gcsverbal = 0\n        then 15\n      -- if previously they were intub, but they aren't now, do not use previous GCS values\n      when b2.gcsverbal = 0\n        then\n            coalesce(b.gcsmotor,6)\n          + coalesce(b.gcsverbal,5)\n          + coalesce(b.gcseyes,4)\n      -- otherwise, add up score normally, imputing previous value if none available at current time\n      else\n            coalesce(b.gcsmotor,coalesce(b2.gcsmotor,6))\n          + coalesce(b.gcsverbal,coalesce(b2.gcsverbal,5))\n          + coalesce(b.gcseyes,coalesce(b2.gcseyes,4))\n      end as gcs\n\n  from base b\n  -- join to itself within 6 hours to get previous value\n  left join base b2\n    on b.icustay_id = b2.icustay_id\n    and b.rn = b2.rn+1\n    and b2.charttime > DATETIME_SUB(b.charttime, INTERVAL '6' HOUR)\n)\n-- combine components with previous within 6 hours\n-- filter down to cohort which is not excluded\n-- truncate charttime to the hour\n, gcs_stg1 as\n(\n  select gs.icustay_id, gs.charttime\n  , gs.gcs\n  , coalesce(gcsmotor,gcsmotorprev) as gcsmotor\n  , coalesce(gcsverbal,gcsverbalprev) as gcsverbal\n  , coalesce(gcseyes,gcseyesprev) as gcseyes\n  , case when coalesce(gcsmotor,gcsmotorprev) is null then 0 else 1 end\n  + case when coalesce(gcsverbal,gcsverbalprev) is null then 0 else 1 end\n  + case when coalesce(gcseyes,gcseyesprev) is null then 0 else 1 end\n    as components_measured\n  , endotrachflag\n  from gcs_stg0 gs\n)\n-- priority is:\n--  (i) complete data, (ii) non-sedated GCS, (iii) lowest GCS, (iv) charttime\n, gcs_priority as\n(\n  select icustay_id\n    , charttime\n    , gcs\n    , gcsmotor\n    , gcsverbal\n    , gcseyes\n    , endotrachflag\n    , ROW_NUMBER() over\n      (\n        PARTITION BY icustay_id, charttime\n        ORDER BY components_measured DESC, endotrachflag, gcs, charttime DESC\n      ) as rn\n  from gcs_stg1\n)\nselect icustay_id\n  , charttime\n  , gcs\n  , gcsmotor\n  , gcsverbal\n  , gcseyes\n  , endotrachflag\nfrom gcs_priority gs\nwhere rn = 1\nORDER BY icustay_id, charttime",
        "tables": [
            "mimiciii_clinical.chartevents"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "charttime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "gcs": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "gcsmotor": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "gcsverbal": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "gcseyes": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "endotrachflag": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.chartevents.valuenum"
            ]
        },
        "table_name": "mimiciii_clinical.pivoted_gcs",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "gs.icustay_id",
                "gs.charttime",
                "gs.gcs",
                "gs.gcsmotor",
                "gs.gcsverbal",
                "gs.gcseyes",
                "gs.endotrachflag"
            ],
            "Sort Key": [
                "gs.icustay_id",
                "gs.charttime"
            ],
            "Plans": [
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE base",
                    "Parallel Aware": false,
                    "Output": [
                        "ce.icustay_id",
                        "ce.charttime",
                        "(max(CASE WHEN (ce.itemid = ANY ('{454,223901}'::integer[])) THEN ce.valuenum ELSE NULL::double precision END))",
                        "(max(CASE WHEN ((ce.itemid = 723) AND ((ce.value)::text = '1.0 ET/Trach'::text)) THEN '0'::double precision WHEN ((ce.itemid = 223900) AND ((ce.value)::text = 'No Response-ETT'::text)) THEN '0'::double precision WHEN (ce.itemid = ANY ('{723,223900}'::integer[])) THEN ce.valuenum ELSE NULL::double precision END))",
                        "(max(CASE WHEN (ce.itemid = ANY ('{184,220739}'::integer[])) THEN ce.valuenum ELSE NULL::double precision END))",
                        "(max(CASE WHEN ((ce.itemid = 723) AND ((ce.value)::text = '1.0 ET/Trach'::text)) THEN 1 WHEN ((ce.itemid = 223900) AND ((ce.value)::text = 'No Response-ETT'::text)) THEN 1 ELSE 0 END))",
                        "row_number() OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Aggregate",
                            "Strategy": "Sorted",
                            "Partial Mode": "Simple",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ce.icustay_id",
                                "ce.charttime",
                                "max(CASE WHEN (ce.itemid = ANY ('{454,223901}'::integer[])) THEN ce.valuenum ELSE NULL::double precision END)",
                                "max(CASE WHEN ((ce.itemid = 723) AND ((ce.value)::text = '1.0 ET/Trach'::text)) THEN '0'::double precision WHEN ((ce.itemid = 223900) AND ((ce.value)::text = 'No Response-ETT'::text)) THEN '0'::double precision WHEN (ce.itemid = ANY ('{723,223900}'::integer[])) THEN ce.valuenum ELSE NULL::double precision END)",
                                "max(CASE WHEN (ce.itemid = ANY ('{184,220739}'::integer[])) THEN ce.valuenum ELSE NULL::double precision END)",
                                "max(CASE WHEN ((ce.itemid = 723) AND ((ce.value)::text = '1.0 ET/Trach'::text)) THEN 1 WHEN ((ce.itemid = 223900) AND ((ce.value)::text = 'No Response-ETT'::text)) THEN 1 ELSE 0 END)"
                            ],
                            "Group Key": [
                                "ce.icustay_id",
                                "ce.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "ce.icustay_id",
                                        "ce.charttime",
                                        "ce.itemid",
                                        "ce.valuenum",
                                        "ce.value"
                                    ],
                                    "Sort Key": [
                                        "ce.icustay_id",
                                        "ce.charttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Append",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_26",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce",
                                                    "Output": [
                                                        "ce.icustay_id",
                                                        "ce.charttime",
                                                        "ce.itemid",
                                                        "ce.valuenum",
                                                        "ce.value"
                                                    ],
                                                    "Filter": "(((ce.error IS NULL) OR (ce.error <> 1)) AND (ce.itemid = ANY ('{184,454,723,223900,223901,220739}'::integer[])))"
                                                },
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_41",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_1",
                                                    "Output": [
                                                        "ce_1.icustay_id",
                                                        "ce_1.charttime",
                                                        "ce_1.itemid",
                                                        "ce_1.valuenum",
                                                        "ce_1.value"
                                                    ],
                                                    "Filter": "(((ce_1.error IS NULL) OR (ce_1.error <> 1)) AND (ce_1.itemid = ANY ('{184,454,723,223900,223901,220739}'::integer[])))"
                                                },
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_85",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_2",
                                                    "Output": [
                                                        "ce_2.icustay_id",
                                                        "ce_2.charttime",
                                                        "ce_2.itemid",
                                                        "ce_2.valuenum",
                                                        "ce_2.value"
                                                    ],
                                                    "Filter": "(((ce_2.error IS NULL) OR (ce_2.error <> 1)) AND (ce_2.itemid = ANY ('{184,454,723,223900,223901,220739}'::integer[])))"
                                                },
                                                {
                                                    "Node Type": "Bitmap Heap Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_171",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_3",
                                                    "Output": [
                                                        "ce_3.icustay_id",
                                                        "ce_3.charttime",
                                                        "ce_3.itemid",
                                                        "ce_3.valuenum",
                                                        "ce_3.value"
                                                    ],
                                                    "Recheck Cond": "(ce_3.itemid = ANY ('{184,454,723,223900,223901,220739}'::integer[]))",
                                                    "Filter": "((ce_3.error IS NULL) OR (ce_3.error <> 1))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Bitmap Index Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Index Name": "chartevents_171_idx01",
                                                            "Index Cond": "(ce_3.itemid = ANY ('{184,454,723,223900,223901,220739}'::integer[]))"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "Node Type": "Bitmap Heap Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_177",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_4",
                                                    "Output": [
                                                        "ce_4.icustay_id",
                                                        "ce_4.charttime",
                                                        "ce_4.itemid",
                                                        "ce_4.valuenum",
                                                        "ce_4.value"
                                                    ],
                                                    "Recheck Cond": "(ce_4.itemid = ANY ('{184,454,723,223900,223901,220739}'::integer[]))",
                                                    "Filter": "((ce_4.error IS NULL) OR (ce_4.error <> 1))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Bitmap Index Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Index Name": "chartevents_177_idx01",
                                                            "Index Cond": "(ce_4.itemid = ANY ('{184,454,723,223900,223901,220739}'::integer[]))"
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE gcs_stg0",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "b.icustay_id",
                        "b.charttime",
                        "b.gcsmotor",
                        "b.gcsverbal",
                        "b.gcseyes",
                        "b.endotrachflag",
                        "b.rn",
                        "b2.gcsverbal",
                        "b2.gcsmotor",
                        "b2.gcseyes",
                        "CASE WHEN (b.gcsverbal = '0'::double precision) THEN '15'::double precision WHEN ((b.gcsverbal IS NULL) AND (b2.gcsverbal = '0'::double precision)) THEN '15'::double precision WHEN (b2.gcsverbal = '0'::double precision) THEN ((COALESCE(b.gcsmotor, '6'::double precision) + COALESCE(b.gcsverbal, '5'::double precision)) + COALESCE(b.gcseyes, '4'::double precision)) ELSE ((COALESCE(b.gcsmotor, COALESCE(b2.gcsmotor, '6'::double precision)) + COALESCE(b.gcsverbal, COALESCE(b2.gcsverbal, '5'::double precision))) + COALESCE(b.gcseyes, COALESCE(b2.gcseyes, '4'::double precision))) END"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "((b.icustay_id = b2.icustay_id) AND (b.rn = ((b2.rn + 1))))",
                    "Join Filter": "(b2.charttime > datetime_sub(b.charttime, '06:00:00'::interval hour))",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "b.icustay_id",
                                "b.charttime",
                                "b.gcsmotor",
                                "b.gcsverbal",
                                "b.gcseyes",
                                "b.endotrachflag",
                                "b.rn"
                            ],
                            "Sort Key": [
                                "b.icustay_id",
                                "b.rn"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "base",
                                    "Alias": "b",
                                    "Output": [
                                        "b.icustay_id",
                                        "b.charttime",
                                        "b.gcsmotor",
                                        "b.gcsverbal",
                                        "b.gcseyes",
                                        "b.endotrachflag",
                                        "b.rn"
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "b2.gcsverbal",
                                "b2.gcsmotor",
                                "b2.gcseyes",
                                "b2.icustay_id",
                                "b2.rn",
                                "b2.charttime",
                                "((b2.rn + 1))"
                            ],
                            "Sort Key": [
                                "b2.icustay_id",
                                "((b2.rn + 1))"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "base",
                                    "Alias": "b2",
                                    "Output": [
                                        "b2.gcsverbal",
                                        "b2.gcsmotor",
                                        "b2.gcseyes",
                                        "b2.icustay_id",
                                        "b2.rn",
                                        "b2.charttime",
                                        "(b2.rn + 1)"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE gcs_stg1",
                    "Parallel Aware": false,
                    "CTE Name": "gcs_stg0",
                    "Alias": "gs_1",
                    "Output": [
                        "gs_1.icustay_id",
                        "gs_1.charttime",
                        "gs_1.gcs",
                        "COALESCE(gs_1.gcsmotor, gs_1.gcsmotorprev)",
                        "COALESCE(gs_1.gcsverbal, gs_1.gcsverbalprev)",
                        "COALESCE(gs_1.gcseyes, gs_1.gcseyesprev)",
                        "((CASE WHEN (COALESCE(gs_1.gcsmotor, gs_1.gcsmotorprev) IS NULL) THEN 0 ELSE 1 END + CASE WHEN (COALESCE(gs_1.gcsverbal, gs_1.gcsverbalprev) IS NULL) THEN 0 ELSE 1 END) + CASE WHEN (COALESCE(gs_1.gcseyes, gs_1.gcseyesprev) IS NULL) THEN 0 ELSE 1 END)",
                        "gs_1.endotrachflag"
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE gcs_priority",
                    "Parallel Aware": false,
                    "Output": [
                        "gcs_stg1.icustay_id",
                        "gcs_stg1.charttime",
                        "gcs_stg1.gcs",
                        "gcs_stg1.gcsmotor",
                        "gcs_stg1.gcsverbal",
                        "gcs_stg1.gcseyes",
                        "gcs_stg1.endotrachflag",
                        "row_number() OVER (?)",
                        "gcs_stg1.components_measured"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "gcs_stg1.icustay_id",
                                "gcs_stg1.charttime",
                                "gcs_stg1.gcs",
                                "gcs_stg1.endotrachflag",
                                "gcs_stg1.components_measured",
                                "gcs_stg1.gcsmotor",
                                "gcs_stg1.gcsverbal",
                                "gcs_stg1.gcseyes"
                            ],
                            "Sort Key": [
                                "gcs_stg1.icustay_id",
                                "gcs_stg1.charttime DESC",
                                "gcs_stg1.components_measured DESC",
                                "gcs_stg1.endotrachflag",
                                "gcs_stg1.gcs"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "gcs_stg1",
                                    "Alias": "gcs_stg1",
                                    "Output": [
                                        "gcs_stg1.icustay_id",
                                        "gcs_stg1.charttime",
                                        "gcs_stg1.gcs",
                                        "gcs_stg1.endotrachflag",
                                        "gcs_stg1.components_measured",
                                        "gcs_stg1.gcsmotor",
                                        "gcs_stg1.gcsverbal",
                                        "gcs_stg1.gcseyes"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "CTE Name": "gcs_priority",
                    "Alias": "gs",
                    "Output": [
                        "gs.icustay_id",
                        "gs.charttime",
                        "gs.gcs",
                        "gs.gcsmotor",
                        "gs.gcsverbal",
                        "gs.gcseyes",
                        "gs.endotrachflag"
                    ],
                    "Filter": "(gs.rn = 1)"
                }
            ]
        }
    },
    "model.mimic.pivoted_height": {
        "sql": "-- prep height\nWITH ht_in AS\n(\n  SELECT \n    c.subject_id, c.icustay_id, c.charttime,\n    -- Ensure that all heights are in centimeters\n    ROUND((CASE\n      WHEN c.itemid IN (920, 1394, 4187, 3486, 226707)\n        THEN ROUND((c.valuenum * 2.54)::numeric, 2)\n        -- ROUND(value::numeric, 2)\n      ELSE c.valuenum\n    END)::numeric, 2) AS height\n    , c.valuenum as height_orig\n  FROM chartevents c\n  WHERE c.valuenum IS NOT NULL\n  AND c.valuenum != 0\n  -- exclude rows marked as error\n  AND COALESCE(c.error, 0) = 0\n  -- Height (measured in inches)\n  AND c.itemid IN\n  (\n    -- CareVue\n    920, 1394, 4187, 3486\n    -- Metavision\n    , 226707\n  )\n)\n, ht_cm AS\n(\n  SELECT \n    c.subject_id, c.icustay_id, c.charttime,\n    -- Ensure that all heights are in centimeters\n    ROUND((CASE\n      WHEN c.itemid IN (920, 1394, 4187, 3486, 226707)\n        THEN c.valuenum * 2.54\n      ELSE c.valuenum\n    END)::numeric, 2) AS height\n  FROM chartevents c\n  WHERE c.valuenum IS NOT NULL\n  AND c.valuenum != 0\n  -- exclude rows marked as error\n  AND COALESCE(c.error, 0) = 0\n  -- Height cm\n  AND c.itemid IN\n  (\n    -- CareVue\n    3485, 4188\n    -- MetaVision\n    , 226730\n  )\n)\n-- merge cm/height, only take 1 value per charted row\n, ht_stg0 AS\n(\n  SELECT\n  COALESCE(h1.subject_id, h1.subject_id) as subject_id\n  , COALESCE(h1.charttime, h1.charttime) AS charttime\n  , COALESCE(h1.height, h2.height) as height\n  FROM ht_cm h1\n  FULL OUTER JOIN ht_in h2\n    ON h1.subject_id = h2.subject_id\n    AND h1.charttime = h2.charttime\n)\n-- filter out bad heights\n, ht_stg1 AS\n(\n  SELECT\n    h.subject_id\n    , charttime\n    , CASE\n        -- rule for neonates\n        -- [charrtime don't have year coloum?]\n        -- WHEN DATETIME_DIFF(charttime, pt.dob, `YEAR`) <= 1 AND height < 80 THEN height\n        WHEN EXTRACT(YEAR FROM charttime-pt.dob) <= 1 AND height < 80 THEN height\n        \n        -- rule for adults\n        -- WHEN DATETIME_DIFF(charttime, pt.dob, `YEAR`) > 1 AND height > 120 AND height < 230 THEN height\n        WHEN EXTRACT(YEAR FROM charttime-pt.dob) > 1 AND height > 120 AND height < 230 THEN height\n      ELSE NULL END as height\n  FROM ht_stg0 h\n  INNER JOIN patients pt\n    ON h.subject_id = pt.subject_id\n)\n-- heights from echo-cardiography notes\n, echo_note AS\n(\n  SELECT\n    subject_id\n    -- extract the time of the note from the text itself\n    -- add this to the structured date in the chartdate column\n    , PARSE_DATETIME('%b-%d-%Y%H:%M',\n      CONCAT(\n        FORMAT_DATE('%b-%d-%Y', chartdate),\n        REGEXP_EXTRACT(ne.text, 'Date/Time: [\\\\[\\\\]0-9*-]+ at ([0-9:]+)')\n       )\n    ) AS charttime\n    -- sometimes numeric values contain de-id numbers, e.g. [** Numeric Identifier **]\n    -- this case is used to ignore that text\n    , case\n        when REGEXP_EXTRACT(ne.text, 'Height: \\\\(in\\\\) (.*?)\\n') like '%*%'\n            then null\n        else cast(REGEXP_EXTRACT(ne.text, 'Height: \\\\(in\\\\) (.*?)\\n') as numeric)\n        end * 2.54 as height\n  FROM noteevents ne\n  WHERE ne.category = 'Echo'\n)\n-- use documented ideal body weights to back-calculate height\n, ibw_note AS\n(\n    SELECT subject_id\n    , ne.category\n    , charttime\n    , CAST(REGEXP_EXTRACT(text, 'Ideal body weight: ([0-9]+\\\\.?[0-9]*)') AS NUMERIC) as ibw\n    FROM noteevents ne\n    WHERE text like '%Ideal body weight:%'\n    AND ne.category != 'Echo'\n)\n, ht_from_ibw AS\n(\n    -- IBW formulas\n    -- inches\n    -- F:  IBW = 45.5 kg + 2.3 kg * (height in inches - 60)\n    -- M:  IBW = 50 kg + 2.3 kg * (height in inches - 60)\n    \n    -- cm\n    -- F: 45.5 + (0.91 \u00d7 [height in centimeters \u2212 152.4])\n    -- M: 50 + (0.91 \u00d7 [height in centimeters \u2212 152.4])\n    \n    SELECT ne.subject_id\n    , charttime\n    , CASE\n        WHEN gender = 'F' THEN (ibw - 45.5)/0.91 + 152.4\n        ELSE (ibw - 50)/0.91 + 152.4 END AS height\n    FROM ibw_note ne\n    INNER JOIN patients pt\n      ON ne.subject_id = pt.subject_id\n    WHERE ibw IS NOT NULL AND ibw != 0\n)\n, ht_nutrition AS\n(\n    -- nutrition notes usually only document height\n    -- but the original note formatting has been lost, so we can't do a clever regex\n    -- instead, we just look for the unit of measure (cm)\n    SELECT subject_id\n    , charttime\n    , CAST(REGEXP_EXTRACT(ne.text, '([0-9]+) cm') AS NUMERIC) as height\n    FROM noteevents ne\n    WHERE category = 'Nutrition'\n    AND lower(text) like '%height%'\n)\nSELECT subject_id, charttime, 'chartevents' as source, height\nFROM ht_stg1\nWHERE height IS NOT NULL AND height > 0\nUNION ALL\nSELECT subject_id, charttime, 'noteevents - echo' as source, height\nFROM echo_note\nWHERE height IS NOT NULL AND height > 0\nUNION ALL\nSELECT subject_id, charttime, 'noteevents - ibw' as source, height\nFROM ht_from_ibw\nWHERE height IS NOT NULL AND height > 0\nUNION ALL\nSELECT subject_id, charttime, 'noteevents - nutrition' as source\n-- convert the heights\n    , CASE \n        WHEN height < 80 THEN height*2.54\n        ELSE height\n    END AS height\nFROM ht_nutrition\nWHERE height IS NOT NULL AND height > 0\nORDER BY subject_id, charttime, source, height",
        "tables": [
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.noteevents",
            "mimiciii_clinical.patients"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.noteevents.category",
                "mimiciii_clinical.noteevents.chartdate",
                "mimiciii_clinical.noteevents.charttime",
                "mimiciii_clinical.noteevents.subject_id",
                "mimiciii_clinical.noteevents.text",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.gender",
                "mimiciii_clinical.patients.subject_id"
            ],
            "charttime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.noteevents.category",
                "mimiciii_clinical.noteevents.chartdate",
                "mimiciii_clinical.noteevents.charttime",
                "mimiciii_clinical.noteevents.subject_id",
                "mimiciii_clinical.noteevents.text",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.gender",
                "mimiciii_clinical.patients.subject_id"
            ],
            "source": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.noteevents.category",
                "mimiciii_clinical.noteevents.chartdate",
                "mimiciii_clinical.noteevents.charttime",
                "mimiciii_clinical.noteevents.subject_id",
                "mimiciii_clinical.noteevents.text",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.gender",
                "mimiciii_clinical.patients.subject_id"
            ],
            "height": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.subject_id",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.noteevents.category",
                "mimiciii_clinical.noteevents.chartdate",
                "mimiciii_clinical.noteevents.charttime",
                "mimiciii_clinical.noteevents.subject_id",
                "mimiciii_clinical.noteevents.text",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.gender",
                "mimiciii_clinical.patients.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.pivoted_height",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "ht_stg1.subject_id",
                "ht_stg1.charttime",
                "('chartevents'::text)",
                "ht_stg1.height"
            ],
            "Sort Key": [
                "ht_stg1.subject_id",
                "ht_stg1.charttime",
                "('chartevents'::text)",
                "ht_stg1.height"
            ],
            "Plans": [
                {
                    "Node Type": "Result",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE ht_in",
                    "Parallel Aware": false,
                    "Output": [
                        "c.subject_id",
                        "c.icustay_id",
                        "c.charttime",
                        "round((CASE WHEN (c.itemid = ANY ('{920,1394,4187,3486,226707}'::integer[])) THEN (round(((c.valuenum * '2.54'::double precision))::numeric, 2))::double precision ELSE c.valuenum END)::numeric, 2)",
                        "c.valuenum"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Append",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_90",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "c",
                                    "Output": [
                                        "c.subject_id",
                                        "c.icustay_id",
                                        "c.charttime",
                                        "c.itemid",
                                        "c.valuenum"
                                    ],
                                    "Recheck Cond": "(c.itemid = ANY ('{920,1394,4187,3486,226707}'::integer[]))",
                                    "Filter": "((c.valuenum IS NOT NULL) AND (c.valuenum <> '0'::double precision) AND (COALESCE(c.error, 0) = 0))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_90_idx01",
                                            "Index Cond": "(c.itemid = ANY ('{920,1394,4187,3486,226707}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_98",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "c_1",
                                    "Output": [
                                        "c_1.subject_id",
                                        "c_1.icustay_id",
                                        "c_1.charttime",
                                        "c_1.itemid",
                                        "c_1.valuenum"
                                    ],
                                    "Recheck Cond": "(c_1.itemid = ANY ('{920,1394,4187,3486,226707}'::integer[]))",
                                    "Filter": "((c_1.valuenum IS NOT NULL) AND (c_1.valuenum <> '0'::double precision) AND (COALESCE(c_1.error, 0) = 0))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_98_idx01",
                                            "Index Cond": "(c_1.itemid = ANY ('{920,1394,4187,3486,226707}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_110",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "c_2",
                                    "Output": [
                                        "c_2.subject_id",
                                        "c_2.icustay_id",
                                        "c_2.charttime",
                                        "c_2.itemid",
                                        "c_2.valuenum"
                                    ],
                                    "Recheck Cond": "(c_2.itemid = ANY ('{920,1394,4187,3486,226707}'::integer[]))",
                                    "Filter": "((c_2.valuenum IS NOT NULL) AND (c_2.valuenum <> '0'::double precision) AND (COALESCE(c_2.error, 0) = 0))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_110_idx01",
                                            "Index Cond": "(c_2.itemid = ANY ('{920,1394,4187,3486,226707}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_121",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "c_3",
                                    "Output": [
                                        "c_3.subject_id",
                                        "c_3.icustay_id",
                                        "c_3.charttime",
                                        "c_3.itemid",
                                        "c_3.valuenum"
                                    ],
                                    "Recheck Cond": "(c_3.itemid = ANY ('{920,1394,4187,3486,226707}'::integer[]))",
                                    "Filter": "((c_3.valuenum IS NOT NULL) AND (c_3.valuenum <> '0'::double precision) AND (COALESCE(c_3.error, 0) = 0))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_121_idx01",
                                            "Index Cond": "(c_3.itemid = ANY ('{920,1394,4187,3486,226707}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_201",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "c_4",
                                    "Output": [
                                        "c_4.subject_id",
                                        "c_4.icustay_id",
                                        "c_4.charttime",
                                        "c_4.itemid",
                                        "c_4.valuenum"
                                    ],
                                    "Recheck Cond": "(c_4.itemid = ANY ('{920,1394,4187,3486,226707}'::integer[]))",
                                    "Filter": "((c_4.valuenum IS NOT NULL) AND (c_4.valuenum <> '0'::double precision) AND (COALESCE(c_4.error, 0) = 0))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_201_idx01",
                                            "Index Cond": "(c_4.itemid = ANY ('{920,1394,4187,3486,226707}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Result",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE ht_cm",
                    "Parallel Aware": false,
                    "Output": [
                        "c_5.subject_id",
                        "c_5.icustay_id",
                        "c_5.charttime",
                        "round((CASE WHEN (c_5.itemid = ANY ('{920,1394,4187,3486,226707}'::integer[])) THEN (c_5.valuenum * '2.54'::double precision) ELSE c_5.valuenum END)::numeric, 2)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Append",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_110",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "c_5",
                                    "Output": [
                                        "c_5.subject_id",
                                        "c_5.icustay_id",
                                        "c_5.charttime",
                                        "c_5.itemid",
                                        "c_5.valuenum"
                                    ],
                                    "Recheck Cond": "(c_5.itemid = ANY ('{3485,4188,226730}'::integer[]))",
                                    "Filter": "((c_5.valuenum IS NOT NULL) AND (c_5.valuenum <> '0'::double precision) AND (COALESCE(c_5.error, 0) = 0))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_110_idx01",
                                            "Index Cond": "(c_5.itemid = ANY ('{3485,4188,226730}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_121",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "c_6",
                                    "Output": [
                                        "c_6.subject_id",
                                        "c_6.icustay_id",
                                        "c_6.charttime",
                                        "c_6.itemid",
                                        "c_6.valuenum"
                                    ],
                                    "Recheck Cond": "(c_6.itemid = ANY ('{3485,4188,226730}'::integer[]))",
                                    "Filter": "((c_6.valuenum IS NOT NULL) AND (c_6.valuenum <> '0'::double precision) AND (COALESCE(c_6.error, 0) = 0))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_121_idx01",
                                            "Index Cond": "(c_6.itemid = ANY ('{3485,4188,226730}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_201",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "c_7",
                                    "Output": [
                                        "c_7.subject_id",
                                        "c_7.icustay_id",
                                        "c_7.charttime",
                                        "c_7.itemid",
                                        "c_7.valuenum"
                                    ],
                                    "Recheck Cond": "(c_7.itemid = ANY ('{3485,4188,226730}'::integer[]))",
                                    "Filter": "((c_7.valuenum IS NOT NULL) AND (c_7.valuenum <> '0'::double precision) AND (COALESCE(c_7.error, 0) = 0))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_201_idx01",
                                            "Index Cond": "(c_7.itemid = ANY ('{3485,4188,226730}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE ht_stg0",
                    "Parallel Aware": false,
                    "Join Type": "Full",
                    "Output": [
                        "COALESCE(h1.subject_id, h1.subject_id)",
                        "COALESCE(h1.charttime, h1.charttime)",
                        "COALESCE(h1.height, h2.height)"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "((h1.subject_id = h2.subject_id) AND (h1.charttime = h2.charttime))",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "h1.subject_id",
                                "h1.charttime",
                                "h1.height"
                            ],
                            "Sort Key": [
                                "h1.subject_id",
                                "h1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "ht_cm",
                                    "Alias": "h1",
                                    "Output": [
                                        "h1.subject_id",
                                        "h1.charttime",
                                        "h1.height"
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "h2.height",
                                "h2.subject_id",
                                "h2.charttime"
                            ],
                            "Sort Key": [
                                "h2.subject_id",
                                "h2.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "ht_in",
                                    "Alias": "h2",
                                    "Output": [
                                        "h2.height",
                                        "h2.subject_id",
                                        "h2.charttime"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE ht_stg1",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "h.subject_id",
                        "h.charttime",
                        "CASE WHEN ((date_part('year'::text, (h.charttime - pt.dob)) <= '1'::double precision) AND (h.height < '80'::numeric)) THEN h.height WHEN ((date_part('year'::text, (h.charttime - pt.dob)) > '1'::double precision) AND (h.height > '120'::numeric) AND (h.height < '230'::numeric)) THEN h.height ELSE NULL::numeric END"
                    ],
                    "Inner Unique": true,
                    "Hash Cond": "(h.subject_id = pt.subject_id)",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "ht_stg0",
                            "Alias": "h",
                            "Output": [
                                "h.subject_id",
                                "h.charttime",
                                "h.height"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "pt.dob",
                                "pt.subject_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "patients",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "pt",
                                    "Output": [
                                        "pt.dob",
                                        "pt.subject_id"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Bitmap Heap Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE echo_note",
                    "Parallel Aware": false,
                    "Relation Name": "noteevents",
                    "Schema": "mimiciii_clinical",
                    "Alias": "ne",
                    "Output": [
                        "ne.subject_id",
                        "parse_datetime('%b-%d-%Y%H:%M'::character varying, (concat(format_date('%b-%d-%Y'::character varying, ne.chartdate), regexp_extract(ne.text, 'Date/Time: [\\\\[\\\\]0-9*-]+ at ([0-9:]+)'::text)))::character varying)",
                        "(CASE WHEN (regexp_extract(ne.text, 'Height: \\\\(in\\\\) (.*?)\\n'::text) ~~ '%*%'::text) THEN NULL::numeric ELSE (regexp_extract(ne.text, 'Height: \\\\(in\\\\) (.*?)\\n'::text))::numeric END * 2.54)"
                    ],
                    "Recheck Cond": "((ne.category)::text = 'Echo'::text)",
                    "Plans": [
                        {
                            "Node Type": "Bitmap Index Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Index Name": "noteevents_idx05",
                            "Index Cond": "((ne.category)::text = 'Echo'::text)"
                        }
                    ]
                },
                {
                    "Node Type": "Seq Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE ibw_note",
                    "Parallel Aware": false,
                    "Relation Name": "noteevents",
                    "Schema": "mimiciii_clinical",
                    "Alias": "ne_1",
                    "Output": [
                        "ne_1.subject_id",
                        "ne_1.category",
                        "ne_1.charttime",
                        "(regexp_extract(ne_1.text, 'Ideal body weight: ([0-9]+\\\\.?[0-9]*)'::text))::numeric"
                    ],
                    "Filter": "((ne_1.text ~~ '%Ideal body weight:%'::text) AND ((ne_1.category)::text <> 'Echo'::text))"
                },
                {
                    "Node Type": "Nested Loop",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE ht_from_ibw",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "ne_2.subject_id",
                        "ne_2.charttime",
                        "CASE WHEN ((pt_1.gender)::text = 'F'::text) THEN (((ne_2.ibw - 45.5) / 0.91) + 152.4) ELSE (((ne_2.ibw - '50'::numeric) / 0.91) + 152.4) END"
                    ],
                    "Inner Unique": true,
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "ibw_note",
                            "Alias": "ne_2",
                            "Output": [
                                "ne_2.subject_id",
                                "ne_2.category",
                                "ne_2.charttime",
                                "ne_2.ibw"
                            ],
                            "Filter": "((ne_2.ibw IS NOT NULL) AND (ne_2.ibw <> '0'::numeric))"
                        },
                        {
                            "Node Type": "Index Scan",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Scan Direction": "Forward",
                            "Index Name": "pat_subid_unique",
                            "Relation Name": "patients",
                            "Schema": "mimiciii_clinical",
                            "Alias": "pt_1",
                            "Output": [
                                "pt_1.row_id",
                                "pt_1.subject_id",
                                "pt_1.gender",
                                "pt_1.dob",
                                "pt_1.dod",
                                "pt_1.dod_hosp",
                                "pt_1.dod_ssn",
                                "pt_1.expire_flag"
                            ],
                            "Index Cond": "(pt_1.subject_id = ne_2.subject_id)"
                        }
                    ]
                },
                {
                    "Node Type": "Index Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE ht_nutrition",
                    "Parallel Aware": false,
                    "Scan Direction": "Forward",
                    "Index Name": "noteevents_idx05",
                    "Relation Name": "noteevents",
                    "Schema": "mimiciii_clinical",
                    "Alias": "ne_3",
                    "Output": [
                        "ne_3.subject_id",
                        "ne_3.charttime",
                        "(regexp_extract(ne_3.text, '([0-9]+) cm'::text))::numeric"
                    ],
                    "Index Cond": "((ne_3.category)::text = 'Nutrition'::text)",
                    "Filter": "(lower(ne_3.text) ~~ '%height%'::text)"
                },
                {
                    "Node Type": "Append",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "ht_stg1",
                            "Alias": "ht_stg1",
                            "Output": [
                                "ht_stg1.subject_id",
                                "ht_stg1.charttime",
                                "'chartevents'::text",
                                "ht_stg1.height"
                            ],
                            "Filter": "((ht_stg1.height IS NOT NULL) AND (ht_stg1.height > '0'::numeric))"
                        },
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "echo_note",
                            "Alias": "echo_note",
                            "Output": [
                                "echo_note.subject_id",
                                "echo_note.charttime",
                                "'noteevents - echo'::text",
                                "echo_note.height"
                            ],
                            "Filter": "((echo_note.height IS NOT NULL) AND (echo_note.height > '0'::numeric))"
                        },
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "ht_from_ibw",
                            "Alias": "ht_from_ibw",
                            "Output": [
                                "ht_from_ibw.subject_id",
                                "ht_from_ibw.charttime",
                                "'noteevents - ibw'::text",
                                "ht_from_ibw.height"
                            ],
                            "Filter": "((ht_from_ibw.height IS NOT NULL) AND (ht_from_ibw.height > '0'::numeric))"
                        },
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Member",
                            "Parallel Aware": false,
                            "CTE Name": "ht_nutrition",
                            "Alias": "ht_nutrition",
                            "Output": [
                                "ht_nutrition.subject_id",
                                "ht_nutrition.charttime",
                                "'noteevents - nutrition'::text",
                                "CASE WHEN (ht_nutrition.height < '80'::numeric) THEN (ht_nutrition.height * 2.54) ELSE ht_nutrition.height END"
                            ],
                            "Filter": "((ht_nutrition.height IS NOT NULL) AND (ht_nutrition.height > '0'::numeric))"
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.pivoted_icp": {
        "sql": "with ce as\n(\n  select ce.icustay_id\n    , ce.charttime\n    -- TODO: handle high ICPs when monitoring two ICPs\n    , case when valuenum > 0 and valuenum < 100 then valuenum else null end as icp\n  FROM chartevents ce\n  -- exclude rows marked as error\n  where (ce.error IS NULL OR ce.error = 0)\n  and ce.icustay_id IS NOT NULL\n  and ce.itemid in\n  (\n   226 -- ICP -- 99159\n  ,1374 -- ICP Right -- 100\n  ,2045 -- icp left -- 70\n  ,2635 -- VENT ICP -- 195\n  ,2660 -- ICP Camino -- 40\n  ,2733 -- RIGHT VENT ICP -- 203\n  ,2745 -- ICP LEFT -- 232\n  ,2870 -- ICP-ventriculostomuy -- 114\n  ,2956 -- ventriculostomy icp -- 64\n  ,2985 -- ICP ventricle -- 85\n  ,5856 -- icp -- 7\n  ,7116 -- Rt ICP -- 80\n  ,8218 -- left icp -- 6\n  ,8298 -- L ICP -- 47\n  ,8299 -- R ICP -- 16\n  ,8305 -- ICP  Right -- 49\n  ,220765 -- Intra Cranial Pressure -- 92306\n  ,227989 -- Intra Cranial Pressure #2 -- 1052\n  )\n)\nselect\n    ce.icustay_id\n  , ce.charttime\n  , MAX(icp) as icp\nfrom ce\ngroup by ce.icustay_id, ce.charttime\norder by ce.icustay_id, ce.charttime",
        "tables": [
            "mimiciii_clinical.chartevents"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "charttime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum"
            ],
            "icp": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum"
            ]
        },
        "table_name": "mimiciii_clinical.pivoted_icp",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "ce.icustay_id",
                "ce.charttime",
                "(max(ce.icp))"
            ],
            "Sort Key": [
                "ce.icustay_id",
                "ce.charttime"
            ],
            "Plans": [
                {
                    "Node Type": "Result",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE ce",
                    "Parallel Aware": false,
                    "Output": [
                        "ce_1.icustay_id",
                        "ce_1.charttime",
                        "CASE WHEN ((ce_1.valuenum > '0'::double precision) AND (ce_1.valuenum < '100'::double precision)) THEN ce_1.valuenum ELSE NULL::double precision END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Append",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_33",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ce_1",
                                    "Output": [
                                        "ce_1.icustay_id",
                                        "ce_1.charttime",
                                        "ce_1.valuenum"
                                    ],
                                    "Recheck Cond": "(ce_1.itemid = ANY ('{226,1374,2045,2635,2660,2733,2745,2870,2956,2985,5856,7116,8218,8298,8299,8305,220765,227989}'::integer[]))",
                                    "Filter": "((ce_1.icustay_id IS NOT NULL) AND ((ce_1.error IS NULL) OR (ce_1.error = 0)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_33_idx01",
                                            "Index Cond": "(ce_1.itemid = ANY ('{226,1374,2045,2635,2660,2733,2745,2870,2956,2985,5856,7116,8218,8298,8299,8305,220765,227989}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_98",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ce_2",
                                    "Output": [
                                        "ce_2.icustay_id",
                                        "ce_2.charttime",
                                        "ce_2.valuenum"
                                    ],
                                    "Recheck Cond": "(ce_2.itemid = ANY ('{226,1374,2045,2635,2660,2733,2745,2870,2956,2985,5856,7116,8218,8298,8299,8305,220765,227989}'::integer[]))",
                                    "Filter": "((ce_2.icustay_id IS NOT NULL) AND ((ce_2.error IS NULL) OR (ce_2.error = 0)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_98_idx01",
                                            "Index Cond": "(ce_2.itemid = ANY ('{226,1374,2045,2635,2660,2733,2745,2870,2956,2985,5856,7116,8218,8298,8299,8305,220765,227989}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_103",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ce_3",
                                    "Output": [
                                        "ce_3.icustay_id",
                                        "ce_3.charttime",
                                        "ce_3.valuenum"
                                    ],
                                    "Recheck Cond": "(ce_3.itemid = ANY ('{226,1374,2045,2635,2660,2733,2745,2870,2956,2985,5856,7116,8218,8298,8299,8305,220765,227989}'::integer[]))",
                                    "Filter": "((ce_3.icustay_id IS NOT NULL) AND ((ce_3.error IS NULL) OR (ce_3.error = 0)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_103_idx01",
                                            "Index Cond": "(ce_3.itemid = ANY ('{226,1374,2045,2635,2660,2733,2745,2870,2956,2985,5856,7116,8218,8298,8299,8305,220765,227989}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_104",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ce_4",
                                    "Output": [
                                        "ce_4.icustay_id",
                                        "ce_4.charttime",
                                        "ce_4.valuenum"
                                    ],
                                    "Recheck Cond": "(ce_4.itemid = ANY ('{226,1374,2045,2635,2660,2733,2745,2870,2956,2985,5856,7116,8218,8298,8299,8305,220765,227989}'::integer[]))",
                                    "Filter": "((ce_4.icustay_id IS NOT NULL) AND ((ce_4.error IS NULL) OR (ce_4.error = 0)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_104_idx01",
                                            "Index Cond": "(ce_4.itemid = ANY ('{226,1374,2045,2635,2660,2733,2745,2870,2956,2985,5856,7116,8218,8298,8299,8305,220765,227989}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_130",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ce_5",
                                    "Output": [
                                        "ce_5.icustay_id",
                                        "ce_5.charttime",
                                        "ce_5.valuenum"
                                    ],
                                    "Recheck Cond": "(ce_5.itemid = ANY ('{226,1374,2045,2635,2660,2733,2745,2870,2956,2985,5856,7116,8218,8298,8299,8305,220765,227989}'::integer[]))",
                                    "Filter": "((ce_5.icustay_id IS NOT NULL) AND ((ce_5.error IS NULL) OR (ce_5.error = 0)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_130_idx01",
                                            "Index Cond": "(ce_5.itemid = ANY ('{226,1374,2045,2635,2660,2733,2745,2870,2956,2985,5856,7116,8218,8298,8299,8305,220765,227989}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_131",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ce_6",
                                    "Output": [
                                        "ce_6.icustay_id",
                                        "ce_6.charttime",
                                        "ce_6.valuenum"
                                    ],
                                    "Recheck Cond": "(ce_6.itemid = ANY ('{226,1374,2045,2635,2660,2733,2745,2870,2956,2985,5856,7116,8218,8298,8299,8305,220765,227989}'::integer[]))",
                                    "Filter": "((ce_6.icustay_id IS NOT NULL) AND ((ce_6.error IS NULL) OR (ce_6.error = 0)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_131_idx01",
                                            "Index Cond": "(ce_6.itemid = ANY ('{226,1374,2045,2635,2660,2733,2745,2870,2956,2985,5856,7116,8218,8298,8299,8305,220765,227989}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_171",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ce_7",
                                    "Output": [
                                        "ce_7.icustay_id",
                                        "ce_7.charttime",
                                        "ce_7.valuenum"
                                    ],
                                    "Recheck Cond": "(ce_7.itemid = ANY ('{226,1374,2045,2635,2660,2733,2745,2870,2956,2985,5856,7116,8218,8298,8299,8305,220765,227989}'::integer[]))",
                                    "Filter": "((ce_7.icustay_id IS NOT NULL) AND ((ce_7.error IS NULL) OR (ce_7.error = 0)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_171_idx01",
                                            "Index Cond": "(ce_7.itemid = ANY ('{226,1374,2045,2635,2660,2733,2745,2870,2956,2985,5856,7116,8218,8298,8299,8305,220765,227989}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_207",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ce_8",
                                    "Output": [
                                        "ce_8.icustay_id",
                                        "ce_8.charttime",
                                        "ce_8.valuenum"
                                    ],
                                    "Recheck Cond": "(ce_8.itemid = ANY ('{226,1374,2045,2635,2660,2733,2745,2870,2956,2985,5856,7116,8218,8298,8299,8305,220765,227989}'::integer[]))",
                                    "Filter": "((ce_8.icustay_id IS NOT NULL) AND ((ce_8.error IS NULL) OR (ce_8.error = 0)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_207_idx01",
                                            "Index Cond": "(ce_8.itemid = ANY ('{226,1374,2045,2635,2660,2733,2745,2870,2956,2985,5856,7116,8218,8298,8299,8305,220765,227989}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "ce.icustay_id",
                        "ce.charttime",
                        "max(ce.icp)"
                    ],
                    "Group Key": [
                        "ce.icustay_id",
                        "ce.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "ce",
                            "Alias": "ce",
                            "Output": [
                                "ce.icustay_id",
                                "ce.charttime",
                                "ce.icp"
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.pivoted_invasive_lines": {
        "sql": "WITH stg0 AS\n(\n    SELECT \n        icustay_id\n        , charttime\n        , storetime\n        , itemid\n        -- create partition which separates the lines\n        , CASE\n            WHEN itemid IN (229, 8392) THEN 1\n            WHEN itemid IN (235, 8393) THEN 2\n            WHEN itemid IN (241, 8394) THEN 3\n            WHEN itemid IN (247, 8395) THEN 4\n            WHEN itemid IN (253, 8396) THEN 5\n            WHEN itemid IN (259, 8397) THEN 6\n            WHEN itemid IN (265, 8398) THEN 7\n            WHEN itemid IN (271, 8399) THEN 8\n          ELSE NULL END AS line_number\n        , CASE WHEN itemid < 8000 THEN value ELSE NULL END AS line_type\n        , CASE WHEN itemid > 8000 THEN value ELSE NULL END AS line_site\n        -- the stopped column is always present for invasive lines\n        , CASE \n            --   WHEN ce.stopped = 'D/C\\'d' THEN 1\n              WHEN ce.stopped = 'D/C''d' THEN 1\n              WHEN ce.stopped = 'NotStopd' THEN 0\n          ELSE NULL END AS line_dc\n    FROM chartevents ce\n    WHERE ce.itemid IN \n    (\n      229 -- INV Line#1 [Type]\n    , 235 -- INV Line#2 [Type]\n    , 241 -- INV Line#3 [Type]\n    , 247 -- INV Line#4 [Type]\n    , 253 -- INV Line#5 [Type]\n    , 259 -- INV Line#6 [Type]\n    , 265 -- INV Line#7 [Type]\n    , 271 -- INV Line#8 [Type]\n    , 8392 -- INV Line#1 [Site]\n    , 8393 -- INV Line#2 [Site]\n    , 8394 -- INV Line#3 [Site]\n    , 8395 -- INV Line#4 [Site]\n    , 8396 -- INV Line#5 [Site]\n    , 8397 -- INV Line#6 [Site]\n    , 8398 -- INV Line#7 [Site]\n    , 8399 -- INV Line#8 [Site]\n    )\n    AND icustay_id IS NOT NULL\n    AND COALESCE(ce.error, 0) = 0\n)\n, stg0_rn AS\n(\n    SELECT \n        icustay_id\n        , charttime\n        , line_number\n        , line_type, line_site, line_dc\n        -- only keep the last documented value\n        , ROW_NUMBER() OVER (PARTITION BY icustay_id, charttime, itemid ORDER BY storetime DESC) as rn_last_stored\n    FROM stg0\n)\n, stg1 AS\n(\n    SELECT \n        icustay_id\n        , charttime\n        , line_number\n        -- collapse line type/site into a single row\n        -- MAX() always collapses a single value, due to where rn_last_stored = 1\n        , MAX(line_type) as line_type\n        , MAX(line_site) as line_site\n        -- any disconnection at this charttime turns off the line\n        , MAX(line_dc) AS line_dc\n    FROM stg0_rn\n    WHERE rn_last_stored = 1\n    GROUP BY icustay_id, charttime, line_number\n)\n, stg2 AS\n(\n    SELECT \n        icustay_id\n        , charttime\n        , line_number\n        , line_type, line_site\n        , line_dc\n        -- carry forward the line type\n        , CASE\n            -- if the previous line was D/C'd then it's a new line\n            WHEN LAG(line_dc) OVER (PARTITION BY icustay_id, line_number ORDER BY charttime) = 1 THEN 1\n            -- if it's the same line as before, within 16 hours, continue the event\n            WHEN LAG(line_type) OVER (PARTITION BY icustay_id, line_number ORDER BY charttime) = line_type\n            AND DATETIME_DIFF(\n                charttime,\n                LAG(charttime) OVER (PARTITION BY icustay_id, line_number ORDER BY charttime),\n                'HOUR'\n                ) < 16 THEN 0\n            -- otherwise, it's been more than 16 hours since the line was last documented\n            -- (or it's the first documentation of this line)\n            -- so we consider this a new event\n            ELSE 1\n        END AS rn_part\n    FROM stg1\n)\n-- rn_part is 1 if it's a new event, and 0 if it's a continuation of the previous\n-- so cumulatively summing it will result in a sequential integer which partitions\n-- distinct line events. we can later group on this integer.\n, stg3 AS\n(\n    SELECT\n        icustay_id, charttime, line_number\n        , line_type, line_site\n        , line_dc\n        , SUM(rn_part) OVER (PARTITION BY icustay_id, line_number ORDER BY charttime) as line_event\n    FROM stg2\n)\n-- group by line_event to determine line start/stop times\n, stg4 AS\n(\n    SELECT\n        icustay_id, line_number\n        , line_event\n        , line_type, line_site\n        , MIN(charttime) as starttime\n        , MAX(charttime) as endtime\n    FROM stg3\n    -- filter out the D/C'd rows so they don't impact the starttime of future events\n    WHERE line_dc = 0 \n    GROUP BY icustay_id, line_number, line_event, line_type, line_site\n)\n-- metavision\n, mv AS\n(\n    SELECT \n        icustay_id\n        -- since metavision separates lines using itemid, we can use it as the line number\n        , mv.itemid AS line_number\n        , di.label AS line_type\n        , mv.location AS line_site\n        , starttime, endtime\n    FROM procedureevents_mv mv\n    INNER JOIN d_items di\n      ON mv.itemid = di.itemid\n    WHERE mv.itemid IN\n    (\n      227719 -- AVA Line\n    , 225752 -- Arterial Line\n    , 224269 -- CCO PAC\n    , 224267 -- Cordis/Introducer\n    , 224270 -- Dialysis Catheter\n    , 224272 -- IABP line\n    , 226124 -- ICP Catheter\n    , 228169 -- Impella Line\n    , 225202 -- Indwelling Port (PortaCath)\n    , 228286 -- Intraosseous Device\n    , 225204 -- Midline\n    , 224263 -- Multi Lumen\n    , 224560 -- PA Catheter\n    , 224264 -- PICC Line\n    , 225203 -- Pheresis Catheter\n    , 224273 -- Presep Catheter\n    , 225789 -- Sheath\n    , 225761 -- Sheath Insertion\n    , 228201 -- Tandem Heart Access Line\n    , 228202 -- Tandem Heart Return Line\n    , 224268 -- Trauma line\n    , 225199 -- Triple Introducer\n    , 225315 -- Tunneled (Hickman) Line\n    , 225205 -- RIC\n    )\n    AND icustay_id IS NOT NULL\n    AND statusdescription != 'Rewritten'\n),\ncombined AS\n(\n    select \n        icustay_id\n        , line_type, line_site\n        , starttime\n        , endtime\n    FROM stg4\n    UNION DISTINCT\n    select \n        icustay_id\n        , line_type, line_site\n        , starttime\n        , endtime\n    FROM mv\n)\n-- as a final step, combine any similar terms together\n-- this was comprehensive as of MIMIC-III v1.4\nselect \n    icustay_id\n    , CASE\n        WHEN line_type IN ('Arterial Line', 'A-Line') THEN 'Arterial'\n        WHEN line_type IN ('CCO PA Line', 'CCO PAC') THEN 'Continuous Cardiac Output PA'\n        WHEN line_type IN ('Dialysis Catheter', 'Dialysis Line') THEN 'Dialysis'\n        WHEN line_type IN ('Hickman', 'Tunneled (Hickman) Line') THEN 'Hickman'\n        WHEN line_type IN ('IABP', 'IABP line') THEN 'IABP'\n        WHEN line_type IN ('Multi Lumen', 'Multi-lumen') THEN 'Multi Lumen'\n        WHEN line_type IN ('PA Catheter', 'PA line') THEN 'PA'\n        WHEN line_type IN ('PICC Line', 'PICC line') THEN 'PICC'\n        WHEN line_type IN ('Pre-Sep Catheter', 'Presep Catheter') THEN 'Pre-Sep'\n        WHEN line_type IN ('Trauma Line', 'Trauma line') THEN 'Trauma'\n        WHEN line_type IN ('Triple Introducer', 'TripleIntroducer') THEN 'Triple Introducer'\n        WHEN line_type IN ('Portacath', 'Indwelling Port (PortaCath)') THEN 'Portacath'\n        -- AVA Line\n        -- Camino Bolt\n        -- Cordis/Introducer\n        -- ICP Catheter\n        -- Impella Line\n        -- Intraosseous Device\n        -- Introducer\n        -- Lumbar Drain\n        -- Midline\n        -- Other/Remarks\n        -- PacerIntroducer\n        -- PermaCath\n        -- Pheresis Catheter\n        -- RIC\n        -- Sheath\n        -- Tandem Heart Access Line\n        -- Tandem Heart Return Line\n        -- Venous Access\n        -- Ventriculostomy\n    ELSE line_type END AS line_type\n    , CASE\n        WHEN line_site IN ('Left Antecub', 'Left Antecube') THEN 'Left Antecube'\n        WHEN line_site IN ('Left Axilla', 'Left Axilla.') THEN 'Left Axilla'\n        WHEN line_site IN ('Left Brachial', 'Left Brachial.') THEN 'Left Brachial'\n        WHEN line_site IN ('Left Femoral', 'Left Femoral.') THEN 'Left Femoral'\n        WHEN line_site IN ('Right Antecub', 'Right Antecube') THEN 'Right Antecube' \n        WHEN line_site IN ('Right Axilla', 'Right Axilla.') THEN 'Right Axilla' \n        WHEN line_site IN ('Right Brachial', 'Right Brachial.') THEN 'Right Brachial' \n        WHEN line_site IN ('Right Femoral', 'Right Femoral.') THEN 'Right Femoral' \n        -- 'Left Foot'\n        -- 'Left IJ'\n        -- 'Left Radial'\n        -- 'Left Subclavian'\n        -- 'Left Ulnar'\n        -- 'Left Upper Arm'\n        -- 'Right Foot'\n        -- 'Right IJ'\n        -- 'Right Radial'\n        -- 'Right Side Head'\n        -- 'Right Subclavian'\n        -- 'Right Ulnar'\n        -- 'Right Upper Arm'\n        -- 'Transthoracic'\n        -- 'Other/Remarks'\n    ELSE line_site END AS line_site\n    , starttime\n    , endtime\nFROM combined\nORDER BY icustay_id, starttime, line_type, line_site",
        "tables": [
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.d_items",
            "mimiciii_clinical.procedureevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.stopped",
                "mimiciii_clinical.chartevents.storetime",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.d_items.itemid",
                "mimiciii_clinical.d_items.label",
                "mimiciii_clinical.procedureevents_mv.endtime",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.location",
                "mimiciii_clinical.procedureevents_mv.starttime",
                "mimiciii_clinical.procedureevents_mv.statusdescription"
            ],
            "line_type": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.stopped",
                "mimiciii_clinical.chartevents.storetime",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.d_items.itemid",
                "mimiciii_clinical.d_items.label",
                "mimiciii_clinical.procedureevents_mv.endtime",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.location",
                "mimiciii_clinical.procedureevents_mv.starttime",
                "mimiciii_clinical.procedureevents_mv.statusdescription"
            ],
            "line_site": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.stopped",
                "mimiciii_clinical.chartevents.storetime",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.d_items.itemid",
                "mimiciii_clinical.d_items.label",
                "mimiciii_clinical.procedureevents_mv.endtime",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.location",
                "mimiciii_clinical.procedureevents_mv.starttime",
                "mimiciii_clinical.procedureevents_mv.statusdescription"
            ],
            "starttime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.stopped",
                "mimiciii_clinical.chartevents.storetime",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.d_items.itemid",
                "mimiciii_clinical.d_items.label",
                "mimiciii_clinical.procedureevents_mv.endtime",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.location",
                "mimiciii_clinical.procedureevents_mv.starttime",
                "mimiciii_clinical.procedureevents_mv.statusdescription"
            ],
            "endtime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.stopped",
                "mimiciii_clinical.chartevents.storetime",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.d_items.itemid",
                "mimiciii_clinical.d_items.label",
                "mimiciii_clinical.procedureevents_mv.endtime",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.location",
                "mimiciii_clinical.procedureevents_mv.starttime",
                "mimiciii_clinical.procedureevents_mv.statusdescription"
            ]
        },
        "table_name": "mimiciii_clinical.pivoted_invasive_lines",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "combined.icustay_id",
                "(CASE WHEN (combined.line_type = ANY ('{\"Arterial Line\",A-Line}'::text[])) THEN 'Arterial'::text WHEN (combined.line_type = ANY ('{\"CCO PA Line\",\"CCO PAC\"}'::text[])) THEN 'Continuous Cardiac Output PA'::text WHEN (combined.line_type = ANY ('{\"Dialysis Catheter\",\"Dialysis Line\"}'::text[])) THEN 'Dialysis'::text WHEN (combined.line_type = ANY ('{Hickman,\"Tunneled (Hickman) Line\"}'::text[])) THEN 'Hickman'::text WHEN (combined.line_type = ANY ('{IABP,\"IABP line\"}'::text[])) THEN 'IABP'::text WHEN (combined.line_type = ANY ('{\"Multi Lumen\",Multi-lumen}'::text[])) THEN 'Multi Lumen'::text WHEN (combined.line_type = ANY ('{\"PA Catheter\",\"PA line\"}'::text[])) THEN 'PA'::text WHEN (combined.line_type = ANY ('{\"PICC Line\",\"PICC line\"}'::text[])) THEN 'PICC'::text WHEN (combined.line_type = ANY ('{\"Pre-Sep Catheter\",\"Presep Catheter\"}'::text[])) THEN 'Pre-Sep'::text WHEN (combined.line_type = ANY ('{\"Trauma Line\",\"Trauma line\"}'::text[])) THEN 'Trauma'::text WHEN (combined.line_type = ANY ('{\"Triple Introducer\",TripleIntroducer}'::text[])) THEN 'Triple Introducer'::text WHEN (combined.line_type = ANY ('{Portacath,\"Indwelling Port (PortaCath)\"}'::text[])) THEN 'Portacath'::text ELSE combined.line_type END)",
                "(CASE WHEN (combined.line_site = ANY ('{\"Left Antecub\",\"Left Antecube\"}'::text[])) THEN 'Left Antecube'::text WHEN (combined.line_site = ANY ('{\"Left Axilla\",\"Left Axilla.\"}'::text[])) THEN 'Left Axilla'::text WHEN (combined.line_site = ANY ('{\"Left Brachial\",\"Left Brachial.\"}'::text[])) THEN 'Left Brachial'::text WHEN (combined.line_site = ANY ('{\"Left Femoral\",\"Left Femoral.\"}'::text[])) THEN 'Left Femoral'::text WHEN (combined.line_site = ANY ('{\"Right Antecub\",\"Right Antecube\"}'::text[])) THEN 'Right Antecube'::text WHEN (combined.line_site = ANY ('{\"Right Axilla\",\"Right Axilla.\"}'::text[])) THEN 'Right Axilla'::text WHEN (combined.line_site = ANY ('{\"Right Brachial\",\"Right Brachial.\"}'::text[])) THEN 'Right Brachial'::text WHEN (combined.line_site = ANY ('{\"Right Femoral\",\"Right Femoral.\"}'::text[])) THEN 'Right Femoral'::text ELSE combined.line_site END)",
                "combined.starttime",
                "combined.endtime"
            ],
            "Sort Key": [
                "combined.icustay_id",
                "combined.starttime",
                "(CASE WHEN (combined.line_type = ANY ('{\"Arterial Line\",A-Line}'::text[])) THEN 'Arterial'::text WHEN (combined.line_type = ANY ('{\"CCO PA Line\",\"CCO PAC\"}'::text[])) THEN 'Continuous Cardiac Output PA'::text WHEN (combined.line_type = ANY ('{\"Dialysis Catheter\",\"Dialysis Line\"}'::text[])) THEN 'Dialysis'::text WHEN (combined.line_type = ANY ('{Hickman,\"Tunneled (Hickman) Line\"}'::text[])) THEN 'Hickman'::text WHEN (combined.line_type = ANY ('{IABP,\"IABP line\"}'::text[])) THEN 'IABP'::text WHEN (combined.line_type = ANY ('{\"Multi Lumen\",Multi-lumen}'::text[])) THEN 'Multi Lumen'::text WHEN (combined.line_type = ANY ('{\"PA Catheter\",\"PA line\"}'::text[])) THEN 'PA'::text WHEN (combined.line_type = ANY ('{\"PICC Line\",\"PICC line\"}'::text[])) THEN 'PICC'::text WHEN (combined.line_type = ANY ('{\"Pre-Sep Catheter\",\"Presep Catheter\"}'::text[])) THEN 'Pre-Sep'::text WHEN (combined.line_type = ANY ('{\"Trauma Line\",\"Trauma line\"}'::text[])) THEN 'Trauma'::text WHEN (combined.line_type = ANY ('{\"Triple Introducer\",TripleIntroducer}'::text[])) THEN 'Triple Introducer'::text WHEN (combined.line_type = ANY ('{Portacath,\"Indwelling Port (PortaCath)\"}'::text[])) THEN 'Portacath'::text ELSE combined.line_type END)",
                "(CASE WHEN (combined.line_site = ANY ('{\"Left Antecub\",\"Left Antecube\"}'::text[])) THEN 'Left Antecube'::text WHEN (combined.line_site = ANY ('{\"Left Axilla\",\"Left Axilla.\"}'::text[])) THEN 'Left Axilla'::text WHEN (combined.line_site = ANY ('{\"Left Brachial\",\"Left Brachial.\"}'::text[])) THEN 'Left Brachial'::text WHEN (combined.line_site = ANY ('{\"Left Femoral\",\"Left Femoral.\"}'::text[])) THEN 'Left Femoral'::text WHEN (combined.line_site = ANY ('{\"Right Antecub\",\"Right Antecube\"}'::text[])) THEN 'Right Antecube'::text WHEN (combined.line_site = ANY ('{\"Right Axilla\",\"Right Axilla.\"}'::text[])) THEN 'Right Axilla'::text WHEN (combined.line_site = ANY ('{\"Right Brachial\",\"Right Brachial.\"}'::text[])) THEN 'Right Brachial'::text WHEN (combined.line_site = ANY ('{\"Right Femoral\",\"Right Femoral.\"}'::text[])) THEN 'Right Femoral'::text ELSE combined.line_site END)"
            ],
            "Plans": [
                {
                    "Node Type": "Result",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE stg0",
                    "Parallel Aware": false,
                    "Output": [
                        "ce.icustay_id",
                        "ce.charttime",
                        "ce.storetime",
                        "ce.itemid",
                        "CASE WHEN (ce.itemid = ANY ('{229,8392}'::integer[])) THEN 1 WHEN (ce.itemid = ANY ('{235,8393}'::integer[])) THEN 2 WHEN (ce.itemid = ANY ('{241,8394}'::integer[])) THEN 3 WHEN (ce.itemid = ANY ('{247,8395}'::integer[])) THEN 4 WHEN (ce.itemid = ANY ('{253,8396}'::integer[])) THEN 5 WHEN (ce.itemid = ANY ('{259,8397}'::integer[])) THEN 6 WHEN (ce.itemid = ANY ('{265,8398}'::integer[])) THEN 7 WHEN (ce.itemid = ANY ('{271,8399}'::integer[])) THEN 8 ELSE NULL::integer END",
                        "CASE WHEN (ce.itemid < 8000) THEN ce.value ELSE NULL::character varying END",
                        "CASE WHEN (ce.itemid > 8000) THEN ce.value ELSE NULL::character varying END",
                        "CASE WHEN ((ce.stopped)::text = 'D/C''d'::text) THEN 1 WHEN ((ce.stopped)::text = 'NotStopd'::text) THEN 0 ELSE NULL::integer END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Append",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_33",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ce",
                                    "Output": [
                                        "ce.icustay_id",
                                        "ce.charttime",
                                        "ce.storetime",
                                        "ce.itemid",
                                        "ce.value",
                                        "ce.stopped"
                                    ],
                                    "Recheck Cond": "(ce.itemid = ANY ('{229,235,241,247,253,259,265,271,8392,8393,8394,8395,8396,8397,8398,8399}'::integer[]))",
                                    "Filter": "((ce.icustay_id IS NOT NULL) AND (COALESCE(ce.error, 0) = 0))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_33_idx01",
                                            "Index Cond": "(ce.itemid = ANY ('{229,235,241,247,253,259,265,271,8392,8393,8394,8395,8396,8397,8398,8399}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_34",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ce_1",
                                    "Output": [
                                        "ce_1.icustay_id",
                                        "ce_1.charttime",
                                        "ce_1.storetime",
                                        "ce_1.itemid",
                                        "ce_1.value",
                                        "ce_1.stopped"
                                    ],
                                    "Recheck Cond": "(ce_1.itemid = ANY ('{229,235,241,247,253,259,265,271,8392,8393,8394,8395,8396,8397,8398,8399}'::integer[]))",
                                    "Filter": "((ce_1.icustay_id IS NOT NULL) AND (COALESCE(ce_1.error, 0) = 0))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_34_idx01",
                                            "Index Cond": "(ce_1.itemid = ANY ('{229,235,241,247,253,259,265,271,8392,8393,8394,8395,8396,8397,8398,8399}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "chartevents_134",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ce_2",
                                    "Output": [
                                        "ce_2.icustay_id",
                                        "ce_2.charttime",
                                        "ce_2.storetime",
                                        "ce_2.itemid",
                                        "ce_2.value",
                                        "ce_2.stopped"
                                    ],
                                    "Recheck Cond": "(ce_2.itemid = ANY ('{229,235,241,247,253,259,265,271,8392,8393,8394,8395,8396,8397,8398,8399}'::integer[]))",
                                    "Filter": "((ce_2.icustay_id IS NOT NULL) AND (COALESCE(ce_2.error, 0) = 0))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "chartevents_134_idx01",
                                            "Index Cond": "(ce_2.itemid = ANY ('{229,235,241,247,253,259,265,271,8392,8393,8394,8395,8396,8397,8398,8399}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE stg0_rn",
                    "Parallel Aware": false,
                    "Output": [
                        "stg0.icustay_id",
                        "stg0.charttime",
                        "stg0.line_number",
                        "stg0.line_type",
                        "stg0.line_site",
                        "stg0.line_dc",
                        "row_number() OVER (?)",
                        "stg0.storetime",
                        "stg0.itemid"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "stg0.icustay_id",
                                "stg0.charttime",
                                "stg0.storetime",
                                "stg0.itemid",
                                "stg0.line_number",
                                "stg0.line_type",
                                "stg0.line_site",
                                "stg0.line_dc"
                            ],
                            "Sort Key": [
                                "stg0.icustay_id",
                                "stg0.charttime",
                                "stg0.itemid",
                                "stg0.storetime DESC"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "stg0",
                                    "Alias": "stg0",
                                    "Output": [
                                        "stg0.icustay_id",
                                        "stg0.charttime",
                                        "stg0.storetime",
                                        "stg0.itemid",
                                        "stg0.line_number",
                                        "stg0.line_type",
                                        "stg0.line_site",
                                        "stg0.line_dc"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE stg1",
                    "Parallel Aware": false,
                    "Output": [
                        "stg0_rn.icustay_id",
                        "stg0_rn.charttime",
                        "stg0_rn.line_number",
                        "max((stg0_rn.line_type)::text)",
                        "max((stg0_rn.line_site)::text)",
                        "max(stg0_rn.line_dc)"
                    ],
                    "Group Key": [
                        "stg0_rn.icustay_id",
                        "stg0_rn.charttime",
                        "stg0_rn.line_number"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "stg0_rn.icustay_id",
                                "stg0_rn.charttime",
                                "stg0_rn.line_number",
                                "stg0_rn.line_type",
                                "stg0_rn.line_site",
                                "stg0_rn.line_dc"
                            ],
                            "Sort Key": [
                                "stg0_rn.icustay_id",
                                "stg0_rn.charttime",
                                "stg0_rn.line_number"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "stg0_rn",
                                    "Alias": "stg0_rn",
                                    "Output": [
                                        "stg0_rn.icustay_id",
                                        "stg0_rn.charttime",
                                        "stg0_rn.line_number",
                                        "stg0_rn.line_type",
                                        "stg0_rn.line_site",
                                        "stg0_rn.line_dc"
                                    ],
                                    "Filter": "(stg0_rn.rn_last_stored = 1)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE stg2",
                    "Parallel Aware": false,
                    "Output": [
                        "stg1.icustay_id",
                        "stg1.charttime",
                        "stg1.line_number",
                        "stg1.line_type",
                        "stg1.line_site",
                        "stg1.line_dc",
                        "CASE WHEN (lag(stg1.line_dc) OVER (?) = 1) THEN 1 WHEN ((lag(stg1.line_type) OVER (?) = stg1.line_type) AND (datetime_diff(stg1.charttime, lag(stg1.charttime) OVER (?), 'HOUR'::text) < '16'::numeric)) THEN 0 ELSE 1 END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "stg1.icustay_id",
                                "stg1.charttime",
                                "stg1.line_number",
                                "stg1.line_type",
                                "stg1.line_site",
                                "stg1.line_dc"
                            ],
                            "Sort Key": [
                                "stg1.icustay_id",
                                "stg1.line_number",
                                "stg1.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "stg1",
                                    "Alias": "stg1",
                                    "Output": [
                                        "stg1.icustay_id",
                                        "stg1.charttime",
                                        "stg1.line_number",
                                        "stg1.line_type",
                                        "stg1.line_site",
                                        "stg1.line_dc"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE stg3",
                    "Parallel Aware": false,
                    "Output": [
                        "stg2.icustay_id",
                        "stg2.charttime",
                        "stg2.line_number",
                        "stg2.line_type",
                        "stg2.line_site",
                        "stg2.line_dc",
                        "sum(stg2.rn_part) OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "stg2.icustay_id",
                                "stg2.charttime",
                                "stg2.line_number",
                                "stg2.line_type",
                                "stg2.line_site",
                                "stg2.line_dc",
                                "stg2.rn_part"
                            ],
                            "Sort Key": [
                                "stg2.icustay_id",
                                "stg2.line_number",
                                "stg2.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "stg2",
                                    "Alias": "stg2",
                                    "Output": [
                                        "stg2.icustay_id",
                                        "stg2.charttime",
                                        "stg2.line_number",
                                        "stg2.line_type",
                                        "stg2.line_site",
                                        "stg2.line_dc",
                                        "stg2.rn_part"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE stg4",
                    "Parallel Aware": false,
                    "Output": [
                        "stg3.icustay_id",
                        "stg3.line_number",
                        "stg3.line_event",
                        "stg3.line_type",
                        "stg3.line_site",
                        "min(stg3.charttime)",
                        "max(stg3.charttime)"
                    ],
                    "Group Key": [
                        "stg3.icustay_id",
                        "stg3.line_number",
                        "stg3.line_event",
                        "stg3.line_type",
                        "stg3.line_site"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "stg3.icustay_id",
                                "stg3.line_number",
                                "stg3.line_event",
                                "stg3.line_type",
                                "stg3.line_site",
                                "stg3.charttime"
                            ],
                            "Sort Key": [
                                "stg3.icustay_id",
                                "stg3.line_number",
                                "stg3.line_event",
                                "stg3.line_type",
                                "stg3.line_site"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "stg3",
                                    "Alias": "stg3",
                                    "Output": [
                                        "stg3.icustay_id",
                                        "stg3.line_number",
                                        "stg3.line_event",
                                        "stg3.line_type",
                                        "stg3.line_site",
                                        "stg3.charttime"
                                    ],
                                    "Filter": "(stg3.line_dc = 0)"
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE mv",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "mv.icustay_id",
                        "mv.itemid",
                        "di.label",
                        "mv.location",
                        "mv.starttime",
                        "mv.endtime"
                    ],
                    "Inner Unique": true,
                    "Hash Cond": "(mv.itemid = di.itemid)",
                    "Plans": [
                        {
                            "Node Type": "Bitmap Heap Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "procedureevents_mv",
                            "Schema": "mimiciii_clinical",
                            "Alias": "mv",
                            "Output": [
                                "mv.row_id",
                                "mv.subject_id",
                                "mv.hadm_id",
                                "mv.icustay_id",
                                "mv.starttime",
                                "mv.endtime",
                                "mv.itemid",
                                "mv.value",
                                "mv.valueuom",
                                "mv.location",
                                "mv.locationcategory",
                                "mv.storetime",
                                "mv.cgid",
                                "mv.orderid",
                                "mv.linkorderid",
                                "mv.ordercategoryname",
                                "mv.secondaryordercategoryname",
                                "mv.ordercategorydescription",
                                "mv.isopenbag",
                                "mv.continueinnextdept",
                                "mv.cancelreason",
                                "mv.statusdescription",
                                "mv.comments_editedby",
                                "mv.comments_canceledby",
                                "mv.comments_date"
                            ],
                            "Recheck Cond": "(mv.itemid = ANY ('{227719,225752,224269,224267,224270,224272,226124,228169,225202,228286,225204,224263,224560,224264,225203,224273,225789,225761,228201,228202,224268,225199,225315,225205}'::integer[]))",
                            "Filter": "((mv.icustay_id IS NOT NULL) AND ((mv.statusdescription)::text <> 'Rewritten'::text))",
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Index Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Index Name": "procedureevents_mv_idx05",
                                    "Index Cond": "(mv.itemid = ANY ('{227719,225752,224269,224267,224270,224272,226124,228169,225202,228286,225204,224263,224560,224264,225203,224273,225789,225761,228201,228202,224268,225199,225315,225205}'::integer[]))"
                                }
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "di.label",
                                "di.itemid"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "d_items",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "di",
                                    "Output": [
                                        "di.label",
                                        "di.itemid"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE combined",
                    "Parallel Aware": false,
                    "Output": [
                        "stg4.icustay_id",
                        "stg4.line_type",
                        "stg4.line_site",
                        "stg4.starttime",
                        "stg4.endtime"
                    ],
                    "Group Key": [
                        "stg4.icustay_id",
                        "stg4.line_type",
                        "stg4.line_site",
                        "stg4.starttime",
                        "stg4.endtime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Append",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "CTE Name": "stg4",
                                    "Alias": "stg4",
                                    "Output": [
                                        "stg4.icustay_id",
                                        "stg4.line_type",
                                        "stg4.line_site",
                                        "stg4.starttime",
                                        "stg4.endtime"
                                    ]
                                },
                                {
                                    "Node Type": "Subquery Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Alias": "*SELECT* 2",
                                    "Output": [
                                        "\"*SELECT* 2\".icustay_id",
                                        "\"*SELECT* 2\".line_type",
                                        "\"*SELECT* 2\".line_site",
                                        "\"*SELECT* 2\".starttime",
                                        "\"*SELECT* 2\".endtime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Subquery",
                                            "Parallel Aware": false,
                                            "CTE Name": "mv",
                                            "Alias": "mv_1",
                                            "Output": [
                                                "mv_1.icustay_id",
                                                "mv_1.line_type",
                                                "mv_1.line_site",
                                                "mv_1.starttime",
                                                "mv_1.endtime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "CTE Name": "combined",
                    "Alias": "combined",
                    "Output": [
                        "combined.icustay_id",
                        "CASE WHEN (combined.line_type = ANY ('{\"Arterial Line\",A-Line}'::text[])) THEN 'Arterial'::text WHEN (combined.line_type = ANY ('{\"CCO PA Line\",\"CCO PAC\"}'::text[])) THEN 'Continuous Cardiac Output PA'::text WHEN (combined.line_type = ANY ('{\"Dialysis Catheter\",\"Dialysis Line\"}'::text[])) THEN 'Dialysis'::text WHEN (combined.line_type = ANY ('{Hickman,\"Tunneled (Hickman) Line\"}'::text[])) THEN 'Hickman'::text WHEN (combined.line_type = ANY ('{IABP,\"IABP line\"}'::text[])) THEN 'IABP'::text WHEN (combined.line_type = ANY ('{\"Multi Lumen\",Multi-lumen}'::text[])) THEN 'Multi Lumen'::text WHEN (combined.line_type = ANY ('{\"PA Catheter\",\"PA line\"}'::text[])) THEN 'PA'::text WHEN (combined.line_type = ANY ('{\"PICC Line\",\"PICC line\"}'::text[])) THEN 'PICC'::text WHEN (combined.line_type = ANY ('{\"Pre-Sep Catheter\",\"Presep Catheter\"}'::text[])) THEN 'Pre-Sep'::text WHEN (combined.line_type = ANY ('{\"Trauma Line\",\"Trauma line\"}'::text[])) THEN 'Trauma'::text WHEN (combined.line_type = ANY ('{\"Triple Introducer\",TripleIntroducer}'::text[])) THEN 'Triple Introducer'::text WHEN (combined.line_type = ANY ('{Portacath,\"Indwelling Port (PortaCath)\"}'::text[])) THEN 'Portacath'::text ELSE combined.line_type END",
                        "CASE WHEN (combined.line_site = ANY ('{\"Left Antecub\",\"Left Antecube\"}'::text[])) THEN 'Left Antecube'::text WHEN (combined.line_site = ANY ('{\"Left Axilla\",\"Left Axilla.\"}'::text[])) THEN 'Left Axilla'::text WHEN (combined.line_site = ANY ('{\"Left Brachial\",\"Left Brachial.\"}'::text[])) THEN 'Left Brachial'::text WHEN (combined.line_site = ANY ('{\"Left Femoral\",\"Left Femoral.\"}'::text[])) THEN 'Left Femoral'::text WHEN (combined.line_site = ANY ('{\"Right Antecub\",\"Right Antecube\"}'::text[])) THEN 'Right Antecube'::text WHEN (combined.line_site = ANY ('{\"Right Axilla\",\"Right Axilla.\"}'::text[])) THEN 'Right Axilla'::text WHEN (combined.line_site = ANY ('{\"Right Brachial\",\"Right Brachial.\"}'::text[])) THEN 'Right Brachial'::text WHEN (combined.line_site = ANY ('{\"Right Femoral\",\"Right Femoral.\"}'::text[])) THEN 'Right Femoral'::text ELSE combined.line_site END",
                        "combined.starttime",
                        "combined.endtime"
                    ]
                }
            ]
        }
    },
    "model.mimic.pivoted_rrt": {
        "sql": "-- Creates a table with icustay_id / time / dialysis type (if present)\n\nwith ce as\n(\n  select ce.icustay_id\n    , ce.charttime\n          -- when ce.itemid in (152,148,149,146,147,151,150) and value is not null then 1\n          -- when ce.itemid in (229,235,241,247,253,259,265,271) and value = 'Dialysis Line' then 1\n          -- when ce.itemid = 466 and value = 'Dialysis RN' then 1\n          -- when ce.itemid = 927 and value = 'Dialysis Solutions' then 1\n          -- when ce.itemid = 6250 and value = 'dialys' then 1\n          -- when ce.\n          -- when ce.itemid = 582 and value in ('CAVH Start','CAVH D/C','CVVHD Start','CVVHD D/C','Hemodialysis st','Hemodialysis end') then 1\n    , CASE\n        WHEN ce.itemid IN\n        (\n          146 -- \"Dialysate Flow ml/hr\"\n          , 147 -- \"Dialysate Infusing\";56605\n          , 148 -- \"Dialysis Access Site\";60335\n          , 149 -- \"Dialysis Access Type\";60030\n          , 150 -- \"Dialysis Machine\";27472 (baxter or gambro)\n          , 151 -- \"Dialysis Site Appear\";37345\n          , 152 -- \"Dialysis Type\";61449\n        ) THEN 1\n        WHEN ce.itemid = 582 AND value IN \n        (\n          'CAVH Start', 'CVVHD Start', 'Hemodialysis st',\n          'CAVH D/C', 'CVVHD D/C', 'Hemodialysis end',\n          'Peritoneal Dial'\n        ) THEN 1\n        WHEN ce.itemid IN (229, 235, 241, 247, 253, 259, 265, 271) AND value = 'Dialysis Line' \n          THEN 1\n        -- WHEN ce.itemid = 917 AND value IN\n        -- (\n        --   '+ INITIATE DIALYSIS', 'BLEEDING FROM DIALYSIS CATHETER',\n        --   -- 'FAILED DIALYSIS CATH.',\n        --   'FEBRILE SYNDROME;DIALYSIS', 'HYPOTENSION WITH HEMODIALYSIS',\n        --   'HYPOTENSION.GLOGGED DIALYSIS',\n        --   'INFECTED DIALYSIS CATHETER'\n        -- )\n        -- metavision itemids\n\n        -- checkboxes\n        WHEN ce.itemid IN\n        (\n            226118 -- | Dialysis Catheter placed in outside facility      | Access Lines - Invasive | chartevents        | Checkbox\n          , 227357 -- | Dialysis Catheter Dressing Occlusive              | Access Lines - Invasive | chartevents        | Checkbox\n          , 225725 -- | Dialysis Catheter Tip Cultured                    | Access Lines - Invasive | chartevents        | Checkbox\n        ) THEN 1\n        -- numeric data\n        WHEN ce.itemid IN\n        (\n            226499 -- | Hemodialysis Output                               | Dialysis\n          , 224154 -- | Dialysate Rate                                    | Dialysis\n          , 225810 -- | Dwell Time (Peritoneal Dialysis)                  | Dialysis\n          , 225959 -- | Medication Added Amount  #1 (Peritoneal Dialysis) | Dialysis\n          , 227639 -- | Medication Added Amount  #2 (Peritoneal Dialysis) | Dialysis\n          , 225183 -- | Current Goal                     | Dialysis\n          , 227438 -- | Volume not removed               | Dialysis\n          , 224191 -- | Hourly Patient Fluid Removal     | Dialysis\n          , 225806 -- | Volume In (PD)                   | Dialysis\n          , 225807 -- | Volume Out (PD)                  | Dialysis\n          , 228004 -- | Citrate (ACD-A)                  | Dialysis\n          , 228005 -- | PBP (Prefilter) Replacement Rate | Dialysis\n          , 228006 -- | Post Filter Replacement Rate     | Dialysis\n          , 224144 -- | Blood Flow (ml/min)              | Dialysis\n          , 224145 -- | Heparin Dose (per hour)          | Dialysis\n          , 224149 -- | Access Pressure                  | Dialysis\n          , 224150 -- | Filter Pressure                  | Dialysis\n          , 224151 -- | Effluent Pressure                | Dialysis\n          , 224152 -- | Return Pressure                  | Dialysis\n          , 224153 -- | Replacement Rate                 | Dialysis\n          , 224404 -- | ART Lumen Volume                 | Dialysis\n          , 224406 -- | VEN Lumen Volume                 | Dialysis\n          , 226457 -- | Ultrafiltrate Output             | Dialysis\n        ) THEN 1\n\n        -- text fields\n        WHEN ce.itemid IN\n        (\n            224135 -- | Dialysis Access Site | Dialysis\n          , 224139 -- | Dialysis Site Appearance | Dialysis\n          , 224146 -- | System Integrity | Dialysis\n          , 225323 -- | Dialysis Catheter Site Appear | Access Lines - Invasive\n          , 225740 -- | Dialysis Catheter Discontinued | Access Lines - Invasive\n          , 225776 -- | Dialysis Catheter Dressing Type | Access Lines - Invasive\n          , 225951 -- | Peritoneal Dialysis Fluid Appearance | Dialysis\n          , 225952 -- | Medication Added #1 (Peritoneal Dialysis) | Dialysis\n          , 225953 -- | Solution (Peritoneal Dialysis) | Dialysis\n          , 225954 -- | Dialysis Access Type | Dialysis\n          , 225956 -- | Reason for CRRT Filter Change | Dialysis\n          , 225958 -- | Heparin Concentration (units/mL) | Dialysis\n          , 225961 -- | Medication Added Units #1 (Peritoneal Dialysis) | Dialysis\n          , 225963 -- | Peritoneal Dialysis Catheter Type | Dialysis\n          , 225965 -- | Peritoneal Dialysis Catheter Status | Dialysis\n          , 225976 -- | Replacement Fluid | Dialysis\n          , 225977 -- | Dialysate Fluid | Dialysis\n          , 227124 -- | Dialysis Catheter Type | Access Lines - Invasive\n          , 227290 -- | CRRT mode | Dialysis\n          , 227638 -- | Medication Added #2 (Peritoneal Dialysis) | Dialysis\n          , 227640 -- | Medication Added Units #2 (Peritoneal Dialysis) | Dialysis\n          , 227753 -- | Dialysis Catheter Placement Confirmed by X-ray | Access Lines - Invasive\n        ) THEN 1\n      ELSE 0 END\n      AS dialysis_present\n    , CASE\n        WHEN ce.itemid = 582 AND value IN \n        (\n          'CAVH Start', 'CVVHD Start', 'Hemodialysis st',\n          'Peritoneal Dial'\n        ) THEN 1\n        WHEN ce.itemid = 582 AND value IN \n        (\n          'CAVH D/C', 'CVVHD D/C', 'Hemodialysis end'\n        ) THEN 0\n        WHEN ce.itemid = 147 AND value = 'Yes' THEN 1 -- \"Dialysate Infusing\";56605\n        WHEN ce.itemid = 225965 -- Peritoneal Dialysis Catheter Status\n          AND value = 'In use' THEN 1\n        WHEN ce.itemid IN\n        (\n            146    -- Dialysate Flow ml/hr\n          , 226499 -- | Hemodialysis Output              | Dialysis\n          , 224154 -- | Dialysate Rate                   | Dialysis\n          , 225183 -- | Current Goal                     | Dialysis\n          , 227438 -- | Volume not removed               | Dialysis\n          , 224191 -- | Hourly Patient Fluid Removal     | Dialysis\n          , 225806 -- | Volume In (PD)                   | Dialysis\n          , 225807 -- | Volume Out (PD)                  | Dialysis\n          , 228004 -- | Citrate (ACD-A)                  | Dialysis\n          , 228005 -- | PBP (Prefilter) Replacement Rate | Dialysis\n          , 228006 -- | Post Filter Replacement Rate     | Dialysis\n          , 224144 -- | Blood Flow (ml/min)              | Dialysis\n          , 224145 -- | Heparin Dose (per hour)          | Dialysis\n          , 224153 -- | Replacement Rate                 | Dialysis\n          , 226457 -- | Ultrafiltrate Output             | Dialysis\n        ) THEN 1\n      ELSE 0 END\n      AS dialysis_active\n    , CASE\n        -- dialysis mode\n        WHEN ce.itemid in (152, 227290) THEN\n          CASE\n            WHEN value = 'CVVH' THEN 'CVVH'\n            WHEN value = 'CVVHD' THEN 'CVVHD'\n            WHEN value = 'CVVHDF' THEN 'CVVHDF'\n            WHEN value = 'SCUF' THEN 'SCUF'\n            WHEN value = 'Peritoneal' THEN 'Peritoneal'\n          END\n        -- itemids which imply a certain dialysis mode\n\n        -- peritoneal dialysis\n        WHEN ce.itemid IN \n        (\n            225810 -- | Dwell Time (Peritoneal Dialysis) | Dialysis\n          , 225806 -- | Volume In (PD)                   | Dialysis\n          , 225807 -- | Volume Out (PD)                  | Dialysis\n          , 225810 -- | Dwell Time (Peritoneal Dialysis)                  | Dialysis\n          , 227639 -- | Medication Added Amount  #2 (Peritoneal Dialysis) | Dialysis\n          , 225959 -- | Medication Added Amount  #1 (Peritoneal Dialysis) | Dialysis\n          , 225951 -- | Peritoneal Dialysis Fluid Appearance | Dialysis\n          , 225952 -- | Medication Added #1 (Peritoneal Dialysis) | Dialysis\n          , 225961 -- | Medication Added Units #1 (Peritoneal Dialysis) | Dialysis\n          , 225953 -- | Solution (Peritoneal Dialysis) | Dialysis\n          , 225963 -- | Peritoneal Dialysis Catheter Type | Dialysis\n          , 225965 -- | Peritoneal Dialysis Catheter Status | Dialysis\n          , 227638 -- | Medication Added #2 (Peritoneal Dialysis) | Dialysis\n          , 227640 -- | Medication Added Units #2 (Peritoneal Dialysis) | Dialysis\n        )\n          THEN 'Peritoneal'\n        WHEN ce.itemid IN (226499)\n          THEN 'IHD'\n        WHEN ce.itemid = 582 THEN\n          CASE\n            WHEN value IN ('CAVH Start','CAVH D/C')\n              THEN 'CAVH'\n            WHEN value IN ('CVVHD Start','CVVHD D/C')\n              THEN 'CVVHD'\n            WHEN value IN ('Hemodialysis st', 'Hemodialysis end')\n              -- null is ambiguous\n              THEN NULL\n          ELSE NULL\n          END\n      ELSE NULL END as dialysis_type\n  from chartevents ce\n  WHERE ce.itemid in\n  (\n     152 -- \"Dialysis Type\";61449\n    ,146 -- \"Dialysate Flow ml/hr\";57445\n    ,147 -- \"Dialysate Infusing\";56605\n    ,148 -- \"Dialysis Access Site\";60335\n    ,149 -- \"Dialysis Access Type\";60030\n    ,150 -- \"Dialysis Machine\";27472 (baxter or gambro)\n    ,151 -- \"Dialysis Site Appear\";37345\n    ,582 -- Procedures\n    -- below indicate existence of a dialysis line\n    ,229 -- INV Line#1 [Type]\n    ,235 -- INV Line#2 [Type]\n    ,241 -- INV Line#3 [Type]\n    ,247 -- INV Line#4 [Type]\n    ,253 -- INV Line#5 [Type]\n    ,259 -- INV Line#6 [Type]\n    ,265 -- INV Line#7 [Type]\n    ,271 -- INV Line#8 [Type]\n    \n    -- dialysis consults can't be 100% guaranteed to be active\n    -- ,466 -- Nursing Consultation\n    -- diagnosis has 6 or 7 dx related to dialysis, probably not worth including\n    -- as the chart time isn't going to match the start time of dialysis\n    -- , 917 -- Diagnosis/op\n    -- ,7949 -- \"Calcium for CVVH\" - only has 2 null values\n    \n    -- === MetaVision itemids === --\n  \n    -- Checkboxes\n    , 226118 -- | Dialysis Catheter placed in outside facility      | Access Lines - Invasive | chartevents        | Checkbox\n    , 227357 -- | Dialysis Catheter Dressing Occlusive              | Access Lines - Invasive | chartevents        | Checkbox\n    , 225725 -- | Dialysis Catheter Tip Cultured                    | Access Lines - Invasive | chartevents        | Checkbox\n\n    -- Numeric values\n    , 226499 -- | Hemodialysis Output                               | Dialysis                | chartevents        | Numeric\n    , 224154 -- | Dialysate Rate                                    | Dialysis                | chartevents        | Numeric\n    , 225810 -- | Dwell Time (Peritoneal Dialysis)                  | Dialysis                | chartevents        | Numeric\n    , 227639 -- | Medication Added Amount  #2 (Peritoneal Dialysis) | Dialysis                | chartevents        | Numeric\n    , 225183 -- | Current Goal                     | Dialysis | chartevents        | Numeric\n    , 227438 -- | Volume not removed               | Dialysis | chartevents        | Numeric\n    , 224191 -- | Hourly Patient Fluid Removal     | Dialysis | chartevents        | Numeric\n    , 225806 -- | Volume In (PD)                   | Dialysis | chartevents        | Numeric\n    , 225807 -- | Volume Out (PD)                  | Dialysis | chartevents        | Numeric\n    , 228004 -- | Citrate (ACD-A)                  | Dialysis | chartevents        | Numeric\n    , 228005 -- | PBP (Prefilter) Replacement Rate | Dialysis | chartevents        | Numeric\n    , 228006 -- | Post Filter Replacement Rate     | Dialysis | chartevents        | Numeric\n    , 224144 -- | Blood Flow (ml/min)              | Dialysis | chartevents        | Numeric\n    , 224145 -- | Heparin Dose (per hour)          | Dialysis | chartevents        | Numeric\n    , 224149 -- | Access Pressure                  | Dialysis | chartevents        | Numeric\n    , 224150 -- | Filter Pressure                  | Dialysis | chartevents        | Numeric\n    , 224151 -- | Effluent Pressure                | Dialysis | chartevents        | Numeric\n    , 224152 -- | Return Pressure                  | Dialysis | chartevents        | Numeric\n    , 224153 -- | Replacement Rate                 | Dialysis | chartevents        | Numeric\n    , 224404 -- | ART Lumen Volume                 | Dialysis | chartevents        | Numeric\n    , 224406 -- | VEN Lumen Volume                 | Dialysis | chartevents        | Numeric\n    , 226457 -- | Ultrafiltrate Output             | Dialysis | chartevents        | Numeric\n    , 225959 -- | Medication Added Amount  #1 (Peritoneal Dialysis) | Dialysis | chartevents | Numeric\n    -- Text values\n    , 224135 -- | Dialysis Access Site | Dialysis | chartevents | Text\n    , 224139 -- | Dialysis Site Appearance | Dialysis | chartevents | Text\n    , 224146 -- | System Integrity | Dialysis | chartevents | Text\n    , 225323 -- | Dialysis Catheter Site Appear | Access Lines - Invasive | chartevents | Text\n    , 225740 -- | Dialysis Catheter Discontinued | Access Lines - Invasive | chartevents | Text\n    , 225776 -- | Dialysis Catheter Dressing Type | Access Lines - Invasive | chartevents | Text\n    , 225951 -- | Peritoneal Dialysis Fluid Appearance | Dialysis | chartevents | Text\n    , 225952 -- | Medication Added #1 (Peritoneal Dialysis) | Dialysis | chartevents | Text\n    , 225953 -- | Solution (Peritoneal Dialysis) | Dialysis | chartevents | Text\n    , 225954 -- | Dialysis Access Type | Dialysis | chartevents | Text\n    , 225956 -- | Reason for CRRT Filter Change | Dialysis | chartevents | Text\n    , 225958 -- | Heparin Concentration (units/mL) | Dialysis | chartevents | Text\n    , 225961 -- | Medication Added Units #1 (Peritoneal Dialysis) | Dialysis | chartevents | Text\n    , 225963 -- | Peritoneal Dialysis Catheter Type | Dialysis | chartevents | Text\n    , 225965 -- | Peritoneal Dialysis Catheter Status | Dialysis | chartevents | Text\n    , 225976 -- | Replacement Fluid | Dialysis | chartevents | Text\n    , 225977 -- | Dialysate Fluid | Dialysis | chartevents | Text\n    , 227124 -- | Dialysis Catheter Type | Access Lines - Invasive | chartevents | Text\n    , 227290 -- | CRRT mode | Dialysis | chartevents | Text\n    , 227638 -- | Medication Added #2 (Peritoneal Dialysis) | Dialysis | chartevents | Text\n    , 227640 -- | Medication Added Units #2 (Peritoneal Dialysis) | Dialysis | chartevents | Text\n    , 227753 -- | Dialysis Catheter Placement Confirmed by X-ray | Access Lines - Invasive | chartevents | Text\n  )\n  AND ce.value IS NOT NULL\n  AND ce.icustay_id IS NOT NULL\n  -- exclude rows marked as error\n  and COALESCE(ce.error, 0) = 0\n)\n\n-- TODO:\n--   charttime + dialysis_present + dialysis_active\n--  for inputevents_cv, outputevents\n--  for procedures_mv, left join and set the dialysis_type\n, cv_ie as\n(\n  select icustay_id\n    , charttime\n    , 1 AS dialysis_present\n    , CASE\n        WHEN itemid NOT IN\n        (\n          44954 -- OR CVVHDF |  | inputevents_cv\n        ) THEN 1\n      ELSE 0 END AS dialysis_active\n    , CASE\n        WHEN itemid IN\n        (\n            40788 -- PD dialysate in | Free Form Intake | inputevents_cv\n          , 41063 -- PD Dialysate Intake | Free Form Intake | inputevents_cv\n          , 41307 -- Peritoneal Dialysate | Free Form Intake | inputevents_cv\n          , 43829 -- PERITONEAL DIALYSATE | Free Form Intake | inputevents_cv\n          , 44698 -- peritoneal dialysate | Free Form Intake | inputevents_cv\n          , 46720 -- PD Dialysate | Free Form Intake | inputevents_cv\n        ) THEN 'Peritoneal'\n        WHEN itemid IN\n        (\n            45352 -- CA GLUC for CVVH | Free Form Intake | inputevents_cv\n          , 45353 -- KCL for CVVH | Free Form Intake | inputevents_cv\n        ) THEN 'CVVH'\n        WHEN itemid IN\n        (\n            45268 -- CALCIUM FOR CVVHD | Free Form Intake | inputevents_cv\n          , 46769 -- cvvdh rescue line | Free Form Intake | inputevents_cv\n          , 46773 -- CVVHD NS line flush | Free Form Intake | inputevents_cv\n        ) THEN 'CVVHD'\n        WHEN itemid IN\n        (\n            46012 -- CA GLUC CVVHDF | Free Form Intake | inputevents_cv\n          , 46013 -- KCL CVVHDF | Free Form Intake | inputevents_cv\n          , 46172 -- CVVHDF CA GLUC | Free Form Intake | inputevents_cv\n          , 46173 -- CVVHDF KCL | Free Form Intake | inputevents_cv\n        ) THEN 'CVVHDF'\n      ELSE NULL END AS dialysis_type\n  from inputevents_cv\n  where itemid in\n  (\n        40788 -- PD dialysate in | Free Form Intake | inputevents_cv\n      , 40907 -- dialysate | Free Form Intake | inputevents_cv\n      , 41063 -- PD Dialysate Intake | Free Form Intake | inputevents_cv\n      , 41147 -- Dialysate instilled | Free Form Intake | inputevents_cv\n      , 41307 -- Peritoneal Dialysate | Free Form Intake | inputevents_cv\n      , 41460 -- capd dialysate | Free Form Intake | inputevents_cv\n      , 41620 -- dialysate in | Free Form Intake | inputevents_cv\n      , 41711 -- CAPD dialysate dwell | Free Form Intake | inputevents_cv\n      , 41791 -- 2.5% dialysate in | Free Form Intake | inputevents_cv\n      , 41792 -- 1.5% dialysate | Free Form Intake | inputevents_cv\n      , 42562 -- pos. dialysate intak | Free Form Intake | inputevents_cv\n      , 43829 -- PERITONEAL DIALYSATE | Free Form Intake | inputevents_cv\n      , 44037 -- Dialysate Instilled | Free Form Intake | inputevents_cv\n      , 44188 -- rep.+dialysate | Free Form Intake | inputevents_cv\n      , 44526 -- dialysate 1.5% dex | Free Form Intake | inputevents_cv\n      , 44527 -- dialysate 2.5% | Free Form Intake | inputevents_cv\n      , 44584 -- Dialysate IN | Free Form Intake | inputevents_cv\n      , 44591 -- dialysate 4.25% | Free Form Intake | inputevents_cv\n      , 44698 -- peritoneal dialysate | Free Form Intake | inputevents_cv\n      , 44927 -- CRRT HEPARIN | Free Form Intake | inputevents_cv\n      , 44954 -- OR CVVHDF |  | inputevents_cv\n      , 45157 -- ca+ gtt for cvvh | Free Form Intake | inputevents_cv\n      , 45268 -- CALCIUM FOR CVVHD | Free Form Intake | inputevents_cv\n      , 45352 -- CA GLUC for CVVH | Free Form Intake | inputevents_cv\n      , 45353 -- KCL for CVVH | Free Form Intake | inputevents_cv\n      , 46012 -- CA GLUC CVVHDF | Free Form Intake | inputevents_cv\n      , 46013 -- KCL CVVHDF | Free Form Intake | inputevents_cv\n      , 46172 -- CVVHDF CA GLUC | Free Form Intake | inputevents_cv\n      , 46173 -- CVVHDF KCL | Free Form Intake | inputevents_cv\n      , 46250 -- EBL  CVVH |  | inputevents_cv\n      , 46262 -- dialysate 2.5% in | Free Form Intake | inputevents_cv\n      , 46292 -- CRRT Irrigation | Free Form Intake | inputevents_cv\n      , 46293 -- CRRT Citrate | Free Form Intake | inputevents_cv\n      , 46311 -- crrt irrigation | Free Form Intake | inputevents_cv\n      , 46389 -- CRRT FLUSH | Free Form Intake | inputevents_cv\n      , 46574 -- CRRT rescue line NS | Free Form Intake | inputevents_cv\n      , 46681 -- CRRT Rescue Flush | Free Form Intake | inputevents_cv\n      , 46720 -- PD Dialysate | Free Form Intake | inputevents_cv\n      , 46769 -- cvvdh rescue line | Free Form Intake | inputevents_cv\n      , 46773 -- CVVHD NS line flush | Free Form Intake | inputevents_cv\n  )\n  and amount > 0 -- also ensures it's not null\n)\n, oe as\n(\n select icustay_id\n    , charttime\n    , 1 AS dialysis_present\n    , CASE\n        WHEN itemid NOT IN\n        (\n          41897 -- CVVH OUTPUT FROM OR\n        ) THEN 1\n      ELSE 0 END AS dialysis_active\n    , CASE\n        WHEN itemid IN\n        (\n          40789 -- PD dialysate out\n        , 40910 -- PERITONEAL DIALYSIS\n        , 41069 -- PD Dialysate Output\n        , 44843 -- peritoneal dialysis\n        , 46394 -- Peritoneal dialysis\n        ) THEN 'Peritoneal'\n      ELSE NULL END AS dialysis_type\n from outputevents\n where itemid in\n (\n       40386 -- hemodialysis\n     , 40425 -- dialysis output\n     , 40426 -- dialysis out\n     , 40507 -- Dialysis out\n     , 40613 -- DIALYSIS OUT\n     , 40624 -- dialysis\n     , 40690 -- DIALYSIS\n     , 40745 -- Dialysis\n     , 40789 -- PD dialysate out\n     , 40881 -- Hemodialysis\n     , 40910 -- PERITONEAL DIALYSIS\n     , 41016 -- hemodialysis out\n     , 41034 -- dialysis in\n     , 41069 -- PD Dialysate Output\n     , 41112 -- Dialysys out\n     , 41250 -- HEMODIALYSIS OUT\n     , 41374 -- Dialysis Out\n     , 41417 -- Hemodialysis Out\n     , 41500 -- hemodialysis output\n     , 41527 -- HEMODIALYSIS\n     , 41623 -- dialysate out\n     , 41635 -- Hemodialysis removal\n     , 41713 -- dialyslate out\n     , 41750 -- dialysis  out\n     , 41829 -- HEMODIALYSIS OUTPUT\n     , 41842 -- Dialysis Output.\n     , 41897 -- CVVH OUTPUT FROM OR\n     , 42289 -- dialysis off\n     , 42388 -- DIALYSIS OUTPUT\n     , 42464 -- hemodialysis ultrafe\n     , 42524 -- HemoDialysis\n     , 42536 -- Dialysis output\n     , 42868 -- hemodialysis off\n     , 42928 -- HEMODIALYSIS.\n     , 42972 -- HEMODIALYSIS OFF\n     , 43016 -- DIALYSIS TOTAL OUT\n     , 43052 -- DIALYSIS REMOVED\n     , 43098 -- hemodialysis crystal\n     , 43115 -- dialysis net\n     , 43687 -- crystalloid/dialysis\n     , 43941 -- dialysis/intake\n     , 44027 -- dialysis fluid off\n     , 44085 -- DIALYSIS OFF\n     , 44193 -- Dialysis.\n     , 44199 -- HEMODIALYSIS O/P\n     , 44216 -- Hemodialysis out\n     , 44286 -- Dialysis indwelling\n     , 44567 -- Hemodialysis.\n     , 44843 -- peritoneal dialysis\n     , 44845 -- Dialysis fluids\n     , 44857 -- dialysis- fluid off\n     , 44901 -- Dialysis Removed\n     , 44943 -- fluid removed dialys\n     , 45479 -- Dialysis In\n     , 45828 -- Hemo dialysis out\n     , 46230 -- Dialysis 1.5% IN\n     , 46232 -- dialysis flush\n     , 46394 -- Peritoneal dialysis\n     , 46464 -- Hemodialysis OUT\n     , 46712 -- CALCIUM-DIALYSIS\n     , 46713 -- KCL-10 MEQ-DIALYSIS\n     , 46715 -- Citrate - dialysis\n     , 46741 -- dialysis removed\n )\n and value > 0 -- also ensures it's not null\n)\n, mv_ranges as\n(\n  select icustay_id\n    , starttime, endtime\n    , 1 AS dialysis_present\n    , 1 AS dialysis_active\n    , 'CRRT' as dialysis_type\n  from inputevents_mv\n  where itemid in\n  (\n      227536 --\tKCl (CRRT)\tMedications\tinputevents_mv\tSolution\n    , 227525 --\tCalcium Gluconate (CRRT)\tMedications\tinputevents_mv\tSolution\n  )\n  and amount > 0 -- also ensures it's not null\n  UNION DISTINCT\n  select icustay_id\n    , starttime, endtime\n    , 1 AS dialysis_present\n    , CASE WHEN itemid NOT IN (224270, 225436) THEN 1 ELSE 0 END AS dialysis_active\n    , CASE\n        WHEN itemid = 225441 THEN 'IHD'\n        WHEN itemid = 225802 THEN 'CRRT'  -- CVVH (Continuous venovenous hemofiltration)\n        WHEN itemid = 225803 THEN 'CVVHD' -- CVVHD (Continuous venovenous hemodialysis)\n        WHEN itemid = 225805 THEN 'Peritoneal'\n        WHEN itemid = 225809 THEN 'CVVHDF' -- CVVHDF (Continuous venovenous hemodiafiltration)\n        WHEN itemid = 225955 THEN 'SCUF' -- SCUF (Slow continuous ultra filtration)\n      ELSE NULL END as dialysis_type\n  from procedureevents_mv\n  where itemid in\n  (\n      225441 -- | Hemodialysis          | 4-Procedures              | procedureevents_mv | Process\n    , 225802 -- | Dialysis - CRRT       | Dialysis                  | procedureevents_mv | Process\n    , 225803 -- | Dialysis - CVVHD      | Dialysis                  | procedureevents_mv | Process\n    , 225805 -- | Peritoneal Dialysis   | Dialysis                  | procedureevents_mv | Process\n    , 224270 -- | Dialysis Catheter     | Access Lines - Invasive   | procedureevents_mv | Process\n    , 225809 -- | Dialysis - CVVHDF     | Dialysis                  | procedureevents_mv | Process\n    , 225955 -- | Dialysis - SCUF       | Dialysis                  | procedureevents_mv | Process\n    , 225436 -- | CRRT Filter Change    | Dialysis                  | procedureevents_mv | Process\n  )\n  AND value IS NOT NULL\n)\n-- union together the charttime tables; append times from mv_ranges to guarantee they exist\n, stg0 AS\n(\n  SELECT\n    icustay_id, charttime, dialysis_present, dialysis_active, dialysis_type\n  FROM ce\n  WHERE dialysis_present = 1\n  UNION DISTINCT\n  SELECT\n    icustay_id, charttime, dialysis_present, dialysis_active, dialysis_type\n  FROM cv_ie\n  WHERE dialysis_present = 1\n  UNION DISTINCT\n  SELECT\n    icustay_id, charttime, dialysis_present, dialysis_active, dialysis_type\n  FROM oe\n  WHERE dialysis_present = 1\n  UNION DISTINCT\n  SELECT\n    icustay_id, starttime AS charttime, dialysis_present, dialysis_active, dialysis_type\n  FROM mv_ranges\n  UNION DISTINCT\n  SELECT\n    icustay_id, endtime AS charttime, dialysis_present, dialysis_active, dialysis_type\n  FROM mv_ranges\n)\nSELECT\n    stg0.icustay_id\n    , charttime\n    , COALESCE(mv.dialysis_present, stg0.dialysis_present) AS dialysis_present\n    , COALESCE(mv.dialysis_active, stg0.dialysis_active) AS dialysis_active\n    , COALESCE(mv.dialysis_type, stg0.dialysis_type) AS dialysis_type\nFROM stg0\nLEFT JOIN mv_ranges mv\n  ON stg0.icustay_id = mv.icustay_id\n  AND stg0.charttime >= mv.starttime\n  AND stg0.charttime <= mv.endtime\nWHERE stg0.icustay_id IS NOT NULL\nORDER BY 1,2",
        "tables": [
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.inputevents_cv",
            "mimiciii_clinical.inputevents_mv",
            "mimiciii_clinical.outputevents",
            "mimiciii_clinical.procedureevents_mv"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.outputevents.charttime",
                "mimiciii_clinical.outputevents.icustay_id",
                "mimiciii_clinical.outputevents.itemid",
                "mimiciii_clinical.outputevents.value",
                "mimiciii_clinical.procedureevents_mv.endtime",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.starttime",
                "mimiciii_clinical.procedureevents_mv.value"
            ],
            "charttime": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.outputevents.charttime",
                "mimiciii_clinical.outputevents.icustay_id",
                "mimiciii_clinical.outputevents.itemid",
                "mimiciii_clinical.outputevents.value",
                "mimiciii_clinical.procedureevents_mv.endtime",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.starttime",
                "mimiciii_clinical.procedureevents_mv.value"
            ],
            "dialysis_present": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.outputevents.charttime",
                "mimiciii_clinical.outputevents.icustay_id",
                "mimiciii_clinical.outputevents.itemid",
                "mimiciii_clinical.outputevents.value",
                "mimiciii_clinical.procedureevents_mv.endtime",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.starttime",
                "mimiciii_clinical.procedureevents_mv.value"
            ],
            "dialysis_active": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.outputevents.charttime",
                "mimiciii_clinical.outputevents.icustay_id",
                "mimiciii_clinical.outputevents.itemid",
                "mimiciii_clinical.outputevents.value",
                "mimiciii_clinical.procedureevents_mv.endtime",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.starttime",
                "mimiciii_clinical.procedureevents_mv.value"
            ],
            "dialysis_type": [
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.inputevents_cv.amount",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_mv.amount",
                "mimiciii_clinical.inputevents_mv.endtime",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.outputevents.charttime",
                "mimiciii_clinical.outputevents.icustay_id",
                "mimiciii_clinical.outputevents.itemid",
                "mimiciii_clinical.outputevents.value",
                "mimiciii_clinical.procedureevents_mv.endtime",
                "mimiciii_clinical.procedureevents_mv.icustay_id",
                "mimiciii_clinical.procedureevents_mv.itemid",
                "mimiciii_clinical.procedureevents_mv.starttime",
                "mimiciii_clinical.procedureevents_mv.value"
            ]
        },
        "table_name": "mimiciii_clinical.pivoted_rrt",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "stg0.icustay_id",
                "stg0.charttime",
                "(COALESCE(mv.dialysis_present, stg0.dialysis_present))",
                "(COALESCE(mv.dialysis_active, stg0.dialysis_active))",
                "(COALESCE(mv.dialysis_type, stg0.dialysis_type))"
            ],
            "Sort Key": [
                "stg0.icustay_id",
                "stg0.charttime"
            ],
            "Plans": [
                {
                    "Node Type": "Gather",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE ce",
                    "Parallel Aware": false,
                    "Output": [
                        "ce.icustay_id",
                        "ce.charttime",
                        "(CASE WHEN (ce.itemid = ANY ('{146,147,148,149,150,151,152}'::integer[])) THEN 1 WHEN ((ce.itemid = 582) AND ((ce.value)::text = ANY ('{\"CAVH Start\",\"CVVHD Start\",\"Hemodialysis st\",\"CAVH D/C\",\"CVVHD D/C\",\"Hemodialysis end\",\"Peritoneal Dial\"}'::text[]))) THEN 1 WHEN ((ce.itemid = ANY ('{229,235,241,247,253,259,265,271}'::integer[])) AND ((ce.value)::text = 'Dialysis Line'::text)) THEN 1 WHEN (ce.itemid = ANY ('{226118,227357,225725}'::integer[])) THEN 1 WHEN (ce.itemid = ANY ('{226499,224154,225810,225959,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457}'::integer[])) THEN 1 WHEN (ce.itemid = ANY ('{224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[])) THEN 1 ELSE 0 END)",
                        "(CASE WHEN ((ce.itemid = 582) AND ((ce.value)::text = ANY ('{\"CAVH Start\",\"CVVHD Start\",\"Hemodialysis st\",\"Peritoneal Dial\"}'::text[]))) THEN 1 WHEN ((ce.itemid = 582) AND ((ce.value)::text = ANY ('{\"CAVH D/C\",\"CVVHD D/C\",\"Hemodialysis end\"}'::text[]))) THEN 0 WHEN ((ce.itemid = 147) AND ((ce.value)::text = 'Yes'::text)) THEN 1 WHEN ((ce.itemid = 225965) AND ((ce.value)::text = 'In use'::text)) THEN 1 WHEN (ce.itemid = ANY ('{146,226499,224154,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224153,226457}'::integer[])) THEN 1 ELSE 0 END)",
                        "(CASE WHEN (ce.itemid = ANY ('{152,227290}'::integer[])) THEN CASE WHEN ((ce.value)::text = 'CVVH'::text) THEN 'CVVH'::text WHEN ((ce.value)::text = 'CVVHD'::text) THEN 'CVVHD'::text WHEN ((ce.value)::text = 'CVVHDF'::text) THEN 'CVVHDF'::text WHEN ((ce.value)::text = 'SCUF'::text) THEN 'SCUF'::text WHEN ((ce.value)::text = 'Peritoneal'::text) THEN 'Peritoneal'::text ELSE NULL::text END WHEN (ce.itemid = ANY ('{225810,225806,225807,225810,227639,225959,225951,225952,225961,225953,225963,225965,227638,227640}'::integer[])) THEN 'Peritoneal'::text WHEN (ce.itemid = 226499) THEN 'IHD'::text WHEN (ce.itemid = 582) THEN CASE WHEN ((ce.value)::text = ANY ('{\"CAVH Start\",\"CAVH D/C\"}'::text[])) THEN 'CAVH'::text WHEN ((ce.value)::text = ANY ('{\"CVVHD Start\",\"CVVHD D/C\"}'::text[])) THEN 'CVVHD'::text WHEN ((ce.value)::text = ANY ('{\"Hemodialysis st\",\"Hemodialysis end\"}'::text[])) THEN NULL::text ELSE NULL::text END ELSE NULL::text END)"
                    ],
                    "Workers Planned": 2,
                    "Single Copy": false,
                    "Plans": [
                        {
                            "Node Type": "Result",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ce.icustay_id",
                                "ce.charttime",
                                "CASE WHEN (ce.itemid = ANY ('{146,147,148,149,150,151,152}'::integer[])) THEN 1 WHEN ((ce.itemid = 582) AND ((ce.value)::text = ANY ('{\"CAVH Start\",\"CVVHD Start\",\"Hemodialysis st\",\"CAVH D/C\",\"CVVHD D/C\",\"Hemodialysis end\",\"Peritoneal Dial\"}'::text[]))) THEN 1 WHEN ((ce.itemid = ANY ('{229,235,241,247,253,259,265,271}'::integer[])) AND ((ce.value)::text = 'Dialysis Line'::text)) THEN 1 WHEN (ce.itemid = ANY ('{226118,227357,225725}'::integer[])) THEN 1 WHEN (ce.itemid = ANY ('{226499,224154,225810,225959,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457}'::integer[])) THEN 1 WHEN (ce.itemid = ANY ('{224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[])) THEN 1 ELSE 0 END",
                                "CASE WHEN ((ce.itemid = 582) AND ((ce.value)::text = ANY ('{\"CAVH Start\",\"CVVHD Start\",\"Hemodialysis st\",\"Peritoneal Dial\"}'::text[]))) THEN 1 WHEN ((ce.itemid = 582) AND ((ce.value)::text = ANY ('{\"CAVH D/C\",\"CVVHD D/C\",\"Hemodialysis end\"}'::text[]))) THEN 0 WHEN ((ce.itemid = 147) AND ((ce.value)::text = 'Yes'::text)) THEN 1 WHEN ((ce.itemid = 225965) AND ((ce.value)::text = 'In use'::text)) THEN 1 WHEN (ce.itemid = ANY ('{146,226499,224154,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224153,226457}'::integer[])) THEN 1 ELSE 0 END",
                                "CASE WHEN (ce.itemid = ANY ('{152,227290}'::integer[])) THEN CASE WHEN ((ce.value)::text = 'CVVH'::text) THEN 'CVVH'::text WHEN ((ce.value)::text = 'CVVHD'::text) THEN 'CVVHD'::text WHEN ((ce.value)::text = 'CVVHDF'::text) THEN 'CVVHDF'::text WHEN ((ce.value)::text = 'SCUF'::text) THEN 'SCUF'::text WHEN ((ce.value)::text = 'Peritoneal'::text) THEN 'Peritoneal'::text ELSE NULL::text END WHEN (ce.itemid = ANY ('{225810,225806,225807,225810,227639,225959,225951,225952,225961,225953,225963,225965,227638,227640}'::integer[])) THEN 'Peritoneal'::text WHEN (ce.itemid = 226499) THEN 'IHD'::text WHEN (ce.itemid = 582) THEN CASE WHEN ((ce.value)::text = ANY ('{\"CAVH Start\",\"CAVH D/C\"}'::text[])) THEN 'CAVH'::text WHEN ((ce.value)::text = ANY ('{\"CVVHD Start\",\"CVVHD D/C\"}'::text[])) THEN 'CVVHD'::text WHEN ((ce.value)::text = ANY ('{\"Hemodialysis st\",\"Hemodialysis end\"}'::text[])) THEN NULL::text ELSE NULL::text END ELSE NULL::text END"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Append",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": true,
                                            "Relation Name": "chartevents_19",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce",
                                            "Output": [
                                                "ce.icustay_id",
                                                "ce.charttime",
                                                "ce.itemid",
                                                "ce.value"
                                            ],
                                            "Recheck Cond": "(ce.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))",
                                            "Filter": "((ce.value IS NOT NULL) AND (ce.icustay_id IS NOT NULL) AND (COALESCE(ce.error, 0) = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_19_idx01",
                                                    "Index Cond": "(ce.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": true,
                                            "Relation Name": "chartevents_33",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_1",
                                            "Output": [
                                                "ce_1.icustay_id",
                                                "ce_1.charttime",
                                                "ce_1.itemid",
                                                "ce_1.value"
                                            ],
                                            "Recheck Cond": "(ce_1.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))",
                                            "Filter": "((ce_1.value IS NOT NULL) AND (ce_1.icustay_id IS NOT NULL) AND (COALESCE(ce_1.error, 0) = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_33_idx01",
                                                    "Index Cond": "(ce_1.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": true,
                                            "Relation Name": "chartevents_34",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_2",
                                            "Output": [
                                                "ce_2.icustay_id",
                                                "ce_2.charttime",
                                                "ce_2.itemid",
                                                "ce_2.value"
                                            ],
                                            "Recheck Cond": "(ce_2.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))",
                                            "Filter": "((ce_2.value IS NOT NULL) AND (ce_2.icustay_id IS NOT NULL) AND (COALESCE(ce_2.error, 0) = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_34_idx01",
                                                    "Index Cond": "(ce_2.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": true,
                                            "Relation Name": "chartevents_55",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_3",
                                            "Output": [
                                                "ce_3.icustay_id",
                                                "ce_3.charttime",
                                                "ce_3.itemid",
                                                "ce_3.value"
                                            ],
                                            "Recheck Cond": "(ce_3.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))",
                                            "Filter": "((ce_3.value IS NOT NULL) AND (ce_3.icustay_id IS NOT NULL) AND (COALESCE(ce_3.error, 0) = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_55_idx01",
                                                    "Index Cond": "(ce_3.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": true,
                                            "Relation Name": "chartevents_189",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_4",
                                            "Output": [
                                                "ce_4.icustay_id",
                                                "ce_4.charttime",
                                                "ce_4.itemid",
                                                "ce_4.value"
                                            ],
                                            "Recheck Cond": "(ce_4.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))",
                                            "Filter": "((ce_4.value IS NOT NULL) AND (ce_4.icustay_id IS NOT NULL) AND (COALESCE(ce_4.error, 0) = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_189_idx01",
                                                    "Index Cond": "(ce_4.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": true,
                                            "Relation Name": "chartevents_190",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_5",
                                            "Output": [
                                                "ce_5.icustay_id",
                                                "ce_5.charttime",
                                                "ce_5.itemid",
                                                "ce_5.value"
                                            ],
                                            "Recheck Cond": "(ce_5.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))",
                                            "Filter": "((ce_5.value IS NOT NULL) AND (ce_5.icustay_id IS NOT NULL) AND (COALESCE(ce_5.error, 0) = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_190_idx01",
                                                    "Index Cond": "(ce_5.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": true,
                                            "Relation Name": "chartevents_198",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_6",
                                            "Output": [
                                                "ce_6.icustay_id",
                                                "ce_6.charttime",
                                                "ce_6.itemid",
                                                "ce_6.value"
                                            ],
                                            "Recheck Cond": "(ce_6.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))",
                                            "Filter": "((ce_6.value IS NOT NULL) AND (ce_6.icustay_id IS NOT NULL) AND (COALESCE(ce_6.error, 0) = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_198_idx01",
                                                    "Index Cond": "(ce_6.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": true,
                                            "Relation Name": "chartevents_199",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_7",
                                            "Output": [
                                                "ce_7.icustay_id",
                                                "ce_7.charttime",
                                                "ce_7.itemid",
                                                "ce_7.value"
                                            ],
                                            "Recheck Cond": "(ce_7.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))",
                                            "Filter": "((ce_7.value IS NOT NULL) AND (ce_7.icustay_id IS NOT NULL) AND (COALESCE(ce_7.error, 0) = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_199_idx01",
                                                    "Index Cond": "(ce_7.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": true,
                                            "Relation Name": "chartevents_200",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_8",
                                            "Output": [
                                                "ce_8.icustay_id",
                                                "ce_8.charttime",
                                                "ce_8.itemid",
                                                "ce_8.value"
                                            ],
                                            "Recheck Cond": "(ce_8.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))",
                                            "Filter": "((ce_8.value IS NOT NULL) AND (ce_8.icustay_id IS NOT NULL) AND (COALESCE(ce_8.error, 0) = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_200_idx01",
                                                    "Index Cond": "(ce_8.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": true,
                                            "Relation Name": "chartevents_202",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_9",
                                            "Output": [
                                                "ce_9.icustay_id",
                                                "ce_9.charttime",
                                                "ce_9.itemid",
                                                "ce_9.value"
                                            ],
                                            "Recheck Cond": "(ce_9.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))",
                                            "Filter": "((ce_9.value IS NOT NULL) AND (ce_9.icustay_id IS NOT NULL) AND (COALESCE(ce_9.error, 0) = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_202_idx01",
                                                    "Index Cond": "(ce_9.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": true,
                                            "Relation Name": "chartevents_203",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_10",
                                            "Output": [
                                                "ce_10.icustay_id",
                                                "ce_10.charttime",
                                                "ce_10.itemid",
                                                "ce_10.value"
                                            ],
                                            "Recheck Cond": "(ce_10.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))",
                                            "Filter": "((ce_10.value IS NOT NULL) AND (ce_10.icustay_id IS NOT NULL) AND (COALESCE(ce_10.error, 0) = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_203_idx01",
                                                    "Index Cond": "(ce_10.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": true,
                                            "Relation Name": "chartevents_207",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ce_11",
                                            "Output": [
                                                "ce_11.icustay_id",
                                                "ce_11.charttime",
                                                "ce_11.itemid",
                                                "ce_11.value"
                                            ],
                                            "Recheck Cond": "(ce_11.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))",
                                            "Filter": "((ce_11.value IS NOT NULL) AND (ce_11.icustay_id IS NOT NULL) AND (COALESCE(ce_11.error, 0) = 0))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "chartevents_207_idx01",
                                                    "Index Cond": "(ce_11.itemid = ANY ('{152,146,147,148,149,150,151,582,229,235,241,247,253,259,265,271,226118,227357,225725,226499,224154,225810,227639,225183,227438,224191,225806,225807,228004,228005,228006,224144,224145,224149,224150,224151,224152,224153,224404,224406,226457,225959,224135,224139,224146,225323,225740,225776,225951,225952,225953,225954,225956,225958,225961,225963,225965,225976,225977,227124,227290,227638,227640,227753}'::integer[]))"
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Bitmap Heap Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cv_ie",
                    "Parallel Aware": false,
                    "Relation Name": "inputevents_cv",
                    "Schema": "mimiciii_clinical",
                    "Alias": "inputevents_cv",
                    "Output": [
                        "inputevents_cv.icustay_id",
                        "inputevents_cv.charttime",
                        "1",
                        "CASE WHEN (inputevents_cv.itemid <> 44954) THEN 1 ELSE 0 END",
                        "CASE WHEN (inputevents_cv.itemid = ANY ('{40788,41063,41307,43829,44698,46720}'::integer[])) THEN 'Peritoneal'::text WHEN (inputevents_cv.itemid = ANY ('{45352,45353}'::integer[])) THEN 'CVVH'::text WHEN (inputevents_cv.itemid = ANY ('{45268,46769,46773}'::integer[])) THEN 'CVVHD'::text WHEN (inputevents_cv.itemid = ANY ('{46012,46013,46172,46173}'::integer[])) THEN 'CVVHDF'::text ELSE NULL::text END"
                    ],
                    "Recheck Cond": "(inputevents_cv.itemid = ANY ('{40788,40907,41063,41147,41307,41460,41620,41711,41791,41792,42562,43829,44037,44188,44526,44527,44584,44591,44698,44927,44954,45157,45268,45352,45353,46012,46013,46172,46173,46250,46262,46292,46293,46311,46389,46574,46681,46720,46769,46773}'::integer[]))",
                    "Filter": "(inputevents_cv.amount > '0'::double precision)",
                    "Plans": [
                        {
                            "Node Type": "Bitmap Index Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Index Name": "inputevents_cv_idx05",
                            "Index Cond": "(inputevents_cv.itemid = ANY ('{40788,40907,41063,41147,41307,41460,41620,41711,41791,41792,42562,43829,44037,44188,44526,44527,44584,44591,44698,44927,44954,45157,45268,45352,45353,46012,46013,46172,46173,46250,46262,46292,46293,46311,46389,46574,46681,46720,46769,46773}'::integer[]))"
                        }
                    ]
                },
                {
                    "Node Type": "Index Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE oe",
                    "Parallel Aware": false,
                    "Scan Direction": "Forward",
                    "Index Name": "outputevents_idx02",
                    "Relation Name": "outputevents",
                    "Schema": "mimiciii_clinical",
                    "Alias": "outputevents",
                    "Output": [
                        "outputevents.icustay_id",
                        "outputevents.charttime",
                        "1",
                        "CASE WHEN (outputevents.itemid <> 41897) THEN 1 ELSE 0 END",
                        "CASE WHEN (outputevents.itemid = ANY ('{40789,40910,41069,44843,46394}'::integer[])) THEN 'Peritoneal'::text ELSE NULL::text END"
                    ],
                    "Index Cond": "(outputevents.itemid = ANY ('{40386,40425,40426,40507,40613,40624,40690,40745,40789,40881,40910,41016,41034,41069,41112,41250,41374,41417,41500,41527,41623,41635,41713,41750,41829,41842,41897,42289,42388,42464,42524,42536,42868,42928,42972,43016,43052,43098,43115,43687,43941,44027,44085,44193,44199,44216,44286,44567,44843,44845,44857,44901,44943,45479,45828,46230,46232,46394,46464,46712,46713,46715,46741}'::integer[]))",
                    "Filter": "(outputevents.value > '0'::double precision)"
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE mv_ranges",
                    "Parallel Aware": false,
                    "Output": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.starttime",
                        "inputevents_mv.endtime",
                        "(1)",
                        "(1)",
                        "('CRRT'::text)"
                    ],
                    "Group Key": [
                        "inputevents_mv.icustay_id",
                        "inputevents_mv.starttime",
                        "inputevents_mv.endtime",
                        "(1)",
                        "(1)",
                        "('CRRT'::text)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Append",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Plans": [
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "inputevents_mv",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "inputevents_mv",
                                    "Output": [
                                        "inputevents_mv.icustay_id",
                                        "inputevents_mv.starttime",
                                        "inputevents_mv.endtime",
                                        "1",
                                        "1",
                                        "'CRRT'::text"
                                    ],
                                    "Recheck Cond": "(inputevents_mv.itemid = ANY ('{227536,227525}'::integer[]))",
                                    "Filter": "(inputevents_mv.amount > '0'::double precision)",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "inputevents_mv_idx05",
                                            "Index Cond": "(inputevents_mv.itemid = ANY ('{227536,227525}'::integer[]))"
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Bitmap Heap Scan",
                                    "Parent Relationship": "Member",
                                    "Parallel Aware": false,
                                    "Relation Name": "procedureevents_mv",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "procedureevents_mv",
                                    "Output": [
                                        "procedureevents_mv.icustay_id",
                                        "procedureevents_mv.starttime",
                                        "procedureevents_mv.endtime",
                                        "1",
                                        "CASE WHEN (procedureevents_mv.itemid <> ALL ('{224270,225436}'::integer[])) THEN 1 ELSE 0 END",
                                        "CASE WHEN (procedureevents_mv.itemid = 225441) THEN 'IHD'::text WHEN (procedureevents_mv.itemid = 225802) THEN 'CRRT'::text WHEN (procedureevents_mv.itemid = 225803) THEN 'CVVHD'::text WHEN (procedureevents_mv.itemid = 225805) THEN 'Peritoneal'::text WHEN (procedureevents_mv.itemid = 225809) THEN 'CVVHDF'::text WHEN (procedureevents_mv.itemid = 225955) THEN 'SCUF'::text ELSE NULL::text END"
                                    ],
                                    "Recheck Cond": "(procedureevents_mv.itemid = ANY ('{225441,225802,225803,225805,224270,225809,225955,225436}'::integer[]))",
                                    "Filter": "(procedureevents_mv.value IS NOT NULL)",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Index Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Index Name": "procedureevents_mv_idx05",
                                            "Index Cond": "(procedureevents_mv.itemid = ANY ('{225441,225802,225803,225805,224270,225809,225955,225436}'::integer[]))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Unique",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE stg0",
                    "Parallel Aware": false,
                    "Output": [
                        "ce_12.icustay_id",
                        "ce_12.charttime",
                        "ce_12.dialysis_present",
                        "ce_12.dialysis_active",
                        "ce_12.dialysis_type"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ce_12.icustay_id",
                                "ce_12.charttime",
                                "ce_12.dialysis_present",
                                "ce_12.dialysis_active",
                                "ce_12.dialysis_type"
                            ],
                            "Sort Key": [
                                "ce_12.icustay_id",
                                "ce_12.charttime",
                                "ce_12.dialysis_present",
                                "ce_12.dialysis_active",
                                "ce_12.dialysis_type"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Append",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "CTE Name": "ce",
                                            "Alias": "ce_12",
                                            "Output": [
                                                "ce_12.icustay_id",
                                                "ce_12.charttime",
                                                "ce_12.dialysis_present",
                                                "ce_12.dialysis_active",
                                                "ce_12.dialysis_type"
                                            ],
                                            "Filter": "(ce_12.dialysis_present = 1)"
                                        },
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "CTE Name": "cv_ie",
                                            "Alias": "cv_ie",
                                            "Output": [
                                                "cv_ie.icustay_id",
                                                "cv_ie.charttime",
                                                "cv_ie.dialysis_present",
                                                "cv_ie.dialysis_active",
                                                "cv_ie.dialysis_type"
                                            ],
                                            "Filter": "(cv_ie.dialysis_present = 1)"
                                        },
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "CTE Name": "oe",
                                            "Alias": "oe",
                                            "Output": [
                                                "oe.icustay_id",
                                                "oe.charttime",
                                                "oe.dialysis_present",
                                                "oe.dialysis_active",
                                                "oe.dialysis_type"
                                            ],
                                            "Filter": "(oe.dialysis_present = 1)"
                                        },
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "CTE Name": "mv_ranges",
                                            "Alias": "mv_ranges",
                                            "Output": [
                                                "mv_ranges.icustay_id",
                                                "mv_ranges.starttime",
                                                "mv_ranges.dialysis_present",
                                                "mv_ranges.dialysis_active",
                                                "mv_ranges.dialysis_type"
                                            ]
                                        },
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Member",
                                            "Parallel Aware": false,
                                            "CTE Name": "mv_ranges",
                                            "Alias": "mv_ranges_1",
                                            "Output": [
                                                "mv_ranges_1.icustay_id",
                                                "mv_ranges_1.endtime",
                                                "mv_ranges_1.dialysis_present",
                                                "mv_ranges_1.dialysis_active",
                                                "mv_ranges_1.dialysis_type"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "stg0.icustay_id",
                        "stg0.charttime",
                        "COALESCE(mv.dialysis_present, stg0.dialysis_present)",
                        "COALESCE(mv.dialysis_active, stg0.dialysis_active)",
                        "COALESCE(mv.dialysis_type, stg0.dialysis_type)"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "(stg0.icustay_id = mv.icustay_id)",
                    "Join Filter": "((stg0.charttime >= mv.starttime) AND (stg0.charttime <= mv.endtime))",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "stg0.icustay_id",
                                "stg0.charttime",
                                "stg0.dialysis_present",
                                "stg0.dialysis_active",
                                "stg0.dialysis_type"
                            ],
                            "Sort Key": [
                                "stg0.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "stg0",
                                    "Alias": "stg0",
                                    "Output": [
                                        "stg0.icustay_id",
                                        "stg0.charttime",
                                        "stg0.dialysis_present",
                                        "stg0.dialysis_active",
                                        "stg0.dialysis_type"
                                    ],
                                    "Filter": "(stg0.icustay_id IS NOT NULL)"
                                }
                            ]
                        },
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "mv.dialysis_present",
                                "mv.dialysis_active",
                                "mv.dialysis_type",
                                "mv.icustay_id",
                                "mv.starttime",
                                "mv.endtime"
                            ],
                            "Sort Key": [
                                "mv.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "mv_ranges",
                                    "Alias": "mv",
                                    "Output": [
                                        "mv.dialysis_present",
                                        "mv.dialysis_active",
                                        "mv.dialysis_type",
                                        "mv.icustay_id",
                                        "mv.starttime",
                                        "mv.endtime"
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.pivoted_uo": {
        "sql": "select\n  icustay_id\n  , charttime\n  , sum(urineoutput) as urineoutput\nfrom\n(\n  select\n  -- patient identifiers\n    oe.icustay_id\n  , oe.charttime \n  -- volumes associated with urine output ITEMIDs\n  -- note we consider input of GU irrigant as a negative volume\n  , case\n      when oe.itemid = 227488 and oe.value > 0 then -1*oe.value\n      else oe.value\n    end as urineoutput\n  from outputevents oe\n-- exclude rows marked as error\nwhere (oe.iserror IS NULL OR oe.iserror != 1)\n  and itemid in\n  (\n  -- these are the most frequently occurring urine output observations in CareVue\n  40055, -- \"Urine Out Foley\"\n  43175, -- \"Urine .\"\n  40069, -- \"Urine Out Void\"\n  40094, -- \"Urine Out Condom Cath\"\n  40715, -- \"Urine Out Suprapubic\"\n  40473, -- \"Urine Out IleoConduit\"\n  40085, -- \"Urine Out Incontinent\"\n  40057, -- \"Urine Out Rt Nephrostomy\"\n  40056, -- \"Urine Out Lt Nephrostomy\"\n  40405, -- \"Urine Out Other\"\n  40428, -- \"Urine Out Straight Cath\"\n  40086,--\tUrine Out Incontinent\n  40096, -- \"Urine Out Ureteral Stent #1\"\n  40651, -- \"Urine Out Ureteral Stent #2\"\n\n  -- these are the most frequently occurring urine output observations in CareVue\n  226559, -- \"Foley\"\n  226560, -- \"Void\"\n  226561, -- \"Condom Cath\"\n  226584, -- \"Ileoconduit\"\n  226563, -- \"Suprapubic\"\n  226564, -- \"R Nephrostomy\"\n  226565, -- \"L Nephrostomy\"\n  226567, --\tStraight Cath\n  226557, -- R Ureteral Stent\n  226558, -- L Ureteral Stent\n  227488, -- GU Irrigant Volume In\n  227489  -- GU Irrigant/Urine Volume Out\n  )\n) as foo\ngroup by icustay_id, charttime\norder by icustay_id, charttime",
        "tables": [
            "mimiciii_clinical.outputevents"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.outputevents.charttime",
                "mimiciii_clinical.outputevents.icustay_id",
                "mimiciii_clinical.outputevents.iserror",
                "mimiciii_clinical.outputevents.itemid"
            ],
            "charttime": [
                "mimiciii_clinical.outputevents.charttime",
                "mimiciii_clinical.outputevents.icustay_id",
                "mimiciii_clinical.outputevents.iserror",
                "mimiciii_clinical.outputevents.itemid"
            ],
            "urineoutput": [
                "mimiciii_clinical.outputevents.charttime",
                "mimiciii_clinical.outputevents.icustay_id",
                "mimiciii_clinical.outputevents.iserror",
                "mimiciii_clinical.outputevents.itemid",
                "mimiciii_clinical.outputevents.value"
            ]
        },
        "table_name": "mimiciii_clinical.pivoted_uo",
        "plan": {
            "Node Type": "Aggregate",
            "Strategy": "Sorted",
            "Partial Mode": "Finalize",
            "Parallel Aware": false,
            "Output": [
                "oe.icustay_id",
                "oe.charttime",
                "sum(CASE WHEN ((oe.itemid = 227488) AND (oe.value > '0'::double precision)) THEN ('-1'::double precision * oe.value) ELSE oe.value END)"
            ],
            "Group Key": [
                "oe.icustay_id",
                "oe.charttime"
            ],
            "Plans": [
                {
                    "Node Type": "Gather Merge",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "oe.icustay_id",
                        "oe.charttime",
                        "(PARTIAL sum(CASE WHEN ((oe.itemid = 227488) AND (oe.value > '0'::double precision)) THEN ('-1'::double precision * oe.value) ELSE oe.value END))"
                    ],
                    "Workers Planned": 2,
                    "Plans": [
                        {
                            "Node Type": "Aggregate",
                            "Strategy": "Sorted",
                            "Partial Mode": "Partial",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "oe.icustay_id",
                                "oe.charttime",
                                "PARTIAL sum(CASE WHEN ((oe.itemid = 227488) AND (oe.value > '0'::double precision)) THEN ('-1'::double precision * oe.value) ELSE oe.value END)"
                            ],
                            "Group Key": [
                                "oe.icustay_id",
                                "oe.charttime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "oe.icustay_id",
                                        "oe.charttime",
                                        "oe.itemid",
                                        "oe.value"
                                    ],
                                    "Sort Key": [
                                        "oe.icustay_id",
                                        "oe.charttime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": true,
                                            "Relation Name": "outputevents",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "oe",
                                            "Output": [
                                                "oe.icustay_id",
                                                "oe.charttime",
                                                "oe.itemid",
                                                "oe.value"
                                            ],
                                            "Filter": "(((oe.iserror IS NULL) OR (oe.iserror <> 1)) AND (oe.itemid = ANY ('{40055,43175,40069,40094,40715,40473,40085,40057,40056,40405,40428,40086,40096,40651,226559,226560,226561,226584,226563,226564,226565,226567,226557,226558,227488,227489}'::integer[])))"
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.angus": {
        "sql": "-- ICD-9 codes for Angus criteria of sepsis\n\n-- Angus et al, 2001. Epidemiology of severe sepsis in the United States\n-- http://www.ncbi.nlm.nih.gov/pubmed/11445675\n\n-- Case selection and definitions\n-- To identify cases with severe sepsis, we selected all acute care\n-- hospitalizations with ICD-9-CM codes for both:\n-- (a) a bacterial or fungal infectious process AND\n-- (b) a diagnosis of acute organ dysfunction (Appendix 2).\n\n-- ICD-9 codes for infection - as sourced from Appendix 1 of above paper\n \n\nWITH infection_group AS\n(\n\tSELECT subject_id, hadm_id,\n\tCASE\n\t\tWHEN SUBSTR(icd9_code,1,3) IN ('001','002','003','004','005','008',\n\t\t\t   '009','010','011','012','013','014','015','016','017','018',\n\t\t\t   '020','021','022','023','024','025','026','027','030','031',\n\t\t\t   '032','033','034','035','036','037','038','039','040','041',\n\t\t\t   '090','091','092','093','094','095','096','097','098','100',\n\t\t\t   '101','102','103','104','110','111','112','114','115','116',\n\t\t\t   '117','118','320','322','324','325','420','421','451','461',\n\t\t\t   '462','463','464','465','481','482','485','486','494','510',\n\t\t\t   '513','540','541','542','566','567','590','597','601','614',\n\t\t\t   '615','616','681','682','683','686','730') THEN 1\n\t\tWHEN SUBSTR(icd9_code,1,4) IN ('5695','5720','5721','5750','5990','7110',\n\t\t\t\t'7907','9966','9985','9993') THEN 1\n\t\tWHEN SUBSTR(icd9_code,1,5) IN ('49121','56201','56203','56211','56213',\n\t\t\t\t'56983') THEN 1\n\t\tELSE 0 END AS infection\n\tfrom diagnoses_icd\n),\n-- ICD-9 codes for organ dysfunction - as sourced from Appendix 2 of above paper\norgan_diag_group as\n(\n\tSELECT subject_id, hadm_id,\n\t\tCASE\n\t\t-- Acute Organ Dysfunction Diagnosis Codes\n\t\tWHEN SUBSTR(icd9_code,1,3) IN ('458','293','570','584') THEN 1\n\t\tWHEN SUBSTR(icd9_code,1,4) IN ('7855','3483','3481',\n\t\t\t\t'2874','2875','2869','2866','5734')  THEN 1\n\t\tELSE 0 END AS organ_dysfunction,\n\t\t-- Explicit diagnosis of severe sepsis or septic shock\n\t\tCASE\n\t\tWHEN SUBSTR(icd9_code,1,5) IN ('99592','78552')  THEN 1\n\t\tELSE 0 END AS explicit_sepsis\n\tfrom diagnoses_icd\n),\n-- Mechanical ventilation\norgan_proc_group as\n(\n\tSELECT subject_id, hadm_id,\n\t\tCASE\n\t\tWHEN icd9_code IN ('9670', '9671', '9672') THEN 1\n\t\tELSE 0 END AS mech_vent\n\tFROM procedures_icd\n),\n-- Aggregate above views together\naggregate as\n(\n\tSELECT subject_id, hadm_id,\n\t\tCASE\n\t\t\tWHEN hadm_id in\n\t\t\t\t\t(SELECT DISTINCT hadm_id\n\t\t\t\t\tFROM infection_group\n\t\t\t\t\tWHERE infection = 1)\n\t\t\t\tTHEN 1\n\t\t\tELSE 0 END AS infection,\n\t\tCASE\n\t\t\tWHEN hadm_id in\n\t\t\t\t\t(SELECT DISTINCT hadm_id\n\t\t\t\t\tFROM organ_diag_group\n\t\t\t\t\tWHERE explicit_sepsis = 1)\n\t\t\t\tTHEN 1\n\t\t\tELSE 0 END AS explicit_sepsis,\n\t\tCASE\n\t\t\tWHEN hadm_id in\n\t\t\t\t\t(SELECT DISTINCT hadm_id\n\t\t\t\t\tFROM organ_diag_group\n\t\t\t\t\tWHERE organ_dysfunction = 1)\n\t\t\t\tTHEN 1\n\t\t\tELSE 0 END AS organ_dysfunction,\n\t\tCASE\n\t\tWHEN hadm_id in\n\t\t\t\t(SELECT DISTINCT hadm_id\n\t\t\t\tFROM organ_proc_group\n\t\t\t\tWHERE mech_vent = 1)\n\t\t\tTHEN 1\n\t\tELSE 0 END AS mech_vent\n\tFROM admissions\n)\n-- Output component flags (explicit sepsis, organ dysfunction) and final flag (angus)\nSELECT subject_id, hadm_id, infection,\n   explicit_sepsis, organ_dysfunction, mech_vent,\nCASE\n\tWHEN explicit_sepsis = 1 THEN 1\n\tWHEN infection = 1 AND organ_dysfunction = 1 THEN 1\n\tWHEN infection = 1 AND mech_vent = 1 THEN 1\n\tELSE 0 END\nAS angus\nFROM aggregate",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.diagnoses_icd",
            "mimiciii_clinical.procedures_icd"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.procedures_icd.icd9_code"
            ],
            "hadm_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.procedures_icd.icd9_code"
            ],
            "infection": [
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.procedures_icd.icd9_code"
            ],
            "explicit_sepsis": [
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.procedures_icd.icd9_code"
            ],
            "organ_dysfunction": [
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.procedures_icd.icd9_code"
            ],
            "mech_vent": [
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.procedures_icd.icd9_code"
            ],
            "angus": [
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.procedures_icd.icd9_code"
            ]
        },
        "table_name": "mimiciii_clinical.angus",
        "plan": {
            "Node Type": "CTE Scan",
            "Parallel Aware": false,
            "CTE Name": "aggregate",
            "Alias": "aggregate",
            "Output": [
                "aggregate.subject_id",
                "aggregate.hadm_id",
                "aggregate.infection",
                "aggregate.explicit_sepsis",
                "aggregate.organ_dysfunction",
                "aggregate.mech_vent",
                "CASE WHEN (aggregate.explicit_sepsis = 1) THEN 1 WHEN ((aggregate.infection = 1) AND (aggregate.organ_dysfunction = 1)) THEN 1 WHEN ((aggregate.infection = 1) AND (aggregate.mech_vent = 1)) THEN 1 ELSE 0 END"
            ],
            "Plans": [
                {
                    "Node Type": "Seq Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE infection_group",
                    "Parallel Aware": false,
                    "Relation Name": "diagnoses_icd",
                    "Schema": "mimiciii_clinical",
                    "Alias": "diagnoses_icd",
                    "Output": [
                        "diagnoses_icd.subject_id",
                        "diagnoses_icd.hadm_id",
                        "CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 3) = ANY ('{001,002,003,004,005,008,009,010,011,012,013,014,015,016,017,018,020,021,022,023,024,025,026,027,030,031,032,033,034,035,036,037,038,039,040,041,090,091,092,093,094,095,096,097,098,100,101,102,103,104,110,111,112,114,115,116,117,118,320,322,324,325,420,421,451,461,462,463,464,465,481,482,485,486,494,510,513,540,541,542,566,567,590,597,601,614,615,616,681,682,683,686,730}'::text[])) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = ANY ('{5695,5720,5721,5750,5990,7110,7907,9966,9985,9993}'::text[])) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 5) = ANY ('{49121,56201,56203,56211,56213,56983}'::text[])) THEN 1 ELSE 0 END"
                    ]
                },
                {
                    "Node Type": "Seq Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE organ_diag_group",
                    "Parallel Aware": false,
                    "Relation Name": "diagnoses_icd",
                    "Schema": "mimiciii_clinical",
                    "Alias": "diagnoses_icd_1",
                    "Output": [
                        "diagnoses_icd_1.subject_id",
                        "diagnoses_icd_1.hadm_id",
                        "CASE WHEN (substr((diagnoses_icd_1.icd9_code)::text, 1, 3) = ANY ('{458,293,570,584}'::text[])) THEN 1 WHEN (substr((diagnoses_icd_1.icd9_code)::text, 1, 4) = ANY ('{7855,3483,3481,2874,2875,2869,2866,5734}'::text[])) THEN 1 ELSE 0 END",
                        "CASE WHEN (substr((diagnoses_icd_1.icd9_code)::text, 1, 5) = ANY ('{99592,78552}'::text[])) THEN 1 ELSE 0 END"
                    ]
                },
                {
                    "Node Type": "Seq Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE organ_proc_group",
                    "Parallel Aware": false,
                    "Relation Name": "procedures_icd",
                    "Schema": "mimiciii_clinical",
                    "Alias": "procedures_icd",
                    "Output": [
                        "procedures_icd.subject_id",
                        "procedures_icd.hadm_id",
                        "CASE WHEN ((procedures_icd.icd9_code)::text = ANY ('{9670,9671,9672}'::text[])) THEN 1 ELSE 0 END"
                    ]
                },
                {
                    "Node Type": "Seq Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE aggregate",
                    "Parallel Aware": false,
                    "Relation Name": "admissions",
                    "Schema": "mimiciii_clinical",
                    "Alias": "admissions",
                    "Output": [
                        "admissions.subject_id",
                        "admissions.hadm_id",
                        "CASE WHEN (hashed SubPlan 4) THEN 1 ELSE 0 END",
                        "CASE WHEN (hashed SubPlan 5) THEN 1 ELSE 0 END",
                        "CASE WHEN (hashed SubPlan 6) THEN 1 ELSE 0 END",
                        "CASE WHEN (hashed SubPlan 7) THEN 1 ELSE 0 END"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Aggregate",
                            "Strategy": "Hashed",
                            "Partial Mode": "Simple",
                            "Parent Relationship": "SubPlan",
                            "Subplan Name": "SubPlan 4",
                            "Parallel Aware": false,
                            "Output": [
                                "infection_group.hadm_id"
                            ],
                            "Group Key": [
                                "infection_group.hadm_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "infection_group",
                                    "Alias": "infection_group",
                                    "Output": [
                                        "infection_group.subject_id",
                                        "infection_group.hadm_id",
                                        "infection_group.infection"
                                    ],
                                    "Filter": "(infection_group.infection = 1)"
                                }
                            ]
                        },
                        {
                            "Node Type": "Aggregate",
                            "Strategy": "Hashed",
                            "Partial Mode": "Simple",
                            "Parent Relationship": "SubPlan",
                            "Subplan Name": "SubPlan 5",
                            "Parallel Aware": false,
                            "Output": [
                                "organ_diag_group.hadm_id"
                            ],
                            "Group Key": [
                                "organ_diag_group.hadm_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "organ_diag_group",
                                    "Alias": "organ_diag_group",
                                    "Output": [
                                        "organ_diag_group.subject_id",
                                        "organ_diag_group.hadm_id",
                                        "organ_diag_group.organ_dysfunction",
                                        "organ_diag_group.explicit_sepsis"
                                    ],
                                    "Filter": "(organ_diag_group.explicit_sepsis = 1)"
                                }
                            ]
                        },
                        {
                            "Node Type": "Aggregate",
                            "Strategy": "Hashed",
                            "Partial Mode": "Simple",
                            "Parent Relationship": "SubPlan",
                            "Subplan Name": "SubPlan 6",
                            "Parallel Aware": false,
                            "Output": [
                                "organ_diag_group_1.hadm_id"
                            ],
                            "Group Key": [
                                "organ_diag_group_1.hadm_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "organ_diag_group",
                                    "Alias": "organ_diag_group_1",
                                    "Output": [
                                        "organ_diag_group_1.subject_id",
                                        "organ_diag_group_1.hadm_id",
                                        "organ_diag_group_1.organ_dysfunction",
                                        "organ_diag_group_1.explicit_sepsis"
                                    ],
                                    "Filter": "(organ_diag_group_1.organ_dysfunction = 1)"
                                }
                            ]
                        },
                        {
                            "Node Type": "Aggregate",
                            "Strategy": "Hashed",
                            "Partial Mode": "Simple",
                            "Parent Relationship": "SubPlan",
                            "Subplan Name": "SubPlan 7",
                            "Parallel Aware": false,
                            "Output": [
                                "organ_proc_group.hadm_id"
                            ],
                            "Group Key": [
                                "organ_proc_group.hadm_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "organ_proc_group",
                                    "Alias": "organ_proc_group",
                                    "Output": [
                                        "organ_proc_group.subject_id",
                                        "organ_proc_group.hadm_id",
                                        "organ_proc_group.mech_vent"
                                    ],
                                    "Filter": "(organ_proc_group.mech_vent = 1)"
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.explicit": {
        "sql": "-- This code extracts explicit sepsis using ICD-9 diagnosis codes\n-- That is, the two codes 995.92 (severe sepsis) or 785.52 (septic shock)\n-- These codes are extremely specific to sepsis, but have very low sensitivity\n-- From Iwashyna et al. (vs. chart reviews): 100% PPV, 9.3% sens, 100% specificity\n \n\nWITH co_dx AS\n(\n\tSELECT hadm_id\n\t-- sepsis codes\n\t, MAX(\n    \tCASE\n    \t\tWHEN icd9_code = '99592' THEN 1\n      ELSE 0 END\n    ) AS severe_sepsis\n\t, MAX(\n    \tCASE\n    \t\tWHEN icd9_code = '78552' THEN 1\n      ELSE 0 END\n    ) AS septic_shock\n  from diagnoses_icd\n  GROUP BY hadm_id\n)\nselect\n  adm.subject_id\n  , adm.hadm_id\n\t, co_dx.severe_sepsis\n  , co_dx.septic_shock\n\t, case when co_dx.severe_sepsis = 1 or co_dx.septic_shock = 1\n\t\t\tthen 1\n\t\telse 0 end as sepsis\nFROM admissions adm\nleft join co_dx\n  on adm.hadm_id = co_dx.hadm_id\norder by adm.subject_id, adm.hadm_id",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.diagnoses_icd"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id"
            ],
            "hadm_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id"
            ],
            "severe_sepsis": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code"
            ],
            "septic_shock": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code"
            ],
            "sepsis": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code"
            ]
        },
        "table_name": "mimiciii_clinical.explicit",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "adm.subject_id",
                "adm.hadm_id",
                "co_dx.severe_sepsis",
                "co_dx.septic_shock",
                "(CASE WHEN ((co_dx.severe_sepsis = 1) OR (co_dx.septic_shock = 1)) THEN 1 ELSE 0 END)"
            ],
            "Sort Key": [
                "adm.subject_id",
                "adm.hadm_id"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE co_dx",
                    "Parallel Aware": false,
                    "Output": [
                        "diagnoses_icd.hadm_id",
                        "max(CASE WHEN ((diagnoses_icd.icd9_code)::text = '99592'::text) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((diagnoses_icd.icd9_code)::text = '78552'::text) THEN 1 ELSE 0 END)"
                    ],
                    "Group Key": [
                        "diagnoses_icd.hadm_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Seq Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "diagnoses_icd",
                            "Schema": "mimiciii_clinical",
                            "Alias": "diagnoses_icd",
                            "Output": [
                                "diagnoses_icd.row_id",
                                "diagnoses_icd.subject_id",
                                "diagnoses_icd.hadm_id",
                                "diagnoses_icd.seq_num",
                                "diagnoses_icd.icd9_code"
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Join Type": "Right",
                    "Output": [
                        "adm.subject_id",
                        "adm.hadm_id",
                        "co_dx.severe_sepsis",
                        "co_dx.septic_shock",
                        "CASE WHEN ((co_dx.severe_sepsis = 1) OR (co_dx.septic_shock = 1)) THEN 1 ELSE 0 END"
                    ],
                    "Inner Unique": true,
                    "Hash Cond": "(co_dx.hadm_id = adm.hadm_id)",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "co_dx",
                            "Alias": "co_dx",
                            "Output": [
                                "co_dx.hadm_id",
                                "co_dx.severe_sepsis",
                                "co_dx.septic_shock"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "adm.subject_id",
                                "adm.hadm_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "admissions",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "adm",
                                    "Output": [
                                        "adm.subject_id",
                                        "adm.hadm_id"
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.martin": {
        "sql": "-- ICD-9 codes for sepsis as validated by Martin et al.\n\n-- Greg S. Martin, David M. Mannino, Stephanie Eaton, and Marc Moss. The epidemiology of\n-- sepsis in the united states from 1979 through 2000. N Engl J Med, 348(16):1546\u20131554, Apr\n-- 2003. doi: 10.1056/NEJMoa022139. URL http://dx.doi.org/10.1056/NEJMoa022139.\n \nWITH co_dx AS\n(\n\tSELECT subject_id, hadm_id\n  , MAX(\n    \tCASE\n        -- septicemia\n    \t\tWHEN SUBSTR(icd9_code,1,3) = '038' THEN 1\n        -- septicemic, bacteremia, disseminated fungal infection, disseminated candida infection\n\t\t\t\t-- NOTE: the paper specifies 020.0 ... but this is bubonic plague\n\t\t\t\t-- presumably, they meant 020.2, which is septicemic plague\n        WHEN SUBSTR(icd9_code,1,4) in ('0202','7907','1179','1125') THEN 1\n        -- disseminated fungal endocarditis\n        WHEN SUBSTR(icd9_code,1,5) = '11281' THEN 1\n      ELSE 0 END\n    ) AS sepsis\n    , MAX(\n      CASE\n        WHEN SUBSTR(icd9_code,1,4) in ('7991') THEN 1\n        WHEN SUBSTR(icd9_code,1,5) in ('51881','51882','51885','78609') THEN 1\n      ELSE 0 END\n    ) AS respiratory\n    , MAX(\n      CASE\n        WHEN SUBSTR(icd9_code,1,4) in ('4580','7855','4580','4588','4589','7963') THEN 1\n        WHEN SUBSTR(icd9_code,1,5) in ('785.51','785.59') THEN 1\n      ELSE 0 END\n    ) AS cardiovascular\n    , MAX(\n      CASE\n        WHEN SUBSTR(icd9_code,1,3) in ('584','580','585') THEN 1\n      ELSE 0 END\n    ) AS renal\n    , MAX(\n      CASE\n        WHEN SUBSTR(icd9_code,1,3) in ('570') THEN 1\n        WHEN SUBSTR(icd9_code,1,4) in ('5722','5733') THEN 1\n      ELSE 0 END\n    ) AS hepatic\n    , MAX(\n      CASE\n        WHEN SUBSTR(icd9_code,1,4) in ('2862','2866','2869','2873','2874','2875') THEN 1\n      ELSE 0 END\n    ) AS hematologic\n    , MAX(\n      CASE\n        WHEN SUBSTR(icd9_code,1,4) in ('2762') THEN 1\n      ELSE 0 END\n    ) AS metabolic\n    , MAX(\n      CASE\n        WHEN SUBSTR(icd9_code,1,3) in ('293') THEN 1\n        WHEN SUBSTR(icd9_code,1,4) in ('3481','3483') THEN 1\n        WHEN SUBSTR(icd9_code,1,5) in ('78001','78009') THEN 1\n      ELSE 0 END\n    ) AS neurologic\n  from diagnoses_icd\n  GROUP BY subject_id, hadm_id\n)\n-- procedure codes:\n-- \"96.7 - Ventilator management\"\n-- translated:\n--    9670\tContinuous invasive mechanical ventilation of unspecified duration\n--    9671\tContinuous invasive mechanical ventilation for less than 96 consecutive hours\n--    9672\tContinuous invasive mechanical ventilation for 96 consecutive hours or more\n-- \"39.95 - Hemodialysis\"\n--    3995\tHemodialysis\n-- \"89.14 - Electroencephalography\"\n--    8914\tElectroencephalogram\n, co_proc as\n(\n  SELECT subject_id, hadm_id\n  , MAX(CASE WHEN icd9_code = '967' then 1 ELSE 0 END) as respiratory\n  , MAX(CASE WHEN icd9_code = '3995' then 1 ELSE 0 END) as renal\n  , MAX(CASE WHEN icd9_code = '8914' then 1 ELSE 0 END) as neurologic\n  FROM procedures_icd\n  GROUP BY subject_id, hadm_id\n)\nselect adm.subject_id, adm.hadm_id\n, co_dx.sepsis\n, CASE\n    WHEN co_dx.respiratory = 1 OR co_proc.respiratory = 1\n      OR co_dx.cardiovascular = 1\n      OR co_dx.renal = 1 OR co_proc.renal = 1\n      OR co_dx.hepatic = 1\n      OR co_dx.hematologic = 1\n      OR co_dx.metabolic = 1\n      OR co_dx.neurologic = 1 OR co_proc.neurologic = 1\n    THEN 1\n  ELSE 0 END as organ_failure\n, case when co_dx.respiratory = 1 or co_proc.respiratory = 1 then 1 else 0 end as respiratory\n, co_dx.cardiovascular\n, case when co_dx.renal = 1 or co_proc.renal = 1 then 1 else 0 end as renal\n, co_dx.hepatic\n, co_dx.hematologic\n, co_dx.metabolic\n, case when co_dx.neurologic = 1 or co_proc.neurologic = 1 then 1 else 0 end as neurologic\nFROM admissions adm\nleft join co_dx\n  on adm.hadm_id = co_dx.hadm_id\nleft join co_proc\n  on adm.hadm_id = co_proc.hadm_id",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.diagnoses_icd",
            "mimiciii_clinical.procedures_icd"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.subject_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.procedures_icd.hadm_id",
                "mimiciii_clinical.procedures_icd.subject_id"
            ],
            "hadm_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.procedures_icd.hadm_id",
                "mimiciii_clinical.procedures_icd.subject_id"
            ],
            "sepsis": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.procedures_icd.hadm_id",
                "mimiciii_clinical.procedures_icd.subject_id"
            ],
            "organ_failure": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.procedures_icd.hadm_id",
                "mimiciii_clinical.procedures_icd.icd9_code",
                "mimiciii_clinical.procedures_icd.subject_id"
            ],
            "respiratory": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.procedures_icd.hadm_id",
                "mimiciii_clinical.procedures_icd.icd9_code",
                "mimiciii_clinical.procedures_icd.subject_id"
            ],
            "cardiovascular": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.procedures_icd.hadm_id",
                "mimiciii_clinical.procedures_icd.subject_id"
            ],
            "renal": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.procedures_icd.hadm_id",
                "mimiciii_clinical.procedures_icd.icd9_code",
                "mimiciii_clinical.procedures_icd.subject_id"
            ],
            "hepatic": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.procedures_icd.hadm_id",
                "mimiciii_clinical.procedures_icd.subject_id"
            ],
            "hematologic": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.procedures_icd.hadm_id",
                "mimiciii_clinical.procedures_icd.subject_id"
            ],
            "metabolic": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.procedures_icd.hadm_id",
                "mimiciii_clinical.procedures_icd.subject_id"
            ],
            "neurologic": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.diagnoses_icd.subject_id",
                "mimiciii_clinical.procedures_icd.hadm_id",
                "mimiciii_clinical.procedures_icd.icd9_code",
                "mimiciii_clinical.procedures_icd.subject_id"
            ]
        },
        "table_name": "mimiciii_clinical.martin",
        "plan": {
            "Node Type": "Hash Join",
            "Parallel Aware": false,
            "Join Type": "Right",
            "Output": [
                "adm.subject_id",
                "adm.hadm_id",
                "co_dx.sepsis",
                "CASE WHEN ((co_dx.respiratory = 1) OR (co_proc.respiratory = 1) OR (co_dx.cardiovascular = 1) OR (co_dx.renal = 1) OR (co_proc.renal = 1) OR (co_dx.hepatic = 1) OR (co_dx.hematologic = 1) OR (co_dx.metabolic = 1) OR (co_dx.neurologic = 1) OR (co_proc.neurologic = 1)) THEN 1 ELSE 0 END",
                "CASE WHEN ((co_dx.respiratory = 1) OR (co_proc.respiratory = 1)) THEN 1 ELSE 0 END",
                "co_dx.cardiovascular",
                "CASE WHEN ((co_dx.renal = 1) OR (co_proc.renal = 1)) THEN 1 ELSE 0 END",
                "co_dx.hepatic",
                "co_dx.hematologic",
                "co_dx.metabolic",
                "CASE WHEN ((co_dx.neurologic = 1) OR (co_proc.neurologic = 1)) THEN 1 ELSE 0 END"
            ],
            "Inner Unique": false,
            "Hash Cond": "(co_dx.hadm_id = adm.hadm_id)",
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Finalize",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE co_dx",
                    "Parallel Aware": false,
                    "Output": [
                        "diagnoses_icd.subject_id",
                        "diagnoses_icd.hadm_id",
                        "max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 3) = '038'::text) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = ANY ('{0202,7907,1179,1125}'::text[])) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 5) = '11281'::text) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = '7991'::text) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 5) = ANY ('{51881,51882,51885,78609}'::text[])) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = ANY ('{4580,7855,4580,4588,4589,7963}'::text[])) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 5) = ANY ('{785.51,785.59}'::text[])) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 3) = ANY ('{584,580,585}'::text[])) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 3) = '570'::text) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = ANY ('{5722,5733}'::text[])) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = ANY ('{2862,2866,2869,2873,2874,2875}'::text[])) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = '2762'::text) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 3) = '293'::text) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = ANY ('{3481,3483}'::text[])) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 5) = ANY ('{78001,78009}'::text[])) THEN 1 ELSE 0 END)"
                    ],
                    "Group Key": [
                        "diagnoses_icd.subject_id",
                        "diagnoses_icd.hadm_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Gather Merge",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "diagnoses_icd.subject_id",
                                "diagnoses_icd.hadm_id",
                                "(PARTIAL max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 3) = '038'::text) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = ANY ('{0202,7907,1179,1125}'::text[])) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 5) = '11281'::text) THEN 1 ELSE 0 END))",
                                "(PARTIAL max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = '7991'::text) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 5) = ANY ('{51881,51882,51885,78609}'::text[])) THEN 1 ELSE 0 END))",
                                "(PARTIAL max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = ANY ('{4580,7855,4580,4588,4589,7963}'::text[])) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 5) = ANY ('{785.51,785.59}'::text[])) THEN 1 ELSE 0 END))",
                                "(PARTIAL max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 3) = ANY ('{584,580,585}'::text[])) THEN 1 ELSE 0 END))",
                                "(PARTIAL max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 3) = '570'::text) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = ANY ('{5722,5733}'::text[])) THEN 1 ELSE 0 END))",
                                "(PARTIAL max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = ANY ('{2862,2866,2869,2873,2874,2875}'::text[])) THEN 1 ELSE 0 END))",
                                "(PARTIAL max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = '2762'::text) THEN 1 ELSE 0 END))",
                                "(PARTIAL max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 3) = '293'::text) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = ANY ('{3481,3483}'::text[])) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 5) = ANY ('{78001,78009}'::text[])) THEN 1 ELSE 0 END))"
                            ],
                            "Workers Planned": 2,
                            "Plans": [
                                {
                                    "Node Type": "Aggregate",
                                    "Strategy": "Sorted",
                                    "Partial Mode": "Partial",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "diagnoses_icd.subject_id",
                                        "diagnoses_icd.hadm_id",
                                        "PARTIAL max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 3) = '038'::text) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = ANY ('{0202,7907,1179,1125}'::text[])) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 5) = '11281'::text) THEN 1 ELSE 0 END)",
                                        "PARTIAL max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = '7991'::text) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 5) = ANY ('{51881,51882,51885,78609}'::text[])) THEN 1 ELSE 0 END)",
                                        "PARTIAL max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = ANY ('{4580,7855,4580,4588,4589,7963}'::text[])) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 5) = ANY ('{785.51,785.59}'::text[])) THEN 1 ELSE 0 END)",
                                        "PARTIAL max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 3) = ANY ('{584,580,585}'::text[])) THEN 1 ELSE 0 END)",
                                        "PARTIAL max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 3) = '570'::text) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = ANY ('{5722,5733}'::text[])) THEN 1 ELSE 0 END)",
                                        "PARTIAL max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = ANY ('{2862,2866,2869,2873,2874,2875}'::text[])) THEN 1 ELSE 0 END)",
                                        "PARTIAL max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = '2762'::text) THEN 1 ELSE 0 END)",
                                        "PARTIAL max(CASE WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 3) = '293'::text) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = ANY ('{3481,3483}'::text[])) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 5) = ANY ('{78001,78009}'::text[])) THEN 1 ELSE 0 END)"
                                    ],
                                    "Group Key": [
                                        "diagnoses_icd.subject_id",
                                        "diagnoses_icd.hadm_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "diagnoses_icd.subject_id",
                                                "diagnoses_icd.hadm_id",
                                                "diagnoses_icd.icd9_code"
                                            ],
                                            "Sort Key": [
                                                "diagnoses_icd.subject_id",
                                                "diagnoses_icd.hadm_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": true,
                                                    "Relation Name": "diagnoses_icd",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "diagnoses_icd",
                                                    "Output": [
                                                        "diagnoses_icd.subject_id",
                                                        "diagnoses_icd.hadm_id",
                                                        "diagnoses_icd.icd9_code"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE co_proc",
                    "Parallel Aware": false,
                    "Output": [
                        "procedures_icd.subject_id",
                        "procedures_icd.hadm_id",
                        "max(CASE WHEN ((procedures_icd.icd9_code)::text = '967'::text) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((procedures_icd.icd9_code)::text = '3995'::text) THEN 1 ELSE 0 END)",
                        "max(CASE WHEN ((procedures_icd.icd9_code)::text = '8914'::text) THEN 1 ELSE 0 END)"
                    ],
                    "Group Key": [
                        "procedures_icd.subject_id",
                        "procedures_icd.hadm_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Seq Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "procedures_icd",
                            "Schema": "mimiciii_clinical",
                            "Alias": "procedures_icd",
                            "Output": [
                                "procedures_icd.row_id",
                                "procedures_icd.subject_id",
                                "procedures_icd.hadm_id",
                                "procedures_icd.seq_num",
                                "procedures_icd.icd9_code"
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "CTE Name": "co_dx",
                    "Alias": "co_dx",
                    "Output": [
                        "co_dx.subject_id",
                        "co_dx.hadm_id",
                        "co_dx.sepsis",
                        "co_dx.respiratory",
                        "co_dx.cardiovascular",
                        "co_dx.renal",
                        "co_dx.hepatic",
                        "co_dx.hematologic",
                        "co_dx.metabolic",
                        "co_dx.neurologic"
                    ]
                },
                {
                    "Node Type": "Hash",
                    "Parent Relationship": "Inner",
                    "Parallel Aware": false,
                    "Output": [
                        "adm.subject_id",
                        "adm.hadm_id",
                        "co_proc.respiratory",
                        "co_proc.renal",
                        "co_proc.neurologic"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Right",
                            "Output": [
                                "adm.subject_id",
                                "adm.hadm_id",
                                "co_proc.respiratory",
                                "co_proc.renal",
                                "co_proc.neurologic"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "(co_proc.hadm_id = adm.hadm_id)",
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "co_proc",
                                    "Alias": "co_proc",
                                    "Output": [
                                        "co_proc.subject_id",
                                        "co_proc.hadm_id",
                                        "co_proc.respiratory",
                                        "co_proc.renal",
                                        "co_proc.neurologic"
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "adm.subject_id",
                                        "adm.hadm_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "admissions",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "adm",
                                            "Output": [
                                                "adm.subject_id",
                                                "adm.hadm_id"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.apsiii": {
        "sql": "-- ------------------------------------------------------------------\n-- Title: Acute Physiology Score III (APS III)\n-- This query extracts the acute physiology score III.\n-- This score is a measure of patient severity of illness.\n-- The score is calculated on the first day of each ICU patients' stay.\n-- ------------------------------------------------------------------\n\n-- Reference for APS III:\n--    Knaus WA, Wagner DP, Draper EA, Zimmerman JE, Bergner M, Bastos PG, Sirio CA, Murphy DJ, Lotring T, Damiano A.\n--    The APACHE III prognostic system. Risk prediction of hospital mortality for critically ill hospitalized adults.\n--    Chest Journal. 1991 Dec 1100(6):1619-36.\n\n-- Reference for the equation for calibrating APS III to hospital mortality:\n--    Johnson, A. E. W. (2015). Mortality prediction and acuity assessment in critical care.\n--    University of Oxford, Oxford, UK.\n\n-- Variables used in APS III:\n--  GCS\n--  VITALS: Heart rate, mean blood pressure, temperature, respiration rate\n--  FLAGS: ventilation/cpap, chronic dialysis\n--  IO: urine output\n--  LABS: pao2, A-aDO2, hematocrit, WBC, creatinine\n--        , blood urea nitrogen, sodium, albumin, bilirubin, glucose, pH, pCO2\n\n-- The following views are required to run this query:\n--  1) urine_output_first_day - generated by urine-output-first-day.sql\n--  2) ventilation_first_day - generated by ventilated-first-day.sql\n--  3) vitals_first_day - generated by vitals-first-day.sql\n--  4) gcs_first_day - generated by gcs-first-day.sql\n--  5) labs_first_day - generated by labs-first-day.sql\n\n-- Note:\n--  The score is calculated for *all* ICU patients, with the assumption that the user will subselect appropriate icustay_ids.\n--  For example, the score is calculated for neonates, but it is likely inappropriate to actually use the score values for these patients.\n\n-- List of TODO:\n-- The site of temperature is not incorporated. Axillary measurements should be increased by 1 degree.\n-- Unfortunately the data for metavision is not available at the moment.\n--  674 | Temp. Site\n--  224642 | Temperature Site\n\nwith pa as\n(\n  select bg.icustay_id, bg.charttime\n  , po2 as PaO2\n  , ROW_NUMBER() over (partition by bg.icustay_id ORDER BY bg.po2 DESC) as rn\n  from \"mimic\".\"mimiciii_clinical\".\"blood_gas_first_day_arterial\" bg\n  left join ventilation_durations vd\n    on bg.icustay_id = vd.icustay_id\n    and bg.charttime >= vd.starttime\n    and bg.charttime <= vd.endtime\n  WHERE vd.icustay_id is null -- patient is *not* ventilated\n  -- and fio2 < 50, or if no fio2, assume room air\n  AND coalesce(fio2, fio2_chartevents, 21) < 50\n  AND bg.po2 IS NOT NULL\n)\n, aa as\n(\n  -- join blood gas to ventilation durations to determine if patient was vent\n  -- also join to cpap table for the same purpose\n  select bg.icustay_id, bg.charttime\n  , bg.aado2\n  , ROW_NUMBER() over (partition by bg.icustay_id ORDER BY bg.aado2 DESC) as rn\n  -- row number indicating the highest AaDO2\n  from blood_gas_first_day_arterial bg\n  INNER JOIN ventilation_durations vd\n    on bg.icustay_id = vd.icustay_id\n    and bg.charttime >= vd.starttime\n    and bg.charttime <= vd.endtime\n  WHERE vd.icustay_id is not null -- patient is ventilated\n  AND coalesce(fio2, fio2_chartevents) >= 50\n  AND bg.aado2 IS NOT NULL\n)\n-- because ph/pco2 rules are an interaction *within* a blood gas, we calculate them here\n-- the worse score is then taken for the final calculation\n, acidbase as\n(\n  select bg.icustay_id\n  , ph, pco2 as paco2\n  , case\n      when ph is null or pco2 is null then null\n      when ph < 7.20 then\n        case\n          when pco2 < 50 then 12\n          else 4\n        end\n      when ph < 7.30 then\n        case\n          when pco2 < 30 then 9\n          when pco2 < 40 then 6\n          when pco2 < 50 then 3\n          else 2\n        end\n      when ph < 7.35 then\n        case\n          when pco2 < 30 then 9\n          when pco2 < 45 then 0\n          else 1\n        end\n      when ph < 7.45 then\n        case\n          when pco2 < 30 then 5\n          when pco2 < 45 then 0\n          else 1\n        end\n      when ph < 7.50 then\n        case\n          when pco2 < 30 then 5\n          when pco2 < 35 then 0\n          when pco2 < 45 then 2\n          else 12\n        end\n      when ph < 7.60 then\n        case\n          when pco2 < 40 then 3\n          else 12\n        end\n      else -- ph >= 7.60\n        case\n          when pco2 < 25 then 0\n          when pco2 < 40 then 3\n          else 12\n        end\n    end as acidbase_score\n  from blood_gas_first_day_arterial bg\n  where ph is not null and pco2 is not null\n)\n, acidbase_max as\n(\n  select icustay_id, acidbase_score, ph, paco2\n    -- create integer which indexes maximum value of score with 1\n  , ROW_NUMBER() over (partition by icustay_id ORDER BY acidbase_score DESC) as acidbase_rn\n  from acidbase\n)\n-- define acute renal failure (ARF) as:\n--  creatinine >=1.5 mg/dl\n--  and urine output <410 cc/day\n--  and no chronic dialysis\n, arf as\n(\n  select ie.icustay_id\n    , case\n        when labs.creatinine_max >= 1.5\n        and  uo.urineoutput < 410\n        -- acute renal failure is only coded if the patient is not on chronic dialysis\n        -- we use ICD-9 coding of ESRD as a proxy for chronic dialysis\n        and  icd.ckd = 0\n          then 1\n      else 0 end as arf\n  FROM icustays ie\n  left join \"mimic\".\"mimiciii_clinical\".\"urine_output_first_day\" uo\n    on ie.icustay_id = uo.icustay_id\n  left join \"mimic\".\"mimiciii_clinical\".\"labs_first_day\" labs\n    on ie.icustay_id = labs.icustay_id\n  left join\n  (\n    select hadm_id\n      , max(case\n          -- severe kidney failure requiring use of dialysis\n          when icd9_code in  ('5854','5855','5856') then 1\n          -- we do not include 5859 as that is sometimes coded for acute-on-chronic ARF\n        else 0 end)\n      as ckd\n    from diagnoses_icd\n    group by hadm_id\n  ) icd\n    on ie.hadm_id = icd.hadm_id\n)\n, cohort as\n(\nselect ie.subject_id, ie.hadm_id, ie.icustay_id\n      , ie.intime\n      , ie.outtime\n\n      , vital.heartrate_min\n      , vital.heartrate_max\n      , vital.meanbp_min\n      , vital.meanbp_max\n      , vital.tempc_min\n      , vital.tempc_max\n      , vital.resprate_min\n      , vital.resprate_max\n\n      , pa.pao2\n      , aa.aado2\n\n      , ab.ph\n      , ab.paco2\n      , ab.acidbase_score\n\n      , labs.hematocrit_min\n      , labs.hematocrit_max\n      , labs.wbc_min\n      , labs.wbc_max\n      , labs.creatinine_min\n      , labs.creatinine_max\n      , labs.bun_min\n      , labs.bun_max\n      , labs.sodium_min\n      , labs.sodium_max\n      , labs.albumin_min\n      , labs.albumin_max\n      , labs.bilirubin_min\n      , labs.bilirubin_max\n\n      , case\n          when labs.glucose_max is null and vital.glucose_max is null\n            then null\n          when labs.glucose_max is null or vital.glucose_max > labs.glucose_max\n            then vital.glucose_max\n          when vital.glucose_max is null or labs.glucose_max > vital.glucose_max\n            then labs.glucose_max\n          else labs.glucose_max -- if equal, just pick labs\n        end as glucose_max\n\n      , case\n          when labs.glucose_min is null and vital.glucose_min is null\n            then null\n          when labs.glucose_min is null or vital.glucose_min < labs.glucose_min\n            then vital.glucose_min\n          when vital.glucose_min is null or labs.glucose_min < vital.glucose_min\n            then labs.glucose_min\n          else labs.glucose_min -- if equal, just pick labs\n        end as glucose_min\n\n      -- , labs.bicarbonate_min\n      -- , labs.bicarbonate_max\n      , vent.vent\n      , uo.urineoutput\n      -- gcs and its components\n      , gcs.mingcs\n      , gcs.gcsmotor, gcs.gcsverbal,  gcs.gcseyes, gcs.endotrachflag\n      -- acute renal failure\n      , arf.arf as arf\n\nFROM icustays ie\ninner join admissions adm\n  on ie.hadm_id = adm.hadm_id\ninner join patients pat\n  on ie.subject_id = pat.subject_id\n-- join to above views - the row number filters to 1 row per icustay_id\nleft join pa\n  on  ie.icustay_id = pa.icustay_id\n  and pa.rn = 1\nleft join aa\n  on  ie.icustay_id = aa.icustay_id\n  and aa.rn = 1\nleft join acidbase_max ab\n  on  ie.icustay_id = ab.icustay_id\n  and ab.acidbase_rn = 1\nleft join arf\n  on ie.icustay_id = arf.icustay_id\n\n-- join to custom tables to get more data....\nleft join \"mimic\".\"mimiciii_clinical\".\"ventilation_first_day\" vent\n  on ie.icustay_id = vent.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"gcs_first_day\" gcs\n  on ie.icustay_id = gcs.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"vitals_first_day\" vital\n  on ie.icustay_id = vital.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"urine_output_first_day\" uo\n  on ie.icustay_id = uo.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"labs_first_day\" labs\n  on ie.icustay_id = labs.icustay_id\n)\n-- First, we calculate the score for the minimum values\n, score_min as\n(\n  select cohort.subject_id, cohort.hadm_id, cohort.icustay_id\n  , case\n      when heartrate_min is null then null\n      when heartrate_min <   40 then 8\n      when heartrate_min <   50 then 5\n      when heartrate_min <  100 then 0\n      when heartrate_min <  110 then 1\n      when heartrate_min <  120 then 5\n      when heartrate_min <  140 then 7\n      when heartrate_min <  155 then 13\n      when heartrate_min >= 155 then 17\n    end as hr_score\n\n  , case\n      when meanbp_min is null then null\n      when meanbp_min <   40 then 23\n      when meanbp_min <   60 then 15\n      when meanbp_min <   70 then 7\n      when meanbp_min <   80 then 6\n      when meanbp_min <  100 then 0\n      when meanbp_min <  120 then 4\n      when meanbp_min <  130 then 7\n      when meanbp_min <  140 then 9\n      when meanbp_min >= 140 then 10\n    end as meanbp_score\n\n  -- TODO: add 1 degree to axillary measurements\n  , case\n      when tempc_min is null then null\n      when tempc_min <  33.0 then 20\n      when tempc_min <  33.5 then 16\n      when tempc_min <  34.0 then 13\n      when tempc_min <  35.0 then 8\n      when tempc_min <  36.0 then 2\n      when tempc_min <  40.0 then 0\n      when tempc_min >= 40.0 then 4\n    end as temp_score\n\n  , case\n      when resprate_min is null then null\n      -- special case for ventilated patients\n      when vent = 1 and resprate_min < 14 then 0\n      when resprate_min <   6 then 17\n      when resprate_min <  12 then 8\n      when resprate_min <  14 then 7\n      when resprate_min <  25 then 0\n      when resprate_min <  35 then 6\n      when resprate_min <  40 then 9\n      when resprate_min <  50 then 11\n      when resprate_min >= 50 then 18\n    end as resprate_score\n\n  , case\n      when hematocrit_min is null then null\n      when hematocrit_min <   41.0 then 3\n      when hematocrit_min <   50.0 then 0\n      when hematocrit_min >=  50.0 then 3\n    end as hematocrit_score\n\n  , case\n      when wbc_min is null then null\n      when wbc_min <   1.0 then 19\n      when wbc_min <   3.0 then 5\n      when wbc_min <  20.0 then 0\n      when wbc_min <  25.0 then 1\n      when wbc_min >= 25.0 then 5\n    end as wbc_score\n\n  , case\n      when creatinine_min is null then null\n      when arf = 1 and creatinine_min <  1.5 then 0\n      when arf = 1 and creatinine_min >= 1.5 then 10\n      when creatinine_min <   0.5 then 3\n      when creatinine_min <   1.5 then 0\n      when creatinine_min <  1.95 then 4\n      when creatinine_min >= 1.95 then 7\n    end as creatinine_score\n\n  , case\n      when bun_min is null then null\n      when bun_min <  17.0 then 0\n      when bun_min <  20.0 then 2\n      when bun_min <  40.0 then 7\n      when bun_min <  80.0 then 11\n      when bun_min >= 80.0 then 12\n    end as bun_score\n\n  , case\n      when sodium_min is null then null\n      when sodium_min <  120 then 3\n      when sodium_min <  135 then 2\n      when sodium_min <  155 then 0\n      when sodium_min >= 155 then 4\n    end as sodium_score\n\n  , case\n      when albumin_min is null then null\n      when albumin_min <  2.0 then 11\n      when albumin_min <  2.5 then 6\n      when albumin_min <  4.5 then 0\n      when albumin_min >= 4.5 then 4\n    end as albumin_score\n\n  , case\n      when bilirubin_min is null then null\n      when bilirubin_min <  2.0 then 0\n      when bilirubin_min <  3.0 then 5\n      when bilirubin_min <  5.0 then 6\n      when bilirubin_min <  8.0 then 8\n      when bilirubin_min >= 8.0 then 16\n    end as bilirubin_score\n\n  , case\n      when glucose_min is null then null\n      when glucose_min <   40 then 8\n      when glucose_min <   60 then 9\n      when glucose_min <  200 then 0\n      when glucose_min <  350 then 3\n      when glucose_min >= 350 then 5\n    end as glucose_score\n\nfrom cohort\n)\n, score_max as\n(\n  select cohort.subject_id, cohort.hadm_id, cohort.icustay_id\n    , case\n        when heartrate_max is null then null\n        when heartrate_max <   40 then 8\n        when heartrate_max <   50 then 5\n        when heartrate_max <  100 then 0\n        when heartrate_max <  110 then 1\n        when heartrate_max <  120 then 5\n        when heartrate_max <  140 then 7\n        when heartrate_max <  155 then 13\n        when heartrate_max >= 155 then 17\n      end as hr_score\n\n    , case\n        when meanbp_max is null then null\n        when meanbp_max <   40 then 23\n        when meanbp_max <   60 then 15\n        when meanbp_max <   70 then 7\n        when meanbp_max <   80 then 6\n        when meanbp_max <  100 then 0\n        when meanbp_max <  120 then 4\n        when meanbp_max <  130 then 7\n        when meanbp_max <  140 then 9\n        when meanbp_max >= 140 then 10\n      end as meanbp_score\n\n    -- TODO: add 1 degree to axillary measurements\n    , case\n        when tempc_max is null then null\n        when tempc_max <  33.0 then 20\n        when tempc_max <  33.5 then 16\n        when tempc_max <  34.0 then 13\n        when tempc_max <  35.0 then 8\n        when tempc_max <  36.0 then 2\n        when tempc_max <  40.0 then 0\n        when tempc_max >= 40.0 then 4\n      end as temp_score\n\n    , case\n        when resprate_max is null then null\n        -- special case for ventilated patients\n        when vent = 1 and resprate_max < 14 then 0\n        when resprate_max <   6 then 17\n        when resprate_max <  12 then 8\n        when resprate_max <  14 then 7\n        when resprate_max <  25 then 0\n        when resprate_max <  35 then 6\n        when resprate_max <  40 then 9\n        when resprate_max <  50 then 11\n        when resprate_max >= 50 then 18\n      end as resprate_score\n\n    , case\n        when hematocrit_max is null then null\n        when hematocrit_max <   41.0 then 3\n        when hematocrit_max <   50.0 then 0\n        when hematocrit_max >=  50.0 then 3\n      end as hematocrit_score\n\n    , case\n        when wbc_max is null then null\n        when wbc_max <   1.0 then 19\n        when wbc_max <   3.0 then 5\n        when wbc_max <  20.0 then 0\n        when wbc_max <  25.0 then 1\n        when wbc_max >= 25.0 then 5\n      end as wbc_score\n\n    , case\n        when creatinine_max is null then null\n        when arf = 1 and creatinine_max <  1.5 then 0\n        when arf = 1 and creatinine_max >= 1.5 then 10\n        when creatinine_max <   0.5 then 3\n        when creatinine_max <   1.5 then 0\n        when creatinine_max <  1.95 then 4\n        when creatinine_max >= 1.95 then 7\n      end as creatinine_score\n\n    , case\n        when bun_max is null then null\n        when bun_max <  17.0 then 0\n        when bun_max <  20.0 then 2\n        when bun_max <  40.0 then 7\n        when bun_max <  80.0 then 11\n        when bun_max >= 80.0 then 12\n      end as bun_score\n\n    , case\n        when sodium_max is null then null\n        when sodium_max <  120 then 3\n        when sodium_max <  135 then 2\n        when sodium_max <  155 then 0\n        when sodium_max >= 155 then 4\n      end as sodium_score\n\n    , case\n        when albumin_max is null then null\n        when albumin_max <  2.0 then 11\n        when albumin_max <  2.5 then 6\n        when albumin_max <  4.5 then 0\n        when albumin_max >= 4.5 then 4\n      end as albumin_score\n\n    , case\n        when bilirubin_max is null then null\n        when bilirubin_max <  2.0 then 0\n        when bilirubin_max <  3.0 then 5\n        when bilirubin_max <  5.0 then 6\n        when bilirubin_max <  8.0 then 8\n        when bilirubin_max >= 8.0 then 16\n      end as bilirubin_score\n\n    , case\n        when glucose_max is null then null\n        when glucose_max <   40 then 8\n        when glucose_max <   60 then 9\n        when glucose_max <  200 then 0\n        when glucose_max <  350 then 3\n        when glucose_max >= 350 then 5\n      end as glucose_score\n\nfrom cohort\n)\n-- Combine together the scores for min/max, using the following rules:\n--  1) select the value furthest from a predefined normal value\n--  2) if both equidistant, choose the one which gives a worse score\n--  3) calculate score for acid-base abnormalities as it requires interactions\n-- sometimes the code is a bit redundant, i.e. we know the max would always be furthest from 0\n, scorecomp as\n(\n  select co.*\n  -- The rules for APS III require the definition of a \"worst\" value\n  -- This value is defined as whatever value is furthest from a predefined normal\n  -- e.g., for heart rate, worst is defined as furthest from 75\n  , case\n      when heartrate_max is null then null\n      when abs(heartrate_max-75) > abs(heartrate_min-75)\n        then smax.hr_score\n      when abs(heartrate_max-75) < abs(heartrate_min-75)\n        then smin.hr_score\n      when abs(heartrate_max-75) = abs(heartrate_min-75)\n      and  smax.hr_score >= smin.hr_score\n        then smax.hr_score\n      when abs(heartrate_max-75) = abs(heartrate_min-75)\n      and  smax.hr_score < smin.hr_score\n        then smin.hr_score\n    end as hr_score\n\n  , case\n      when meanbp_max is null then null\n      when abs(meanbp_max-90) > abs(meanbp_min-90)\n        then smax.meanbp_score\n      when abs(meanbp_max-90) < abs(meanbp_min-90)\n        then smin.meanbp_score\n      -- values are equidistant - pick the larger score\n      when abs(meanbp_max-90) = abs(meanbp_min-90)\n      and  smax.meanbp_score >= smin.meanbp_score\n        then smax.meanbp_score\n      when abs(meanbp_max-90) = abs(meanbp_min-90)\n      and  smax.meanbp_score < smin.meanbp_score\n        then smin.meanbp_score\n    end as meanbp_score\n\n  , case\n      when tempc_max is null then null\n      when abs(tempc_max-38) > abs(tempc_min-38)\n        then smax.temp_score\n      when abs(tempc_max-38) < abs(tempc_min-38)\n        then smin.temp_score\n      -- values are equidistant - pick the larger score\n      when abs(tempc_max-38) = abs(tempc_min-38)\n      and  smax.temp_score >= smin.temp_score\n        then smax.temp_score\n      when abs(tempc_max-38) = abs(tempc_min-38)\n      and  smax.temp_score < smin.temp_score\n        then smin.temp_score\n    end as temp_score\n\n  , case\n      when resprate_max is null then null\n      when abs(resprate_max-19) > abs(resprate_min-19)\n        then smax.resprate_score\n      when abs(resprate_max-19) < abs(resprate_min-19)\n        then smin.resprate_score\n      -- values are equidistant - pick the larger score\n      when abs(resprate_max-19) = abs(resprate_max-19)\n      and  smax.resprate_score >= smin.resprate_score\n        then smax.resprate_score\n      when abs(resprate_max-19) = abs(resprate_max-19)\n      and  smax.resprate_score < smin.resprate_score\n        then smin.resprate_score\n    end as resprate_score\n\n  , case\n      when hematocrit_max is null then null\n      when abs(hematocrit_max-45.5) > abs(hematocrit_min-45.5)\n        then smax.hematocrit_score\n      when abs(hematocrit_max-45.5) < abs(hematocrit_min-45.5)\n        then smin.hematocrit_score\n      -- values are equidistant - pick the larger score\n      when abs(hematocrit_max-45.5) = abs(hematocrit_max-45.5)\n      and  smax.hematocrit_score >= smin.hematocrit_score\n        then smax.hematocrit_score\n      when abs(hematocrit_max-45.5) = abs(hematocrit_max-45.5)\n      and  smax.hematocrit_score < smin.hematocrit_score\n        then smin.hematocrit_score\n    end as hematocrit_score\n\n  , case\n      when wbc_max is null then null\n      when abs(wbc_max-11.5) > abs(wbc_min-11.5)\n        then smax.wbc_score\n      when abs(wbc_max-11.5) < abs(wbc_min-11.5)\n        then smin.wbc_score\n      -- values are equidistant - pick the larger score\n      when abs(wbc_max-11.5) = abs(wbc_max-11.5)\n      and  smax.wbc_score >= smin.wbc_score\n        then smax.wbc_score\n      when abs(wbc_max-11.5) = abs(wbc_max-11.5)\n      and  smax.wbc_score < smin.wbc_score\n        then smin.wbc_score\n    end as wbc_score\n\n\n  -- For some labs, \"furthest from normal\" doesn't make sense\n  -- e.g. creatinine w/ ARF, the minimum could be 0.3, and the max 1.6\n  -- while the minimum of 0.3 is \"further from 1\", seems like the max should be scored\n\n  , case\n      when creatinine_max is null then null\n      -- if they have arf then use the max to score\n      when arf = 1 then smax.creatinine_score\n      -- otherwise furthest from 1\n      when abs(creatinine_max-1) > abs(creatinine_min-1)\n        then smax.creatinine_score\n      when abs(creatinine_max-1) < abs(creatinine_min-1)\n        then smin.creatinine_score\n      -- values are equidistant\n      when smax.creatinine_score >= smin.creatinine_score\n        then smax.creatinine_score\n      when smax.creatinine_score < smin.creatinine_score\n        then smin.creatinine_score\n    end as creatinine_score\n\n  -- the rule for BUN is the furthest from 0.. equivalent to the max value\n  , case\n      when bun_max is null then null\n      else smax.bun_score\n    end as bun_score\n\n  , case\n      when sodium_max is null then null\n      when abs(sodium_max-145.5) > abs(sodium_min-145.5)\n        then smax.sodium_score\n      when abs(sodium_max-145.5) < abs(sodium_min-145.5)\n        then smin.sodium_score\n      -- values are equidistant - pick the larger score\n      when abs(sodium_max-145.5) = abs(sodium_max-145.5)\n      and  smax.sodium_score >= smin.sodium_score\n        then smax.sodium_score\n      when abs(sodium_max-145.5) = abs(sodium_max-145.5)\n      and  smax.sodium_score < smin.sodium_score\n        then smin.sodium_score\n    end as sodium_score\n\n  , case\n      when albumin_max is null then null\n      when abs(albumin_max-3.5) > abs(albumin_min-3.5)\n        then smax.albumin_score\n      when abs(albumin_max-3.5) < abs(albumin_min-3.5)\n        then smin.albumin_score\n      -- values are equidistant - pick the larger score\n      when abs(albumin_max-3.5) = abs(albumin_max-3.5)\n      and  smax.albumin_score >= smin.albumin_score\n        then smax.albumin_score\n      when abs(albumin_max-3.5) = abs(albumin_max-3.5)\n      and  smax.albumin_score < smin.albumin_score\n        then smin.albumin_score\n    end as albumin_score\n\n  , case\n      when bilirubin_max is null then null\n      else smax.bilirubin_score\n    end as bilirubin_score\n\n  , case\n      when glucose_max is null then null\n      when abs(glucose_max-130) > abs(glucose_min-130)\n        then smax.glucose_score\n      when abs(glucose_max-130) < abs(glucose_min-130)\n        then smin.glucose_score\n      -- values are equidistant - pick the larger score\n      when abs(glucose_max-130) = abs(glucose_max-130)\n      and  smax.glucose_score >= smin.glucose_score\n        then smax.glucose_score\n      when abs(glucose_max-130) = abs(glucose_max-130)\n      and  smax.glucose_score < smin.glucose_score\n        then smin.glucose_score\n    end as glucose_score\n\n\n  -- Below are interactions/special cases where only 1 value is important\n  , case\n      when urineoutput is null then null\n      when urineoutput <   400 then 15\n      when urineoutput <   600 then 8\n      when urineoutput <   900 then 7\n      when urineoutput <  1500 then 5\n      when urineoutput <  2000 then 4\n      when urineoutput <  4000 then 0\n      when urineoutput >= 4000 then 1\n  end as uo_score\n\n  , case\n      when endotrachflag = 1\n        -- here they are intubated, so their verbal score is inappropriate\n        -- normally you are supposed to use \"clinical judgement\"\n        -- we don't have that, so we just assume normal (as was done in the original study)\n        then 0\n      when gcseyes = 1\n        then case\n          when gcsverbal = 1 and gcsmotor in (1,2)\n            then 48\n          when gcsverbal = 1 and gcsmotor in (3,4)\n            then 33\n          when gcsverbal = 1 and gcsmotor in (5,6)\n            then 16\n          when gcsverbal in (2,3) and gcsmotor in (1,2)\n            then 29\n          when gcsverbal in (2,3) and gcsmotor in (3,4)\n            then 24\n          when gcsverbal in (2,3) and gcsmotor >= 5\n            -- highly unlikely clinical combination\n            then null\n          when gcsverbal >= 4\n            then null\n          end\n      when gcseyes > 1\n        then case\n          when gcsverbal = 1 and gcsmotor in (1,2)\n            then 29\n          when gcsverbal = 1 and gcsmotor in (3,4)\n            then 24\n          when gcsverbal = 1 and gcsmotor in (5,6)\n            then 15\n          when gcsverbal in (2,3) and gcsmotor in (1,2)\n            then 29\n          when gcsverbal in (2,3) and gcsmotor in (3,4)\n            then 24\n          when gcsverbal in (2,3) and gcsmotor = 5\n            then 13\n          when gcsverbal in (2,3) and gcsmotor = 6\n            then 10\n          when gcsverbal = 4 and gcsmotor in (1,2,3,4)\n            then 13\n          when gcsverbal = 4 and gcsmotor = 5\n            then 8\n          when gcsverbal = 4 and gcsmotor = 6\n            then 3\n          when gcsverbal = 5 and gcsmotor in (1,2,3,4,5)\n            then 3\n          when gcsverbal = 5 and gcsmotor = 6\n            then 0\n          end\n      else null\n    end as gcs_score\n\n  , case\n      when pao2 is null and aado2 is null\n        then null\n      when pao2 is not null then\n        case\n          when pao2 < 50 then 15\n          when pao2 < 70 then 5\n          when pao2 < 80 then 2\n        else 0 end\n      when aado2 is not null then\n        case\n          when aado2 <  100 then 0\n          when aado2 <  250 then 7\n          when aado2 <  350 then 9\n          when aado2 <  500 then 11\n          when aado2 >= 500 then 14\n        else 0 end\n      end as pao2_aado2_score\n\nfrom cohort co\nleft join score_min smin\n  on co.icustay_id = smin.icustay_id\nleft join score_max smax\n  on co.icustay_id = smax.icustay_id\n)\n-- tabulate the APS III using the scores from the worst values\n, score as\n(\n  select s.*\n  -- coalesce statements impute normal score of zero if data element is missing\n  , coalesce(hr_score,0)\n  + coalesce(meanbp_score,0)\n  + coalesce(temp_score,0)\n  + coalesce(resprate_score,0)\n  + coalesce(pao2_aado2_score,0)\n  + coalesce(hematocrit_score,0)\n  + coalesce(wbc_score,0)\n  + coalesce(creatinine_score,0)\n  + coalesce(uo_score,0)\n  + coalesce(bun_score,0)\n  + coalesce(sodium_score,0)\n  + coalesce(albumin_score,0)\n  + coalesce(bilirubin_score,0)\n  + coalesce(glucose_score,0)\n  + coalesce(acidbase_score,0)\n  + coalesce(gcs_score,0)\n    as apsiii\n  from scorecomp s\n)\nselect ie.subject_id, ie.hadm_id, ie.icustay_id\n, apsiii\n-- Calculate probability of hospital mortality using equation from Johnson 2014.\n, 1 / (1 + exp(- (-4.4360 + 0.04726*(apsiii) ))) as apsiii_prob\n, hr_score\n, meanbp_score\n, temp_score\n, resprate_score\n, pao2_aado2_score\n, hematocrit_score\n, wbc_score\n, creatinine_score\n, uo_score\n, bun_score\n, sodium_score\n, albumin_score\n, bilirubin_score\n, glucose_score\n, acidbase_score\n, gcs_score\nFROM icustays ie\nleft join score s\n  on ie.icustay_id = s.icustay_id\norder by ie.icustay_id",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.blood_gas_first_day_arterial",
            "mimiciii_clinical.diagnoses_icd",
            "mimiciii_clinical.gcs_first_day",
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.labs_first_day",
            "mimiciii_clinical.patients",
            "mimiciii_clinical.urine_output_first_day",
            "mimiciii_clinical.ventilation_durations",
            "mimiciii_clinical.ventilation_first_day",
            "mimiciii_clinical.vitals_first_day"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.aado2",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2_chartevents",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.ph",
                "mimiciii_clinical.blood_gas_first_day_arterial.po2",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "hadm_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.aado2",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2_chartevents",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.ph",
                "mimiciii_clinical.blood_gas_first_day_arterial.po2",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "icustay_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.aado2",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2_chartevents",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.ph",
                "mimiciii_clinical.blood_gas_first_day_arterial.po2",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "apsiii": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.aado2",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2_chartevents",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.ph",
                "mimiciii_clinical.blood_gas_first_day_arterial.po2",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.endotrachflag",
                "mimiciii_clinical.gcs_first_day.gcseyes",
                "mimiciii_clinical.gcs_first_day.gcsmotor",
                "mimiciii_clinical.gcs_first_day.gcsverbal",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.albumin_max",
                "mimiciii_clinical.labs_first_day.albumin_min",
                "mimiciii_clinical.labs_first_day.bilirubin_max",
                "mimiciii_clinical.labs_first_day.bun_max",
                "mimiciii_clinical.labs_first_day.creatinine_max",
                "mimiciii_clinical.labs_first_day.creatinine_min",
                "mimiciii_clinical.labs_first_day.glucose_max",
                "mimiciii_clinical.labs_first_day.glucose_min",
                "mimiciii_clinical.labs_first_day.hematocrit_max",
                "mimiciii_clinical.labs_first_day.hematocrit_min",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.sodium_max",
                "mimiciii_clinical.labs_first_day.sodium_min",
                "mimiciii_clinical.labs_first_day.wbc_max",
                "mimiciii_clinical.labs_first_day.wbc_min",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.urineoutput",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.vent",
                "mimiciii_clinical.vitals_first_day.glucose_max",
                "mimiciii_clinical.vitals_first_day.glucose_min",
                "mimiciii_clinical.vitals_first_day.heartrate_max",
                "mimiciii_clinical.vitals_first_day.heartrate_min",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.meanbp_max",
                "mimiciii_clinical.vitals_first_day.meanbp_min",
                "mimiciii_clinical.vitals_first_day.resprate_max",
                "mimiciii_clinical.vitals_first_day.resprate_min",
                "mimiciii_clinical.vitals_first_day.tempc_max",
                "mimiciii_clinical.vitals_first_day.tempc_min"
            ],
            "apsiii_prob": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.aado2",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2_chartevents",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.ph",
                "mimiciii_clinical.blood_gas_first_day_arterial.po2",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.endotrachflag",
                "mimiciii_clinical.gcs_first_day.gcseyes",
                "mimiciii_clinical.gcs_first_day.gcsmotor",
                "mimiciii_clinical.gcs_first_day.gcsverbal",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.albumin_max",
                "mimiciii_clinical.labs_first_day.albumin_min",
                "mimiciii_clinical.labs_first_day.bilirubin_max",
                "mimiciii_clinical.labs_first_day.bun_max",
                "mimiciii_clinical.labs_first_day.creatinine_max",
                "mimiciii_clinical.labs_first_day.creatinine_min",
                "mimiciii_clinical.labs_first_day.glucose_max",
                "mimiciii_clinical.labs_first_day.glucose_min",
                "mimiciii_clinical.labs_first_day.hematocrit_max",
                "mimiciii_clinical.labs_first_day.hematocrit_min",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.sodium_max",
                "mimiciii_clinical.labs_first_day.sodium_min",
                "mimiciii_clinical.labs_first_day.wbc_max",
                "mimiciii_clinical.labs_first_day.wbc_min",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.urineoutput",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.vent",
                "mimiciii_clinical.vitals_first_day.glucose_max",
                "mimiciii_clinical.vitals_first_day.glucose_min",
                "mimiciii_clinical.vitals_first_day.heartrate_max",
                "mimiciii_clinical.vitals_first_day.heartrate_min",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.meanbp_max",
                "mimiciii_clinical.vitals_first_day.meanbp_min",
                "mimiciii_clinical.vitals_first_day.resprate_max",
                "mimiciii_clinical.vitals_first_day.resprate_min",
                "mimiciii_clinical.vitals_first_day.tempc_max",
                "mimiciii_clinical.vitals_first_day.tempc_min"
            ],
            "hr_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.aado2",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2_chartevents",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.ph",
                "mimiciii_clinical.blood_gas_first_day_arterial.po2",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.heartrate_max",
                "mimiciii_clinical.vitals_first_day.heartrate_min",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "meanbp_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.aado2",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2_chartevents",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.ph",
                "mimiciii_clinical.blood_gas_first_day_arterial.po2",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.meanbp_max",
                "mimiciii_clinical.vitals_first_day.meanbp_min"
            ],
            "temp_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.aado2",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2_chartevents",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.ph",
                "mimiciii_clinical.blood_gas_first_day_arterial.po2",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.tempc_max",
                "mimiciii_clinical.vitals_first_day.tempc_min"
            ],
            "resprate_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.aado2",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2_chartevents",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.ph",
                "mimiciii_clinical.blood_gas_first_day_arterial.po2",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.vent",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.resprate_max",
                "mimiciii_clinical.vitals_first_day.resprate_min"
            ],
            "pao2_aado2_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.aado2",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2_chartevents",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.ph",
                "mimiciii_clinical.blood_gas_first_day_arterial.po2",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "hematocrit_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.aado2",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2_chartevents",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.ph",
                "mimiciii_clinical.blood_gas_first_day_arterial.po2",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.hematocrit_max",
                "mimiciii_clinical.labs_first_day.hematocrit_min",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "wbc_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.aado2",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2_chartevents",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.ph",
                "mimiciii_clinical.blood_gas_first_day_arterial.po2",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.wbc_max",
                "mimiciii_clinical.labs_first_day.wbc_min",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "creatinine_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.aado2",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2_chartevents",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.ph",
                "mimiciii_clinical.blood_gas_first_day_arterial.po2",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.creatinine_max",
                "mimiciii_clinical.labs_first_day.creatinine_min",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.urineoutput",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "uo_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.aado2",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2_chartevents",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.ph",
                "mimiciii_clinical.blood_gas_first_day_arterial.po2",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.urineoutput",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "bun_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.aado2",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2_chartevents",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.ph",
                "mimiciii_clinical.blood_gas_first_day_arterial.po2",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.bun_max",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "sodium_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.aado2",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2_chartevents",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.ph",
                "mimiciii_clinical.blood_gas_first_day_arterial.po2",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.sodium_max",
                "mimiciii_clinical.labs_first_day.sodium_min",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "albumin_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.aado2",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2_chartevents",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.ph",
                "mimiciii_clinical.blood_gas_first_day_arterial.po2",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.albumin_max",
                "mimiciii_clinical.labs_first_day.albumin_min",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "bilirubin_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.aado2",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2_chartevents",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.ph",
                "mimiciii_clinical.blood_gas_first_day_arterial.po2",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.bilirubin_max",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "glucose_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.aado2",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2_chartevents",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.ph",
                "mimiciii_clinical.blood_gas_first_day_arterial.po2",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.glucose_max",
                "mimiciii_clinical.labs_first_day.glucose_min",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.glucose_max",
                "mimiciii_clinical.vitals_first_day.glucose_min",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "acidbase_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.aado2",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2_chartevents",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.ph",
                "mimiciii_clinical.blood_gas_first_day_arterial.po2",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "gcs_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.aado2",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2",
                "mimiciii_clinical.blood_gas_first_day_arterial.fio2_chartevents",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.ph",
                "mimiciii_clinical.blood_gas_first_day_arterial.po2",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.endotrachflag",
                "mimiciii_clinical.gcs_first_day.gcseyes",
                "mimiciii_clinical.gcs_first_day.gcsmotor",
                "mimiciii_clinical.gcs_first_day.gcsverbal",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ]
        },
        "table_name": "mimiciii_clinical.apsiii",
        "plan": {
            "Node Type": "Merge Join",
            "Parallel Aware": false,
            "Join Type": "Left",
            "Output": [
                "ie.subject_id",
                "ie.hadm_id",
                "ie.icustay_id",
                "s.apsiii",
                "('1'::numeric / ('1'::numeric + exp((- ('-4.4360'::numeric + (0.04726 * (s.apsiii)::numeric))))))",
                "s.hr_score",
                "s.meanbp_score",
                "s.temp_score",
                "s.resprate_score",
                "s.pao2_aado2_score",
                "s.hematocrit_score",
                "s.wbc_score",
                "s.creatinine_score",
                "s.uo_score",
                "s.bun_score",
                "s.sodium_score",
                "s.albumin_score",
                "s.bilirubin_score",
                "s.glucose_score",
                "s.acidbase_score",
                "s.gcs_score"
            ],
            "Inner Unique": false,
            "Merge Cond": "(ie.icustay_id = s.icustay_id)",
            "Plans": [
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE pa",
                    "Parallel Aware": false,
                    "Output": [
                        "bg.icustay_id",
                        "bg.charttime",
                        "bg.po2",
                        "row_number() OVER (?)",
                        "bg.po2"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "bg.icustay_id",
                                "bg.po2",
                                "bg.charttime"
                            ],
                            "Sort Key": [
                                "bg.icustay_id",
                                "bg.po2 DESC"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Anti",
                                    "Output": [
                                        "bg.icustay_id",
                                        "bg.po2",
                                        "bg.charttime"
                                    ],
                                    "Inner Unique": false,
                                    "Hash Cond": "(bg.icustay_id = vd.icustay_id)",
                                    "Join Filter": "((bg.charttime >= vd.starttime) AND (bg.charttime <= vd.endtime))",
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "blood_gas_first_day_arterial",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "bg",
                                            "Output": [
                                                "bg.subject_id",
                                                "bg.hadm_id",
                                                "bg.icustay_id",
                                                "bg.charttime",
                                                "bg.specimen",
                                                "bg.specimen_pred",
                                                "bg.specimen_prob",
                                                "bg.so2",
                                                "bg.spo2",
                                                "bg.po2",
                                                "bg.pco2",
                                                "bg.fio2_chartevents",
                                                "bg.fio2",
                                                "bg.aado2",
                                                "bg.aado2_calc",
                                                "bg.pao2fio2",
                                                "bg.ph",
                                                "bg.baseexcess",
                                                "bg.bicarbonate",
                                                "bg.totalco2",
                                                "bg.hematocrit",
                                                "bg.hemoglobin",
                                                "bg.carboxyhemoglobin",
                                                "bg.methemoglobin",
                                                "bg.chloride",
                                                "bg.calcium",
                                                "bg.temperature",
                                                "bg.potassium",
                                                "bg.sodium",
                                                "bg.lactate",
                                                "bg.glucose",
                                                "bg.intubated",
                                                "bg.tidalvolume",
                                                "bg.ventilationrate",
                                                "bg.ventilator",
                                                "bg.peep",
                                                "bg.o2flow",
                                                "bg.requiredo2"
                                            ],
                                            "Filter": "((bg.po2 IS NOT NULL) AND (COALESCE(bg.fio2, bg.fio2_chartevents, '21'::double precision) < '50'::double precision))"
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "vd.icustay_id",
                                                "vd.starttime",
                                                "vd.endtime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "ventilation_durations",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "vd",
                                                    "Output": [
                                                        "vd.icustay_id",
                                                        "vd.starttime",
                                                        "vd.endtime"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE aa",
                    "Parallel Aware": false,
                    "Output": [
                        "bg_1.icustay_id",
                        "bg_1.charttime",
                        "bg_1.aado2",
                        "row_number() OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "bg_1.icustay_id",
                                "bg_1.aado2",
                                "bg_1.charttime"
                            ],
                            "Sort Key": [
                                "bg_1.icustay_id",
                                "bg_1.aado2 DESC"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Gather",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "bg_1.icustay_id",
                                        "bg_1.aado2",
                                        "bg_1.charttime"
                                    ],
                                    "Workers Planned": 2,
                                    "Single Copy": false,
                                    "Plans": [
                                        {
                                            "Node Type": "Hash Join",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Join Type": "Inner",
                                            "Output": [
                                                "bg_1.icustay_id",
                                                "bg_1.aado2",
                                                "bg_1.charttime"
                                            ],
                                            "Inner Unique": false,
                                            "Hash Cond": "(bg_1.icustay_id = vd_1.icustay_id)",
                                            "Join Filter": "((bg_1.charttime >= vd_1.starttime) AND (bg_1.charttime <= vd_1.endtime))",
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": true,
                                                    "Relation Name": "blood_gas_first_day_arterial",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "bg_1",
                                                    "Output": [
                                                        "bg_1.subject_id",
                                                        "bg_1.hadm_id",
                                                        "bg_1.icustay_id",
                                                        "bg_1.charttime",
                                                        "bg_1.specimen",
                                                        "bg_1.specimen_pred",
                                                        "bg_1.specimen_prob",
                                                        "bg_1.so2",
                                                        "bg_1.spo2",
                                                        "bg_1.po2",
                                                        "bg_1.pco2",
                                                        "bg_1.fio2_chartevents",
                                                        "bg_1.fio2",
                                                        "bg_1.aado2",
                                                        "bg_1.aado2_calc",
                                                        "bg_1.pao2fio2",
                                                        "bg_1.ph",
                                                        "bg_1.baseexcess",
                                                        "bg_1.bicarbonate",
                                                        "bg_1.totalco2",
                                                        "bg_1.hematocrit",
                                                        "bg_1.hemoglobin",
                                                        "bg_1.carboxyhemoglobin",
                                                        "bg_1.methemoglobin",
                                                        "bg_1.chloride",
                                                        "bg_1.calcium",
                                                        "bg_1.temperature",
                                                        "bg_1.potassium",
                                                        "bg_1.sodium",
                                                        "bg_1.lactate",
                                                        "bg_1.glucose",
                                                        "bg_1.intubated",
                                                        "bg_1.tidalvolume",
                                                        "bg_1.ventilationrate",
                                                        "bg_1.ventilator",
                                                        "bg_1.peep",
                                                        "bg_1.o2flow",
                                                        "bg_1.requiredo2"
                                                    ],
                                                    "Filter": "((bg_1.aado2 IS NOT NULL) AND (COALESCE(bg_1.fio2, bg_1.fio2_chartevents) >= '50'::double precision))"
                                                },
                                                {
                                                    "Node Type": "Hash",
                                                    "Parent Relationship": "Inner",
                                                    "Parallel Aware": false,
                                                    "Output": [
                                                        "vd_1.icustay_id",
                                                        "vd_1.starttime",
                                                        "vd_1.endtime"
                                                    ],
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Seq Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "ventilation_durations",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "vd_1",
                                                            "Output": [
                                                                "vd_1.icustay_id",
                                                                "vd_1.starttime",
                                                                "vd_1.endtime"
                                                            ],
                                                            "Filter": "(vd_1.icustay_id IS NOT NULL)"
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Seq Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE acidbase",
                    "Parallel Aware": false,
                    "Relation Name": "blood_gas_first_day_arterial",
                    "Schema": "mimiciii_clinical",
                    "Alias": "bg_2",
                    "Output": [
                        "bg_2.icustay_id",
                        "bg_2.ph",
                        "bg_2.pco2",
                        "CASE WHEN ((bg_2.ph IS NULL) OR (bg_2.pco2 IS NULL)) THEN NULL::integer WHEN (bg_2.ph < '7.2'::double precision) THEN CASE WHEN (bg_2.pco2 < '50'::double precision) THEN 12 ELSE 4 END WHEN (bg_2.ph < '7.3'::double precision) THEN CASE WHEN (bg_2.pco2 < '30'::double precision) THEN 9 WHEN (bg_2.pco2 < '40'::double precision) THEN 6 WHEN (bg_2.pco2 < '50'::double precision) THEN 3 ELSE 2 END WHEN (bg_2.ph < '7.35'::double precision) THEN CASE WHEN (bg_2.pco2 < '30'::double precision) THEN 9 WHEN (bg_2.pco2 < '45'::double precision) THEN 0 ELSE 1 END WHEN (bg_2.ph < '7.45'::double precision) THEN CASE WHEN (bg_2.pco2 < '30'::double precision) THEN 5 WHEN (bg_2.pco2 < '45'::double precision) THEN 0 ELSE 1 END WHEN (bg_2.ph < '7.5'::double precision) THEN CASE WHEN (bg_2.pco2 < '30'::double precision) THEN 5 WHEN (bg_2.pco2 < '35'::double precision) THEN 0 WHEN (bg_2.pco2 < '45'::double precision) THEN 2 ELSE 12 END WHEN (bg_2.ph < '7.6'::double precision) THEN CASE WHEN (bg_2.pco2 < '40'::double precision) THEN 3 ELSE 12 END ELSE CASE WHEN (bg_2.pco2 < '25'::double precision) THEN 0 WHEN (bg_2.pco2 < '40'::double precision) THEN 3 ELSE 12 END END"
                    ],
                    "Filter": "((bg_2.ph IS NOT NULL) AND (bg_2.pco2 IS NOT NULL))"
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE acidbase_max",
                    "Parallel Aware": false,
                    "Output": [
                        "acidbase.icustay_id",
                        "acidbase.acidbase_score",
                        "acidbase.ph",
                        "acidbase.paco2",
                        "row_number() OVER (?)"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "acidbase.icustay_id",
                                "acidbase.acidbase_score",
                                "acidbase.ph",
                                "acidbase.paco2"
                            ],
                            "Sort Key": [
                                "acidbase.icustay_id",
                                "acidbase.acidbase_score DESC"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "acidbase",
                                    "Alias": "acidbase",
                                    "Output": [
                                        "acidbase.icustay_id",
                                        "acidbase.acidbase_score",
                                        "acidbase.ph",
                                        "acidbase.paco2"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE arf",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "ie_1.icustay_id",
                        "CASE WHEN ((labs.creatinine_max >= '1.5'::double precision) AND (uo.urineoutput < '410'::double precision) AND (icd.ckd = 0)) THEN 1 ELSE 0 END"
                    ],
                    "Inner Unique": true,
                    "Hash Cond": "(ie_1.hadm_id = icd.hadm_id)",
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Left",
                            "Output": [
                                "ie_1.icustay_id",
                                "ie_1.hadm_id",
                                "uo.urineoutput",
                                "labs.creatinine_max"
                            ],
                            "Inner Unique": false,
                            "Hash Cond": "(ie_1.icustay_id = uo.icustay_id)",
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Right",
                                    "Output": [
                                        "ie_1.icustay_id",
                                        "ie_1.hadm_id",
                                        "labs.creatinine_max"
                                    ],
                                    "Inner Unique": true,
                                    "Hash Cond": "(labs.icustay_id = ie_1.icustay_id)",
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "labs_first_day",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "labs",
                                            "Output": [
                                                "labs.subject_id",
                                                "labs.hadm_id",
                                                "labs.icustay_id",
                                                "labs.aniongap_min",
                                                "labs.aniongap_max",
                                                "labs.albumin_min",
                                                "labs.albumin_max",
                                                "labs.bands_min",
                                                "labs.bands_max",
                                                "labs.bicarbonate_min",
                                                "labs.bicarbonate_max",
                                                "labs.bilirubin_min",
                                                "labs.bilirubin_max",
                                                "labs.creatinine_min",
                                                "labs.creatinine_max",
                                                "labs.chloride_min",
                                                "labs.chloride_max",
                                                "labs.glucose_min",
                                                "labs.glucose_max",
                                                "labs.hematocrit_min",
                                                "labs.hematocrit_max",
                                                "labs.hemoglobin_min",
                                                "labs.hemoglobin_max",
                                                "labs.lactate_min",
                                                "labs.lactate_max",
                                                "labs.platelet_min",
                                                "labs.platelet_max",
                                                "labs.potassium_min",
                                                "labs.potassium_max",
                                                "labs.ptt_min",
                                                "labs.ptt_max",
                                                "labs.inr_min",
                                                "labs.inr_max",
                                                "labs.pt_min",
                                                "labs.pt_max",
                                                "labs.sodium_min",
                                                "labs.sodium_max",
                                                "labs.bun_min",
                                                "labs.bun_max",
                                                "labs.wbc_min",
                                                "labs.wbc_max"
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ie_1.icustay_id",
                                                "ie_1.hadm_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "icustays",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ie_1",
                                                    "Output": [
                                                        "ie_1.icustay_id",
                                                        "ie_1.hadm_id"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "uo.urineoutput",
                                        "uo.icustay_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "urine_output_first_day",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "uo",
                                            "Output": [
                                                "uo.urineoutput",
                                                "uo.icustay_id"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "icd.ckd",
                                "icd.hadm_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Subquery Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Alias": "icd",
                                    "Output": [
                                        "icd.ckd",
                                        "icd.hadm_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Aggregate",
                                            "Strategy": "Hashed",
                                            "Partial Mode": "Simple",
                                            "Parent Relationship": "Subquery",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "diagnoses_icd.hadm_id",
                                                "max(CASE WHEN ((diagnoses_icd.icd9_code)::text = ANY ('{5854,5855,5856}'::text[])) THEN 1 ELSE 0 END)"
                                            ],
                                            "Group Key": [
                                                "diagnoses_icd.hadm_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "diagnoses_icd",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "diagnoses_icd",
                                                    "Output": [
                                                        "diagnoses_icd.row_id",
                                                        "diagnoses_icd.subject_id",
                                                        "diagnoses_icd.hadm_id",
                                                        "diagnoses_icd.seq_num",
                                                        "diagnoses_icd.icd9_code"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cohort",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "ie_2.subject_id",
                        "ie_2.hadm_id",
                        "ie_2.icustay_id",
                        "ie_2.intime",
                        "ie_2.outtime",
                        "vital.heartrate_min",
                        "vital.heartrate_max",
                        "vital.meanbp_min",
                        "vital.meanbp_max",
                        "vital.tempc_min",
                        "vital.tempc_max",
                        "vital.resprate_min",
                        "vital.resprate_max",
                        "pa.pao2",
                        "aa.aado2",
                        "ab.ph",
                        "ab.paco2",
                        "ab.acidbase_score",
                        "labs_1.hematocrit_min",
                        "labs_1.hematocrit_max",
                        "labs_1.wbc_min",
                        "labs_1.wbc_max",
                        "labs_1.creatinine_min",
                        "labs_1.creatinine_max",
                        "labs_1.bun_min",
                        "labs_1.bun_max",
                        "labs_1.sodium_min",
                        "labs_1.sodium_max",
                        "labs_1.albumin_min",
                        "labs_1.albumin_max",
                        "labs_1.bilirubin_min",
                        "labs_1.bilirubin_max",
                        "CASE WHEN ((labs_1.glucose_max IS NULL) AND (vital.glucose_max IS NULL)) THEN NULL::double precision WHEN ((labs_1.glucose_max IS NULL) OR (vital.glucose_max > labs_1.glucose_max)) THEN vital.glucose_max WHEN ((vital.glucose_max IS NULL) OR (labs_1.glucose_max > vital.glucose_max)) THEN labs_1.glucose_max ELSE labs_1.glucose_max END",
                        "CASE WHEN ((labs_1.glucose_min IS NULL) AND (vital.glucose_min IS NULL)) THEN NULL::double precision WHEN ((labs_1.glucose_min IS NULL) OR (vital.glucose_min < labs_1.glucose_min)) THEN vital.glucose_min WHEN ((vital.glucose_min IS NULL) OR (labs_1.glucose_min < vital.glucose_min)) THEN labs_1.glucose_min ELSE labs_1.glucose_min END",
                        "vent.vent",
                        "uo_1.urineoutput",
                        "gcs.mingcs",
                        "gcs.gcsmotor",
                        "gcs.gcsverbal",
                        "gcs.gcseyes",
                        "gcs.endotrachflag",
                        "arf.arf"
                    ],
                    "Inner Unique": false,
                    "Hash Cond": "(ie_2.icustay_id = uo_1.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Left",
                            "Output": [
                                "ie_2.subject_id",
                                "ie_2.hadm_id",
                                "ie_2.icustay_id",
                                "ie_2.intime",
                                "ie_2.outtime",
                                "pa.pao2",
                                "aa.aado2",
                                "ab.ph",
                                "ab.paco2",
                                "ab.acidbase_score",
                                "arf.arf",
                                "vent.vent",
                                "gcs.mingcs",
                                "gcs.gcsmotor",
                                "gcs.gcsverbal",
                                "gcs.gcseyes",
                                "gcs.endotrachflag",
                                "vital.heartrate_min",
                                "vital.heartrate_max",
                                "vital.meanbp_min",
                                "vital.meanbp_max",
                                "vital.tempc_min",
                                "vital.tempc_max",
                                "vital.resprate_min",
                                "vital.resprate_max",
                                "vital.glucose_max",
                                "vital.glucose_min",
                                "labs_1.hematocrit_min",
                                "labs_1.hematocrit_max",
                                "labs_1.wbc_min",
                                "labs_1.wbc_max",
                                "labs_1.creatinine_min",
                                "labs_1.creatinine_max",
                                "labs_1.bun_min",
                                "labs_1.bun_max",
                                "labs_1.sodium_min",
                                "labs_1.sodium_max",
                                "labs_1.albumin_min",
                                "labs_1.albumin_max",
                                "labs_1.bilirubin_min",
                                "labs_1.bilirubin_max",
                                "labs_1.glucose_max",
                                "labs_1.glucose_min"
                            ],
                            "Inner Unique": false,
                            "Hash Cond": "(ie_2.icustay_id = labs_1.icustay_id)",
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Left",
                                    "Output": [
                                        "ie_2.subject_id",
                                        "ie_2.hadm_id",
                                        "ie_2.icustay_id",
                                        "ie_2.intime",
                                        "ie_2.outtime",
                                        "pa.pao2",
                                        "aa.aado2",
                                        "ab.ph",
                                        "ab.paco2",
                                        "ab.acidbase_score",
                                        "arf.arf",
                                        "vent.vent",
                                        "gcs.mingcs",
                                        "gcs.gcsmotor",
                                        "gcs.gcsverbal",
                                        "gcs.gcseyes",
                                        "gcs.endotrachflag",
                                        "vital.heartrate_min",
                                        "vital.heartrate_max",
                                        "vital.meanbp_min",
                                        "vital.meanbp_max",
                                        "vital.tempc_min",
                                        "vital.tempc_max",
                                        "vital.resprate_min",
                                        "vital.resprate_max",
                                        "vital.glucose_max",
                                        "vital.glucose_min"
                                    ],
                                    "Inner Unique": false,
                                    "Hash Cond": "(ie_2.icustay_id = vital.icustay_id)",
                                    "Plans": [
                                        {
                                            "Node Type": "Hash Join",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Join Type": "Left",
                                            "Output": [
                                                "ie_2.subject_id",
                                                "ie_2.hadm_id",
                                                "ie_2.icustay_id",
                                                "ie_2.intime",
                                                "ie_2.outtime",
                                                "pa.pao2",
                                                "aa.aado2",
                                                "ab.ph",
                                                "ab.paco2",
                                                "ab.acidbase_score",
                                                "arf.arf",
                                                "vent.vent",
                                                "gcs.mingcs",
                                                "gcs.gcsmotor",
                                                "gcs.gcsverbal",
                                                "gcs.gcseyes",
                                                "gcs.endotrachflag"
                                            ],
                                            "Inner Unique": false,
                                            "Hash Cond": "(ie_2.icustay_id = gcs.icustay_id)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Hash Join",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Join Type": "Left",
                                                    "Output": [
                                                        "ie_2.subject_id",
                                                        "ie_2.hadm_id",
                                                        "ie_2.icustay_id",
                                                        "ie_2.intime",
                                                        "ie_2.outtime",
                                                        "pa.pao2",
                                                        "aa.aado2",
                                                        "ab.ph",
                                                        "ab.paco2",
                                                        "ab.acidbase_score",
                                                        "arf.arf",
                                                        "vent.vent"
                                                    ],
                                                    "Inner Unique": false,
                                                    "Hash Cond": "(ie_2.icustay_id = vent.icustay_id)",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Hash Join",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Join Type": "Left",
                                                            "Output": [
                                                                "ie_2.subject_id",
                                                                "ie_2.hadm_id",
                                                                "ie_2.icustay_id",
                                                                "ie_2.intime",
                                                                "ie_2.outtime",
                                                                "pa.pao2",
                                                                "aa.aado2",
                                                                "ab.ph",
                                                                "ab.paco2",
                                                                "ab.acidbase_score",
                                                                "arf.arf"
                                                            ],
                                                            "Inner Unique": false,
                                                            "Hash Cond": "(ie_2.icustay_id = aa.icustay_id)",
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Hash Join",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Join Type": "Inner",
                                                                    "Output": [
                                                                        "ie_2.subject_id",
                                                                        "ie_2.hadm_id",
                                                                        "ie_2.icustay_id",
                                                                        "ie_2.intime",
                                                                        "ie_2.outtime",
                                                                        "pa.pao2",
                                                                        "ab.ph",
                                                                        "ab.paco2",
                                                                        "ab.acidbase_score",
                                                                        "arf.arf"
                                                                    ],
                                                                    "Inner Unique": true,
                                                                    "Hash Cond": "(ie_2.subject_id = pat.subject_id)",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Hash Join",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Join Type": "Inner",
                                                                            "Output": [
                                                                                "ie_2.subject_id",
                                                                                "ie_2.hadm_id",
                                                                                "ie_2.icustay_id",
                                                                                "ie_2.intime",
                                                                                "ie_2.outtime",
                                                                                "pa.pao2",
                                                                                "ab.ph",
                                                                                "ab.paco2",
                                                                                "ab.acidbase_score",
                                                                                "arf.arf"
                                                                            ],
                                                                            "Inner Unique": true,
                                                                            "Hash Cond": "(ie_2.hadm_id = adm.hadm_id)",
                                                                            "Plans": [
                                                                                {
                                                                                    "Node Type": "Hash Join",
                                                                                    "Parent Relationship": "Outer",
                                                                                    "Parallel Aware": false,
                                                                                    "Join Type": "Right",
                                                                                    "Output": [
                                                                                        "ie_2.subject_id",
                                                                                        "ie_2.hadm_id",
                                                                                        "ie_2.icustay_id",
                                                                                        "ie_2.intime",
                                                                                        "ie_2.outtime",
                                                                                        "pa.pao2",
                                                                                        "ab.ph",
                                                                                        "ab.paco2",
                                                                                        "ab.acidbase_score",
                                                                                        "arf.arf"
                                                                                    ],
                                                                                    "Inner Unique": false,
                                                                                    "Hash Cond": "(ab.icustay_id = ie_2.icustay_id)",
                                                                                    "Plans": [
                                                                                        {
                                                                                            "Node Type": "CTE Scan",
                                                                                            "Parent Relationship": "Outer",
                                                                                            "Parallel Aware": false,
                                                                                            "CTE Name": "acidbase_max",
                                                                                            "Alias": "ab",
                                                                                            "Output": [
                                                                                                "ab.ph",
                                                                                                "ab.paco2",
                                                                                                "ab.acidbase_score",
                                                                                                "ab.icustay_id"
                                                                                            ],
                                                                                            "Filter": "(ab.acidbase_rn = 1)"
                                                                                        },
                                                                                        {
                                                                                            "Node Type": "Hash",
                                                                                            "Parent Relationship": "Inner",
                                                                                            "Parallel Aware": false,
                                                                                            "Output": [
                                                                                                "ie_2.subject_id",
                                                                                                "ie_2.hadm_id",
                                                                                                "ie_2.icustay_id",
                                                                                                "ie_2.intime",
                                                                                                "ie_2.outtime",
                                                                                                "pa.pao2",
                                                                                                "arf.arf"
                                                                                            ],
                                                                                            "Plans": [
                                                                                                {
                                                                                                    "Node Type": "Hash Join",
                                                                                                    "Parent Relationship": "Outer",
                                                                                                    "Parallel Aware": false,
                                                                                                    "Join Type": "Right",
                                                                                                    "Output": [
                                                                                                        "ie_2.subject_id",
                                                                                                        "ie_2.hadm_id",
                                                                                                        "ie_2.icustay_id",
                                                                                                        "ie_2.intime",
                                                                                                        "ie_2.outtime",
                                                                                                        "pa.pao2",
                                                                                                        "arf.arf"
                                                                                                    ],
                                                                                                    "Inner Unique": false,
                                                                                                    "Hash Cond": "(pa.icustay_id = ie_2.icustay_id)",
                                                                                                    "Plans": [
                                                                                                        {
                                                                                                            "Node Type": "CTE Scan",
                                                                                                            "Parent Relationship": "Outer",
                                                                                                            "Parallel Aware": false,
                                                                                                            "CTE Name": "pa",
                                                                                                            "Alias": "pa",
                                                                                                            "Output": [
                                                                                                                "pa.pao2",
                                                                                                                "pa.icustay_id"
                                                                                                            ],
                                                                                                            "Filter": "(pa.rn = 1)"
                                                                                                        },
                                                                                                        {
                                                                                                            "Node Type": "Hash",
                                                                                                            "Parent Relationship": "Inner",
                                                                                                            "Parallel Aware": false,
                                                                                                            "Output": [
                                                                                                                "ie_2.subject_id",
                                                                                                                "ie_2.hadm_id",
                                                                                                                "ie_2.icustay_id",
                                                                                                                "ie_2.intime",
                                                                                                                "ie_2.outtime",
                                                                                                                "arf.arf"
                                                                                                            ],
                                                                                                            "Plans": [
                                                                                                                {
                                                                                                                    "Node Type": "Hash Join",
                                                                                                                    "Parent Relationship": "Outer",
                                                                                                                    "Parallel Aware": false,
                                                                                                                    "Join Type": "Right",
                                                                                                                    "Output": [
                                                                                                                        "ie_2.subject_id",
                                                                                                                        "ie_2.hadm_id",
                                                                                                                        "ie_2.icustay_id",
                                                                                                                        "ie_2.intime",
                                                                                                                        "ie_2.outtime",
                                                                                                                        "arf.arf"
                                                                                                                    ],
                                                                                                                    "Inner Unique": true,
                                                                                                                    "Hash Cond": "(arf.icustay_id = ie_2.icustay_id)",
                                                                                                                    "Plans": [
                                                                                                                        {
                                                                                                                            "Node Type": "CTE Scan",
                                                                                                                            "Parent Relationship": "Outer",
                                                                                                                            "Parallel Aware": false,
                                                                                                                            "CTE Name": "arf",
                                                                                                                            "Alias": "arf",
                                                                                                                            "Output": [
                                                                                                                                "arf.arf",
                                                                                                                                "arf.icustay_id"
                                                                                                                            ]
                                                                                                                        },
                                                                                                                        {
                                                                                                                            "Node Type": "Hash",
                                                                                                                            "Parent Relationship": "Inner",
                                                                                                                            "Parallel Aware": false,
                                                                                                                            "Output": [
                                                                                                                                "ie_2.subject_id",
                                                                                                                                "ie_2.hadm_id",
                                                                                                                                "ie_2.icustay_id",
                                                                                                                                "ie_2.intime",
                                                                                                                                "ie_2.outtime"
                                                                                                                            ],
                                                                                                                            "Plans": [
                                                                                                                                {
                                                                                                                                    "Node Type": "Seq Scan",
                                                                                                                                    "Parent Relationship": "Outer",
                                                                                                                                    "Parallel Aware": false,
                                                                                                                                    "Relation Name": "icustays",
                                                                                                                                    "Schema": "mimiciii_clinical",
                                                                                                                                    "Alias": "ie_2",
                                                                                                                                    "Output": [
                                                                                                                                        "ie_2.subject_id",
                                                                                                                                        "ie_2.hadm_id",
                                                                                                                                        "ie_2.icustay_id",
                                                                                                                                        "ie_2.intime",
                                                                                                                                        "ie_2.outtime"
                                                                                                                                    ]
                                                                                                                                }
                                                                                                                            ]
                                                                                                                        }
                                                                                                                    ]
                                                                                                                }
                                                                                                            ]
                                                                                                        }
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "Node Type": "Hash",
                                                                                    "Parent Relationship": "Inner",
                                                                                    "Parallel Aware": false,
                                                                                    "Output": [
                                                                                        "adm.hadm_id"
                                                                                    ],
                                                                                    "Plans": [
                                                                                        {
                                                                                            "Node Type": "Seq Scan",
                                                                                            "Parent Relationship": "Outer",
                                                                                            "Parallel Aware": false,
                                                                                            "Relation Name": "admissions",
                                                                                            "Schema": "mimiciii_clinical",
                                                                                            "Alias": "adm",
                                                                                            "Output": [
                                                                                                "adm.hadm_id"
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "Node Type": "Hash",
                                                                            "Parent Relationship": "Inner",
                                                                            "Parallel Aware": false,
                                                                            "Output": [
                                                                                "pat.subject_id"
                                                                            ],
                                                                            "Plans": [
                                                                                {
                                                                                    "Node Type": "Seq Scan",
                                                                                    "Parent Relationship": "Outer",
                                                                                    "Parallel Aware": false,
                                                                                    "Relation Name": "patients",
                                                                                    "Schema": "mimiciii_clinical",
                                                                                    "Alias": "pat",
                                                                                    "Output": [
                                                                                        "pat.subject_id"
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Hash",
                                                                    "Parent Relationship": "Inner",
                                                                    "Parallel Aware": false,
                                                                    "Output": [
                                                                        "aa.aado2",
                                                                        "aa.icustay_id"
                                                                    ],
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "CTE Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "CTE Name": "aa",
                                                                            "Alias": "aa",
                                                                            "Output": [
                                                                                "aa.aado2",
                                                                                "aa.icustay_id"
                                                                            ],
                                                                            "Filter": "(aa.rn = 1)"
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "Node Type": "Hash",
                                                            "Parent Relationship": "Inner",
                                                            "Parallel Aware": false,
                                                            "Output": [
                                                                "vent.vent",
                                                                "vent.icustay_id"
                                                            ],
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Seq Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Relation Name": "ventilation_first_day",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "vent",
                                                                    "Output": [
                                                                        "vent.vent",
                                                                        "vent.icustay_id"
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "Node Type": "Hash",
                                                    "Parent Relationship": "Inner",
                                                    "Parallel Aware": false,
                                                    "Output": [
                                                        "gcs.mingcs",
                                                        "gcs.gcsmotor",
                                                        "gcs.gcsverbal",
                                                        "gcs.gcseyes",
                                                        "gcs.endotrachflag",
                                                        "gcs.icustay_id"
                                                    ],
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Seq Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "gcs_first_day",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "gcs",
                                                            "Output": [
                                                                "gcs.mingcs",
                                                                "gcs.gcsmotor",
                                                                "gcs.gcsverbal",
                                                                "gcs.gcseyes",
                                                                "gcs.endotrachflag",
                                                                "gcs.icustay_id"
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "vital.heartrate_min",
                                                "vital.heartrate_max",
                                                "vital.meanbp_min",
                                                "vital.meanbp_max",
                                                "vital.tempc_min",
                                                "vital.tempc_max",
                                                "vital.resprate_min",
                                                "vital.resprate_max",
                                                "vital.glucose_max",
                                                "vital.glucose_min",
                                                "vital.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "vitals_first_day",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "vital",
                                                    "Output": [
                                                        "vital.heartrate_min",
                                                        "vital.heartrate_max",
                                                        "vital.meanbp_min",
                                                        "vital.meanbp_max",
                                                        "vital.tempc_min",
                                                        "vital.tempc_max",
                                                        "vital.resprate_min",
                                                        "vital.resprate_max",
                                                        "vital.glucose_max",
                                                        "vital.glucose_min",
                                                        "vital.icustay_id"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "labs_1.hematocrit_min",
                                        "labs_1.hematocrit_max",
                                        "labs_1.wbc_min",
                                        "labs_1.wbc_max",
                                        "labs_1.creatinine_min",
                                        "labs_1.creatinine_max",
                                        "labs_1.bun_min",
                                        "labs_1.bun_max",
                                        "labs_1.sodium_min",
                                        "labs_1.sodium_max",
                                        "labs_1.albumin_min",
                                        "labs_1.albumin_max",
                                        "labs_1.bilirubin_min",
                                        "labs_1.bilirubin_max",
                                        "labs_1.glucose_max",
                                        "labs_1.glucose_min",
                                        "labs_1.icustay_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "labs_first_day",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "labs_1",
                                            "Output": [
                                                "labs_1.hematocrit_min",
                                                "labs_1.hematocrit_max",
                                                "labs_1.wbc_min",
                                                "labs_1.wbc_max",
                                                "labs_1.creatinine_min",
                                                "labs_1.creatinine_max",
                                                "labs_1.bun_min",
                                                "labs_1.bun_max",
                                                "labs_1.sodium_min",
                                                "labs_1.sodium_max",
                                                "labs_1.albumin_min",
                                                "labs_1.albumin_max",
                                                "labs_1.bilirubin_min",
                                                "labs_1.bilirubin_max",
                                                "labs_1.glucose_max",
                                                "labs_1.glucose_min",
                                                "labs_1.icustay_id"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "uo_1.urineoutput",
                                "uo_1.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "urine_output_first_day",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "uo_1",
                                    "Output": [
                                        "uo_1.urineoutput",
                                        "uo_1.icustay_id"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE score_min",
                    "Parallel Aware": false,
                    "CTE Name": "cohort",
                    "Alias": "cohort",
                    "Output": [
                        "cohort.subject_id",
                        "cohort.hadm_id",
                        "cohort.icustay_id",
                        "CASE WHEN (cohort.heartrate_min IS NULL) THEN NULL::integer WHEN (cohort.heartrate_min < '40'::double precision) THEN 8 WHEN (cohort.heartrate_min < '50'::double precision) THEN 5 WHEN (cohort.heartrate_min < '100'::double precision) THEN 0 WHEN (cohort.heartrate_min < '110'::double precision) THEN 1 WHEN (cohort.heartrate_min < '120'::double precision) THEN 5 WHEN (cohort.heartrate_min < '140'::double precision) THEN 7 WHEN (cohort.heartrate_min < '155'::double precision) THEN 13 WHEN (cohort.heartrate_min >= '155'::double precision) THEN 17 ELSE NULL::integer END",
                        "CASE WHEN (cohort.meanbp_min IS NULL) THEN NULL::integer WHEN (cohort.meanbp_min < '40'::double precision) THEN 23 WHEN (cohort.meanbp_min < '60'::double precision) THEN 15 WHEN (cohort.meanbp_min < '70'::double precision) THEN 7 WHEN (cohort.meanbp_min < '80'::double precision) THEN 6 WHEN (cohort.meanbp_min < '100'::double precision) THEN 0 WHEN (cohort.meanbp_min < '120'::double precision) THEN 4 WHEN (cohort.meanbp_min < '130'::double precision) THEN 7 WHEN (cohort.meanbp_min < '140'::double precision) THEN 9 WHEN (cohort.meanbp_min >= '140'::double precision) THEN 10 ELSE NULL::integer END",
                        "CASE WHEN (cohort.tempc_min IS NULL) THEN NULL::integer WHEN (cohort.tempc_min < '33'::double precision) THEN 20 WHEN (cohort.tempc_min < '33.5'::double precision) THEN 16 WHEN (cohort.tempc_min < '34'::double precision) THEN 13 WHEN (cohort.tempc_min < '35'::double precision) THEN 8 WHEN (cohort.tempc_min < '36'::double precision) THEN 2 WHEN (cohort.tempc_min < '40'::double precision) THEN 0 WHEN (cohort.tempc_min >= '40'::double precision) THEN 4 ELSE NULL::integer END",
                        "CASE WHEN (cohort.resprate_min IS NULL) THEN NULL::integer WHEN ((cohort.vent = 1) AND (cohort.resprate_min < '14'::double precision)) THEN 0 WHEN (cohort.resprate_min < '6'::double precision) THEN 17 WHEN (cohort.resprate_min < '12'::double precision) THEN 8 WHEN (cohort.resprate_min < '14'::double precision) THEN 7 WHEN (cohort.resprate_min < '25'::double precision) THEN 0 WHEN (cohort.resprate_min < '35'::double precision) THEN 6 WHEN (cohort.resprate_min < '40'::double precision) THEN 9 WHEN (cohort.resprate_min < '50'::double precision) THEN 11 WHEN (cohort.resprate_min >= '50'::double precision) THEN 18 ELSE NULL::integer END",
                        "CASE WHEN (cohort.hematocrit_min IS NULL) THEN NULL::integer WHEN (cohort.hematocrit_min < '41'::double precision) THEN 3 WHEN (cohort.hematocrit_min < '50'::double precision) THEN 0 WHEN (cohort.hematocrit_min >= '50'::double precision) THEN 3 ELSE NULL::integer END",
                        "CASE WHEN (cohort.wbc_min IS NULL) THEN NULL::integer WHEN (cohort.wbc_min < '1'::double precision) THEN 19 WHEN (cohort.wbc_min < '3'::double precision) THEN 5 WHEN (cohort.wbc_min < '20'::double precision) THEN 0 WHEN (cohort.wbc_min < '25'::double precision) THEN 1 WHEN (cohort.wbc_min >= '25'::double precision) THEN 5 ELSE NULL::integer END",
                        "CASE WHEN (cohort.creatinine_min IS NULL) THEN NULL::integer WHEN ((cohort.arf = 1) AND (cohort.creatinine_min < '1.5'::double precision)) THEN 0 WHEN ((cohort.arf = 1) AND (cohort.creatinine_min >= '1.5'::double precision)) THEN 10 WHEN (cohort.creatinine_min < '0.5'::double precision) THEN 3 WHEN (cohort.creatinine_min < '1.5'::double precision) THEN 0 WHEN (cohort.creatinine_min < '1.95'::double precision) THEN 4 WHEN (cohort.creatinine_min >= '1.95'::double precision) THEN 7 ELSE NULL::integer END",
                        "CASE WHEN (cohort.bun_min IS NULL) THEN NULL::integer WHEN (cohort.bun_min < '17'::double precision) THEN 0 WHEN (cohort.bun_min < '20'::double precision) THEN 2 WHEN (cohort.bun_min < '40'::double precision) THEN 7 WHEN (cohort.bun_min < '80'::double precision) THEN 11 WHEN (cohort.bun_min >= '80'::double precision) THEN 12 ELSE NULL::integer END",
                        "CASE WHEN (cohort.sodium_min IS NULL) THEN NULL::integer WHEN (cohort.sodium_min < '120'::double precision) THEN 3 WHEN (cohort.sodium_min < '135'::double precision) THEN 2 WHEN (cohort.sodium_min < '155'::double precision) THEN 0 WHEN (cohort.sodium_min >= '155'::double precision) THEN 4 ELSE NULL::integer END",
                        "CASE WHEN (cohort.albumin_min IS NULL) THEN NULL::integer WHEN (cohort.albumin_min < '2'::double precision) THEN 11 WHEN (cohort.albumin_min < '2.5'::double precision) THEN 6 WHEN (cohort.albumin_min < '4.5'::double precision) THEN 0 WHEN (cohort.albumin_min >= '4.5'::double precision) THEN 4 ELSE NULL::integer END",
                        "CASE WHEN (cohort.bilirubin_min IS NULL) THEN NULL::integer WHEN (cohort.bilirubin_min < '2'::double precision) THEN 0 WHEN (cohort.bilirubin_min < '3'::double precision) THEN 5 WHEN (cohort.bilirubin_min < '5'::double precision) THEN 6 WHEN (cohort.bilirubin_min < '8'::double precision) THEN 8 WHEN (cohort.bilirubin_min >= '8'::double precision) THEN 16 ELSE NULL::integer END",
                        "CASE WHEN (cohort.glucose_min IS NULL) THEN NULL::integer WHEN (cohort.glucose_min < '40'::double precision) THEN 8 WHEN (cohort.glucose_min < '60'::double precision) THEN 9 WHEN (cohort.glucose_min < '200'::double precision) THEN 0 WHEN (cohort.glucose_min < '350'::double precision) THEN 3 WHEN (cohort.glucose_min >= '350'::double precision) THEN 5 ELSE NULL::integer END"
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE score_max",
                    "Parallel Aware": false,
                    "CTE Name": "cohort",
                    "Alias": "cohort_1",
                    "Output": [
                        "cohort_1.subject_id",
                        "cohort_1.hadm_id",
                        "cohort_1.icustay_id",
                        "CASE WHEN (cohort_1.heartrate_max IS NULL) THEN NULL::integer WHEN (cohort_1.heartrate_max < '40'::double precision) THEN 8 WHEN (cohort_1.heartrate_max < '50'::double precision) THEN 5 WHEN (cohort_1.heartrate_max < '100'::double precision) THEN 0 WHEN (cohort_1.heartrate_max < '110'::double precision) THEN 1 WHEN (cohort_1.heartrate_max < '120'::double precision) THEN 5 WHEN (cohort_1.heartrate_max < '140'::double precision) THEN 7 WHEN (cohort_1.heartrate_max < '155'::double precision) THEN 13 WHEN (cohort_1.heartrate_max >= '155'::double precision) THEN 17 ELSE NULL::integer END",
                        "CASE WHEN (cohort_1.meanbp_max IS NULL) THEN NULL::integer WHEN (cohort_1.meanbp_max < '40'::double precision) THEN 23 WHEN (cohort_1.meanbp_max < '60'::double precision) THEN 15 WHEN (cohort_1.meanbp_max < '70'::double precision) THEN 7 WHEN (cohort_1.meanbp_max < '80'::double precision) THEN 6 WHEN (cohort_1.meanbp_max < '100'::double precision) THEN 0 WHEN (cohort_1.meanbp_max < '120'::double precision) THEN 4 WHEN (cohort_1.meanbp_max < '130'::double precision) THEN 7 WHEN (cohort_1.meanbp_max < '140'::double precision) THEN 9 WHEN (cohort_1.meanbp_max >= '140'::double precision) THEN 10 ELSE NULL::integer END",
                        "CASE WHEN (cohort_1.tempc_max IS NULL) THEN NULL::integer WHEN (cohort_1.tempc_max < '33'::double precision) THEN 20 WHEN (cohort_1.tempc_max < '33.5'::double precision) THEN 16 WHEN (cohort_1.tempc_max < '34'::double precision) THEN 13 WHEN (cohort_1.tempc_max < '35'::double precision) THEN 8 WHEN (cohort_1.tempc_max < '36'::double precision) THEN 2 WHEN (cohort_1.tempc_max < '40'::double precision) THEN 0 WHEN (cohort_1.tempc_max >= '40'::double precision) THEN 4 ELSE NULL::integer END",
                        "CASE WHEN (cohort_1.resprate_max IS NULL) THEN NULL::integer WHEN ((cohort_1.vent = 1) AND (cohort_1.resprate_max < '14'::double precision)) THEN 0 WHEN (cohort_1.resprate_max < '6'::double precision) THEN 17 WHEN (cohort_1.resprate_max < '12'::double precision) THEN 8 WHEN (cohort_1.resprate_max < '14'::double precision) THEN 7 WHEN (cohort_1.resprate_max < '25'::double precision) THEN 0 WHEN (cohort_1.resprate_max < '35'::double precision) THEN 6 WHEN (cohort_1.resprate_max < '40'::double precision) THEN 9 WHEN (cohort_1.resprate_max < '50'::double precision) THEN 11 WHEN (cohort_1.resprate_max >= '50'::double precision) THEN 18 ELSE NULL::integer END",
                        "CASE WHEN (cohort_1.hematocrit_max IS NULL) THEN NULL::integer WHEN (cohort_1.hematocrit_max < '41'::double precision) THEN 3 WHEN (cohort_1.hematocrit_max < '50'::double precision) THEN 0 WHEN (cohort_1.hematocrit_max >= '50'::double precision) THEN 3 ELSE NULL::integer END",
                        "CASE WHEN (cohort_1.wbc_max IS NULL) THEN NULL::integer WHEN (cohort_1.wbc_max < '1'::double precision) THEN 19 WHEN (cohort_1.wbc_max < '3'::double precision) THEN 5 WHEN (cohort_1.wbc_max < '20'::double precision) THEN 0 WHEN (cohort_1.wbc_max < '25'::double precision) THEN 1 WHEN (cohort_1.wbc_max >= '25'::double precision) THEN 5 ELSE NULL::integer END",
                        "CASE WHEN (cohort_1.creatinine_max IS NULL) THEN NULL::integer WHEN ((cohort_1.arf = 1) AND (cohort_1.creatinine_max < '1.5'::double precision)) THEN 0 WHEN ((cohort_1.arf = 1) AND (cohort_1.creatinine_max >= '1.5'::double precision)) THEN 10 WHEN (cohort_1.creatinine_max < '0.5'::double precision) THEN 3 WHEN (cohort_1.creatinine_max < '1.5'::double precision) THEN 0 WHEN (cohort_1.creatinine_max < '1.95'::double precision) THEN 4 WHEN (cohort_1.creatinine_max >= '1.95'::double precision) THEN 7 ELSE NULL::integer END",
                        "CASE WHEN (cohort_1.bun_max IS NULL) THEN NULL::integer WHEN (cohort_1.bun_max < '17'::double precision) THEN 0 WHEN (cohort_1.bun_max < '20'::double precision) THEN 2 WHEN (cohort_1.bun_max < '40'::double precision) THEN 7 WHEN (cohort_1.bun_max < '80'::double precision) THEN 11 WHEN (cohort_1.bun_max >= '80'::double precision) THEN 12 ELSE NULL::integer END",
                        "CASE WHEN (cohort_1.sodium_max IS NULL) THEN NULL::integer WHEN (cohort_1.sodium_max < '120'::double precision) THEN 3 WHEN (cohort_1.sodium_max < '135'::double precision) THEN 2 WHEN (cohort_1.sodium_max < '155'::double precision) THEN 0 WHEN (cohort_1.sodium_max >= '155'::double precision) THEN 4 ELSE NULL::integer END",
                        "CASE WHEN (cohort_1.albumin_max IS NULL) THEN NULL::integer WHEN (cohort_1.albumin_max < '2'::double precision) THEN 11 WHEN (cohort_1.albumin_max < '2.5'::double precision) THEN 6 WHEN (cohort_1.albumin_max < '4.5'::double precision) THEN 0 WHEN (cohort_1.albumin_max >= '4.5'::double precision) THEN 4 ELSE NULL::integer END",
                        "CASE WHEN (cohort_1.bilirubin_max IS NULL) THEN NULL::integer WHEN (cohort_1.bilirubin_max < '2'::double precision) THEN 0 WHEN (cohort_1.bilirubin_max < '3'::double precision) THEN 5 WHEN (cohort_1.bilirubin_max < '5'::double precision) THEN 6 WHEN (cohort_1.bilirubin_max < '8'::double precision) THEN 8 WHEN (cohort_1.bilirubin_max >= '8'::double precision) THEN 16 ELSE NULL::integer END",
                        "CASE WHEN (cohort_1.glucose_max IS NULL) THEN NULL::integer WHEN (cohort_1.glucose_max < '40'::double precision) THEN 8 WHEN (cohort_1.glucose_max < '60'::double precision) THEN 9 WHEN (cohort_1.glucose_max < '200'::double precision) THEN 0 WHEN (cohort_1.glucose_max < '350'::double precision) THEN 3 WHEN (cohort_1.glucose_max >= '350'::double precision) THEN 5 ELSE NULL::integer END"
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE scorecomp",
                    "Parallel Aware": false,
                    "Join Type": "Right",
                    "Output": [
                        "co.subject_id",
                        "co.hadm_id",
                        "co.icustay_id",
                        "co.intime",
                        "co.outtime",
                        "co.heartrate_min",
                        "co.heartrate_max",
                        "co.meanbp_min",
                        "co.meanbp_max",
                        "co.tempc_min",
                        "co.tempc_max",
                        "co.resprate_min",
                        "co.resprate_max",
                        "co.pao2",
                        "co.aado2",
                        "co.ph",
                        "co.paco2",
                        "co.acidbase_score",
                        "co.hematocrit_min",
                        "co.hematocrit_max",
                        "co.wbc_min",
                        "co.wbc_max",
                        "co.creatinine_min",
                        "co.creatinine_max",
                        "co.bun_min",
                        "co.bun_max",
                        "co.sodium_min",
                        "co.sodium_max",
                        "co.albumin_min",
                        "co.albumin_max",
                        "co.bilirubin_min",
                        "co.bilirubin_max",
                        "co.glucose_max",
                        "co.glucose_min",
                        "co.vent",
                        "co.urineoutput",
                        "co.mingcs",
                        "co.gcsmotor",
                        "co.gcsverbal",
                        "co.gcseyes",
                        "co.endotrachflag",
                        "co.arf",
                        "CASE WHEN (co.heartrate_max IS NULL) THEN NULL::integer WHEN (abs((co.heartrate_max - '75'::double precision)) > abs((co.heartrate_min - '75'::double precision))) THEN smax.hr_score WHEN (abs((co.heartrate_max - '75'::double precision)) < abs((co.heartrate_min - '75'::double precision))) THEN smin.hr_score WHEN ((abs((co.heartrate_max - '75'::double precision)) = abs((co.heartrate_min - '75'::double precision))) AND (smax.hr_score >= smin.hr_score)) THEN smax.hr_score WHEN ((abs((co.heartrate_max - '75'::double precision)) = abs((co.heartrate_min - '75'::double precision))) AND (smax.hr_score < smin.hr_score)) THEN smin.hr_score ELSE NULL::integer END",
                        "CASE WHEN (co.meanbp_max IS NULL) THEN NULL::integer WHEN (abs((co.meanbp_max - '90'::double precision)) > abs((co.meanbp_min - '90'::double precision))) THEN smax.meanbp_score WHEN (abs((co.meanbp_max - '90'::double precision)) < abs((co.meanbp_min - '90'::double precision))) THEN smin.meanbp_score WHEN ((abs((co.meanbp_max - '90'::double precision)) = abs((co.meanbp_min - '90'::double precision))) AND (smax.meanbp_score >= smin.meanbp_score)) THEN smax.meanbp_score WHEN ((abs((co.meanbp_max - '90'::double precision)) = abs((co.meanbp_min - '90'::double precision))) AND (smax.meanbp_score < smin.meanbp_score)) THEN smin.meanbp_score ELSE NULL::integer END",
                        "CASE WHEN (co.tempc_max IS NULL) THEN NULL::integer WHEN (abs((co.tempc_max - '38'::double precision)) > abs((co.tempc_min - '38'::double precision))) THEN smax.temp_score WHEN (abs((co.tempc_max - '38'::double precision)) < abs((co.tempc_min - '38'::double precision))) THEN smin.temp_score WHEN ((abs((co.tempc_max - '38'::double precision)) = abs((co.tempc_min - '38'::double precision))) AND (smax.temp_score >= smin.temp_score)) THEN smax.temp_score WHEN ((abs((co.tempc_max - '38'::double precision)) = abs((co.tempc_min - '38'::double precision))) AND (smax.temp_score < smin.temp_score)) THEN smin.temp_score ELSE NULL::integer END",
                        "CASE WHEN (co.resprate_max IS NULL) THEN NULL::integer WHEN (abs((co.resprate_max - '19'::double precision)) > abs((co.resprate_min - '19'::double precision))) THEN smax.resprate_score WHEN (abs((co.resprate_max - '19'::double precision)) < abs((co.resprate_min - '19'::double precision))) THEN smin.resprate_score WHEN ((abs((co.resprate_max - '19'::double precision)) = abs((co.resprate_max - '19'::double precision))) AND (smax.resprate_score >= smin.resprate_score)) THEN smax.resprate_score WHEN ((abs((co.resprate_max - '19'::double precision)) = abs((co.resprate_max - '19'::double precision))) AND (smax.resprate_score < smin.resprate_score)) THEN smin.resprate_score ELSE NULL::integer END",
                        "CASE WHEN (co.hematocrit_max IS NULL) THEN NULL::integer WHEN (abs((co.hematocrit_max - '45.5'::double precision)) > abs((co.hematocrit_min - '45.5'::double precision))) THEN smax.hematocrit_score WHEN (abs((co.hematocrit_max - '45.5'::double precision)) < abs((co.hematocrit_min - '45.5'::double precision))) THEN smin.hematocrit_score WHEN ((abs((co.hematocrit_max - '45.5'::double precision)) = abs((co.hematocrit_max - '45.5'::double precision))) AND (smax.hematocrit_score >= smin.hematocrit_score)) THEN smax.hematocrit_score WHEN ((abs((co.hematocrit_max - '45.5'::double precision)) = abs((co.hematocrit_max - '45.5'::double precision))) AND (smax.hematocrit_score < smin.hematocrit_score)) THEN smin.hematocrit_score ELSE NULL::integer END",
                        "CASE WHEN (co.wbc_max IS NULL) THEN NULL::integer WHEN (abs((co.wbc_max - '11.5'::double precision)) > abs((co.wbc_min - '11.5'::double precision))) THEN smax.wbc_score WHEN (abs((co.wbc_max - '11.5'::double precision)) < abs((co.wbc_min - '11.5'::double precision))) THEN smin.wbc_score WHEN ((abs((co.wbc_max - '11.5'::double precision)) = abs((co.wbc_max - '11.5'::double precision))) AND (smax.wbc_score >= smin.wbc_score)) THEN smax.wbc_score WHEN ((abs((co.wbc_max - '11.5'::double precision)) = abs((co.wbc_max - '11.5'::double precision))) AND (smax.wbc_score < smin.wbc_score)) THEN smin.wbc_score ELSE NULL::integer END",
                        "CASE WHEN (co.creatinine_max IS NULL) THEN NULL::integer WHEN (co.arf = 1) THEN smax.creatinine_score WHEN (abs((co.creatinine_max - '1'::double precision)) > abs((co.creatinine_min - '1'::double precision))) THEN smax.creatinine_score WHEN (abs((co.creatinine_max - '1'::double precision)) < abs((co.creatinine_min - '1'::double precision))) THEN smin.creatinine_score WHEN (smax.creatinine_score >= smin.creatinine_score) THEN smax.creatinine_score WHEN (smax.creatinine_score < smin.creatinine_score) THEN smin.creatinine_score ELSE NULL::integer END",
                        "CASE WHEN (co.bun_max IS NULL) THEN NULL::integer ELSE smax.bun_score END",
                        "CASE WHEN (co.sodium_max IS NULL) THEN NULL::integer WHEN (abs((co.sodium_max - '145.5'::double precision)) > abs((co.sodium_min - '145.5'::double precision))) THEN smax.sodium_score WHEN (abs((co.sodium_max - '145.5'::double precision)) < abs((co.sodium_min - '145.5'::double precision))) THEN smin.sodium_score WHEN ((abs((co.sodium_max - '145.5'::double precision)) = abs((co.sodium_max - '145.5'::double precision))) AND (smax.sodium_score >= smin.sodium_score)) THEN smax.sodium_score WHEN ((abs((co.sodium_max - '145.5'::double precision)) = abs((co.sodium_max - '145.5'::double precision))) AND (smax.sodium_score < smin.sodium_score)) THEN smin.sodium_score ELSE NULL::integer END",
                        "CASE WHEN (co.albumin_max IS NULL) THEN NULL::integer WHEN (abs((co.albumin_max - '3.5'::double precision)) > abs((co.albumin_min - '3.5'::double precision))) THEN smax.albumin_score WHEN (abs((co.albumin_max - '3.5'::double precision)) < abs((co.albumin_min - '3.5'::double precision))) THEN smin.albumin_score WHEN ((abs((co.albumin_max - '3.5'::double precision)) = abs((co.albumin_max - '3.5'::double precision))) AND (smax.albumin_score >= smin.albumin_score)) THEN smax.albumin_score WHEN ((abs((co.albumin_max - '3.5'::double precision)) = abs((co.albumin_max - '3.5'::double precision))) AND (smax.albumin_score < smin.albumin_score)) THEN smin.albumin_score ELSE NULL::integer END",
                        "CASE WHEN (co.bilirubin_max IS NULL) THEN NULL::integer ELSE smax.bilirubin_score END",
                        "CASE WHEN (co.glucose_max IS NULL) THEN NULL::integer WHEN (abs((co.glucose_max - '130'::double precision)) > abs((co.glucose_min - '130'::double precision))) THEN smax.glucose_score WHEN (abs((co.glucose_max - '130'::double precision)) < abs((co.glucose_min - '130'::double precision))) THEN smin.glucose_score WHEN ((abs((co.glucose_max - '130'::double precision)) = abs((co.glucose_max - '130'::double precision))) AND (smax.glucose_score >= smin.glucose_score)) THEN smax.glucose_score WHEN ((abs((co.glucose_max - '130'::double precision)) = abs((co.glucose_max - '130'::double precision))) AND (smax.glucose_score < smin.glucose_score)) THEN smin.glucose_score ELSE NULL::integer END",
                        "CASE WHEN (co.urineoutput IS NULL) THEN NULL::integer WHEN (co.urineoutput < '400'::double precision) THEN 15 WHEN (co.urineoutput < '600'::double precision) THEN 8 WHEN (co.urineoutput < '900'::double precision) THEN 7 WHEN (co.urineoutput < '1500'::double precision) THEN 5 WHEN (co.urineoutput < '2000'::double precision) THEN 4 WHEN (co.urineoutput < '4000'::double precision) THEN 0 WHEN (co.urineoutput >= '4000'::double precision) THEN 1 ELSE NULL::integer END",
                        "CASE WHEN (co.endotrachflag = 1) THEN 0 WHEN (co.gcseyes = '1'::double precision) THEN CASE WHEN ((co.gcsverbal = '1'::double precision) AND (co.gcsmotor = ANY ('{1,2}'::double precision[]))) THEN 48 WHEN ((co.gcsverbal = '1'::double precision) AND (co.gcsmotor = ANY ('{3,4}'::double precision[]))) THEN 33 WHEN ((co.gcsverbal = '1'::double precision) AND (co.gcsmotor = ANY ('{5,6}'::double precision[]))) THEN 16 WHEN ((co.gcsverbal = ANY ('{2,3}'::double precision[])) AND (co.gcsmotor = ANY ('{1,2}'::double precision[]))) THEN 29 WHEN ((co.gcsverbal = ANY ('{2,3}'::double precision[])) AND (co.gcsmotor = ANY ('{3,4}'::double precision[]))) THEN 24 WHEN ((co.gcsverbal = ANY ('{2,3}'::double precision[])) AND (co.gcsmotor >= '5'::double precision)) THEN NULL::integer WHEN (co.gcsverbal >= '4'::double precision) THEN NULL::integer ELSE NULL::integer END WHEN (co.gcseyes > '1'::double precision) THEN CASE WHEN ((co.gcsverbal = '1'::double precision) AND (co.gcsmotor = ANY ('{1,2}'::double precision[]))) THEN 29 WHEN ((co.gcsverbal = '1'::double precision) AND (co.gcsmotor = ANY ('{3,4}'::double precision[]))) THEN 24 WHEN ((co.gcsverbal = '1'::double precision) AND (co.gcsmotor = ANY ('{5,6}'::double precision[]))) THEN 15 WHEN ((co.gcsverbal = ANY ('{2,3}'::double precision[])) AND (co.gcsmotor = ANY ('{1,2}'::double precision[]))) THEN 29 WHEN ((co.gcsverbal = ANY ('{2,3}'::double precision[])) AND (co.gcsmotor = ANY ('{3,4}'::double precision[]))) THEN 24 WHEN ((co.gcsverbal = ANY ('{2,3}'::double precision[])) AND (co.gcsmotor = '5'::double precision)) THEN 13 WHEN ((co.gcsverbal = ANY ('{2,3}'::double precision[])) AND (co.gcsmotor = '6'::double precision)) THEN 10 WHEN ((co.gcsverbal = '4'::double precision) AND (co.gcsmotor = ANY ('{1,2,3,4}'::double precision[]))) THEN 13 WHEN ((co.gcsverbal = '4'::double precision) AND (co.gcsmotor = '5'::double precision)) THEN 8 WHEN ((co.gcsverbal = '4'::double precision) AND (co.gcsmotor = '6'::double precision)) THEN 3 WHEN ((co.gcsverbal = '5'::double precision) AND (co.gcsmotor = ANY ('{1,2,3,4,5}'::double precision[]))) THEN 3 WHEN ((co.gcsverbal = '5'::double precision) AND (co.gcsmotor = '6'::double precision)) THEN 0 ELSE NULL::integer END ELSE NULL::integer END",
                        "CASE WHEN ((co.pao2 IS NULL) AND (co.aado2 IS NULL)) THEN NULL::integer WHEN (co.pao2 IS NOT NULL) THEN CASE WHEN (co.pao2 < '50'::double precision) THEN 15 WHEN (co.pao2 < '70'::double precision) THEN 5 WHEN (co.pao2 < '80'::double precision) THEN 2 ELSE 0 END WHEN (co.aado2 IS NOT NULL) THEN CASE WHEN (co.aado2 < '100'::double precision) THEN 0 WHEN (co.aado2 < '250'::double precision) THEN 7 WHEN (co.aado2 < '350'::double precision) THEN 9 WHEN (co.aado2 < '500'::double precision) THEN 11 WHEN (co.aado2 >= '500'::double precision) THEN 14 ELSE 0 END ELSE NULL::integer END"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "(smax.icustay_id = co.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "smax.hr_score",
                                "smax.meanbp_score",
                                "smax.temp_score",
                                "smax.resprate_score",
                                "smax.hematocrit_score",
                                "smax.wbc_score",
                                "smax.creatinine_score",
                                "smax.bun_score",
                                "smax.sodium_score",
                                "smax.albumin_score",
                                "smax.bilirubin_score",
                                "smax.glucose_score",
                                "smax.icustay_id"
                            ],
                            "Sort Key": [
                                "smax.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "score_max",
                                    "Alias": "smax",
                                    "Output": [
                                        "smax.hr_score",
                                        "smax.meanbp_score",
                                        "smax.temp_score",
                                        "smax.resprate_score",
                                        "smax.hematocrit_score",
                                        "smax.wbc_score",
                                        "smax.creatinine_score",
                                        "smax.bun_score",
                                        "smax.sodium_score",
                                        "smax.albumin_score",
                                        "smax.bilirubin_score",
                                        "smax.glucose_score",
                                        "smax.icustay_id"
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Materialize",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "co.subject_id",
                                "co.hadm_id",
                                "co.icustay_id",
                                "co.intime",
                                "co.outtime",
                                "co.heartrate_min",
                                "co.heartrate_max",
                                "co.meanbp_min",
                                "co.meanbp_max",
                                "co.tempc_min",
                                "co.tempc_max",
                                "co.resprate_min",
                                "co.resprate_max",
                                "co.pao2",
                                "co.aado2",
                                "co.ph",
                                "co.paco2",
                                "co.acidbase_score",
                                "co.hematocrit_min",
                                "co.hematocrit_max",
                                "co.wbc_min",
                                "co.wbc_max",
                                "co.creatinine_min",
                                "co.creatinine_max",
                                "co.bun_min",
                                "co.bun_max",
                                "co.sodium_min",
                                "co.sodium_max",
                                "co.albumin_min",
                                "co.albumin_max",
                                "co.bilirubin_min",
                                "co.bilirubin_max",
                                "co.glucose_max",
                                "co.glucose_min",
                                "co.vent",
                                "co.urineoutput",
                                "co.mingcs",
                                "co.gcsmotor",
                                "co.gcsverbal",
                                "co.gcseyes",
                                "co.endotrachflag",
                                "co.arf",
                                "smin.hr_score",
                                "smin.meanbp_score",
                                "smin.temp_score",
                                "smin.resprate_score",
                                "smin.hematocrit_score",
                                "smin.wbc_score",
                                "smin.creatinine_score",
                                "smin.sodium_score",
                                "smin.albumin_score",
                                "smin.glucose_score"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Merge Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Left",
                                    "Output": [
                                        "co.subject_id",
                                        "co.hadm_id",
                                        "co.icustay_id",
                                        "co.intime",
                                        "co.outtime",
                                        "co.heartrate_min",
                                        "co.heartrate_max",
                                        "co.meanbp_min",
                                        "co.meanbp_max",
                                        "co.tempc_min",
                                        "co.tempc_max",
                                        "co.resprate_min",
                                        "co.resprate_max",
                                        "co.pao2",
                                        "co.aado2",
                                        "co.ph",
                                        "co.paco2",
                                        "co.acidbase_score",
                                        "co.hematocrit_min",
                                        "co.hematocrit_max",
                                        "co.wbc_min",
                                        "co.wbc_max",
                                        "co.creatinine_min",
                                        "co.creatinine_max",
                                        "co.bun_min",
                                        "co.bun_max",
                                        "co.sodium_min",
                                        "co.sodium_max",
                                        "co.albumin_min",
                                        "co.albumin_max",
                                        "co.bilirubin_min",
                                        "co.bilirubin_max",
                                        "co.glucose_max",
                                        "co.glucose_min",
                                        "co.vent",
                                        "co.urineoutput",
                                        "co.mingcs",
                                        "co.gcsmotor",
                                        "co.gcsverbal",
                                        "co.gcseyes",
                                        "co.endotrachflag",
                                        "co.arf",
                                        "smin.hr_score",
                                        "smin.meanbp_score",
                                        "smin.temp_score",
                                        "smin.resprate_score",
                                        "smin.hematocrit_score",
                                        "smin.wbc_score",
                                        "smin.creatinine_score",
                                        "smin.sodium_score",
                                        "smin.albumin_score",
                                        "smin.glucose_score"
                                    ],
                                    "Inner Unique": false,
                                    "Merge Cond": "(co.icustay_id = smin.icustay_id)",
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "co.subject_id",
                                                "co.hadm_id",
                                                "co.icustay_id",
                                                "co.intime",
                                                "co.outtime",
                                                "co.heartrate_min",
                                                "co.heartrate_max",
                                                "co.meanbp_min",
                                                "co.meanbp_max",
                                                "co.tempc_min",
                                                "co.tempc_max",
                                                "co.resprate_min",
                                                "co.resprate_max",
                                                "co.pao2",
                                                "co.aado2",
                                                "co.ph",
                                                "co.paco2",
                                                "co.acidbase_score",
                                                "co.hematocrit_min",
                                                "co.hematocrit_max",
                                                "co.wbc_min",
                                                "co.wbc_max",
                                                "co.creatinine_min",
                                                "co.creatinine_max",
                                                "co.bun_min",
                                                "co.bun_max",
                                                "co.sodium_min",
                                                "co.sodium_max",
                                                "co.albumin_min",
                                                "co.albumin_max",
                                                "co.bilirubin_min",
                                                "co.bilirubin_max",
                                                "co.glucose_max",
                                                "co.glucose_min",
                                                "co.vent",
                                                "co.urineoutput",
                                                "co.mingcs",
                                                "co.gcsmotor",
                                                "co.gcsverbal",
                                                "co.gcseyes",
                                                "co.endotrachflag",
                                                "co.arf"
                                            ],
                                            "Sort Key": [
                                                "co.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "cohort",
                                                    "Alias": "co",
                                                    "Output": [
                                                        "co.subject_id",
                                                        "co.hadm_id",
                                                        "co.icustay_id",
                                                        "co.intime",
                                                        "co.outtime",
                                                        "co.heartrate_min",
                                                        "co.heartrate_max",
                                                        "co.meanbp_min",
                                                        "co.meanbp_max",
                                                        "co.tempc_min",
                                                        "co.tempc_max",
                                                        "co.resprate_min",
                                                        "co.resprate_max",
                                                        "co.pao2",
                                                        "co.aado2",
                                                        "co.ph",
                                                        "co.paco2",
                                                        "co.acidbase_score",
                                                        "co.hematocrit_min",
                                                        "co.hematocrit_max",
                                                        "co.wbc_min",
                                                        "co.wbc_max",
                                                        "co.creatinine_min",
                                                        "co.creatinine_max",
                                                        "co.bun_min",
                                                        "co.bun_max",
                                                        "co.sodium_min",
                                                        "co.sodium_max",
                                                        "co.albumin_min",
                                                        "co.albumin_max",
                                                        "co.bilirubin_min",
                                                        "co.bilirubin_max",
                                                        "co.glucose_max",
                                                        "co.glucose_min",
                                                        "co.vent",
                                                        "co.urineoutput",
                                                        "co.mingcs",
                                                        "co.gcsmotor",
                                                        "co.gcsverbal",
                                                        "co.gcseyes",
                                                        "co.endotrachflag",
                                                        "co.arf"
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Materialize",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "smin.hr_score",
                                                "smin.meanbp_score",
                                                "smin.temp_score",
                                                "smin.resprate_score",
                                                "smin.hematocrit_score",
                                                "smin.wbc_score",
                                                "smin.creatinine_score",
                                                "smin.sodium_score",
                                                "smin.albumin_score",
                                                "smin.glucose_score",
                                                "smin.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Sort",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Output": [
                                                        "smin.hr_score",
                                                        "smin.meanbp_score",
                                                        "smin.temp_score",
                                                        "smin.resprate_score",
                                                        "smin.hematocrit_score",
                                                        "smin.wbc_score",
                                                        "smin.creatinine_score",
                                                        "smin.sodium_score",
                                                        "smin.albumin_score",
                                                        "smin.glucose_score",
                                                        "smin.icustay_id"
                                                    ],
                                                    "Sort Key": [
                                                        "smin.icustay_id"
                                                    ],
                                                    "Plans": [
                                                        {
                                                            "Node Type": "CTE Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "CTE Name": "score_min",
                                                            "Alias": "smin",
                                                            "Output": [
                                                                "smin.hr_score",
                                                                "smin.meanbp_score",
                                                                "smin.temp_score",
                                                                "smin.resprate_score",
                                                                "smin.hematocrit_score",
                                                                "smin.wbc_score",
                                                                "smin.creatinine_score",
                                                                "smin.sodium_score",
                                                                "smin.albumin_score",
                                                                "smin.glucose_score",
                                                                "smin.icustay_id"
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE score",
                    "Parallel Aware": false,
                    "CTE Name": "scorecomp",
                    "Alias": "s_1",
                    "Output": [
                        "s_1.subject_id",
                        "s_1.hadm_id",
                        "s_1.icustay_id",
                        "s_1.intime",
                        "s_1.outtime",
                        "s_1.heartrate_min",
                        "s_1.heartrate_max",
                        "s_1.meanbp_min",
                        "s_1.meanbp_max",
                        "s_1.tempc_min",
                        "s_1.tempc_max",
                        "s_1.resprate_min",
                        "s_1.resprate_max",
                        "s_1.pao2",
                        "s_1.aado2",
                        "s_1.ph",
                        "s_1.paco2",
                        "s_1.acidbase_score",
                        "s_1.hematocrit_min",
                        "s_1.hematocrit_max",
                        "s_1.wbc_min",
                        "s_1.wbc_max",
                        "s_1.creatinine_min",
                        "s_1.creatinine_max",
                        "s_1.bun_min",
                        "s_1.bun_max",
                        "s_1.sodium_min",
                        "s_1.sodium_max",
                        "s_1.albumin_min",
                        "s_1.albumin_max",
                        "s_1.bilirubin_min",
                        "s_1.bilirubin_max",
                        "s_1.glucose_max",
                        "s_1.glucose_min",
                        "s_1.vent",
                        "s_1.urineoutput",
                        "s_1.mingcs",
                        "s_1.gcsmotor",
                        "s_1.gcsverbal",
                        "s_1.gcseyes",
                        "s_1.endotrachflag",
                        "s_1.arf",
                        "s_1.hr_score",
                        "s_1.meanbp_score",
                        "s_1.temp_score",
                        "s_1.resprate_score",
                        "s_1.hematocrit_score",
                        "s_1.wbc_score",
                        "s_1.creatinine_score",
                        "s_1.bun_score",
                        "s_1.sodium_score",
                        "s_1.albumin_score",
                        "s_1.bilirubin_score",
                        "s_1.glucose_score",
                        "s_1.uo_score",
                        "s_1.gcs_score",
                        "s_1.pao2_aado2_score",
                        "(((((((((((((((COALESCE(s_1.hr_score, 0) + COALESCE(s_1.meanbp_score, 0)) + COALESCE(s_1.temp_score, 0)) + COALESCE(s_1.resprate_score, 0)) + COALESCE(s_1.pao2_aado2_score, 0)) + COALESCE(s_1.hematocrit_score, 0)) + COALESCE(s_1.wbc_score, 0)) + COALESCE(s_1.creatinine_score, 0)) + COALESCE(s_1.uo_score, 0)) + COALESCE(s_1.bun_score, 0)) + COALESCE(s_1.sodium_score, 0)) + COALESCE(s_1.albumin_score, 0)) + COALESCE(s_1.bilirubin_score, 0)) + COALESCE(s_1.glucose_score, 0)) + COALESCE(s_1.acidbase_score, 0)) + COALESCE(s_1.gcs_score, 0))"
                    ]
                },
                {
                    "Node Type": "Index Scan",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Scan Direction": "Forward",
                    "Index Name": "icustays_idx02",
                    "Relation Name": "icustays",
                    "Schema": "mimiciii_clinical",
                    "Alias": "ie",
                    "Output": [
                        "ie.row_id",
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id",
                        "ie.dbsource",
                        "ie.first_careunit",
                        "ie.last_careunit",
                        "ie.first_wardid",
                        "ie.last_wardid",
                        "ie.intime",
                        "ie.outtime",
                        "ie.los"
                    ]
                },
                {
                    "Node Type": "Materialize",
                    "Parent Relationship": "Inner",
                    "Parallel Aware": false,
                    "Output": [
                        "s.apsiii",
                        "s.hr_score",
                        "s.meanbp_score",
                        "s.temp_score",
                        "s.resprate_score",
                        "s.pao2_aado2_score",
                        "s.hematocrit_score",
                        "s.wbc_score",
                        "s.creatinine_score",
                        "s.uo_score",
                        "s.bun_score",
                        "s.sodium_score",
                        "s.albumin_score",
                        "s.bilirubin_score",
                        "s.glucose_score",
                        "s.acidbase_score",
                        "s.gcs_score",
                        "s.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "s.apsiii",
                                "s.hr_score",
                                "s.meanbp_score",
                                "s.temp_score",
                                "s.resprate_score",
                                "s.pao2_aado2_score",
                                "s.hematocrit_score",
                                "s.wbc_score",
                                "s.creatinine_score",
                                "s.uo_score",
                                "s.bun_score",
                                "s.sodium_score",
                                "s.albumin_score",
                                "s.bilirubin_score",
                                "s.glucose_score",
                                "s.acidbase_score",
                                "s.gcs_score",
                                "s.icustay_id"
                            ],
                            "Sort Key": [
                                "s.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "CTE Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "CTE Name": "score",
                                    "Alias": "s",
                                    "Output": [
                                        "s.apsiii",
                                        "s.hr_score",
                                        "s.meanbp_score",
                                        "s.temp_score",
                                        "s.resprate_score",
                                        "s.pao2_aado2_score",
                                        "s.hematocrit_score",
                                        "s.wbc_score",
                                        "s.creatinine_score",
                                        "s.uo_score",
                                        "s.bun_score",
                                        "s.sodium_score",
                                        "s.albumin_score",
                                        "s.bilirubin_score",
                                        "s.glucose_score",
                                        "s.acidbase_score",
                                        "s.gcs_score",
                                        "s.icustay_id"
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.lods": {
        "sql": "-- ------------------------------------------------------------------\n-- Title: Logistic Organ Dysfunction Score (LODS)\n-- This query extracts the logistic organ dysfunction system.\n-- This score is a measure of organ failure in a patient.\n-- The score is calculated on the first day of each ICU patients' stay.\n-- ------------------------------------------------------------------\n\n-- Reference for LODS:\n--  Le Gall, J. R., Klar, J., Lemeshow, S., Saulnier, F., Alberti, C., Artigas, A., & Teres, D.\n--  The Logistic Organ Dysfunction system: a new way to assess organ dysfunction in the intensive care unit.\n--  JAMA 276.10 (1996): 802-810.\n\n-- Variables used in LODS:\n--  GCS\n--  VITALS: Heart rate, systolic blood pressure\n--  FLAGS: ventilation/cpap\n--  IO: urine output\n--  LABS: blood urea nitrogen, WBC, bilirubin, creatinine, prothrombin time (PT), platelets\n--  ABG: PaO2 with associated FiO2\n\n-- The following views are required to run this query:\n--  1) urine_output_first_day - generated by urine-output-first-day.sql\n--  2) ventilation_durations - generated by ventilation_durations.sql\n--  3) vitals_first_day - generated by vitals-first-day.sql\n--  4) gcs_first_day - generated by gcs-first-day.sql\n--  5) labs_first_day - generated by labs-first-day.sql\n--  5) blood_gas_first_day_arterial - generated by blood-gas-first-day-arterial.sql\n\n-- Note:\n--  The score is calculated for *all* ICU patients, with the assumption that the user will subselect appropriate ICUSTAY_IDs.\n--  For example, the score is calculated for neonates, but it is likely inappropriate to actually use the score values for these patients.\n\n-- extract CPAP from the \"Oxygen Delivery Device\" fields\nwith cpap as\n(\n  select ie.icustay_id\n    , min(DATETIME_SUB(charttime, INTERVAL '1' HOUR)) as starttime\n    , max(DATETIME_ADD(charttime, INTERVAL '4' HOUR)) as endtime\n    , max(CASE\n          WHEN lower(ce.value) LIKE '%cpap%' THEN 1\n          WHEN lower(ce.value) LIKE '%bipap mask%' THEN 1\n        else 0 end) as cpap\n  FROM icustays ie\n  inner join chartevents ce\n    on ie.icustay_id = ce.icustay_id\n    and ce.charttime between ie.intime and DATETIME_ADD(ie.intime, INTERVAL '1' DAY)\n  where itemid in\n  (\n    -- TODO: when metavision data import fixed, check the values in 226732 match the value clause below\n    467, 469, 226732\n  )\n  and (lower(ce.value) LIKE '%cpap%' or lower(ce.value) LIKE '%bipap mask%')\n  -- exclude rows marked as error\n  AND (ce.error IS NULL OR ce.error = 0)\n  group by ie.icustay_id\n)\n, pafi1 as\n(\n  -- join blood gas to ventilation durations to determine if patient was vent\n  -- also join to cpap table for the same purpose\n  select bg.icustay_id, bg.charttime\n  , pao2fio2\n  , case when vd.icustay_id is not null then 1 else 0 end as vent\n  , case when cp.icustay_id is not null then 1 else 0 end as cpap\n  from \"mimic\".\"mimiciii_clinical\".\"blood_gas_first_day_arterial\" bg\n  left join \"mimic\".\"mimiciii_clinical\".\"ventilation_durations\" vd\n    on bg.icustay_id = vd.icustay_id\n    and bg.charttime >= vd.starttime\n    and bg.charttime <= vd.endtime\n  left join cpap cp\n    on bg.icustay_id = cp.icustay_id\n    and bg.charttime >= cp.starttime\n    and bg.charttime <= cp.endtime\n)\n, pafi2 as\n(\n  -- get the minimum PaO2/FiO2 ratio *only for ventilated/cpap patients*\n  select icustay_id\n  , min(pao2fio2) as pao2fio2_vent_min\n  from pafi1\n  where vent = 1 or cpap = 1\n  group by icustay_id\n)\n, cohort as\n(\nselect  ie.subject_id\n      , ie.hadm_id\n      , ie.icustay_id\n      , ie.intime\n      , ie.outtime\n\n      , gcs.mingcs\n      , vital.heartrate_max\n      , vital.heartrate_min\n      , vital.sysbp_max\n      , vital.sysbp_min\n\n      -- this value is non-null iff the patient is on vent/cpap\n      , pf.pao2fio2_vent_min\n\n      , labs.bun_max\n      , labs.bun_min\n      , labs.wbc_max\n      , labs.wbc_min\n      , labs.bilirubin_max\n      , labs.creatinine_max\n      , labs.pt_min\n      , labs.pt_max\n      , labs.platelet_min\n\n      , uo.urineoutput\n\nFROM icustays ie\ninner join admissions adm\n  on ie.hadm_id = adm.hadm_id\ninner join patients pat\n  on ie.subject_id = pat.subject_id\n\n-- join to above view to get pao2/fio2 ratio\nleft join pafi2 pf\n  on ie.icustay_id = pf.icustay_id\n\n-- join to custom tables to get more data....\nleft join \"mimic\".\"mimiciii_clinical\".\"gcs_first_day\" gcs\n  on ie.icustay_id = gcs.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"vitals_first_day\" vital\n  on ie.icustay_id = vital.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"urine_output_first_day\" uo\n  on ie.icustay_id = uo.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"labs_first_day\" labs\n  on ie.icustay_id = labs.icustay_id\n)\n, scorecomp as\n(\nselect\n  cohort.*\n  -- Below code calculates the component scores needed for SAPS\n\n  -- neurologic\n  , case\n    when mingcs is null then null\n      when mingcs <  3 then null -- erroneous value/on trach\n      when mingcs <=  5 then 5\n      when mingcs <=  8 then 3\n      when mingcs <= 13 then 1\n    else 0\n  end as neurologic\n\n  -- cardiovascular\n  , case\n      when heartrate_max is null\n      and sysbp_min is null then null\n      when heartrate_min < 30 then 5\n      when sysbp_min < 40 then 5\n      when sysbp_min <  70 then 3\n      when sysbp_max >= 270 then 3\n      when heartrate_max >= 140 then 1\n      when sysbp_max >= 240 then 1\n      when sysbp_min < 90 then 1\n    else 0\n  end as cardiovascular\n\n  -- renal\n  , case\n      when bun_max is null\n        or urineoutput is null\n        or creatinine_max is null\n        then null\n      when urineoutput <   500.0 then 5\n      when bun_max >= 56.0 then 5\n      when creatinine_max >= 1.60 then 3\n      when urineoutput <   750.0 then 3\n      when bun_max >= 28.0 then 3\n      when urineoutput >= 10000.0 then 3\n      when creatinine_max >= 1.20 then 1\n      when bun_max >= 17.0 then 1\n      when bun_max >= 7.50 then 1\n    else 0\n  end as renal\n\n  -- pulmonary\n  , case\n      when pao2fio2_vent_min is null then 0\n      when pao2fio2_vent_min >= 150 then 1\n      when pao2fio2_vent_min < 150 then 3\n    else null\n  end as pulmonary\n\n  -- hematologic\n  , case\n      when wbc_max is null\n        and platelet_min is null\n          then null\n      when wbc_min <   1.0 then 3\n      when wbc_min <   2.5 then 1\n      when platelet_min < 50.0 then 1\n      when wbc_max >= 50.0 then 1\n    else 0\n  end as hematologic\n\n  -- hepatic\n  -- We have defined the \"standard\" PT as 12 seconds.\n  -- This is an assumption and subsequent analyses may be affected by this assumption.\n  , case\n      when pt_max is null\n        and bilirubin_max is null\n          then null\n      when bilirubin_max >= 2.0 then 1\n      when pt_max > (12+3) then 1\n      when pt_min < (12*0.25) then 1\n    else 0\n  end as hepatic\n\nfrom cohort\n)\nselect ie.subject_id, ie.hadm_id, ie.icustay_id\n-- coalesce statements impute normal score of zero if data element is missing\n, coalesce(neurologic,0)\n+ coalesce(cardiovascular,0)\n+ coalesce(renal,0)\n+ coalesce(pulmonary,0)\n+ coalesce(hematologic,0)\n+ coalesce(hepatic,0)\n  as LODS\n, neurologic\n, cardiovascular\n, renal\n, pulmonary\n, hematologic\n, hepatic\nFROM icustays ie\nleft join scorecomp s\n  on ie.icustay_id = s.icustay_id\norder by ie.icustay_id",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.blood_gas_first_day_arterial",
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.gcs_first_day",
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.labs_first_day",
            "mimiciii_clinical.patients",
            "mimiciii_clinical.urine_output_first_day",
            "mimiciii_clinical.ventilation_durations",
            "mimiciii_clinical.vitals_first_day"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "hadm_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "icustay_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "lods": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pao2fio2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.gcs_first_day.mingcs",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.bilirubin_max",
                "mimiciii_clinical.labs_first_day.bun_max",
                "mimiciii_clinical.labs_first_day.creatinine_max",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.platelet_min",
                "mimiciii_clinical.labs_first_day.pt_max",
                "mimiciii_clinical.labs_first_day.pt_min",
                "mimiciii_clinical.labs_first_day.wbc_max",
                "mimiciii_clinical.labs_first_day.wbc_min",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.urineoutput",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.heartrate_max",
                "mimiciii_clinical.vitals_first_day.heartrate_min",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.sysbp_max",
                "mimiciii_clinical.vitals_first_day.sysbp_min"
            ],
            "neurologic": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.gcs_first_day.mingcs",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "cardiovascular": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.heartrate_max",
                "mimiciii_clinical.vitals_first_day.heartrate_min",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.sysbp_max",
                "mimiciii_clinical.vitals_first_day.sysbp_min"
            ],
            "renal": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.bun_max",
                "mimiciii_clinical.labs_first_day.creatinine_max",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.urineoutput",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "pulmonary": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pao2fio2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "hematologic": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.platelet_min",
                "mimiciii_clinical.labs_first_day.wbc_max",
                "mimiciii_clinical.labs_first_day.wbc_min",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "hepatic": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.bilirubin_max",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.pt_max",
                "mimiciii_clinical.labs_first_day.pt_min",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ]
        },
        "table_name": "mimiciii_clinical.lods",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "ie.subject_id",
                "ie.hadm_id",
                "ie.icustay_id",
                "((((((COALESCE(s.neurologic, 0) + COALESCE(s.cardiovascular, 0)) + COALESCE(s.renal, 0)) + COALESCE(s.pulmonary, 0)) + COALESCE(s.hematologic, 0)) + COALESCE(s.hepatic, 0)))",
                "s.neurologic",
                "s.cardiovascular",
                "s.renal",
                "s.pulmonary",
                "s.hematologic",
                "s.hepatic"
            ],
            "Sort Key": [
                "ie.icustay_id"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cpap",
                    "Parallel Aware": false,
                    "Output": [
                        "ie_1.icustay_id",
                        "min(datetime_sub(ce.charttime, '01:00:00'::interval hour))",
                        "max(datetime_add(ce.charttime, '04:00:00'::interval hour))",
                        "max(CASE WHEN (lower((ce.value)::text) ~~ '%cpap%'::text) THEN 1 WHEN (lower((ce.value)::text) ~~ '%bipap mask%'::text) THEN 1 ELSE 0 END)"
                    ],
                    "Group Key": [
                        "ie_1.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ie_1.icustay_id",
                                "ce.charttime",
                                "ce.value"
                            ],
                            "Sort Key": [
                                "ie_1.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "ie_1.icustay_id",
                                        "ce.charttime",
                                        "ce.value"
                                    ],
                                    "Inner Unique": true,
                                    "Hash Cond": "(ce.icustay_id = ie_1.icustay_id)",
                                    "Join Filter": "((ce.charttime >= ie_1.intime) AND (ce.charttime <= datetime_add(ie_1.intime, '1 day'::interval day)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Append",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_45",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce",
                                                    "Output": [
                                                        "ce.charttime",
                                                        "ce.value",
                                                        "ce.icustay_id"
                                                    ],
                                                    "Filter": "(((ce.error IS NULL) OR (ce.error = 0)) AND (ce.itemid = ANY ('{467,469,226732}'::integer[])) AND ((lower((ce.value)::text) ~~ '%cpap%'::text) OR (lower((ce.value)::text) ~~ '%bipap mask%'::text)))"
                                                },
                                                {
                                                    "Node Type": "Index Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Scan Direction": "Forward",
                                                    "Index Name": "chartevents_46_idx01",
                                                    "Relation Name": "chartevents_46",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_1",
                                                    "Output": [
                                                        "ce_1.charttime",
                                                        "ce_1.value",
                                                        "ce_1.icustay_id"
                                                    ],
                                                    "Index Cond": "(ce_1.itemid = ANY ('{467,469,226732}'::integer[]))",
                                                    "Filter": "(((ce_1.error IS NULL) OR (ce_1.error = 0)) AND ((lower((ce_1.value)::text) ~~ '%cpap%'::text) OR (lower((ce_1.value)::text) ~~ '%bipap mask%'::text)))"
                                                },
                                                {
                                                    "Node Type": "Bitmap Heap Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_201",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_2",
                                                    "Output": [
                                                        "ce_2.charttime",
                                                        "ce_2.value",
                                                        "ce_2.icustay_id"
                                                    ],
                                                    "Recheck Cond": "(ce_2.itemid = ANY ('{467,469,226732}'::integer[]))",
                                                    "Filter": "(((ce_2.error IS NULL) OR (ce_2.error = 0)) AND ((lower((ce_2.value)::text) ~~ '%cpap%'::text) OR (lower((ce_2.value)::text) ~~ '%bipap mask%'::text)))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Bitmap Index Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Index Name": "chartevents_201_idx01",
                                                            "Index Cond": "(ce_2.itemid = ANY ('{467,469,226732}'::integer[]))"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ie_1.icustay_id",
                                                "ie_1.intime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "icustays",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ie_1",
                                                    "Output": [
                                                        "ie_1.icustay_id",
                                                        "ie_1.intime"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE pafi1",
                    "Parallel Aware": false,
                    "Join Type": "Right",
                    "Output": [
                        "bg.icustay_id",
                        "bg.charttime",
                        "bg.pao2fio2",
                        "CASE WHEN (vd.icustay_id IS NOT NULL) THEN 1 ELSE 0 END",
                        "CASE WHEN (cp.icustay_id IS NOT NULL) THEN 1 ELSE 0 END"
                    ],
                    "Inner Unique": false,
                    "Hash Cond": "(vd.icustay_id = bg.icustay_id)",
                    "Join Filter": "((bg.charttime >= vd.starttime) AND (bg.charttime <= vd.endtime))",
                    "Plans": [
                        {
                            "Node Type": "Seq Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "ventilation_durations",
                            "Schema": "mimiciii_clinical",
                            "Alias": "vd",
                            "Output": [
                                "vd.icustay_id",
                                "vd.starttime",
                                "vd.endtime"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "bg.icustay_id",
                                "bg.charttime",
                                "bg.pao2fio2",
                                "cp.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Right",
                                    "Output": [
                                        "bg.icustay_id",
                                        "bg.charttime",
                                        "bg.pao2fio2",
                                        "cp.icustay_id"
                                    ],
                                    "Inner Unique": false,
                                    "Hash Cond": "(cp.icustay_id = bg.icustay_id)",
                                    "Join Filter": "((bg.charttime >= cp.starttime) AND (bg.charttime <= cp.endtime))",
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "cpap",
                                            "Alias": "cp",
                                            "Output": [
                                                "cp.icustay_id",
                                                "cp.starttime",
                                                "cp.endtime"
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "bg.icustay_id",
                                                "bg.charttime",
                                                "bg.pao2fio2"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "blood_gas_first_day_arterial",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "bg",
                                                    "Output": [
                                                        "bg.icustay_id",
                                                        "bg.charttime",
                                                        "bg.pao2fio2"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE pafi2",
                    "Parallel Aware": false,
                    "Output": [
                        "pafi1.icustay_id",
                        "min(pafi1.pao2fio2)"
                    ],
                    "Group Key": [
                        "pafi1.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "pafi1",
                            "Alias": "pafi1",
                            "Output": [
                                "pafi1.icustay_id",
                                "pafi1.charttime",
                                "pafi1.pao2fio2",
                                "pafi1.vent",
                                "pafi1.cpap"
                            ],
                            "Filter": "((pafi1.vent = 1) OR (pafi1.cpap = 1))"
                        }
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cohort",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "ie_2.subject_id",
                        "ie_2.hadm_id",
                        "ie_2.icustay_id",
                        "ie_2.intime",
                        "ie_2.outtime",
                        "gcs.mingcs",
                        "vital.heartrate_max",
                        "vital.heartrate_min",
                        "vital.sysbp_max",
                        "vital.sysbp_min",
                        "pf.pao2fio2_vent_min",
                        "labs.bun_max",
                        "labs.bun_min",
                        "labs.wbc_max",
                        "labs.wbc_min",
                        "labs.bilirubin_max",
                        "labs.creatinine_max",
                        "labs.pt_min",
                        "labs.pt_max",
                        "labs.platelet_min",
                        "uo.urineoutput"
                    ],
                    "Inner Unique": false,
                    "Hash Cond": "(ie_2.icustay_id = uo.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Left",
                            "Output": [
                                "ie_2.subject_id",
                                "ie_2.hadm_id",
                                "ie_2.icustay_id",
                                "ie_2.intime",
                                "ie_2.outtime",
                                "pf.pao2fio2_vent_min",
                                "gcs.mingcs",
                                "vital.heartrate_max",
                                "vital.heartrate_min",
                                "vital.sysbp_max",
                                "vital.sysbp_min",
                                "labs.bun_max",
                                "labs.bun_min",
                                "labs.wbc_max",
                                "labs.wbc_min",
                                "labs.bilirubin_max",
                                "labs.creatinine_max",
                                "labs.pt_min",
                                "labs.pt_max",
                                "labs.platelet_min"
                            ],
                            "Inner Unique": false,
                            "Hash Cond": "(ie_2.icustay_id = gcs.icustay_id)",
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Left",
                                    "Output": [
                                        "ie_2.subject_id",
                                        "ie_2.hadm_id",
                                        "ie_2.icustay_id",
                                        "ie_2.intime",
                                        "ie_2.outtime",
                                        "pf.pao2fio2_vent_min",
                                        "vital.heartrate_max",
                                        "vital.heartrate_min",
                                        "vital.sysbp_max",
                                        "vital.sysbp_min",
                                        "labs.bun_max",
                                        "labs.bun_min",
                                        "labs.wbc_max",
                                        "labs.wbc_min",
                                        "labs.bilirubin_max",
                                        "labs.creatinine_max",
                                        "labs.pt_min",
                                        "labs.pt_max",
                                        "labs.platelet_min"
                                    ],
                                    "Inner Unique": false,
                                    "Hash Cond": "(ie_2.icustay_id = pf.icustay_id)",
                                    "Plans": [
                                        {
                                            "Node Type": "Hash Join",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Join Type": "Left",
                                            "Output": [
                                                "ie_2.subject_id",
                                                "ie_2.hadm_id",
                                                "ie_2.icustay_id",
                                                "ie_2.intime",
                                                "ie_2.outtime",
                                                "vital.heartrate_max",
                                                "vital.heartrate_min",
                                                "vital.sysbp_max",
                                                "vital.sysbp_min",
                                                "labs.bun_max",
                                                "labs.bun_min",
                                                "labs.wbc_max",
                                                "labs.wbc_min",
                                                "labs.bilirubin_max",
                                                "labs.creatinine_max",
                                                "labs.pt_min",
                                                "labs.pt_max",
                                                "labs.platelet_min"
                                            ],
                                            "Inner Unique": false,
                                            "Hash Cond": "(ie_2.icustay_id = labs.icustay_id)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Hash Join",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Join Type": "Inner",
                                                    "Output": [
                                                        "ie_2.subject_id",
                                                        "ie_2.hadm_id",
                                                        "ie_2.icustay_id",
                                                        "ie_2.intime",
                                                        "ie_2.outtime",
                                                        "vital.heartrate_max",
                                                        "vital.heartrate_min",
                                                        "vital.sysbp_max",
                                                        "vital.sysbp_min"
                                                    ],
                                                    "Inner Unique": true,
                                                    "Hash Cond": "(ie_2.subject_id = pat.subject_id)",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Hash Join",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Join Type": "Inner",
                                                            "Output": [
                                                                "ie_2.subject_id",
                                                                "ie_2.hadm_id",
                                                                "ie_2.icustay_id",
                                                                "ie_2.intime",
                                                                "ie_2.outtime",
                                                                "vital.heartrate_max",
                                                                "vital.heartrate_min",
                                                                "vital.sysbp_max",
                                                                "vital.sysbp_min"
                                                            ],
                                                            "Inner Unique": true,
                                                            "Hash Cond": "(ie_2.hadm_id = adm.hadm_id)",
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Hash Join",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Join Type": "Right",
                                                                    "Output": [
                                                                        "ie_2.subject_id",
                                                                        "ie_2.hadm_id",
                                                                        "ie_2.icustay_id",
                                                                        "ie_2.intime",
                                                                        "ie_2.outtime",
                                                                        "vital.heartrate_max",
                                                                        "vital.heartrate_min",
                                                                        "vital.sysbp_max",
                                                                        "vital.sysbp_min"
                                                                    ],
                                                                    "Inner Unique": true,
                                                                    "Hash Cond": "(vital.icustay_id = ie_2.icustay_id)",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Seq Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Relation Name": "vitals_first_day",
                                                                            "Schema": "mimiciii_clinical",
                                                                            "Alias": "vital",
                                                                            "Output": [
                                                                                "vital.heartrate_max",
                                                                                "vital.heartrate_min",
                                                                                "vital.sysbp_max",
                                                                                "vital.sysbp_min",
                                                                                "vital.icustay_id"
                                                                            ]
                                                                        },
                                                                        {
                                                                            "Node Type": "Hash",
                                                                            "Parent Relationship": "Inner",
                                                                            "Parallel Aware": false,
                                                                            "Output": [
                                                                                "ie_2.subject_id",
                                                                                "ie_2.hadm_id",
                                                                                "ie_2.icustay_id",
                                                                                "ie_2.intime",
                                                                                "ie_2.outtime"
                                                                            ],
                                                                            "Plans": [
                                                                                {
                                                                                    "Node Type": "Seq Scan",
                                                                                    "Parent Relationship": "Outer",
                                                                                    "Parallel Aware": false,
                                                                                    "Relation Name": "icustays",
                                                                                    "Schema": "mimiciii_clinical",
                                                                                    "Alias": "ie_2",
                                                                                    "Output": [
                                                                                        "ie_2.subject_id",
                                                                                        "ie_2.hadm_id",
                                                                                        "ie_2.icustay_id",
                                                                                        "ie_2.intime",
                                                                                        "ie_2.outtime"
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Hash",
                                                                    "Parent Relationship": "Inner",
                                                                    "Parallel Aware": false,
                                                                    "Output": [
                                                                        "adm.hadm_id"
                                                                    ],
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Seq Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Relation Name": "admissions",
                                                                            "Schema": "mimiciii_clinical",
                                                                            "Alias": "adm",
                                                                            "Output": [
                                                                                "adm.hadm_id"
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "Node Type": "Hash",
                                                            "Parent Relationship": "Inner",
                                                            "Parallel Aware": false,
                                                            "Output": [
                                                                "pat.subject_id"
                                                            ],
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Seq Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Relation Name": "patients",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "pat",
                                                                    "Output": [
                                                                        "pat.subject_id"
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "Node Type": "Hash",
                                                    "Parent Relationship": "Inner",
                                                    "Parallel Aware": false,
                                                    "Output": [
                                                        "labs.bun_max",
                                                        "labs.bun_min",
                                                        "labs.wbc_max",
                                                        "labs.wbc_min",
                                                        "labs.bilirubin_max",
                                                        "labs.creatinine_max",
                                                        "labs.pt_min",
                                                        "labs.pt_max",
                                                        "labs.platelet_min",
                                                        "labs.icustay_id"
                                                    ],
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Seq Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "labs_first_day",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "labs",
                                                            "Output": [
                                                                "labs.bun_max",
                                                                "labs.bun_min",
                                                                "labs.wbc_max",
                                                                "labs.wbc_min",
                                                                "labs.bilirubin_max",
                                                                "labs.creatinine_max",
                                                                "labs.pt_min",
                                                                "labs.pt_max",
                                                                "labs.platelet_min",
                                                                "labs.icustay_id"
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "pf.pao2fio2_vent_min",
                                                "pf.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "pafi2",
                                                    "Alias": "pf",
                                                    "Output": [
                                                        "pf.pao2fio2_vent_min",
                                                        "pf.icustay_id"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "gcs.mingcs",
                                        "gcs.icustay_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "gcs_first_day",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "gcs",
                                            "Output": [
                                                "gcs.mingcs",
                                                "gcs.icustay_id"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "uo.urineoutput",
                                "uo.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "urine_output_first_day",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "uo",
                                    "Output": [
                                        "uo.urineoutput",
                                        "uo.icustay_id"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE scorecomp",
                    "Parallel Aware": false,
                    "CTE Name": "cohort",
                    "Alias": "cohort",
                    "Output": [
                        "cohort.subject_id",
                        "cohort.hadm_id",
                        "cohort.icustay_id",
                        "cohort.intime",
                        "cohort.outtime",
                        "cohort.mingcs",
                        "cohort.heartrate_max",
                        "cohort.heartrate_min",
                        "cohort.sysbp_max",
                        "cohort.sysbp_min",
                        "cohort.pao2fio2_vent_min",
                        "cohort.bun_max",
                        "cohort.bun_min",
                        "cohort.wbc_max",
                        "cohort.wbc_min",
                        "cohort.bilirubin_max",
                        "cohort.creatinine_max",
                        "cohort.pt_min",
                        "cohort.pt_max",
                        "cohort.platelet_min",
                        "cohort.urineoutput",
                        "CASE WHEN (cohort.mingcs IS NULL) THEN NULL::integer WHEN (cohort.mingcs < '3'::double precision) THEN NULL::integer WHEN (cohort.mingcs <= '5'::double precision) THEN 5 WHEN (cohort.mingcs <= '8'::double precision) THEN 3 WHEN (cohort.mingcs <= '13'::double precision) THEN 1 ELSE 0 END",
                        "CASE WHEN ((cohort.heartrate_max IS NULL) AND (cohort.sysbp_min IS NULL)) THEN NULL::integer WHEN (cohort.heartrate_min < '30'::double precision) THEN 5 WHEN (cohort.sysbp_min < '40'::double precision) THEN 5 WHEN (cohort.sysbp_min < '70'::double precision) THEN 3 WHEN (cohort.sysbp_max >= '270'::double precision) THEN 3 WHEN (cohort.heartrate_max >= '140'::double precision) THEN 1 WHEN (cohort.sysbp_max >= '240'::double precision) THEN 1 WHEN (cohort.sysbp_min < '90'::double precision) THEN 1 ELSE 0 END",
                        "CASE WHEN ((cohort.bun_max IS NULL) OR (cohort.urineoutput IS NULL) OR (cohort.creatinine_max IS NULL)) THEN NULL::integer WHEN (cohort.urineoutput < '500'::double precision) THEN 5 WHEN (cohort.bun_max >= '56'::double precision) THEN 5 WHEN (cohort.creatinine_max >= '1.6'::double precision) THEN 3 WHEN (cohort.urineoutput < '750'::double precision) THEN 3 WHEN (cohort.bun_max >= '28'::double precision) THEN 3 WHEN (cohort.urineoutput >= '10000'::double precision) THEN 3 WHEN (cohort.creatinine_max >= '1.2'::double precision) THEN 1 WHEN (cohort.bun_max >= '17'::double precision) THEN 1 WHEN (cohort.bun_max >= '7.5'::double precision) THEN 1 ELSE 0 END",
                        "CASE WHEN (cohort.pao2fio2_vent_min IS NULL) THEN 0 WHEN (cohort.pao2fio2_vent_min >= '150'::double precision) THEN 1 WHEN (cohort.pao2fio2_vent_min < '150'::double precision) THEN 3 ELSE NULL::integer END",
                        "CASE WHEN ((cohort.wbc_max IS NULL) AND (cohort.platelet_min IS NULL)) THEN NULL::integer WHEN (cohort.wbc_min < '1'::double precision) THEN 3 WHEN (cohort.wbc_min < '2.5'::double precision) THEN 1 WHEN (cohort.platelet_min < '50'::double precision) THEN 1 WHEN (cohort.wbc_max >= '50'::double precision) THEN 1 ELSE 0 END",
                        "CASE WHEN ((cohort.pt_max IS NULL) AND (cohort.bilirubin_max IS NULL)) THEN NULL::integer WHEN (cohort.bilirubin_max >= '2'::double precision) THEN 1 WHEN (cohort.pt_max > '15'::double precision) THEN 1 WHEN (cohort.pt_min < '3'::double precision) THEN 1 ELSE 0 END"
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Join Type": "Right",
                    "Output": [
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id",
                        "(((((COALESCE(s.neurologic, 0) + COALESCE(s.cardiovascular, 0)) + COALESCE(s.renal, 0)) + COALESCE(s.pulmonary, 0)) + COALESCE(s.hematologic, 0)) + COALESCE(s.hepatic, 0))",
                        "s.neurologic",
                        "s.cardiovascular",
                        "s.renal",
                        "s.pulmonary",
                        "s.hematologic",
                        "s.hepatic"
                    ],
                    "Inner Unique": true,
                    "Hash Cond": "(s.icustay_id = ie.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "scorecomp",
                            "Alias": "s",
                            "Output": [
                                "s.subject_id",
                                "s.hadm_id",
                                "s.icustay_id",
                                "s.intime",
                                "s.outtime",
                                "s.mingcs",
                                "s.heartrate_max",
                                "s.heartrate_min",
                                "s.sysbp_max",
                                "s.sysbp_min",
                                "s.pao2fio2_vent_min",
                                "s.bun_max",
                                "s.bun_min",
                                "s.wbc_max",
                                "s.wbc_min",
                                "s.bilirubin_max",
                                "s.creatinine_max",
                                "s.pt_min",
                                "s.pt_max",
                                "s.platelet_min",
                                "s.urineoutput",
                                "s.neurologic",
                                "s.cardiovascular",
                                "s.renal",
                                "s.pulmonary",
                                "s.hematologic",
                                "s.hepatic"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "ie.subject_id",
                                "ie.hadm_id",
                                "ie.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "icustays",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ie",
                                    "Output": [
                                        "ie.subject_id",
                                        "ie.hadm_id",
                                        "ie.icustay_id"
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.mlods": {
        "sql": "-- ------------------------------------------------------------------\n-- Title: Modified Logistic organ dysfunction system (mLODS)\n-- This query extracts a modified version of the logistic organ dysfunction system.\n-- This score was used in the third international definition of sepsis: Sepsis-3.\n-- This score is a measure of organ failure in a patient.\n-- ------------------------------------------------------------------\n\n-- Reference for LODS:\n--  Le Gall, J. R., Klar, J., Lemeshow, S., Saulnier, F., Alberti, C., Artigas, A., & Teres, D.\n--  The Logistic Organ Dysfunction system: a new way to assess organ dysfunction in the intensive care unit.\n--  JAMA 276.10 (1996): 802-810.\n\n-- Reference for modified LODS:\n--  Le Gall, J. R., Klar, J., Lemeshow, S., Saulnier, F., Alberti, C., Artigas, A., & Teres, D.\n--  The Logistic Organ Dysfunction system: a new way to assess organ dysfunction in the intensive care unit.\n--  JAMA 276.10 (1996): 802-810.\n\n-- Variables used in mLODS:\n--  GCS\n--  VITALS: Heart rate, systolic blood pressure\n--  FLAGS: ventilation/cpap\n--  LABS: WBC, bilirubin, creatinine, platelets\n--  ABG: PaO2 with associated FiO2\n\n-- Variables *excluded*, that are used in the original LODS:\n--  prothrombin time (PT), blood urea nitrogen, urine output\n\n-- Note:\n--  The score is calculated for *all* ICU patients, with the assumption that the user will subselect appropriate ICUSTAY_IDs.\n--  For example, the score is calculated for neonates, but it is likely inappropriate to actually use the score values for these patients.\n\n-- extract CPAP from the \"Oxygen Delivery Device\" fields\nwith cpap as\n(\n  select ie.icustay_id\n    , min(DATETIME_SUB(charttime, INTERVAL '1' HOUR)) as starttime\n    , max(DATETIME_ADD(charttime, INTERVAL '4' HOUR)) as endtime\n    , max(CASE\n          WHEN lower(ce.value) LIKE '%cpap%' THEN 1\n          WHEN lower(ce.value) LIKE '%bipap mask%' THEN 1\n        else 0 end) as cpap\n  FROM icustays ie\n  inner join chartevents ce\n    on ie.icustay_id = ce.icustay_id\n    and ce.charttime between ie.intime and ie.outtime\n  where itemid in\n  (\n    -- TODO: when metavision data import fixed, check the values in 226732 match the value clause below\n    467, 469, 226732\n  )\n  and (lower(ce.value) LIKE '%cpap%' or lower(ce.value) LIKE '%bipap mask%')\n  -- exclude rows marked as error\n  AND (ce.error IS NULL OR ce.error = 0)\n  group by ie.icustay_id\n)\n, pafi1 as\n(\n  -- join blood gas to ventilation durations to determine if patient was vent\n  -- also join to cpap table for the same purpose\n  select bg.icustay_id, bg.charttime\n  , PaO2FiO2\n  , case when vd.icustay_id is not null then 1 else 0 end as vent\n  , case when cp.icustay_id is not null then 1 else 0 end as cpap\n  from \"mimic\".\"mimiciii_clinical\".\"blood_gas_first_day_arterial\" bg\n  left join \"mimic\".\"mimiciii_clinical\".\"ventilation_durations\" vd\n    on bg.icustay_id = vd.icustay_id\n    and bg.charttime >= vd.starttime\n    and bg.charttime <= vd.endtime\n  left join cpap cp\n    on bg.icustay_id = cp.icustay_id\n    and bg.charttime >= cp.starttime\n    and bg.charttime <= cp.endtime\n)\n, pafi2 as\n(\n  -- get the minimum PaO2/FiO2 ratio *only for ventilated/cpap patients*\n  select icustay_id\n  , min(PaO2FiO2) as PaO2FiO2_vent_min\n  from pafi1\n  where vent = 1 or cpap = 1\n  group by icustay_id\n)\n, cohort as\n(\nselect  ie.subject_id\n      , ie.hadm_id\n      , ie.icustay_id\n      , ie.intime\n      , ie.outtime\n\n      , gcs.mingcs\n      , vital.heartrate_max\n      , vital.heartrate_min\n      , vital.sysbp_max\n      , vital.sysbp_min\n\n      -- this value is non-null iff the patient is on vent/cpap\n      , pf.PaO2FiO2_vent_min\n\n      , labs.wbc_max\n      , labs.wbc_min\n      , labs.bilirubin_max\n      , labs.creatinine_max\n      , labs.platelet_min\n\nFROM icustays ie\ninner join admissions adm\n  on ie.hadm_id = adm.hadm_id\ninner join patients pat\n  on ie.subject_id = pat.subject_id\n\n-- join to above view to get pao2/fio2 ratio\nleft join pafi2 pf\n  on ie.icustay_id = pf.icustay_id\n\n-- join to custom tables to get more data....\nleft join \"mimic\".\"mimiciii_clinical\".\"gcs_first_day\" gcs\n  on ie.icustay_id = gcs.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"vitals_first_day\" vital\n  on ie.icustay_id = vital.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"labs_first_day\" labs\n  on ie.icustay_id = labs.icustay_id\n)\n, scorecomp as\n(\nselect\n  cohort.*\n\n  -- neurologic\n  , case\n    when mingcs is null then null\n      when mingcs <  3 then null -- erroneous value/on trach\n      when mingcs <=  5 then 5\n      when mingcs <=  8 then 3\n      when mingcs <= 13 then 1\n    else 0\n  end as neurologic\n\n  -- cardiovascular\n  , case\n      when heartrate_max is null\n      and sysbp_min is null then null\n      when heartrate_min < 30 then 5\n      when sysbp_min < 40 then 5\n      when sysbp_min <  70 then 3\n      when sysbp_max >= 270 then 3\n      when heartrate_max >= 140 then 1\n      when sysbp_max >= 240 then 1\n      when sysbp_min < 90 then 1\n    else 0\n  end as cardiovascular\n\n  -- renal\n  , case\n      when creatinine_max is null\n        -- or UrineOutput is null\n        -- or bun_max is null\n        then null\n      -- when UrineOutput <   500.0 then 5\n      -- when bun_max >= 56.0 then 5\n      when creatinine_max >= 1.60 then 3\n      -- when UrineOutput <   750.0 then 3\n      -- when bun_max >= 28.0 then 3\n      -- when UrineOutput >= 10000.0 then 3\n      when creatinine_max >= 1.20 then 1\n      -- when bun_max >= 17.0 then 1\n      -- when bun_max >= 7.50 then 1\n    else 0\n  end as renal\n\n  -- pulmonary\n  , case\n      when PaO2FiO2_vent_min is null then 0\n      when PaO2FiO2_vent_min >= 150 then 1\n      when PaO2FiO2_vent_min < 150 then 3\n    else null\n  end as pulmonary\n\n  -- hematologic\n  , case\n      when wbc_max is null\n        and platelet_min is null\n          then null\n      when wbc_min <   1.0 then 3\n      when wbc_min <   2.5 then 1\n      when platelet_min < 50.0 then 1\n      when wbc_max >= 50.0 then 1\n    else 0\n  end as hematologic\n\n  -- hepatic\n  , case\n      when bilirubin_max is null\n        -- and pt_max is null\n          then null\n      when bilirubin_max >= 2.0 then 1\n      -- when pt_max > (12+3) then 1\n      -- when pt_min < (12*0.25) then 1\n    else 0\n  end as hepatic\n\nfrom cohort\n)\nselect ie.icustay_id\n-- coalesce statements impute normal score of zero if data element is missing\n, coalesce(neurologic,0)\n+ coalesce(cardiovascular,0)\n+ coalesce(renal,0)\n+ coalesce(pulmonary,0)\n+ coalesce(hematologic,0)\n+ coalesce(hepatic,0)\n  as mLODS\n, neurologic\n, cardiovascular\n, renal\n, pulmonary\n, hematologic\n, hepatic\nFROM icustays ie\nleft join scorecomp s\n  on ie.icustay_id = s.icustay_id\norder by ie.icustay_id",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.blood_gas_first_day_arterial",
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.gcs_first_day",
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.labs_first_day",
            "mimiciii_clinical.patients",
            "mimiciii_clinical.ventilation_durations",
            "mimiciii_clinical.vitals_first_day"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "mlods": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pao2fio2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.gcs_first_day.mingcs",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.bilirubin_max",
                "mimiciii_clinical.labs_first_day.creatinine_max",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.platelet_min",
                "mimiciii_clinical.labs_first_day.wbc_max",
                "mimiciii_clinical.labs_first_day.wbc_min",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.heartrate_max",
                "mimiciii_clinical.vitals_first_day.heartrate_min",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.sysbp_max",
                "mimiciii_clinical.vitals_first_day.sysbp_min"
            ],
            "neurologic": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.gcs_first_day.mingcs",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "cardiovascular": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.heartrate_max",
                "mimiciii_clinical.vitals_first_day.heartrate_min",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.sysbp_max",
                "mimiciii_clinical.vitals_first_day.sysbp_min"
            ],
            "renal": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.creatinine_max",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "pulmonary": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pao2fio2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "hematologic": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.platelet_min",
                "mimiciii_clinical.labs_first_day.wbc_max",
                "mimiciii_clinical.labs_first_day.wbc_min",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "hepatic": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.bilirubin_max",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ]
        },
        "table_name": "mimiciii_clinical.mlods",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "ie.icustay_id",
                "((((((COALESCE(s.neurologic, 0) + COALESCE(s.cardiovascular, 0)) + COALESCE(s.renal, 0)) + COALESCE(s.pulmonary, 0)) + COALESCE(s.hematologic, 0)) + COALESCE(s.hepatic, 0)))",
                "s.neurologic",
                "s.cardiovascular",
                "s.renal",
                "s.pulmonary",
                "s.hematologic",
                "s.hepatic"
            ],
            "Sort Key": [
                "ie.icustay_id"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cpap",
                    "Parallel Aware": false,
                    "Output": [
                        "ie_1.icustay_id",
                        "min(datetime_sub(ce.charttime, '01:00:00'::interval hour))",
                        "max(datetime_add(ce.charttime, '04:00:00'::interval hour))",
                        "max(CASE WHEN (lower((ce.value)::text) ~~ '%cpap%'::text) THEN 1 WHEN (lower((ce.value)::text) ~~ '%bipap mask%'::text) THEN 1 ELSE 0 END)"
                    ],
                    "Group Key": [
                        "ie_1.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ie_1.icustay_id",
                                "ce.charttime",
                                "ce.value"
                            ],
                            "Sort Key": [
                                "ie_1.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "ie_1.icustay_id",
                                        "ce.charttime",
                                        "ce.value"
                                    ],
                                    "Inner Unique": true,
                                    "Hash Cond": "(ce.icustay_id = ie_1.icustay_id)",
                                    "Join Filter": "((ce.charttime >= ie_1.intime) AND (ce.charttime <= ie_1.outtime))",
                                    "Plans": [
                                        {
                                            "Node Type": "Append",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_45",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce",
                                                    "Output": [
                                                        "ce.charttime",
                                                        "ce.value",
                                                        "ce.icustay_id"
                                                    ],
                                                    "Filter": "(((ce.error IS NULL) OR (ce.error = 0)) AND (ce.itemid = ANY ('{467,469,226732}'::integer[])) AND ((lower((ce.value)::text) ~~ '%cpap%'::text) OR (lower((ce.value)::text) ~~ '%bipap mask%'::text)))"
                                                },
                                                {
                                                    "Node Type": "Index Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Scan Direction": "Forward",
                                                    "Index Name": "chartevents_46_idx01",
                                                    "Relation Name": "chartevents_46",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_1",
                                                    "Output": [
                                                        "ce_1.charttime",
                                                        "ce_1.value",
                                                        "ce_1.icustay_id"
                                                    ],
                                                    "Index Cond": "(ce_1.itemid = ANY ('{467,469,226732}'::integer[]))",
                                                    "Filter": "(((ce_1.error IS NULL) OR (ce_1.error = 0)) AND ((lower((ce_1.value)::text) ~~ '%cpap%'::text) OR (lower((ce_1.value)::text) ~~ '%bipap mask%'::text)))"
                                                },
                                                {
                                                    "Node Type": "Bitmap Heap Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_201",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_2",
                                                    "Output": [
                                                        "ce_2.charttime",
                                                        "ce_2.value",
                                                        "ce_2.icustay_id"
                                                    ],
                                                    "Recheck Cond": "(ce_2.itemid = ANY ('{467,469,226732}'::integer[]))",
                                                    "Filter": "(((ce_2.error IS NULL) OR (ce_2.error = 0)) AND ((lower((ce_2.value)::text) ~~ '%cpap%'::text) OR (lower((ce_2.value)::text) ~~ '%bipap mask%'::text)))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Bitmap Index Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Index Name": "chartevents_201_idx01",
                                                            "Index Cond": "(ce_2.itemid = ANY ('{467,469,226732}'::integer[]))"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ie_1.icustay_id",
                                                "ie_1.intime",
                                                "ie_1.outtime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "icustays",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ie_1",
                                                    "Output": [
                                                        "ie_1.icustay_id",
                                                        "ie_1.intime",
                                                        "ie_1.outtime"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE pafi1",
                    "Parallel Aware": false,
                    "Join Type": "Right",
                    "Output": [
                        "bg.icustay_id",
                        "bg.charttime",
                        "bg.pao2fio2",
                        "CASE WHEN (vd.icustay_id IS NOT NULL) THEN 1 ELSE 0 END",
                        "CASE WHEN (cp.icustay_id IS NOT NULL) THEN 1 ELSE 0 END"
                    ],
                    "Inner Unique": false,
                    "Hash Cond": "(vd.icustay_id = bg.icustay_id)",
                    "Join Filter": "((bg.charttime >= vd.starttime) AND (bg.charttime <= vd.endtime))",
                    "Plans": [
                        {
                            "Node Type": "Seq Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "ventilation_durations",
                            "Schema": "mimiciii_clinical",
                            "Alias": "vd",
                            "Output": [
                                "vd.icustay_id",
                                "vd.starttime",
                                "vd.endtime"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "bg.icustay_id",
                                "bg.charttime",
                                "bg.pao2fio2",
                                "cp.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Right",
                                    "Output": [
                                        "bg.icustay_id",
                                        "bg.charttime",
                                        "bg.pao2fio2",
                                        "cp.icustay_id"
                                    ],
                                    "Inner Unique": false,
                                    "Hash Cond": "(cp.icustay_id = bg.icustay_id)",
                                    "Join Filter": "((bg.charttime >= cp.starttime) AND (bg.charttime <= cp.endtime))",
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "cpap",
                                            "Alias": "cp",
                                            "Output": [
                                                "cp.icustay_id",
                                                "cp.starttime",
                                                "cp.endtime"
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "bg.icustay_id",
                                                "bg.charttime",
                                                "bg.pao2fio2"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "blood_gas_first_day_arterial",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "bg",
                                                    "Output": [
                                                        "bg.icustay_id",
                                                        "bg.charttime",
                                                        "bg.pao2fio2"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE pafi2",
                    "Parallel Aware": false,
                    "Output": [
                        "pafi1.icustay_id",
                        "min(pafi1.pao2fio2)"
                    ],
                    "Group Key": [
                        "pafi1.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "pafi1",
                            "Alias": "pafi1",
                            "Output": [
                                "pafi1.icustay_id",
                                "pafi1.charttime",
                                "pafi1.pao2fio2",
                                "pafi1.vent",
                                "pafi1.cpap"
                            ],
                            "Filter": "((pafi1.vent = 1) OR (pafi1.cpap = 1))"
                        }
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cohort",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "ie_2.subject_id",
                        "ie_2.hadm_id",
                        "ie_2.icustay_id",
                        "ie_2.intime",
                        "ie_2.outtime",
                        "gcs.mingcs",
                        "vital.heartrate_max",
                        "vital.heartrate_min",
                        "vital.sysbp_max",
                        "vital.sysbp_min",
                        "pf.pao2fio2_vent_min",
                        "labs.wbc_max",
                        "labs.wbc_min",
                        "labs.bilirubin_max",
                        "labs.creatinine_max",
                        "labs.platelet_min"
                    ],
                    "Inner Unique": false,
                    "Hash Cond": "(ie_2.icustay_id = gcs.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Left",
                            "Output": [
                                "ie_2.subject_id",
                                "ie_2.hadm_id",
                                "ie_2.icustay_id",
                                "ie_2.intime",
                                "ie_2.outtime",
                                "pf.pao2fio2_vent_min",
                                "vital.heartrate_max",
                                "vital.heartrate_min",
                                "vital.sysbp_max",
                                "vital.sysbp_min",
                                "labs.wbc_max",
                                "labs.wbc_min",
                                "labs.bilirubin_max",
                                "labs.creatinine_max",
                                "labs.platelet_min"
                            ],
                            "Inner Unique": false,
                            "Hash Cond": "(ie_2.icustay_id = pf.icustay_id)",
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Left",
                                    "Output": [
                                        "ie_2.subject_id",
                                        "ie_2.hadm_id",
                                        "ie_2.icustay_id",
                                        "ie_2.intime",
                                        "ie_2.outtime",
                                        "vital.heartrate_max",
                                        "vital.heartrate_min",
                                        "vital.sysbp_max",
                                        "vital.sysbp_min",
                                        "labs.wbc_max",
                                        "labs.wbc_min",
                                        "labs.bilirubin_max",
                                        "labs.creatinine_max",
                                        "labs.platelet_min"
                                    ],
                                    "Inner Unique": false,
                                    "Hash Cond": "(ie_2.icustay_id = vital.icustay_id)",
                                    "Plans": [
                                        {
                                            "Node Type": "Hash Join",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Join Type": "Inner",
                                            "Output": [
                                                "ie_2.subject_id",
                                                "ie_2.hadm_id",
                                                "ie_2.icustay_id",
                                                "ie_2.intime",
                                                "ie_2.outtime",
                                                "labs.wbc_max",
                                                "labs.wbc_min",
                                                "labs.bilirubin_max",
                                                "labs.creatinine_max",
                                                "labs.platelet_min"
                                            ],
                                            "Inner Unique": true,
                                            "Hash Cond": "(ie_2.subject_id = pat.subject_id)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Hash Join",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Join Type": "Inner",
                                                    "Output": [
                                                        "ie_2.subject_id",
                                                        "ie_2.hadm_id",
                                                        "ie_2.icustay_id",
                                                        "ie_2.intime",
                                                        "ie_2.outtime",
                                                        "labs.wbc_max",
                                                        "labs.wbc_min",
                                                        "labs.bilirubin_max",
                                                        "labs.creatinine_max",
                                                        "labs.platelet_min"
                                                    ],
                                                    "Inner Unique": true,
                                                    "Hash Cond": "(ie_2.hadm_id = adm.hadm_id)",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Hash Join",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Join Type": "Right",
                                                            "Output": [
                                                                "ie_2.subject_id",
                                                                "ie_2.hadm_id",
                                                                "ie_2.icustay_id",
                                                                "ie_2.intime",
                                                                "ie_2.outtime",
                                                                "labs.wbc_max",
                                                                "labs.wbc_min",
                                                                "labs.bilirubin_max",
                                                                "labs.creatinine_max",
                                                                "labs.platelet_min"
                                                            ],
                                                            "Inner Unique": true,
                                                            "Hash Cond": "(labs.icustay_id = ie_2.icustay_id)",
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Seq Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Relation Name": "labs_first_day",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "labs",
                                                                    "Output": [
                                                                        "labs.wbc_max",
                                                                        "labs.wbc_min",
                                                                        "labs.bilirubin_max",
                                                                        "labs.creatinine_max",
                                                                        "labs.platelet_min",
                                                                        "labs.icustay_id"
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Hash",
                                                                    "Parent Relationship": "Inner",
                                                                    "Parallel Aware": false,
                                                                    "Output": [
                                                                        "ie_2.subject_id",
                                                                        "ie_2.hadm_id",
                                                                        "ie_2.icustay_id",
                                                                        "ie_2.intime",
                                                                        "ie_2.outtime"
                                                                    ],
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Seq Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Relation Name": "icustays",
                                                                            "Schema": "mimiciii_clinical",
                                                                            "Alias": "ie_2",
                                                                            "Output": [
                                                                                "ie_2.subject_id",
                                                                                "ie_2.hadm_id",
                                                                                "ie_2.icustay_id",
                                                                                "ie_2.intime",
                                                                                "ie_2.outtime"
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "Node Type": "Hash",
                                                            "Parent Relationship": "Inner",
                                                            "Parallel Aware": false,
                                                            "Output": [
                                                                "adm.hadm_id"
                                                            ],
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Seq Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Relation Name": "admissions",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "adm",
                                                                    "Output": [
                                                                        "adm.hadm_id"
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "Node Type": "Hash",
                                                    "Parent Relationship": "Inner",
                                                    "Parallel Aware": false,
                                                    "Output": [
                                                        "pat.subject_id"
                                                    ],
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Seq Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "patients",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "pat",
                                                            "Output": [
                                                                "pat.subject_id"
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "vital.heartrate_max",
                                                "vital.heartrate_min",
                                                "vital.sysbp_max",
                                                "vital.sysbp_min",
                                                "vital.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "vitals_first_day",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "vital",
                                                    "Output": [
                                                        "vital.heartrate_max",
                                                        "vital.heartrate_min",
                                                        "vital.sysbp_max",
                                                        "vital.sysbp_min",
                                                        "vital.icustay_id"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "pf.pao2fio2_vent_min",
                                        "pf.icustay_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "pafi2",
                                            "Alias": "pf",
                                            "Output": [
                                                "pf.pao2fio2_vent_min",
                                                "pf.icustay_id"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "gcs.mingcs",
                                "gcs.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "gcs_first_day",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "gcs",
                                    "Output": [
                                        "gcs.mingcs",
                                        "gcs.icustay_id"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE scorecomp",
                    "Parallel Aware": false,
                    "CTE Name": "cohort",
                    "Alias": "cohort",
                    "Output": [
                        "cohort.subject_id",
                        "cohort.hadm_id",
                        "cohort.icustay_id",
                        "cohort.intime",
                        "cohort.outtime",
                        "cohort.mingcs",
                        "cohort.heartrate_max",
                        "cohort.heartrate_min",
                        "cohort.sysbp_max",
                        "cohort.sysbp_min",
                        "cohort.pao2fio2_vent_min",
                        "cohort.wbc_max",
                        "cohort.wbc_min",
                        "cohort.bilirubin_max",
                        "cohort.creatinine_max",
                        "cohort.platelet_min",
                        "CASE WHEN (cohort.mingcs IS NULL) THEN NULL::integer WHEN (cohort.mingcs < '3'::double precision) THEN NULL::integer WHEN (cohort.mingcs <= '5'::double precision) THEN 5 WHEN (cohort.mingcs <= '8'::double precision) THEN 3 WHEN (cohort.mingcs <= '13'::double precision) THEN 1 ELSE 0 END",
                        "CASE WHEN ((cohort.heartrate_max IS NULL) AND (cohort.sysbp_min IS NULL)) THEN NULL::integer WHEN (cohort.heartrate_min < '30'::double precision) THEN 5 WHEN (cohort.sysbp_min < '40'::double precision) THEN 5 WHEN (cohort.sysbp_min < '70'::double precision) THEN 3 WHEN (cohort.sysbp_max >= '270'::double precision) THEN 3 WHEN (cohort.heartrate_max >= '140'::double precision) THEN 1 WHEN (cohort.sysbp_max >= '240'::double precision) THEN 1 WHEN (cohort.sysbp_min < '90'::double precision) THEN 1 ELSE 0 END",
                        "CASE WHEN (cohort.creatinine_max IS NULL) THEN NULL::integer WHEN (cohort.creatinine_max >= '1.6'::double precision) THEN 3 WHEN (cohort.creatinine_max >= '1.2'::double precision) THEN 1 ELSE 0 END",
                        "CASE WHEN (cohort.pao2fio2_vent_min IS NULL) THEN 0 WHEN (cohort.pao2fio2_vent_min >= '150'::double precision) THEN 1 WHEN (cohort.pao2fio2_vent_min < '150'::double precision) THEN 3 ELSE NULL::integer END",
                        "CASE WHEN ((cohort.wbc_max IS NULL) AND (cohort.platelet_min IS NULL)) THEN NULL::integer WHEN (cohort.wbc_min < '1'::double precision) THEN 3 WHEN (cohort.wbc_min < '2.5'::double precision) THEN 1 WHEN (cohort.platelet_min < '50'::double precision) THEN 1 WHEN (cohort.wbc_max >= '50'::double precision) THEN 1 ELSE 0 END",
                        "CASE WHEN (cohort.bilirubin_max IS NULL) THEN NULL::integer WHEN (cohort.bilirubin_max >= '2'::double precision) THEN 1 ELSE 0 END"
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Join Type": "Right",
                    "Output": [
                        "ie.icustay_id",
                        "(((((COALESCE(s.neurologic, 0) + COALESCE(s.cardiovascular, 0)) + COALESCE(s.renal, 0)) + COALESCE(s.pulmonary, 0)) + COALESCE(s.hematologic, 0)) + COALESCE(s.hepatic, 0))",
                        "s.neurologic",
                        "s.cardiovascular",
                        "s.renal",
                        "s.pulmonary",
                        "s.hematologic",
                        "s.hepatic"
                    ],
                    "Inner Unique": true,
                    "Hash Cond": "(s.icustay_id = ie.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "scorecomp",
                            "Alias": "s",
                            "Output": [
                                "s.subject_id",
                                "s.hadm_id",
                                "s.icustay_id",
                                "s.intime",
                                "s.outtime",
                                "s.mingcs",
                                "s.heartrate_max",
                                "s.heartrate_min",
                                "s.sysbp_max",
                                "s.sysbp_min",
                                "s.pao2fio2_vent_min",
                                "s.wbc_max",
                                "s.wbc_min",
                                "s.bilirubin_max",
                                "s.creatinine_max",
                                "s.platelet_min",
                                "s.neurologic",
                                "s.cardiovascular",
                                "s.renal",
                                "s.pulmonary",
                                "s.hematologic",
                                "s.hepatic"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "ie.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "icustays",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ie",
                                    "Output": [
                                        "ie.icustay_id"
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.oasis": {
        "sql": "-- ------------------------------------------------------------------\n-- Title: Oxford Acute Severity of Illness Score (oasis)\n-- This query extracts the Oxford acute severity of illness score.\n-- This score is a measure of severity of illness for patients in the ICU.\n-- The score is calculated on the first day of each ICU patients' stay.\n-- ------------------------------------------------------------------\n\n-- Reference for OASIS:\n--    Johnson, Alistair EW, Andrew A. Kramer, and Gari D. Clifford.\n--    \"A new severity of illness scale using a subset of acute physiology and chronic health evaluation data elements shows comparable predictive accuracy*.\"\n--    Critical care medicine 41, no. 7 (2013): 1711-1718.\n\n-- Variables used in OASIS:\n--  Heart rate, GCS, MAP, Temperature, Respiratory rate, Ventilation status (sourced FROM chartevents)\n--  Urine output (sourced from OUTPUTEVENTS)\n--  Elective surgery (sourced FROM admissions and SERVICES)\n--  Pre-ICU in-hospital length of stay (sourced FROM admissions and ICUSTAYS)\n--  Age (sourced FROM patients)\n\n-- The following views are required to run this query:\n--  1) urine_output_first_day - generated by urine-output-first-day.sql\n--  2) vent_first_day - generated by ventilated-first-day.sql\n--  3) vitals_first_day - generated by vitals-first-day.sql\n--  4) gcs_first_day - generated by gcs-first-day.sql\n\n\n-- Regarding missing values:\n--  The ventilation flag is always 0/1. It cannot be missing, since VENT=0 if no data is found for vent settings.\n\n-- Note:\n--  The score is calculated for *all* ICU patients, with the assumption that the user will subselect appropriate ICUSTAY_IDs.\n--  For example, the score is calculated for neonates, but it is likely inappropriate to actually use the score values for these patients.\n\n\nwith surgflag as\n(\n  select ie.icustay_id\n    , max(case\n        when lower(curr_service) like '%surg%' then 1\n        when curr_service = 'ORTHO' then 1\n    else 0 end) as surgical\n  FROM icustays ie\n  left join services se\n    on ie.hadm_id = se.hadm_id\n    and se.transfertime < DATETIME_ADD(ie.intime, INTERVAL '1' DAY)\n  group by ie.icustay_id\n)\n, cohort as\n(\nselect ie.subject_id, ie.hadm_id, ie.icustay_id\n      , ie.intime\n      , ie.outtime\n      , adm.deathtime\n      -- , DATETIME_DIFF(ie.intime, adm.admittime, MINUTE) as preiculos\n      , EXTRACT(MINUTE FROM ie.intime-adm.admittime) as preiculos\n      , EXTRACT(YEAR FROM ie.intime-pat.dob) as age\n      -- , DATETIME_DIFF(ie.intime, pat.dob, `YEAR`) as age\n      , gcs.mingcs\n      , vital.heartrate_max\n      , vital.heartrate_min\n      , vital.meanbp_max\n      , vital.meanbp_min\n      , vital.resprate_max\n      , vital.resprate_min\n      , vital.tempc_max\n      , vital.tempc_min\n      , vent.vent as mechvent\n      , uo.urineoutput\n\n      , case\n          when adm.ADMISSION_TYPE = 'ELECTIVE' and sf.surgical = 1\n            then 1\n          when adm.ADMISSION_TYPE is null or sf.surgical is null\n            then null\n          else 0\n        end as electivesurgery\n\n      -- age group\n      , case\n        when DATETIME_DIFF(ie.intime, pat.dob, 'YEAR') <= 1 then 'neonate'\n        when DATETIME_DIFF(ie.intime, pat.dob, 'YEAR') <= 15 then 'middle'\n        -- when EXTRACT(YEAR FROM ie.intime-pat.dob) <= 1 then 'neonate'\n        -- when EXTRACT(YEAR FROM ie.intime-pat.dob) <= 15 then 'middle'\n        else 'adult' end as icustay_age_group\n\n      -- mortality flags\n      , case\n          when adm.deathtime between ie.intime and ie.outtime\n            then 1\n          when adm.deathtime <= ie.intime -- sometimes there are typographical errors in the death date\n            then 1\n          when adm.dischtime <= ie.outtime and adm.discharge_location = 'DEAD/EXPIRED'\n            then 1\n          else 0 end\n        as icustay_expire_flag\n      , adm.hospital_expire_flag\nFROM icustays ie\ninner join admissions adm\n  on ie.hadm_id = adm.hadm_id\ninner join patients pat\n  on ie.subject_id = pat.subject_id\nleft join surgflag sf\n  on ie.icustay_id = sf.icustay_id\n-- join to custom tables to get more data....\nleft join \"mimic\".\"mimiciii_clinical\".\"gcs_first_day\" gcs\n  on ie.icustay_id = gcs.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"vitals_first_day\" vital\n  on ie.icustay_id = vital.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"urine_output_first_day\" uo\n  on ie.icustay_id = uo.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"ventilation_first_day\" vent\n  on ie.icustay_id = vent.icustay_id\n)\n, scorecomp as\n(\nselect co.subject_id, co.hadm_id, co.icustay_id\n, co.icustay_age_group\n, co.icustay_expire_flag\n, co.hospital_expire_flag\n\n-- Below code calculates the component scores needed for oasis\n, case when preiculos is null then null\n     when preiculos < 10.2 then 5\n     when preiculos < 297 then 3\n     when preiculos < 1440 then 0\n     when preiculos < 18708 then 1\n     else 2 end as preiculos_score\n,  case when age is null then null\n      when age < 24 then 0\n      when age <= 53 then 3\n      when age <= 77 then 6\n      when age <= 89 then 9\n      when age >= 90 then 7\n      else 0 end as age_score\n,  case when mingcs is null then null\n      when mingcs <= 7 then 10\n      when mingcs < 14 then 4\n      when mingcs = 14 then 3\n      else 0 end as gcs_score\n,  case when heartrate_max is null then null\n      when heartrate_max > 125 then 6\n      when heartrate_min < 33 then 4\n      when heartrate_max >= 107 and heartrate_max <= 125 then 3\n      when heartrate_max >= 89 and heartrate_max <= 106 then 1\n      else 0 end as heartrate_score\n,  case when meanbp_min is null then null\n      when meanbp_min < 20.65 then 4\n      when meanbp_min < 51 then 3\n      when meanbp_max > 143.44 then 3\n      when meanbp_min >= 51 and meanbp_min < 61.33 then 2\n      else 0 end as meanbp_score\n,  case when resprate_min is null then null\n      when resprate_min <   6 then 10\n      when resprate_max >  44 then  9\n      when resprate_max >  30 then  6\n      when resprate_max >  22 then  1\n      when resprate_min <  13 then 1 else 0\n      end as resprate_score\n,  case when tempc_max is null then null\n      when tempc_max > 39.88 then 6\n      when tempc_min >= 33.22 and tempc_min <= 35.93 then 4\n      when tempc_max >= 33.22 and tempc_max <= 35.93 then 4\n      when tempc_min < 33.22 then 3\n      when tempc_min > 35.93 and tempc_min <= 36.39 then 2\n      when tempc_max >= 36.89 and tempc_max <= 39.88 then 2\n      else 0 end as temp_score\n,  case when UrineOutput is null then null\n      when UrineOutput < 671.09 then 10\n      when UrineOutput > 6896.80 then 8\n      when UrineOutput >= 671.09\n       and UrineOutput <= 1426.99 then 5\n      when UrineOutput >= 1427.00\n       and UrineOutput <= 2544.14 then 1\n      else 0 end as urineoutput_score\n,  case when mechvent is null then null\n      when mechvent = 1 then 9\n      else 0 end as mechvent_score\n,  case when electivesurgery is null then null\n      when electivesurgery = 1 then 0\n      else 6 end as electivesurgery_score\n\n\n-- The below code gives the component associated with each score\n-- This is not needed to calculate oasis, but provided for user convenience.\n-- If both the min/max are in the normal range (score of 0), then the average value is stored.\n, preiculos\n, age\n, mingcs as gcs\n,  case when heartrate_max is null then null\n      when heartrate_max > 125 then heartrate_max\n      when heartrate_min < 33 then heartrate_min\n      when heartrate_max >= 107 and heartrate_max <= 125 then heartrate_max\n      when heartrate_max >= 89 and heartrate_max <= 106 then heartrate_max\n      else (heartrate_min+heartrate_max)/2 end as heartrate\n,  case when meanbp_min is null then null\n      when meanbp_min < 20.65 then meanbp_min\n      when meanbp_min < 51 then meanbp_min\n      when meanbp_max > 143.44 then meanbp_max\n      when meanbp_min >= 51 and meanbp_min < 61.33 then meanbp_min\n      else (meanbp_min+meanbp_max)/2 end as meanbp\n,  case when resprate_min is null then null\n      when resprate_min <   6 then resprate_min\n      when resprate_max >  44 then resprate_max\n      when resprate_max >  30 then resprate_max\n      when resprate_max >  22 then resprate_max\n      when resprate_min <  13 then resprate_min\n      else (resprate_min+resprate_max)/2 end as resprate\n,  case when tempc_max is null then null\n      when tempc_max > 39.88 then tempc_max\n      when tempc_min >= 33.22 and tempc_min <= 35.93 then tempc_min\n      when tempc_max >= 33.22 and tempc_max <= 35.93 then tempc_max\n      when tempc_min < 33.22 then tempc_min\n      when tempc_min > 35.93 and tempc_min <= 36.39 then tempc_min\n      when tempc_max >= 36.89 and tempc_max <= 39.88 then tempc_max\n      else (tempc_min+tempc_max)/2 end as temp\n,  UrineOutput\n,  mechvent\n,  electivesurgery\nfrom cohort co\n)\n, score as\n(\nselect s.*\n    , coalesce(age_score,0)\n    + coalesce(preiculos_score,0)\n    + coalesce(gcs_score,0)\n    + coalesce(heartrate_score,0)\n    + coalesce(meanbp_score,0)\n    + coalesce(resprate_score,0)\n    + coalesce(temp_score,0)\n    + coalesce(urineoutput_score,0)\n    + coalesce(mechvent_score,0)\n    + coalesce(electivesurgery_score,0)\n    as oasis\nfrom scorecomp s\n)\nselect\n  subject_id, hadm_id, icustay_id\n  , icustay_age_group\n  , hospital_expire_flag\n  , icustay_expire_flag\n  , oasis\n  -- Calculate the probability of in-hospital mortality\n  , 1 / (1 + exp(- (-6.1746 + 0.1275*(oasis) ))) as oasis_PROB\n  , age, age_score\n  , preiculos, preiculos_score\n  , gcs, gcs_score\n  , heartrate, heartrate_score\n  , meanbp, meanbp_score\n  , resprate, resprate_score\n  , temp, temp_score\n  , urineoutput, urineoutput_score\n  , mechvent, mechvent_score\n  , electivesurgery, electivesurgery_score\nfrom score\norder by icustay_id",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.gcs_first_day",
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.patients",
            "mimiciii_clinical.services",
            "mimiciii_clinical.urine_output_first_day",
            "mimiciii_clinical.ventilation_first_day",
            "mimiciii_clinical.vitals_first_day"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "hadm_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "icustay_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "icustay_age_group": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "hospital_expire_flag": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.admissions.hospital_expire_flag",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "icustay_expire_flag": [
                "mimiciii_clinical.admissions.deathtime",
                "mimiciii_clinical.admissions.discharge_location",
                "mimiciii_clinical.admissions.dischtime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.outtime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "oasis": [
                "mimiciii_clinical.admissions.admission_type",
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.gcs_first_day.mingcs",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.curr_service",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.urineoutput",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.vent",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "oasis_prob": [
                "mimiciii_clinical.admissions.admission_type",
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.gcs_first_day.mingcs",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.curr_service",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.urineoutput",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.vent",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "age": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "age_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "preiculos": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "preiculos_score": [
                "mimiciii_clinical.admissions.admittime",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "gcs": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.gcs_first_day.mingcs",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "gcs_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.gcs_first_day.mingcs",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "heartrate": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "heartrate_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "meanbp": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "meanbp_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "resprate": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "resprate_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "temp": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "temp_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "urineoutput": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.urineoutput",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "urineoutput_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.urineoutput",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "mechvent": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.vent",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "mechvent_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.vent",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "electivesurgery": [
                "mimiciii_clinical.admissions.admission_type",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.curr_service",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "electivesurgery_score": [
                "mimiciii_clinical.admissions.admission_type",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.curr_service",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ]
        },
        "table_name": "mimiciii_clinical.oasis",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "score.subject_id",
                "score.hadm_id",
                "score.icustay_id",
                "score.icustay_age_group",
                "score.hospital_expire_flag",
                "score.icustay_expire_flag",
                "score.oasis",
                "(('1'::numeric / ('1'::numeric + exp((- ('-6.1746'::numeric + (0.1275 * (score.oasis)::numeric)))))))",
                "score.age",
                "score.age_score",
                "score.preiculos",
                "score.preiculos_score",
                "score.gcs",
                "score.gcs_score",
                "score.heartrate",
                "score.heartrate_score",
                "score.meanbp",
                "score.meanbp_score",
                "score.resprate",
                "score.resprate_score",
                "score.temp",
                "score.temp_score",
                "score.urineoutput",
                "score.urineoutput_score",
                "score.mechvent",
                "score.mechvent_score",
                "score.electivesurgery",
                "score.electivesurgery_score"
            ],
            "Sort Key": [
                "score.icustay_id"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE surgflag",
                    "Parallel Aware": false,
                    "Output": [
                        "ie.icustay_id",
                        "max(CASE WHEN (lower((se.curr_service)::text) ~~ '%surg%'::text) THEN 1 WHEN ((se.curr_service)::text = 'ORTHO'::text) THEN 1 ELSE 0 END)"
                    ],
                    "Group Key": [
                        "ie.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Right",
                            "Output": [
                                "ie.icustay_id",
                                "se.curr_service"
                            ],
                            "Inner Unique": false,
                            "Hash Cond": "(se.hadm_id = ie.hadm_id)",
                            "Join Filter": "(se.transfertime < datetime_add(ie.intime, '1 day'::interval day))",
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "services",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "se",
                                    "Output": [
                                        "se.row_id",
                                        "se.subject_id",
                                        "se.hadm_id",
                                        "se.transfertime",
                                        "se.prev_service",
                                        "se.curr_service"
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "ie.icustay_id",
                                        "ie.hadm_id",
                                        "ie.intime"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "icustays",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ie",
                                            "Output": [
                                                "ie.icustay_id",
                                                "ie.hadm_id",
                                                "ie.intime"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cohort",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "ie_1.subject_id",
                        "ie_1.hadm_id",
                        "ie_1.icustay_id",
                        "ie_1.intime",
                        "ie_1.outtime",
                        "adm.deathtime",
                        "date_part('minute'::text, (ie_1.intime - adm.admittime))",
                        "date_part('year'::text, (ie_1.intime - pat.dob))",
                        "gcs.mingcs",
                        "vital.heartrate_max",
                        "vital.heartrate_min",
                        "vital.meanbp_max",
                        "vital.meanbp_min",
                        "vital.resprate_max",
                        "vital.resprate_min",
                        "vital.tempc_max",
                        "vital.tempc_min",
                        "vent.vent",
                        "uo.urineoutput",
                        "CASE WHEN (((adm.admission_type)::text = 'ELECTIVE'::text) AND (sf.surgical = 1)) THEN 1 WHEN ((adm.admission_type IS NULL) OR (sf.surgical IS NULL)) THEN NULL::integer ELSE 0 END",
                        "CASE WHEN (datetime_diff(ie_1.intime, pat.dob, 'YEAR'::text) <= '1'::numeric) THEN 'neonate'::text WHEN (datetime_diff(ie_1.intime, pat.dob, 'YEAR'::text) <= '15'::numeric) THEN 'middle'::text ELSE 'adult'::text END",
                        "CASE WHEN ((adm.deathtime >= ie_1.intime) AND (adm.deathtime <= ie_1.outtime)) THEN 1 WHEN (adm.deathtime <= ie_1.intime) THEN 1 WHEN ((adm.dischtime <= ie_1.outtime) AND ((adm.discharge_location)::text = 'DEAD/EXPIRED'::text)) THEN 1 ELSE 0 END",
                        "adm.hospital_expire_flag"
                    ],
                    "Inner Unique": false,
                    "Hash Cond": "(ie_1.icustay_id = vent.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Left",
                            "Output": [
                                "ie_1.subject_id",
                                "ie_1.hadm_id",
                                "ie_1.icustay_id",
                                "ie_1.intime",
                                "ie_1.outtime",
                                "adm.deathtime",
                                "adm.admittime",
                                "adm.admission_type",
                                "adm.dischtime",
                                "adm.discharge_location",
                                "adm.hospital_expire_flag",
                                "pat.dob",
                                "sf.surgical",
                                "gcs.mingcs",
                                "vital.heartrate_max",
                                "vital.heartrate_min",
                                "vital.meanbp_max",
                                "vital.meanbp_min",
                                "vital.resprate_max",
                                "vital.resprate_min",
                                "vital.tempc_max",
                                "vital.tempc_min",
                                "uo.urineoutput"
                            ],
                            "Inner Unique": false,
                            "Hash Cond": "(ie_1.icustay_id = uo.icustay_id)",
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Left",
                                    "Output": [
                                        "ie_1.subject_id",
                                        "ie_1.hadm_id",
                                        "ie_1.icustay_id",
                                        "ie_1.intime",
                                        "ie_1.outtime",
                                        "adm.deathtime",
                                        "adm.admittime",
                                        "adm.admission_type",
                                        "adm.dischtime",
                                        "adm.discharge_location",
                                        "adm.hospital_expire_flag",
                                        "pat.dob",
                                        "sf.surgical",
                                        "gcs.mingcs",
                                        "vital.heartrate_max",
                                        "vital.heartrate_min",
                                        "vital.meanbp_max",
                                        "vital.meanbp_min",
                                        "vital.resprate_max",
                                        "vital.resprate_min",
                                        "vital.tempc_max",
                                        "vital.tempc_min"
                                    ],
                                    "Inner Unique": false,
                                    "Hash Cond": "(ie_1.icustay_id = gcs.icustay_id)",
                                    "Plans": [
                                        {
                                            "Node Type": "Hash Join",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Join Type": "Inner",
                                            "Output": [
                                                "ie_1.subject_id",
                                                "ie_1.hadm_id",
                                                "ie_1.icustay_id",
                                                "ie_1.intime",
                                                "ie_1.outtime",
                                                "adm.deathtime",
                                                "adm.admittime",
                                                "adm.admission_type",
                                                "adm.dischtime",
                                                "adm.discharge_location",
                                                "adm.hospital_expire_flag",
                                                "pat.dob",
                                                "sf.surgical",
                                                "vital.heartrate_max",
                                                "vital.heartrate_min",
                                                "vital.meanbp_max",
                                                "vital.meanbp_min",
                                                "vital.resprate_max",
                                                "vital.resprate_min",
                                                "vital.tempc_max",
                                                "vital.tempc_min"
                                            ],
                                            "Inner Unique": true,
                                            "Hash Cond": "(ie_1.subject_id = pat.subject_id)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Hash Join",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Join Type": "Left",
                                                    "Output": [
                                                        "ie_1.subject_id",
                                                        "ie_1.hadm_id",
                                                        "ie_1.icustay_id",
                                                        "ie_1.intime",
                                                        "ie_1.outtime",
                                                        "adm.deathtime",
                                                        "adm.admittime",
                                                        "adm.admission_type",
                                                        "adm.dischtime",
                                                        "adm.discharge_location",
                                                        "adm.hospital_expire_flag",
                                                        "sf.surgical",
                                                        "vital.heartrate_max",
                                                        "vital.heartrate_min",
                                                        "vital.meanbp_max",
                                                        "vital.meanbp_min",
                                                        "vital.resprate_max",
                                                        "vital.resprate_min",
                                                        "vital.tempc_max",
                                                        "vital.tempc_min"
                                                    ],
                                                    "Inner Unique": false,
                                                    "Hash Cond": "(ie_1.icustay_id = vital.icustay_id)",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Hash Join",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Join Type": "Inner",
                                                            "Output": [
                                                                "ie_1.subject_id",
                                                                "ie_1.hadm_id",
                                                                "ie_1.icustay_id",
                                                                "ie_1.intime",
                                                                "ie_1.outtime",
                                                                "adm.deathtime",
                                                                "adm.admittime",
                                                                "adm.admission_type",
                                                                "adm.dischtime",
                                                                "adm.discharge_location",
                                                                "adm.hospital_expire_flag",
                                                                "sf.surgical"
                                                            ],
                                                            "Inner Unique": true,
                                                            "Hash Cond": "(ie_1.hadm_id = adm.hadm_id)",
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Hash Join",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Join Type": "Right",
                                                                    "Output": [
                                                                        "ie_1.subject_id",
                                                                        "ie_1.hadm_id",
                                                                        "ie_1.icustay_id",
                                                                        "ie_1.intime",
                                                                        "ie_1.outtime",
                                                                        "sf.surgical"
                                                                    ],
                                                                    "Inner Unique": true,
                                                                    "Hash Cond": "(sf.icustay_id = ie_1.icustay_id)",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "CTE Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "CTE Name": "surgflag",
                                                                            "Alias": "sf",
                                                                            "Output": [
                                                                                "sf.surgical",
                                                                                "sf.icustay_id"
                                                                            ]
                                                                        },
                                                                        {
                                                                            "Node Type": "Hash",
                                                                            "Parent Relationship": "Inner",
                                                                            "Parallel Aware": false,
                                                                            "Output": [
                                                                                "ie_1.subject_id",
                                                                                "ie_1.hadm_id",
                                                                                "ie_1.icustay_id",
                                                                                "ie_1.intime",
                                                                                "ie_1.outtime"
                                                                            ],
                                                                            "Plans": [
                                                                                {
                                                                                    "Node Type": "Seq Scan",
                                                                                    "Parent Relationship": "Outer",
                                                                                    "Parallel Aware": false,
                                                                                    "Relation Name": "icustays",
                                                                                    "Schema": "mimiciii_clinical",
                                                                                    "Alias": "ie_1",
                                                                                    "Output": [
                                                                                        "ie_1.subject_id",
                                                                                        "ie_1.hadm_id",
                                                                                        "ie_1.icustay_id",
                                                                                        "ie_1.intime",
                                                                                        "ie_1.outtime"
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Hash",
                                                                    "Parent Relationship": "Inner",
                                                                    "Parallel Aware": false,
                                                                    "Output": [
                                                                        "adm.deathtime",
                                                                        "adm.admittime",
                                                                        "adm.admission_type",
                                                                        "adm.dischtime",
                                                                        "adm.discharge_location",
                                                                        "adm.hospital_expire_flag",
                                                                        "adm.hadm_id"
                                                                    ],
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Seq Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Relation Name": "admissions",
                                                                            "Schema": "mimiciii_clinical",
                                                                            "Alias": "adm",
                                                                            "Output": [
                                                                                "adm.deathtime",
                                                                                "adm.admittime",
                                                                                "adm.admission_type",
                                                                                "adm.dischtime",
                                                                                "adm.discharge_location",
                                                                                "adm.hospital_expire_flag",
                                                                                "adm.hadm_id"
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "Node Type": "Hash",
                                                            "Parent Relationship": "Inner",
                                                            "Parallel Aware": false,
                                                            "Output": [
                                                                "vital.heartrate_max",
                                                                "vital.heartrate_min",
                                                                "vital.meanbp_max",
                                                                "vital.meanbp_min",
                                                                "vital.resprate_max",
                                                                "vital.resprate_min",
                                                                "vital.tempc_max",
                                                                "vital.tempc_min",
                                                                "vital.icustay_id"
                                                            ],
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Seq Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Relation Name": "vitals_first_day",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "vital",
                                                                    "Output": [
                                                                        "vital.heartrate_max",
                                                                        "vital.heartrate_min",
                                                                        "vital.meanbp_max",
                                                                        "vital.meanbp_min",
                                                                        "vital.resprate_max",
                                                                        "vital.resprate_min",
                                                                        "vital.tempc_max",
                                                                        "vital.tempc_min",
                                                                        "vital.icustay_id"
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "Node Type": "Hash",
                                                    "Parent Relationship": "Inner",
                                                    "Parallel Aware": false,
                                                    "Output": [
                                                        "pat.dob",
                                                        "pat.subject_id"
                                                    ],
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Seq Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "patients",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "pat",
                                                            "Output": [
                                                                "pat.dob",
                                                                "pat.subject_id"
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "gcs.mingcs",
                                                "gcs.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "gcs_first_day",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "gcs",
                                                    "Output": [
                                                        "gcs.mingcs",
                                                        "gcs.icustay_id"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "uo.urineoutput",
                                        "uo.icustay_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "urine_output_first_day",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "uo",
                                            "Output": [
                                                "uo.urineoutput",
                                                "uo.icustay_id"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "vent.vent",
                                "vent.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "ventilation_first_day",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "vent",
                                    "Output": [
                                        "vent.vent",
                                        "vent.icustay_id"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE scorecomp",
                    "Parallel Aware": false,
                    "CTE Name": "cohort",
                    "Alias": "co",
                    "Output": [
                        "co.subject_id",
                        "co.hadm_id",
                        "co.icustay_id",
                        "co.icustay_age_group",
                        "co.icustay_expire_flag",
                        "co.hospital_expire_flag",
                        "CASE WHEN (co.preiculos IS NULL) THEN NULL::integer WHEN (co.preiculos < '10.2'::double precision) THEN 5 WHEN (co.preiculos < '297'::double precision) THEN 3 WHEN (co.preiculos < '1440'::double precision) THEN 0 WHEN (co.preiculos < '18708'::double precision) THEN 1 ELSE 2 END",
                        "CASE WHEN (co.age IS NULL) THEN NULL::integer WHEN (co.age < '24'::double precision) THEN 0 WHEN (co.age <= '53'::double precision) THEN 3 WHEN (co.age <= '77'::double precision) THEN 6 WHEN (co.age <= '89'::double precision) THEN 9 WHEN (co.age >= '90'::double precision) THEN 7 ELSE 0 END",
                        "CASE WHEN (co.mingcs IS NULL) THEN NULL::integer WHEN (co.mingcs <= '7'::double precision) THEN 10 WHEN (co.mingcs < '14'::double precision) THEN 4 WHEN (co.mingcs = '14'::double precision) THEN 3 ELSE 0 END",
                        "CASE WHEN (co.heartrate_max IS NULL) THEN NULL::integer WHEN (co.heartrate_max > '125'::double precision) THEN 6 WHEN (co.heartrate_min < '33'::double precision) THEN 4 WHEN ((co.heartrate_max >= '107'::double precision) AND (co.heartrate_max <= '125'::double precision)) THEN 3 WHEN ((co.heartrate_max >= '89'::double precision) AND (co.heartrate_max <= '106'::double precision)) THEN 1 ELSE 0 END",
                        "CASE WHEN (co.meanbp_min IS NULL) THEN NULL::integer WHEN (co.meanbp_min < '20.65'::double precision) THEN 4 WHEN (co.meanbp_min < '51'::double precision) THEN 3 WHEN (co.meanbp_max > '143.44'::double precision) THEN 3 WHEN ((co.meanbp_min >= '51'::double precision) AND (co.meanbp_min < '61.33'::double precision)) THEN 2 ELSE 0 END",
                        "CASE WHEN (co.resprate_min IS NULL) THEN NULL::integer WHEN (co.resprate_min < '6'::double precision) THEN 10 WHEN (co.resprate_max > '44'::double precision) THEN 9 WHEN (co.resprate_max > '30'::double precision) THEN 6 WHEN (co.resprate_max > '22'::double precision) THEN 1 WHEN (co.resprate_min < '13'::double precision) THEN 1 ELSE 0 END",
                        "CASE WHEN (co.tempc_max IS NULL) THEN NULL::integer WHEN (co.tempc_max > '39.88'::double precision) THEN 6 WHEN ((co.tempc_min >= '33.22'::double precision) AND (co.tempc_min <= '35.93'::double precision)) THEN 4 WHEN ((co.tempc_max >= '33.22'::double precision) AND (co.tempc_max <= '35.93'::double precision)) THEN 4 WHEN (co.tempc_min < '33.22'::double precision) THEN 3 WHEN ((co.tempc_min > '35.93'::double precision) AND (co.tempc_min <= '36.39'::double precision)) THEN 2 WHEN ((co.tempc_max >= '36.89'::double precision) AND (co.tempc_max <= '39.88'::double precision)) THEN 2 ELSE 0 END",
                        "CASE WHEN (co.urineoutput IS NULL) THEN NULL::integer WHEN (co.urineoutput < '671.09'::double precision) THEN 10 WHEN (co.urineoutput > '6896.8'::double precision) THEN 8 WHEN ((co.urineoutput >= '671.09'::double precision) AND (co.urineoutput <= '1426.99'::double precision)) THEN 5 WHEN ((co.urineoutput >= '1427'::double precision) AND (co.urineoutput <= '2544.14'::double precision)) THEN 1 ELSE 0 END",
                        "CASE WHEN (co.mechvent IS NULL) THEN NULL::integer WHEN (co.mechvent = 1) THEN 9 ELSE 0 END",
                        "CASE WHEN (co.electivesurgery IS NULL) THEN NULL::integer WHEN (co.electivesurgery = 1) THEN 0 ELSE 6 END",
                        "co.preiculos",
                        "co.age",
                        "co.mingcs",
                        "CASE WHEN (co.heartrate_max IS NULL) THEN NULL::double precision WHEN (co.heartrate_max > '125'::double precision) THEN co.heartrate_max WHEN (co.heartrate_min < '33'::double precision) THEN co.heartrate_min WHEN ((co.heartrate_max >= '107'::double precision) AND (co.heartrate_max <= '125'::double precision)) THEN co.heartrate_max WHEN ((co.heartrate_max >= '89'::double precision) AND (co.heartrate_max <= '106'::double precision)) THEN co.heartrate_max ELSE ((co.heartrate_min + co.heartrate_max) / '2'::double precision) END",
                        "CASE WHEN (co.meanbp_min IS NULL) THEN NULL::double precision WHEN (co.meanbp_min < '20.65'::double precision) THEN co.meanbp_min WHEN (co.meanbp_min < '51'::double precision) THEN co.meanbp_min WHEN (co.meanbp_max > '143.44'::double precision) THEN co.meanbp_max WHEN ((co.meanbp_min >= '51'::double precision) AND (co.meanbp_min < '61.33'::double precision)) THEN co.meanbp_min ELSE ((co.meanbp_min + co.meanbp_max) / '2'::double precision) END",
                        "CASE WHEN (co.resprate_min IS NULL) THEN NULL::double precision WHEN (co.resprate_min < '6'::double precision) THEN co.resprate_min WHEN (co.resprate_max > '44'::double precision) THEN co.resprate_max WHEN (co.resprate_max > '30'::double precision) THEN co.resprate_max WHEN (co.resprate_max > '22'::double precision) THEN co.resprate_max WHEN (co.resprate_min < '13'::double precision) THEN co.resprate_min ELSE ((co.resprate_min + co.resprate_max) / '2'::double precision) END",
                        "CASE WHEN (co.tempc_max IS NULL) THEN NULL::double precision WHEN (co.tempc_max > '39.88'::double precision) THEN co.tempc_max WHEN ((co.tempc_min >= '33.22'::double precision) AND (co.tempc_min <= '35.93'::double precision)) THEN co.tempc_min WHEN ((co.tempc_max >= '33.22'::double precision) AND (co.tempc_max <= '35.93'::double precision)) THEN co.tempc_max WHEN (co.tempc_min < '33.22'::double precision) THEN co.tempc_min WHEN ((co.tempc_min > '35.93'::double precision) AND (co.tempc_min <= '36.39'::double precision)) THEN co.tempc_min WHEN ((co.tempc_max >= '36.89'::double precision) AND (co.tempc_max <= '39.88'::double precision)) THEN co.tempc_max ELSE ((co.tempc_min + co.tempc_max) / '2'::double precision) END",
                        "co.urineoutput",
                        "co.mechvent",
                        "co.electivesurgery"
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE score",
                    "Parallel Aware": false,
                    "CTE Name": "scorecomp",
                    "Alias": "s",
                    "Output": [
                        "s.subject_id",
                        "s.hadm_id",
                        "s.icustay_id",
                        "s.icustay_age_group",
                        "s.icustay_expire_flag",
                        "s.hospital_expire_flag",
                        "s.preiculos_score",
                        "s.age_score",
                        "s.gcs_score",
                        "s.heartrate_score",
                        "s.meanbp_score",
                        "s.resprate_score",
                        "s.temp_score",
                        "s.urineoutput_score",
                        "s.mechvent_score",
                        "s.electivesurgery_score",
                        "s.preiculos",
                        "s.age",
                        "s.gcs",
                        "s.heartrate",
                        "s.meanbp",
                        "s.resprate",
                        "s.temp",
                        "s.urineoutput",
                        "s.mechvent",
                        "s.electivesurgery",
                        "(((((((((COALESCE(s.age_score, 0) + COALESCE(s.preiculos_score, 0)) + COALESCE(s.gcs_score, 0)) + COALESCE(s.heartrate_score, 0)) + COALESCE(s.meanbp_score, 0)) + COALESCE(s.resprate_score, 0)) + COALESCE(s.temp_score, 0)) + COALESCE(s.urineoutput_score, 0)) + COALESCE(s.mechvent_score, 0)) + COALESCE(s.electivesurgery_score, 0))"
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "CTE Name": "score",
                    "Alias": "score",
                    "Output": [
                        "score.subject_id",
                        "score.hadm_id",
                        "score.icustay_id",
                        "score.icustay_age_group",
                        "score.hospital_expire_flag",
                        "score.icustay_expire_flag",
                        "score.oasis",
                        "('1'::numeric / ('1'::numeric + exp((- ('-6.1746'::numeric + (0.1275 * (score.oasis)::numeric))))))",
                        "score.age",
                        "score.age_score",
                        "score.preiculos",
                        "score.preiculos_score",
                        "score.gcs",
                        "score.gcs_score",
                        "score.heartrate",
                        "score.heartrate_score",
                        "score.meanbp",
                        "score.meanbp_score",
                        "score.resprate",
                        "score.resprate_score",
                        "score.temp",
                        "score.temp_score",
                        "score.urineoutput",
                        "score.urineoutput_score",
                        "score.mechvent",
                        "score.mechvent_score",
                        "score.electivesurgery",
                        "score.electivesurgery_score"
                    ]
                }
            ]
        }
    },
    "model.mimic.qsofa": {
        "sql": "-- ------------------------------------------------------------------\n-- Title: Quick Sequential Organ Failure Assessment (qSOFA)\n-- This query extracts the quick sequential organ failure assessment.\n-- This score was a recent revision of SOFA, aiming to detect patients at risk of sepsis.\n-- The score is calculated on the first day of each ICU patients' stay - though needn't be.\n-- ------------------------------------------------------------------\n\n-- Reference for qSOFA:\n--    Singer M, et al. The Third International Consensus Definitions for Sepsis and Septic Shock (Sepsis-3)\n--    Seymour CW, et al. Assessment of Clinical Criteria for Sepsis: For the Third International Consensus Definitions for Sepsis and Septic Shock (Sepsis-3)\n\n-- Variables used in qSOFA:\n--  GCS, respiratory rate, systolic blood pressure\n\n-- The following views required to run this query:\n--  1) gcsfirstday - generated by gcs-first-day.sql\n--  2) vitalsfirstday - generated by vitals-first-day.sql\n\n-- Note:\n--  The score is calculated for *all* ICU patients, with the assumption that the user will subselect appropriate ICUSTAY_IDs.\n--  For example, the score is calculated for neonates, but it is likely inappropriate to actually use the score values for these patients.\n\nwith scorecomp as\n(\nselect ie.icustay_id\n  , v.sysbp_min\n  , v.resprate_max\n  , gcs.mingcs\nFROM icustays ie\nleft join \"mimic\".\"mimiciii_clinical\".\"vitals_first_day\" v\n  on ie.icustay_id = v.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"gcs_first_day\" gcs\n  on ie.icustay_id = gcs.icustay_id\n)\n, scorecalc as\n(\n  -- Calculate the final score\n  -- note that if the underlying data is missing, the component is null\n  -- eventually these are treated as 0 (normal), but knowing when data is missing is useful for debugging\n  select icustay_id\n  , case\n      when sysbp_min is null then null\n      when sysbp_min   <= 100 then 1\n      else 0 end\n    as sysbp_score\n  , case\n      when mingcs is null then null\n      when mingcs   <= 13 then 1\n      else 0 end\n    as gcs_score\n  , case\n      when resprate_max is null then null\n      when resprate_max   >= 22 then 1\n      else 0 end\n    as resprate_score\n  from scorecomp\n)\nselect ie.subject_id, ie.hadm_id, ie.icustay_id\n, coalesce(sysbp_score,0)\n + coalesce(gcs_score,0)\n + coalesce(resprate_score,0)\n as qsofa\n, sysbp_score\n, gcs_score\n, resprate_score\nFROM icustays ie\nleft join scorecalc s\n  on ie.icustay_id = s.icustay_id\norder by ie.icustay_id",
        "tables": [
            "mimiciii_clinical.gcs_first_day",
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.vitals_first_day"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "hadm_id": [
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "icustay_id": [
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "qsofa": [
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.gcs_first_day.mingcs",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.resprate_max",
                "mimiciii_clinical.vitals_first_day.sysbp_min"
            ],
            "sysbp_score": [
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.sysbp_min"
            ],
            "gcs_score": [
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.gcs_first_day.mingcs",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "resprate_score": [
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.resprate_max"
            ]
        },
        "table_name": "mimiciii_clinical.qsofa",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "ie.subject_id",
                "ie.hadm_id",
                "ie.icustay_id",
                "(((COALESCE(s.sysbp_score, 0) + COALESCE(s.gcs_score, 0)) + COALESCE(s.resprate_score, 0)))",
                "s.sysbp_score",
                "s.gcs_score",
                "s.resprate_score"
            ],
            "Sort Key": [
                "ie.icustay_id"
            ],
            "Plans": [
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE scorecomp",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "ie_1.icustay_id",
                        "v.sysbp_min",
                        "v.resprate_max",
                        "gcs.mingcs"
                    ],
                    "Inner Unique": false,
                    "Hash Cond": "(ie_1.icustay_id = gcs.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Right",
                            "Output": [
                                "ie_1.icustay_id",
                                "v.sysbp_min",
                                "v.resprate_max"
                            ],
                            "Inner Unique": true,
                            "Hash Cond": "(v.icustay_id = ie_1.icustay_id)",
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "vitals_first_day",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "v",
                                    "Output": [
                                        "v.subject_id",
                                        "v.hadm_id",
                                        "v.icustay_id",
                                        "v.heartrate_min",
                                        "v.heartrate_max",
                                        "v.heartrate_mean",
                                        "v.sysbp_min",
                                        "v.sysbp_max",
                                        "v.sysbp_mean",
                                        "v.diasbp_min",
                                        "v.diasbp_max",
                                        "v.diasbp_mean",
                                        "v.meanbp_min",
                                        "v.meanbp_max",
                                        "v.meanbp_mean",
                                        "v.resprate_min",
                                        "v.resprate_max",
                                        "v.resprate_mean",
                                        "v.tempc_min",
                                        "v.tempc_max",
                                        "v.tempc_mean",
                                        "v.spo2_min",
                                        "v.spo2_max",
                                        "v.spo2_mean",
                                        "v.glucose_min",
                                        "v.glucose_max",
                                        "v.glucose_mean"
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "ie_1.icustay_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "icustays",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "ie_1",
                                            "Output": [
                                                "ie_1.icustay_id"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "gcs.mingcs",
                                "gcs.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "gcs_first_day",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "gcs",
                                    "Output": [
                                        "gcs.mingcs",
                                        "gcs.icustay_id"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE scorecalc",
                    "Parallel Aware": false,
                    "CTE Name": "scorecomp",
                    "Alias": "scorecomp",
                    "Output": [
                        "scorecomp.icustay_id",
                        "CASE WHEN (scorecomp.sysbp_min IS NULL) THEN NULL::integer WHEN (scorecomp.sysbp_min <= '100'::double precision) THEN 1 ELSE 0 END",
                        "CASE WHEN (scorecomp.mingcs IS NULL) THEN NULL::integer WHEN (scorecomp.mingcs <= '13'::double precision) THEN 1 ELSE 0 END",
                        "CASE WHEN (scorecomp.resprate_max IS NULL) THEN NULL::integer WHEN (scorecomp.resprate_max >= '22'::double precision) THEN 1 ELSE 0 END"
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Join Type": "Right",
                    "Output": [
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id",
                        "((COALESCE(s.sysbp_score, 0) + COALESCE(s.gcs_score, 0)) + COALESCE(s.resprate_score, 0))",
                        "s.sysbp_score",
                        "s.gcs_score",
                        "s.resprate_score"
                    ],
                    "Inner Unique": true,
                    "Hash Cond": "(s.icustay_id = ie.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "scorecalc",
                            "Alias": "s",
                            "Output": [
                                "s.icustay_id",
                                "s.sysbp_score",
                                "s.gcs_score",
                                "s.resprate_score"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "ie.subject_id",
                                "ie.hadm_id",
                                "ie.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "icustays",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ie",
                                    "Output": [
                                        "ie.subject_id",
                                        "ie.hadm_id",
                                        "ie.icustay_id"
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.saps": {
        "sql": "-- ------------------------------------------------------------------\n-- Title: Simplified Acute Physiology Score (SAPS)\n-- This query extracts the simplified acute physiology score.\n-- This score is a measure of patient severity of illness.\n-- The score is calculated on the first day of each ICU patients' stay.\n-- ------------------------------------------------------------------\n\n-- Reference for SAPS:\n--    Jean-Roger Le Gall, Philippe Loirat, Annick Alperovitch, Paul Glaser, Claude Granthil,\n--    Daniel Mathieu, Philippe Mercier, Remi Thomas, and Daniel Villers.\n--    \"A simplified acute physiology score for ICU patients.\"\n--    Critical care medicine 12, no. 11 (1984): 975-977.\n\n-- Variables used in SAPS:\n--  Age, GCS\n--  VITALS: Heart rate, systolic blood pressure, temperature, respiration rate\n--  FLAGS: ventilation/cpap\n--  IO: urine output\n--  LABS: blood urea nitrogen, hematocrit, WBC, glucose, potassium, sodium, HCO3\n\n-- The following views are required to run this query:\n--  1) urine_output_first_day - generated by urine-output-first-day.sql\n--  2) vent_first_day - generated by ventilated-first-day.sql\n--  3) vitals_first_day - generated by vitals-first-day.sql\n--  4) gcs_first_day - generated by gcs-first-day.sql\n--  5) labs_first_day - generated by labs-first-day.sql\n\n-- Note:\n--  The score is calculated for *all* ICU patients, with the assumption that the user will subselect appropriate ICUSTAY_IDs.\n--  For example, the score is calculated for neonates, but it is likely inappropriate to actually use the score values for these patients.\n\n-- extract CPAP from the \"Oxygen Delivery Device\" fields\nwith cpap as\n(\n  select ie.icustay_id\n  , max(CASE\n        WHEN lower(ce.value) LIKE '%cpap%' THEN 1\n        WHEN lower(ce.value) LIKE '%bipap mask%' THEN 1\n      else 0 end) as cpap\n  FROM icustays ie\n  inner join chartevents ce\n    on ie.icustay_id = ce.icustay_id\n    and ce.charttime between ie.intime and DATETIME_ADD(ie.intime, INTERVAL '1' DAY)\n  where itemid in\n  (\n    -- TODO: when metavision data import fixed, check the values in 226732 match the value clause below\n    467, 469, 226732\n  )\n  and (lower(ce.value) LIKE '%cpap%' or lower(ce.value) LIKE '%bipap mask%')\n  -- exclude rows marked as error\n  AND (ce.error IS NULL OR ce.error = 0)\n  group by ie.icustay_id\n)\n, cohort as\n(\nselect ie.subject_id, ie.hadm_id, ie.icustay_id\n      , ie.intime\n      , ie.outtime\n\n      -- the casts ensure the result is numeric.. we could equally extract EPOCH from the interval\n      -- however this code works in Oracle and Postgres\n      , DATETIME_DIFF(ie.intime, pat.dob, 'YEAR') as age\n      , gcs.mingcs\n      , vital.heartrate_max\n      , vital.heartrate_min\n      , vital.sysbp_max\n      , vital.sysbp_min\n      , vital.resprate_max\n      , vital.resprate_min\n      , vital.tempc_max\n      , vital.tempc_min\n\n      , coalesce(vital.glucose_max, labs.glucose_max) as glucose_max\n      , coalesce(vital.glucose_min, labs.glucose_min) as glucose_min\n\n      , labs.bun_max\n      , labs.bun_min\n      , labs.hematocrit_max\n      , labs.hematocrit_min\n      , labs.wbc_max\n      , labs.wbc_min\n      , labs.sodium_max\n      , labs.sodium_min\n      , labs.potassium_max\n      , labs.potassium_min\n      , labs.bicarbonate_max\n      , labs.bicarbonate_min\n\n      , vent.vent as mechvent\n      , uo.urineoutput\n\n      , cp.cpap\n\nFROM icustays ie\ninner join admissions adm\n  on ie.hadm_id = adm.hadm_id\ninner join patients pat\n  on ie.subject_id = pat.subject_id\n\n-- join to above view to get CPAP\nleft join cpap cp\n  on ie.icustay_id = cp.icustay_id\n\n-- join to custom tables to get more data....\nleft join \"mimic\".\"mimiciii_clinical\".\"gcs_first_day\" gcs\n  on ie.icustay_id = gcs.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"vitals_first_day\" vital\n  on ie.icustay_id = vital.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"urine_output_first_day\" uo\n  on ie.icustay_id = uo.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"ventilation_first_day\" vent\n  on ie.icustay_id = vent.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"labs_first_day\" labs\n  on ie.icustay_id = labs.icustay_id\n)\n, scorecomp as\n(\nselect\n  cohort.*\n  -- Below code calculates the component scores needed for SAPS\n  , case\n      when age is null then null\n      when age <= 45 then 0\n      when age <= 55 then 1\n      when age <= 65 then 2\n      when age <= 75 then 3\n      when age >  75 then 4\n    end as age_score\n  , case\n      when heartrate_max is null then null\n      when heartrate_max >= 180 then 4\n      when heartrate_min < 40 then 4\n      when heartrate_max >= 140 then 3\n      when heartrate_min <= 54 then 3\n      when heartrate_max >= 110 then 2\n      when heartrate_min <= 69 then 2\n      when heartrate_max >= 70 and heartrate_max <= 109\n        and heartrate_min >= 70 and heartrate_min <= 109\n      then 0\n    end as hr_score\n  , case\n      when sysbp_min is null then null\n      when sysbp_max >= 190 then 4\n      when sysbp_min < 55 then 4\n      when sysbp_max >= 150 then 2\n      when sysbp_min <= 79 then 2\n      when sysbp_max >= 80 and sysbp_max <= 149\n        and sysbp_min >= 80 and sysbp_min <= 149\n        then 0\n    end as sysbp_score\n\n  , case\n      when tempc_max is null then null\n      when tempc_max >= 41.0 then 4\n      when tempc_min <  30.0 then 4\n      when tempc_max >= 39.0 then 3\n      when tempc_min <= 31.9  then 3\n      when tempc_min <= 33.9  then 2\n      when tempc_max >  38.4 then 1\n      when tempc_min <  36.0  then 1\n      when tempc_max >= 36.0 and tempc_max <= 38.4\n       and tempc_min >= 36.0 and tempc_min <= 38.4\n        then 0\n    end as temp_score\n\n  , case\n      when resprate_min is null then null\n      when resprate_max >= 50 then 4\n      when resprate_min <  6 then 4\n      when resprate_max >= 35 then 3\n      when resprate_min <= 9 then 2\n      when resprate_max >= 25 then 1\n      when resprate_min <= 11 then 1\n      when  resprate_max >= 12 and resprate_max <= 24\n        and resprate_min >= 12 and resprate_min <= 24\n          then 0\n      end as resp_score\n\n  , case\n      when coalesce(mechvent,cpap) is null then null\n      when cpap = 1 then 3\n      when mechvent = 1 then 3\n      else 0\n    end as vent_score\n\n  , case\n      when UrineOutput is null then null\n      when UrineOutput >  5000.0 then 2\n      when UrineOutput >= 3500.0 then 1\n      when UrineOutput >=  700.0 then 0\n      when UrineOutput >=  500.0 then 2\n      when UrineOutput >=  200.0 then 3\n      when UrineOutput <   200.0 then 4\n    end as uo_score\n\n  , case\n      when bun_max is null then null\n      when bun_max >= 55.0 then 4\n      when bun_max >= 36.0 then 3\n      when bun_max >= 29.0 then 2\n      when bun_max >= 7.50 then 1\n      when bun_min < 3.5 then 1\n      when  bun_max >= 3.5 and bun_max < 7.5\n        and bun_min >= 3.5 and bun_min < 7.5\n          then 0\n    end as bun_score\n\n  , case\n      when hematocrit_max is null then null\n      when hematocrit_max >= 60.0 then 4\n      when hematocrit_min <  20.0 then 4\n      when hematocrit_max >= 50.0 then 2\n      when hematocrit_min < 30.0 then 2\n      when hematocrit_max >= 46.0 then 1\n      when  hematocrit_max >= 30.0 and hematocrit_max < 46.0\n        and hematocrit_min >= 30.0 and hematocrit_min < 46.0\n          then 0\n      end as hematocrit_score\n\n  , case\n      when wbc_max is null then null\n      when wbc_max >= 40.0 then 4\n      when wbc_min <   1.0 then 4\n      when wbc_max >= 20.0 then 2\n      when wbc_min <   3.0 then 2\n      when wbc_max >= 15.0 then 1\n      when wbc_max >=  3.0 and wbc_max < 15.0\n       and wbc_min >=  3.0 and wbc_min < 15.0\n        then 0\n    end as wbc_score\n\n  , case\n      when glucose_max is null then null\n      when glucose_max >= 44.5 then 4\n      when glucose_min <   1.6 then 4\n      when glucose_max >= 27.8 then 3\n      when glucose_min <   2.8 then 3\n      when glucose_min <   3.9 then 2\n      when glucose_max >= 14.0 then 1\n      when glucose_max >=  3.9 and glucose_max < 14.0\n       and glucose_min >=  3.9 and glucose_min < 14.0\n        then 0\n      end as glucose_score\n\n  , case\n      when potassium_max is null then null\n      when potassium_max >= 7.0 then 4\n      when potassium_min <  2.5 then 4\n      when potassium_max >= 6.0 then 3\n      when potassium_min <  3.0 then 2\n      when potassium_max >= 5.5 then 1\n      when potassium_min <  3.5 then 1\n      when potassium_max >= 3.5 and potassium_max < 5.5\n       and potassium_min >= 3.5 and potassium_min < 5.5\n        then 0\n      end as potassium_score\n\n  , case\n      when sodium_max is null then null\n      when sodium_max >= 180 then 4\n      when sodium_min  < 110 then 4\n      when sodium_max >= 161 then 3\n      when sodium_min  < 120 then 3\n      when sodium_max >= 156 then 2\n      when sodium_min  < 130 then 2\n      when sodium_max >= 151 then 1\n      when sodium_max >= 130 and sodium_max < 151\n       and sodium_min >= 130 and sodium_min < 151\n        then 0\n      end as sodium_score\n\n  , case\n      when bicarbonate_max is null then null\n      when bicarbonate_min <   5.0 then 4\n      when bicarbonate_max >= 40.0 then 3\n      when bicarbonate_min <  10.0 then 3\n      when bicarbonate_max >= 30.0 then 1\n      when bicarbonate_min <  20.0 then 1\n      when bicarbonate_max >= 20.0 and bicarbonate_max < 30.0\n       and bicarbonate_min >= 20.0 and bicarbonate_min < 30.0\n          then 0\n      end as bicarbonate_score\n\n   , case\n      when mingcs is null then null\n        when mingcs <  3 then null -- erroneous value/on trach\n        when mingcs =  3 then 4\n        when mingcs <  7 then 3\n        when mingcs < 10 then 2\n        when mingcs < 13 then 1\n        when mingcs >= 13\n         and mingcs <= 15\n          then 0\n        end as gcs_score\nfrom cohort\n)\nselect ie.subject_id, ie.hadm_id, ie.icustay_id\n-- coalesce statements impute normal score of zero if data element is missing\n, coalesce(age_score,0)\n+ coalesce(hr_score,0)\n+ coalesce(sysbp_score,0)\n+ coalesce(resp_score,0)\n+ coalesce(temp_score,0)\n+ coalesce(uo_score,0)\n+ coalesce(vent_score,0)\n+ coalesce(bun_score,0)\n+ coalesce(hematocrit_score,0)\n+ coalesce(wbc_score,0)\n+ coalesce(glucose_score,0)\n+ coalesce(potassium_score,0)\n+ coalesce(sodium_score,0)\n+ coalesce(bicarbonate_score,0)\n+ coalesce(gcs_score,0)\n  as SAPS\n, age_score\n, hr_score\n, sysbp_score\n, resp_score\n, temp_score\n, uo_score\n, vent_score\n, bun_score\n, hematocrit_score\n, wbc_score\n, glucose_score\n, potassium_score\n, sodium_score\n, bicarbonate_score\n, gcs_score\n\nFROM icustays ie\nleft join scorecomp s\n  on ie.icustay_id = s.icustay_id\norder by ie.icustay_id",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.gcs_first_day",
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.labs_first_day",
            "mimiciii_clinical.patients",
            "mimiciii_clinical.urine_output_first_day",
            "mimiciii_clinical.ventilation_first_day",
            "mimiciii_clinical.vitals_first_day"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "hadm_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "icustay_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "saps": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.gcs_first_day.mingcs",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.bicarbonate_max",
                "mimiciii_clinical.labs_first_day.bicarbonate_min",
                "mimiciii_clinical.labs_first_day.bun_max",
                "mimiciii_clinical.labs_first_day.bun_min",
                "mimiciii_clinical.labs_first_day.glucose_max",
                "mimiciii_clinical.labs_first_day.glucose_min",
                "mimiciii_clinical.labs_first_day.hematocrit_max",
                "mimiciii_clinical.labs_first_day.hematocrit_min",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.potassium_max",
                "mimiciii_clinical.labs_first_day.potassium_min",
                "mimiciii_clinical.labs_first_day.sodium_max",
                "mimiciii_clinical.labs_first_day.sodium_min",
                "mimiciii_clinical.labs_first_day.wbc_max",
                "mimiciii_clinical.labs_first_day.wbc_min",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.urineoutput",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.vent",
                "mimiciii_clinical.vitals_first_day.glucose_max",
                "mimiciii_clinical.vitals_first_day.glucose_min",
                "mimiciii_clinical.vitals_first_day.heartrate_max",
                "mimiciii_clinical.vitals_first_day.heartrate_min",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.resprate_max",
                "mimiciii_clinical.vitals_first_day.resprate_min",
                "mimiciii_clinical.vitals_first_day.sysbp_max",
                "mimiciii_clinical.vitals_first_day.sysbp_min",
                "mimiciii_clinical.vitals_first_day.tempc_max",
                "mimiciii_clinical.vitals_first_day.tempc_min"
            ],
            "age_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "hr_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.heartrate_max",
                "mimiciii_clinical.vitals_first_day.heartrate_min",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "sysbp_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.sysbp_max",
                "mimiciii_clinical.vitals_first_day.sysbp_min"
            ],
            "resp_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.resprate_max",
                "mimiciii_clinical.vitals_first_day.resprate_min"
            ],
            "temp_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.tempc_max",
                "mimiciii_clinical.vitals_first_day.tempc_min"
            ],
            "uo_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.urineoutput",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "vent_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.vent",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "bun_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.bun_max",
                "mimiciii_clinical.labs_first_day.bun_min",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "hematocrit_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.hematocrit_max",
                "mimiciii_clinical.labs_first_day.hematocrit_min",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "wbc_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.wbc_max",
                "mimiciii_clinical.labs_first_day.wbc_min",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "glucose_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.glucose_max",
                "mimiciii_clinical.labs_first_day.glucose_min",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.glucose_max",
                "mimiciii_clinical.vitals_first_day.glucose_min",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "potassium_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.potassium_max",
                "mimiciii_clinical.labs_first_day.potassium_min",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "sodium_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.sodium_max",
                "mimiciii_clinical.labs_first_day.sodium_min",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "bicarbonate_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.bicarbonate_max",
                "mimiciii_clinical.labs_first_day.bicarbonate_min",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "gcs_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.gcs_first_day.mingcs",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ]
        },
        "table_name": "mimiciii_clinical.saps",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "ie.subject_id",
                "ie.hadm_id",
                "ie.icustay_id",
                "(((((((((((((((COALESCE(s.age_score, 0) + COALESCE(s.hr_score, 0)) + COALESCE(s.sysbp_score, 0)) + COALESCE(s.resp_score, 0)) + COALESCE(s.temp_score, 0)) + COALESCE(s.uo_score, 0)) + COALESCE(s.vent_score, 0)) + COALESCE(s.bun_score, 0)) + COALESCE(s.hematocrit_score, 0)) + COALESCE(s.wbc_score, 0)) + COALESCE(s.glucose_score, 0)) + COALESCE(s.potassium_score, 0)) + COALESCE(s.sodium_score, 0)) + COALESCE(s.bicarbonate_score, 0)) + COALESCE(s.gcs_score, 0)))",
                "s.age_score",
                "s.hr_score",
                "s.sysbp_score",
                "s.resp_score",
                "s.temp_score",
                "s.uo_score",
                "s.vent_score",
                "s.bun_score",
                "s.hematocrit_score",
                "s.wbc_score",
                "s.glucose_score",
                "s.potassium_score",
                "s.sodium_score",
                "s.bicarbonate_score",
                "s.gcs_score"
            ],
            "Sort Key": [
                "ie.icustay_id"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cpap",
                    "Parallel Aware": false,
                    "Output": [
                        "ie_1.icustay_id",
                        "max(CASE WHEN (lower((ce.value)::text) ~~ '%cpap%'::text) THEN 1 WHEN (lower((ce.value)::text) ~~ '%bipap mask%'::text) THEN 1 ELSE 0 END)"
                    ],
                    "Group Key": [
                        "ie_1.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ie_1.icustay_id",
                                "ce.value"
                            ],
                            "Sort Key": [
                                "ie_1.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "ie_1.icustay_id",
                                        "ce.value"
                                    ],
                                    "Inner Unique": true,
                                    "Hash Cond": "(ce.icustay_id = ie_1.icustay_id)",
                                    "Join Filter": "((ce.charttime >= ie_1.intime) AND (ce.charttime <= datetime_add(ie_1.intime, '1 day'::interval day)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Append",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_45",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce",
                                                    "Output": [
                                                        "ce.value",
                                                        "ce.icustay_id",
                                                        "ce.charttime"
                                                    ],
                                                    "Filter": "(((ce.error IS NULL) OR (ce.error = 0)) AND (ce.itemid = ANY ('{467,469,226732}'::integer[])) AND ((lower((ce.value)::text) ~~ '%cpap%'::text) OR (lower((ce.value)::text) ~~ '%bipap mask%'::text)))"
                                                },
                                                {
                                                    "Node Type": "Index Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Scan Direction": "Forward",
                                                    "Index Name": "chartevents_46_idx01",
                                                    "Relation Name": "chartevents_46",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_1",
                                                    "Output": [
                                                        "ce_1.value",
                                                        "ce_1.icustay_id",
                                                        "ce_1.charttime"
                                                    ],
                                                    "Index Cond": "(ce_1.itemid = ANY ('{467,469,226732}'::integer[]))",
                                                    "Filter": "(((ce_1.error IS NULL) OR (ce_1.error = 0)) AND ((lower((ce_1.value)::text) ~~ '%cpap%'::text) OR (lower((ce_1.value)::text) ~~ '%bipap mask%'::text)))"
                                                },
                                                {
                                                    "Node Type": "Bitmap Heap Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_201",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_2",
                                                    "Output": [
                                                        "ce_2.value",
                                                        "ce_2.icustay_id",
                                                        "ce_2.charttime"
                                                    ],
                                                    "Recheck Cond": "(ce_2.itemid = ANY ('{467,469,226732}'::integer[]))",
                                                    "Filter": "(((ce_2.error IS NULL) OR (ce_2.error = 0)) AND ((lower((ce_2.value)::text) ~~ '%cpap%'::text) OR (lower((ce_2.value)::text) ~~ '%bipap mask%'::text)))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Bitmap Index Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Index Name": "chartevents_201_idx01",
                                                            "Index Cond": "(ce_2.itemid = ANY ('{467,469,226732}'::integer[]))"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ie_1.icustay_id",
                                                "ie_1.intime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "icustays",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ie_1",
                                                    "Output": [
                                                        "ie_1.icustay_id",
                                                        "ie_1.intime"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cohort",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "ie_2.subject_id",
                        "ie_2.hadm_id",
                        "ie_2.icustay_id",
                        "ie_2.intime",
                        "ie_2.outtime",
                        "datetime_diff(ie_2.intime, pat.dob, 'YEAR'::text)",
                        "gcs.mingcs",
                        "vital.heartrate_max",
                        "vital.heartrate_min",
                        "vital.sysbp_max",
                        "vital.sysbp_min",
                        "vital.resprate_max",
                        "vital.resprate_min",
                        "vital.tempc_max",
                        "vital.tempc_min",
                        "COALESCE(vital.glucose_max, labs.glucose_max)",
                        "COALESCE(vital.glucose_min, labs.glucose_min)",
                        "labs.bun_max",
                        "labs.bun_min",
                        "labs.hematocrit_max",
                        "labs.hematocrit_min",
                        "labs.wbc_max",
                        "labs.wbc_min",
                        "labs.sodium_max",
                        "labs.sodium_min",
                        "labs.potassium_max",
                        "labs.potassium_min",
                        "labs.bicarbonate_max",
                        "labs.bicarbonate_min",
                        "vent.vent",
                        "uo.urineoutput",
                        "cp.cpap"
                    ],
                    "Inner Unique": false,
                    "Hash Cond": "(ie_2.icustay_id = labs.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Left",
                            "Output": [
                                "ie_2.subject_id",
                                "ie_2.hadm_id",
                                "ie_2.icustay_id",
                                "ie_2.intime",
                                "ie_2.outtime",
                                "pat.dob",
                                "cp.cpap",
                                "gcs.mingcs",
                                "vital.heartrate_max",
                                "vital.heartrate_min",
                                "vital.sysbp_max",
                                "vital.sysbp_min",
                                "vital.resprate_max",
                                "vital.resprate_min",
                                "vital.tempc_max",
                                "vital.tempc_min",
                                "vital.glucose_max",
                                "vital.glucose_min",
                                "uo.urineoutput",
                                "vent.vent"
                            ],
                            "Inner Unique": false,
                            "Hash Cond": "(ie_2.icustay_id = vent.icustay_id)",
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Left",
                                    "Output": [
                                        "ie_2.subject_id",
                                        "ie_2.hadm_id",
                                        "ie_2.icustay_id",
                                        "ie_2.intime",
                                        "ie_2.outtime",
                                        "pat.dob",
                                        "cp.cpap",
                                        "gcs.mingcs",
                                        "vital.heartrate_max",
                                        "vital.heartrate_min",
                                        "vital.sysbp_max",
                                        "vital.sysbp_min",
                                        "vital.resprate_max",
                                        "vital.resprate_min",
                                        "vital.tempc_max",
                                        "vital.tempc_min",
                                        "vital.glucose_max",
                                        "vital.glucose_min",
                                        "uo.urineoutput"
                                    ],
                                    "Inner Unique": false,
                                    "Hash Cond": "(ie_2.icustay_id = uo.icustay_id)",
                                    "Plans": [
                                        {
                                            "Node Type": "Hash Join",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Join Type": "Left",
                                            "Output": [
                                                "ie_2.subject_id",
                                                "ie_2.hadm_id",
                                                "ie_2.icustay_id",
                                                "ie_2.intime",
                                                "ie_2.outtime",
                                                "pat.dob",
                                                "cp.cpap",
                                                "gcs.mingcs",
                                                "vital.heartrate_max",
                                                "vital.heartrate_min",
                                                "vital.sysbp_max",
                                                "vital.sysbp_min",
                                                "vital.resprate_max",
                                                "vital.resprate_min",
                                                "vital.tempc_max",
                                                "vital.tempc_min",
                                                "vital.glucose_max",
                                                "vital.glucose_min"
                                            ],
                                            "Inner Unique": false,
                                            "Hash Cond": "(ie_2.icustay_id = gcs.icustay_id)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Hash Join",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Join Type": "Inner",
                                                    "Output": [
                                                        "ie_2.subject_id",
                                                        "ie_2.hadm_id",
                                                        "ie_2.icustay_id",
                                                        "ie_2.intime",
                                                        "ie_2.outtime",
                                                        "pat.dob",
                                                        "cp.cpap",
                                                        "vital.heartrate_max",
                                                        "vital.heartrate_min",
                                                        "vital.sysbp_max",
                                                        "vital.sysbp_min",
                                                        "vital.resprate_max",
                                                        "vital.resprate_min",
                                                        "vital.tempc_max",
                                                        "vital.tempc_min",
                                                        "vital.glucose_max",
                                                        "vital.glucose_min"
                                                    ],
                                                    "Inner Unique": true,
                                                    "Hash Cond": "(ie_2.subject_id = pat.subject_id)",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Hash Join",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Join Type": "Inner",
                                                            "Output": [
                                                                "ie_2.subject_id",
                                                                "ie_2.hadm_id",
                                                                "ie_2.icustay_id",
                                                                "ie_2.intime",
                                                                "ie_2.outtime",
                                                                "cp.cpap",
                                                                "vital.heartrate_max",
                                                                "vital.heartrate_min",
                                                                "vital.sysbp_max",
                                                                "vital.sysbp_min",
                                                                "vital.resprate_max",
                                                                "vital.resprate_min",
                                                                "vital.tempc_max",
                                                                "vital.tempc_min",
                                                                "vital.glucose_max",
                                                                "vital.glucose_min"
                                                            ],
                                                            "Inner Unique": true,
                                                            "Hash Cond": "(ie_2.hadm_id = adm.hadm_id)",
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Hash Join",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Join Type": "Right",
                                                                    "Output": [
                                                                        "ie_2.subject_id",
                                                                        "ie_2.hadm_id",
                                                                        "ie_2.icustay_id",
                                                                        "ie_2.intime",
                                                                        "ie_2.outtime",
                                                                        "cp.cpap",
                                                                        "vital.heartrate_max",
                                                                        "vital.heartrate_min",
                                                                        "vital.sysbp_max",
                                                                        "vital.sysbp_min",
                                                                        "vital.resprate_max",
                                                                        "vital.resprate_min",
                                                                        "vital.tempc_max",
                                                                        "vital.tempc_min",
                                                                        "vital.glucose_max",
                                                                        "vital.glucose_min"
                                                                    ],
                                                                    "Inner Unique": false,
                                                                    "Hash Cond": "(vital.icustay_id = ie_2.icustay_id)",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Seq Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Relation Name": "vitals_first_day",
                                                                            "Schema": "mimiciii_clinical",
                                                                            "Alias": "vital",
                                                                            "Output": [
                                                                                "vital.heartrate_max",
                                                                                "vital.heartrate_min",
                                                                                "vital.sysbp_max",
                                                                                "vital.sysbp_min",
                                                                                "vital.resprate_max",
                                                                                "vital.resprate_min",
                                                                                "vital.tempc_max",
                                                                                "vital.tempc_min",
                                                                                "vital.glucose_max",
                                                                                "vital.glucose_min",
                                                                                "vital.icustay_id"
                                                                            ]
                                                                        },
                                                                        {
                                                                            "Node Type": "Hash",
                                                                            "Parent Relationship": "Inner",
                                                                            "Parallel Aware": false,
                                                                            "Output": [
                                                                                "ie_2.subject_id",
                                                                                "ie_2.hadm_id",
                                                                                "ie_2.icustay_id",
                                                                                "ie_2.intime",
                                                                                "ie_2.outtime",
                                                                                "cp.cpap"
                                                                            ],
                                                                            "Plans": [
                                                                                {
                                                                                    "Node Type": "Hash Join",
                                                                                    "Parent Relationship": "Outer",
                                                                                    "Parallel Aware": false,
                                                                                    "Join Type": "Right",
                                                                                    "Output": [
                                                                                        "ie_2.subject_id",
                                                                                        "ie_2.hadm_id",
                                                                                        "ie_2.icustay_id",
                                                                                        "ie_2.intime",
                                                                                        "ie_2.outtime",
                                                                                        "cp.cpap"
                                                                                    ],
                                                                                    "Inner Unique": true,
                                                                                    "Hash Cond": "(cp.icustay_id = ie_2.icustay_id)",
                                                                                    "Plans": [
                                                                                        {
                                                                                            "Node Type": "CTE Scan",
                                                                                            "Parent Relationship": "Outer",
                                                                                            "Parallel Aware": false,
                                                                                            "CTE Name": "cpap",
                                                                                            "Alias": "cp",
                                                                                            "Output": [
                                                                                                "cp.cpap",
                                                                                                "cp.icustay_id"
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "Node Type": "Hash",
                                                                                            "Parent Relationship": "Inner",
                                                                                            "Parallel Aware": false,
                                                                                            "Output": [
                                                                                                "ie_2.subject_id",
                                                                                                "ie_2.hadm_id",
                                                                                                "ie_2.icustay_id",
                                                                                                "ie_2.intime",
                                                                                                "ie_2.outtime"
                                                                                            ],
                                                                                            "Plans": [
                                                                                                {
                                                                                                    "Node Type": "Seq Scan",
                                                                                                    "Parent Relationship": "Outer",
                                                                                                    "Parallel Aware": false,
                                                                                                    "Relation Name": "icustays",
                                                                                                    "Schema": "mimiciii_clinical",
                                                                                                    "Alias": "ie_2",
                                                                                                    "Output": [
                                                                                                        "ie_2.subject_id",
                                                                                                        "ie_2.hadm_id",
                                                                                                        "ie_2.icustay_id",
                                                                                                        "ie_2.intime",
                                                                                                        "ie_2.outtime"
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Hash",
                                                                    "Parent Relationship": "Inner",
                                                                    "Parallel Aware": false,
                                                                    "Output": [
                                                                        "adm.hadm_id"
                                                                    ],
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Seq Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Relation Name": "admissions",
                                                                            "Schema": "mimiciii_clinical",
                                                                            "Alias": "adm",
                                                                            "Output": [
                                                                                "adm.hadm_id"
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "Node Type": "Hash",
                                                            "Parent Relationship": "Inner",
                                                            "Parallel Aware": false,
                                                            "Output": [
                                                                "pat.dob",
                                                                "pat.subject_id"
                                                            ],
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Seq Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Relation Name": "patients",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "pat",
                                                                    "Output": [
                                                                        "pat.dob",
                                                                        "pat.subject_id"
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "Node Type": "Hash",
                                                    "Parent Relationship": "Inner",
                                                    "Parallel Aware": false,
                                                    "Output": [
                                                        "gcs.mingcs",
                                                        "gcs.icustay_id"
                                                    ],
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Seq Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "gcs_first_day",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "gcs",
                                                            "Output": [
                                                                "gcs.mingcs",
                                                                "gcs.icustay_id"
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "uo.urineoutput",
                                                "uo.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "urine_output_first_day",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "uo",
                                                    "Output": [
                                                        "uo.urineoutput",
                                                        "uo.icustay_id"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "vent.vent",
                                        "vent.icustay_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "ventilation_first_day",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "vent",
                                            "Output": [
                                                "vent.vent",
                                                "vent.icustay_id"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "labs.glucose_max",
                                "labs.glucose_min",
                                "labs.bun_max",
                                "labs.bun_min",
                                "labs.hematocrit_max",
                                "labs.hematocrit_min",
                                "labs.wbc_max",
                                "labs.wbc_min",
                                "labs.sodium_max",
                                "labs.sodium_min",
                                "labs.potassium_max",
                                "labs.potassium_min",
                                "labs.bicarbonate_max",
                                "labs.bicarbonate_min",
                                "labs.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "labs_first_day",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "labs",
                                    "Output": [
                                        "labs.glucose_max",
                                        "labs.glucose_min",
                                        "labs.bun_max",
                                        "labs.bun_min",
                                        "labs.hematocrit_max",
                                        "labs.hematocrit_min",
                                        "labs.wbc_max",
                                        "labs.wbc_min",
                                        "labs.sodium_max",
                                        "labs.sodium_min",
                                        "labs.potassium_max",
                                        "labs.potassium_min",
                                        "labs.bicarbonate_max",
                                        "labs.bicarbonate_min",
                                        "labs.icustay_id"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE scorecomp",
                    "Parallel Aware": false,
                    "CTE Name": "cohort",
                    "Alias": "cohort",
                    "Output": [
                        "cohort.subject_id",
                        "cohort.hadm_id",
                        "cohort.icustay_id",
                        "cohort.intime",
                        "cohort.outtime",
                        "cohort.age",
                        "cohort.mingcs",
                        "cohort.heartrate_max",
                        "cohort.heartrate_min",
                        "cohort.sysbp_max",
                        "cohort.sysbp_min",
                        "cohort.resprate_max",
                        "cohort.resprate_min",
                        "cohort.tempc_max",
                        "cohort.tempc_min",
                        "cohort.glucose_max",
                        "cohort.glucose_min",
                        "cohort.bun_max",
                        "cohort.bun_min",
                        "cohort.hematocrit_max",
                        "cohort.hematocrit_min",
                        "cohort.wbc_max",
                        "cohort.wbc_min",
                        "cohort.sodium_max",
                        "cohort.sodium_min",
                        "cohort.potassium_max",
                        "cohort.potassium_min",
                        "cohort.bicarbonate_max",
                        "cohort.bicarbonate_min",
                        "cohort.mechvent",
                        "cohort.urineoutput",
                        "cohort.cpap",
                        "CASE WHEN (cohort.age IS NULL) THEN NULL::integer WHEN (cohort.age <= '45'::numeric) THEN 0 WHEN (cohort.age <= '55'::numeric) THEN 1 WHEN (cohort.age <= '65'::numeric) THEN 2 WHEN (cohort.age <= '75'::numeric) THEN 3 WHEN (cohort.age > '75'::numeric) THEN 4 ELSE NULL::integer END",
                        "CASE WHEN (cohort.heartrate_max IS NULL) THEN NULL::integer WHEN (cohort.heartrate_max >= '180'::double precision) THEN 4 WHEN (cohort.heartrate_min < '40'::double precision) THEN 4 WHEN (cohort.heartrate_max >= '140'::double precision) THEN 3 WHEN (cohort.heartrate_min <= '54'::double precision) THEN 3 WHEN (cohort.heartrate_max >= '110'::double precision) THEN 2 WHEN (cohort.heartrate_min <= '69'::double precision) THEN 2 WHEN ((cohort.heartrate_max >= '70'::double precision) AND (cohort.heartrate_max <= '109'::double precision) AND (cohort.heartrate_min >= '70'::double precision) AND (cohort.heartrate_min <= '109'::double precision)) THEN 0 ELSE NULL::integer END",
                        "CASE WHEN (cohort.sysbp_min IS NULL) THEN NULL::integer WHEN (cohort.sysbp_max >= '190'::double precision) THEN 4 WHEN (cohort.sysbp_min < '55'::double precision) THEN 4 WHEN (cohort.sysbp_max >= '150'::double precision) THEN 2 WHEN (cohort.sysbp_min <= '79'::double precision) THEN 2 WHEN ((cohort.sysbp_max >= '80'::double precision) AND (cohort.sysbp_max <= '149'::double precision) AND (cohort.sysbp_min >= '80'::double precision) AND (cohort.sysbp_min <= '149'::double precision)) THEN 0 ELSE NULL::integer END",
                        "CASE WHEN (cohort.tempc_max IS NULL) THEN NULL::integer WHEN (cohort.tempc_max >= '41'::double precision) THEN 4 WHEN (cohort.tempc_min < '30'::double precision) THEN 4 WHEN (cohort.tempc_max >= '39'::double precision) THEN 3 WHEN (cohort.tempc_min <= '31.9'::double precision) THEN 3 WHEN (cohort.tempc_min <= '33.9'::double precision) THEN 2 WHEN (cohort.tempc_max > '38.4'::double precision) THEN 1 WHEN (cohort.tempc_min < '36'::double precision) THEN 1 WHEN ((cohort.tempc_max >= '36'::double precision) AND (cohort.tempc_max <= '38.4'::double precision) AND (cohort.tempc_min >= '36'::double precision) AND (cohort.tempc_min <= '38.4'::double precision)) THEN 0 ELSE NULL::integer END",
                        "CASE WHEN (cohort.resprate_min IS NULL) THEN NULL::integer WHEN (cohort.resprate_max >= '50'::double precision) THEN 4 WHEN (cohort.resprate_min < '6'::double precision) THEN 4 WHEN (cohort.resprate_max >= '35'::double precision) THEN 3 WHEN (cohort.resprate_min <= '9'::double precision) THEN 2 WHEN (cohort.resprate_max >= '25'::double precision) THEN 1 WHEN (cohort.resprate_min <= '11'::double precision) THEN 1 WHEN ((cohort.resprate_max >= '12'::double precision) AND (cohort.resprate_max <= '24'::double precision) AND (cohort.resprate_min >= '12'::double precision) AND (cohort.resprate_min <= '24'::double precision)) THEN 0 ELSE NULL::integer END",
                        "CASE WHEN (COALESCE(cohort.mechvent, cohort.cpap) IS NULL) THEN NULL::integer WHEN (cohort.cpap = 1) THEN 3 WHEN (cohort.mechvent = 1) THEN 3 ELSE 0 END",
                        "CASE WHEN (cohort.urineoutput IS NULL) THEN NULL::integer WHEN (cohort.urineoutput > '5000'::double precision) THEN 2 WHEN (cohort.urineoutput >= '3500'::double precision) THEN 1 WHEN (cohort.urineoutput >= '700'::double precision) THEN 0 WHEN (cohort.urineoutput >= '500'::double precision) THEN 2 WHEN (cohort.urineoutput >= '200'::double precision) THEN 3 WHEN (cohort.urineoutput < '200'::double precision) THEN 4 ELSE NULL::integer END",
                        "CASE WHEN (cohort.bun_max IS NULL) THEN NULL::integer WHEN (cohort.bun_max >= '55'::double precision) THEN 4 WHEN (cohort.bun_max >= '36'::double precision) THEN 3 WHEN (cohort.bun_max >= '29'::double precision) THEN 2 WHEN (cohort.bun_max >= '7.5'::double precision) THEN 1 WHEN (cohort.bun_min < '3.5'::double precision) THEN 1 WHEN ((cohort.bun_max >= '3.5'::double precision) AND (cohort.bun_max < '7.5'::double precision) AND (cohort.bun_min >= '3.5'::double precision) AND (cohort.bun_min < '7.5'::double precision)) THEN 0 ELSE NULL::integer END",
                        "CASE WHEN (cohort.hematocrit_max IS NULL) THEN NULL::integer WHEN (cohort.hematocrit_max >= '60'::double precision) THEN 4 WHEN (cohort.hematocrit_min < '20'::double precision) THEN 4 WHEN (cohort.hematocrit_max >= '50'::double precision) THEN 2 WHEN (cohort.hematocrit_min < '30'::double precision) THEN 2 WHEN (cohort.hematocrit_max >= '46'::double precision) THEN 1 WHEN ((cohort.hematocrit_max >= '30'::double precision) AND (cohort.hematocrit_max < '46'::double precision) AND (cohort.hematocrit_min >= '30'::double precision) AND (cohort.hematocrit_min < '46'::double precision)) THEN 0 ELSE NULL::integer END",
                        "CASE WHEN (cohort.wbc_max IS NULL) THEN NULL::integer WHEN (cohort.wbc_max >= '40'::double precision) THEN 4 WHEN (cohort.wbc_min < '1'::double precision) THEN 4 WHEN (cohort.wbc_max >= '20'::double precision) THEN 2 WHEN (cohort.wbc_min < '3'::double precision) THEN 2 WHEN (cohort.wbc_max >= '15'::double precision) THEN 1 WHEN ((cohort.wbc_max >= '3'::double precision) AND (cohort.wbc_max < '15'::double precision) AND (cohort.wbc_min >= '3'::double precision) AND (cohort.wbc_min < '15'::double precision)) THEN 0 ELSE NULL::integer END",
                        "CASE WHEN (cohort.glucose_max IS NULL) THEN NULL::integer WHEN (cohort.glucose_max >= '44.5'::double precision) THEN 4 WHEN (cohort.glucose_min < '1.6'::double precision) THEN 4 WHEN (cohort.glucose_max >= '27.8'::double precision) THEN 3 WHEN (cohort.glucose_min < '2.8'::double precision) THEN 3 WHEN (cohort.glucose_min < '3.9'::double precision) THEN 2 WHEN (cohort.glucose_max >= '14'::double precision) THEN 1 WHEN ((cohort.glucose_max >= '3.9'::double precision) AND (cohort.glucose_max < '14'::double precision) AND (cohort.glucose_min >= '3.9'::double precision) AND (cohort.glucose_min < '14'::double precision)) THEN 0 ELSE NULL::integer END",
                        "CASE WHEN (cohort.potassium_max IS NULL) THEN NULL::integer WHEN (cohort.potassium_max >= '7'::double precision) THEN 4 WHEN (cohort.potassium_min < '2.5'::double precision) THEN 4 WHEN (cohort.potassium_max >= '6'::double precision) THEN 3 WHEN (cohort.potassium_min < '3'::double precision) THEN 2 WHEN (cohort.potassium_max >= '5.5'::double precision) THEN 1 WHEN (cohort.potassium_min < '3.5'::double precision) THEN 1 WHEN ((cohort.potassium_max >= '3.5'::double precision) AND (cohort.potassium_max < '5.5'::double precision) AND (cohort.potassium_min >= '3.5'::double precision) AND (cohort.potassium_min < '5.5'::double precision)) THEN 0 ELSE NULL::integer END",
                        "CASE WHEN (cohort.sodium_max IS NULL) THEN NULL::integer WHEN (cohort.sodium_max >= '180'::double precision) THEN 4 WHEN (cohort.sodium_min < '110'::double precision) THEN 4 WHEN (cohort.sodium_max >= '161'::double precision) THEN 3 WHEN (cohort.sodium_min < '120'::double precision) THEN 3 WHEN (cohort.sodium_max >= '156'::double precision) THEN 2 WHEN (cohort.sodium_min < '130'::double precision) THEN 2 WHEN (cohort.sodium_max >= '151'::double precision) THEN 1 WHEN ((cohort.sodium_max >= '130'::double precision) AND (cohort.sodium_max < '151'::double precision) AND (cohort.sodium_min >= '130'::double precision) AND (cohort.sodium_min < '151'::double precision)) THEN 0 ELSE NULL::integer END",
                        "CASE WHEN (cohort.bicarbonate_max IS NULL) THEN NULL::integer WHEN (cohort.bicarbonate_min < '5'::double precision) THEN 4 WHEN (cohort.bicarbonate_max >= '40'::double precision) THEN 3 WHEN (cohort.bicarbonate_min < '10'::double precision) THEN 3 WHEN (cohort.bicarbonate_max >= '30'::double precision) THEN 1 WHEN (cohort.bicarbonate_min < '20'::double precision) THEN 1 WHEN ((cohort.bicarbonate_max >= '20'::double precision) AND (cohort.bicarbonate_max < '30'::double precision) AND (cohort.bicarbonate_min >= '20'::double precision) AND (cohort.bicarbonate_min < '30'::double precision)) THEN 0 ELSE NULL::integer END",
                        "CASE WHEN (cohort.mingcs IS NULL) THEN NULL::integer WHEN (cohort.mingcs < '3'::double precision) THEN NULL::integer WHEN (cohort.mingcs = '3'::double precision) THEN 4 WHEN (cohort.mingcs < '7'::double precision) THEN 3 WHEN (cohort.mingcs < '10'::double precision) THEN 2 WHEN (cohort.mingcs < '13'::double precision) THEN 1 WHEN ((cohort.mingcs >= '13'::double precision) AND (cohort.mingcs <= '15'::double precision)) THEN 0 ELSE NULL::integer END"
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Join Type": "Right",
                    "Output": [
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id",
                        "((((((((((((((COALESCE(s.age_score, 0) + COALESCE(s.hr_score, 0)) + COALESCE(s.sysbp_score, 0)) + COALESCE(s.resp_score, 0)) + COALESCE(s.temp_score, 0)) + COALESCE(s.uo_score, 0)) + COALESCE(s.vent_score, 0)) + COALESCE(s.bun_score, 0)) + COALESCE(s.hematocrit_score, 0)) + COALESCE(s.wbc_score, 0)) + COALESCE(s.glucose_score, 0)) + COALESCE(s.potassium_score, 0)) + COALESCE(s.sodium_score, 0)) + COALESCE(s.bicarbonate_score, 0)) + COALESCE(s.gcs_score, 0))",
                        "s.age_score",
                        "s.hr_score",
                        "s.sysbp_score",
                        "s.resp_score",
                        "s.temp_score",
                        "s.uo_score",
                        "s.vent_score",
                        "s.bun_score",
                        "s.hematocrit_score",
                        "s.wbc_score",
                        "s.glucose_score",
                        "s.potassium_score",
                        "s.sodium_score",
                        "s.bicarbonate_score",
                        "s.gcs_score"
                    ],
                    "Inner Unique": true,
                    "Hash Cond": "(s.icustay_id = ie.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "scorecomp",
                            "Alias": "s",
                            "Output": [
                                "s.subject_id",
                                "s.hadm_id",
                                "s.icustay_id",
                                "s.intime",
                                "s.outtime",
                                "s.age",
                                "s.mingcs",
                                "s.heartrate_max",
                                "s.heartrate_min",
                                "s.sysbp_max",
                                "s.sysbp_min",
                                "s.resprate_max",
                                "s.resprate_min",
                                "s.tempc_max",
                                "s.tempc_min",
                                "s.glucose_max",
                                "s.glucose_min",
                                "s.bun_max",
                                "s.bun_min",
                                "s.hematocrit_max",
                                "s.hematocrit_min",
                                "s.wbc_max",
                                "s.wbc_min",
                                "s.sodium_max",
                                "s.sodium_min",
                                "s.potassium_max",
                                "s.potassium_min",
                                "s.bicarbonate_max",
                                "s.bicarbonate_min",
                                "s.mechvent",
                                "s.urineoutput",
                                "s.cpap",
                                "s.age_score",
                                "s.hr_score",
                                "s.sysbp_score",
                                "s.temp_score",
                                "s.resp_score",
                                "s.vent_score",
                                "s.uo_score",
                                "s.bun_score",
                                "s.hematocrit_score",
                                "s.wbc_score",
                                "s.glucose_score",
                                "s.potassium_score",
                                "s.sodium_score",
                                "s.bicarbonate_score",
                                "s.gcs_score"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "ie.subject_id",
                                "ie.hadm_id",
                                "ie.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "icustays",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ie",
                                    "Output": [
                                        "ie.subject_id",
                                        "ie.hadm_id",
                                        "ie.icustay_id"
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.sapsii": {
        "sql": "-- ------------------------------------------------------------------\n-- Title: Simplified Acute Physiology Score II (SAPS II)\n-- This query extracts the simplified acute physiology score II.\n-- This score is a measure of patient severity of illness.\n-- The score is calculated on the first day of each ICU patients' stay.\n-- ------------------------------------------------------------------\n\n-- Reference for SAPS II:\n--    Le Gall, Jean-Roger, Stanley Lemeshow, and Fabienne Saulnier.\n--    \"A new simplified acute physiology score (SAPS II) based on a European/North American multicenter study.\"\n--    JAMA 270, no. 24 (1993): 2957-2963.\n\n-- Variables used in SAPS II:\n--  Age, GCS\n--  VITALS: Heart rate, systolic blood pressure, temperature\n--  FLAGS: ventilation/cpap\n--  IO: urine output\n--  LABS: PaO2/FiO2 ratio, blood urea nitrogen, WBC, potassium, sodium, HCO3\n\n-- The following views are required to run this query:\n--  1) urine_output_first_day - generated by urine-output-first-day.sql\n--  2) ventilation_durations - generated by ventilation_durations.sql\n--  3) vitals_first_day - generated by vitals-first-day.sql\n--  4) gcs_first_day - generated by gcs-first-day.sql\n--  5) labs_first_day - generated by labs-first-day.sql\n--  6) blood_gas_arterial_first_day - generated by blood-gas-first-day-arterial.sql\n\n-- Note:\n--  The score is calculated for *all* ICU patients, with the assumption that the user will subselect appropriate ICUSTAY_IDs.\n--  For example, the score is calculated for neonates, but it is likely inappropriate to actually use the score values for these patients.\n\n-- extract CPAP from the \"Oxygen Delivery Device\" fields\nwith cpap as\n(\n  select ie.icustay_id\n    , min(DATETIME_SUB(charttime, INTERVAL '1' HOUR)) as starttime\n    , max(DATETIME_ADD(charttime, INTERVAL '4' HOUR)) as endtime\n    , max(CASE\n          WHEN lower(ce.value) LIKE '%cpap%' THEN 1\n          WHEN lower(ce.value) LIKE '%bipap mask%' THEN 1\n        else 0 end) as cpap\n  FROM icustays ie\n  inner join chartevents ce\n    on ie.icustay_id = ce.icustay_id\n    and ce.charttime between ie.intime and DATETIME_ADD(ie.intime, INTERVAL '1' DAY)\n  where itemid in\n  (\n    -- TODO: when metavision data import fixed, check the values in 226732 match the value clause below\n    467, 469, 226732\n  )\n  and (lower(ce.value) LIKE '%cpap%' or lower(ce.value) LIKE '%bipap mask%')\n  -- exclude rows marked as error\n  AND (ce.error IS NULL OR ce.error = 0)\n  group by ie.icustay_id\n)\n-- extract a flag for surgical service\n-- this combined with \"elective\" FROM admissions table defines elective/non-elective surgery\n, surgflag as\n(\n  select adm.hadm_id\n    , case when lower(curr_service) like '%surg%' then 1 else 0 end as surgical\n    , ROW_NUMBER() over\n    (\n      PARTITION BY adm.HADM_ID\n      ORDER BY TRANSFERTIME\n    ) as serviceOrder\n  FROM admissions adm\n  left join services se\n    on adm.hadm_id = se.hadm_id\n)\n-- icd-9 diagnostic codes are our best source for comorbidity information\n-- unfortunately, they are technically a-causal\n-- however, this shouldn't matter too much for the SAPS II comorbidities\n, comorb as\n(\nselect hadm_id\n-- these are slightly different than elixhauser comorbidities, but based on them\n-- they include some non-comorbid ICD-9 codes (e.g. 20302, relapse of multiple myeloma)\n  , max(CASE\n    when SUBSTR(icd9_code,1,3) BETWEEN '042' AND '044' THEN 1\n  \t\tend) as aids      /* HIV and AIDS */\n  , max(CASE\n    when icd9_code between '20000' and '20238' then 1 -- lymphoma\n    when icd9_code between '20240' and '20248' then 1 -- leukemia\n    when icd9_code between '20250' and '20302' then 1 -- lymphoma\n    when icd9_code between '20310' and '20312' then 1 -- leukemia\n    when icd9_code between '20302' and '20382' then 1 -- lymphoma\n    when icd9_code between '20400' and '20522' then 1 -- chronic leukemia\n    when icd9_code between '20580' and '20702' then 1 -- other myeloid leukemia\n    when icd9_code between '20720' and '20892' then 1 -- other myeloid leukemia\n    when SUBSTR(icd9_code,1,4) = '2386' then 1 -- lymphoma\n    when SUBSTR(icd9_code,1,4) = '2733' then 1 -- lymphoma\n  \t\tend) as hem\n  , max(CASE\n    when SUBSTR(icd9_code,1,4) BETWEEN '1960' AND '1991' THEN 1\n    when icd9_code between '20970' and '20975' then 1\n    when icd9_code = '20979' then 1\n    when icd9_code = '78951' then 1\n  \t\tend) as mets      /* Metastatic cancer */\n  from diagnoses_icd\n  group by hadm_id\n)\n, pafi1 as\n(\n  -- join blood gas to ventilation durations to determine if patient was vent\n  -- also join to cpap table for the same purpose\n  select bg.icustay_id, bg.charttime\n  , pao2fio2\n  , case when vd.icustay_id is not null then 1 else 0 end as vent\n  , case when cp.icustay_id is not null then 1 else 0 end as cpap\n  from \"mimic\".\"mimiciii_clinical\".\"blood_gas_first_day_arterial\" bg\n  left join \"mimic\".\"mimiciii_clinical\".\"ventilation_durations\" vd\n    on bg.icustay_id = vd.icustay_id\n    and bg.charttime >= vd.starttime\n    and bg.charttime <= vd.endtime\n  left join cpap cp\n    on bg.icustay_id = cp.icustay_id\n    and bg.charttime >= cp.starttime\n    and bg.charttime <= cp.endtime\n)\n, pafi2 as\n(\n  -- get the minimum PaO2/FiO2 ratio *only for ventilated/cpap patients*\n  select icustay_id\n  , min(pao2fio2) as pao2fio2_vent_min\n  from pafi1\n  where vent = 1 or cpap = 1\n  group by icustay_id\n)\n, cohort as\n(\nselect ie.subject_id, ie.hadm_id, ie.icustay_id\n      , ie.intime\n      , ie.outtime\n\n      -- the casts ensure the result is numeric.. we could equally extract EPOCH from the interval\n      -- however this code works in Oracle and Postgres\n      , DATETIME_DIFF(ie.intime, pat.dob, 'YEAR') as age\n\n      , vital.heartrate_max\n      , vital.heartrate_min\n      , vital.sysbp_max\n      , vital.sysbp_min\n      , vital.tempc_max\n      , vital.tempc_min\n\n      -- this value is non-null iff the patient is on vent/cpap\n      , pf.pao2fio2_vent_min\n\n      , uo.urineoutput\n\n      , labs.bun_min\n      , labs.bun_max\n      , labs.wbc_min\n      , labs.wbc_max\n      , labs.potassium_min\n      , labs.potassium_max\n      , labs.sodium_min\n      , labs.sodium_max\n      , labs.bicarbonate_min\n      , labs.bicarbonate_max\n      , labs.bilirubin_min\n      , labs.bilirubin_max\n\n      , gcs.mingcs\n\n      , comorb.aids\n      , comorb.hem\n      , comorb.mets\n\n      , case\n          when adm.ADMISSION_TYPE = 'ELECTIVE' and sf.surgical = 1\n            then 'ScheduledSurgical'\n          when adm.ADMISSION_TYPE != 'ELECTIVE' and sf.surgical = 1\n            then 'UnscheduledSurgical'\n          else 'Medical'\n        end as admissiontype\n\n\nFROM icustays ie\ninner join admissions adm\n  on ie.hadm_id = adm.hadm_id\ninner join patients pat\n  on ie.subject_id = pat.subject_id\n\n-- join to above views\nleft join pafi2 pf\n  on ie.icustay_id = pf.icustay_id\nleft join surgflag sf\n  on adm.hadm_id = sf.hadm_id and sf.serviceOrder = 1\nleft join comorb\n  on ie.hadm_id = comorb.hadm_id\n\n-- join to custom tables to get more data....\nleft join \"mimic\".\"mimiciii_clinical\".\"gcs_first_day\" gcs\n  on ie.icustay_id = gcs.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"vitals_first_day\" vital\n  on ie.icustay_id = vital.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"urine_output_first_day\" uo\n  on ie.icustay_id = uo.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"labs_first_day\" labs\n  on ie.icustay_id = labs.icustay_id\n)\n, scorecomp as\n(\nselect\n  cohort.*\n  -- Below code calculates the component scores needed for SAPS\n  , case\n      when age is null then null\n      when age <  40 then 0\n      when age <  60 then 7\n      when age <  70 then 12\n      when age <  75 then 15\n      when age <  80 then 16\n      when age >= 80 then 18\n    end as age_score\n\n  , case\n      when heartrate_max is null then null\n      when heartrate_min <   40 then 11\n      when heartrate_max >= 160 then 7\n      when heartrate_max >= 120 then 4\n      when heartrate_min  <  70 then 2\n      when  heartrate_max >= 70 and heartrate_max < 120\n        and heartrate_min >= 70 and heartrate_min < 120\n      then 0\n    end as hr_score\n\n  , case\n      when  sysbp_min is null then null\n      when  sysbp_min <   70 then 13\n      when  sysbp_min <  100 then 5\n      when  sysbp_max >= 200 then 2\n      when  sysbp_max >= 100 and sysbp_max < 200\n        and sysbp_min >= 100 and sysbp_min < 200\n        then 0\n    end as sysbp_score\n\n  , case\n      when tempc_max is null then null\n      when tempc_min <  39.0 then 0\n      when tempc_max >= 39.0 then 3\n    end as temp_score\n\n  , case\n      when pao2fio2_vent_min is null then null\n      when pao2fio2_vent_min <  100 then 11\n      when pao2fio2_vent_min <  200 then 9\n      when pao2fio2_vent_min >= 200 then 6\n    end as pao2fio2_score\n\n  , case\n      when urineoutput is null then null\n      when urineoutput <   500.0 then 11\n      when urineoutput <  1000.0 then 4\n      when urineoutput >= 1000.0 then 0\n    end as uo_score\n\n  , case\n      when bun_max is null then null\n      when bun_max <  28.0 then 0\n      when bun_max <  84.0 then 6\n      when bun_max >= 84.0 then 10\n    end as bun_score\n\n  , case\n      when wbc_max is null then null\n      when wbc_min <   1.0 then 12\n      when wbc_max >= 20.0 then 3\n      when wbc_max >=  1.0 and wbc_max < 20.0\n       and wbc_min >=  1.0 and wbc_min < 20.0\n        then 0\n    end as wbc_score\n\n  , case\n      when potassium_max is null then null\n      when potassium_min <  3.0 then 3\n      when potassium_max >= 5.0 then 3\n      when potassium_max >= 3.0 and potassium_max < 5.0\n       and potassium_min >= 3.0 and potassium_min < 5.0\n        then 0\n      end as potassium_score\n\n  , case\n      when sodium_max is null then null\n      when sodium_min  < 125 then 5\n      when sodium_max >= 145 then 1\n      when sodium_max >= 125 and sodium_max < 145\n       and sodium_min >= 125 and sodium_min < 145\n        then 0\n      end as sodium_score\n\n  , case\n      when bicarbonate_max is null then null\n      when bicarbonate_min <  15.0 then 5\n      when bicarbonate_min <  20.0 then 3\n      when bicarbonate_max >= 20.0\n       and bicarbonate_min >= 20.0\n          then 0\n      end as bicarbonate_score\n\n  , case\n      when bilirubin_max is null then null\n      when bilirubin_max  < 4.0 then 0\n      when bilirubin_max  < 6.0 then 4\n      when bilirubin_max >= 6.0 then 9\n      end as bilirubin_score\n\n   , case\n      when mingcs is null then null\n        when mingcs <  3 then null -- erroneous value/on trach\n        when mingcs <  6 then 26\n        when mingcs <  9 then 13\n        when mingcs < 11 then 7\n        when mingcs < 14 then 5\n        when mingcs >= 14\n         and mingcs <= 15\n          then 0\n        end as gcs_score\n\n    , case\n        when aids = 1 then 17\n        when hem  = 1 then 10\n        when mets = 1 then 9\n        else 0\n      end as comorbidity_score\n\n    , case\n        when admissiontype = 'ScheduledSurgical' then 0\n        when admissiontype = 'Medical' then 6\n        when admissiontype = 'UnscheduledSurgical' then 8\n        else null\n      end as admissiontype_score\n\nfrom cohort\n)\n-- Calculate SAPS II here so we can use it in the probability calculation below\n, score as\n(\n  select s.*\n  -- coalesce statements impute normal score of zero if data element is missing\n  , coalesce(age_score,0)\n  + coalesce(hr_score,0)\n  + coalesce(sysbp_score,0)\n  + coalesce(temp_score,0)\n  + coalesce(pao2fio2_score,0)\n  + coalesce(uo_score,0)\n  + coalesce(bun_score,0)\n  + coalesce(wbc_score,0)\n  + coalesce(potassium_score,0)\n  + coalesce(sodium_score,0)\n  + coalesce(bicarbonate_score,0)\n  + coalesce(bilirubin_score,0)\n  + coalesce(gcs_score,0)\n  + coalesce(comorbidity_score,0)\n  + coalesce(admissiontype_score,0)\n    as sapsii\n  from scorecomp s\n)\nselect ie.subject_id, ie.hadm_id, ie.icustay_id\n, sapsii\n, 1 / (1 + exp(- (-7.7631 + 0.0737*(sapsii) + 0.9971*(ln(sapsii + 1))) )) as sapsii_prob\n, age_score\n, hr_score\n, sysbp_score\n, temp_score\n, pao2fio2_score\n, uo_score\n, bun_score\n, wbc_score\n, potassium_score\n, sodium_score\n, bicarbonate_score\n, bilirubin_score\n, gcs_score\n, comorbidity_score\n, admissiontype_score\nFROM icustays ie\nleft join score s\n  on ie.icustay_id = s.icustay_id\norder by ie.icustay_id",
        "tables": [
            "mimiciii_clinical.admissions",
            "mimiciii_clinical.blood_gas_first_day_arterial",
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.diagnoses_icd",
            "mimiciii_clinical.gcs_first_day",
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.labs_first_day",
            "mimiciii_clinical.patients",
            "mimiciii_clinical.services",
            "mimiciii_clinical.urine_output_first_day",
            "mimiciii_clinical.ventilation_durations",
            "mimiciii_clinical.vitals_first_day"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "hadm_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "icustay_id": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "sapsii": [
                "mimiciii_clinical.admissions.admission_type",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pao2fio2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.gcs_first_day.mingcs",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.bicarbonate_max",
                "mimiciii_clinical.labs_first_day.bicarbonate_min",
                "mimiciii_clinical.labs_first_day.bilirubin_max",
                "mimiciii_clinical.labs_first_day.bun_max",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.potassium_max",
                "mimiciii_clinical.labs_first_day.potassium_min",
                "mimiciii_clinical.labs_first_day.sodium_max",
                "mimiciii_clinical.labs_first_day.sodium_min",
                "mimiciii_clinical.labs_first_day.wbc_max",
                "mimiciii_clinical.labs_first_day.wbc_min",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.curr_service",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.urineoutput",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.heartrate_max",
                "mimiciii_clinical.vitals_first_day.heartrate_min",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.sysbp_max",
                "mimiciii_clinical.vitals_first_day.sysbp_min",
                "mimiciii_clinical.vitals_first_day.tempc_max",
                "mimiciii_clinical.vitals_first_day.tempc_min"
            ],
            "sapsii_prob": [
                "mimiciii_clinical.admissions.admission_type",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pao2fio2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.gcs_first_day.mingcs",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.bicarbonate_max",
                "mimiciii_clinical.labs_first_day.bicarbonate_min",
                "mimiciii_clinical.labs_first_day.bilirubin_max",
                "mimiciii_clinical.labs_first_day.bun_max",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.potassium_max",
                "mimiciii_clinical.labs_first_day.potassium_min",
                "mimiciii_clinical.labs_first_day.sodium_max",
                "mimiciii_clinical.labs_first_day.sodium_min",
                "mimiciii_clinical.labs_first_day.wbc_max",
                "mimiciii_clinical.labs_first_day.wbc_min",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.curr_service",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.urineoutput",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.heartrate_max",
                "mimiciii_clinical.vitals_first_day.heartrate_min",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.sysbp_max",
                "mimiciii_clinical.vitals_first_day.sysbp_min",
                "mimiciii_clinical.vitals_first_day.tempc_max",
                "mimiciii_clinical.vitals_first_day.tempc_min"
            ],
            "age_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.dob",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "hr_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.heartrate_max",
                "mimiciii_clinical.vitals_first_day.heartrate_min",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "sysbp_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.sysbp_max",
                "mimiciii_clinical.vitals_first_day.sysbp_min"
            ],
            "temp_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.tempc_max",
                "mimiciii_clinical.vitals_first_day.tempc_min"
            ],
            "pao2fio2_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pao2fio2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "uo_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.urineoutput",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "bun_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.bun_max",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "wbc_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.wbc_max",
                "mimiciii_clinical.labs_first_day.wbc_min",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "potassium_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.potassium_max",
                "mimiciii_clinical.labs_first_day.potassium_min",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "sodium_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.sodium_max",
                "mimiciii_clinical.labs_first_day.sodium_min",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "bicarbonate_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.bicarbonate_max",
                "mimiciii_clinical.labs_first_day.bicarbonate_min",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "bilirubin_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.bilirubin_max",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "gcs_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.gcs_first_day.mingcs",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "comorbidity_score": [
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.diagnoses_icd.icd9_code",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "admissiontype_score": [
                "mimiciii_clinical.admissions.admission_type",
                "mimiciii_clinical.admissions.hadm_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.value",
                "mimiciii_clinical.diagnoses_icd.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.patients.subject_id",
                "mimiciii_clinical.services.curr_service",
                "mimiciii_clinical.services.hadm_id",
                "mimiciii_clinical.services.transfertime",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ]
        },
        "table_name": "mimiciii_clinical.sapsii",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "ie.subject_id",
                "ie.hadm_id",
                "ie.icustay_id",
                "s.sapsii",
                "(('1'::double precision / ('1'::double precision + exp((- ((('-7.7631'::numeric + (0.0737 * (s.sapsii)::numeric)))::double precision + ('0.9971'::double precision * ln(((s.sapsii + 1))::double precision))))))))",
                "s.age_score",
                "s.hr_score",
                "s.sysbp_score",
                "s.temp_score",
                "s.pao2fio2_score",
                "s.uo_score",
                "s.bun_score",
                "s.wbc_score",
                "s.potassium_score",
                "s.sodium_score",
                "s.bicarbonate_score",
                "s.bilirubin_score",
                "s.gcs_score",
                "s.comorbidity_score",
                "s.admissiontype_score"
            ],
            "Sort Key": [
                "ie.icustay_id"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cpap",
                    "Parallel Aware": false,
                    "Output": [
                        "ie_1.icustay_id",
                        "min(datetime_sub(ce.charttime, '01:00:00'::interval hour))",
                        "max(datetime_add(ce.charttime, '04:00:00'::interval hour))",
                        "max(CASE WHEN (lower((ce.value)::text) ~~ '%cpap%'::text) THEN 1 WHEN (lower((ce.value)::text) ~~ '%bipap mask%'::text) THEN 1 ELSE 0 END)"
                    ],
                    "Group Key": [
                        "ie_1.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ie_1.icustay_id",
                                "ce.charttime",
                                "ce.value"
                            ],
                            "Sort Key": [
                                "ie_1.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "ie_1.icustay_id",
                                        "ce.charttime",
                                        "ce.value"
                                    ],
                                    "Inner Unique": true,
                                    "Hash Cond": "(ce.icustay_id = ie_1.icustay_id)",
                                    "Join Filter": "((ce.charttime >= ie_1.intime) AND (ce.charttime <= datetime_add(ie_1.intime, '1 day'::interval day)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Append",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_45",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce",
                                                    "Output": [
                                                        "ce.charttime",
                                                        "ce.value",
                                                        "ce.icustay_id"
                                                    ],
                                                    "Filter": "(((ce.error IS NULL) OR (ce.error = 0)) AND (ce.itemid = ANY ('{467,469,226732}'::integer[])) AND ((lower((ce.value)::text) ~~ '%cpap%'::text) OR (lower((ce.value)::text) ~~ '%bipap mask%'::text)))"
                                                },
                                                {
                                                    "Node Type": "Index Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Scan Direction": "Forward",
                                                    "Index Name": "chartevents_46_idx01",
                                                    "Relation Name": "chartevents_46",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_1",
                                                    "Output": [
                                                        "ce_1.charttime",
                                                        "ce_1.value",
                                                        "ce_1.icustay_id"
                                                    ],
                                                    "Index Cond": "(ce_1.itemid = ANY ('{467,469,226732}'::integer[]))",
                                                    "Filter": "(((ce_1.error IS NULL) OR (ce_1.error = 0)) AND ((lower((ce_1.value)::text) ~~ '%cpap%'::text) OR (lower((ce_1.value)::text) ~~ '%bipap mask%'::text)))"
                                                },
                                                {
                                                    "Node Type": "Bitmap Heap Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_201",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ce_2",
                                                    "Output": [
                                                        "ce_2.charttime",
                                                        "ce_2.value",
                                                        "ce_2.icustay_id"
                                                    ],
                                                    "Recheck Cond": "(ce_2.itemid = ANY ('{467,469,226732}'::integer[]))",
                                                    "Filter": "(((ce_2.error IS NULL) OR (ce_2.error = 0)) AND ((lower((ce_2.value)::text) ~~ '%cpap%'::text) OR (lower((ce_2.value)::text) ~~ '%bipap mask%'::text)))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Bitmap Index Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Index Name": "chartevents_201_idx01",
                                                            "Index Cond": "(ce_2.itemid = ANY ('{467,469,226732}'::integer[]))"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ie_1.icustay_id",
                                                "ie_1.intime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "icustays",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ie_1",
                                                    "Output": [
                                                        "ie_1.icustay_id",
                                                        "ie_1.intime"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "WindowAgg",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE surgflag",
                    "Parallel Aware": false,
                    "Output": [
                        "adm.hadm_id",
                        "CASE WHEN (lower((se.curr_service)::text) ~~ '%surg%'::text) THEN 1 ELSE 0 END",
                        "row_number() OVER (?)",
                        "se.transfertime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "adm.hadm_id",
                                "se.transfertime",
                                "se.curr_service"
                            ],
                            "Sort Key": [
                                "adm.hadm_id",
                                "se.transfertime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Right",
                                    "Output": [
                                        "adm.hadm_id",
                                        "se.transfertime",
                                        "se.curr_service"
                                    ],
                                    "Inner Unique": true,
                                    "Hash Cond": "(se.hadm_id = adm.hadm_id)",
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "services",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "se",
                                            "Output": [
                                                "se.row_id",
                                                "se.subject_id",
                                                "se.hadm_id",
                                                "se.transfertime",
                                                "se.prev_service",
                                                "se.curr_service"
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "adm.hadm_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "admissions",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "adm",
                                                    "Output": [
                                                        "adm.hadm_id"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE comorb",
                    "Parallel Aware": false,
                    "Output": [
                        "diagnoses_icd.hadm_id",
                        "max(CASE WHEN ((substr((diagnoses_icd.icd9_code)::text, 1, 3) >= '042'::text) AND (substr((diagnoses_icd.icd9_code)::text, 1, 3) <= '044'::text)) THEN 1 ELSE NULL::integer END)",
                        "max(CASE WHEN (((diagnoses_icd.icd9_code)::text >= '20000'::text) AND ((diagnoses_icd.icd9_code)::text <= '20238'::text)) THEN 1 WHEN (((diagnoses_icd.icd9_code)::text >= '20240'::text) AND ((diagnoses_icd.icd9_code)::text <= '20248'::text)) THEN 1 WHEN (((diagnoses_icd.icd9_code)::text >= '20250'::text) AND ((diagnoses_icd.icd9_code)::text <= '20302'::text)) THEN 1 WHEN (((diagnoses_icd.icd9_code)::text >= '20310'::text) AND ((diagnoses_icd.icd9_code)::text <= '20312'::text)) THEN 1 WHEN (((diagnoses_icd.icd9_code)::text >= '20302'::text) AND ((diagnoses_icd.icd9_code)::text <= '20382'::text)) THEN 1 WHEN (((diagnoses_icd.icd9_code)::text >= '20400'::text) AND ((diagnoses_icd.icd9_code)::text <= '20522'::text)) THEN 1 WHEN (((diagnoses_icd.icd9_code)::text >= '20580'::text) AND ((diagnoses_icd.icd9_code)::text <= '20702'::text)) THEN 1 WHEN (((diagnoses_icd.icd9_code)::text >= '20720'::text) AND ((diagnoses_icd.icd9_code)::text <= '20892'::text)) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = '2386'::text) THEN 1 WHEN (substr((diagnoses_icd.icd9_code)::text, 1, 4) = '2733'::text) THEN 1 ELSE NULL::integer END)",
                        "max(CASE WHEN ((substr((diagnoses_icd.icd9_code)::text, 1, 4) >= '1960'::text) AND (substr((diagnoses_icd.icd9_code)::text, 1, 4) <= '1991'::text)) THEN 1 WHEN (((diagnoses_icd.icd9_code)::text >= '20970'::text) AND ((diagnoses_icd.icd9_code)::text <= '20975'::text)) THEN 1 WHEN ((diagnoses_icd.icd9_code)::text = '20979'::text) THEN 1 WHEN ((diagnoses_icd.icd9_code)::text = '78951'::text) THEN 1 ELSE NULL::integer END)"
                    ],
                    "Group Key": [
                        "diagnoses_icd.hadm_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Index Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Scan Direction": "Forward",
                            "Index Name": "diagnoses_icd_idx03",
                            "Relation Name": "diagnoses_icd",
                            "Schema": "mimiciii_clinical",
                            "Alias": "diagnoses_icd",
                            "Output": [
                                "diagnoses_icd.row_id",
                                "diagnoses_icd.subject_id",
                                "diagnoses_icd.hadm_id",
                                "diagnoses_icd.seq_num",
                                "diagnoses_icd.icd9_code"
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE pafi1",
                    "Parallel Aware": false,
                    "Join Type": "Right",
                    "Output": [
                        "bg.icustay_id",
                        "bg.charttime",
                        "bg.pao2fio2",
                        "CASE WHEN (vd.icustay_id IS NOT NULL) THEN 1 ELSE 0 END",
                        "CASE WHEN (cp.icustay_id IS NOT NULL) THEN 1 ELSE 0 END"
                    ],
                    "Inner Unique": false,
                    "Hash Cond": "(vd.icustay_id = bg.icustay_id)",
                    "Join Filter": "((bg.charttime >= vd.starttime) AND (bg.charttime <= vd.endtime))",
                    "Plans": [
                        {
                            "Node Type": "Seq Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "ventilation_durations",
                            "Schema": "mimiciii_clinical",
                            "Alias": "vd",
                            "Output": [
                                "vd.icustay_id",
                                "vd.starttime",
                                "vd.endtime"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "bg.icustay_id",
                                "bg.charttime",
                                "bg.pao2fio2",
                                "cp.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Right",
                                    "Output": [
                                        "bg.icustay_id",
                                        "bg.charttime",
                                        "bg.pao2fio2",
                                        "cp.icustay_id"
                                    ],
                                    "Inner Unique": false,
                                    "Hash Cond": "(cp.icustay_id = bg.icustay_id)",
                                    "Join Filter": "((bg.charttime >= cp.starttime) AND (bg.charttime <= cp.endtime))",
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "cpap",
                                            "Alias": "cp",
                                            "Output": [
                                                "cp.icustay_id",
                                                "cp.starttime",
                                                "cp.endtime"
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "bg.icustay_id",
                                                "bg.charttime",
                                                "bg.pao2fio2"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "blood_gas_first_day_arterial",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "bg",
                                                    "Output": [
                                                        "bg.icustay_id",
                                                        "bg.charttime",
                                                        "bg.pao2fio2"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE pafi2",
                    "Parallel Aware": false,
                    "Output": [
                        "pafi1.icustay_id",
                        "min(pafi1.pao2fio2)"
                    ],
                    "Group Key": [
                        "pafi1.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "pafi1",
                            "Alias": "pafi1",
                            "Output": [
                                "pafi1.icustay_id",
                                "pafi1.charttime",
                                "pafi1.pao2fio2",
                                "pafi1.vent",
                                "pafi1.cpap"
                            ],
                            "Filter": "((pafi1.vent = 1) OR (pafi1.cpap = 1))"
                        }
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE cohort",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "ie_2.subject_id",
                        "ie_2.hadm_id",
                        "ie_2.icustay_id",
                        "ie_2.intime",
                        "ie_2.outtime",
                        "datetime_diff(ie_2.intime, pat.dob, 'YEAR'::text)",
                        "vital.heartrate_max",
                        "vital.heartrate_min",
                        "vital.sysbp_max",
                        "vital.sysbp_min",
                        "vital.tempc_max",
                        "vital.tempc_min",
                        "pf.pao2fio2_vent_min",
                        "uo.urineoutput",
                        "labs.bun_min",
                        "labs.bun_max",
                        "labs.wbc_min",
                        "labs.wbc_max",
                        "labs.potassium_min",
                        "labs.potassium_max",
                        "labs.sodium_min",
                        "labs.sodium_max",
                        "labs.bicarbonate_min",
                        "labs.bicarbonate_max",
                        "labs.bilirubin_min",
                        "labs.bilirubin_max",
                        "gcs.mingcs",
                        "comorb.aids",
                        "comorb.hem",
                        "comorb.mets",
                        "CASE WHEN (((adm_1.admission_type)::text = 'ELECTIVE'::text) AND (sf.surgical = 1)) THEN 'ScheduledSurgical'::text WHEN (((adm_1.admission_type)::text <> 'ELECTIVE'::text) AND (sf.surgical = 1)) THEN 'UnscheduledSurgical'::text ELSE 'Medical'::text END"
                    ],
                    "Inner Unique": false,
                    "Hash Cond": "(ie_2.icustay_id = uo.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Left",
                            "Output": [
                                "ie_2.subject_id",
                                "ie_2.hadm_id",
                                "ie_2.icustay_id",
                                "ie_2.intime",
                                "ie_2.outtime",
                                "adm_1.admission_type",
                                "pat.dob",
                                "pf.pao2fio2_vent_min",
                                "sf.surgical",
                                "comorb.aids",
                                "comorb.hem",
                                "comorb.mets",
                                "gcs.mingcs",
                                "vital.heartrate_max",
                                "vital.heartrate_min",
                                "vital.sysbp_max",
                                "vital.sysbp_min",
                                "vital.tempc_max",
                                "vital.tempc_min",
                                "labs.bun_min",
                                "labs.bun_max",
                                "labs.wbc_min",
                                "labs.wbc_max",
                                "labs.potassium_min",
                                "labs.potassium_max",
                                "labs.sodium_min",
                                "labs.sodium_max",
                                "labs.bicarbonate_min",
                                "labs.bicarbonate_max",
                                "labs.bilirubin_min",
                                "labs.bilirubin_max"
                            ],
                            "Inner Unique": false,
                            "Hash Cond": "(ie_2.icustay_id = labs.icustay_id)",
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Left",
                                    "Output": [
                                        "ie_2.subject_id",
                                        "ie_2.hadm_id",
                                        "ie_2.icustay_id",
                                        "ie_2.intime",
                                        "ie_2.outtime",
                                        "adm_1.admission_type",
                                        "pat.dob",
                                        "pf.pao2fio2_vent_min",
                                        "sf.surgical",
                                        "comorb.aids",
                                        "comorb.hem",
                                        "comorb.mets",
                                        "gcs.mingcs",
                                        "vital.heartrate_max",
                                        "vital.heartrate_min",
                                        "vital.sysbp_max",
                                        "vital.sysbp_min",
                                        "vital.tempc_max",
                                        "vital.tempc_min"
                                    ],
                                    "Inner Unique": false,
                                    "Hash Cond": "(ie_2.icustay_id = gcs.icustay_id)",
                                    "Plans": [
                                        {
                                            "Node Type": "Hash Join",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Join Type": "Left",
                                            "Output": [
                                                "ie_2.subject_id",
                                                "ie_2.hadm_id",
                                                "ie_2.icustay_id",
                                                "ie_2.intime",
                                                "ie_2.outtime",
                                                "adm_1.admission_type",
                                                "pat.dob",
                                                "pf.pao2fio2_vent_min",
                                                "sf.surgical",
                                                "comorb.aids",
                                                "comorb.hem",
                                                "comorb.mets",
                                                "vital.heartrate_max",
                                                "vital.heartrate_min",
                                                "vital.sysbp_max",
                                                "vital.sysbp_min",
                                                "vital.tempc_max",
                                                "vital.tempc_min"
                                            ],
                                            "Inner Unique": false,
                                            "Hash Cond": "(ie_2.icustay_id = pf.icustay_id)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Hash Join",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Join Type": "Inner",
                                                    "Output": [
                                                        "ie_2.subject_id",
                                                        "ie_2.hadm_id",
                                                        "ie_2.icustay_id",
                                                        "ie_2.intime",
                                                        "ie_2.outtime",
                                                        "adm_1.admission_type",
                                                        "pat.dob",
                                                        "sf.surgical",
                                                        "comorb.aids",
                                                        "comorb.hem",
                                                        "comorb.mets",
                                                        "vital.heartrate_max",
                                                        "vital.heartrate_min",
                                                        "vital.sysbp_max",
                                                        "vital.sysbp_min",
                                                        "vital.tempc_max",
                                                        "vital.tempc_min"
                                                    ],
                                                    "Inner Unique": true,
                                                    "Hash Cond": "(ie_2.subject_id = pat.subject_id)",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Hash Join",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Join Type": "Inner",
                                                            "Output": [
                                                                "ie_2.subject_id",
                                                                "ie_2.hadm_id",
                                                                "ie_2.icustay_id",
                                                                "ie_2.intime",
                                                                "ie_2.outtime",
                                                                "adm_1.admission_type",
                                                                "sf.surgical",
                                                                "comorb.aids",
                                                                "comorb.hem",
                                                                "comorb.mets",
                                                                "vital.heartrate_max",
                                                                "vital.heartrate_min",
                                                                "vital.sysbp_max",
                                                                "vital.sysbp_min",
                                                                "vital.tempc_max",
                                                                "vital.tempc_min"
                                                            ],
                                                            "Inner Unique": false,
                                                            "Hash Cond": "(ie_2.hadm_id = adm_1.hadm_id)",
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Hash Join",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Join Type": "Left",
                                                                    "Output": [
                                                                        "ie_2.subject_id",
                                                                        "ie_2.hadm_id",
                                                                        "ie_2.icustay_id",
                                                                        "ie_2.intime",
                                                                        "ie_2.outtime",
                                                                        "comorb.aids",
                                                                        "comorb.hem",
                                                                        "comorb.mets",
                                                                        "vital.heartrate_max",
                                                                        "vital.heartrate_min",
                                                                        "vital.sysbp_max",
                                                                        "vital.sysbp_min",
                                                                        "vital.tempc_max",
                                                                        "vital.tempc_min"
                                                                    ],
                                                                    "Inner Unique": false,
                                                                    "Hash Cond": "(ie_2.icustay_id = vital.icustay_id)",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Hash Join",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Join Type": "Right",
                                                                            "Output": [
                                                                                "ie_2.subject_id",
                                                                                "ie_2.hadm_id",
                                                                                "ie_2.icustay_id",
                                                                                "ie_2.intime",
                                                                                "ie_2.outtime",
                                                                                "comorb.aids",
                                                                                "comorb.hem",
                                                                                "comorb.mets"
                                                                            ],
                                                                            "Inner Unique": false,
                                                                            "Hash Cond": "(comorb.hadm_id = ie_2.hadm_id)",
                                                                            "Plans": [
                                                                                {
                                                                                    "Node Type": "CTE Scan",
                                                                                    "Parent Relationship": "Outer",
                                                                                    "Parallel Aware": false,
                                                                                    "CTE Name": "comorb",
                                                                                    "Alias": "comorb",
                                                                                    "Output": [
                                                                                        "comorb.aids",
                                                                                        "comorb.hem",
                                                                                        "comorb.mets",
                                                                                        "comorb.hadm_id"
                                                                                    ]
                                                                                },
                                                                                {
                                                                                    "Node Type": "Hash",
                                                                                    "Parent Relationship": "Inner",
                                                                                    "Parallel Aware": false,
                                                                                    "Output": [
                                                                                        "ie_2.subject_id",
                                                                                        "ie_2.hadm_id",
                                                                                        "ie_2.icustay_id",
                                                                                        "ie_2.intime",
                                                                                        "ie_2.outtime"
                                                                                    ],
                                                                                    "Plans": [
                                                                                        {
                                                                                            "Node Type": "Seq Scan",
                                                                                            "Parent Relationship": "Outer",
                                                                                            "Parallel Aware": false,
                                                                                            "Relation Name": "icustays",
                                                                                            "Schema": "mimiciii_clinical",
                                                                                            "Alias": "ie_2",
                                                                                            "Output": [
                                                                                                "ie_2.subject_id",
                                                                                                "ie_2.hadm_id",
                                                                                                "ie_2.icustay_id",
                                                                                                "ie_2.intime",
                                                                                                "ie_2.outtime"
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "Node Type": "Hash",
                                                                            "Parent Relationship": "Inner",
                                                                            "Parallel Aware": false,
                                                                            "Output": [
                                                                                "vital.heartrate_max",
                                                                                "vital.heartrate_min",
                                                                                "vital.sysbp_max",
                                                                                "vital.sysbp_min",
                                                                                "vital.tempc_max",
                                                                                "vital.tempc_min",
                                                                                "vital.icustay_id"
                                                                            ],
                                                                            "Plans": [
                                                                                {
                                                                                    "Node Type": "Seq Scan",
                                                                                    "Parent Relationship": "Outer",
                                                                                    "Parallel Aware": false,
                                                                                    "Relation Name": "vitals_first_day",
                                                                                    "Schema": "mimiciii_clinical",
                                                                                    "Alias": "vital",
                                                                                    "Output": [
                                                                                        "vital.heartrate_max",
                                                                                        "vital.heartrate_min",
                                                                                        "vital.sysbp_max",
                                                                                        "vital.sysbp_min",
                                                                                        "vital.tempc_max",
                                                                                        "vital.tempc_min",
                                                                                        "vital.icustay_id"
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                },
                                                                {
                                                                    "Node Type": "Hash",
                                                                    "Parent Relationship": "Inner",
                                                                    "Parallel Aware": false,
                                                                    "Output": [
                                                                        "adm_1.admission_type",
                                                                        "adm_1.hadm_id",
                                                                        "sf.surgical"
                                                                    ],
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Hash Join",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Join Type": "Right",
                                                                            "Output": [
                                                                                "adm_1.admission_type",
                                                                                "adm_1.hadm_id",
                                                                                "sf.surgical"
                                                                            ],
                                                                            "Inner Unique": true,
                                                                            "Hash Cond": "(sf.hadm_id = adm_1.hadm_id)",
                                                                            "Plans": [
                                                                                {
                                                                                    "Node Type": "CTE Scan",
                                                                                    "Parent Relationship": "Outer",
                                                                                    "Parallel Aware": false,
                                                                                    "CTE Name": "surgflag",
                                                                                    "Alias": "sf",
                                                                                    "Output": [
                                                                                        "sf.hadm_id",
                                                                                        "sf.surgical",
                                                                                        "sf.serviceorder"
                                                                                    ],
                                                                                    "Filter": "(sf.serviceorder = 1)"
                                                                                },
                                                                                {
                                                                                    "Node Type": "Hash",
                                                                                    "Parent Relationship": "Inner",
                                                                                    "Parallel Aware": false,
                                                                                    "Output": [
                                                                                        "adm_1.admission_type",
                                                                                        "adm_1.hadm_id"
                                                                                    ],
                                                                                    "Plans": [
                                                                                        {
                                                                                            "Node Type": "Seq Scan",
                                                                                            "Parent Relationship": "Outer",
                                                                                            "Parallel Aware": false,
                                                                                            "Relation Name": "admissions",
                                                                                            "Schema": "mimiciii_clinical",
                                                                                            "Alias": "adm_1",
                                                                                            "Output": [
                                                                                                "adm_1.admission_type",
                                                                                                "adm_1.hadm_id"
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        },
                                                        {
                                                            "Node Type": "Hash",
                                                            "Parent Relationship": "Inner",
                                                            "Parallel Aware": false,
                                                            "Output": [
                                                                "pat.dob",
                                                                "pat.subject_id"
                                                            ],
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Seq Scan",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Relation Name": "patients",
                                                                    "Schema": "mimiciii_clinical",
                                                                    "Alias": "pat",
                                                                    "Output": [
                                                                        "pat.dob",
                                                                        "pat.subject_id"
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "Node Type": "Hash",
                                                    "Parent Relationship": "Inner",
                                                    "Parallel Aware": false,
                                                    "Output": [
                                                        "pf.pao2fio2_vent_min",
                                                        "pf.icustay_id"
                                                    ],
                                                    "Plans": [
                                                        {
                                                            "Node Type": "CTE Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "CTE Name": "pafi2",
                                                            "Alias": "pf",
                                                            "Output": [
                                                                "pf.pao2fio2_vent_min",
                                                                "pf.icustay_id"
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "gcs.mingcs",
                                                "gcs.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "gcs_first_day",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "gcs",
                                                    "Output": [
                                                        "gcs.mingcs",
                                                        "gcs.icustay_id"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "labs.bun_min",
                                        "labs.bun_max",
                                        "labs.wbc_min",
                                        "labs.wbc_max",
                                        "labs.potassium_min",
                                        "labs.potassium_max",
                                        "labs.sodium_min",
                                        "labs.sodium_max",
                                        "labs.bicarbonate_min",
                                        "labs.bicarbonate_max",
                                        "labs.bilirubin_min",
                                        "labs.bilirubin_max",
                                        "labs.icustay_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "labs_first_day",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "labs",
                                            "Output": [
                                                "labs.bun_min",
                                                "labs.bun_max",
                                                "labs.wbc_min",
                                                "labs.wbc_max",
                                                "labs.potassium_min",
                                                "labs.potassium_max",
                                                "labs.sodium_min",
                                                "labs.sodium_max",
                                                "labs.bicarbonate_min",
                                                "labs.bicarbonate_max",
                                                "labs.bilirubin_min",
                                                "labs.bilirubin_max",
                                                "labs.icustay_id"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "uo.urineoutput",
                                "uo.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "urine_output_first_day",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "uo",
                                    "Output": [
                                        "uo.urineoutput",
                                        "uo.icustay_id"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE scorecomp",
                    "Parallel Aware": false,
                    "CTE Name": "cohort",
                    "Alias": "cohort",
                    "Output": [
                        "cohort.subject_id",
                        "cohort.hadm_id",
                        "cohort.icustay_id",
                        "cohort.intime",
                        "cohort.outtime",
                        "cohort.age",
                        "cohort.heartrate_max",
                        "cohort.heartrate_min",
                        "cohort.sysbp_max",
                        "cohort.sysbp_min",
                        "cohort.tempc_max",
                        "cohort.tempc_min",
                        "cohort.pao2fio2_vent_min",
                        "cohort.urineoutput",
                        "cohort.bun_min",
                        "cohort.bun_max",
                        "cohort.wbc_min",
                        "cohort.wbc_max",
                        "cohort.potassium_min",
                        "cohort.potassium_max",
                        "cohort.sodium_min",
                        "cohort.sodium_max",
                        "cohort.bicarbonate_min",
                        "cohort.bicarbonate_max",
                        "cohort.bilirubin_min",
                        "cohort.bilirubin_max",
                        "cohort.mingcs",
                        "cohort.aids",
                        "cohort.hem",
                        "cohort.mets",
                        "cohort.admissiontype",
                        "CASE WHEN (cohort.age IS NULL) THEN NULL::integer WHEN (cohort.age < '40'::numeric) THEN 0 WHEN (cohort.age < '60'::numeric) THEN 7 WHEN (cohort.age < '70'::numeric) THEN 12 WHEN (cohort.age < '75'::numeric) THEN 15 WHEN (cohort.age < '80'::numeric) THEN 16 WHEN (cohort.age >= '80'::numeric) THEN 18 ELSE NULL::integer END",
                        "CASE WHEN (cohort.heartrate_max IS NULL) THEN NULL::integer WHEN (cohort.heartrate_min < '40'::double precision) THEN 11 WHEN (cohort.heartrate_max >= '160'::double precision) THEN 7 WHEN (cohort.heartrate_max >= '120'::double precision) THEN 4 WHEN (cohort.heartrate_min < '70'::double precision) THEN 2 WHEN ((cohort.heartrate_max >= '70'::double precision) AND (cohort.heartrate_max < '120'::double precision) AND (cohort.heartrate_min >= '70'::double precision) AND (cohort.heartrate_min < '120'::double precision)) THEN 0 ELSE NULL::integer END",
                        "CASE WHEN (cohort.sysbp_min IS NULL) THEN NULL::integer WHEN (cohort.sysbp_min < '70'::double precision) THEN 13 WHEN (cohort.sysbp_min < '100'::double precision) THEN 5 WHEN (cohort.sysbp_max >= '200'::double precision) THEN 2 WHEN ((cohort.sysbp_max >= '100'::double precision) AND (cohort.sysbp_max < '200'::double precision) AND (cohort.sysbp_min >= '100'::double precision) AND (cohort.sysbp_min < '200'::double precision)) THEN 0 ELSE NULL::integer END",
                        "CASE WHEN (cohort.tempc_max IS NULL) THEN NULL::integer WHEN (cohort.tempc_min < '39'::double precision) THEN 0 WHEN (cohort.tempc_max >= '39'::double precision) THEN 3 ELSE NULL::integer END",
                        "CASE WHEN (cohort.pao2fio2_vent_min IS NULL) THEN NULL::integer WHEN (cohort.pao2fio2_vent_min < '100'::double precision) THEN 11 WHEN (cohort.pao2fio2_vent_min < '200'::double precision) THEN 9 WHEN (cohort.pao2fio2_vent_min >= '200'::double precision) THEN 6 ELSE NULL::integer END",
                        "CASE WHEN (cohort.urineoutput IS NULL) THEN NULL::integer WHEN (cohort.urineoutput < '500'::double precision) THEN 11 WHEN (cohort.urineoutput < '1000'::double precision) THEN 4 WHEN (cohort.urineoutput >= '1000'::double precision) THEN 0 ELSE NULL::integer END",
                        "CASE WHEN (cohort.bun_max IS NULL) THEN NULL::integer WHEN (cohort.bun_max < '28'::double precision) THEN 0 WHEN (cohort.bun_max < '84'::double precision) THEN 6 WHEN (cohort.bun_max >= '84'::double precision) THEN 10 ELSE NULL::integer END",
                        "CASE WHEN (cohort.wbc_max IS NULL) THEN NULL::integer WHEN (cohort.wbc_min < '1'::double precision) THEN 12 WHEN (cohort.wbc_max >= '20'::double precision) THEN 3 WHEN ((cohort.wbc_max >= '1'::double precision) AND (cohort.wbc_max < '20'::double precision) AND (cohort.wbc_min >= '1'::double precision) AND (cohort.wbc_min < '20'::double precision)) THEN 0 ELSE NULL::integer END",
                        "CASE WHEN (cohort.potassium_max IS NULL) THEN NULL::integer WHEN (cohort.potassium_min < '3'::double precision) THEN 3 WHEN (cohort.potassium_max >= '5'::double precision) THEN 3 WHEN ((cohort.potassium_max >= '3'::double precision) AND (cohort.potassium_max < '5'::double precision) AND (cohort.potassium_min >= '3'::double precision) AND (cohort.potassium_min < '5'::double precision)) THEN 0 ELSE NULL::integer END",
                        "CASE WHEN (cohort.sodium_max IS NULL) THEN NULL::integer WHEN (cohort.sodium_min < '125'::double precision) THEN 5 WHEN (cohort.sodium_max >= '145'::double precision) THEN 1 WHEN ((cohort.sodium_max >= '125'::double precision) AND (cohort.sodium_max < '145'::double precision) AND (cohort.sodium_min >= '125'::double precision) AND (cohort.sodium_min < '145'::double precision)) THEN 0 ELSE NULL::integer END",
                        "CASE WHEN (cohort.bicarbonate_max IS NULL) THEN NULL::integer WHEN (cohort.bicarbonate_min < '15'::double precision) THEN 5 WHEN (cohort.bicarbonate_min < '20'::double precision) THEN 3 WHEN ((cohort.bicarbonate_max >= '20'::double precision) AND (cohort.bicarbonate_min >= '20'::double precision)) THEN 0 ELSE NULL::integer END",
                        "CASE WHEN (cohort.bilirubin_max IS NULL) THEN NULL::integer WHEN (cohort.bilirubin_max < '4'::double precision) THEN 0 WHEN (cohort.bilirubin_max < '6'::double precision) THEN 4 WHEN (cohort.bilirubin_max >= '6'::double precision) THEN 9 ELSE NULL::integer END",
                        "CASE WHEN (cohort.mingcs IS NULL) THEN NULL::integer WHEN (cohort.mingcs < '3'::double precision) THEN NULL::integer WHEN (cohort.mingcs < '6'::double precision) THEN 26 WHEN (cohort.mingcs < '9'::double precision) THEN 13 WHEN (cohort.mingcs < '11'::double precision) THEN 7 WHEN (cohort.mingcs < '14'::double precision) THEN 5 WHEN ((cohort.mingcs >= '14'::double precision) AND (cohort.mingcs <= '15'::double precision)) THEN 0 ELSE NULL::integer END",
                        "CASE WHEN (cohort.aids = 1) THEN 17 WHEN (cohort.hem = 1) THEN 10 WHEN (cohort.mets = 1) THEN 9 ELSE 0 END",
                        "CASE WHEN (cohort.admissiontype = 'ScheduledSurgical'::text) THEN 0 WHEN (cohort.admissiontype = 'Medical'::text) THEN 6 WHEN (cohort.admissiontype = 'UnscheduledSurgical'::text) THEN 8 ELSE NULL::integer END"
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE score",
                    "Parallel Aware": false,
                    "CTE Name": "scorecomp",
                    "Alias": "s_1",
                    "Output": [
                        "s_1.subject_id",
                        "s_1.hadm_id",
                        "s_1.icustay_id",
                        "s_1.intime",
                        "s_1.outtime",
                        "s_1.age",
                        "s_1.heartrate_max",
                        "s_1.heartrate_min",
                        "s_1.sysbp_max",
                        "s_1.sysbp_min",
                        "s_1.tempc_max",
                        "s_1.tempc_min",
                        "s_1.pao2fio2_vent_min",
                        "s_1.urineoutput",
                        "s_1.bun_min",
                        "s_1.bun_max",
                        "s_1.wbc_min",
                        "s_1.wbc_max",
                        "s_1.potassium_min",
                        "s_1.potassium_max",
                        "s_1.sodium_min",
                        "s_1.sodium_max",
                        "s_1.bicarbonate_min",
                        "s_1.bicarbonate_max",
                        "s_1.bilirubin_min",
                        "s_1.bilirubin_max",
                        "s_1.mingcs",
                        "s_1.aids",
                        "s_1.hem",
                        "s_1.mets",
                        "s_1.admissiontype",
                        "s_1.age_score",
                        "s_1.hr_score",
                        "s_1.sysbp_score",
                        "s_1.temp_score",
                        "s_1.pao2fio2_score",
                        "s_1.uo_score",
                        "s_1.bun_score",
                        "s_1.wbc_score",
                        "s_1.potassium_score",
                        "s_1.sodium_score",
                        "s_1.bicarbonate_score",
                        "s_1.bilirubin_score",
                        "s_1.gcs_score",
                        "s_1.comorbidity_score",
                        "s_1.admissiontype_score",
                        "((((((((((((((COALESCE(s_1.age_score, 0) + COALESCE(s_1.hr_score, 0)) + COALESCE(s_1.sysbp_score, 0)) + COALESCE(s_1.temp_score, 0)) + COALESCE(s_1.pao2fio2_score, 0)) + COALESCE(s_1.uo_score, 0)) + COALESCE(s_1.bun_score, 0)) + COALESCE(s_1.wbc_score, 0)) + COALESCE(s_1.potassium_score, 0)) + COALESCE(s_1.sodium_score, 0)) + COALESCE(s_1.bicarbonate_score, 0)) + COALESCE(s_1.bilirubin_score, 0)) + COALESCE(s_1.gcs_score, 0)) + COALESCE(s_1.comorbidity_score, 0)) + COALESCE(s_1.admissiontype_score, 0))"
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Join Type": "Right",
                    "Output": [
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id",
                        "s.sapsii",
                        "('1'::double precision / ('1'::double precision + exp((- ((('-7.7631'::numeric + (0.0737 * (s.sapsii)::numeric)))::double precision + ('0.9971'::double precision * ln(((s.sapsii + 1))::double precision)))))))",
                        "s.age_score",
                        "s.hr_score",
                        "s.sysbp_score",
                        "s.temp_score",
                        "s.pao2fio2_score",
                        "s.uo_score",
                        "s.bun_score",
                        "s.wbc_score",
                        "s.potassium_score",
                        "s.sodium_score",
                        "s.bicarbonate_score",
                        "s.bilirubin_score",
                        "s.gcs_score",
                        "s.comorbidity_score",
                        "s.admissiontype_score"
                    ],
                    "Inner Unique": true,
                    "Hash Cond": "(s.icustay_id = ie.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "score",
                            "Alias": "s",
                            "Output": [
                                "s.subject_id",
                                "s.hadm_id",
                                "s.icustay_id",
                                "s.intime",
                                "s.outtime",
                                "s.age",
                                "s.heartrate_max",
                                "s.heartrate_min",
                                "s.sysbp_max",
                                "s.sysbp_min",
                                "s.tempc_max",
                                "s.tempc_min",
                                "s.pao2fio2_vent_min",
                                "s.urineoutput",
                                "s.bun_min",
                                "s.bun_max",
                                "s.wbc_min",
                                "s.wbc_max",
                                "s.potassium_min",
                                "s.potassium_max",
                                "s.sodium_min",
                                "s.sodium_max",
                                "s.bicarbonate_min",
                                "s.bicarbonate_max",
                                "s.bilirubin_min",
                                "s.bilirubin_max",
                                "s.mingcs",
                                "s.aids",
                                "s.hem",
                                "s.mets",
                                "s.admissiontype",
                                "s.age_score",
                                "s.hr_score",
                                "s.sysbp_score",
                                "s.temp_score",
                                "s.pao2fio2_score",
                                "s.uo_score",
                                "s.bun_score",
                                "s.wbc_score",
                                "s.potassium_score",
                                "s.sodium_score",
                                "s.bicarbonate_score",
                                "s.bilirubin_score",
                                "s.gcs_score",
                                "s.comorbidity_score",
                                "s.admissiontype_score",
                                "s.sapsii"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "ie.subject_id",
                                "ie.hadm_id",
                                "ie.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "icustays",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ie",
                                    "Output": [
                                        "ie.subject_id",
                                        "ie.hadm_id",
                                        "ie.icustay_id"
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.sirs": {
        "sql": "-- ------------------------------------------------------------------\n-- Title: Systemic inflammatory response syndrome (SIRS) criteria\n-- This query extracts the Systemic inflammatory response syndrome (SIRS) criteria\n-- The criteria quantify the level of inflammatory response of the body\n-- The score is calculated on the first day of each ICU patients' stay.\n-- ------------------------------------------------------------------\n\n-- Reference for SIRS:\n--    American College of Chest Physicians/Society of Critical Care Medicine Consensus Conference:\n--    definitions for sepsis and organ failure and guidelines for the use of innovative therapies in sepsis\"\n--    Crit. Care Med. 20 (6): 864\u201374. 1992.\n--    doi:10.1097/00003246-199206000-00025. PMID 1597042.\n\n-- Variables used in SIRS:\n--  Body temperature (min and max)\n--  Heart rate (max)\n--  Respiratory rate (max)\n--  PaCO2 (min)\n--  White blood cell count (min and max)\n--  the presence of greater than 10% immature neutrophils (band forms)\n\n-- The following views required to run this query:\n--  1) vitals_first_day - generated by vitals-first-day.sql\n--  2) labs_first_day - generated by labs-first-day.sql\n--  3) blood_gas_first_day_arterial - generated by blood-gas-first-day-arterial.sql\n\n-- Note:\n--  The score is calculated for *all* ICU patients, with the assumption that the user will subselect appropriate ICUSTAY_IDs.\n--  For example, the score is calculated for neonates, but it is likely inappropriate to actually use the score values for these patients.\n\nwith bg as\n(\n  -- join blood gas to ventilation durations to determine if patient was vent\n  select bg.icustay_id\n  , min(pco2) as paco2_min\n  from \"mimic\".\"mimiciii_clinical\".\"blood_gas_first_day_arterial\" bg\n  where specimen_pred = 'ART'\n  group by bg.icustay_id\n)\n-- Aggregate the components for the score\n, scorecomp as\n(\nselect ie.icustay_id\n  , v.tempc_min\n  , v.tempc_max\n  , v.heartrate_max\n  , v.resprate_max\n  , bg.paco2_min\n  , l.wbc_min\n  , l.wbc_max\n  , l.bands_max\nFROM icustays ie\nleft join bg\n on ie.icustay_id = bg.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"vitals_first_day\" v\n  on ie.icustay_id = v.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"labs_first_day\" l\n  on ie.icustay_id = l.icustay_id\n)\n, scorecalc as\n(\n  -- Calculate the final score\n  -- note that if the underlying data is missing, the component is null\n  -- eventually these are treated as 0 (normal), but knowing when data is missing is useful for debugging\n  select icustay_id\n\n  , case\n      when tempc_min < 36.0 then 1\n      when tempc_max > 38.0 then 1\n      when tempc_min is null then null\n      else 0\n    end as temp_score\n\n\n  , case\n      when heartrate_max > 90.0  then 1\n      when heartrate_max is null then null\n      else 0\n    end as heartrate_score\n\n  , case\n      when resprate_max > 20.0  then 1\n      when paco2_min < 32.0  then 1\n      when coalesce(resprate_max, paco2_min) is null then null\n      else 0\n    end as resp_score\n\n  , case\n      when wbc_min <  4.0  then 1\n      when wbc_max > 12.0  then 1\n      when bands_max > 10 then 1-- > 10% immature neurophils (band forms)\n      when coalesce(wbc_min, bands_max) is null then null\n      else 0\n    end as wbc_score\n\n  from scorecomp\n)\nselect\n  ie.subject_id, ie.hadm_id, ie.icustay_id\n  -- Combine all the scores to get SOFA\n  -- Impute 0 if the score is missing\n  , coalesce(temp_score,0)\n  + coalesce(heartrate_score,0)\n  + coalesce(resp_score,0)\n  + coalesce(wbc_score,0)\n    as sirs\n  , temp_score, heartrate_score, resp_score, wbc_score\nFROM icustays ie\nleft join scorecalc s\n  on ie.icustay_id = s.icustay_id\norder by ie.icustay_id",
        "tables": [
            "mimiciii_clinical.blood_gas_first_day_arterial",
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.labs_first_day",
            "mimiciii_clinical.vitals_first_day"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.specimen_pred",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "hadm_id": [
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.specimen_pred",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "icustay_id": [
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.specimen_pred",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "sirs": [
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.specimen_pred",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.labs_first_day.bands_max",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.wbc_max",
                "mimiciii_clinical.labs_first_day.wbc_min",
                "mimiciii_clinical.vitals_first_day.heartrate_max",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.resprate_max",
                "mimiciii_clinical.vitals_first_day.tempc_max",
                "mimiciii_clinical.vitals_first_day.tempc_min"
            ],
            "temp_score": [
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.specimen_pred",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.tempc_max",
                "mimiciii_clinical.vitals_first_day.tempc_min"
            ],
            "heartrate_score": [
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.specimen_pred",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.heartrate_max",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "resp_score": [
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pco2",
                "mimiciii_clinical.blood_gas_first_day_arterial.specimen_pred",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.resprate_max"
            ],
            "wbc_score": [
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.specimen_pred",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.labs_first_day.bands_max",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.wbc_max",
                "mimiciii_clinical.labs_first_day.wbc_min",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ]
        },
        "table_name": "mimiciii_clinical.sirs",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "ie.subject_id",
                "ie.hadm_id",
                "ie.icustay_id",
                "((((COALESCE(s.temp_score, 0) + COALESCE(s.heartrate_score, 0)) + COALESCE(s.resp_score, 0)) + COALESCE(s.wbc_score, 0)))",
                "s.temp_score",
                "s.heartrate_score",
                "s.resp_score",
                "s.wbc_score"
            ],
            "Sort Key": [
                "ie.icustay_id"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE bg",
                    "Parallel Aware": false,
                    "Output": [
                        "bg.icustay_id",
                        "min(bg.pco2)"
                    ],
                    "Group Key": [
                        "bg.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Seq Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "blood_gas_first_day_arterial",
                            "Schema": "mimiciii_clinical",
                            "Alias": "bg",
                            "Output": [
                                "bg.subject_id",
                                "bg.hadm_id",
                                "bg.icustay_id",
                                "bg.charttime",
                                "bg.specimen",
                                "bg.specimen_pred",
                                "bg.specimen_prob",
                                "bg.so2",
                                "bg.spo2",
                                "bg.po2",
                                "bg.pco2",
                                "bg.fio2_chartevents",
                                "bg.fio2",
                                "bg.aado2",
                                "bg.aado2_calc",
                                "bg.pao2fio2",
                                "bg.ph",
                                "bg.baseexcess",
                                "bg.bicarbonate",
                                "bg.totalco2",
                                "bg.hematocrit",
                                "bg.hemoglobin",
                                "bg.carboxyhemoglobin",
                                "bg.methemoglobin",
                                "bg.chloride",
                                "bg.calcium",
                                "bg.temperature",
                                "bg.potassium",
                                "bg.sodium",
                                "bg.lactate",
                                "bg.glucose",
                                "bg.intubated",
                                "bg.tidalvolume",
                                "bg.ventilationrate",
                                "bg.ventilator",
                                "bg.peep",
                                "bg.o2flow",
                                "bg.requiredo2"
                            ],
                            "Filter": "(bg.specimen_pred = 'ART'::text)"
                        }
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE scorecomp",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "ie_1.icustay_id",
                        "v.tempc_min",
                        "v.tempc_max",
                        "v.heartrate_max",
                        "v.resprate_max",
                        "bg_1.paco2_min",
                        "l.wbc_min",
                        "l.wbc_max",
                        "l.bands_max"
                    ],
                    "Inner Unique": false,
                    "Hash Cond": "(ie_1.icustay_id = v.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Right",
                            "Output": [
                                "ie_1.icustay_id",
                                "bg_1.paco2_min",
                                "l.wbc_min",
                                "l.wbc_max",
                                "l.bands_max"
                            ],
                            "Inner Unique": false,
                            "Hash Cond": "(l.icustay_id = ie_1.icustay_id)",
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "labs_first_day",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "l",
                                    "Output": [
                                        "l.subject_id",
                                        "l.hadm_id",
                                        "l.icustay_id",
                                        "l.aniongap_min",
                                        "l.aniongap_max",
                                        "l.albumin_min",
                                        "l.albumin_max",
                                        "l.bands_min",
                                        "l.bands_max",
                                        "l.bicarbonate_min",
                                        "l.bicarbonate_max",
                                        "l.bilirubin_min",
                                        "l.bilirubin_max",
                                        "l.creatinine_min",
                                        "l.creatinine_max",
                                        "l.chloride_min",
                                        "l.chloride_max",
                                        "l.glucose_min",
                                        "l.glucose_max",
                                        "l.hematocrit_min",
                                        "l.hematocrit_max",
                                        "l.hemoglobin_min",
                                        "l.hemoglobin_max",
                                        "l.lactate_min",
                                        "l.lactate_max",
                                        "l.platelet_min",
                                        "l.platelet_max",
                                        "l.potassium_min",
                                        "l.potassium_max",
                                        "l.ptt_min",
                                        "l.ptt_max",
                                        "l.inr_min",
                                        "l.inr_max",
                                        "l.pt_min",
                                        "l.pt_max",
                                        "l.sodium_min",
                                        "l.sodium_max",
                                        "l.bun_min",
                                        "l.bun_max",
                                        "l.wbc_min",
                                        "l.wbc_max"
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "ie_1.icustay_id",
                                        "bg_1.paco2_min"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Hash Join",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Join Type": "Right",
                                            "Output": [
                                                "ie_1.icustay_id",
                                                "bg_1.paco2_min"
                                            ],
                                            "Inner Unique": true,
                                            "Hash Cond": "(bg_1.icustay_id = ie_1.icustay_id)",
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "bg",
                                                    "Alias": "bg_1",
                                                    "Output": [
                                                        "bg_1.icustay_id",
                                                        "bg_1.paco2_min"
                                                    ]
                                                },
                                                {
                                                    "Node Type": "Hash",
                                                    "Parent Relationship": "Inner",
                                                    "Parallel Aware": false,
                                                    "Output": [
                                                        "ie_1.icustay_id"
                                                    ],
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Seq Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Relation Name": "icustays",
                                                            "Schema": "mimiciii_clinical",
                                                            "Alias": "ie_1",
                                                            "Output": [
                                                                "ie_1.icustay_id"
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "v.tempc_min",
                                "v.tempc_max",
                                "v.heartrate_max",
                                "v.resprate_max",
                                "v.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "vitals_first_day",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "v",
                                    "Output": [
                                        "v.tempc_min",
                                        "v.tempc_max",
                                        "v.heartrate_max",
                                        "v.resprate_max",
                                        "v.icustay_id"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE scorecalc",
                    "Parallel Aware": false,
                    "CTE Name": "scorecomp",
                    "Alias": "scorecomp",
                    "Output": [
                        "scorecomp.icustay_id",
                        "CASE WHEN (scorecomp.tempc_min < '36'::double precision) THEN 1 WHEN (scorecomp.tempc_max > '38'::double precision) THEN 1 WHEN (scorecomp.tempc_min IS NULL) THEN NULL::integer ELSE 0 END",
                        "CASE WHEN (scorecomp.heartrate_max > '90'::double precision) THEN 1 WHEN (scorecomp.heartrate_max IS NULL) THEN NULL::integer ELSE 0 END",
                        "CASE WHEN (scorecomp.resprate_max > '20'::double precision) THEN 1 WHEN (scorecomp.paco2_min < '32'::double precision) THEN 1 WHEN (COALESCE(scorecomp.resprate_max, scorecomp.paco2_min) IS NULL) THEN NULL::integer ELSE 0 END",
                        "CASE WHEN (scorecomp.wbc_min < '4'::double precision) THEN 1 WHEN (scorecomp.wbc_max > '12'::double precision) THEN 1 WHEN (scorecomp.bands_max > '10'::double precision) THEN 1 WHEN (COALESCE(scorecomp.wbc_min, scorecomp.bands_max) IS NULL) THEN NULL::integer ELSE 0 END"
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Join Type": "Right",
                    "Output": [
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id",
                        "(((COALESCE(s.temp_score, 0) + COALESCE(s.heartrate_score, 0)) + COALESCE(s.resp_score, 0)) + COALESCE(s.wbc_score, 0))",
                        "s.temp_score",
                        "s.heartrate_score",
                        "s.resp_score",
                        "s.wbc_score"
                    ],
                    "Inner Unique": true,
                    "Hash Cond": "(s.icustay_id = ie.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "scorecalc",
                            "Alias": "s",
                            "Output": [
                                "s.icustay_id",
                                "s.temp_score",
                                "s.heartrate_score",
                                "s.resp_score",
                                "s.wbc_score"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "ie.subject_id",
                                "ie.hadm_id",
                                "ie.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "icustays",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ie",
                                    "Output": [
                                        "ie.subject_id",
                                        "ie.hadm_id",
                                        "ie.icustay_id"
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.sofa": {
        "sql": "-- ------------------------------------------------------------------\n-- Title: Sequential Organ Failure Assessment (SOFA)\n-- This query extracts the sequential organ failure assessment (formally: sepsis-related organ failure assessment).\n-- This score is a measure of organ failure for patients in the ICU.\n-- The score is calculated on the first day of each ICU patients' stay.\n-- ------------------------------------------------------------------\n\n-- Reference for SOFA:\n--    Jean-Louis Vincent, Rui Moreno, Jukka Takala, Sheila Willatts, Arnaldo De Mendon\u00e7a,\n--    Hajo Bruining, C. K. Reinhart, Peter M Suter, and L. G. Thijs.\n--    \"The SOFA (Sepsis-related Organ Failure Assessment) score to describe organ dysfunction/failure.\"\n--    Intensive care medicine 22, no. 7 (1996): 707-710.\n\n-- Variables used in SOFA:\n--  GCS, MAP, FiO2, Ventilation status (sourced FROM chartevents)\n--  Creatinine, Bilirubin, FiO2, PaO2, Platelets (sourced FROM labevents)\n--  Dobutamine, Epinephrine, Norepinephrine (sourced FROM inputevents_mv and INPUTEVENTS_CV)\n--  Urine output (sourced from OUTPUTEVENTS)\n\n-- The following views required to run this query:\n--  1) urine_output_first_day - generated by urine-output-first-day.sql\n--  2) vitals_first_day - generated by vitals-first-day.sql\n--  3) gcs_first_day - generated by gcs-first-day.sql\n--  4) labs_first_day - generated by labs-first-day.sql\n--  5) blood_gas_first_day_arterial - generated by blood-gas-first-day-arterial.sql\n--  6) echodata - generated by echo-data.sql\n--  7) ventilation_durations - generated by ventilation_durations.sql\n\n-- Note:\n--  The score is calculated for *all* ICU patients, with the assumption that the user will subselect appropriate ICUSTAY_IDs.\n--  For example, the score is calculated for neonates, but it is likely inappropriate to actually use the score values for these patients.\n\nwith wt AS\n(\n  SELECT ie.icustay_id\n    -- ensure weight is measured in kg\n    , avg(CASE\n        WHEN itemid IN (762, 763, 3723, 3580, 226512)\n          THEN valuenum\n        -- convert lbs to kgs\n        WHEN itemid IN (3581)\n          THEN valuenum * 0.45359237\n        WHEN itemid IN (3582)\n          THEN valuenum * 0.0283495231\n        ELSE null\n      END) AS weight\n\n  FROM icustays ie\n  left join chartevents c\n    on ie.icustay_id = c.icustay_id\n  WHERE valuenum IS NOT NULL\n  AND itemid IN\n  (\n    762, 763, 3723, 3580,                     -- Weight Kg\n    3581,                                     -- Weight lb\n    3582,                                     -- Weight oz\n    226512 -- Metavision: Admission Weight (Kg)\n  )\n  AND valuenum != 0\n  and charttime between DATETIME_SUB(ie.intime, INTERVAL '1' DAY) and DATETIME_ADD(ie.intime, INTERVAL '1' DAY)\n  -- exclude rows marked as error\n  AND (c.error IS NULL OR c.error = 0)\n  group by ie.icustay_id\n)\n-- 5% of patients are missing a weight, but we can impute weight using their echo notes\n, echo2 as(\n  select ie.icustay_id, avg(weight * 0.45359237) as weight\n  FROM icustays ie\n  left join \"mimic\".\"mimiciii_clinical\".\"echo_data\" echo\n    on ie.hadm_id = echo.hadm_id\n    and echo.charttime > DATETIME_SUB(ie.intime, INTERVAL '7' DAY)\n    and echo.charttime < DATETIME_ADD(ie.intime, INTERVAL '1' DAY)\n  group by ie.icustay_id\n)\n, vaso_cv as\n(\n  select ie.icustay_id\n    -- case statement determining whether the ITEMID is an instance of vasopressor usage\n    , max(case\n            when itemid = 30047 then rate / coalesce(wt.weight,ec.weight) -- measured in mcgmin\n            when itemid = 30120 then rate -- measured in mcgkgmin ** there are clear errors, perhaps actually mcgmin\n            else null\n          end) as rate_norepinephrine\n\n    , max(case\n            when itemid =  30044 then rate / coalesce(wt.weight,ec.weight) -- measured in mcgmin\n            when itemid in (30119,30309) then rate -- measured in mcgkgmin\n            else null\n          end) as rate_epinephrine\n\n    , max(case when itemid in (30043,30307) then rate end) as rate_dopamine\n    , max(case when itemid in (30042,30306) then rate end) as rate_dobutamine\n\n  FROM icustays ie\n  inner join inputevents_cv cv\n    on ie.icustay_id = cv.icustay_id and cv.charttime between ie.intime and DATETIME_ADD(ie.intime, INTERVAL '1' DAY)\n  left join wt\n    on ie.icustay_id = wt.icustay_id\n  left join echo2 ec\n    on ie.icustay_id = ec.icustay_id\n  where itemid in (30047,30120,30044,30119,30309,30043,30307,30042,30306)\n  and rate is not null\n  group by ie.icustay_id\n)\n, vaso_mv as\n(\n  select ie.icustay_id\n    -- case statement determining whether the ITEMID is an instance of vasopressor usage\n    , max(case when itemid = 221906 then rate end) as rate_norepinephrine\n    , max(case when itemid = 221289 then rate end) as rate_epinephrine\n    , max(case when itemid = 221662 then rate end) as rate_dopamine\n    , max(case when itemid = 221653 then rate end) as rate_dobutamine\n  FROM icustays ie\n  inner join inputevents_mv mv\n    on ie.icustay_id = mv.icustay_id and mv.starttime between ie.intime and DATETIME_ADD(ie.intime, INTERVAL '1' DAY)\n  where itemid in (221906,221289,221662,221653)\n  -- 'Rewritten' orders are not delivered to the patient\n  and statusdescription != 'Rewritten'\n  group by ie.icustay_id\n)\n, pafi1 as\n(\n  -- join blood gas to ventilation durations to determine if patient was vent\n  select bg.icustay_id, bg.charttime\n  , pao2fio2\n  , case when vd.icustay_id is not null then 1 else 0 end as isvent\n  from \"mimic\".\"mimiciii_clinical\".\"blood_gas_first_day_arterial\" bg\n  left join \"mimic\".\"mimiciii_clinical\".\"ventilation_durations\" vd\n    on bg.icustay_id = vd.icustay_id\n    and bg.charttime >= vd.starttime\n    and bg.charttime <= vd.endtime\n  order by bg.icustay_id, bg.charttime\n)\n, pafi2 as\n(\n  -- because pafi has an interaction between vent/PaO2:FiO2, we need two columns for the score\n  -- it can happen that the lowest unventilated PaO2/FiO2 is 68, but the lowest ventilated PaO2/FiO2 is 120\n  -- in this case, the SOFA score is 3, *not* 4.\n  select icustay_id\n  , min(case when isvent = 0 then pao2fio2 else null end) as pao2fio2_novent_min\n  , min(case when isvent = 1 then pao2fio2 else null end) as pao2fio2_vent_min\n  from pafi1\n  group by icustay_id\n)\n-- Aggregate the components for the score\n, scorecomp as\n(\nselect ie.icustay_id\n  , v.meanbp_min\n  , coalesce(cv.rate_norepinephrine, mv.rate_norepinephrine) as rate_norepinephrine\n  , coalesce(cv.rate_epinephrine, mv.rate_epinephrine) as rate_epinephrine\n  , coalesce(cv.rate_dopamine, mv.rate_dopamine) as rate_dopamine\n  , coalesce(cv.rate_dobutamine, mv.rate_dobutamine) as rate_dobutamine\n\n  , l.creatinine_max\n  , l.bilirubin_max\n  , l.platelet_min\n\n  , pf.pao2fio2_novent_min\n  , pf.pao2fio2_vent_min\n\n  , uo.urineoutput\n\n  , gcs.mingcs\nFROM icustays ie\nleft join vaso_cv cv\n  on ie.icustay_id = cv.icustay_id\nleft join vaso_mv mv\n  on ie.icustay_id = mv.icustay_id\nleft join pafi2 pf\n on ie.icustay_id = pf.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"vitals_first_day\" v\n  on ie.icustay_id = v.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"labs_first_day\" l\n  on ie.icustay_id = l.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"urine_output_first_day\" uo\n  on ie.icustay_id = uo.icustay_id\nleft join \"mimic\".\"mimiciii_clinical\".\"gcs_first_day\" gcs\n  on ie.icustay_id = gcs.icustay_id\n)\n, scorecalc as\n(\n  -- Calculate the final score\n  -- note that if the underlying data is missing, the component is null\n  -- eventually these are treated as 0 (normal), but knowing when data is missing is useful for debugging\n  select icustay_id\n  -- Respiration\n  , case\n      when pao2fio2_vent_min   < 100 then 4\n      when pao2fio2_vent_min   < 200 then 3\n      when pao2fio2_novent_min < 300 then 2\n      when pao2fio2_novent_min < 400 then 1\n      when coalesce(pao2fio2_vent_min, pao2fio2_novent_min) is null then null\n      else 0\n    end as respiration\n\n  -- Coagulation\n  , case\n      when platelet_min < 20  then 4\n      when platelet_min < 50  then 3\n      when platelet_min < 100 then 2\n      when platelet_min < 150 then 1\n      when platelet_min is null then null\n      else 0\n    end as coagulation\n\n  -- Liver\n  , case\n      -- Bilirubin checks in mg/dL\n        when bilirubin_max >= 12.0 then 4\n        when bilirubin_max >= 6.0  then 3\n        when bilirubin_max >= 2.0  then 2\n        when bilirubin_max >= 1.2  then 1\n        when bilirubin_max is null then null\n        else 0\n      end as liver\n\n  -- Cardiovascular\n  , case\n      when rate_dopamine > 15 or rate_epinephrine >  0.1 or rate_norepinephrine >  0.1 then 4\n      when rate_dopamine >  5 or rate_epinephrine <= 0.1 or rate_norepinephrine <= 0.1 then 3\n      when rate_dopamine >  0 or rate_dobutamine > 0 then 2\n      when meanbp_min < 70 then 1\n      when coalesce(meanbp_min, rate_dopamine, rate_dobutamine, rate_epinephrine, rate_norepinephrine) is null then null\n      else 0\n    end as cardiovascular\n\n  -- Neurological failure (GCS)\n  , case\n      when (mingcs >= 13 and mingcs <= 14) then 1\n      when (mingcs >= 10 and mingcs <= 12) then 2\n      when (mingcs >=  6 and mingcs <=  9) then 3\n      when  mingcs <   6 then 4\n      when  mingcs is null then null\n  else 0 end\n    as cns\n\n  -- Renal failure - high creatinine or low urine output\n  , case\n    when (creatinine_max >= 5.0) then 4\n    when  urineoutput < 200 then 4\n    when (creatinine_max >= 3.5 and creatinine_max < 5.0) then 3\n    when  urineoutput < 500 then 3\n    when (creatinine_max >= 2.0 and creatinine_max < 3.5) then 2\n    when (creatinine_max >= 1.2 and creatinine_max < 2.0) then 1\n    when coalesce(urineoutput, creatinine_max) is null then null\n  else 0 end\n    as renal\n  from scorecomp\n)\nselect ie.subject_id, ie.hadm_id, ie.icustay_id\n  -- Combine all the scores to get SOFA\n  -- Impute 0 if the score is missing\n  , coalesce(respiration,0)\n  + coalesce(coagulation,0)\n  + coalesce(liver,0)\n  + coalesce(cardiovascular,0)\n  + coalesce(cns,0)\n  + coalesce(renal,0)\n  as SOFA\n, respiration\n, coagulation\n, liver\n, cardiovascular\n, cns\n, renal\nFROM icustays ie\nleft join scorecalc s\n  on ie.icustay_id = s.icustay_id\norder by ie.icustay_id",
        "tables": [
            "mimiciii_clinical.blood_gas_first_day_arterial",
            "mimiciii_clinical.chartevents",
            "mimiciii_clinical.echo_data",
            "mimiciii_clinical.gcs_first_day",
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.inputevents_cv",
            "mimiciii_clinical.inputevents_mv",
            "mimiciii_clinical.labs_first_day",
            "mimiciii_clinical.urine_output_first_day",
            "mimiciii_clinical.ventilation_durations",
            "mimiciii_clinical.vitals_first_day"
        ],
        "columns": {
            "subject_id": [
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.icustays.subject_id",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "hadm_id": [
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "icustay_id": [
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "sofa": [
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pao2fio2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.hadm_id",
                "mimiciii_clinical.echo_data.weight",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.gcs_first_day.mingcs",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.labs_first_day.bilirubin_max",
                "mimiciii_clinical.labs_first_day.creatinine_max",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.platelet_min",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.urineoutput",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.meanbp_min"
            ],
            "respiration": [
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.blood_gas_first_day_arterial.pao2fio2",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "coagulation": [
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.labs_first_day.platelet_min",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "liver": [
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.labs_first_day.bilirubin_max",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "cardiovascular": [
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.hadm_id",
                "mimiciii_clinical.echo_data.weight",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.rate",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id",
                "mimiciii_clinical.vitals_first_day.meanbp_min"
            ],
            "cns": [
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.gcs_first_day.mingcs",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ],
            "renal": [
                "mimiciii_clinical.blood_gas_first_day_arterial.charttime",
                "mimiciii_clinical.blood_gas_first_day_arterial.icustay_id",
                "mimiciii_clinical.chartevents.charttime",
                "mimiciii_clinical.chartevents.error",
                "mimiciii_clinical.chartevents.icustay_id",
                "mimiciii_clinical.chartevents.itemid",
                "mimiciii_clinical.chartevents.valuenum",
                "mimiciii_clinical.echo_data.charttime",
                "mimiciii_clinical.echo_data.hadm_id",
                "mimiciii_clinical.gcs_first_day.icustay_id",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.icustays.intime",
                "mimiciii_clinical.inputevents_cv.charttime",
                "mimiciii_clinical.inputevents_cv.icustay_id",
                "mimiciii_clinical.inputevents_cv.itemid",
                "mimiciii_clinical.inputevents_cv.rate",
                "mimiciii_clinical.inputevents_mv.icustay_id",
                "mimiciii_clinical.inputevents_mv.itemid",
                "mimiciii_clinical.inputevents_mv.starttime",
                "mimiciii_clinical.inputevents_mv.statusdescription",
                "mimiciii_clinical.labs_first_day.creatinine_max",
                "mimiciii_clinical.labs_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.icustay_id",
                "mimiciii_clinical.urine_output_first_day.urineoutput",
                "mimiciii_clinical.ventilation_durations.endtime",
                "mimiciii_clinical.ventilation_durations.icustay_id",
                "mimiciii_clinical.ventilation_durations.starttime",
                "mimiciii_clinical.vitals_first_day.icustay_id"
            ]
        },
        "table_name": "mimiciii_clinical.sofa",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "ie.subject_id",
                "ie.hadm_id",
                "ie.icustay_id",
                "((((((COALESCE(s.respiration, 0) + COALESCE(s.coagulation, 0)) + COALESCE(s.liver, 0)) + COALESCE(s.cardiovascular, 0)) + COALESCE(s.cns, 0)) + COALESCE(s.renal, 0)))",
                "s.respiration",
                "s.coagulation",
                "s.liver",
                "s.cardiovascular",
                "s.cns",
                "s.renal"
            ],
            "Sort Key": [
                "ie.icustay_id"
            ],
            "Plans": [
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE wt",
                    "Parallel Aware": false,
                    "Output": [
                        "ie_1.icustay_id",
                        "avg(CASE WHEN (c.itemid = ANY ('{762,763,3723,3580,226512}'::integer[])) THEN c.valuenum WHEN (c.itemid = 3581) THEN (c.valuenum * '0.45359237'::double precision) WHEN (c.itemid = 3582) THEN (c.valuenum * '0.0283495231'::double precision) ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "ie_1.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ie_1.icustay_id",
                                "c.itemid",
                                "c.valuenum"
                            ],
                            "Sort Key": [
                                "ie_1.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "ie_1.icustay_id",
                                        "c.itemid",
                                        "c.valuenum"
                                    ],
                                    "Inner Unique": true,
                                    "Hash Cond": "(c.icustay_id = ie_1.icustay_id)",
                                    "Join Filter": "((c.charttime >= datetime_sub(ie_1.intime, '1 day'::interval day)) AND (c.charttime <= datetime_add(ie_1.intime, '1 day'::interval day)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Append",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Heap Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_88",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "c",
                                                    "Output": [
                                                        "c.itemid",
                                                        "c.valuenum",
                                                        "c.icustay_id",
                                                        "c.charttime"
                                                    ],
                                                    "Recheck Cond": "(c.itemid = ANY ('{762,763,3723,3580,3581,3582,226512}'::integer[]))",
                                                    "Filter": "((c.valuenum IS NOT NULL) AND (c.valuenum <> '0'::double precision) AND ((c.error IS NULL) OR (c.error = 0)))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Bitmap Index Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Index Name": "chartevents_88_idx01",
                                                            "Index Cond": "(c.itemid = ANY ('{762,763,3723,3580,3581,3582,226512}'::integer[]))"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "Node Type": "Bitmap Heap Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_112",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "c_1",
                                                    "Output": [
                                                        "c_1.itemid",
                                                        "c_1.valuenum",
                                                        "c_1.icustay_id",
                                                        "c_1.charttime"
                                                    ],
                                                    "Recheck Cond": "(c_1.itemid = ANY ('{762,763,3723,3580,3581,3582,226512}'::integer[]))",
                                                    "Filter": "((c_1.valuenum IS NOT NULL) AND (c_1.valuenum <> '0'::double precision) AND ((c_1.error IS NULL) OR (c_1.error = 0)))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Bitmap Index Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Index Name": "chartevents_112_idx01",
                                                            "Index Cond": "(c_1.itemid = ANY ('{762,763,3723,3580,3581,3582,226512}'::integer[]))"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "Node Type": "Bitmap Heap Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_121",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "c_2",
                                                    "Output": [
                                                        "c_2.itemid",
                                                        "c_2.valuenum",
                                                        "c_2.icustay_id",
                                                        "c_2.charttime"
                                                    ],
                                                    "Recheck Cond": "(c_2.itemid = ANY ('{762,763,3723,3580,3581,3582,226512}'::integer[]))",
                                                    "Filter": "((c_2.valuenum IS NOT NULL) AND (c_2.valuenum <> '0'::double precision) AND ((c_2.error IS NULL) OR (c_2.error = 0)))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Bitmap Index Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Index Name": "chartevents_121_idx01",
                                                            "Index Cond": "(c_2.itemid = ANY ('{762,763,3723,3580,3581,3582,226512}'::integer[]))"
                                                        }
                                                    ]
                                                },
                                                {
                                                    "Node Type": "Bitmap Heap Scan",
                                                    "Parent Relationship": "Member",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "chartevents_201",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "c_3",
                                                    "Output": [
                                                        "c_3.itemid",
                                                        "c_3.valuenum",
                                                        "c_3.icustay_id",
                                                        "c_3.charttime"
                                                    ],
                                                    "Recheck Cond": "(c_3.itemid = ANY ('{762,763,3723,3580,3581,3582,226512}'::integer[]))",
                                                    "Filter": "((c_3.valuenum IS NOT NULL) AND (c_3.valuenum <> '0'::double precision) AND ((c_3.error IS NULL) OR (c_3.error = 0)))",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "Bitmap Index Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "Index Name": "chartevents_201_idx01",
                                                            "Index Cond": "(c_3.itemid = ANY ('{762,763,3723,3580,3581,3582,226512}'::integer[]))"
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ie_1.icustay_id",
                                                "ie_1.intime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "icustays",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ie_1",
                                                    "Output": [
                                                        "ie_1.icustay_id",
                                                        "ie_1.intime"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE echo2",
                    "Parallel Aware": false,
                    "Output": [
                        "ie_2.icustay_id",
                        "avg((echo.weight * 0.45359237))"
                    ],
                    "Group Key": [
                        "ie_2.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ie_2.icustay_id",
                                "echo.weight"
                            ],
                            "Sort Key": [
                                "ie_2.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Right",
                                    "Output": [
                                        "ie_2.icustay_id",
                                        "echo.weight"
                                    ],
                                    "Inner Unique": false,
                                    "Hash Cond": "(echo.hadm_id = ie_2.hadm_id)",
                                    "Join Filter": "((echo.charttime > datetime_sub(ie_2.intime, '7 days'::interval day)) AND (echo.charttime < datetime_add(ie_2.intime, '1 day'::interval day)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "echo_data",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "echo",
                                            "Output": [
                                                "echo.row_id",
                                                "echo.subject_id",
                                                "echo.hadm_id",
                                                "echo.chartdate",
                                                "echo.charttime",
                                                "echo.indication",
                                                "echo.height",
                                                "echo.weight",
                                                "echo.bsa",
                                                "echo.bp",
                                                "echo.bpsys",
                                                "echo.bpdias",
                                                "echo.hr",
                                                "echo.status",
                                                "echo.test",
                                                "echo.doppler",
                                                "echo.contrast",
                                                "echo.technicalquality"
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ie_2.icustay_id",
                                                "ie_2.hadm_id",
                                                "ie_2.intime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "icustays",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ie_2",
                                                    "Output": [
                                                        "ie_2.icustay_id",
                                                        "ie_2.hadm_id",
                                                        "ie_2.intime"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vaso_cv",
                    "Parallel Aware": false,
                    "Output": [
                        "ie_3.icustay_id",
                        "max(CASE WHEN (cv.itemid = 30047) THEN (cv.rate / COALESCE(wt.weight, (ec.weight)::double precision)) WHEN (cv.itemid = 30120) THEN cv.rate ELSE NULL::double precision END)",
                        "max(CASE WHEN (cv.itemid = 30044) THEN (cv.rate / COALESCE(wt.weight, (ec.weight)::double precision)) WHEN (cv.itemid = ANY ('{30119,30309}'::integer[])) THEN cv.rate ELSE NULL::double precision END)",
                        "max(CASE WHEN (cv.itemid = ANY ('{30043,30307}'::integer[])) THEN cv.rate ELSE NULL::double precision END)",
                        "max(CASE WHEN (cv.itemid = ANY ('{30042,30306}'::integer[])) THEN cv.rate ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "ie_3.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ie_3.icustay_id",
                                "cv.itemid",
                                "cv.rate",
                                "wt.weight",
                                "ec.weight"
                            ],
                            "Sort Key": [
                                "ie_3.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Right",
                                    "Output": [
                                        "ie_3.icustay_id",
                                        "cv.itemid",
                                        "cv.rate",
                                        "wt.weight",
                                        "ec.weight"
                                    ],
                                    "Inner Unique": false,
                                    "Hash Cond": "(ec.icustay_id = ie_3.icustay_id)",
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "echo2",
                                            "Alias": "ec",
                                            "Output": [
                                                "ec.icustay_id",
                                                "ec.weight"
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ie_3.icustay_id",
                                                "cv.itemid",
                                                "cv.rate",
                                                "wt.weight"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Hash Join",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Join Type": "Right",
                                                    "Output": [
                                                        "ie_3.icustay_id",
                                                        "cv.itemid",
                                                        "cv.rate",
                                                        "wt.weight"
                                                    ],
                                                    "Inner Unique": false,
                                                    "Hash Cond": "(wt.icustay_id = ie_3.icustay_id)",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "CTE Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "CTE Name": "wt",
                                                            "Alias": "wt",
                                                            "Output": [
                                                                "wt.icustay_id",
                                                                "wt.weight"
                                                            ]
                                                        },
                                                        {
                                                            "Node Type": "Hash",
                                                            "Parent Relationship": "Inner",
                                                            "Parallel Aware": false,
                                                            "Output": [
                                                                "ie_3.icustay_id",
                                                                "cv.itemid",
                                                                "cv.rate"
                                                            ],
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Hash Join",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Join Type": "Inner",
                                                                    "Output": [
                                                                        "ie_3.icustay_id",
                                                                        "cv.itemid",
                                                                        "cv.rate"
                                                                    ],
                                                                    "Inner Unique": true,
                                                                    "Hash Cond": "(cv.icustay_id = ie_3.icustay_id)",
                                                                    "Join Filter": "((cv.charttime >= ie_3.intime) AND (cv.charttime <= datetime_add(ie_3.intime, '1 day'::interval day)))",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "Bitmap Heap Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "Relation Name": "inputevents_cv",
                                                                            "Schema": "mimiciii_clinical",
                                                                            "Alias": "cv",
                                                                            "Output": [
                                                                                "cv.row_id",
                                                                                "cv.subject_id",
                                                                                "cv.hadm_id",
                                                                                "cv.icustay_id",
                                                                                "cv.charttime",
                                                                                "cv.itemid",
                                                                                "cv.amount",
                                                                                "cv.amountuom",
                                                                                "cv.rate",
                                                                                "cv.rateuom",
                                                                                "cv.storetime",
                                                                                "cv.cgid",
                                                                                "cv.orderid",
                                                                                "cv.linkorderid",
                                                                                "cv.stopped",
                                                                                "cv.newbottle",
                                                                                "cv.originalamount",
                                                                                "cv.originalamountuom",
                                                                                "cv.originalroute",
                                                                                "cv.originalrate",
                                                                                "cv.originalrateuom",
                                                                                "cv.originalsite"
                                                                            ],
                                                                            "Recheck Cond": "(cv.itemid = ANY ('{30047,30120,30044,30119,30309,30043,30307,30042,30306}'::integer[]))",
                                                                            "Filter": "(cv.rate IS NOT NULL)",
                                                                            "Plans": [
                                                                                {
                                                                                    "Node Type": "Bitmap Index Scan",
                                                                                    "Parent Relationship": "Outer",
                                                                                    "Parallel Aware": false,
                                                                                    "Index Name": "inputevents_cv_idx05",
                                                                                    "Index Cond": "(cv.itemid = ANY ('{30047,30120,30044,30119,30309,30043,30307,30042,30306}'::integer[]))"
                                                                                }
                                                                            ]
                                                                        },
                                                                        {
                                                                            "Node Type": "Hash",
                                                                            "Parent Relationship": "Inner",
                                                                            "Parallel Aware": false,
                                                                            "Output": [
                                                                                "ie_3.icustay_id",
                                                                                "ie_3.intime"
                                                                            ],
                                                                            "Plans": [
                                                                                {
                                                                                    "Node Type": "Seq Scan",
                                                                                    "Parent Relationship": "Outer",
                                                                                    "Parallel Aware": false,
                                                                                    "Relation Name": "icustays",
                                                                                    "Schema": "mimiciii_clinical",
                                                                                    "Alias": "ie_3",
                                                                                    "Output": [
                                                                                        "ie_3.icustay_id",
                                                                                        "ie_3.intime"
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE vaso_mv",
                    "Parallel Aware": false,
                    "Output": [
                        "ie_4.icustay_id",
                        "max(CASE WHEN (mv.itemid = 221906) THEN mv.rate ELSE NULL::double precision END)",
                        "max(CASE WHEN (mv.itemid = 221289) THEN mv.rate ELSE NULL::double precision END)",
                        "max(CASE WHEN (mv.itemid = 221662) THEN mv.rate ELSE NULL::double precision END)",
                        "max(CASE WHEN (mv.itemid = 221653) THEN mv.rate ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "ie_4.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "ie_4.icustay_id",
                                "mv.itemid",
                                "mv.rate"
                            ],
                            "Sort Key": [
                                "ie_4.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Inner",
                                    "Output": [
                                        "ie_4.icustay_id",
                                        "mv.itemid",
                                        "mv.rate"
                                    ],
                                    "Inner Unique": true,
                                    "Hash Cond": "(mv.icustay_id = ie_4.icustay_id)",
                                    "Join Filter": "((mv.starttime >= ie_4.intime) AND (mv.starttime <= datetime_add(ie_4.intime, '1 day'::interval day)))",
                                    "Plans": [
                                        {
                                            "Node Type": "Bitmap Heap Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "inputevents_mv",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "mv",
                                            "Output": [
                                                "mv.row_id",
                                                "mv.subject_id",
                                                "mv.hadm_id",
                                                "mv.icustay_id",
                                                "mv.starttime",
                                                "mv.endtime",
                                                "mv.itemid",
                                                "mv.amount",
                                                "mv.amountuom",
                                                "mv.rate",
                                                "mv.rateuom",
                                                "mv.storetime",
                                                "mv.cgid",
                                                "mv.orderid",
                                                "mv.linkorderid",
                                                "mv.ordercategoryname",
                                                "mv.secondaryordercategoryname",
                                                "mv.ordercomponenttypedescription",
                                                "mv.ordercategorydescription",
                                                "mv.patientweight",
                                                "mv.totalamount",
                                                "mv.totalamountuom",
                                                "mv.isopenbag",
                                                "mv.continueinnextdept",
                                                "mv.cancelreason",
                                                "mv.statusdescription",
                                                "mv.comments_editedby",
                                                "mv.comments_canceledby",
                                                "mv.comments_date",
                                                "mv.originalamount",
                                                "mv.originalrate"
                                            ],
                                            "Recheck Cond": "(mv.itemid = ANY ('{221906,221289,221662,221653}'::integer[]))",
                                            "Filter": "((mv.statusdescription)::text <> 'Rewritten'::text)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Bitmap Index Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Index Name": "inputevents_mv_idx05",
                                                    "Index Cond": "(mv.itemid = ANY ('{221906,221289,221662,221653}'::integer[]))"
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "ie_4.icustay_id",
                                                "ie_4.intime"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "icustays",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "ie_4",
                                                    "Output": [
                                                        "ie_4.icustay_id",
                                                        "ie_4.intime"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Sort",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE pafi1",
                    "Parallel Aware": false,
                    "Output": [
                        "bg.icustay_id",
                        "bg.charttime",
                        "bg.pao2fio2",
                        "(CASE WHEN (vd.icustay_id IS NOT NULL) THEN 1 ELSE 0 END)"
                    ],
                    "Sort Key": [
                        "bg.icustay_id",
                        "bg.charttime"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Right",
                            "Output": [
                                "bg.icustay_id",
                                "bg.charttime",
                                "bg.pao2fio2",
                                "CASE WHEN (vd.icustay_id IS NOT NULL) THEN 1 ELSE 0 END"
                            ],
                            "Inner Unique": false,
                            "Hash Cond": "(vd.icustay_id = bg.icustay_id)",
                            "Join Filter": "((bg.charttime >= vd.starttime) AND (bg.charttime <= vd.endtime))",
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "ventilation_durations",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "vd",
                                    "Output": [
                                        "vd.icustay_id",
                                        "vd.starttime",
                                        "vd.endtime"
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "bg.icustay_id",
                                        "bg.charttime",
                                        "bg.pao2fio2"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "blood_gas_first_day_arterial",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "bg",
                                            "Output": [
                                                "bg.icustay_id",
                                                "bg.charttime",
                                                "bg.pao2fio2"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE pafi2",
                    "Parallel Aware": false,
                    "Output": [
                        "pafi1.icustay_id",
                        "min(CASE WHEN (pafi1.isvent = 0) THEN pafi1.pao2fio2 ELSE NULL::double precision END)",
                        "min(CASE WHEN (pafi1.isvent = 1) THEN pafi1.pao2fio2 ELSE NULL::double precision END)"
                    ],
                    "Group Key": [
                        "pafi1.icustay_id"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "pafi1",
                            "Alias": "pafi1",
                            "Output": [
                                "pafi1.icustay_id",
                                "pafi1.charttime",
                                "pafi1.pao2fio2",
                                "pafi1.isvent"
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE scorecomp",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "ie_5.icustay_id",
                        "v.meanbp_min",
                        "COALESCE(cv_1.rate_norepinephrine, mv_1.rate_norepinephrine)",
                        "COALESCE(cv_1.rate_epinephrine, mv_1.rate_epinephrine)",
                        "COALESCE(cv_1.rate_dopamine, mv_1.rate_dopamine)",
                        "COALESCE(cv_1.rate_dobutamine, mv_1.rate_dobutamine)",
                        "l.creatinine_max",
                        "l.bilirubin_max",
                        "l.platelet_min",
                        "pf.pao2fio2_novent_min",
                        "pf.pao2fio2_vent_min",
                        "uo.urineoutput",
                        "gcs.mingcs"
                    ],
                    "Inner Unique": false,
                    "Hash Cond": "(ie_5.icustay_id = gcs.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "Hash Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Left",
                            "Output": [
                                "ie_5.icustay_id",
                                "cv_1.rate_norepinephrine",
                                "cv_1.rate_epinephrine",
                                "cv_1.rate_dopamine",
                                "cv_1.rate_dobutamine",
                                "mv_1.rate_norepinephrine",
                                "mv_1.rate_epinephrine",
                                "mv_1.rate_dopamine",
                                "mv_1.rate_dobutamine",
                                "pf.pao2fio2_novent_min",
                                "pf.pao2fio2_vent_min",
                                "v.meanbp_min",
                                "l.creatinine_max",
                                "l.bilirubin_max",
                                "l.platelet_min",
                                "uo.urineoutput"
                            ],
                            "Inner Unique": false,
                            "Hash Cond": "(ie_5.icustay_id = uo.icustay_id)",
                            "Plans": [
                                {
                                    "Node Type": "Hash Join",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Join Type": "Left",
                                    "Output": [
                                        "ie_5.icustay_id",
                                        "cv_1.rate_norepinephrine",
                                        "cv_1.rate_epinephrine",
                                        "cv_1.rate_dopamine",
                                        "cv_1.rate_dobutamine",
                                        "mv_1.rate_norepinephrine",
                                        "mv_1.rate_epinephrine",
                                        "mv_1.rate_dopamine",
                                        "mv_1.rate_dobutamine",
                                        "pf.pao2fio2_novent_min",
                                        "pf.pao2fio2_vent_min",
                                        "v.meanbp_min",
                                        "l.creatinine_max",
                                        "l.bilirubin_max",
                                        "l.platelet_min"
                                    ],
                                    "Inner Unique": false,
                                    "Hash Cond": "(ie_5.icustay_id = v.icustay_id)",
                                    "Plans": [
                                        {
                                            "Node Type": "Hash Join",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Join Type": "Left",
                                            "Output": [
                                                "ie_5.icustay_id",
                                                "cv_1.rate_norepinephrine",
                                                "cv_1.rate_epinephrine",
                                                "cv_1.rate_dopamine",
                                                "cv_1.rate_dobutamine",
                                                "mv_1.rate_norepinephrine",
                                                "mv_1.rate_epinephrine",
                                                "mv_1.rate_dopamine",
                                                "mv_1.rate_dobutamine",
                                                "pf.pao2fio2_novent_min",
                                                "pf.pao2fio2_vent_min",
                                                "l.creatinine_max",
                                                "l.bilirubin_max",
                                                "l.platelet_min"
                                            ],
                                            "Inner Unique": false,
                                            "Hash Cond": "(ie_5.icustay_id = pf.icustay_id)",
                                            "Plans": [
                                                {
                                                    "Node Type": "Hash Join",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Join Type": "Right",
                                                    "Output": [
                                                        "ie_5.icustay_id",
                                                        "cv_1.rate_norepinephrine",
                                                        "cv_1.rate_epinephrine",
                                                        "cv_1.rate_dopamine",
                                                        "cv_1.rate_dobutamine",
                                                        "mv_1.rate_norepinephrine",
                                                        "mv_1.rate_epinephrine",
                                                        "mv_1.rate_dopamine",
                                                        "mv_1.rate_dobutamine",
                                                        "l.creatinine_max",
                                                        "l.bilirubin_max",
                                                        "l.platelet_min"
                                                    ],
                                                    "Inner Unique": false,
                                                    "Hash Cond": "(cv_1.icustay_id = ie_5.icustay_id)",
                                                    "Plans": [
                                                        {
                                                            "Node Type": "CTE Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "CTE Name": "vaso_cv",
                                                            "Alias": "cv_1",
                                                            "Output": [
                                                                "cv_1.rate_norepinephrine",
                                                                "cv_1.rate_epinephrine",
                                                                "cv_1.rate_dopamine",
                                                                "cv_1.rate_dobutamine",
                                                                "cv_1.icustay_id"
                                                            ]
                                                        },
                                                        {
                                                            "Node Type": "Hash",
                                                            "Parent Relationship": "Inner",
                                                            "Parallel Aware": false,
                                                            "Output": [
                                                                "ie_5.icustay_id",
                                                                "mv_1.rate_norepinephrine",
                                                                "mv_1.rate_epinephrine",
                                                                "mv_1.rate_dopamine",
                                                                "mv_1.rate_dobutamine",
                                                                "l.creatinine_max",
                                                                "l.bilirubin_max",
                                                                "l.platelet_min"
                                                            ],
                                                            "Plans": [
                                                                {
                                                                    "Node Type": "Hash Join",
                                                                    "Parent Relationship": "Outer",
                                                                    "Parallel Aware": false,
                                                                    "Join Type": "Right",
                                                                    "Output": [
                                                                        "ie_5.icustay_id",
                                                                        "mv_1.rate_norepinephrine",
                                                                        "mv_1.rate_epinephrine",
                                                                        "mv_1.rate_dopamine",
                                                                        "mv_1.rate_dobutamine",
                                                                        "l.creatinine_max",
                                                                        "l.bilirubin_max",
                                                                        "l.platelet_min"
                                                                    ],
                                                                    "Inner Unique": false,
                                                                    "Hash Cond": "(mv_1.icustay_id = ie_5.icustay_id)",
                                                                    "Plans": [
                                                                        {
                                                                            "Node Type": "CTE Scan",
                                                                            "Parent Relationship": "Outer",
                                                                            "Parallel Aware": false,
                                                                            "CTE Name": "vaso_mv",
                                                                            "Alias": "mv_1",
                                                                            "Output": [
                                                                                "mv_1.rate_norepinephrine",
                                                                                "mv_1.rate_epinephrine",
                                                                                "mv_1.rate_dopamine",
                                                                                "mv_1.rate_dobutamine",
                                                                                "mv_1.icustay_id"
                                                                            ]
                                                                        },
                                                                        {
                                                                            "Node Type": "Hash",
                                                                            "Parent Relationship": "Inner",
                                                                            "Parallel Aware": false,
                                                                            "Output": [
                                                                                "ie_5.icustay_id",
                                                                                "l.creatinine_max",
                                                                                "l.bilirubin_max",
                                                                                "l.platelet_min"
                                                                            ],
                                                                            "Plans": [
                                                                                {
                                                                                    "Node Type": "Hash Join",
                                                                                    "Parent Relationship": "Outer",
                                                                                    "Parallel Aware": false,
                                                                                    "Join Type": "Right",
                                                                                    "Output": [
                                                                                        "ie_5.icustay_id",
                                                                                        "l.creatinine_max",
                                                                                        "l.bilirubin_max",
                                                                                        "l.platelet_min"
                                                                                    ],
                                                                                    "Inner Unique": true,
                                                                                    "Hash Cond": "(l.icustay_id = ie_5.icustay_id)",
                                                                                    "Plans": [
                                                                                        {
                                                                                            "Node Type": "Seq Scan",
                                                                                            "Parent Relationship": "Outer",
                                                                                            "Parallel Aware": false,
                                                                                            "Relation Name": "labs_first_day",
                                                                                            "Schema": "mimiciii_clinical",
                                                                                            "Alias": "l",
                                                                                            "Output": [
                                                                                                "l.subject_id",
                                                                                                "l.hadm_id",
                                                                                                "l.icustay_id",
                                                                                                "l.aniongap_min",
                                                                                                "l.aniongap_max",
                                                                                                "l.albumin_min",
                                                                                                "l.albumin_max",
                                                                                                "l.bands_min",
                                                                                                "l.bands_max",
                                                                                                "l.bicarbonate_min",
                                                                                                "l.bicarbonate_max",
                                                                                                "l.bilirubin_min",
                                                                                                "l.bilirubin_max",
                                                                                                "l.creatinine_min",
                                                                                                "l.creatinine_max",
                                                                                                "l.chloride_min",
                                                                                                "l.chloride_max",
                                                                                                "l.glucose_min",
                                                                                                "l.glucose_max",
                                                                                                "l.hematocrit_min",
                                                                                                "l.hematocrit_max",
                                                                                                "l.hemoglobin_min",
                                                                                                "l.hemoglobin_max",
                                                                                                "l.lactate_min",
                                                                                                "l.lactate_max",
                                                                                                "l.platelet_min",
                                                                                                "l.platelet_max",
                                                                                                "l.potassium_min",
                                                                                                "l.potassium_max",
                                                                                                "l.ptt_min",
                                                                                                "l.ptt_max",
                                                                                                "l.inr_min",
                                                                                                "l.inr_max",
                                                                                                "l.pt_min",
                                                                                                "l.pt_max",
                                                                                                "l.sodium_min",
                                                                                                "l.sodium_max",
                                                                                                "l.bun_min",
                                                                                                "l.bun_max",
                                                                                                "l.wbc_min",
                                                                                                "l.wbc_max"
                                                                                            ]
                                                                                        },
                                                                                        {
                                                                                            "Node Type": "Hash",
                                                                                            "Parent Relationship": "Inner",
                                                                                            "Parallel Aware": false,
                                                                                            "Output": [
                                                                                                "ie_5.icustay_id"
                                                                                            ],
                                                                                            "Plans": [
                                                                                                {
                                                                                                    "Node Type": "Seq Scan",
                                                                                                    "Parent Relationship": "Outer",
                                                                                                    "Parallel Aware": false,
                                                                                                    "Relation Name": "icustays",
                                                                                                    "Schema": "mimiciii_clinical",
                                                                                                    "Alias": "ie_5",
                                                                                                    "Output": [
                                                                                                        "ie_5.icustay_id"
                                                                                                    ]
                                                                                                }
                                                                                            ]
                                                                                        }
                                                                                    ]
                                                                                }
                                                                            ]
                                                                        }
                                                                    ]
                                                                }
                                                            ]
                                                        }
                                                    ]
                                                },
                                                {
                                                    "Node Type": "Hash",
                                                    "Parent Relationship": "Inner",
                                                    "Parallel Aware": false,
                                                    "Output": [
                                                        "pf.pao2fio2_novent_min",
                                                        "pf.pao2fio2_vent_min",
                                                        "pf.icustay_id"
                                                    ],
                                                    "Plans": [
                                                        {
                                                            "Node Type": "CTE Scan",
                                                            "Parent Relationship": "Outer",
                                                            "Parallel Aware": false,
                                                            "CTE Name": "pafi2",
                                                            "Alias": "pf",
                                                            "Output": [
                                                                "pf.pao2fio2_novent_min",
                                                                "pf.pao2fio2_vent_min",
                                                                "pf.icustay_id"
                                                            ]
                                                        }
                                                    ]
                                                }
                                            ]
                                        },
                                        {
                                            "Node Type": "Hash",
                                            "Parent Relationship": "Inner",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "v.meanbp_min",
                                                "v.icustay_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "Seq Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "Relation Name": "vitals_first_day",
                                                    "Schema": "mimiciii_clinical",
                                                    "Alias": "v",
                                                    "Output": [
                                                        "v.meanbp_min",
                                                        "v.icustay_id"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Hash",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "uo.urineoutput",
                                        "uo.icustay_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Seq Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Relation Name": "urine_output_first_day",
                                            "Schema": "mimiciii_clinical",
                                            "Alias": "uo",
                                            "Output": [
                                                "uo.urineoutput",
                                                "uo.icustay_id"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "gcs.mingcs",
                                "gcs.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "gcs_first_day",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "gcs",
                                    "Output": [
                                        "gcs.mingcs",
                                        "gcs.icustay_id"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE scorecalc",
                    "Parallel Aware": false,
                    "CTE Name": "scorecomp",
                    "Alias": "scorecomp",
                    "Output": [
                        "scorecomp.icustay_id",
                        "CASE WHEN (scorecomp.pao2fio2_vent_min < '100'::double precision) THEN 4 WHEN (scorecomp.pao2fio2_vent_min < '200'::double precision) THEN 3 WHEN (scorecomp.pao2fio2_novent_min < '300'::double precision) THEN 2 WHEN (scorecomp.pao2fio2_novent_min < '400'::double precision) THEN 1 WHEN (COALESCE(scorecomp.pao2fio2_vent_min, scorecomp.pao2fio2_novent_min) IS NULL) THEN NULL::integer ELSE 0 END",
                        "CASE WHEN (scorecomp.platelet_min < '20'::double precision) THEN 4 WHEN (scorecomp.platelet_min < '50'::double precision) THEN 3 WHEN (scorecomp.platelet_min < '100'::double precision) THEN 2 WHEN (scorecomp.platelet_min < '150'::double precision) THEN 1 WHEN (scorecomp.platelet_min IS NULL) THEN NULL::integer ELSE 0 END",
                        "CASE WHEN (scorecomp.bilirubin_max >= '12'::double precision) THEN 4 WHEN (scorecomp.bilirubin_max >= '6'::double precision) THEN 3 WHEN (scorecomp.bilirubin_max >= '2'::double precision) THEN 2 WHEN (scorecomp.bilirubin_max >= '1.2'::double precision) THEN 1 WHEN (scorecomp.bilirubin_max IS NULL) THEN NULL::integer ELSE 0 END",
                        "CASE WHEN ((scorecomp.rate_dopamine > '15'::double precision) OR (scorecomp.rate_epinephrine > '0.1'::double precision) OR (scorecomp.rate_norepinephrine > '0.1'::double precision)) THEN 4 WHEN ((scorecomp.rate_dopamine > '5'::double precision) OR (scorecomp.rate_epinephrine <= '0.1'::double precision) OR (scorecomp.rate_norepinephrine <= '0.1'::double precision)) THEN 3 WHEN ((scorecomp.rate_dopamine > '0'::double precision) OR (scorecomp.rate_dobutamine > '0'::double precision)) THEN 2 WHEN (scorecomp.meanbp_min < '70'::double precision) THEN 1 WHEN (COALESCE(scorecomp.meanbp_min, scorecomp.rate_dopamine, scorecomp.rate_dobutamine, scorecomp.rate_epinephrine, scorecomp.rate_norepinephrine) IS NULL) THEN NULL::integer ELSE 0 END",
                        "CASE WHEN ((scorecomp.mingcs >= '13'::double precision) AND (scorecomp.mingcs <= '14'::double precision)) THEN 1 WHEN ((scorecomp.mingcs >= '10'::double precision) AND (scorecomp.mingcs <= '12'::double precision)) THEN 2 WHEN ((scorecomp.mingcs >= '6'::double precision) AND (scorecomp.mingcs <= '9'::double precision)) THEN 3 WHEN (scorecomp.mingcs < '6'::double precision) THEN 4 WHEN (scorecomp.mingcs IS NULL) THEN NULL::integer ELSE 0 END",
                        "CASE WHEN (scorecomp.creatinine_max >= '5'::double precision) THEN 4 WHEN (scorecomp.urineoutput < '200'::double precision) THEN 4 WHEN ((scorecomp.creatinine_max >= '3.5'::double precision) AND (scorecomp.creatinine_max < '5'::double precision)) THEN 3 WHEN (scorecomp.urineoutput < '500'::double precision) THEN 3 WHEN ((scorecomp.creatinine_max >= '2'::double precision) AND (scorecomp.creatinine_max < '3.5'::double precision)) THEN 2 WHEN ((scorecomp.creatinine_max >= '1.2'::double precision) AND (scorecomp.creatinine_max < '2'::double precision)) THEN 1 WHEN (COALESCE(scorecomp.urineoutput, scorecomp.creatinine_max) IS NULL) THEN NULL::integer ELSE 0 END"
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Join Type": "Right",
                    "Output": [
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id",
                        "(((((COALESCE(s.respiration, 0) + COALESCE(s.coagulation, 0)) + COALESCE(s.liver, 0)) + COALESCE(s.cardiovascular, 0)) + COALESCE(s.cns, 0)) + COALESCE(s.renal, 0))",
                        "s.respiration",
                        "s.coagulation",
                        "s.liver",
                        "s.cardiovascular",
                        "s.cns",
                        "s.renal"
                    ],
                    "Inner Unique": true,
                    "Hash Cond": "(s.icustay_id = ie.icustay_id)",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "scorecalc",
                            "Alias": "s",
                            "Output": [
                                "s.icustay_id",
                                "s.respiration",
                                "s.coagulation",
                                "s.liver",
                                "s.cardiovascular",
                                "s.cns",
                                "s.renal"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "ie.subject_id",
                                "ie.hadm_id",
                                "ie.icustay_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "icustays",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ie",
                                    "Output": [
                                        "ie.subject_id",
                                        "ie.hadm_id",
                                        "ie.icustay_id"
                                    ]
                                }
                            ]
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.abx_prescriptions_list": {
        "sql": " \nwith t1 as\n(\n  select\n    drug, drug_name_generic\n    , route\n    , case\n      when lower(drug) like '%adoxa%' then 1\n      when lower(drug) like '%ala-tet%' then 1\n      when lower(drug) like '%alodox%' then 1\n      when lower(drug) like '%amikacin%' then 1\n      when lower(drug) like '%amikin%' then 1\n      when lower(drug) like '%amoxicillin%' then 1\n      when lower(drug) like '%amoxicillin%clavulanate%' then 1\n      when lower(drug) like '%clavulanate%' then 1\n      when lower(drug) like '%ampicillin%' then 1\n      when lower(drug) like '%augmentin%' then 1\n      when lower(drug) like '%avelox%' then 1\n      when lower(drug) like '%avidoxy%' then 1\n      when lower(drug) like '%azactam%' then 1\n      when lower(drug) like '%azithromycin%' then 1\n      when lower(drug) like '%aztreonam%' then 1\n      when lower(drug) like '%axetil%' then 1\n      when lower(drug) like '%bactocill%' then 1\n      when lower(drug) like '%bactrim%' then 1\n      when lower(drug) like '%bethkis%' then 1\n      when lower(drug) like '%biaxin%' then 1\n      when lower(drug) like '%bicillin l-a%' then 1\n      when lower(drug) like '%cayston%' then 1\n      when lower(drug) like '%cefazolin%' then 1\n      when lower(drug) like '%cedax%' then 1\n      when lower(drug) like '%cefoxitin%' then 1\n      when lower(drug) like '%ceftazidime%' then 1\n      when lower(drug) like '%cefaclor%' then 1\n      when lower(drug) like '%cefadroxil%' then 1\n      when lower(drug) like '%cefdinir%' then 1\n      when lower(drug) like '%cefditoren%' then 1\n      when lower(drug) like '%cefepime%' then 1\n      when lower(drug) like '%cefotetan%' then 1\n      when lower(drug) like '%cefotaxime%' then 1\n      when lower(drug) like '%cefpodoxime%' then 1\n      when lower(drug) like '%cefprozil%' then 1\n      when lower(drug) like '%ceftibuten%' then 1\n      when lower(drug) like '%ceftin%' then 1\n      when lower(drug) like '%cefuroxime %' then 1\n      when lower(drug) like '%cefuroxime%' then 1\n      when lower(drug) like '%cephalexin%' then 1\n      when lower(drug) like '%chloramphenicol%' then 1\n      when lower(drug) like '%cipro%' then 1\n      when lower(drug) like '%ciprofloxacin%' then 1\n      when lower(drug) like '%claforan%' then 1\n      when lower(drug) like '%clarithromycin%' then 1\n      when lower(drug) like '%cleocin%' then 1\n      when lower(drug) like '%clindamycin%' then 1\n      when lower(drug) like '%cubicin%' then 1\n      when lower(drug) like '%dicloxacillin%' then 1\n      when lower(drug) like '%doryx%' then 1\n      when lower(drug) like '%doxycycline%' then 1\n      when lower(drug) like '%duricef%' then 1\n      when lower(drug) like '%dynacin%' then 1\n      when lower(drug) like '%ery-tab%' then 1\n      when lower(drug) like '%eryped%' then 1\n      when lower(drug) like '%eryc%' then 1\n      when lower(drug) like '%erythrocin%' then 1\n      when lower(drug) like '%erythromycin%' then 1\n      when lower(drug) like '%factive%' then 1\n      when lower(drug) like '%flagyl%' then 1\n      when lower(drug) like '%fortaz%' then 1\n      when lower(drug) like '%furadantin%' then 1\n      when lower(drug) like '%garamycin%' then 1\n      when lower(drug) like '%gentamicin%' then 1\n      when lower(drug) like '%kanamycin%' then 1\n      when lower(drug) like '%keflex%' then 1\n      when lower(drug) like '%ketek%' then 1\n      when lower(drug) like '%levaquin%' then 1\n      when lower(drug) like '%levofloxacin%' then 1\n      when lower(drug) like '%lincocin%' then 1\n      when lower(drug) like '%macrobid%' then 1\n      when lower(drug) like '%macrodantin%' then 1\n      when lower(drug) like '%maxipime%' then 1\n      when lower(drug) like '%mefoxin%' then 1\n      when lower(drug) like '%metronidazole%' then 1\n      when lower(drug) like '%minocin%' then 1\n      when lower(drug) like '%minocycline%' then 1\n      when lower(drug) like '%monodox%' then 1\n      when lower(drug) like '%monurol%' then 1\n      when lower(drug) like '%morgidox%' then 1\n      when lower(drug) like '%moxatag%' then 1\n      when lower(drug) like '%moxifloxacin%' then 1\n      when lower(drug) like '%myrac%' then 1\n      when lower(drug) like '%nafcillin sodium%' then 1\n      when lower(drug) like '%nicazel doxy 30%' then 1\n      when lower(drug) like '%nitrofurantoin%' then 1\n      when lower(drug) like '%noroxin%' then 1\n      when lower(drug) like '%ocudox%' then 1\n      when lower(drug) like '%ofloxacin%' then 1\n      when lower(drug) like '%omnicef%' then 1\n      when lower(drug) like '%oracea%' then 1\n      when lower(drug) like '%oraxyl%' then 1\n      when lower(drug) like '%oxacillin%' then 1\n      when lower(drug) like '%pc pen vk%' then 1\n      when lower(drug) like '%pce dispertab%' then 1\n      when lower(drug) like '%panixine%' then 1\n      when lower(drug) like '%pediazole%' then 1\n      when lower(drug) like '%penicillin%' then 1\n      when lower(drug) like '%periostat%' then 1\n      when lower(drug) like '%pfizerpen%' then 1\n      when lower(drug) like '%piperacillin%' then 1\n      when lower(drug) like '%tazobactam%' then 1\n      when lower(drug) like '%primsol%' then 1\n      when lower(drug) like '%proquin%' then 1\n      when lower(drug) like '%raniclor%' then 1\n      when lower(drug) like '%rifadin%' then 1\n      when lower(drug) like '%rifampin%' then 1\n      when lower(drug) like '%rocephin%' then 1\n      when lower(drug) like '%smz-tmp%' then 1\n      when lower(drug) like '%septra%' then 1\n      when lower(drug) like '%septra ds%' then 1\n      when lower(drug) like '%septra%' then 1\n      when lower(drug) like '%solodyn%' then 1\n      when lower(drug) like '%spectracef%' then 1\n      when lower(drug) like '%streptomycin sulfate%' then 1\n      when lower(drug) like '%sulfadiazine%' then 1\n      when lower(drug) like '%sulfamethoxazole%' then 1\n      when lower(drug) like '%trimethoprim%' then 1\n      when lower(drug) like '%sulfatrim%' then 1\n      when lower(drug) like '%sulfisoxazole%' then 1\n      when lower(drug) like '%suprax%' then 1\n      when lower(drug) like '%synercid%' then 1\n      when lower(drug) like '%tazicef%' then 1\n      when lower(drug) like '%tetracycline%' then 1\n      when lower(drug) like '%timentin%' then 1\n      when lower(drug) like '%tobi%' then 1\n      when lower(drug) like '%tobramycin%' then 1\n      when lower(drug) like '%trimethoprim%' then 1\n      when lower(drug) like '%unasyn%' then 1\n      when lower(drug) like '%vancocin%' then 1\n      when lower(drug) like '%vancomycin%' then 1\n      when lower(drug) like '%vantin%' then 1\n      when lower(drug) like '%vibativ%' then 1\n      when lower(drug) like '%vibra-tabs%' then 1\n      when lower(drug) like '%vibramycin%' then 1\n      when lower(drug) like '%zinacef%' then 1\n      when lower(drug) like '%zithromax%' then 1\n      when lower(drug) like '%zmax%' then 1\n      when lower(drug) like '%zosyn%' then 1\n      when lower(drug) like '%zyvox%' then 1\n    else 0\n    end as antibiotic\n  from prescriptions\n  where drug_type in ('MAIN','ADDITIVE')\n  -- we exclude routes via the eye, ears, or topically\n  and route not in ('OU','OS','OD','AU','AS','AD', 'TP')\n  and lower(route) not like '%ear%'\n  and lower(route) not like '%eye%'\n  -- we exclude certain types of antibiotics: topical creams, gels, desens, etc\n  and lower(drug) not like '%cream%'\n  and lower(drug) not like '%desensitization%'\n  and lower(drug) not like '%ophth oint%'\n  and lower(drug) not like '%gel%'\n  -- other routes not sure about...\n  -- for sure keep: ('IV','PO','PO/NG','ORAL', 'IV DRIP', 'IV BOLUS')\n  -- ? VT, PB, PR, PL, NS, NG, NEB, NAS, LOCK, J TUBE, IVT\n  -- ? IT, IRR, IP, IO, INHALATION, IN, IM\n  -- ? IJ, IH, G TUBE, DIALYS\n  -- ?? enemas??\n)\nselect\n  drug --, drug_name_generic\n  , count(*) as numobs\nfrom t1\nwhere antibiotic = 1\ngroup by drug --, drug_name_generic\norder by numobs desc",
        "tables": [
            "mimiciii_clinical.prescriptions"
        ],
        "columns": {
            "drug": [
                "mimiciii_clinical.prescriptions.drug",
                "mimiciii_clinical.prescriptions.drug_type",
                "mimiciii_clinical.prescriptions.route"
            ],
            "numobs": [
                "mimiciii_clinical.prescriptions.drug",
                "mimiciii_clinical.prescriptions.drug_type",
                "mimiciii_clinical.prescriptions.route"
            ]
        },
        "table_name": "mimiciii_clinical.abx_prescriptions_list",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "t1.drug",
                "(count(*))"
            ],
            "Sort Key": [
                "(count(*)) DESC"
            ],
            "Plans": [
                {
                    "Node Type": "Seq Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE t1",
                    "Parallel Aware": false,
                    "Relation Name": "prescriptions",
                    "Schema": "mimiciii_clinical",
                    "Alias": "prescriptions",
                    "Output": [
                        "prescriptions.drug",
                        "prescriptions.drug_name_generic",
                        "prescriptions.route",
                        "CASE WHEN (lower((prescriptions.drug)::text) ~~ '%adoxa%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%ala-tet%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%alodox%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%amikacin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%amikin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%amoxicillin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%amoxicillin%clavulanate%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%clavulanate%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%ampicillin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%augmentin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%avelox%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%avidoxy%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%azactam%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%azithromycin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%aztreonam%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%axetil%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%bactocill%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%bactrim%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%bethkis%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%biaxin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%bicillin l-a%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%cayston%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%cefazolin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%cedax%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%cefoxitin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%ceftazidime%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%cefaclor%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%cefadroxil%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%cefdinir%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%cefditoren%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%cefepime%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%cefotetan%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%cefotaxime%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%cefpodoxime%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%cefprozil%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%ceftibuten%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%ceftin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%cefuroxime %'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%cefuroxime%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%cephalexin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%chloramphenicol%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%cipro%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%ciprofloxacin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%claforan%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%clarithromycin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%cleocin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%clindamycin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%cubicin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%dicloxacillin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%doryx%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%doxycycline%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%duricef%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%dynacin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%ery-tab%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%eryped%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%eryc%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%erythrocin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%erythromycin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%factive%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%flagyl%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%fortaz%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%furadantin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%garamycin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%gentamicin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%kanamycin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%keflex%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%ketek%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%levaquin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%levofloxacin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%lincocin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%macrobid%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%macrodantin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%maxipime%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%mefoxin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%metronidazole%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%minocin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%minocycline%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%monodox%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%monurol%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%morgidox%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%moxatag%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%moxifloxacin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%myrac%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%nafcillin sodium%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%nicazel doxy 30%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%nitrofurantoin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%noroxin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%ocudox%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%ofloxacin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%omnicef%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%oracea%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%oraxyl%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%oxacillin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%pc pen vk%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%pce dispertab%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%panixine%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%pediazole%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%penicillin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%periostat%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%pfizerpen%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%piperacillin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%tazobactam%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%primsol%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%proquin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%raniclor%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%rifadin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%rifampin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%rocephin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%smz-tmp%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%septra%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%septra ds%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%septra%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%solodyn%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%spectracef%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%streptomycin sulfate%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%sulfadiazine%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%sulfamethoxazole%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%trimethoprim%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%sulfatrim%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%sulfisoxazole%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%suprax%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%synercid%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%tazicef%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%tetracycline%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%timentin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%tobi%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%tobramycin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%trimethoprim%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%unasyn%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%vancocin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%vancomycin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%vantin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%vibativ%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%vibra-tabs%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%vibramycin%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%zinacef%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%zithromax%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%zmax%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%zosyn%'::text) THEN 1 WHEN (lower((prescriptions.drug)::text) ~~ '%zyvox%'::text) THEN 1 ELSE 0 END"
                    ],
                    "Filter": "(((prescriptions.drug_type)::text = ANY ('{MAIN,ADDITIVE}'::text[])) AND (lower((prescriptions.route)::text) !~~ '%ear%'::text) AND (lower((prescriptions.route)::text) !~~ '%eye%'::text) AND (lower((prescriptions.drug)::text) !~~ '%cream%'::text) AND (lower((prescriptions.drug)::text) !~~ '%desensitization%'::text) AND (lower((prescriptions.drug)::text) !~~ '%ophth oint%'::text) AND (lower((prescriptions.drug)::text) !~~ '%gel%'::text) AND ((prescriptions.route)::text <> ALL ('{OU,OS,OD,AU,AS,AD,TP}'::text[])))"
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Hashed",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "Output": [
                        "t1.drug",
                        "count(*)"
                    ],
                    "Group Key": [
                        "t1.drug"
                    ],
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "t1",
                            "Alias": "t1",
                            "Output": [
                                "t1.drug",
                                "t1.drug_name_generic",
                                "t1.route",
                                "t1.antibiotic"
                            ],
                            "Filter": "(t1.antibiotic = 1)"
                        }
                    ]
                }
            ]
        }
    },
    "model.mimic.suspicion_of_infection": {
        "sql": " \n\n-- defines suspicion of infection using prescriptions + microbiologyevents\nwith abx as\n(\n  select pr.hadm_id\n  , pr.drug as antibiotic_name\n  , pr.startdate as antibiotic_time\n  , pr.enddate as antibiotic_endtime\n  from prescriptions pr\n  -- inner join to subselect to only antibiotic prescriptions\n  inner join \"mimic\".\"mimiciii_clinical\".\"abx_prescriptions_list\" ab\n      on pr.drug = ab.drug\n)\n-- get cultures for each icustay\n-- note this duplicates prescriptions\n-- each ICU stay in the same hospitalization will get a copy of all prescriptions for that hospitalization\n, ab_tbl as\n(\n  select\n        ie.subject_id, ie.hadm_id, ie.icustay_id\n      , ie.intime, ie.outtime\n      , abx.antibiotic_name\n      , abx.antibiotic_time\n      , abx.antibiotic_endtime\n  from icustays ie\n  left join abx\n      on ie.hadm_id = abx.hadm_id\n)\n, me as\n(\n  select hadm_id\n    , chartdate, charttime\n    , spec_type_desc\n    , max(case when org_name is not null and org_name != '' then 1 else 0 end) as PositiveCulture\n  from microbiologyevents\n  group by hadm_id, chartdate, charttime, spec_type_desc\n)\n, ab_fnl as\n(\n  select\n      ab_tbl.icustay_id, ab_tbl.intime, ab_tbl.outtime\n    , ab_tbl.antibiotic_name\n    , ab_tbl.antibiotic_time\n    , coalesce(me72.charttime,me72.chartdate) as last72_charttime\n    , coalesce(me24.charttime,me24.chartdate) as next24_charttime\n    , me72.positiveculture as last72_positiveculture\n    , me72.spec_type_desc as last72_specimen\n    , me24.positiveculture as next24_positiveculture\n    , me24.spec_type_desc as next24_specimen\n  from ab_tbl\n  -- blood culture in last 72 hours\n  left join me me72\n    on ab_tbl.hadm_id = me72.hadm_id\n    and ab_tbl.antibiotic_time is not null\n    and\n    (\n      -- if charttime is available, use it\n      (\n          ab_tbl.antibiotic_time >= me72.charttime\n      and ab_tbl.antibiotic_time <= datetime_add(me72.charttime, INTERVAL '72 HOUR')\n      )\n      OR\n      (\n      -- if charttime is not available, use chartdate\n          me72.charttime is null\n      and ab_tbl.antibiotic_time >= me72.chartdate\n      and ab_tbl.antibiotic_time <= datetime_add(me72.chartdate, INTERVAL '96 HOUR')\n      )\n    )\n  -- blood culture in subsequent 24 hours\n  left join me me24\n    on ab_tbl.hadm_id = me24.hadm_id\n    and ab_tbl.antibiotic_time is not null\n    and\n    (\n      -- if charttime is available, use it\n      (\n          ab_tbl.antibiotic_time <= me24.charttime\n      and ab_tbl.antibiotic_time >= datetime_sub(me24.charttime, INTERVAL '24 HOUR')\n      )\n      OR\n      (\n      -- if charttime is not available, use chartdate\n          me24.charttime is null\n      and ab_tbl.antibiotic_time <= me24.chartdate\n      and ab_tbl.antibiotic_time >= datetime_sub(me24.chartdate, INTERVAL '24 HOUR')\n      )\n    )\n)\n, ab_laststg as\n(\nselect\n  icustay_id\n  , antibiotic_name\n  , antibiotic_time\n  , last72_charttime\n  , next24_charttime\n\n  -- time of suspected infection: either the culture time (if before antibiotic), or the antibiotic time\n  , case\n      when coalesce(last72_charttime,next24_charttime) is null\n        then 0\n      else 1 end as suspected_infection\n\n  , coalesce(last72_charttime,next24_charttime) as suspected_infection_time\n\n  -- the specimen that was cultured\n  , case\n      when last72_charttime is not null\n        then last72_specimen\n      when next24_charttime is not null\n        then next24_specimen\n    else null\n  end as specimen\n\n  -- whether the cultured specimen ended up being positive or not\n  , case\n      when last72_charttime is not null\n        then last72_positiveculture\n      when next24_charttime is not null\n        then next24_positiveculture\n    else null\n  end as positiveculture\nfrom ab_fnl\n)\nselect\n  icustay_id\n  , antibiotic_name\n  , antibiotic_time\n  , last72_charttime\n  , next24_charttime\n  , suspected_infection_time\n  -- -- the below two fields are used to extract data - modifying them facilitates sensitivity analyses\n  -- , suspected_infection_time - interval '48' hour as si_starttime\n  -- , suspected_infection_time + interval '24' hour as si_endtime\n  , specimen, positiveculture\nfrom ab_laststg\norder by icustay_id, antibiotic_time",
        "tables": [
            "mimiciii_clinical.abx_prescriptions_list",
            "mimiciii_clinical.icustays",
            "mimiciii_clinical.microbiologyevents",
            "mimiciii_clinical.prescriptions"
        ],
        "columns": {
            "icustay_id": [
                "mimiciii_clinical.abx_prescriptions_list.drug",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.microbiologyevents.chartdate",
                "mimiciii_clinical.microbiologyevents.charttime",
                "mimiciii_clinical.microbiologyevents.hadm_id",
                "mimiciii_clinical.microbiologyevents.spec_type_desc",
                "mimiciii_clinical.prescriptions.drug",
                "mimiciii_clinical.prescriptions.hadm_id",
                "mimiciii_clinical.prescriptions.startdate"
            ],
            "antibiotic_name": [
                "mimiciii_clinical.abx_prescriptions_list.drug",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.microbiologyevents.chartdate",
                "mimiciii_clinical.microbiologyevents.charttime",
                "mimiciii_clinical.microbiologyevents.hadm_id",
                "mimiciii_clinical.microbiologyevents.spec_type_desc",
                "mimiciii_clinical.prescriptions.drug",
                "mimiciii_clinical.prescriptions.hadm_id",
                "mimiciii_clinical.prescriptions.startdate"
            ],
            "antibiotic_time": [
                "mimiciii_clinical.abx_prescriptions_list.drug",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.microbiologyevents.chartdate",
                "mimiciii_clinical.microbiologyevents.charttime",
                "mimiciii_clinical.microbiologyevents.hadm_id",
                "mimiciii_clinical.microbiologyevents.spec_type_desc",
                "mimiciii_clinical.prescriptions.drug",
                "mimiciii_clinical.prescriptions.hadm_id",
                "mimiciii_clinical.prescriptions.startdate"
            ],
            "last72_charttime": [
                "mimiciii_clinical.abx_prescriptions_list.drug",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.microbiologyevents.chartdate",
                "mimiciii_clinical.microbiologyevents.charttime",
                "mimiciii_clinical.microbiologyevents.hadm_id",
                "mimiciii_clinical.microbiologyevents.spec_type_desc",
                "mimiciii_clinical.prescriptions.drug",
                "mimiciii_clinical.prescriptions.hadm_id",
                "mimiciii_clinical.prescriptions.startdate"
            ],
            "next24_charttime": [
                "mimiciii_clinical.abx_prescriptions_list.drug",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.microbiologyevents.chartdate",
                "mimiciii_clinical.microbiologyevents.charttime",
                "mimiciii_clinical.microbiologyevents.hadm_id",
                "mimiciii_clinical.microbiologyevents.spec_type_desc",
                "mimiciii_clinical.prescriptions.drug",
                "mimiciii_clinical.prescriptions.hadm_id",
                "mimiciii_clinical.prescriptions.startdate"
            ],
            "suspected_infection_time": [
                "mimiciii_clinical.abx_prescriptions_list.drug",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.microbiologyevents.chartdate",
                "mimiciii_clinical.microbiologyevents.charttime",
                "mimiciii_clinical.microbiologyevents.hadm_id",
                "mimiciii_clinical.microbiologyevents.spec_type_desc",
                "mimiciii_clinical.prescriptions.drug",
                "mimiciii_clinical.prescriptions.hadm_id",
                "mimiciii_clinical.prescriptions.startdate"
            ],
            "specimen": [
                "mimiciii_clinical.abx_prescriptions_list.drug",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.microbiologyevents.chartdate",
                "mimiciii_clinical.microbiologyevents.charttime",
                "mimiciii_clinical.microbiologyevents.hadm_id",
                "mimiciii_clinical.microbiologyevents.spec_type_desc",
                "mimiciii_clinical.prescriptions.drug",
                "mimiciii_clinical.prescriptions.hadm_id",
                "mimiciii_clinical.prescriptions.startdate"
            ],
            "positiveculture": [
                "mimiciii_clinical.abx_prescriptions_list.drug",
                "mimiciii_clinical.icustays.hadm_id",
                "mimiciii_clinical.icustays.icustay_id",
                "mimiciii_clinical.microbiologyevents.chartdate",
                "mimiciii_clinical.microbiologyevents.charttime",
                "mimiciii_clinical.microbiologyevents.hadm_id",
                "mimiciii_clinical.microbiologyevents.org_name",
                "mimiciii_clinical.microbiologyevents.spec_type_desc",
                "mimiciii_clinical.prescriptions.drug",
                "mimiciii_clinical.prescriptions.hadm_id",
                "mimiciii_clinical.prescriptions.startdate"
            ]
        },
        "table_name": "mimiciii_clinical.suspicion_of_infection",
        "plan": {
            "Node Type": "Sort",
            "Parallel Aware": false,
            "Output": [
                "ab_laststg.icustay_id",
                "ab_laststg.antibiotic_name",
                "ab_laststg.antibiotic_time",
                "ab_laststg.last72_charttime",
                "ab_laststg.next24_charttime",
                "ab_laststg.suspected_infection_time",
                "ab_laststg.specimen",
                "ab_laststg.positiveculture"
            ],
            "Sort Key": [
                "ab_laststg.icustay_id",
                "ab_laststg.antibiotic_time"
            ],
            "Plans": [
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE abx",
                    "Parallel Aware": false,
                    "Join Type": "Inner",
                    "Output": [
                        "pr.hadm_id",
                        "pr.drug",
                        "pr.startdate",
                        "pr.enddate"
                    ],
                    "Inner Unique": false,
                    "Hash Cond": "((pr.drug)::text = (ab.drug)::text)",
                    "Plans": [
                        {
                            "Node Type": "Seq Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Relation Name": "prescriptions",
                            "Schema": "mimiciii_clinical",
                            "Alias": "pr",
                            "Output": [
                                "pr.row_id",
                                "pr.subject_id",
                                "pr.hadm_id",
                                "pr.icustay_id",
                                "pr.startdate",
                                "pr.enddate",
                                "pr.drug_type",
                                "pr.drug",
                                "pr.drug_name_poe",
                                "pr.drug_name_generic",
                                "pr.formulary_drug_cd",
                                "pr.gsn",
                                "pr.ndc",
                                "pr.prod_strength",
                                "pr.dose_val_rx",
                                "pr.dose_unit_rx",
                                "pr.form_val_disp",
                                "pr.form_unit_disp",
                                "pr.route"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "ab.drug"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "abx_prescriptions_list",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ab",
                                    "Output": [
                                        "ab.drug"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Hash Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE ab_tbl",
                    "Parallel Aware": false,
                    "Join Type": "Right",
                    "Output": [
                        "ie.subject_id",
                        "ie.hadm_id",
                        "ie.icustay_id",
                        "ie.intime",
                        "ie.outtime",
                        "abx.antibiotic_name",
                        "abx.antibiotic_time",
                        "abx.antibiotic_endtime"
                    ],
                    "Inner Unique": false,
                    "Hash Cond": "(abx.hadm_id = ie.hadm_id)",
                    "Plans": [
                        {
                            "Node Type": "CTE Scan",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "CTE Name": "abx",
                            "Alias": "abx",
                            "Output": [
                                "abx.antibiotic_name",
                                "abx.antibiotic_time",
                                "abx.antibiotic_endtime",
                                "abx.hadm_id"
                            ]
                        },
                        {
                            "Node Type": "Hash",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "ie.subject_id",
                                "ie.hadm_id",
                                "ie.icustay_id",
                                "ie.intime",
                                "ie.outtime"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "icustays",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "ie",
                                    "Output": [
                                        "ie.subject_id",
                                        "ie.hadm_id",
                                        "ie.icustay_id",
                                        "ie.intime",
                                        "ie.outtime"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Aggregate",
                    "Strategy": "Sorted",
                    "Partial Mode": "Simple",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE me",
                    "Parallel Aware": false,
                    "Output": [
                        "microbiologyevents.hadm_id",
                        "microbiologyevents.chartdate",
                        "microbiologyevents.charttime",
                        "microbiologyevents.spec_type_desc",
                        "max(CASE WHEN ((microbiologyevents.org_name IS NOT NULL) AND ((microbiologyevents.org_name)::text <> ''::text)) THEN 1 ELSE 0 END)"
                    ],
                    "Group Key": [
                        "microbiologyevents.hadm_id",
                        "microbiologyevents.chartdate",
                        "microbiologyevents.charttime",
                        "microbiologyevents.spec_type_desc"
                    ],
                    "Plans": [
                        {
                            "Node Type": "Sort",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Output": [
                                "microbiologyevents.hadm_id",
                                "microbiologyevents.chartdate",
                                "microbiologyevents.charttime",
                                "microbiologyevents.spec_type_desc",
                                "microbiologyevents.org_name"
                            ],
                            "Sort Key": [
                                "microbiologyevents.hadm_id",
                                "microbiologyevents.chartdate",
                                "microbiologyevents.charttime",
                                "microbiologyevents.spec_type_desc"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Seq Scan",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Relation Name": "microbiologyevents",
                                    "Schema": "mimiciii_clinical",
                                    "Alias": "microbiologyevents",
                                    "Output": [
                                        "microbiologyevents.hadm_id",
                                        "microbiologyevents.chartdate",
                                        "microbiologyevents.charttime",
                                        "microbiologyevents.spec_type_desc",
                                        "microbiologyevents.org_name"
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "Merge Join",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE ab_fnl",
                    "Parallel Aware": false,
                    "Join Type": "Left",
                    "Output": [
                        "ab_tbl.icustay_id",
                        "ab_tbl.intime",
                        "ab_tbl.outtime",
                        "ab_tbl.antibiotic_name",
                        "ab_tbl.antibiotic_time",
                        "COALESCE(me72.charttime, me72.chartdate)",
                        "COALESCE(me24.charttime, me24.chartdate)",
                        "me72.positiveculture",
                        "me72.spec_type_desc",
                        "me24.positiveculture",
                        "me24.spec_type_desc"
                    ],
                    "Inner Unique": false,
                    "Merge Cond": "(ab_tbl.hadm_id = me24.hadm_id)",
                    "Join Filter": "((ab_tbl.antibiotic_time IS NOT NULL) AND (((ab_tbl.antibiotic_time <= me24.charttime) AND (ab_tbl.antibiotic_time >= datetime_sub(me24.charttime, '24:00:00'::interval))) OR ((me24.charttime IS NULL) AND (ab_tbl.antibiotic_time <= me24.chartdate) AND (ab_tbl.antibiotic_time >= datetime_sub(me24.chartdate, '24:00:00'::interval)))))",
                    "Plans": [
                        {
                            "Node Type": "Merge Join",
                            "Parent Relationship": "Outer",
                            "Parallel Aware": false,
                            "Join Type": "Left",
                            "Output": [
                                "ab_tbl.icustay_id",
                                "ab_tbl.intime",
                                "ab_tbl.outtime",
                                "ab_tbl.antibiotic_name",
                                "ab_tbl.antibiotic_time",
                                "ab_tbl.hadm_id",
                                "me72.charttime",
                                "me72.chartdate",
                                "me72.positiveculture",
                                "me72.spec_type_desc"
                            ],
                            "Inner Unique": false,
                            "Merge Cond": "(ab_tbl.hadm_id = me72.hadm_id)",
                            "Join Filter": "((ab_tbl.antibiotic_time IS NOT NULL) AND (((ab_tbl.antibiotic_time >= me72.charttime) AND (ab_tbl.antibiotic_time <= datetime_add(me72.charttime, '72:00:00'::interval))) OR ((me72.charttime IS NULL) AND (ab_tbl.antibiotic_time >= me72.chartdate) AND (ab_tbl.antibiotic_time <= datetime_add(me72.chartdate, '96:00:00'::interval)))))",
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "ab_tbl.icustay_id",
                                        "ab_tbl.intime",
                                        "ab_tbl.outtime",
                                        "ab_tbl.antibiotic_name",
                                        "ab_tbl.antibiotic_time",
                                        "ab_tbl.hadm_id"
                                    ],
                                    "Sort Key": [
                                        "ab_tbl.hadm_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "ab_tbl",
                                            "Alias": "ab_tbl",
                                            "Output": [
                                                "ab_tbl.icustay_id",
                                                "ab_tbl.intime",
                                                "ab_tbl.outtime",
                                                "ab_tbl.antibiotic_name",
                                                "ab_tbl.antibiotic_time",
                                                "ab_tbl.hadm_id"
                                            ]
                                        }
                                    ]
                                },
                                {
                                    "Node Type": "Materialize",
                                    "Parent Relationship": "Inner",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "me72.charttime",
                                        "me72.chartdate",
                                        "me72.positiveculture",
                                        "me72.spec_type_desc",
                                        "me72.hadm_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "Sort",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "Output": [
                                                "me72.charttime",
                                                "me72.chartdate",
                                                "me72.positiveculture",
                                                "me72.spec_type_desc",
                                                "me72.hadm_id"
                                            ],
                                            "Sort Key": [
                                                "me72.hadm_id"
                                            ],
                                            "Plans": [
                                                {
                                                    "Node Type": "CTE Scan",
                                                    "Parent Relationship": "Outer",
                                                    "Parallel Aware": false,
                                                    "CTE Name": "me",
                                                    "Alias": "me72",
                                                    "Output": [
                                                        "me72.charttime",
                                                        "me72.chartdate",
                                                        "me72.positiveculture",
                                                        "me72.spec_type_desc",
                                                        "me72.hadm_id"
                                                    ]
                                                }
                                            ]
                                        }
                                    ]
                                }
                            ]
                        },
                        {
                            "Node Type": "Materialize",
                            "Parent Relationship": "Inner",
                            "Parallel Aware": false,
                            "Output": [
                                "me24.charttime",
                                "me24.chartdate",
                                "me24.positiveculture",
                                "me24.spec_type_desc",
                                "me24.hadm_id"
                            ],
                            "Plans": [
                                {
                                    "Node Type": "Sort",
                                    "Parent Relationship": "Outer",
                                    "Parallel Aware": false,
                                    "Output": [
                                        "me24.charttime",
                                        "me24.chartdate",
                                        "me24.positiveculture",
                                        "me24.spec_type_desc",
                                        "me24.hadm_id"
                                    ],
                                    "Sort Key": [
                                        "me24.hadm_id"
                                    ],
                                    "Plans": [
                                        {
                                            "Node Type": "CTE Scan",
                                            "Parent Relationship": "Outer",
                                            "Parallel Aware": false,
                                            "CTE Name": "me",
                                            "Alias": "me24",
                                            "Output": [
                                                "me24.charttime",
                                                "me24.chartdate",
                                                "me24.positiveculture",
                                                "me24.spec_type_desc",
                                                "me24.hadm_id"
                                            ]
                                        }
                                    ]
                                }
                            ]
                        }
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "InitPlan",
                    "Subplan Name": "CTE ab_laststg",
                    "Parallel Aware": false,
                    "CTE Name": "ab_fnl",
                    "Alias": "ab_fnl",
                    "Output": [
                        "ab_fnl.icustay_id",
                        "ab_fnl.antibiotic_name",
                        "ab_fnl.antibiotic_time",
                        "ab_fnl.last72_charttime",
                        "ab_fnl.next24_charttime",
                        "CASE WHEN (COALESCE(ab_fnl.last72_charttime, ab_fnl.next24_charttime) IS NULL) THEN 0 ELSE 1 END",
                        "COALESCE(ab_fnl.last72_charttime, ab_fnl.next24_charttime)",
                        "CASE WHEN (ab_fnl.last72_charttime IS NOT NULL) THEN ab_fnl.last72_specimen WHEN (ab_fnl.next24_charttime IS NOT NULL) THEN ab_fnl.next24_specimen ELSE NULL::character varying END",
                        "CASE WHEN (ab_fnl.last72_charttime IS NOT NULL) THEN ab_fnl.last72_positiveculture WHEN (ab_fnl.next24_charttime IS NOT NULL) THEN ab_fnl.next24_positiveculture ELSE NULL::integer END"
                    ]
                },
                {
                    "Node Type": "CTE Scan",
                    "Parent Relationship": "Outer",
                    "Parallel Aware": false,
                    "CTE Name": "ab_laststg",
                    "Alias": "ab_laststg",
                    "Output": [
                        "ab_laststg.icustay_id",
                        "ab_laststg.antibiotic_name",
                        "ab_laststg.antibiotic_time",
                        "ab_laststg.last72_charttime",
                        "ab_laststg.next24_charttime",
                        "ab_laststg.suspected_infection_time",
                        "ab_laststg.specimen",
                        "ab_laststg.positiveculture"
                    ]
                }
            ]
        }
    }
}